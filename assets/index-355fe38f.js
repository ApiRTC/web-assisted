function _mergeNamespaces(a,o){for(var _e=0;_e<o.length;_e++){const tt=o[_e];if(typeof tt!="string"&&!Array.isArray(tt)){for(const rt in tt)if(rt!=="default"&&!(rt in a)){const st=Object.getOwnPropertyDescriptor(tt,rt);st&&Object.defineProperty(a,rt,st.get?st:{enumerable:!0,get:()=>tt[rt]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const rt of document.querySelectorAll('link[rel="modulepreload"]'))tt(rt);new MutationObserver(rt=>{for(const st of rt)if(st.type==="childList")for(const at of st.addedNodes)at.tagName==="LINK"&&at.rel==="modulepreload"&&tt(at)}).observe(document,{childList:!0,subtree:!0});function _e(rt){const st={};return rt.integrity&&(st.integrity=rt.integrity),rt.referrerPolicy&&(st.referrerPolicy=rt.referrerPolicy),rt.crossOrigin==="use-credentials"?st.credentials="include":rt.crossOrigin==="anonymous"?st.credentials="omit":st.credentials="same-origin",st}function tt(rt){if(rt.ep)return;rt.ep=!0;const st=_e(rt);fetch(rt.href,st)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$3=Symbol.for("react.element"),n$3=Symbol.for("react.portal"),p$4=Symbol.for("react.fragment"),q$4=Symbol.for("react.strict_mode"),r$2=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u$2=Symbol.for("react.context"),v$3=Symbol.for("react.forward_ref"),w$2=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$2=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$4(a){return a===null||typeof a!="object"?null:(a=z$3&&a[z$3]||a["@@iterator"],typeof a=="function"?a:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$2(a,o,_e){this.props=a,this.context=o,this.refs=D$2,this.updater=_e||B$2}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(a,o){if(typeof a!="object"&&typeof a!="function"&&a!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,a,o,"setState")};E$2.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$2(a,o,_e){this.props=a,this.context=o,this.refs=D$2,this.updater=_e||B$2}var H$1=G$2.prototype=new F$1;H$1.constructor=G$2;C$2(H$1,E$2.prototype);H$1.isPureReactComponent=!0;var I$3=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$2={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$2(a,o,_e){var tt,rt={},st=null,at=null;if(o!=null)for(tt in o.ref!==void 0&&(at=o.ref),o.key!==void 0&&(st=""+o.key),o)J$1.call(o,tt)&&!L$1.hasOwnProperty(tt)&&(rt[tt]=o[tt]);var ut=arguments.length-2;if(ut===1)rt.children=_e;else if(1<ut){for(var s=Array(ut),et=0;et<ut;et++)s[et]=arguments[et+2];rt.children=s}if(a&&a.defaultProps)for(tt in ut=a.defaultProps,ut)rt[tt]===void 0&&(rt[tt]=ut[tt]);return{$$typeof:l$3,type:a,key:st,ref:at,props:rt,_owner:K$2.current}}function N$3(a,o){return{$$typeof:l$3,type:a.type,key:o,ref:a.ref,props:a.props,_owner:a._owner}}function O$2(a){return typeof a=="object"&&a!==null&&a.$$typeof===l$3}function escape$1(a){var o={"=":"=0",":":"=2"};return"$"+a.replace(/[=:]/g,function(_e){return o[_e]})}var P$1=/\/+/g;function Q$2(a,o){return typeof a=="object"&&a!==null&&a.key!=null?escape$1(""+a.key):o.toString(36)}function R$1(a,o,_e,tt,rt){var st=typeof a;(st==="undefined"||st==="boolean")&&(a=null);var at=!1;if(a===null)at=!0;else switch(st){case"string":case"number":at=!0;break;case"object":switch(a.$$typeof){case l$3:case n$3:at=!0}}if(at)return at=a,rt=rt(at),a=tt===""?"."+Q$2(at,0):tt,I$3(rt)?(_e="",a!=null&&(_e=a.replace(P$1,"$&/")+"/"),R$1(rt,o,_e,"",function(et){return et})):rt!=null&&(O$2(rt)&&(rt=N$3(rt,_e+(!rt.key||at&&at.key===rt.key?"":(""+rt.key).replace(P$1,"$&/")+"/")+a)),o.push(rt)),1;if(at=0,tt=tt===""?".":tt+":",I$3(a))for(var ut=0;ut<a.length;ut++){st=a[ut];var s=tt+Q$2(st,ut);at+=R$1(st,o,_e,s,rt)}else if(s=A$4(a),typeof s=="function")for(a=s.call(a),ut=0;!(st=a.next()).done;)st=st.value,s=tt+Q$2(st,ut++),at+=R$1(st,o,_e,s,rt);else if(st==="object")throw o=String(a),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return at}function S$2(a,o,_e){if(a==null)return a;var tt=[],rt=0;return R$1(a,tt,"","",function(st){return o.call(_e,st,rt++)}),tt}function T$2(a){if(a._status===-1){var o=a._result;o=o(),o.then(function(_e){(a._status===0||a._status===-1)&&(a._status=1,a._result=_e)},function(_e){(a._status===0||a._status===-1)&&(a._status=2,a._result=_e)}),a._status===-1&&(a._status=0,a._result=o)}if(a._status===1)return a._result.default;throw a._result}var U$1={current:null},V$1={transition:null},W$2={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$2};react_production_min.Children={map:S$2,forEach:function(a,o,_e){S$2(a,function(){o.apply(this,arguments)},_e)},count:function(a){var o=0;return S$2(a,function(){o++}),o},toArray:function(a){return S$2(a,function(o){return o})||[]},only:function(a){if(!O$2(a))throw Error("React.Children.only expected to receive a single React element child.");return a}};react_production_min.Component=E$2;react_production_min.Fragment=p$4;react_production_min.Profiler=r$2;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$4;react_production_min.Suspense=w$2;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.cloneElement=function(a,o,_e){if(a==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+a+".");var tt=C$2({},a.props),rt=a.key,st=a.ref,at=a._owner;if(o!=null){if(o.ref!==void 0&&(st=o.ref,at=K$2.current),o.key!==void 0&&(rt=""+o.key),a.type&&a.type.defaultProps)var ut=a.type.defaultProps;for(s in o)J$1.call(o,s)&&!L$1.hasOwnProperty(s)&&(tt[s]=o[s]===void 0&&ut!==void 0?ut[s]:o[s])}var s=arguments.length-2;if(s===1)tt.children=_e;else if(1<s){ut=Array(s);for(var et=0;et<s;et++)ut[et]=arguments[et+2];tt.children=ut}return{$$typeof:l$3,type:a.type,key:rt,ref:st,props:tt,_owner:at}};react_production_min.createContext=function(a){return a={$$typeof:u$2,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},a.Provider={$$typeof:t$2,_context:a},a.Consumer=a};react_production_min.createElement=M$2;react_production_min.createFactory=function(a){var o=M$2.bind(null,a);return o.type=a,o};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(a){return{$$typeof:v$3,render:a}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(a){return{$$typeof:y$2,_payload:{_status:-1,_result:a},_init:T$2}};react_production_min.memo=function(a,o){return{$$typeof:x$2,type:a,compare:o===void 0?null:o}};react_production_min.startTransition=function(a){var o=V$1.transition;V$1.transition={};try{a()}finally{V$1.transition=o}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(a,o){return U$1.current.useCallback(a,o)};react_production_min.useContext=function(a){return U$1.current.useContext(a)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(a){return U$1.current.useDeferredValue(a)};react_production_min.useEffect=function(a,o){return U$1.current.useEffect(a,o)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(a,o,_e){return U$1.current.useImperativeHandle(a,o,_e)};react_production_min.useInsertionEffect=function(a,o){return U$1.current.useInsertionEffect(a,o)};react_production_min.useLayoutEffect=function(a,o){return U$1.current.useLayoutEffect(a,o)};react_production_min.useMemo=function(a,o){return U$1.current.useMemo(a,o)};react_production_min.useReducer=function(a,o,_e){return U$1.current.useReducer(a,o,_e)};react_production_min.useRef=function(a){return U$1.current.useRef(a)};react_production_min.useState=function(a){return U$1.current.useState(a)};react_production_min.useSyncExternalStore=function(a,o,_e){return U$1.current.useSyncExternalStore(a,o,_e)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React$1=getDefaultExportFromCjs(reactExports),React$2=_mergeNamespaces({__proto__:null,default:React$1},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$2=reactExports,k$2=Symbol.for("react.element"),l$2=Symbol.for("react.fragment"),m$4=Object.prototype.hasOwnProperty,n$2=f$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$3={key:!0,ref:!0,__self:!0,__source:!0};function q$3(a,o,_e){var tt,rt={},st=null,at=null;_e!==void 0&&(st=""+_e),o.key!==void 0&&(st=""+o.key),o.ref!==void 0&&(at=o.ref);for(tt in o)m$4.call(o,tt)&&!p$3.hasOwnProperty(tt)&&(rt[tt]=o[tt]);if(a&&a.defaultProps)for(tt in o=a.defaultProps,o)rt[tt]===void 0&&(rt[tt]=o[tt]);return{$$typeof:k$2,type:a,key:st,ref:at,props:rt,_owner:n$2.current}}reactJsxRuntime_production_min.Fragment=l$2;reactJsxRuntime_production_min.jsx=q$3;reactJsxRuntime_production_min.jsxs=q$3;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(a){function o(Ht,fn){var bn=Ht.length;Ht.push(fn);e:for(;0<bn;){var In=bn-1>>>1,un=Ht[In];if(0<rt(un,fn))Ht[In]=fn,Ht[bn]=un,bn=In;else break e}}function _e(Ht){return Ht.length===0?null:Ht[0]}function tt(Ht){if(Ht.length===0)return null;var fn=Ht[0],bn=Ht.pop();if(bn!==fn){Ht[0]=bn;e:for(var In=0,un=Ht.length,mn=un>>>1;In<mn;){var yn=2*(In+1)-1,pn=Ht[yn],Tn=yn+1,kn=Ht[Tn];if(0>rt(pn,bn))Tn<un&&0>rt(kn,pn)?(Ht[In]=kn,Ht[Tn]=bn,In=Tn):(Ht[In]=pn,Ht[yn]=bn,In=yn);else if(Tn<un&&0>rt(kn,bn))Ht[In]=kn,Ht[Tn]=bn,In=Tn;else break e}}return fn}function rt(Ht,fn){var bn=Ht.sortIndex-fn.sortIndex;return bn!==0?bn:Ht.id-fn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;a.unstable_now=function(){return st.now()}}else{var at=Date,ut=at.now();a.unstable_now=function(){return at.now()-ut}}var s=[],et=[],ot=1,lt=null,St=3,pt=!1,gt=!1,ct=!1,ht=typeof setTimeout=="function"?setTimeout:null,it=typeof clearTimeout=="function"?clearTimeout:null,ft=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function mt(Ht){for(var fn=_e(et);fn!==null;){if(fn.callback===null)tt(et);else if(fn.startTime<=Ht)tt(et),fn.sortIndex=fn.expirationTime,o(s,fn);else break;fn=_e(et)}}function Tt(Ht){if(ct=!1,mt(Ht),!gt)if(_e(s)!==null)gt=!0,gn(It);else{var fn=_e(et);fn!==null&&tn(Tt,fn.startTime-Ht)}}function It(Ht,fn){gt=!1,ct&&(ct=!1,it(Nt),Nt=-1),pt=!0;var bn=St;try{for(mt(fn),lt=_e(s);lt!==null&&(!(lt.expirationTime>fn)||Ht&&!bt());){var In=lt.callback;if(typeof In=="function"){lt.callback=null,St=lt.priorityLevel;var un=In(lt.expirationTime<=fn);fn=a.unstable_now(),typeof un=="function"?lt.callback=un:lt===_e(s)&&tt(s),mt(fn)}else tt(s);lt=_e(s)}if(lt!==null)var mn=!0;else{var yn=_e(et);yn!==null&&tn(Tt,yn.startTime-fn),mn=!1}return mn}finally{lt=null,St=bn,pt=!1}}var Pt=!1,At=null,Nt=-1,Ot=5,Mt=-1;function bt(){return!(a.unstable_now()-Mt<Ot)}function Wt(){if(At!==null){var Ht=a.unstable_now();Mt=Ht;var fn=!0;try{fn=At(!0,Ht)}finally{fn?zt():(Pt=!1,At=null)}}else Pt=!1}var zt;if(typeof ft=="function")zt=function(){ft(Wt)};else if(typeof MessageChannel<"u"){var Bt=new MessageChannel,rn=Bt.port2;Bt.port1.onmessage=Wt,zt=function(){rn.postMessage(null)}}else zt=function(){ht(Wt,0)};function gn(Ht){At=Ht,Pt||(Pt=!0,zt())}function tn(Ht,fn){Nt=ht(function(){Ht(a.unstable_now())},fn)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(Ht){Ht.callback=null},a.unstable_continueExecution=function(){gt||pt||(gt=!0,gn(It))},a.unstable_forceFrameRate=function(Ht){0>Ht||125<Ht?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ot=0<Ht?Math.floor(1e3/Ht):5},a.unstable_getCurrentPriorityLevel=function(){return St},a.unstable_getFirstCallbackNode=function(){return _e(s)},a.unstable_next=function(Ht){switch(St){case 1:case 2:case 3:var fn=3;break;default:fn=St}var bn=St;St=fn;try{return Ht()}finally{St=bn}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(Ht,fn){switch(Ht){case 1:case 2:case 3:case 4:case 5:break;default:Ht=3}var bn=St;St=Ht;try{return fn()}finally{St=bn}},a.unstable_scheduleCallback=function(Ht,fn,bn){var In=a.unstable_now();switch(typeof bn=="object"&&bn!==null?(bn=bn.delay,bn=typeof bn=="number"&&0<bn?In+bn:In):bn=In,Ht){case 1:var un=-1;break;case 2:un=250;break;case 5:un=1073741823;break;case 4:un=1e4;break;default:un=5e3}return un=bn+un,Ht={id:ot++,callback:fn,priorityLevel:Ht,startTime:bn,expirationTime:un,sortIndex:-1},bn>In?(Ht.sortIndex=bn,o(et,Ht),_e(s)===null&&Ht===_e(et)&&(ct?(it(Nt),Nt=-1):ct=!0,tn(Tt,bn-In))):(Ht.sortIndex=un,o(s,Ht),gt||pt||(gt=!0,gn(It))),Ht},a.unstable_shouldYield=bt,a.unstable_wrapCallback=function(Ht){var fn=St;return function(){var bn=St;St=fn;try{return Ht.apply(this,arguments)}finally{St=bn}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$2(a){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+a,_e=1;_e<arguments.length;_e++)o+="&args[]="+encodeURIComponent(arguments[_e]);return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(a,o){ha(a,o),ha(a+"Capture",o)}function ha(a,o){for(ea[a]=o,a=0;a<o.length;a++)da.add(o[a])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(a){return ja.call(ma,a)?!0:ja.call(la,a)?!1:ka.test(a)?ma[a]=!0:(la[a]=!0,!1)}function pa(a,o,_e,tt){if(_e!==null&&_e.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return tt?!1:_e!==null?!_e.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function qa(a,o,_e,tt){if(o===null||typeof o>"u"||pa(a,o,_e,tt))return!0;if(tt)return!1;if(_e!==null)switch(_e.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function v$2(a,o,_e,tt,rt,st,at){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=tt,this.attributeNamespace=rt,this.mustUseProperty=_e,this.propertyName=a,this.type=o,this.sanitizeURL=st,this.removeEmptyString=at}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){z$2[a]=new v$2(a,0,!1,a,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var o=a[0];z$2[o]=new v$2(o,1,!1,a[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){z$2[a]=new v$2(a,2,!1,a.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){z$2[a]=new v$2(a,2,!1,a,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){z$2[a]=new v$2(a,3,!1,a.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(a){z$2[a]=new v$2(a,3,!0,a,null,!1,!1)});["capture","download"].forEach(function(a){z$2[a]=new v$2(a,4,!1,a,null,!1,!1)});["cols","rows","size","span"].forEach(function(a){z$2[a]=new v$2(a,6,!1,a,null,!1,!1)});["rowSpan","start"].forEach(function(a){z$2[a]=new v$2(a,5,!1,a.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var o=a.replace(ra,sa);z$2[o]=new v$2(o,1,!1,a,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var o=a.replace(ra,sa);z$2[o]=new v$2(o,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var o=a.replace(ra,sa);z$2[o]=new v$2(o,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(a){z$2[a]=new v$2(a,1,!1,a.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$2("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(a){z$2[a]=new v$2(a,1,!1,a.toLowerCase(),null,!0,!0)});function ta(a,o,_e,tt){var rt=z$2.hasOwnProperty(o)?z$2[o]:null;(rt!==null?rt.type!==0:tt||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(qa(o,_e,rt,tt)&&(_e=null),tt||rt===null?oa(o)&&(_e===null?a.removeAttribute(o):a.setAttribute(o,""+_e)):rt.mustUseProperty?a[rt.propertyName]=_e===null?rt.type===3?!1:"":_e:(o=rt.attributeName,tt=rt.attributeNamespace,_e===null?a.removeAttribute(o):(rt=rt.type,_e=rt===3||rt===4&&_e===!0?"":""+_e,tt?a.setAttributeNS(tt,o,_e):a.setAttribute(o,_e))))}var ua$1=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(a){return a===null||typeof a!="object"?null:(a=Ja&&a[Ja]||a["@@iterator"],typeof a=="function"?a:null)}var A$3=Object.assign,La;function Ma(a){if(La===void 0)try{throw Error()}catch(_e){var o=_e.stack.trim().match(/\n( *(at )?)/);La=o&&o[1]||""}return`
`+La+a}var Na=!1;function Oa(a,o){if(!a||Na)return"";Na=!0;var _e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(et){var tt=et}Reflect.construct(a,[],o)}else{try{o.call()}catch(et){tt=et}a.call(o.prototype)}else{try{throw Error()}catch(et){tt=et}a()}}catch(et){if(et&&tt&&typeof et.stack=="string"){for(var rt=et.stack.split(`
`),st=tt.stack.split(`
`),at=rt.length-1,ut=st.length-1;1<=at&&0<=ut&&rt[at]!==st[ut];)ut--;for(;1<=at&&0<=ut;at--,ut--)if(rt[at]!==st[ut]){if(at!==1||ut!==1)do if(at--,ut--,0>ut||rt[at]!==st[ut]){var s=`
`+rt[at].replace(" at new "," at ");return a.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",a.displayName)),s}while(1<=at&&0<=ut);break}}}finally{Na=!1,Error.prepareStackTrace=_e}return(a=a?a.displayName||a.name:"")?Ma(a):""}function Pa(a){switch(a.tag){case 5:return Ma(a.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return a=Oa(a.type,!1),a;case 11:return a=Oa(a.type.render,!1),a;case 1:return a=Oa(a.type,!0),a;default:return""}}function Qa(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case Ca:return(a.displayName||"Context")+".Consumer";case Ba:return(a._context.displayName||"Context")+".Provider";case Da:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Ga:return o=a.displayName||null,o!==null?o:Qa(a.type)||"Memo";case Ha:o=a._payload,a=a._init;try{return Qa(a(o))}catch{}}return null}function Ra(a){var o=a.type;switch(a.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=o.render,a=a.displayName||a.name||"",o.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(o);case 8:return o===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Sa(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ta(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ua(a){var o=Ta(a)?"checked":"value",_e=Object.getOwnPropertyDescriptor(a.constructor.prototype,o),tt=""+a[o];if(!a.hasOwnProperty(o)&&typeof _e<"u"&&typeof _e.get=="function"&&typeof _e.set=="function"){var rt=_e.get,st=_e.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return rt.call(this)},set:function(at){tt=""+at,st.call(this,at)}}),Object.defineProperty(a,o,{enumerable:_e.enumerable}),{getValue:function(){return tt},setValue:function(at){tt=""+at},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var _e=o.getValue(),tt="";return a&&(tt=Ta(a)?a.checked?"true":"false":a.value),a=tt,a!==_e?(o.setValue(a),!0):!1}function Xa(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Ya(a,o){var _e=o.checked;return A$3({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_e??a._wrapperState.initialChecked})}function Za(a,o){var _e=o.defaultValue==null?"":o.defaultValue,tt=o.checked!=null?o.checked:o.defaultChecked;_e=Sa(o.value!=null?o.value:_e),a._wrapperState={initialChecked:tt,initialValue:_e,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ab(a,o){o=o.checked,o!=null&&ta(a,"checked",o,!1)}function bb(a,o){ab(a,o);var _e=Sa(o.value),tt=o.type;if(_e!=null)tt==="number"?(_e===0&&a.value===""||a.value!=_e)&&(a.value=""+_e):a.value!==""+_e&&(a.value=""+_e);else if(tt==="submit"||tt==="reset"){a.removeAttribute("value");return}o.hasOwnProperty("value")?cb(a,o.type,_e):o.hasOwnProperty("defaultValue")&&cb(a,o.type,Sa(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(a.defaultChecked=!!o.defaultChecked)}function db(a,o,_e){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var tt=o.type;if(!(tt!=="submit"&&tt!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+a._wrapperState.initialValue,_e||o===a.value||(a.value=o),a.defaultValue=o}_e=a.name,_e!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,_e!==""&&(a.name=_e)}function cb(a,o,_e){(o!=="number"||Xa(a.ownerDocument)!==a)&&(_e==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+_e&&(a.defaultValue=""+_e))}var eb=Array.isArray;function fb(a,o,_e,tt){if(a=a.options,o){o={};for(var rt=0;rt<_e.length;rt++)o["$"+_e[rt]]=!0;for(_e=0;_e<a.length;_e++)rt=o.hasOwnProperty("$"+a[_e].value),a[_e].selected!==rt&&(a[_e].selected=rt),rt&&tt&&(a[_e].defaultSelected=!0)}else{for(_e=""+Sa(_e),o=null,rt=0;rt<a.length;rt++){if(a[rt].value===_e){a[rt].selected=!0,tt&&(a[rt].defaultSelected=!0);return}o!==null||a[rt].disabled||(o=a[rt])}o!==null&&(o.selected=!0)}}function gb(a,o){if(o.dangerouslySetInnerHTML!=null)throw Error(p$2(91));return A$3({},o,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function hb(a,o){var _e=o.value;if(_e==null){if(_e=o.children,o=o.defaultValue,_e!=null){if(o!=null)throw Error(p$2(92));if(eb(_e)){if(1<_e.length)throw Error(p$2(93));_e=_e[0]}o=_e}o==null&&(o=""),_e=o}a._wrapperState={initialValue:Sa(_e)}}function ib(a,o){var _e=Sa(o.value),tt=Sa(o.defaultValue);_e!=null&&(_e=""+_e,_e!==a.value&&(a.value=_e),o.defaultValue==null&&a.defaultValue!==_e&&(a.defaultValue=_e)),tt!=null&&(a.defaultValue=""+tt)}function jb(a){var o=a.textContent;o===a._wrapperState.initialValue&&o!==""&&o!==null&&(a.value=o)}function kb(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(a,o){return a==null||a==="http://www.w3.org/1999/xhtml"?kb(o):a==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var mb,nb=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,_e,tt,rt){MSApp.execUnsafeLocalFunction(function(){return a(o,_e,tt,rt)})}:a}(function(a,o){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=o;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=mb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;o.firstChild;)a.appendChild(o.firstChild)}});function ob(a,o){if(o){var _e=a.firstChild;if(_e&&_e===a.lastChild&&_e.nodeType===3){_e.nodeValue=o;return}}a.textContent=o}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(a){qb.forEach(function(o){o=o+a.charAt(0).toUpperCase()+a.substring(1),pb[o]=pb[a]})});function rb(a,o,_e){return o==null||typeof o=="boolean"||o===""?"":_e||typeof o!="number"||o===0||pb.hasOwnProperty(a)&&pb[a]?(""+o).trim():o+"px"}function sb(a,o){a=a.style;for(var _e in o)if(o.hasOwnProperty(_e)){var tt=_e.indexOf("--")===0,rt=rb(_e,o[_e],tt);_e==="float"&&(_e="cssFloat"),tt?a.setProperty(_e,rt):a[_e]=rt}}var tb=A$3({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(a,o){if(o){if(tb[a]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(p$2(137,a));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(p$2(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(p$2(61))}if(o.style!=null&&typeof o.style!="object")throw Error(p$2(62))}}function vb(a,o){if(a.indexOf("-")===-1)return typeof o.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var yb=null,zb=null,Ab=null;function Bb(a){if(a=Cb(a)){if(typeof yb!="function")throw Error(p$2(280));var o=a.stateNode;o&&(o=Db(o),yb(a.stateNode,a.type,o))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,o=Ab;if(Ab=zb=null,Bb(a),o)for(a=0;a<o.length;a++)Bb(o[a])}}function Gb(a,o){return a(o)}function Hb(){}var Ib=!1;function Jb(a,o,_e){if(Ib)return a(o,_e);Ib=!0;try{return Gb(a,o,_e)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(a,o){var _e=a.stateNode;if(_e===null)return null;var tt=Db(_e);if(tt===null)return null;_e=tt[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(tt=!tt.disabled)||(a=a.type,tt=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!tt;break e;default:a=!1}if(a)return null;if(_e&&typeof _e!="function")throw Error(p$2(231,o,typeof _e));return _e}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(a,o,_e,tt,rt,st,at,ut,s){var et=Array.prototype.slice.call(arguments,3);try{o.apply(_e,et)}catch(ot){this.onError(ot)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(a){Ob=!0,Pb=a}};function Tb(a,o,_e,tt,rt,st,at,ut,s){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(a,o,_e,tt,rt,st,at,ut,s){if(Tb.apply(this,arguments),Ob){if(Ob){var et=Pb;Ob=!1,Pb=null}else throw Error(p$2(198));Qb||(Qb=!0,Rb=et)}}function Vb(a){var o=a,_e=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,o.flags&4098&&(_e=o.return),a=o.return;while(a)}return o.tag===3?_e:null}function Wb(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function Xb(a){if(Vb(a)!==a)throw Error(p$2(188))}function Yb(a){var o=a.alternate;if(!o){if(o=Vb(a),o===null)throw Error(p$2(188));return o!==a?null:a}for(var _e=a,tt=o;;){var rt=_e.return;if(rt===null)break;var st=rt.alternate;if(st===null){if(tt=rt.return,tt!==null){_e=tt;continue}break}if(rt.child===st.child){for(st=rt.child;st;){if(st===_e)return Xb(rt),a;if(st===tt)return Xb(rt),o;st=st.sibling}throw Error(p$2(188))}if(_e.return!==tt.return)_e=rt,tt=st;else{for(var at=!1,ut=rt.child;ut;){if(ut===_e){at=!0,_e=rt,tt=st;break}if(ut===tt){at=!0,tt=rt,_e=st;break}ut=ut.sibling}if(!at){for(ut=st.child;ut;){if(ut===_e){at=!0,_e=st,tt=rt;break}if(ut===tt){at=!0,tt=st,_e=rt;break}ut=ut.sibling}if(!at)throw Error(p$2(189))}}if(_e.alternate!==tt)throw Error(p$2(190))}if(_e.tag!==3)throw Error(p$2(188));return _e.stateNode.current===_e?a:o}function Zb(a){return a=Yb(a),a!==null?$b(a):null}function $b(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var o=$b(a);if(o!==null)return o;a=a.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$1=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(a){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,a,void 0,(a.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(a){return a>>>=0,a===0?32:31-(pc(a)/qc|0)|0}var rc=64,sc=4194304;function tc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function uc(a,o){var _e=a.pendingLanes;if(_e===0)return 0;var tt=0,rt=a.suspendedLanes,st=a.pingedLanes,at=_e&268435455;if(at!==0){var ut=at&~rt;ut!==0?tt=tc(ut):(st&=at,st!==0&&(tt=tc(st)))}else at=_e&~rt,at!==0?tt=tc(at):st!==0&&(tt=tc(st));if(tt===0)return 0;if(o!==0&&o!==tt&&!(o&rt)&&(rt=tt&-tt,st=o&-o,rt>=st||rt===16&&(st&4194240)!==0))return o;if(tt&4&&(tt|=_e&16),o=a.entangledLanes,o!==0)for(a=a.entanglements,o&=tt;0<o;)_e=31-oc(o),rt=1<<_e,tt|=a[_e],o&=~rt;return tt}function vc(a,o){switch(a){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(a,o){for(var _e=a.suspendedLanes,tt=a.pingedLanes,rt=a.expirationTimes,st=a.pendingLanes;0<st;){var at=31-oc(st),ut=1<<at,s=rt[at];s===-1?(!(ut&_e)||ut&tt)&&(rt[at]=vc(ut,o)):s<=o&&(a.expiredLanes|=ut),st&=~ut}}function xc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function yc(){var a=rc;return rc<<=1,!(rc&4194240)&&(rc=64),a}function zc(a){for(var o=[],_e=0;31>_e;_e++)o.push(a);return o}function Ac(a,o,_e){a.pendingLanes|=o,o!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,o=31-oc(o),a[o]=_e}function Bc(a,o){var _e=a.pendingLanes&~o;a.pendingLanes=o,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=o,a.mutableReadLanes&=o,a.entangledLanes&=o,o=a.entanglements;var tt=a.eventTimes;for(a=a.expirationTimes;0<_e;){var rt=31-oc(_e),st=1<<rt;o[rt]=0,tt[rt]=-1,a[rt]=-1,_e&=~st}}function Cc(a,o){var _e=a.entangledLanes|=o;for(a=a.entanglements;_e;){var tt=31-oc(_e),rt=1<<tt;rt&o|a[tt]&o&&(a[tt]|=o),_e&=~rt}}var C$1=0;function Dc(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(a,o){switch(a){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(o.pointerId)}}function Tc(a,o,_e,tt,rt,st){return a===null||a.nativeEvent!==st?(a={blockedOn:o,domEventName:_e,eventSystemFlags:tt,nativeEvent:st,targetContainers:[rt]},o!==null&&(o=Cb(o),o!==null&&Fc(o)),a):(a.eventSystemFlags|=tt,o=a.targetContainers,rt!==null&&o.indexOf(rt)===-1&&o.push(rt),a)}function Uc(a,o,_e,tt,rt){switch(o){case"focusin":return Lc=Tc(Lc,a,o,_e,tt,rt),!0;case"dragenter":return Mc=Tc(Mc,a,o,_e,tt,rt),!0;case"mouseover":return Nc=Tc(Nc,a,o,_e,tt,rt),!0;case"pointerover":var st=rt.pointerId;return Oc.set(st,Tc(Oc.get(st)||null,a,o,_e,tt,rt)),!0;case"gotpointercapture":return st=rt.pointerId,Pc.set(st,Tc(Pc.get(st)||null,a,o,_e,tt,rt)),!0}return!1}function Vc(a){var o=Wc(a.target);if(o!==null){var _e=Vb(o);if(_e!==null){if(o=_e.tag,o===13){if(o=Wb(_e),o!==null){a.blockedOn=o,Ic(a.priority,function(){Gc(_e)});return}}else if(o===3&&_e.stateNode.current.memoizedState.isDehydrated){a.blockedOn=_e.tag===3?_e.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Xc(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var _e=Yc(a.domEventName,a.eventSystemFlags,o[0],a.nativeEvent);if(_e===null){_e=a.nativeEvent;var tt=new _e.constructor(_e.type,_e);wb=tt,_e.target.dispatchEvent(tt),wb=null}else return o=Cb(_e),o!==null&&Fc(o),a.blockedOn=_e,!1;o.shift()}return!0}function Zc(a,o,_e){Xc(a)&&_e.delete(o)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(a,o){a.blockedOn===o&&(a.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(a){function o(rt){return ad(rt,a)}if(0<Kc.length){ad(Kc[0],a);for(var _e=1;_e<Kc.length;_e++){var tt=Kc[_e];tt.blockedOn===a&&(tt.blockedOn=null)}}for(Lc!==null&&ad(Lc,a),Mc!==null&&ad(Mc,a),Nc!==null&&ad(Nc,a),Oc.forEach(o),Pc.forEach(o),_e=0;_e<Qc.length;_e++)tt=Qc[_e],tt.blockedOn===a&&(tt.blockedOn=null);for(;0<Qc.length&&(_e=Qc[0],_e.blockedOn===null);)Vc(_e),_e.blockedOn===null&&Qc.shift()}var cd=ua$1.ReactCurrentBatchConfig,dd=!0;function ed(a,o,_e,tt){var rt=C$1,st=cd.transition;cd.transition=null;try{C$1=1,fd(a,o,_e,tt)}finally{C$1=rt,cd.transition=st}}function gd(a,o,_e,tt){var rt=C$1,st=cd.transition;cd.transition=null;try{C$1=4,fd(a,o,_e,tt)}finally{C$1=rt,cd.transition=st}}function fd(a,o,_e,tt){if(dd){var rt=Yc(a,o,_e,tt);if(rt===null)hd(a,o,tt,id,_e),Sc(a,tt);else if(Uc(rt,a,o,_e,tt))tt.stopPropagation();else if(Sc(a,tt),o&4&&-1<Rc.indexOf(a)){for(;rt!==null;){var st=Cb(rt);if(st!==null&&Ec(st),st=Yc(a,o,_e,tt),st===null&&hd(a,o,tt,id,_e),st===rt)break;rt=st}rt!==null&&tt.stopPropagation()}else hd(a,o,tt,null,_e)}}var id=null;function Yc(a,o,_e,tt){if(id=null,a=xb(tt),a=Wc(a),a!==null)if(o=Vb(a),o===null)a=null;else if(_e=o.tag,_e===13){if(a=Wb(o),a!==null)return a;a=null}else if(_e===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null);return id=a,null}function jd(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var a,o=ld,_e=o.length,tt,rt="value"in kd?kd.value:kd.textContent,st=rt.length;for(a=0;a<_e&&o[a]===rt[a];a++);var at=_e-a;for(tt=1;tt<=at&&o[_e-tt]===rt[st-tt];tt++);return md=rt.slice(a,1<tt?1-tt:void 0)}function od(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function pd(){return!0}function qd(){return!1}function rd(a){function o(_e,tt,rt,st,at){this._reactName=_e,this._targetInst=rt,this.type=tt,this.nativeEvent=st,this.target=at,this.currentTarget=null;for(var ut in a)a.hasOwnProperty(ut)&&(_e=a[ut],this[ut]=_e?_e(st):st[ut]);return this.isDefaultPrevented=(st.defaultPrevented!=null?st.defaultPrevented:st.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$3(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _e=this.nativeEvent;_e&&(_e.preventDefault?_e.preventDefault():typeof _e.returnValue!="unknown"&&(_e.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var _e=this.nativeEvent;_e&&(_e.stopPropagation?_e.stopPropagation():typeof _e.cancelBubble!="unknown"&&(_e.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),o}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$3({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$3({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==yd&&(yd&&a.type==="mousemove"?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a),wd)},movementY:function(a){return"movementY"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=A$3({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$3({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$3({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$3({},sd,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$3({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=Od[a])?!!o[a]:!1}function zd(){return Pd}var Qd=A$3({},ud,{key:function(a){if(a.key){var o=Md[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=od(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Nd[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return a.type==="keypress"?od(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?od(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Rd=rd(Qd),Sd=A$3({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$3({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$3({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$3({},Ad,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee$1=String.fromCharCode(32),fe=!1;function ge(a,o){switch(a){case"keyup":return $d.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ie=!1;function je(a,o){switch(a){case"compositionend":return he(o);case"keypress":return o.which!==32?null:(fe=!0,ee$1);case"textInput":return a=o.data,a===ee$1&&fe?null:a;default:return null}}function ke(a,o){if(ie)return a==="compositionend"||!ae&&ge(a,o)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return de&&o.locale!=="ko"?null:o.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!le[a.type]:o==="textarea"}function ne(a,o,_e,tt){Eb(tt),o=oe(o,"onChange"),0<o.length&&(_e=new td("onChange","change",null,_e,tt),a.push({event:_e,listeners:o}))}var pe=null,qe=null;function re(a){se(a,0)}function te$1(a){var o=ue(a);if(Wa(o))return a}function ve(a,o){if(a==="change")return o}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(a){if(a.propertyName==="value"&&te$1(qe)){var o=[];ne(o,qe,a,xb(a)),Jb(re,o)}}function Ce(a,o,_e){a==="focusin"?(Ae(),pe=o,qe=_e,pe.attachEvent("onpropertychange",Be)):a==="focusout"&&Ae()}function De(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return te$1(qe)}function Ee(a,o){if(a==="click")return te$1(o)}function Fe(a,o){if(a==="input"||a==="change")return te$1(o)}function Ge(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(a,o){if(He(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var _e=Object.keys(a),tt=Object.keys(o);if(_e.length!==tt.length)return!1;for(tt=0;tt<_e.length;tt++){var rt=_e[tt];if(!ja.call(o,rt)||!He(a[rt],o[rt]))return!1}return!0}function Je(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Ke(a,o){var _e=Je(a);a=0;for(var tt;_e;){if(_e.nodeType===3){if(tt=a+_e.textContent.length,a<=o&&tt>=o)return{node:_e,offset:o-a};a=tt}e:{for(;_e;){if(_e.nextSibling){_e=_e.nextSibling;break e}_e=_e.parentNode}_e=void 0}_e=Je(_e)}}function Le(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?Le(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function Me(){for(var a=window,o=Xa();o instanceof a.HTMLIFrameElement;){try{var _e=typeof o.contentWindow.location.href=="string"}catch{_e=!1}if(_e)a=o.contentWindow;else break;o=Xa(a.document)}return o}function Ne(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}function Oe(a){var o=Me(),_e=a.focusedElem,tt=a.selectionRange;if(o!==_e&&_e&&_e.ownerDocument&&Le(_e.ownerDocument.documentElement,_e)){if(tt!==null&&Ne(_e)){if(o=tt.start,a=tt.end,a===void 0&&(a=o),"selectionStart"in _e)_e.selectionStart=o,_e.selectionEnd=Math.min(a,_e.value.length);else if(a=(o=_e.ownerDocument||document)&&o.defaultView||window,a.getSelection){a=a.getSelection();var rt=_e.textContent.length,st=Math.min(tt.start,rt);tt=tt.end===void 0?st:Math.min(tt.end,rt),!a.extend&&st>tt&&(rt=tt,tt=st,st=rt),rt=Ke(_e,st);var at=Ke(_e,tt);rt&&at&&(a.rangeCount!==1||a.anchorNode!==rt.node||a.anchorOffset!==rt.offset||a.focusNode!==at.node||a.focusOffset!==at.offset)&&(o=o.createRange(),o.setStart(rt.node,rt.offset),a.removeAllRanges(),st>tt?(a.addRange(o),a.extend(at.node,at.offset)):(o.setEnd(at.node,at.offset),a.addRange(o)))}}for(o=[],a=_e;a=a.parentNode;)a.nodeType===1&&o.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof _e.focus=="function"&&_e.focus(),_e=0;_e<o.length;_e++)a=o[_e],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(a,o,_e){var tt=_e.window===_e?_e.document:_e.nodeType===9?_e:_e.ownerDocument;Te||Qe==null||Qe!==Xa(tt)||(tt=Qe,"selectionStart"in tt&&Ne(tt)?tt={start:tt.selectionStart,end:tt.selectionEnd}:(tt=(tt.ownerDocument&&tt.ownerDocument.defaultView||window).getSelection(),tt={anchorNode:tt.anchorNode,anchorOffset:tt.anchorOffset,focusNode:tt.focusNode,focusOffset:tt.focusOffset}),Se&&Ie(Se,tt)||(Se=tt,tt=oe(Re,"onSelect"),0<tt.length&&(o=new td("onSelect","select",null,o,_e),a.push({event:o,listeners:tt}),o.target=Qe)))}function Ve(a,o){var _e={};return _e[a.toLowerCase()]=o.toLowerCase(),_e["Webkit"+a]="webkit"+o,_e["Moz"+a]="moz"+o,_e}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(a){if(Xe[a])return Xe[a];if(!We[a])return a;var o=We[a],_e;for(_e in o)if(o.hasOwnProperty(_e)&&_e in Ye)return Xe[a]=o[_e];return a}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(a,o){df.set(a,o),fa(o,[a])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(a,o,_e){var tt=a.type||"unknown-event";a.currentTarget=_e,Ub(tt,o,void 0,a),a.currentTarget=null}function se(a,o){o=(o&4)!==0;for(var _e=0;_e<a.length;_e++){var tt=a[_e],rt=tt.event;tt=tt.listeners;e:{var st=void 0;if(o)for(var at=tt.length-1;0<=at;at--){var ut=tt[at],s=ut.instance,et=ut.currentTarget;if(ut=ut.listener,s!==st&&rt.isPropagationStopped())break e;nf(rt,ut,et),st=s}else for(at=0;at<tt.length;at++){if(ut=tt[at],s=ut.instance,et=ut.currentTarget,ut=ut.listener,s!==st&&rt.isPropagationStopped())break e;nf(rt,ut,et),st=s}}}if(Qb)throw a=Rb,Qb=!1,Rb=null,a}function D$1(a,o){var _e=o[of];_e===void 0&&(_e=o[of]=new Set);var tt=a+"__bubble";_e.has(tt)||(pf(o,a,2,!1),_e.add(tt))}function qf(a,o,_e){var tt=0;o&&(tt|=4),pf(_e,a,tt,o)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(a){if(!a[rf]){a[rf]=!0,da.forEach(function(_e){_e!=="selectionchange"&&(mf.has(_e)||qf(_e,!1,a),qf(_e,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[rf]||(o[rf]=!0,qf("selectionchange",!1,o))}}function pf(a,o,_e,tt){switch(jd(o)){case 1:var rt=ed;break;case 4:rt=gd;break;default:rt=fd}_e=rt.bind(null,o,_e,a),rt=void 0,!Lb||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(rt=!0),tt?rt!==void 0?a.addEventListener(o,_e,{capture:!0,passive:rt}):a.addEventListener(o,_e,!0):rt!==void 0?a.addEventListener(o,_e,{passive:rt}):a.addEventListener(o,_e,!1)}function hd(a,o,_e,tt,rt){var st=tt;if(!(o&1)&&!(o&2)&&tt!==null)e:for(;;){if(tt===null)return;var at=tt.tag;if(at===3||at===4){var ut=tt.stateNode.containerInfo;if(ut===rt||ut.nodeType===8&&ut.parentNode===rt)break;if(at===4)for(at=tt.return;at!==null;){var s=at.tag;if((s===3||s===4)&&(s=at.stateNode.containerInfo,s===rt||s.nodeType===8&&s.parentNode===rt))return;at=at.return}for(;ut!==null;){if(at=Wc(ut),at===null)return;if(s=at.tag,s===5||s===6){tt=st=at;continue e}ut=ut.parentNode}}tt=tt.return}Jb(function(){var et=st,ot=xb(_e),lt=[];e:{var St=df.get(a);if(St!==void 0){var pt=td,gt=a;switch(a){case"keypress":if(od(_e)===0)break e;case"keydown":case"keyup":pt=Rd;break;case"focusin":gt="focus",pt=Fd;break;case"focusout":gt="blur",pt=Fd;break;case"beforeblur":case"afterblur":pt=Fd;break;case"click":if(_e.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=Vd;break;case $e:case af:case bf:pt=Hd;break;case cf:pt=Xd;break;case"scroll":pt=vd;break;case"wheel":pt=Zd;break;case"copy":case"cut":case"paste":pt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=Td}var ct=(o&4)!==0,ht=!ct&&a==="scroll",it=ct?St!==null?St+"Capture":null:St;ct=[];for(var ft=et,mt;ft!==null;){mt=ft;var Tt=mt.stateNode;if(mt.tag===5&&Tt!==null&&(mt=Tt,it!==null&&(Tt=Kb(ft,it),Tt!=null&&ct.push(tf(ft,Tt,mt)))),ht)break;ft=ft.return}0<ct.length&&(St=new pt(St,gt,null,_e,ot),lt.push({event:St,listeners:ct}))}}if(!(o&7)){e:{if(St=a==="mouseover"||a==="pointerover",pt=a==="mouseout"||a==="pointerout",St&&_e!==wb&&(gt=_e.relatedTarget||_e.fromElement)&&(Wc(gt)||gt[uf]))break e;if((pt||St)&&(St=ot.window===ot?ot:(St=ot.ownerDocument)?St.defaultView||St.parentWindow:window,pt?(gt=_e.relatedTarget||_e.toElement,pt=et,gt=gt?Wc(gt):null,gt!==null&&(ht=Vb(gt),gt!==ht||gt.tag!==5&&gt.tag!==6)&&(gt=null)):(pt=null,gt=et),pt!==gt)){if(ct=Bd,Tt="onMouseLeave",it="onMouseEnter",ft="mouse",(a==="pointerout"||a==="pointerover")&&(ct=Td,Tt="onPointerLeave",it="onPointerEnter",ft="pointer"),ht=pt==null?St:ue(pt),mt=gt==null?St:ue(gt),St=new ct(Tt,ft+"leave",pt,_e,ot),St.target=ht,St.relatedTarget=mt,Tt=null,Wc(ot)===et&&(ct=new ct(it,ft+"enter",gt,_e,ot),ct.target=mt,ct.relatedTarget=ht,Tt=ct),ht=Tt,pt&&gt)t:{for(ct=pt,it=gt,ft=0,mt=ct;mt;mt=vf(mt))ft++;for(mt=0,Tt=it;Tt;Tt=vf(Tt))mt++;for(;0<ft-mt;)ct=vf(ct),ft--;for(;0<mt-ft;)it=vf(it),mt--;for(;ft--;){if(ct===it||it!==null&&ct===it.alternate)break t;ct=vf(ct),it=vf(it)}ct=null}else ct=null;pt!==null&&wf(lt,St,pt,ct,!1),gt!==null&&ht!==null&&wf(lt,ht,gt,ct,!0)}}e:{if(St=et?ue(et):window,pt=St.nodeName&&St.nodeName.toLowerCase(),pt==="select"||pt==="input"&&St.type==="file")var It=ve;else if(me(St))if(we)It=Fe;else{It=De;var Pt=Ce}else(pt=St.nodeName)&&pt.toLowerCase()==="input"&&(St.type==="checkbox"||St.type==="radio")&&(It=Ee);if(It&&(It=It(a,et))){ne(lt,It,_e,ot);break e}Pt&&Pt(a,St,et),a==="focusout"&&(Pt=St._wrapperState)&&Pt.controlled&&St.type==="number"&&cb(St,"number",St.value)}switch(Pt=et?ue(et):window,a){case"focusin":(me(Pt)||Pt.contentEditable==="true")&&(Qe=Pt,Re=et,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(lt,_e,ot);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(lt,_e,ot)}var At;if(ae)e:{switch(a){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else ie?ge(a,_e)&&(Nt="onCompositionEnd"):a==="keydown"&&_e.keyCode===229&&(Nt="onCompositionStart");Nt&&(de&&_e.locale!=="ko"&&(ie||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&ie&&(At=nd()):(kd=ot,ld="value"in kd?kd.value:kd.textContent,ie=!0)),Pt=oe(et,Nt),0<Pt.length&&(Nt=new Ld(Nt,a,null,_e,ot),lt.push({event:Nt,listeners:Pt}),At?Nt.data=At:(At=he(_e),At!==null&&(Nt.data=At)))),(At=ce?je(a,_e):ke(a,_e))&&(et=oe(et,"onBeforeInput"),0<et.length&&(ot=new Ld("onBeforeInput","beforeinput",null,_e,ot),lt.push({event:ot,listeners:et}),ot.data=At))}se(lt,o)})}function tf(a,o,_e){return{instance:a,listener:o,currentTarget:_e}}function oe(a,o){for(var _e=o+"Capture",tt=[];a!==null;){var rt=a,st=rt.stateNode;rt.tag===5&&st!==null&&(rt=st,st=Kb(a,_e),st!=null&&tt.unshift(tf(a,st,rt)),st=Kb(a,o),st!=null&&tt.push(tf(a,st,rt))),a=a.return}return tt}function vf(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function wf(a,o,_e,tt,rt){for(var st=o._reactName,at=[];_e!==null&&_e!==tt;){var ut=_e,s=ut.alternate,et=ut.stateNode;if(s!==null&&s===tt)break;ut.tag===5&&et!==null&&(ut=et,rt?(s=Kb(_e,st),s!=null&&at.unshift(tf(_e,s,ut))):rt||(s=Kb(_e,st),s!=null&&at.push(tf(_e,s,ut)))),_e=_e.return}at.length!==0&&a.push({event:o,listeners:at})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(a){return(typeof a=="string"?a:""+a).replace(xf,`
`).replace(yf,"")}function Af(a,o,_e){if(o=zf(o),zf(a)!==o&&_e)throw Error(p$2(425))}function Bf(){}var Cf=null,Df=null;function Ef(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(a){return Hf.resolve(null).then(a).catch(If)}:Ff;function If(a){setTimeout(function(){throw a})}function Kf(a,o){var _e=o,tt=0;do{var rt=_e.nextSibling;if(a.removeChild(_e),rt&&rt.nodeType===8)if(_e=rt.data,_e==="/$"){if(tt===0){a.removeChild(rt),bd(o);return}tt--}else _e!=="$"&&_e!=="$?"&&_e!=="$!"||tt++;_e=rt}while(_e);bd(o)}function Lf(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return a}function Mf(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var _e=a.data;if(_e==="$"||_e==="$!"||_e==="$?"){if(o===0)return a;o--}else _e==="/$"&&o++}a=a.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(a){var o=a[Of];if(o)return o;for(var _e=a.parentNode;_e;){if(o=_e[uf]||_e[Of]){if(_e=o.alternate,o.child!==null||_e!==null&&_e.child!==null)for(a=Mf(a);a!==null;){if(_e=a[Of])return _e;a=Mf(a)}return o}a=_e,_e=a.parentNode}return null}function Cb(a){return a=a[Of]||a[uf],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ue(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(p$2(33))}function Db(a){return a[Pf]||null}var Sf=[],Tf=-1;function Uf(a){return{current:a}}function E$1(a){0>Tf||(a.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(a,o){Tf++,Sf[Tf]=a.current,a.current=o}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(a,o){var _e=a.type.contextTypes;if(!_e)return Vf;var tt=a.stateNode;if(tt&&tt.__reactInternalMemoizedUnmaskedChildContext===o)return tt.__reactInternalMemoizedMaskedChildContext;var rt={},st;for(st in _e)rt[st]=o[st];return tt&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=o,a.__reactInternalMemoizedMaskedChildContext=rt),rt}function Zf(a){return a=a.childContextTypes,a!=null}function $f(){E$1(Wf),E$1(H)}function ag(a,o,_e){if(H.current!==Vf)throw Error(p$2(168));G$1(H,o),G$1(Wf,_e)}function bg(a,o,_e){var tt=a.stateNode;if(o=o.childContextTypes,typeof tt.getChildContext!="function")return _e;tt=tt.getChildContext();for(var rt in tt)if(!(rt in o))throw Error(p$2(108,Ra(a)||"Unknown",rt));return A$3({},_e,tt)}function cg(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G$1(H,a),G$1(Wf,Wf.current),!0}function dg(a,o,_e){var tt=a.stateNode;if(!tt)throw Error(p$2(169));_e?(a=bg(a,o,Xf),tt.__reactInternalMemoizedMergedChildContext=a,E$1(Wf),E$1(H),G$1(H,a)):E$1(Wf),G$1(Wf,_e)}var eg=null,fg=!1,gg=!1;function hg(a){eg===null?eg=[a]:eg.push(a)}function ig(a){fg=!0,hg(a)}function jg(){if(!gg&&eg!==null){gg=!0;var a=0,o=C$1;try{var _e=eg;for(C$1=1;a<_e.length;a++){var tt=_e[a];do tt=tt(!0);while(tt!==null)}eg=null,fg=!1}catch(rt){throw eg!==null&&(eg=eg.slice(a+1)),ac(fc,jg),rt}finally{C$1=o,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(a,o){kg[lg++]=ng,kg[lg++]=mg,mg=a,ng=o}function ug(a,o,_e){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=a;var tt=rg;a=sg;var rt=32-oc(tt)-1;tt&=~(1<<rt),_e+=1;var st=32-oc(o)+rt;if(30<st){var at=rt-rt%5;st=(tt&(1<<at)-1).toString(32),tt>>=at,rt-=at,rg=1<<32-oc(o)+rt|_e<<rt|tt,sg=st+a}else rg=1<<st|_e<<rt|tt,sg=a}function vg(a){a.return!==null&&(tg(a,1),ug(a,1,0))}function wg(a){for(;a===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;a===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$2=!1,zg=null;function Ag(a,o){var _e=Bg(5,null,null,0);_e.elementType="DELETED",_e.stateNode=o,_e.return=a,o=a.deletions,o===null?(a.deletions=[_e],a.flags|=16):o.push(_e)}function Cg(a,o){switch(a.tag){case 5:var _e=a.type;return o=o.nodeType!==1||_e.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(a.stateNode=o,xg=a,yg=Lf(o.firstChild),!0):!1;case 6:return o=a.pendingProps===""||o.nodeType!==3?null:o,o!==null?(a.stateNode=o,xg=a,yg=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(_e=qg!==null?{id:rg,overflow:sg}:null,a.memoizedState={dehydrated:o,treeContext:_e,retryLane:1073741824},_e=Bg(18,null,null,0),_e.stateNode=o,_e.return=a,a.child=_e,xg=a,yg=null,!0):!1;default:return!1}}function Dg(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Eg(a){if(I$2){var o=yg;if(o){var _e=o;if(!Cg(a,o)){if(Dg(a))throw Error(p$2(418));o=Lf(_e.nextSibling);var tt=xg;o&&Cg(a,o)?Ag(tt,_e):(a.flags=a.flags&-4097|2,I$2=!1,xg=a)}}else{if(Dg(a))throw Error(p$2(418));a.flags=a.flags&-4097|2,I$2=!1,xg=a}}}function Fg(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;xg=a}function Gg(a){if(a!==xg)return!1;if(!I$2)return Fg(a),I$2=!0,!1;var o;if((o=a.tag!==3)&&!(o=a.tag!==5)&&(o=a.type,o=o!=="head"&&o!=="body"&&!Ef(a.type,a.memoizedProps)),o&&(o=yg)){if(Dg(a))throw Hg(),Error(p$2(418));for(;o;)Ag(a,o),o=Lf(o.nextSibling)}if(Fg(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(p$2(317));e:{for(a=a.nextSibling,o=0;a;){if(a.nodeType===8){var _e=a.data;if(_e==="/$"){if(o===0){yg=Lf(a.nextSibling);break e}o--}else _e!=="$"&&_e!=="$!"&&_e!=="$?"||o++}a=a.nextSibling}yg=null}}else yg=xg?Lf(a.stateNode.nextSibling):null;return!0}function Hg(){for(var a=yg;a;)a=Lf(a.nextSibling)}function Ig(){yg=xg=null,I$2=!1}function Jg(a){zg===null?zg=[a]:zg.push(a)}var Kg=ua$1.ReactCurrentBatchConfig;function Lg(a,o){if(a&&a.defaultProps){o=A$3({},o),a=a.defaultProps;for(var _e in a)o[_e]===void 0&&(o[_e]=a[_e]);return o}return o}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(a){var o=Mg.current;E$1(Mg),a._currentValue=o}function Sg(a,o,_e){for(;a!==null;){var tt=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,tt!==null&&(tt.childLanes|=o)):tt!==null&&(tt.childLanes&o)!==o&&(tt.childLanes|=o),a===_e)break;a=a.return}}function Tg(a,o){Ng=a,Pg=Og=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&o&&(Ug=!0),a.firstContext=null)}function Vg(a){var o=a._currentValue;if(Pg!==a)if(a={context:a,memoizedValue:o,next:null},Og===null){if(Ng===null)throw Error(p$2(308));Og=a,Ng.dependencies={lanes:0,firstContext:a}}else Og=Og.next=a;return o}var Wg=null;function Xg(a){Wg===null?Wg=[a]:Wg.push(a)}function Yg(a,o,_e,tt){var rt=o.interleaved;return rt===null?(_e.next=_e,Xg(o)):(_e.next=rt.next,rt.next=_e),o.interleaved=_e,Zg(a,tt)}function Zg(a,o){a.lanes|=o;var _e=a.alternate;for(_e!==null&&(_e.lanes|=o),_e=a,a=a.return;a!==null;)a.childLanes|=o,_e=a.alternate,_e!==null&&(_e.childLanes|=o),_e=a,a=a.return;return _e.tag===3?_e.stateNode:null}var $g=!1;function ah(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ch(a,o){return{eventTime:a,lane:o,tag:0,payload:null,callback:null,next:null}}function dh(a,o,_e){var tt=a.updateQueue;if(tt===null)return null;if(tt=tt.shared,K$1&2){var rt=tt.pending;return rt===null?o.next=o:(o.next=rt.next,rt.next=o),tt.pending=o,Zg(a,_e)}return rt=tt.interleaved,rt===null?(o.next=o,Xg(tt)):(o.next=rt.next,rt.next=o),tt.interleaved=o,Zg(a,_e)}function eh(a,o,_e){if(o=o.updateQueue,o!==null&&(o=o.shared,(_e&4194240)!==0)){var tt=o.lanes;tt&=a.pendingLanes,_e|=tt,o.lanes=_e,Cc(a,_e)}}function fh(a,o){var _e=a.updateQueue,tt=a.alternate;if(tt!==null&&(tt=tt.updateQueue,_e===tt)){var rt=null,st=null;if(_e=_e.firstBaseUpdate,_e!==null){do{var at={eventTime:_e.eventTime,lane:_e.lane,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null};st===null?rt=st=at:st=st.next=at,_e=_e.next}while(_e!==null);st===null?rt=st=o:st=st.next=o}else rt=st=o;_e={baseState:tt.baseState,firstBaseUpdate:rt,lastBaseUpdate:st,shared:tt.shared,effects:tt.effects},a.updateQueue=_e;return}a=_e.lastBaseUpdate,a===null?_e.firstBaseUpdate=o:a.next=o,_e.lastBaseUpdate=o}function gh(a,o,_e,tt){var rt=a.updateQueue;$g=!1;var st=rt.firstBaseUpdate,at=rt.lastBaseUpdate,ut=rt.shared.pending;if(ut!==null){rt.shared.pending=null;var s=ut,et=s.next;s.next=null,at===null?st=et:at.next=et,at=s;var ot=a.alternate;ot!==null&&(ot=ot.updateQueue,ut=ot.lastBaseUpdate,ut!==at&&(ut===null?ot.firstBaseUpdate=et:ut.next=et,ot.lastBaseUpdate=s))}if(st!==null){var lt=rt.baseState;at=0,ot=et=s=null,ut=st;do{var St=ut.lane,pt=ut.eventTime;if((tt&St)===St){ot!==null&&(ot=ot.next={eventTime:pt,lane:0,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null});e:{var gt=a,ct=ut;switch(St=o,pt=_e,ct.tag){case 1:if(gt=ct.payload,typeof gt=="function"){lt=gt.call(pt,lt,St);break e}lt=gt;break e;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=ct.payload,St=typeof gt=="function"?gt.call(pt,lt,St):gt,St==null)break e;lt=A$3({},lt,St);break e;case 2:$g=!0}}ut.callback!==null&&ut.lane!==0&&(a.flags|=64,St=rt.effects,St===null?rt.effects=[ut]:St.push(ut))}else pt={eventTime:pt,lane:St,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null},ot===null?(et=ot=pt,s=lt):ot=ot.next=pt,at|=St;if(ut=ut.next,ut===null){if(ut=rt.shared.pending,ut===null)break;St=ut,ut=St.next,St.next=null,rt.lastBaseUpdate=St,rt.shared.pending=null}}while(1);if(ot===null&&(s=lt),rt.baseState=s,rt.firstBaseUpdate=et,rt.lastBaseUpdate=ot,o=rt.shared.interleaved,o!==null){rt=o;do at|=rt.lane,rt=rt.next;while(rt!==o)}else st===null&&(rt.shared.lanes=0);hh|=at,a.lanes=at,a.memoizedState=lt}}function ih(a,o,_e){if(a=o.effects,o.effects=null,a!==null)for(o=0;o<a.length;o++){var tt=a[o],rt=tt.callback;if(rt!==null){if(tt.callback=null,tt=_e,typeof rt!="function")throw Error(p$2(191,rt));rt.call(tt)}}}var jh=new aa.Component().refs;function kh(a,o,_e,tt){o=a.memoizedState,_e=_e(tt,o),_e=_e==null?o:A$3({},o,_e),a.memoizedState=_e,a.lanes===0&&(a.updateQueue.baseState=_e)}var nh={isMounted:function(a){return(a=a._reactInternals)?Vb(a)===a:!1},enqueueSetState:function(a,o,_e){a=a._reactInternals;var tt=L(),rt=lh(a),st=ch(tt,rt);st.payload=o,_e!=null&&(st.callback=_e),o=dh(a,st,rt),o!==null&&(mh(o,a,rt,tt),eh(o,a,rt))},enqueueReplaceState:function(a,o,_e){a=a._reactInternals;var tt=L(),rt=lh(a),st=ch(tt,rt);st.tag=1,st.payload=o,_e!=null&&(st.callback=_e),o=dh(a,st,rt),o!==null&&(mh(o,a,rt,tt),eh(o,a,rt))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var _e=L(),tt=lh(a),rt=ch(_e,tt);rt.tag=2,o!=null&&(rt.callback=o),o=dh(a,rt,tt),o!==null&&(mh(o,a,tt,_e),eh(o,a,tt))}};function oh(a,o,_e,tt,rt,st,at){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(tt,st,at):o.prototype&&o.prototype.isPureReactComponent?!Ie(_e,tt)||!Ie(rt,st):!0}function ph(a,o,_e){var tt=!1,rt=Vf,st=o.contextType;return typeof st=="object"&&st!==null?st=Vg(st):(rt=Zf(o)?Xf:H.current,tt=o.contextTypes,st=(tt=tt!=null)?Yf(a,rt):Vf),o=new o(_e,st),a.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=nh,a.stateNode=o,o._reactInternals=a,tt&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=rt,a.__reactInternalMemoizedMaskedChildContext=st),o}function qh(a,o,_e,tt){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(_e,tt),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(_e,tt),o.state!==a&&nh.enqueueReplaceState(o,o.state,null)}function rh(a,o,_e,tt){var rt=a.stateNode;rt.props=_e,rt.state=a.memoizedState,rt.refs=jh,ah(a);var st=o.contextType;typeof st=="object"&&st!==null?rt.context=Vg(st):(st=Zf(o)?Xf:H.current,rt.context=Yf(a,st)),rt.state=a.memoizedState,st=o.getDerivedStateFromProps,typeof st=="function"&&(kh(a,o,st,_e),rt.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof rt.getSnapshotBeforeUpdate=="function"||typeof rt.UNSAFE_componentWillMount!="function"&&typeof rt.componentWillMount!="function"||(o=rt.state,typeof rt.componentWillMount=="function"&&rt.componentWillMount(),typeof rt.UNSAFE_componentWillMount=="function"&&rt.UNSAFE_componentWillMount(),o!==rt.state&&nh.enqueueReplaceState(rt,rt.state,null),gh(a,_e,rt,tt),rt.state=a.memoizedState),typeof rt.componentDidMount=="function"&&(a.flags|=4194308)}function sh(a,o,_e){if(a=_e.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(_e._owner){if(_e=_e._owner,_e){if(_e.tag!==1)throw Error(p$2(309));var tt=_e.stateNode}if(!tt)throw Error(p$2(147,a));var rt=tt,st=""+a;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===st?o.ref:(o=function(at){var ut=rt.refs;ut===jh&&(ut=rt.refs={}),at===null?delete ut[st]:ut[st]=at},o._stringRef=st,o)}if(typeof a!="string")throw Error(p$2(284));if(!_e._owner)throw Error(p$2(290,a))}return a}function th(a,o){throw a=Object.prototype.toString.call(o),Error(p$2(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a))}function uh(a){var o=a._init;return o(a._payload)}function vh(a){function o(it,ft){if(a){var mt=it.deletions;mt===null?(it.deletions=[ft],it.flags|=16):mt.push(ft)}}function _e(it,ft){if(!a)return null;for(;ft!==null;)o(it,ft),ft=ft.sibling;return null}function tt(it,ft){for(it=new Map;ft!==null;)ft.key!==null?it.set(ft.key,ft):it.set(ft.index,ft),ft=ft.sibling;return it}function rt(it,ft){return it=wh(it,ft),it.index=0,it.sibling=null,it}function st(it,ft,mt){return it.index=mt,a?(mt=it.alternate,mt!==null?(mt=mt.index,mt<ft?(it.flags|=2,ft):mt):(it.flags|=2,ft)):(it.flags|=1048576,ft)}function at(it){return a&&it.alternate===null&&(it.flags|=2),it}function ut(it,ft,mt,Tt){return ft===null||ft.tag!==6?(ft=xh(mt,it.mode,Tt),ft.return=it,ft):(ft=rt(ft,mt),ft.return=it,ft)}function s(it,ft,mt,Tt){var It=mt.type;return It===ya?ot(it,ft,mt.props.children,Tt,mt.key):ft!==null&&(ft.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Ha&&uh(It)===ft.type)?(Tt=rt(ft,mt.props),Tt.ref=sh(it,ft,mt),Tt.return=it,Tt):(Tt=yh(mt.type,mt.key,mt.props,null,it.mode,Tt),Tt.ref=sh(it,ft,mt),Tt.return=it,Tt)}function et(it,ft,mt,Tt){return ft===null||ft.tag!==4||ft.stateNode.containerInfo!==mt.containerInfo||ft.stateNode.implementation!==mt.implementation?(ft=zh(mt,it.mode,Tt),ft.return=it,ft):(ft=rt(ft,mt.children||[]),ft.return=it,ft)}function ot(it,ft,mt,Tt,It){return ft===null||ft.tag!==7?(ft=Ah(mt,it.mode,Tt,It),ft.return=it,ft):(ft=rt(ft,mt),ft.return=it,ft)}function lt(it,ft,mt){if(typeof ft=="string"&&ft!==""||typeof ft=="number")return ft=xh(""+ft,it.mode,mt),ft.return=it,ft;if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case va:return mt=yh(ft.type,ft.key,ft.props,null,it.mode,mt),mt.ref=sh(it,null,ft),mt.return=it,mt;case wa:return ft=zh(ft,it.mode,mt),ft.return=it,ft;case Ha:var Tt=ft._init;return lt(it,Tt(ft._payload),mt)}if(eb(ft)||Ka(ft))return ft=Ah(ft,it.mode,mt,null),ft.return=it,ft;th(it,ft)}return null}function St(it,ft,mt,Tt){var It=ft!==null?ft.key:null;if(typeof mt=="string"&&mt!==""||typeof mt=="number")return It!==null?null:ut(it,ft,""+mt,Tt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:return mt.key===It?s(it,ft,mt,Tt):null;case wa:return mt.key===It?et(it,ft,mt,Tt):null;case Ha:return It=mt._init,St(it,ft,It(mt._payload),Tt)}if(eb(mt)||Ka(mt))return It!==null?null:ot(it,ft,mt,Tt,null);th(it,mt)}return null}function pt(it,ft,mt,Tt,It){if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return it=it.get(mt)||null,ut(ft,it,""+Tt,It);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case va:return it=it.get(Tt.key===null?mt:Tt.key)||null,s(ft,it,Tt,It);case wa:return it=it.get(Tt.key===null?mt:Tt.key)||null,et(ft,it,Tt,It);case Ha:var Pt=Tt._init;return pt(it,ft,mt,Pt(Tt._payload),It)}if(eb(Tt)||Ka(Tt))return it=it.get(mt)||null,ot(ft,it,Tt,It,null);th(ft,Tt)}return null}function gt(it,ft,mt,Tt){for(var It=null,Pt=null,At=ft,Nt=ft=0,Ot=null;At!==null&&Nt<mt.length;Nt++){At.index>Nt?(Ot=At,At=null):Ot=At.sibling;var Mt=St(it,At,mt[Nt],Tt);if(Mt===null){At===null&&(At=Ot);break}a&&At&&Mt.alternate===null&&o(it,At),ft=st(Mt,ft,Nt),Pt===null?It=Mt:Pt.sibling=Mt,Pt=Mt,At=Ot}if(Nt===mt.length)return _e(it,At),I$2&&tg(it,Nt),It;if(At===null){for(;Nt<mt.length;Nt++)At=lt(it,mt[Nt],Tt),At!==null&&(ft=st(At,ft,Nt),Pt===null?It=At:Pt.sibling=At,Pt=At);return I$2&&tg(it,Nt),It}for(At=tt(it,At);Nt<mt.length;Nt++)Ot=pt(At,it,Nt,mt[Nt],Tt),Ot!==null&&(a&&Ot.alternate!==null&&At.delete(Ot.key===null?Nt:Ot.key),ft=st(Ot,ft,Nt),Pt===null?It=Ot:Pt.sibling=Ot,Pt=Ot);return a&&At.forEach(function(bt){return o(it,bt)}),I$2&&tg(it,Nt),It}function ct(it,ft,mt,Tt){var It=Ka(mt);if(typeof It!="function")throw Error(p$2(150));if(mt=It.call(mt),mt==null)throw Error(p$2(151));for(var Pt=It=null,At=ft,Nt=ft=0,Ot=null,Mt=mt.next();At!==null&&!Mt.done;Nt++,Mt=mt.next()){At.index>Nt?(Ot=At,At=null):Ot=At.sibling;var bt=St(it,At,Mt.value,Tt);if(bt===null){At===null&&(At=Ot);break}a&&At&&bt.alternate===null&&o(it,At),ft=st(bt,ft,Nt),Pt===null?It=bt:Pt.sibling=bt,Pt=bt,At=Ot}if(Mt.done)return _e(it,At),I$2&&tg(it,Nt),It;if(At===null){for(;!Mt.done;Nt++,Mt=mt.next())Mt=lt(it,Mt.value,Tt),Mt!==null&&(ft=st(Mt,ft,Nt),Pt===null?It=Mt:Pt.sibling=Mt,Pt=Mt);return I$2&&tg(it,Nt),It}for(At=tt(it,At);!Mt.done;Nt++,Mt=mt.next())Mt=pt(At,it,Nt,Mt.value,Tt),Mt!==null&&(a&&Mt.alternate!==null&&At.delete(Mt.key===null?Nt:Mt.key),ft=st(Mt,ft,Nt),Pt===null?It=Mt:Pt.sibling=Mt,Pt=Mt);return a&&At.forEach(function(Wt){return o(it,Wt)}),I$2&&tg(it,Nt),It}function ht(it,ft,mt,Tt){if(typeof mt=="object"&&mt!==null&&mt.type===ya&&mt.key===null&&(mt=mt.props.children),typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:e:{for(var It=mt.key,Pt=ft;Pt!==null;){if(Pt.key===It){if(It=mt.type,It===ya){if(Pt.tag===7){_e(it,Pt.sibling),ft=rt(Pt,mt.props.children),ft.return=it,it=ft;break e}}else if(Pt.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Ha&&uh(It)===Pt.type){_e(it,Pt.sibling),ft=rt(Pt,mt.props),ft.ref=sh(it,Pt,mt),ft.return=it,it=ft;break e}_e(it,Pt);break}else o(it,Pt);Pt=Pt.sibling}mt.type===ya?(ft=Ah(mt.props.children,it.mode,Tt,mt.key),ft.return=it,it=ft):(Tt=yh(mt.type,mt.key,mt.props,null,it.mode,Tt),Tt.ref=sh(it,ft,mt),Tt.return=it,it=Tt)}return at(it);case wa:e:{for(Pt=mt.key;ft!==null;){if(ft.key===Pt)if(ft.tag===4&&ft.stateNode.containerInfo===mt.containerInfo&&ft.stateNode.implementation===mt.implementation){_e(it,ft.sibling),ft=rt(ft,mt.children||[]),ft.return=it,it=ft;break e}else{_e(it,ft);break}else o(it,ft);ft=ft.sibling}ft=zh(mt,it.mode,Tt),ft.return=it,it=ft}return at(it);case Ha:return Pt=mt._init,ht(it,ft,Pt(mt._payload),Tt)}if(eb(mt))return gt(it,ft,mt,Tt);if(Ka(mt))return ct(it,ft,mt,Tt);th(it,mt)}return typeof mt=="string"&&mt!==""||typeof mt=="number"?(mt=""+mt,ft!==null&&ft.tag===6?(_e(it,ft.sibling),ft=rt(ft,mt),ft.return=it,it=ft):(_e(it,ft),ft=xh(mt,it.mode,Tt),ft.return=it,it=ft),at(it)):_e(it,ft)}return ht}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(a){if(a===Dh)throw Error(p$2(174));return a}function Ih(a,o){switch(G$1(Gh,o),G$1(Fh,a),G$1(Eh,Dh),a=o.nodeType,a){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:lb(null,"");break;default:a=a===8?o.parentNode:o,o=a.namespaceURI||null,a=a.tagName,o=lb(o,a)}E$1(Eh),G$1(Eh,o)}function Jh(){E$1(Eh),E$1(Fh),E$1(Gh)}function Kh(a){Hh(Gh.current);var o=Hh(Eh.current),_e=lb(o,a.type);o!==_e&&(G$1(Fh,a),G$1(Eh,_e))}function Lh(a){Fh.current===a&&(E$1(Eh),E$1(Fh))}var M$1=Uf(0);function Mh(a){for(var o=a;o!==null;){if(o.tag===13){var _e=o.memoizedState;if(_e!==null&&(_e=_e.dehydrated,_e===null||_e.data==="$?"||_e.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Nh=[];function Oh(){for(var a=0;a<Nh.length;a++)Nh[a]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua$1.ReactCurrentDispatcher,Qh=ua$1.ReactCurrentBatchConfig,Rh=0,N$2=null,O$1=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q$1(){throw Error(p$2(321))}function Wh(a,o){if(o===null)return!1;for(var _e=0;_e<o.length&&_e<a.length;_e++)if(!He(a[_e],o[_e]))return!1;return!0}function Xh(a,o,_e,tt,rt,st){if(Rh=st,N$2=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ph.current=a===null||a.memoizedState===null?Yh:Zh,a=_e(tt,rt),Th){st=0;do{if(Th=!1,Uh=0,25<=st)throw Error(p$2(301));st+=1,P=O$1=null,o.updateQueue=null,Ph.current=$h,a=_e(tt,rt)}while(Th)}if(Ph.current=ai,o=O$1!==null&&O$1.next!==null,Rh=0,P=O$1=N$2=null,Sh=!1,o)throw Error(p$2(300));return a}function bi(){var a=Uh!==0;return Uh=0,a}function ci(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N$2.memoizedState=P=a:P=P.next=a,P}function di(){if(O$1===null){var a=N$2.alternate;a=a!==null?a.memoizedState:null}else a=O$1.next;var o=P===null?N$2.memoizedState:P.next;if(o!==null)P=o,O$1=a;else{if(a===null)throw Error(p$2(310));O$1=a,a={memoizedState:O$1.memoizedState,baseState:O$1.baseState,baseQueue:O$1.baseQueue,queue:O$1.queue,next:null},P===null?N$2.memoizedState=P=a:P=P.next=a}return P}function ei(a,o){return typeof o=="function"?o(a):o}function fi(a){var o=di(),_e=o.queue;if(_e===null)throw Error(p$2(311));_e.lastRenderedReducer=a;var tt=O$1,rt=tt.baseQueue,st=_e.pending;if(st!==null){if(rt!==null){var at=rt.next;rt.next=st.next,st.next=at}tt.baseQueue=rt=st,_e.pending=null}if(rt!==null){st=rt.next,tt=tt.baseState;var ut=at=null,s=null,et=st;do{var ot=et.lane;if((Rh&ot)===ot)s!==null&&(s=s.next={lane:0,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),tt=et.hasEagerState?et.eagerState:a(tt,et.action);else{var lt={lane:ot,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null};s===null?(ut=s=lt,at=tt):s=s.next=lt,N$2.lanes|=ot,hh|=ot}et=et.next}while(et!==null&&et!==st);s===null?at=tt:s.next=ut,He(tt,o.memoizedState)||(Ug=!0),o.memoizedState=tt,o.baseState=at,o.baseQueue=s,_e.lastRenderedState=tt}if(a=_e.interleaved,a!==null){rt=a;do st=rt.lane,N$2.lanes|=st,hh|=st,rt=rt.next;while(rt!==a)}else rt===null&&(_e.lanes=0);return[o.memoizedState,_e.dispatch]}function gi(a){var o=di(),_e=o.queue;if(_e===null)throw Error(p$2(311));_e.lastRenderedReducer=a;var tt=_e.dispatch,rt=_e.pending,st=o.memoizedState;if(rt!==null){_e.pending=null;var at=rt=rt.next;do st=a(st,at.action),at=at.next;while(at!==rt);He(st,o.memoizedState)||(Ug=!0),o.memoizedState=st,o.baseQueue===null&&(o.baseState=st),_e.lastRenderedState=st}return[st,tt]}function hi(){}function ii(a,o){var _e=N$2,tt=di(),rt=o(),st=!He(tt.memoizedState,rt);if(st&&(tt.memoizedState=rt,Ug=!0),tt=tt.queue,ji(ki.bind(null,_e,tt,a),[a]),tt.getSnapshot!==o||st||P!==null&&P.memoizedState.tag&1){if(_e.flags|=2048,li(9,mi.bind(null,_e,tt,rt,o),void 0,null),R===null)throw Error(p$2(349));Rh&30||ni(_e,o,rt)}return rt}function ni(a,o,_e){a.flags|=16384,a={getSnapshot:o,value:_e},o=N$2.updateQueue,o===null?(o={lastEffect:null,stores:null},N$2.updateQueue=o,o.stores=[a]):(_e=o.stores,_e===null?o.stores=[a]:_e.push(a))}function mi(a,o,_e,tt){o.value=_e,o.getSnapshot=tt,oi(o)&&pi(a)}function ki(a,o,_e){return _e(function(){oi(o)&&pi(a)})}function oi(a){var o=a.getSnapshot;a=a.value;try{var _e=o();return!He(a,_e)}catch{return!0}}function pi(a){var o=Zg(a,1);o!==null&&mh(o,a,1,-1)}function qi(a){var o=ci();return typeof a=="function"&&(a=a()),o.memoizedState=o.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:a},o.queue=a,a=a.dispatch=ri.bind(null,N$2,a),[o.memoizedState,a]}function li(a,o,_e,tt){return a={tag:a,create:o,destroy:_e,deps:tt,next:null},o=N$2.updateQueue,o===null?(o={lastEffect:null,stores:null},N$2.updateQueue=o,o.lastEffect=a.next=a):(_e=o.lastEffect,_e===null?o.lastEffect=a.next=a:(tt=_e.next,_e.next=a,a.next=tt,o.lastEffect=a)),a}function si(){return di().memoizedState}function ti(a,o,_e,tt){var rt=ci();N$2.flags|=a,rt.memoizedState=li(1|o,_e,void 0,tt===void 0?null:tt)}function ui(a,o,_e,tt){var rt=di();tt=tt===void 0?null:tt;var st=void 0;if(O$1!==null){var at=O$1.memoizedState;if(st=at.destroy,tt!==null&&Wh(tt,at.deps)){rt.memoizedState=li(o,_e,st,tt);return}}N$2.flags|=a,rt.memoizedState=li(1|o,_e,st,tt)}function vi(a,o){return ti(8390656,8,a,o)}function ji(a,o){return ui(2048,8,a,o)}function wi(a,o){return ui(4,2,a,o)}function xi(a,o){return ui(4,4,a,o)}function yi(a,o){if(typeof o=="function")return a=a(),o(a),function(){o(null)};if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function zi(a,o,_e){return _e=_e!=null?_e.concat([a]):null,ui(4,4,yi.bind(null,o,a),_e)}function Ai(){}function Bi(a,o){var _e=di();o=o===void 0?null:o;var tt=_e.memoizedState;return tt!==null&&o!==null&&Wh(o,tt[1])?tt[0]:(_e.memoizedState=[a,o],a)}function Ci(a,o){var _e=di();o=o===void 0?null:o;var tt=_e.memoizedState;return tt!==null&&o!==null&&Wh(o,tt[1])?tt[0]:(a=a(),_e.memoizedState=[a,o],a)}function Di(a,o,_e){return Rh&21?(He(_e,o)||(_e=yc(),N$2.lanes|=_e,hh|=_e,a.baseState=!0),o):(a.baseState&&(a.baseState=!1,Ug=!0),a.memoizedState=_e)}function Ei(a,o){var _e=C$1;C$1=_e!==0&&4>_e?_e:4,a(!0);var tt=Qh.transition;Qh.transition={};try{a(!1),o()}finally{C$1=_e,Qh.transition=tt}}function Fi(){return di().memoizedState}function Gi(a,o,_e){var tt=lh(a);if(_e={lane:tt,action:_e,hasEagerState:!1,eagerState:null,next:null},Hi(a))Ii(o,_e);else if(_e=Yg(a,o,_e,tt),_e!==null){var rt=L();mh(_e,a,tt,rt),Ji(_e,o,tt)}}function ri(a,o,_e){var tt=lh(a),rt={lane:tt,action:_e,hasEagerState:!1,eagerState:null,next:null};if(Hi(a))Ii(o,rt);else{var st=a.alternate;if(a.lanes===0&&(st===null||st.lanes===0)&&(st=o.lastRenderedReducer,st!==null))try{var at=o.lastRenderedState,ut=st(at,_e);if(rt.hasEagerState=!0,rt.eagerState=ut,He(ut,at)){var s=o.interleaved;s===null?(rt.next=rt,Xg(o)):(rt.next=s.next,s.next=rt),o.interleaved=rt;return}}catch{}finally{}_e=Yg(a,o,rt,tt),_e!==null&&(rt=L(),mh(_e,a,tt,rt),Ji(_e,o,tt))}}function Hi(a){var o=a.alternate;return a===N$2||o!==null&&o===N$2}function Ii(a,o){Th=Sh=!0;var _e=a.pending;_e===null?o.next=o:(o.next=_e.next,_e.next=o),a.pending=o}function Ji(a,o,_e){if(_e&4194240){var tt=o.lanes;tt&=a.pendingLanes,_e|=tt,o.lanes=_e,Cc(a,_e)}}var ai={readContext:Vg,useCallback:Q$1,useContext:Q$1,useEffect:Q$1,useImperativeHandle:Q$1,useInsertionEffect:Q$1,useLayoutEffect:Q$1,useMemo:Q$1,useReducer:Q$1,useRef:Q$1,useState:Q$1,useDebugValue:Q$1,useDeferredValue:Q$1,useTransition:Q$1,useMutableSource:Q$1,useSyncExternalStore:Q$1,useId:Q$1,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(a,o){return ci().memoizedState=[a,o===void 0?null:o],a},useContext:Vg,useEffect:vi,useImperativeHandle:function(a,o,_e){return _e=_e!=null?_e.concat([a]):null,ti(4194308,4,yi.bind(null,o,a),_e)},useLayoutEffect:function(a,o){return ti(4194308,4,a,o)},useInsertionEffect:function(a,o){return ti(4,2,a,o)},useMemo:function(a,o){var _e=ci();return o=o===void 0?null:o,a=a(),_e.memoizedState=[a,o],a},useReducer:function(a,o,_e){var tt=ci();return o=_e!==void 0?_e(o):o,tt.memoizedState=tt.baseState=o,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:o},tt.queue=a,a=a.dispatch=Gi.bind(null,N$2,a),[tt.memoizedState,a]},useRef:function(a){var o=ci();return a={current:a},o.memoizedState=a},useState:qi,useDebugValue:Ai,useDeferredValue:function(a){return ci().memoizedState=a},useTransition:function(){var a=qi(!1),o=a[0];return a=Ei.bind(null,a[1]),ci().memoizedState=a,[o,a]},useMutableSource:function(){},useSyncExternalStore:function(a,o,_e){var tt=N$2,rt=ci();if(I$2){if(_e===void 0)throw Error(p$2(407));_e=_e()}else{if(_e=o(),R===null)throw Error(p$2(349));Rh&30||ni(tt,o,_e)}rt.memoizedState=_e;var st={value:_e,getSnapshot:o};return rt.queue=st,vi(ki.bind(null,tt,st,a),[a]),tt.flags|=2048,li(9,mi.bind(null,tt,st,_e,o),void 0,null),_e},useId:function(){var a=ci(),o=R.identifierPrefix;if(I$2){var _e=sg,tt=rg;_e=(tt&~(1<<32-oc(tt)-1)).toString(32)+_e,o=":"+o+"R"+_e,_e=Uh++,0<_e&&(o+="H"+_e.toString(32)),o+=":"}else _e=Vh++,o=":"+o+"r"+_e.toString(32)+":";return a.memoizedState=o},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(a){var o=di();return Di(o,O$1.memoizedState,a)},useTransition:function(){var a=fi(ei)[0],o=di().memoizedState;return[a,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(a){var o=di();return O$1===null?o.memoizedState=a:Di(o,O$1.memoizedState,a)},useTransition:function(){var a=gi(ei)[0],o=di().memoizedState;return[a,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(a,o){try{var _e="",tt=o;do _e+=Pa(tt),tt=tt.return;while(tt);var rt=_e}catch(st){rt=`
Error generating stack: `+st.message+`
`+st.stack}return{value:a,source:o,stack:rt,digest:null}}function Li(a,o,_e){return{value:a,source:null,stack:_e??null,digest:o??null}}function Mi(a,o){try{console.error(o.value)}catch(_e){setTimeout(function(){throw _e})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(a,o,_e){_e=ch(-1,_e),_e.tag=3,_e.payload={element:null};var tt=o.value;return _e.callback=function(){Pi||(Pi=!0,Qi=tt),Mi(a,o)},_e}function Ri(a,o,_e){_e=ch(-1,_e),_e.tag=3;var tt=a.type.getDerivedStateFromError;if(typeof tt=="function"){var rt=o.value;_e.payload=function(){return tt(rt)},_e.callback=function(){Mi(a,o)}}var st=a.stateNode;return st!==null&&typeof st.componentDidCatch=="function"&&(_e.callback=function(){Mi(a,o),typeof tt!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var at=o.stack;this.componentDidCatch(o.value,{componentStack:at!==null?at:""})}),_e}function Ti(a,o,_e){var tt=a.pingCache;if(tt===null){tt=a.pingCache=new Ni;var rt=new Set;tt.set(o,rt)}else rt=tt.get(o),rt===void 0&&(rt=new Set,tt.set(o,rt));rt.has(_e)||(rt.add(_e),a=Ui.bind(null,a,o,_e),o.then(a,a))}function Vi(a){do{var o;if((o=a.tag===13)&&(o=a.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return a;a=a.return}while(a!==null);return null}function Wi(a,o,_e,tt,rt){return a.mode&1?(a.flags|=65536,a.lanes=rt,a):(a===o?a.flags|=65536:(a.flags|=128,_e.flags|=131072,_e.flags&=-52805,_e.tag===1&&(_e.alternate===null?_e.tag=17:(o=ch(-1,1),o.tag=2,dh(_e,o,1))),_e.lanes|=1),a)}var Xi=ua$1.ReactCurrentOwner,Ug=!1;function Yi(a,o,_e,tt){o.child=a===null?Ch(o,null,_e,tt):Bh(o,a.child,_e,tt)}function Zi(a,o,_e,tt,rt){_e=_e.render;var st=o.ref;return Tg(o,rt),tt=Xh(a,o,_e,tt,st,rt),_e=bi(),a!==null&&!Ug?(o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~rt,$i(a,o,rt)):(I$2&&_e&&vg(o),o.flags|=1,Yi(a,o,tt,rt),o.child)}function aj(a,o,_e,tt,rt){if(a===null){var st=_e.type;return typeof st=="function"&&!bj(st)&&st.defaultProps===void 0&&_e.compare===null&&_e.defaultProps===void 0?(o.tag=15,o.type=st,cj(a,o,st,tt,rt)):(a=yh(_e.type,null,tt,o,o.mode,rt),a.ref=o.ref,a.return=o,o.child=a)}if(st=a.child,!(a.lanes&rt)){var at=st.memoizedProps;if(_e=_e.compare,_e=_e!==null?_e:Ie,_e(at,tt)&&a.ref===o.ref)return $i(a,o,rt)}return o.flags|=1,a=wh(st,tt),a.ref=o.ref,a.return=o,o.child=a}function cj(a,o,_e,tt,rt){if(a!==null){var st=a.memoizedProps;if(Ie(st,tt)&&a.ref===o.ref)if(Ug=!1,o.pendingProps=tt=st,(a.lanes&rt)!==0)a.flags&131072&&(Ug=!0);else return o.lanes=a.lanes,$i(a,o,rt)}return dj(a,o,_e,tt,rt)}function ej(a,o,_e){var tt=o.pendingProps,rt=tt.children,st=a!==null?a.memoizedState:null;if(tt.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(fj,gj),gj|=_e;else{if(!(_e&1073741824))return a=st!==null?st.baseLanes|_e:_e,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:a,cachePool:null,transitions:null},o.updateQueue=null,G$1(fj,gj),gj|=a,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt=st!==null?st.baseLanes:_e,G$1(fj,gj),gj|=tt}else st!==null?(tt=st.baseLanes|_e,o.memoizedState=null):tt=_e,G$1(fj,gj),gj|=tt;return Yi(a,o,rt,_e),o.child}function hj(a,o){var _e=o.ref;(a===null&&_e!==null||a!==null&&a.ref!==_e)&&(o.flags|=512,o.flags|=2097152)}function dj(a,o,_e,tt,rt){var st=Zf(_e)?Xf:H.current;return st=Yf(o,st),Tg(o,rt),_e=Xh(a,o,_e,tt,st,rt),tt=bi(),a!==null&&!Ug?(o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~rt,$i(a,o,rt)):(I$2&&tt&&vg(o),o.flags|=1,Yi(a,o,_e,rt),o.child)}function ij(a,o,_e,tt,rt){if(Zf(_e)){var st=!0;cg(o)}else st=!1;if(Tg(o,rt),o.stateNode===null)jj(a,o),ph(o,_e,tt),rh(o,_e,tt,rt),tt=!0;else if(a===null){var at=o.stateNode,ut=o.memoizedProps;at.props=ut;var s=at.context,et=_e.contextType;typeof et=="object"&&et!==null?et=Vg(et):(et=Zf(_e)?Xf:H.current,et=Yf(o,et));var ot=_e.getDerivedStateFromProps,lt=typeof ot=="function"||typeof at.getSnapshotBeforeUpdate=="function";lt||typeof at.UNSAFE_componentWillReceiveProps!="function"&&typeof at.componentWillReceiveProps!="function"||(ut!==tt||s!==et)&&qh(o,at,tt,et),$g=!1;var St=o.memoizedState;at.state=St,gh(o,tt,at,rt),s=o.memoizedState,ut!==tt||St!==s||Wf.current||$g?(typeof ot=="function"&&(kh(o,_e,ot,tt),s=o.memoizedState),(ut=$g||oh(o,_e,ut,tt,St,s,et))?(lt||typeof at.UNSAFE_componentWillMount!="function"&&typeof at.componentWillMount!="function"||(typeof at.componentWillMount=="function"&&at.componentWillMount(),typeof at.UNSAFE_componentWillMount=="function"&&at.UNSAFE_componentWillMount()),typeof at.componentDidMount=="function"&&(o.flags|=4194308)):(typeof at.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=tt,o.memoizedState=s),at.props=tt,at.state=s,at.context=et,tt=ut):(typeof at.componentDidMount=="function"&&(o.flags|=4194308),tt=!1)}else{at=o.stateNode,bh(a,o),ut=o.memoizedProps,et=o.type===o.elementType?ut:Lg(o.type,ut),at.props=et,lt=o.pendingProps,St=at.context,s=_e.contextType,typeof s=="object"&&s!==null?s=Vg(s):(s=Zf(_e)?Xf:H.current,s=Yf(o,s));var pt=_e.getDerivedStateFromProps;(ot=typeof pt=="function"||typeof at.getSnapshotBeforeUpdate=="function")||typeof at.UNSAFE_componentWillReceiveProps!="function"&&typeof at.componentWillReceiveProps!="function"||(ut!==lt||St!==s)&&qh(o,at,tt,s),$g=!1,St=o.memoizedState,at.state=St,gh(o,tt,at,rt);var gt=o.memoizedState;ut!==lt||St!==gt||Wf.current||$g?(typeof pt=="function"&&(kh(o,_e,pt,tt),gt=o.memoizedState),(et=$g||oh(o,_e,et,tt,St,gt,s)||!1)?(ot||typeof at.UNSAFE_componentWillUpdate!="function"&&typeof at.componentWillUpdate!="function"||(typeof at.componentWillUpdate=="function"&&at.componentWillUpdate(tt,gt,s),typeof at.UNSAFE_componentWillUpdate=="function"&&at.UNSAFE_componentWillUpdate(tt,gt,s)),typeof at.componentDidUpdate=="function"&&(o.flags|=4),typeof at.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof at.componentDidUpdate!="function"||ut===a.memoizedProps&&St===a.memoizedState||(o.flags|=4),typeof at.getSnapshotBeforeUpdate!="function"||ut===a.memoizedProps&&St===a.memoizedState||(o.flags|=1024),o.memoizedProps=tt,o.memoizedState=gt),at.props=tt,at.state=gt,at.context=s,tt=et):(typeof at.componentDidUpdate!="function"||ut===a.memoizedProps&&St===a.memoizedState||(o.flags|=4),typeof at.getSnapshotBeforeUpdate!="function"||ut===a.memoizedProps&&St===a.memoizedState||(o.flags|=1024),tt=!1)}return kj(a,o,_e,tt,st,rt)}function kj(a,o,_e,tt,rt,st){hj(a,o);var at=(o.flags&128)!==0;if(!tt&&!at)return rt&&dg(o,_e,!1),$i(a,o,st);tt=o.stateNode,Xi.current=o;var ut=at&&typeof _e.getDerivedStateFromError!="function"?null:tt.render();return o.flags|=1,a!==null&&at?(o.child=Bh(o,a.child,null,st),o.child=Bh(o,null,ut,st)):Yi(a,o,ut,st),o.memoizedState=tt.state,rt&&dg(o,_e,!0),o.child}function lj(a){var o=a.stateNode;o.pendingContext?ag(a,o.pendingContext,o.pendingContext!==o.context):o.context&&ag(a,o.context,!1),Ih(a,o.containerInfo)}function mj(a,o,_e,tt,rt){return Ig(),Jg(rt),o.flags|=256,Yi(a,o,_e,tt),o.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(a){return{baseLanes:a,cachePool:null,transitions:null}}function pj(a,o,_e){var tt=o.pendingProps,rt=M$1.current,st=!1,at=(o.flags&128)!==0,ut;if((ut=at)||(ut=a!==null&&a.memoizedState===null?!1:(rt&2)!==0),ut?(st=!0,o.flags&=-129):(a===null||a.memoizedState!==null)&&(rt|=1),G$1(M$1,rt&1),a===null)return Eg(o),a=o.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(o.mode&1?a.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(at=tt.children,a=tt.fallback,st?(tt=o.mode,st=o.child,at={mode:"hidden",children:at},!(tt&1)&&st!==null?(st.childLanes=0,st.pendingProps=at):st=qj(at,tt,0,null),a=Ah(a,tt,_e,null),st.return=o,a.return=o,st.sibling=a,o.child=st,o.child.memoizedState=oj(_e),o.memoizedState=nj,a):rj(o,at));if(rt=a.memoizedState,rt!==null&&(ut=rt.dehydrated,ut!==null))return sj(a,o,at,tt,ut,rt,_e);if(st){st=tt.fallback,at=o.mode,rt=a.child,ut=rt.sibling;var s={mode:"hidden",children:tt.children};return!(at&1)&&o.child!==rt?(tt=o.child,tt.childLanes=0,tt.pendingProps=s,o.deletions=null):(tt=wh(rt,s),tt.subtreeFlags=rt.subtreeFlags&14680064),ut!==null?st=wh(ut,st):(st=Ah(st,at,_e,null),st.flags|=2),st.return=o,tt.return=o,tt.sibling=st,o.child=tt,tt=st,st=o.child,at=a.child.memoizedState,at=at===null?oj(_e):{baseLanes:at.baseLanes|_e,cachePool:null,transitions:at.transitions},st.memoizedState=at,st.childLanes=a.childLanes&~_e,o.memoizedState=nj,tt}return st=a.child,a=st.sibling,tt=wh(st,{mode:"visible",children:tt.children}),!(o.mode&1)&&(tt.lanes=_e),tt.return=o,tt.sibling=null,a!==null&&(_e=o.deletions,_e===null?(o.deletions=[a],o.flags|=16):_e.push(a)),o.child=tt,o.memoizedState=null,tt}function rj(a,o){return o=qj({mode:"visible",children:o},a.mode,0,null),o.return=a,a.child=o}function tj(a,o,_e,tt){return tt!==null&&Jg(tt),Bh(o,a.child,null,_e),a=rj(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function sj(a,o,_e,tt,rt,st,at){if(_e)return o.flags&256?(o.flags&=-257,tt=Li(Error(p$2(422))),tj(a,o,at,tt)):o.memoizedState!==null?(o.child=a.child,o.flags|=128,null):(st=tt.fallback,rt=o.mode,tt=qj({mode:"visible",children:tt.children},rt,0,null),st=Ah(st,rt,at,null),st.flags|=2,tt.return=o,st.return=o,tt.sibling=st,o.child=tt,o.mode&1&&Bh(o,a.child,null,at),o.child.memoizedState=oj(at),o.memoizedState=nj,st);if(!(o.mode&1))return tj(a,o,at,null);if(rt.data==="$!"){if(tt=rt.nextSibling&&rt.nextSibling.dataset,tt)var ut=tt.dgst;return tt=ut,st=Error(p$2(419)),tt=Li(st,tt,void 0),tj(a,o,at,tt)}if(ut=(at&a.childLanes)!==0,Ug||ut){if(tt=R,tt!==null){switch(at&-at){case 4:rt=2;break;case 16:rt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:rt=32;break;case 536870912:rt=268435456;break;default:rt=0}rt=rt&(tt.suspendedLanes|at)?0:rt,rt!==0&&rt!==st.retryLane&&(st.retryLane=rt,Zg(a,rt),mh(tt,a,rt,-1))}return uj(),tt=Li(Error(p$2(421))),tj(a,o,at,tt)}return rt.data==="$?"?(o.flags|=128,o.child=a.child,o=vj.bind(null,a),rt._reactRetry=o,null):(a=st.treeContext,yg=Lf(rt.nextSibling),xg=o,I$2=!0,zg=null,a!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=a.id,sg=a.overflow,qg=o),o=rj(o,tt.children),o.flags|=4096,o)}function wj(a,o,_e){a.lanes|=o;var tt=a.alternate;tt!==null&&(tt.lanes|=o),Sg(a.return,o,_e)}function xj(a,o,_e,tt,rt){var st=a.memoizedState;st===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:tt,tail:_e,tailMode:rt}:(st.isBackwards=o,st.rendering=null,st.renderingStartTime=0,st.last=tt,st.tail=_e,st.tailMode=rt)}function yj(a,o,_e){var tt=o.pendingProps,rt=tt.revealOrder,st=tt.tail;if(Yi(a,o,tt.children,_e),tt=M$1.current,tt&2)tt=tt&1|2,o.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&wj(a,_e,o);else if(a.tag===19)wj(a,_e,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}tt&=1}if(G$1(M$1,tt),!(o.mode&1))o.memoizedState=null;else switch(rt){case"forwards":for(_e=o.child,rt=null;_e!==null;)a=_e.alternate,a!==null&&Mh(a)===null&&(rt=_e),_e=_e.sibling;_e=rt,_e===null?(rt=o.child,o.child=null):(rt=_e.sibling,_e.sibling=null),xj(o,!1,rt,_e,st);break;case"backwards":for(_e=null,rt=o.child,o.child=null;rt!==null;){if(a=rt.alternate,a!==null&&Mh(a)===null){o.child=rt;break}a=rt.sibling,rt.sibling=_e,_e=rt,rt=a}xj(o,!0,_e,null,st);break;case"together":xj(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function jj(a,o){!(o.mode&1)&&a!==null&&(a.alternate=null,o.alternate=null,o.flags|=2)}function $i(a,o,_e){if(a!==null&&(o.dependencies=a.dependencies),hh|=o.lanes,!(_e&o.childLanes))return null;if(a!==null&&o.child!==a.child)throw Error(p$2(153));if(o.child!==null){for(a=o.child,_e=wh(a,a.pendingProps),o.child=_e,_e.return=o;a.sibling!==null;)a=a.sibling,_e=_e.sibling=wh(a,a.pendingProps),_e.return=o;_e.sibling=null}return o.child}function zj(a,o,_e){switch(o.tag){case 3:lj(o),Ig();break;case 5:Kh(o);break;case 1:Zf(o.type)&&cg(o);break;case 4:Ih(o,o.stateNode.containerInfo);break;case 10:var tt=o.type._context,rt=o.memoizedProps.value;G$1(Mg,tt._currentValue),tt._currentValue=rt;break;case 13:if(tt=o.memoizedState,tt!==null)return tt.dehydrated!==null?(G$1(M$1,M$1.current&1),o.flags|=128,null):_e&o.child.childLanes?pj(a,o,_e):(G$1(M$1,M$1.current&1),a=$i(a,o,_e),a!==null?a.sibling:null);G$1(M$1,M$1.current&1);break;case 19:if(tt=(_e&o.childLanes)!==0,a.flags&128){if(tt)return yj(a,o,_e);o.flags|=128}if(rt=o.memoizedState,rt!==null&&(rt.rendering=null,rt.tail=null,rt.lastEffect=null),G$1(M$1,M$1.current),tt)break;return null;case 22:case 23:return o.lanes=0,ej(a,o,_e)}return $i(a,o,_e)}var Aj,Bj,Cj,Dj;Aj=function(a,o){for(var _e=o.child;_e!==null;){if(_e.tag===5||_e.tag===6)a.appendChild(_e.stateNode);else if(_e.tag!==4&&_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===o)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===o)return;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}};Bj=function(){};Cj=function(a,o,_e,tt){var rt=a.memoizedProps;if(rt!==tt){a=o.stateNode,Hh(Eh.current);var st=null;switch(_e){case"input":rt=Ya(a,rt),tt=Ya(a,tt),st=[];break;case"select":rt=A$3({},rt,{value:void 0}),tt=A$3({},tt,{value:void 0}),st=[];break;case"textarea":rt=gb(a,rt),tt=gb(a,tt),st=[];break;default:typeof rt.onClick!="function"&&typeof tt.onClick=="function"&&(a.onclick=Bf)}ub(_e,tt);var at;_e=null;for(et in rt)if(!tt.hasOwnProperty(et)&&rt.hasOwnProperty(et)&&rt[et]!=null)if(et==="style"){var ut=rt[et];for(at in ut)ut.hasOwnProperty(at)&&(_e||(_e={}),_e[at]="")}else et!=="dangerouslySetInnerHTML"&&et!=="children"&&et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&et!=="autoFocus"&&(ea.hasOwnProperty(et)?st||(st=[]):(st=st||[]).push(et,null));for(et in tt){var s=tt[et];if(ut=rt!=null?rt[et]:void 0,tt.hasOwnProperty(et)&&s!==ut&&(s!=null||ut!=null))if(et==="style")if(ut){for(at in ut)!ut.hasOwnProperty(at)||s&&s.hasOwnProperty(at)||(_e||(_e={}),_e[at]="");for(at in s)s.hasOwnProperty(at)&&ut[at]!==s[at]&&(_e||(_e={}),_e[at]=s[at])}else _e||(st||(st=[]),st.push(et,_e)),_e=s;else et==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,ut=ut?ut.__html:void 0,s!=null&&ut!==s&&(st=st||[]).push(et,s)):et==="children"?typeof s!="string"&&typeof s!="number"||(st=st||[]).push(et,""+s):et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&(ea.hasOwnProperty(et)?(s!=null&&et==="onScroll"&&D$1("scroll",a),st||ut===s||(st=[])):(st=st||[]).push(et,s))}_e&&(st=st||[]).push("style",_e);var et=st;(o.updateQueue=et)&&(o.flags|=4)}};Dj=function(a,o,_e,tt){_e!==tt&&(o.flags|=4)};function Ej(a,o){if(!I$2)switch(a.tailMode){case"hidden":o=a.tail;for(var _e=null;o!==null;)o.alternate!==null&&(_e=o),o=o.sibling;_e===null?a.tail=null:_e.sibling=null;break;case"collapsed":_e=a.tail;for(var tt=null;_e!==null;)_e.alternate!==null&&(tt=_e),_e=_e.sibling;tt===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:tt.sibling=null}}function S$1(a){var o=a.alternate!==null&&a.alternate.child===a.child,_e=0,tt=0;if(o)for(var rt=a.child;rt!==null;)_e|=rt.lanes|rt.childLanes,tt|=rt.subtreeFlags&14680064,tt|=rt.flags&14680064,rt.return=a,rt=rt.sibling;else for(rt=a.child;rt!==null;)_e|=rt.lanes|rt.childLanes,tt|=rt.subtreeFlags,tt|=rt.flags,rt.return=a,rt=rt.sibling;return a.subtreeFlags|=tt,a.childLanes=_e,o}function Fj(a,o,_e){var tt=o.pendingProps;switch(wg(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(o),null;case 1:return Zf(o.type)&&$f(),S$1(o),null;case 3:return tt=o.stateNode,Jh(),E$1(Wf),E$1(H),Oh(),tt.pendingContext&&(tt.context=tt.pendingContext,tt.pendingContext=null),(a===null||a.child===null)&&(Gg(o)?o.flags|=4:a===null||a.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(a,o),S$1(o),null;case 5:Lh(o);var rt=Hh(Gh.current);if(_e=o.type,a!==null&&o.stateNode!=null)Cj(a,o,_e,tt,rt),a.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!tt){if(o.stateNode===null)throw Error(p$2(166));return S$1(o),null}if(a=Hh(Eh.current),Gg(o)){tt=o.stateNode,_e=o.type;var st=o.memoizedProps;switch(tt[Of]=o,tt[Pf]=st,a=(o.mode&1)!==0,_e){case"dialog":D$1("cancel",tt),D$1("close",tt);break;case"iframe":case"object":case"embed":D$1("load",tt);break;case"video":case"audio":for(rt=0;rt<lf.length;rt++)D$1(lf[rt],tt);break;case"source":D$1("error",tt);break;case"img":case"image":case"link":D$1("error",tt),D$1("load",tt);break;case"details":D$1("toggle",tt);break;case"input":Za(tt,st),D$1("invalid",tt);break;case"select":tt._wrapperState={wasMultiple:!!st.multiple},D$1("invalid",tt);break;case"textarea":hb(tt,st),D$1("invalid",tt)}ub(_e,st),rt=null;for(var at in st)if(st.hasOwnProperty(at)){var ut=st[at];at==="children"?typeof ut=="string"?tt.textContent!==ut&&(st.suppressHydrationWarning!==!0&&Af(tt.textContent,ut,a),rt=["children",ut]):typeof ut=="number"&&tt.textContent!==""+ut&&(st.suppressHydrationWarning!==!0&&Af(tt.textContent,ut,a),rt=["children",""+ut]):ea.hasOwnProperty(at)&&ut!=null&&at==="onScroll"&&D$1("scroll",tt)}switch(_e){case"input":Va(tt),db(tt,st,!0);break;case"textarea":Va(tt),jb(tt);break;case"select":case"option":break;default:typeof st.onClick=="function"&&(tt.onclick=Bf)}tt=rt,o.updateQueue=tt,tt!==null&&(o.flags|=4)}else{at=rt.nodeType===9?rt:rt.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=kb(_e)),a==="http://www.w3.org/1999/xhtml"?_e==="script"?(a=at.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof tt.is=="string"?a=at.createElement(_e,{is:tt.is}):(a=at.createElement(_e),_e==="select"&&(at=a,tt.multiple?at.multiple=!0:tt.size&&(at.size=tt.size))):a=at.createElementNS(a,_e),a[Of]=o,a[Pf]=tt,Aj(a,o,!1,!1),o.stateNode=a;e:{switch(at=vb(_e,tt),_e){case"dialog":D$1("cancel",a),D$1("close",a),rt=tt;break;case"iframe":case"object":case"embed":D$1("load",a),rt=tt;break;case"video":case"audio":for(rt=0;rt<lf.length;rt++)D$1(lf[rt],a);rt=tt;break;case"source":D$1("error",a),rt=tt;break;case"img":case"image":case"link":D$1("error",a),D$1("load",a),rt=tt;break;case"details":D$1("toggle",a),rt=tt;break;case"input":Za(a,tt),rt=Ya(a,tt),D$1("invalid",a);break;case"option":rt=tt;break;case"select":a._wrapperState={wasMultiple:!!tt.multiple},rt=A$3({},tt,{value:void 0}),D$1("invalid",a);break;case"textarea":hb(a,tt),rt=gb(a,tt),D$1("invalid",a);break;default:rt=tt}ub(_e,rt),ut=rt;for(st in ut)if(ut.hasOwnProperty(st)){var s=ut[st];st==="style"?sb(a,s):st==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,s!=null&&nb(a,s)):st==="children"?typeof s=="string"?(_e!=="textarea"||s!=="")&&ob(a,s):typeof s=="number"&&ob(a,""+s):st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&st!=="autoFocus"&&(ea.hasOwnProperty(st)?s!=null&&st==="onScroll"&&D$1("scroll",a):s!=null&&ta(a,st,s,at))}switch(_e){case"input":Va(a),db(a,tt,!1);break;case"textarea":Va(a),jb(a);break;case"option":tt.value!=null&&a.setAttribute("value",""+Sa(tt.value));break;case"select":a.multiple=!!tt.multiple,st=tt.value,st!=null?fb(a,!!tt.multiple,st,!1):tt.defaultValue!=null&&fb(a,!!tt.multiple,tt.defaultValue,!0);break;default:typeof rt.onClick=="function"&&(a.onclick=Bf)}switch(_e){case"button":case"input":case"select":case"textarea":tt=!!tt.autoFocus;break e;case"img":tt=!0;break e;default:tt=!1}}tt&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return S$1(o),null;case 6:if(a&&o.stateNode!=null)Dj(a,o,a.memoizedProps,tt);else{if(typeof tt!="string"&&o.stateNode===null)throw Error(p$2(166));if(_e=Hh(Gh.current),Hh(Eh.current),Gg(o)){if(tt=o.stateNode,_e=o.memoizedProps,tt[Of]=o,(st=tt.nodeValue!==_e)&&(a=xg,a!==null))switch(a.tag){case 3:Af(tt.nodeValue,_e,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Af(tt.nodeValue,_e,(a.mode&1)!==0)}st&&(o.flags|=4)}else tt=(_e.nodeType===9?_e:_e.ownerDocument).createTextNode(tt),tt[Of]=o,o.stateNode=tt}return S$1(o),null;case 13:if(E$1(M$1),tt=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(I$2&&yg!==null&&o.mode&1&&!(o.flags&128))Hg(),Ig(),o.flags|=98560,st=!1;else if(st=Gg(o),tt!==null&&tt.dehydrated!==null){if(a===null){if(!st)throw Error(p$2(318));if(st=o.memoizedState,st=st!==null?st.dehydrated:null,!st)throw Error(p$2(317));st[Of]=o}else Ig(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;S$1(o),st=!1}else zg!==null&&(Gj(zg),zg=null),st=!0;if(!st)return o.flags&65536?o:null}return o.flags&128?(o.lanes=_e,o):(tt=tt!==null,tt!==(a!==null&&a.memoizedState!==null)&&tt&&(o.child.flags|=8192,o.mode&1&&(a===null||M$1.current&1?T$1===0&&(T$1=3):uj())),o.updateQueue!==null&&(o.flags|=4),S$1(o),null);case 4:return Jh(),Bj(a,o),a===null&&sf(o.stateNode.containerInfo),S$1(o),null;case 10:return Rg(o.type._context),S$1(o),null;case 17:return Zf(o.type)&&$f(),S$1(o),null;case 19:if(E$1(M$1),st=o.memoizedState,st===null)return S$1(o),null;if(tt=(o.flags&128)!==0,at=st.rendering,at===null)if(tt)Ej(st,!1);else{if(T$1!==0||a!==null&&a.flags&128)for(a=o.child;a!==null;){if(at=Mh(a),at!==null){for(o.flags|=128,Ej(st,!1),tt=at.updateQueue,tt!==null&&(o.updateQueue=tt,o.flags|=4),o.subtreeFlags=0,tt=_e,_e=o.child;_e!==null;)st=_e,a=tt,st.flags&=14680066,at=st.alternate,at===null?(st.childLanes=0,st.lanes=a,st.child=null,st.subtreeFlags=0,st.memoizedProps=null,st.memoizedState=null,st.updateQueue=null,st.dependencies=null,st.stateNode=null):(st.childLanes=at.childLanes,st.lanes=at.lanes,st.child=at.child,st.subtreeFlags=0,st.deletions=null,st.memoizedProps=at.memoizedProps,st.memoizedState=at.memoizedState,st.updateQueue=at.updateQueue,st.type=at.type,a=at.dependencies,st.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),_e=_e.sibling;return G$1(M$1,M$1.current&1|2),o.child}a=a.sibling}st.tail!==null&&B$1()>Hj&&(o.flags|=128,tt=!0,Ej(st,!1),o.lanes=4194304)}else{if(!tt)if(a=Mh(at),a!==null){if(o.flags|=128,tt=!0,_e=a.updateQueue,_e!==null&&(o.updateQueue=_e,o.flags|=4),Ej(st,!0),st.tail===null&&st.tailMode==="hidden"&&!at.alternate&&!I$2)return S$1(o),null}else 2*B$1()-st.renderingStartTime>Hj&&_e!==1073741824&&(o.flags|=128,tt=!0,Ej(st,!1),o.lanes=4194304);st.isBackwards?(at.sibling=o.child,o.child=at):(_e=st.last,_e!==null?_e.sibling=at:o.child=at,st.last=at)}return st.tail!==null?(o=st.tail,st.rendering=o,st.tail=o.sibling,st.renderingStartTime=B$1(),o.sibling=null,_e=M$1.current,G$1(M$1,tt?_e&1|2:_e&1),o):(S$1(o),null);case 22:case 23:return Ij(),tt=o.memoizedState!==null,a!==null&&a.memoizedState!==null!==tt&&(o.flags|=8192),tt&&o.mode&1?gj&1073741824&&(S$1(o),o.subtreeFlags&6&&(o.flags|=8192)):S$1(o),null;case 24:return null;case 25:return null}throw Error(p$2(156,o.tag))}function Jj(a,o){switch(wg(o),o.tag){case 1:return Zf(o.type)&&$f(),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return Jh(),E$1(Wf),E$1(H),Oh(),a=o.flags,a&65536&&!(a&128)?(o.flags=a&-65537|128,o):null;case 5:return Lh(o),null;case 13:if(E$1(M$1),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(p$2(340));Ig()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return E$1(M$1),null;case 4:return Jh(),null;case 10:return Rg(o.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Mj(a,o){var _e=a.ref;if(_e!==null)if(typeof _e=="function")try{_e(null)}catch(tt){W$1(a,o,tt)}else _e.current=null}function Nj(a,o,_e){try{_e()}catch(tt){W$1(a,o,tt)}}var Oj=!1;function Pj(a,o){if(Cf=dd,a=Me(),Ne(a)){if("selectionStart"in a)var _e={start:a.selectionStart,end:a.selectionEnd};else e:{_e=(_e=a.ownerDocument)&&_e.defaultView||window;var tt=_e.getSelection&&_e.getSelection();if(tt&&tt.rangeCount!==0){_e=tt.anchorNode;var rt=tt.anchorOffset,st=tt.focusNode;tt=tt.focusOffset;try{_e.nodeType,st.nodeType}catch{_e=null;break e}var at=0,ut=-1,s=-1,et=0,ot=0,lt=a,St=null;t:for(;;){for(var pt;lt!==_e||rt!==0&&lt.nodeType!==3||(ut=at+rt),lt!==st||tt!==0&&lt.nodeType!==3||(s=at+tt),lt.nodeType===3&&(at+=lt.nodeValue.length),(pt=lt.firstChild)!==null;)St=lt,lt=pt;for(;;){if(lt===a)break t;if(St===_e&&++et===rt&&(ut=at),St===st&&++ot===tt&&(s=at),(pt=lt.nextSibling)!==null)break;lt=St,St=lt.parentNode}lt=pt}_e=ut===-1||s===-1?null:{start:ut,end:s}}else _e=null}_e=_e||{start:0,end:0}}else _e=null;for(Df={focusedElem:a,selectionRange:_e},dd=!1,V=o;V!==null;)if(o=V,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,V=a;else for(;V!==null;){o=V;try{var gt=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(gt!==null){var ct=gt.memoizedProps,ht=gt.memoizedState,it=o.stateNode,ft=it.getSnapshotBeforeUpdate(o.elementType===o.type?ct:Lg(o.type,ct),ht);it.__reactInternalSnapshotBeforeUpdate=ft}break;case 3:var mt=o.stateNode.containerInfo;mt.nodeType===1?mt.textContent="":mt.nodeType===9&&mt.documentElement&&mt.removeChild(mt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$2(163))}}catch(Tt){W$1(o,o.return,Tt)}if(a=o.sibling,a!==null){a.return=o.return,V=a;break}V=o.return}return gt=Oj,Oj=!1,gt}function Qj(a,o,_e){var tt=o.updateQueue;if(tt=tt!==null?tt.lastEffect:null,tt!==null){var rt=tt=tt.next;do{if((rt.tag&a)===a){var st=rt.destroy;rt.destroy=void 0,st!==void 0&&Nj(o,_e,st)}rt=rt.next}while(rt!==tt)}}function Rj(a,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var _e=o=o.next;do{if((_e.tag&a)===a){var tt=_e.create;_e.destroy=tt()}_e=_e.next}while(_e!==o)}}function Sj(a){var o=a.ref;if(o!==null){var _e=a.stateNode;switch(a.tag){case 5:a=_e;break;default:a=_e}typeof o=="function"?o(a):o.current=a}}function Tj(a){var o=a.alternate;o!==null&&(a.alternate=null,Tj(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&(delete o[Of],delete o[Pf],delete o[of],delete o[Qf],delete o[Rf])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Uj(a){return a.tag===5||a.tag===3||a.tag===4}function Vj(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Uj(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Wj(a,o,_e){var tt=a.tag;if(tt===5||tt===6)a=a.stateNode,o?_e.nodeType===8?_e.parentNode.insertBefore(a,o):_e.insertBefore(a,o):(_e.nodeType===8?(o=_e.parentNode,o.insertBefore(a,_e)):(o=_e,o.appendChild(a)),_e=_e._reactRootContainer,_e!=null||o.onclick!==null||(o.onclick=Bf));else if(tt!==4&&(a=a.child,a!==null))for(Wj(a,o,_e),a=a.sibling;a!==null;)Wj(a,o,_e),a=a.sibling}function Xj(a,o,_e){var tt=a.tag;if(tt===5||tt===6)a=a.stateNode,o?_e.insertBefore(a,o):_e.appendChild(a);else if(tt!==4&&(a=a.child,a!==null))for(Xj(a,o,_e),a=a.sibling;a!==null;)Xj(a,o,_e),a=a.sibling}var X$1=null,Yj=!1;function Zj(a,o,_e){for(_e=_e.child;_e!==null;)ak(a,o,_e),_e=_e.sibling}function ak(a,o,_e){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,_e)}catch{}switch(_e.tag){case 5:U||Mj(_e,o);case 6:var tt=X$1,rt=Yj;X$1=null,Zj(a,o,_e),X$1=tt,Yj=rt,X$1!==null&&(Yj?(a=X$1,_e=_e.stateNode,a.nodeType===8?a.parentNode.removeChild(_e):a.removeChild(_e)):X$1.removeChild(_e.stateNode));break;case 18:X$1!==null&&(Yj?(a=X$1,_e=_e.stateNode,a.nodeType===8?Kf(a.parentNode,_e):a.nodeType===1&&Kf(a,_e),bd(a)):Kf(X$1,_e.stateNode));break;case 4:tt=X$1,rt=Yj,X$1=_e.stateNode.containerInfo,Yj=!0,Zj(a,o,_e),X$1=tt,Yj=rt;break;case 0:case 11:case 14:case 15:if(!U&&(tt=_e.updateQueue,tt!==null&&(tt=tt.lastEffect,tt!==null))){rt=tt=tt.next;do{var st=rt,at=st.destroy;st=st.tag,at!==void 0&&(st&2||st&4)&&Nj(_e,o,at),rt=rt.next}while(rt!==tt)}Zj(a,o,_e);break;case 1:if(!U&&(Mj(_e,o),tt=_e.stateNode,typeof tt.componentWillUnmount=="function"))try{tt.props=_e.memoizedProps,tt.state=_e.memoizedState,tt.componentWillUnmount()}catch(ut){W$1(_e,o,ut)}Zj(a,o,_e);break;case 21:Zj(a,o,_e);break;case 22:_e.mode&1?(U=(tt=U)||_e.memoizedState!==null,Zj(a,o,_e),U=tt):Zj(a,o,_e);break;default:Zj(a,o,_e)}}function bk(a){var o=a.updateQueue;if(o!==null){a.updateQueue=null;var _e=a.stateNode;_e===null&&(_e=a.stateNode=new Lj),o.forEach(function(tt){var rt=ck.bind(null,a,tt);_e.has(tt)||(_e.add(tt),tt.then(rt,rt))})}}function dk(a,o){var _e=o.deletions;if(_e!==null)for(var tt=0;tt<_e.length;tt++){var rt=_e[tt];try{var st=a,at=o,ut=at;e:for(;ut!==null;){switch(ut.tag){case 5:X$1=ut.stateNode,Yj=!1;break e;case 3:X$1=ut.stateNode.containerInfo,Yj=!0;break e;case 4:X$1=ut.stateNode.containerInfo,Yj=!0;break e}ut=ut.return}if(X$1===null)throw Error(p$2(160));ak(st,at,rt),X$1=null,Yj=!1;var s=rt.alternate;s!==null&&(s.return=null),rt.return=null}catch(et){W$1(rt,o,et)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)ek(o,a),o=o.sibling}function ek(a,o){var _e=a.alternate,tt=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(dk(o,a),fk(a),tt&4){try{Qj(3,a,a.return),Rj(3,a)}catch(ct){W$1(a,a.return,ct)}try{Qj(5,a,a.return)}catch(ct){W$1(a,a.return,ct)}}break;case 1:dk(o,a),fk(a),tt&512&&_e!==null&&Mj(_e,_e.return);break;case 5:if(dk(o,a),fk(a),tt&512&&_e!==null&&Mj(_e,_e.return),a.flags&32){var rt=a.stateNode;try{ob(rt,"")}catch(ct){W$1(a,a.return,ct)}}if(tt&4&&(rt=a.stateNode,rt!=null)){var st=a.memoizedProps,at=_e!==null?_e.memoizedProps:st,ut=a.type,s=a.updateQueue;if(a.updateQueue=null,s!==null)try{ut==="input"&&st.type==="radio"&&st.name!=null&&ab(rt,st),vb(ut,at);var et=vb(ut,st);for(at=0;at<s.length;at+=2){var ot=s[at],lt=s[at+1];ot==="style"?sb(rt,lt):ot==="dangerouslySetInnerHTML"?nb(rt,lt):ot==="children"?ob(rt,lt):ta(rt,ot,lt,et)}switch(ut){case"input":bb(rt,st);break;case"textarea":ib(rt,st);break;case"select":var St=rt._wrapperState.wasMultiple;rt._wrapperState.wasMultiple=!!st.multiple;var pt=st.value;pt!=null?fb(rt,!!st.multiple,pt,!1):St!==!!st.multiple&&(st.defaultValue!=null?fb(rt,!!st.multiple,st.defaultValue,!0):fb(rt,!!st.multiple,st.multiple?[]:"",!1))}rt[Pf]=st}catch(ct){W$1(a,a.return,ct)}}break;case 6:if(dk(o,a),fk(a),tt&4){if(a.stateNode===null)throw Error(p$2(162));rt=a.stateNode,st=a.memoizedProps;try{rt.nodeValue=st}catch(ct){W$1(a,a.return,ct)}}break;case 3:if(dk(o,a),fk(a),tt&4&&_e!==null&&_e.memoizedState.isDehydrated)try{bd(o.containerInfo)}catch(ct){W$1(a,a.return,ct)}break;case 4:dk(o,a),fk(a);break;case 13:dk(o,a),fk(a),rt=a.child,rt.flags&8192&&(st=rt.memoizedState!==null,rt.stateNode.isHidden=st,!st||rt.alternate!==null&&rt.alternate.memoizedState!==null||(gk=B$1())),tt&4&&bk(a);break;case 22:if(ot=_e!==null&&_e.memoizedState!==null,a.mode&1?(U=(et=U)||ot,dk(o,a),U=et):dk(o,a),fk(a),tt&8192){if(et=a.memoizedState!==null,(a.stateNode.isHidden=et)&&!ot&&a.mode&1)for(V=a,ot=a.child;ot!==null;){for(lt=V=ot;V!==null;){switch(St=V,pt=St.child,St.tag){case 0:case 11:case 14:case 15:Qj(4,St,St.return);break;case 1:Mj(St,St.return);var gt=St.stateNode;if(typeof gt.componentWillUnmount=="function"){tt=St,_e=St.return;try{o=tt,gt.props=o.memoizedProps,gt.state=o.memoizedState,gt.componentWillUnmount()}catch(ct){W$1(tt,_e,ct)}}break;case 5:Mj(St,St.return);break;case 22:if(St.memoizedState!==null){hk(lt);continue}}pt!==null?(pt.return=St,V=pt):hk(lt)}ot=ot.sibling}e:for(ot=null,lt=a;;){if(lt.tag===5){if(ot===null){ot=lt;try{rt=lt.stateNode,et?(st=rt.style,typeof st.setProperty=="function"?st.setProperty("display","none","important"):st.display="none"):(ut=lt.stateNode,s=lt.memoizedProps.style,at=s!=null&&s.hasOwnProperty("display")?s.display:null,ut.style.display=rb("display",at))}catch(ct){W$1(a,a.return,ct)}}}else if(lt.tag===6){if(ot===null)try{lt.stateNode.nodeValue=et?"":lt.memoizedProps}catch(ct){W$1(a,a.return,ct)}}else if((lt.tag!==22&&lt.tag!==23||lt.memoizedState===null||lt===a)&&lt.child!==null){lt.child.return=lt,lt=lt.child;continue}if(lt===a)break e;for(;lt.sibling===null;){if(lt.return===null||lt.return===a)break e;ot===lt&&(ot=null),lt=lt.return}ot===lt&&(ot=null),lt.sibling.return=lt.return,lt=lt.sibling}}break;case 19:dk(o,a),fk(a),tt&4&&bk(a);break;case 21:break;default:dk(o,a),fk(a)}}function fk(a){var o=a.flags;if(o&2){try{e:{for(var _e=a.return;_e!==null;){if(Uj(_e)){var tt=_e;break e}_e=_e.return}throw Error(p$2(160))}switch(tt.tag){case 5:var rt=tt.stateNode;tt.flags&32&&(ob(rt,""),tt.flags&=-33);var st=Vj(a);Xj(a,st,rt);break;case 3:case 4:var at=tt.stateNode.containerInfo,ut=Vj(a);Wj(a,ut,at);break;default:throw Error(p$2(161))}}catch(s){W$1(a,a.return,s)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function ik(a,o,_e){V=a,jk(a)}function jk(a,o,_e){for(var tt=(a.mode&1)!==0;V!==null;){var rt=V,st=rt.child;if(rt.tag===22&&tt){var at=rt.memoizedState!==null||Kj;if(!at){var ut=rt.alternate,s=ut!==null&&ut.memoizedState!==null||U;ut=Kj;var et=U;if(Kj=at,(U=s)&&!et)for(V=rt;V!==null;)at=V,s=at.child,at.tag===22&&at.memoizedState!==null?kk(rt):s!==null?(s.return=at,V=s):kk(rt);for(;st!==null;)V=st,jk(st),st=st.sibling;V=rt,Kj=ut,U=et}lk(a)}else rt.subtreeFlags&8772&&st!==null?(st.return=rt,V=st):lk(a)}}function lk(a){for(;V!==null;){var o=V;if(o.flags&8772){var _e=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:U||Rj(5,o);break;case 1:var tt=o.stateNode;if(o.flags&4&&!U)if(_e===null)tt.componentDidMount();else{var rt=o.elementType===o.type?_e.memoizedProps:Lg(o.type,_e.memoizedProps);tt.componentDidUpdate(rt,_e.memoizedState,tt.__reactInternalSnapshotBeforeUpdate)}var st=o.updateQueue;st!==null&&ih(o,st,tt);break;case 3:var at=o.updateQueue;if(at!==null){if(_e=null,o.child!==null)switch(o.child.tag){case 5:_e=o.child.stateNode;break;case 1:_e=o.child.stateNode}ih(o,at,_e)}break;case 5:var ut=o.stateNode;if(_e===null&&o.flags&4){_e=ut;var s=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&_e.focus();break;case"img":s.src&&(_e.src=s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var et=o.alternate;if(et!==null){var ot=et.memoizedState;if(ot!==null){var lt=ot.dehydrated;lt!==null&&bd(lt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$2(163))}U||o.flags&512&&Sj(o)}catch(St){W$1(o,o.return,St)}}if(o===a){V=null;break}if(_e=o.sibling,_e!==null){_e.return=o.return,V=_e;break}V=o.return}}function hk(a){for(;V!==null;){var o=V;if(o===a){V=null;break}var _e=o.sibling;if(_e!==null){_e.return=o.return,V=_e;break}V=o.return}}function kk(a){for(;V!==null;){var o=V;try{switch(o.tag){case 0:case 11:case 15:var _e=o.return;try{Rj(4,o)}catch(s){W$1(o,_e,s)}break;case 1:var tt=o.stateNode;if(typeof tt.componentDidMount=="function"){var rt=o.return;try{tt.componentDidMount()}catch(s){W$1(o,rt,s)}}var st=o.return;try{Sj(o)}catch(s){W$1(o,st,s)}break;case 5:var at=o.return;try{Sj(o)}catch(s){W$1(o,at,s)}}}catch(s){W$1(o,o.return,s)}if(o===a){V=null;break}var ut=o.sibling;if(ut!==null){ut.return=o.return,V=ut;break}V=o.return}}var mk=Math.ceil,nk=ua$1.ReactCurrentDispatcher,ok=ua$1.ReactCurrentOwner,pk=ua$1.ReactCurrentBatchConfig,K$1=0,R=null,Y$1=null,Z$1=0,gj=0,fj=Uf(0),T$1=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K$1&6?B$1():Bk!==-1?Bk:Bk=B$1()}function lh(a){return a.mode&1?K$1&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(a=C$1,a!==0||(a=window.event,a=a===void 0?16:jd(a.type)),a):1}function mh(a,o,_e,tt){if(50<zk)throw zk=0,Ak=null,Error(p$2(185));Ac(a,_e,tt),(!(K$1&2)||a!==R)&&(a===R&&(!(K$1&2)&&(rk|=_e),T$1===4&&Dk(a,Z$1)),Ek(a,tt),_e===1&&K$1===0&&!(o.mode&1)&&(Hj=B$1()+500,fg&&jg()))}function Ek(a,o){var _e=a.callbackNode;wc(a,o);var tt=uc(a,a===R?Z$1:0);if(tt===0)_e!==null&&bc(_e),a.callbackNode=null,a.callbackPriority=0;else if(o=tt&-tt,a.callbackPriority!==o){if(_e!=null&&bc(_e),o===1)a.tag===0?ig(Fk.bind(null,a)):hg(Fk.bind(null,a)),Jf(function(){!(K$1&6)&&jg()}),_e=null;else{switch(Dc(tt)){case 1:_e=fc;break;case 4:_e=gc;break;case 16:_e=hc;break;case 536870912:_e=jc;break;default:_e=hc}_e=Gk(_e,Hk.bind(null,a))}a.callbackPriority=o,a.callbackNode=_e}}function Hk(a,o){if(Bk=-1,Ck=0,K$1&6)throw Error(p$2(327));var _e=a.callbackNode;if(Ik()&&a.callbackNode!==_e)return null;var tt=uc(a,a===R?Z$1:0);if(tt===0)return null;if(tt&30||tt&a.expiredLanes||o)o=Jk(a,tt);else{o=tt;var rt=K$1;K$1|=2;var st=Kk();(R!==a||Z$1!==o)&&(vk=null,Hj=B$1()+500,Lk(a,o));do try{Mk();break}catch(ut){Nk(a,ut)}while(1);Qg(),nk.current=st,K$1=rt,Y$1!==null?o=0:(R=null,Z$1=0,o=T$1)}if(o!==0){if(o===2&&(rt=xc(a),rt!==0&&(tt=rt,o=Ok(a,rt))),o===1)throw _e=qk,Lk(a,0),Dk(a,tt),Ek(a,B$1()),_e;if(o===6)Dk(a,tt);else{if(rt=a.current.alternate,!(tt&30)&&!Pk(rt)&&(o=Jk(a,tt),o===2&&(st=xc(a),st!==0&&(tt=st,o=Ok(a,st))),o===1))throw _e=qk,Lk(a,0),Dk(a,tt),Ek(a,B$1()),_e;switch(a.finishedWork=rt,a.finishedLanes=tt,o){case 0:case 1:throw Error(p$2(345));case 2:Qk(a,uk,vk);break;case 3:if(Dk(a,tt),(tt&130023424)===tt&&(o=gk+500-B$1(),10<o)){if(uc(a,0)!==0)break;if(rt=a.suspendedLanes,(rt&tt)!==tt){L(),a.pingedLanes|=a.suspendedLanes&rt;break}a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),o);break}Qk(a,uk,vk);break;case 4:if(Dk(a,tt),(tt&4194240)===tt)break;for(o=a.eventTimes,rt=-1;0<tt;){var at=31-oc(tt);st=1<<at,at=o[at],at>rt&&(rt=at),tt&=~st}if(tt=rt,tt=B$1()-tt,tt=(120>tt?120:480>tt?480:1080>tt?1080:1920>tt?1920:3e3>tt?3e3:4320>tt?4320:1960*mk(tt/1960))-tt,10<tt){a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),tt);break}Qk(a,uk,vk);break;case 5:Qk(a,uk,vk);break;default:throw Error(p$2(329))}}}return Ek(a,B$1()),a.callbackNode===_e?Hk.bind(null,a):null}function Ok(a,o){var _e=tk;return a.current.memoizedState.isDehydrated&&(Lk(a,o).flags|=256),a=Jk(a,o),a!==2&&(o=uk,uk=_e,o!==null&&Gj(o)),a}function Gj(a){uk===null?uk=a:uk.push.apply(uk,a)}function Pk(a){for(var o=a;;){if(o.flags&16384){var _e=o.updateQueue;if(_e!==null&&(_e=_e.stores,_e!==null))for(var tt=0;tt<_e.length;tt++){var rt=_e[tt],st=rt.getSnapshot;rt=rt.value;try{if(!He(st(),rt))return!1}catch{return!1}}}if(_e=o.child,o.subtreeFlags&16384&&_e!==null)_e.return=o,o=_e;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Dk(a,o){for(o&=~sk,o&=~rk,a.suspendedLanes|=o,a.pingedLanes&=~o,a=a.expirationTimes;0<o;){var _e=31-oc(o),tt=1<<_e;a[_e]=-1,o&=~tt}}function Fk(a){if(K$1&6)throw Error(p$2(327));Ik();var o=uc(a,0);if(!(o&1))return Ek(a,B$1()),null;var _e=Jk(a,o);if(a.tag!==0&&_e===2){var tt=xc(a);tt!==0&&(o=tt,_e=Ok(a,tt))}if(_e===1)throw _e=qk,Lk(a,0),Dk(a,o),Ek(a,B$1()),_e;if(_e===6)throw Error(p$2(345));return a.finishedWork=a.current.alternate,a.finishedLanes=o,Qk(a,uk,vk),Ek(a,B$1()),null}function Rk(a,o){var _e=K$1;K$1|=1;try{return a(o)}finally{K$1=_e,K$1===0&&(Hj=B$1()+500,fg&&jg())}}function Sk(a){xk!==null&&xk.tag===0&&!(K$1&6)&&Ik();var o=K$1;K$1|=1;var _e=pk.transition,tt=C$1;try{if(pk.transition=null,C$1=1,a)return a()}finally{C$1=tt,pk.transition=_e,K$1=o,!(K$1&6)&&jg()}}function Ij(){gj=fj.current,E$1(fj)}function Lk(a,o){a.finishedWork=null,a.finishedLanes=0;var _e=a.timeoutHandle;if(_e!==-1&&(a.timeoutHandle=-1,Gf(_e)),Y$1!==null)for(_e=Y$1.return;_e!==null;){var tt=_e;switch(wg(tt),tt.tag){case 1:tt=tt.type.childContextTypes,tt!=null&&$f();break;case 3:Jh(),E$1(Wf),E$1(H),Oh();break;case 5:Lh(tt);break;case 4:Jh();break;case 13:E$1(M$1);break;case 19:E$1(M$1);break;case 10:Rg(tt.type._context);break;case 22:case 23:Ij()}_e=_e.return}if(R=a,Y$1=a=wh(a.current,null),Z$1=gj=o,T$1=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(o=0;o<Wg.length;o++)if(_e=Wg[o],tt=_e.interleaved,tt!==null){_e.interleaved=null;var rt=tt.next,st=_e.pending;if(st!==null){var at=st.next;st.next=rt,tt.next=at}_e.pending=tt}Wg=null}return a}function Nk(a,o){do{var _e=Y$1;try{if(Qg(),Ph.current=ai,Sh){for(var tt=N$2.memoizedState;tt!==null;){var rt=tt.queue;rt!==null&&(rt.pending=null),tt=tt.next}Sh=!1}if(Rh=0,P=O$1=N$2=null,Th=!1,Uh=0,ok.current=null,_e===null||_e.return===null){T$1=1,qk=o,Y$1=null;break}e:{var st=a,at=_e.return,ut=_e,s=o;if(o=Z$1,ut.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){var et=s,ot=ut,lt=ot.tag;if(!(ot.mode&1)&&(lt===0||lt===11||lt===15)){var St=ot.alternate;St?(ot.updateQueue=St.updateQueue,ot.memoizedState=St.memoizedState,ot.lanes=St.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var pt=Vi(at);if(pt!==null){pt.flags&=-257,Wi(pt,at,ut,st,o),pt.mode&1&&Ti(st,et,o),o=pt,s=et;var gt=o.updateQueue;if(gt===null){var ct=new Set;ct.add(s),o.updateQueue=ct}else gt.add(s);break e}else{if(!(o&1)){Ti(st,et,o),uj();break e}s=Error(p$2(426))}}else if(I$2&&ut.mode&1){var ht=Vi(at);if(ht!==null){!(ht.flags&65536)&&(ht.flags|=256),Wi(ht,at,ut,st,o),Jg(Ki(s,ut));break e}}st=s=Ki(s,ut),T$1!==4&&(T$1=2),tk===null?tk=[st]:tk.push(st),st=at;do{switch(st.tag){case 3:st.flags|=65536,o&=-o,st.lanes|=o;var it=Oi(st,s,o);fh(st,it);break e;case 1:ut=s;var ft=st.type,mt=st.stateNode;if(!(st.flags&128)&&(typeof ft.getDerivedStateFromError=="function"||mt!==null&&typeof mt.componentDidCatch=="function"&&(Si===null||!Si.has(mt)))){st.flags|=65536,o&=-o,st.lanes|=o;var Tt=Ri(st,ut,o);fh(st,Tt);break e}}st=st.return}while(st!==null)}Tk(_e)}catch(It){o=It,Y$1===_e&&_e!==null&&(Y$1=_e=_e.return);continue}break}while(1)}function Kk(){var a=nk.current;return nk.current=ai,a===null?ai:a}function uj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),R===null||!(hh&268435455)&&!(rk&268435455)||Dk(R,Z$1)}function Jk(a,o){var _e=K$1;K$1|=2;var tt=Kk();(R!==a||Z$1!==o)&&(vk=null,Lk(a,o));do try{Uk();break}catch(rt){Nk(a,rt)}while(1);if(Qg(),K$1=_e,nk.current=tt,Y$1!==null)throw Error(p$2(261));return R=null,Z$1=0,T$1}function Uk(){for(;Y$1!==null;)Vk(Y$1)}function Mk(){for(;Y$1!==null&&!cc();)Vk(Y$1)}function Vk(a){var o=Wk(a.alternate,a,gj);a.memoizedProps=a.pendingProps,o===null?Tk(a):Y$1=o,ok.current=null}function Tk(a){var o=a;do{var _e=o.alternate;if(a=o.return,o.flags&32768){if(_e=Jj(_e,o),_e!==null){_e.flags&=32767,Y$1=_e;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{T$1=6,Y$1=null;return}}else if(_e=Fj(_e,o,gj),_e!==null){Y$1=_e;return}if(o=o.sibling,o!==null){Y$1=o;return}Y$1=o=a}while(o!==null);T$1===0&&(T$1=5)}function Qk(a,o,_e){var tt=C$1,rt=pk.transition;try{pk.transition=null,C$1=1,Xk(a,o,_e,tt)}finally{pk.transition=rt,C$1=tt}return null}function Xk(a,o,_e,tt){do Ik();while(xk!==null);if(K$1&6)throw Error(p$2(327));_e=a.finishedWork;var rt=a.finishedLanes;if(_e===null)return null;if(a.finishedWork=null,a.finishedLanes=0,_e===a.current)throw Error(p$2(177));a.callbackNode=null,a.callbackPriority=0;var st=_e.lanes|_e.childLanes;if(Bc(a,st),a===R&&(Y$1=R=null,Z$1=0),!(_e.subtreeFlags&2064)&&!(_e.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),st=(_e.flags&15990)!==0,_e.subtreeFlags&15990||st){st=pk.transition,pk.transition=null;var at=C$1;C$1=1;var ut=K$1;K$1|=4,ok.current=null,Pj(a,_e),ek(_e,a),Oe(Df),dd=!!Cf,Df=Cf=null,a.current=_e,ik(_e),dc(),K$1=ut,C$1=at,pk.transition=st}else a.current=_e;if(wk&&(wk=!1,xk=a,yk=rt),st=a.pendingLanes,st===0&&(Si=null),mc(_e.stateNode),Ek(a,B$1()),o!==null)for(tt=a.onRecoverableError,_e=0;_e<o.length;_e++)rt=o[_e],tt(rt.value,{componentStack:rt.stack,digest:rt.digest});if(Pi)throw Pi=!1,a=Qi,Qi=null,a;return yk&1&&a.tag!==0&&Ik(),st=a.pendingLanes,st&1?a===Ak?zk++:(zk=0,Ak=a):zk=0,jg(),null}function Ik(){if(xk!==null){var a=Dc(yk),o=pk.transition,_e=C$1;try{if(pk.transition=null,C$1=16>a?16:a,xk===null)var tt=!1;else{if(a=xk,xk=null,yk=0,K$1&6)throw Error(p$2(331));var rt=K$1;for(K$1|=4,V=a.current;V!==null;){var st=V,at=st.child;if(V.flags&16){var ut=st.deletions;if(ut!==null){for(var s=0;s<ut.length;s++){var et=ut[s];for(V=et;V!==null;){var ot=V;switch(ot.tag){case 0:case 11:case 15:Qj(8,ot,st)}var lt=ot.child;if(lt!==null)lt.return=ot,V=lt;else for(;V!==null;){ot=V;var St=ot.sibling,pt=ot.return;if(Tj(ot),ot===et){V=null;break}if(St!==null){St.return=pt,V=St;break}V=pt}}}var gt=st.alternate;if(gt!==null){var ct=gt.child;if(ct!==null){gt.child=null;do{var ht=ct.sibling;ct.sibling=null,ct=ht}while(ct!==null)}}V=st}}if(st.subtreeFlags&2064&&at!==null)at.return=st,V=at;else e:for(;V!==null;){if(st=V,st.flags&2048)switch(st.tag){case 0:case 11:case 15:Qj(9,st,st.return)}var it=st.sibling;if(it!==null){it.return=st.return,V=it;break e}V=st.return}}var ft=a.current;for(V=ft;V!==null;){at=V;var mt=at.child;if(at.subtreeFlags&2064&&mt!==null)mt.return=at,V=mt;else e:for(at=ft;V!==null;){if(ut=V,ut.flags&2048)try{switch(ut.tag){case 0:case 11:case 15:Rj(9,ut)}}catch(It){W$1(ut,ut.return,It)}if(ut===at){V=null;break e}var Tt=ut.sibling;if(Tt!==null){Tt.return=ut.return,V=Tt;break e}V=ut.return}}if(K$1=rt,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,a)}catch{}tt=!0}return tt}finally{C$1=_e,pk.transition=o}}return!1}function Yk(a,o,_e){o=Ki(_e,o),o=Oi(a,o,1),a=dh(a,o,1),o=L(),a!==null&&(Ac(a,1,o),Ek(a,o))}function W$1(a,o,_e){if(a.tag===3)Yk(a,a,_e);else for(;o!==null;){if(o.tag===3){Yk(o,a,_e);break}else if(o.tag===1){var tt=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof tt.componentDidCatch=="function"&&(Si===null||!Si.has(tt))){a=Ki(_e,a),a=Ri(o,a,1),o=dh(o,a,1),a=L(),o!==null&&(Ac(o,1,a),Ek(o,a));break}}o=o.return}}function Ui(a,o,_e){var tt=a.pingCache;tt!==null&&tt.delete(o),o=L(),a.pingedLanes|=a.suspendedLanes&_e,R===a&&(Z$1&_e)===_e&&(T$1===4||T$1===3&&(Z$1&130023424)===Z$1&&500>B$1()-gk?Lk(a,0):sk|=_e),Ek(a,o)}function Zk(a,o){o===0&&(a.mode&1?(o=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):o=1);var _e=L();a=Zg(a,o),a!==null&&(Ac(a,o,_e),Ek(a,_e))}function vj(a){var o=a.memoizedState,_e=0;o!==null&&(_e=o.retryLane),Zk(a,_e)}function ck(a,o){var _e=0;switch(a.tag){case 13:var tt=a.stateNode,rt=a.memoizedState;rt!==null&&(_e=rt.retryLane);break;case 19:tt=a.stateNode;break;default:throw Error(p$2(314))}tt!==null&&tt.delete(o),Zk(a,_e)}var Wk;Wk=function(a,o,_e){if(a!==null)if(a.memoizedProps!==o.pendingProps||Wf.current)Ug=!0;else{if(!(a.lanes&_e)&&!(o.flags&128))return Ug=!1,zj(a,o,_e);Ug=!!(a.flags&131072)}else Ug=!1,I$2&&o.flags&1048576&&ug(o,ng,o.index);switch(o.lanes=0,o.tag){case 2:var tt=o.type;jj(a,o),a=o.pendingProps;var rt=Yf(o,H.current);Tg(o,_e),rt=Xh(null,o,tt,a,rt,_e);var st=bi();return o.flags|=1,typeof rt=="object"&&rt!==null&&typeof rt.render=="function"&&rt.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Zf(tt)?(st=!0,cg(o)):st=!1,o.memoizedState=rt.state!==null&&rt.state!==void 0?rt.state:null,ah(o),rt.updater=nh,o.stateNode=rt,rt._reactInternals=o,rh(o,tt,a,_e),o=kj(null,o,tt,!0,st,_e)):(o.tag=0,I$2&&st&&vg(o),Yi(null,o,rt,_e),o=o.child),o;case 16:tt=o.elementType;e:{switch(jj(a,o),a=o.pendingProps,rt=tt._init,tt=rt(tt._payload),o.type=tt,rt=o.tag=$k(tt),a=Lg(tt,a),rt){case 0:o=dj(null,o,tt,a,_e);break e;case 1:o=ij(null,o,tt,a,_e);break e;case 11:o=Zi(null,o,tt,a,_e);break e;case 14:o=aj(null,o,tt,Lg(tt.type,a),_e);break e}throw Error(p$2(306,tt,""))}return o;case 0:return tt=o.type,rt=o.pendingProps,rt=o.elementType===tt?rt:Lg(tt,rt),dj(a,o,tt,rt,_e);case 1:return tt=o.type,rt=o.pendingProps,rt=o.elementType===tt?rt:Lg(tt,rt),ij(a,o,tt,rt,_e);case 3:e:{if(lj(o),a===null)throw Error(p$2(387));tt=o.pendingProps,st=o.memoizedState,rt=st.element,bh(a,o),gh(o,tt,null,_e);var at=o.memoizedState;if(tt=at.element,st.isDehydrated)if(st={element:tt,isDehydrated:!1,cache:at.cache,pendingSuspenseBoundaries:at.pendingSuspenseBoundaries,transitions:at.transitions},o.updateQueue.baseState=st,o.memoizedState=st,o.flags&256){rt=Ki(Error(p$2(423)),o),o=mj(a,o,tt,_e,rt);break e}else if(tt!==rt){rt=Ki(Error(p$2(424)),o),o=mj(a,o,tt,_e,rt);break e}else for(yg=Lf(o.stateNode.containerInfo.firstChild),xg=o,I$2=!0,zg=null,_e=Ch(o,null,tt,_e),o.child=_e;_e;)_e.flags=_e.flags&-3|4096,_e=_e.sibling;else{if(Ig(),tt===rt){o=$i(a,o,_e);break e}Yi(a,o,tt,_e)}o=o.child}return o;case 5:return Kh(o),a===null&&Eg(o),tt=o.type,rt=o.pendingProps,st=a!==null?a.memoizedProps:null,at=rt.children,Ef(tt,rt)?at=null:st!==null&&Ef(tt,st)&&(o.flags|=32),hj(a,o),Yi(a,o,at,_e),o.child;case 6:return a===null&&Eg(o),null;case 13:return pj(a,o,_e);case 4:return Ih(o,o.stateNode.containerInfo),tt=o.pendingProps,a===null?o.child=Bh(o,null,tt,_e):Yi(a,o,tt,_e),o.child;case 11:return tt=o.type,rt=o.pendingProps,rt=o.elementType===tt?rt:Lg(tt,rt),Zi(a,o,tt,rt,_e);case 7:return Yi(a,o,o.pendingProps,_e),o.child;case 8:return Yi(a,o,o.pendingProps.children,_e),o.child;case 12:return Yi(a,o,o.pendingProps.children,_e),o.child;case 10:e:{if(tt=o.type._context,rt=o.pendingProps,st=o.memoizedProps,at=rt.value,G$1(Mg,tt._currentValue),tt._currentValue=at,st!==null)if(He(st.value,at)){if(st.children===rt.children&&!Wf.current){o=$i(a,o,_e);break e}}else for(st=o.child,st!==null&&(st.return=o);st!==null;){var ut=st.dependencies;if(ut!==null){at=st.child;for(var s=ut.firstContext;s!==null;){if(s.context===tt){if(st.tag===1){s=ch(-1,_e&-_e),s.tag=2;var et=st.updateQueue;if(et!==null){et=et.shared;var ot=et.pending;ot===null?s.next=s:(s.next=ot.next,ot.next=s),et.pending=s}}st.lanes|=_e,s=st.alternate,s!==null&&(s.lanes|=_e),Sg(st.return,_e,o),ut.lanes|=_e;break}s=s.next}}else if(st.tag===10)at=st.type===o.type?null:st.child;else if(st.tag===18){if(at=st.return,at===null)throw Error(p$2(341));at.lanes|=_e,ut=at.alternate,ut!==null&&(ut.lanes|=_e),Sg(at,_e,o),at=st.sibling}else at=st.child;if(at!==null)at.return=st;else for(at=st;at!==null;){if(at===o){at=null;break}if(st=at.sibling,st!==null){st.return=at.return,at=st;break}at=at.return}st=at}Yi(a,o,rt.children,_e),o=o.child}return o;case 9:return rt=o.type,tt=o.pendingProps.children,Tg(o,_e),rt=Vg(rt),tt=tt(rt),o.flags|=1,Yi(a,o,tt,_e),o.child;case 14:return tt=o.type,rt=Lg(tt,o.pendingProps),rt=Lg(tt.type,rt),aj(a,o,tt,rt,_e);case 15:return cj(a,o,o.type,o.pendingProps,_e);case 17:return tt=o.type,rt=o.pendingProps,rt=o.elementType===tt?rt:Lg(tt,rt),jj(a,o),o.tag=1,Zf(tt)?(a=!0,cg(o)):a=!1,Tg(o,_e),ph(o,tt,rt),rh(o,tt,rt,_e),kj(null,o,tt,!0,a,_e);case 19:return yj(a,o,_e);case 22:return ej(a,o,_e)}throw Error(p$2(156,o.tag))};function Gk(a,o){return ac(a,o)}function al(a,o,_e,tt){this.tag=a,this.key=_e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=tt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(a,o,_e,tt){return new al(a,o,_e,tt)}function bj(a){return a=a.prototype,!(!a||!a.isReactComponent)}function $k(a){if(typeof a=="function")return bj(a)?1:0;if(a!=null){if(a=a.$$typeof,a===Da)return 11;if(a===Ga)return 14}return 2}function wh(a,o){var _e=a.alternate;return _e===null?(_e=Bg(a.tag,o,a.key,a.mode),_e.elementType=a.elementType,_e.type=a.type,_e.stateNode=a.stateNode,_e.alternate=a,a.alternate=_e):(_e.pendingProps=o,_e.type=a.type,_e.flags=0,_e.subtreeFlags=0,_e.deletions=null),_e.flags=a.flags&14680064,_e.childLanes=a.childLanes,_e.lanes=a.lanes,_e.child=a.child,_e.memoizedProps=a.memoizedProps,_e.memoizedState=a.memoizedState,_e.updateQueue=a.updateQueue,o=a.dependencies,_e.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},_e.sibling=a.sibling,_e.index=a.index,_e.ref=a.ref,_e}function yh(a,o,_e,tt,rt,st){var at=2;if(tt=a,typeof a=="function")bj(a)&&(at=1);else if(typeof a=="string")at=5;else e:switch(a){case ya:return Ah(_e.children,rt,st,o);case za:at=8,rt|=8;break;case Aa:return a=Bg(12,_e,o,rt|2),a.elementType=Aa,a.lanes=st,a;case Ea:return a=Bg(13,_e,o,rt),a.elementType=Ea,a.lanes=st,a;case Fa:return a=Bg(19,_e,o,rt),a.elementType=Fa,a.lanes=st,a;case Ia:return qj(_e,rt,st,o);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case Ba:at=10;break e;case Ca:at=9;break e;case Da:at=11;break e;case Ga:at=14;break e;case Ha:at=16,tt=null;break e}throw Error(p$2(130,a==null?a:typeof a,""))}return o=Bg(at,_e,o,rt),o.elementType=a,o.type=tt,o.lanes=st,o}function Ah(a,o,_e,tt){return a=Bg(7,a,tt,o),a.lanes=_e,a}function qj(a,o,_e,tt){return a=Bg(22,a,tt,o),a.elementType=Ia,a.lanes=_e,a.stateNode={isHidden:!1},a}function xh(a,o,_e){return a=Bg(6,a,null,o),a.lanes=_e,a}function zh(a,o,_e){return o=Bg(4,a.children!==null?a.children:[],a.key,o),o.lanes=_e,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}function bl(a,o,_e,tt,rt){this.tag=o,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=tt,this.onRecoverableError=rt,this.mutableSourceEagerHydrationData=null}function cl(a,o,_e,tt,rt,st,at,ut,s){return a=new bl(a,o,_e,ut,s),o===1?(o=1,st===!0&&(o|=8)):o=0,st=Bg(3,null,null,o),a.current=st,st.stateNode=a,st.memoizedState={element:tt,isDehydrated:_e,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(st),a}function dl(a,o,_e){var tt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:tt==null?null:""+tt,children:a,containerInfo:o,implementation:_e}}function el(a){if(!a)return Vf;a=a._reactInternals;e:{if(Vb(a)!==a||a.tag!==1)throw Error(p$2(170));var o=a;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Zf(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(p$2(171))}if(a.tag===1){var _e=a.type;if(Zf(_e))return bg(a,_e,o)}return o}function fl(a,o,_e,tt,rt,st,at,ut,s){return a=cl(_e,tt,!0,a,rt,st,at,ut,s),a.context=el(null),_e=a.current,tt=L(),rt=lh(_e),st=ch(tt,rt),st.callback=o??null,dh(_e,st,rt),a.current.lanes=rt,Ac(a,rt,tt),Ek(a,tt),a}function gl(a,o,_e,tt){var rt=o.current,st=L(),at=lh(rt);return _e=el(_e),o.context===null?o.context=_e:o.pendingContext=_e,o=ch(st,at),o.payload={element:a},tt=tt===void 0?null:tt,tt!==null&&(o.callback=tt),a=dh(rt,o,at),a!==null&&(mh(a,rt,at,st),eh(a,rt,at)),at}function hl(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function il(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var _e=a.retryLane;a.retryLane=_e!==0&&_e<o?_e:o}}function jl(a,o){il(a,o),(a=a.alternate)&&il(a,o)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(a){console.error(a)};function ml(a){this._internalRoot=a}nl.prototype.render=ml.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(p$2(409));gl(a,o,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;Sk(function(){gl(null,a,null,null)}),o[uf]=null}};function nl(a){this._internalRoot=a}nl.prototype.unstable_scheduleHydration=function(a){if(a){var o=Hc();a={blockedOn:null,target:a,priority:o};for(var _e=0;_e<Qc.length&&o!==0&&o<Qc[_e].priority;_e++);Qc.splice(_e,0,a),_e===0&&Vc(a)}};function ol(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function pl(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(a,o,_e,tt,rt){if(rt){if(typeof tt=="function"){var st=tt;tt=function(){var et=hl(at);st.call(et)}}var at=fl(o,tt,a,0,null,!1,!1,"",ql);return a._reactRootContainer=at,a[uf]=at.current,sf(a.nodeType===8?a.parentNode:a),Sk(),at}for(;rt=a.lastChild;)a.removeChild(rt);if(typeof tt=="function"){var ut=tt;tt=function(){var et=hl(s);ut.call(et)}}var s=cl(a,0,!1,null,null,!1,!1,"",ql);return a._reactRootContainer=s,a[uf]=s.current,sf(a.nodeType===8?a.parentNode:a),Sk(function(){gl(o,s,_e,tt)}),s}function sl(a,o,_e,tt,rt){var st=_e._reactRootContainer;if(st){var at=st;if(typeof rt=="function"){var ut=rt;rt=function(){var s=hl(at);ut.call(s)}}gl(o,at,a,rt)}else at=rl(_e,o,a,rt,tt);return hl(at)}Ec=function(a){switch(a.tag){case 3:var o=a.stateNode;if(o.current.memoizedState.isDehydrated){var _e=tc(o.pendingLanes);_e!==0&&(Cc(o,_e|1),Ek(o,B$1()),!(K$1&6)&&(Hj=B$1()+500,jg()))}break;case 13:Sk(function(){var tt=Zg(a,1);if(tt!==null){var rt=L();mh(tt,a,1,rt)}}),jl(a,1)}};Fc=function(a){if(a.tag===13){var o=Zg(a,134217728);if(o!==null){var _e=L();mh(o,a,134217728,_e)}jl(a,134217728)}};Gc=function(a){if(a.tag===13){var o=lh(a),_e=Zg(a,o);if(_e!==null){var tt=L();mh(_e,a,o,tt)}jl(a,o)}};Hc=function(){return C$1};Ic=function(a,o){var _e=C$1;try{return C$1=a,o()}finally{C$1=_e}};yb=function(a,o,_e){switch(o){case"input":if(bb(a,_e),o=_e.name,_e.type==="radio"&&o!=null){for(_e=a;_e.parentNode;)_e=_e.parentNode;for(_e=_e.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<_e.length;o++){var tt=_e[o];if(tt!==a&&tt.form===a.form){var rt=Db(tt);if(!rt)throw Error(p$2(90));Wa(tt),bb(tt,rt)}}}break;case"textarea":ib(a,_e);break;case"select":o=_e.value,o!=null&&fb(a,!!_e.multiple,o,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$1.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Zb(a),a===null?null:a.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(a,o){var _e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(o))throw Error(p$2(200));return dl(a,o,null,_e)};reactDom_production_min.createRoot=function(a,o){if(!ol(a))throw Error(p$2(299));var _e=!1,tt="",rt=ll;return o!=null&&(o.unstable_strictMode===!0&&(_e=!0),o.identifierPrefix!==void 0&&(tt=o.identifierPrefix),o.onRecoverableError!==void 0&&(rt=o.onRecoverableError)),o=cl(a,1,!1,null,null,_e,!1,tt,rt),a[uf]=o.current,sf(a.nodeType===8?a.parentNode:a),new ml(o)};reactDom_production_min.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(p$2(188)):(a=Object.keys(a).join(","),Error(p$2(268,a)));return a=Zb(o),a=a===null?null:a.stateNode,a};reactDom_production_min.flushSync=function(a){return Sk(a)};reactDom_production_min.hydrate=function(a,o,_e){if(!pl(o))throw Error(p$2(200));return sl(null,a,o,!0,_e)};reactDom_production_min.hydrateRoot=function(a,o,_e){if(!ol(a))throw Error(p$2(405));var tt=_e!=null&&_e.hydratedSources||null,rt=!1,st="",at=ll;if(_e!=null&&(_e.unstable_strictMode===!0&&(rt=!0),_e.identifierPrefix!==void 0&&(st=_e.identifierPrefix),_e.onRecoverableError!==void 0&&(at=_e.onRecoverableError)),o=fl(o,null,a,1,_e??null,rt,!1,st,at),a[uf]=o.current,sf(a),tt)for(a=0;a<tt.length;a++)_e=tt[a],rt=_e._getVersion,rt=rt(_e._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[_e,rt]:o.mutableSourceEagerHydrationData.push(_e,rt);return new nl(o)};reactDom_production_min.render=function(a,o,_e){if(!pl(o))throw Error(p$2(200));return sl(null,a,o,!1,_e)};reactDom_production_min.unmountComponentAtNode=function(a){if(!pl(a))throw Error(p$2(40));return a._reactRootContainer?(Sk(function(){sl(null,null,a,!1,function(){a._reactRootContainer=null,a[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(a,o,_e,tt){if(!pl(_e))throw Error(p$2(200));if(a==null||a._reactInternals===void 0)throw Error(p$2(38));return sl(a,o,_e,!1,tt)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(a){console.error(a)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs(reactDomExports);var createRoot,m$3=reactDomExports;createRoot=m$3.createRoot,m$3.hydrateRoot;/**
 * @remix-run/router v1.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var tt in _e)Object.prototype.hasOwnProperty.call(_e,tt)&&(a[tt]=_e[tt])}return a},_extends$3.apply(this,arguments)}var Action;(function(a){a.Pop="POP",a.Push="PUSH",a.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(a){a===void 0&&(a={});function o(tt,rt){let{pathname:st,search:at,hash:ut}=tt.location;return createLocation("",{pathname:st,search:at,hash:ut},rt.state&&rt.state.usr||null,rt.state&&rt.state.key||"default")}function _e(tt,rt){return typeof rt=="string"?rt:createPath(rt)}return getUrlBasedHistory(o,_e,null,a)}function invariant(a,o){if(a===!1||a===null||typeof a>"u")throw new Error(o)}function warning(a,o){if(!a){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(a,o){return{usr:a.state,key:a.key,idx:o}}function createLocation(a,o,_e,tt){return _e===void 0&&(_e=null),_extends$3({pathname:typeof a=="string"?a:a.pathname,search:"",hash:""},typeof o=="string"?parsePath(o):o,{state:_e,key:o&&o.key||tt||createKey()})}function createPath(a){let{pathname:o="/",search:_e="",hash:tt=""}=a;return _e&&_e!=="?"&&(o+=_e.charAt(0)==="?"?_e:"?"+_e),tt&&tt!=="#"&&(o+=tt.charAt(0)==="#"?tt:"#"+tt),o}function parsePath(a){let o={};if(a){let _e=a.indexOf("#");_e>=0&&(o.hash=a.substr(_e),a=a.substr(0,_e));let tt=a.indexOf("?");tt>=0&&(o.search=a.substr(tt),a=a.substr(0,tt)),a&&(o.pathname=a)}return o}function getUrlBasedHistory(a,o,_e,tt){tt===void 0&&(tt={});let{window:rt=document.defaultView,v5Compat:st=!1}=tt,at=rt.history,ut=Action.Pop,s=null,et=ot();et==null&&(et=0,at.replaceState(_extends$3({},at.state,{idx:et}),""));function ot(){return(at.state||{idx:null}).idx}function lt(){ut=Action.Pop;let ht=ot(),it=ht==null?null:ht-et;et=ht,s&&s({action:ut,location:ct.location,delta:it})}function St(ht,it){ut=Action.Push;let ft=createLocation(ct.location,ht,it);_e&&_e(ft,ht),et=ot()+1;let mt=getHistoryState(ft,et),Tt=ct.createHref(ft);try{at.pushState(mt,"",Tt)}catch(It){if(It instanceof DOMException&&It.name==="DataCloneError")throw It;rt.location.assign(Tt)}st&&s&&s({action:ut,location:ct.location,delta:1})}function pt(ht,it){ut=Action.Replace;let ft=createLocation(ct.location,ht,it);_e&&_e(ft,ht),et=ot();let mt=getHistoryState(ft,et),Tt=ct.createHref(ft);at.replaceState(mt,"",Tt),st&&s&&s({action:ut,location:ct.location,delta:0})}function gt(ht){let it=rt.location.origin!=="null"?rt.location.origin:rt.location.href,ft=typeof ht=="string"?ht:createPath(ht);return invariant(it,"No window.location.(origin|href) available to create URL for href: "+ft),new URL(ft,it)}let ct={get action(){return ut},get location(){return a(rt,at)},listen(ht){if(s)throw new Error("A history only accepts one active listener");return rt.addEventListener(PopStateEventType,lt),s=ht,()=>{rt.removeEventListener(PopStateEventType,lt),s=null}},createHref(ht){return o(rt,ht)},createURL:gt,encodeLocation(ht){let it=gt(ht);return{pathname:it.pathname,search:it.search,hash:it.hash}},push:St,replace:pt,go(ht){return at.go(ht)}};return ct}var ResultType;(function(a){a.data="data",a.deferred="deferred",a.redirect="redirect",a.error="error"})(ResultType||(ResultType={}));function matchRoutes(a,o,_e){_e===void 0&&(_e="/");let tt=typeof o=="string"?parsePath(o):o,rt=stripBasename(tt.pathname||"/",_e);if(rt==null)return null;let st=flattenRoutes(a);rankRouteBranches(st);let at=null;for(let ut=0;at==null&&ut<st.length;++ut)at=matchRouteBranch(st[ut],safelyDecodeURI(rt));return at}function flattenRoutes(a,o,_e,tt){o===void 0&&(o=[]),_e===void 0&&(_e=[]),tt===void 0&&(tt="");let rt=(st,at,ut)=>{let s={relativePath:ut===void 0?st.path||"":ut,caseSensitive:st.caseSensitive===!0,childrenIndex:at,route:st};s.relativePath.startsWith("/")&&(invariant(s.relativePath.startsWith(tt),'Absolute route path "'+s.relativePath+'" nested under path '+('"'+tt+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),s.relativePath=s.relativePath.slice(tt.length));let et=joinPaths([tt,s.relativePath]),ot=_e.concat(s);st.children&&st.children.length>0&&(invariant(st.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+et+'".')),flattenRoutes(st.children,o,ot,et)),!(st.path==null&&!st.index)&&o.push({path:et,score:computeScore(et,st.index),routesMeta:ot})};return a.forEach((st,at)=>{var ut;if(st.path===""||!((ut=st.path)!=null&&ut.includes("?")))rt(st,at);else for(let s of explodeOptionalSegments(st.path))rt(st,at,s)}),o}function explodeOptionalSegments(a){let o=a.split("/");if(o.length===0)return[];let[_e,...tt]=o,rt=_e.endsWith("?"),st=_e.replace(/\?$/,"");if(tt.length===0)return rt?[st,""]:[st];let at=explodeOptionalSegments(tt.join("/")),ut=[];return ut.push(...at.map(s=>s===""?st:[st,s].join("/"))),rt&&ut.push(...at),ut.map(s=>a.startsWith("/")&&s===""?"/":s)}function rankRouteBranches(a){a.sort((o,_e)=>o.score!==_e.score?_e.score-o.score:compareIndexes(o.routesMeta.map(tt=>tt.childrenIndex),_e.routesMeta.map(tt=>tt.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=a=>a==="*";function computeScore(a,o){let _e=a.split("/"),tt=_e.length;return _e.some(isSplat)&&(tt+=splatPenalty),o&&(tt+=indexRouteValue),_e.filter(rt=>!isSplat(rt)).reduce((rt,st)=>rt+(paramRe.test(st)?dynamicSegmentValue:st===""?emptySegmentValue:staticSegmentValue),tt)}function compareIndexes(a,o){return a.length===o.length&&a.slice(0,-1).every((tt,rt)=>tt===o[rt])?a[a.length-1]-o[o.length-1]:0}function matchRouteBranch(a,o){let{routesMeta:_e}=a,tt={},rt="/",st=[];for(let at=0;at<_e.length;++at){let ut=_e[at],s=at===_e.length-1,et=rt==="/"?o:o.slice(rt.length)||"/",ot=matchPath({path:ut.relativePath,caseSensitive:ut.caseSensitive,end:s},et);if(!ot)return null;Object.assign(tt,ot.params);let lt=ut.route;st.push({params:tt,pathname:joinPaths([rt,ot.pathname]),pathnameBase:normalizePathname(joinPaths([rt,ot.pathnameBase])),route:lt}),ot.pathnameBase!=="/"&&(rt=joinPaths([rt,ot.pathnameBase]))}return st}function matchPath(a,o){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[_e,tt]=compilePath(a.path,a.caseSensitive,a.end),rt=o.match(_e);if(!rt)return null;let st=rt[0],at=st.replace(/(.)\/+$/,"$1"),ut=rt.slice(1);return{params:tt.reduce((et,ot,lt)=>{if(ot==="*"){let St=ut[lt]||"";at=st.slice(0,st.length-St.length).replace(/(.)\/+$/,"$1")}return et[ot]=safelyDecodeURIComponent(ut[lt]||"",ot),et},{}),pathname:st,pathnameBase:at,pattern:a}}function compilePath(a,o,_e){o===void 0&&(o=!1),_e===void 0&&(_e=!0),warning(a==="*"||!a.endsWith("*")||a.endsWith("/*"),'Route path "'+a+'" will be treated as if it were '+('"'+a.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+a.replace(/\*$/,"/*")+'".'));let tt=[],rt="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(at,ut)=>(tt.push(ut),"/([^\\/]+)"));return a.endsWith("*")?(tt.push("*"),rt+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):_e?rt+="\\/*$":a!==""&&a!=="/"&&(rt+="(?:(?=\\/|$))"),[new RegExp(rt,o?void 0:"i"),tt]}function safelyDecodeURI(a){try{return decodeURI(a)}catch(o){return warning(!1,'The URL path "'+a+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),a}}function safelyDecodeURIComponent(a,o){try{return decodeURIComponent(a)}catch(_e){return warning(!1,'The value for the URL param "'+o+'" will not be decoded because'+(' the string "'+a+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+_e+").")),a}}function stripBasename(a,o){if(o==="/")return a;if(!a.toLowerCase().startsWith(o.toLowerCase()))return null;let _e=o.endsWith("/")?o.length-1:o.length,tt=a.charAt(_e);return tt&&tt!=="/"?null:a.slice(_e)||"/"}function resolvePath(a,o){o===void 0&&(o="/");let{pathname:_e,search:tt="",hash:rt=""}=typeof a=="string"?parsePath(a):a;return{pathname:_e?_e.startsWith("/")?_e:resolvePathname(_e,o):o,search:normalizeSearch(tt),hash:normalizeHash(rt)}}function resolvePathname(a,o){let _e=o.replace(/\/+$/,"").split("/");return a.split("/").forEach(rt=>{rt===".."?_e.length>1&&_e.pop():rt!=="."&&_e.push(rt)}),_e.length>1?_e.join("/"):"/"}function getInvalidPathError(a,o,_e,tt){return"Cannot include a '"+a+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(tt)+"].  Please separate it out to the ")+("`to."+_e+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(a){return a.filter((o,_e)=>_e===0||o.route.path&&o.route.path.length>0)}function resolveTo(a,o,_e,tt){tt===void 0&&(tt=!1);let rt;typeof a=="string"?rt=parsePath(a):(rt=_extends$3({},a),invariant(!rt.pathname||!rt.pathname.includes("?"),getInvalidPathError("?","pathname","search",rt)),invariant(!rt.pathname||!rt.pathname.includes("#"),getInvalidPathError("#","pathname","hash",rt)),invariant(!rt.search||!rt.search.includes("#"),getInvalidPathError("#","search","hash",rt)));let st=a===""||rt.pathname==="",at=st?"/":rt.pathname,ut;if(tt||at==null)ut=_e;else{let lt=o.length-1;if(at.startsWith("..")){let St=at.split("/");for(;St[0]==="..";)St.shift(),lt-=1;rt.pathname=St.join("/")}ut=lt>=0?o[lt]:"/"}let s=resolvePath(rt,ut),et=at&&at!=="/"&&at.endsWith("/"),ot=(st||at===".")&&_e.endsWith("/");return!s.pathname.endsWith("/")&&(et||ot)&&(s.pathname+="/"),s}const joinPaths=a=>a.join("/").replace(/\/\/+/g,"/"),normalizePathname=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,normalizeHash=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function isRouteErrorResponse(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.17.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var tt in _e)Object.prototype.hasOwnProperty.call(_e,tt)&&(a[tt]=_e[tt])}return a},_extends$2.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(a){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(a)}function useNavigate(){let{isDataRoute:a}=reactExports.useContext(RouteContext);return a?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let a=reactExports.useContext(DataRouterContext),{basename:o,navigator:_e}=reactExports.useContext(NavigationContext),{matches:tt}=reactExports.useContext(RouteContext),{pathname:rt}=useLocation(),st=JSON.stringify(getPathContributingMatches(tt).map(s=>s.pathnameBase)),at=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{at.current=!0}),reactExports.useCallback(function(s,et){if(et===void 0&&(et={}),!at.current)return;if(typeof s=="number"){_e.go(s);return}let ot=resolveTo(s,JSON.parse(st),rt,et.relative==="path");a==null&&o!=="/"&&(ot.pathname=ot.pathname==="/"?o:joinPaths([o,ot.pathname])),(et.replace?_e.replace:_e.push)(ot,et.state,et)},[o,_e,st,rt,a])}function useParams(){let{matches:a}=reactExports.useContext(RouteContext),o=a[a.length-1];return o?o.params:{}}function useRoutes(a,o){return useRoutesImpl(a,o)}function useRoutesImpl(a,o,_e){useInRouterContext()||invariant(!1);let{navigator:tt}=reactExports.useContext(NavigationContext),{matches:rt}=reactExports.useContext(RouteContext),st=rt[rt.length-1],at=st?st.params:{};st&&st.pathname;let ut=st?st.pathnameBase:"/";st&&st.route;let s=useLocation(),et;if(o){var ot;let ct=typeof o=="string"?parsePath(o):o;ut==="/"||(ot=ct.pathname)!=null&&ot.startsWith(ut)||invariant(!1),et=ct}else et=s;let lt=et.pathname||"/",St=ut==="/"?lt:lt.slice(ut.length)||"/",pt=matchRoutes(a,{pathname:St}),gt=_renderMatches(pt&&pt.map(ct=>Object.assign({},ct,{params:Object.assign({},at,ct.params),pathname:joinPaths([ut,tt.encodeLocation?tt.encodeLocation(ct.pathname).pathname:ct.pathname]),pathnameBase:ct.pathnameBase==="/"?ut:joinPaths([ut,tt.encodeLocation?tt.encodeLocation(ct.pathnameBase).pathname:ct.pathnameBase])})),rt,_e);return o&&gt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$2({pathname:"/",search:"",hash:"",state:null,key:"default"},et),navigationType:Action.Pop}},gt):gt}function DefaultErrorComponent(){let a=useRouteError(),o=isRouteErrorResponse(a)?a.status+" "+a.statusText:a instanceof Error?a.message:JSON.stringify(a),_e=a instanceof Error?a.stack:null,rt={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},st=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},o),_e?reactExports.createElement("pre",{style:rt},_e):null,st)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,_e){return _e.location!==o.location||_e.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error||_e.error,location:_e.location,revalidation:o.revalidation||_e.revalidation}}componentDidCatch(o,_e){console.error("React Router caught the following error during render",o,_e)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(a){let{routeContext:o,match:_e,children:tt}=a,rt=reactExports.useContext(DataRouterContext);return rt&&rt.static&&rt.staticContext&&(_e.route.errorElement||_e.route.ErrorBoundary)&&(rt.staticContext._deepestRenderedBoundaryId=_e.route.id),reactExports.createElement(RouteContext.Provider,{value:o},tt)}function _renderMatches(a,o,_e){var tt;if(o===void 0&&(o=[]),_e===void 0&&(_e=null),a==null){var rt;if((rt=_e)!=null&&rt.errors)a=_e.matches;else return null}let st=a,at=(tt=_e)==null?void 0:tt.errors;if(at!=null){let ut=st.findIndex(s=>s.route.id&&(at==null?void 0:at[s.route.id]));ut>=0||invariant(!1),st=st.slice(0,Math.min(st.length,ut+1))}return st.reduceRight((ut,s,et)=>{let ot=s.route.id?at==null?void 0:at[s.route.id]:null,lt=null;_e&&(lt=s.route.errorElement||defaultErrorElement);let St=o.concat(st.slice(0,et+1)),pt=()=>{let gt;return ot?gt=lt:s.route.Component?gt=reactExports.createElement(s.route.Component,null):s.route.element?gt=s.route.element:gt=ut,reactExports.createElement(RenderedRoute,{match:s,routeContext:{outlet:ut,matches:St,isDataRoute:_e!=null},children:gt})};return _e&&(s.route.ErrorBoundary||s.route.errorElement||et===0)?reactExports.createElement(RenderErrorBoundary,{location:_e.location,revalidation:_e.revalidation,component:lt,error:ot,children:pt(),routeContext:{outlet:null,matches:St,isDataRoute:!0}}):pt()},null)}var DataRouterHook$1=function(a){return a.UseBlocker="useBlocker",a.UseRevalidator="useRevalidator",a.UseNavigateStable="useNavigate",a}(DataRouterHook$1||{}),DataRouterStateHook$1=function(a){return a.UseBlocker="useBlocker",a.UseLoaderData="useLoaderData",a.UseActionData="useActionData",a.UseRouteError="useRouteError",a.UseNavigation="useNavigation",a.UseRouteLoaderData="useRouteLoaderData",a.UseMatches="useMatches",a.UseRevalidator="useRevalidator",a.UseNavigateStable="useNavigate",a.UseRouteId="useRouteId",a}(DataRouterStateHook$1||{});function useDataRouterContext(a){let o=reactExports.useContext(DataRouterContext);return o||invariant(!1),o}function useDataRouterState(a){let o=reactExports.useContext(DataRouterStateContext);return o||invariant(!1),o}function useRouteContext(a){let o=reactExports.useContext(RouteContext);return o||invariant(!1),o}function useCurrentRouteId(a){let o=useRouteContext(),_e=o.matches[o.matches.length-1];return _e.route.id||invariant(!1),_e.route.id}function useRouteError(){var a;let o=reactExports.useContext(RouteErrorContext),_e=useDataRouterState(DataRouterStateHook$1.UseRouteError),tt=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return o||((a=_e.errors)==null?void 0:a[tt])}function useNavigateStable(){let{router:a}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),o=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),_e=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{_e.current=!0}),reactExports.useCallback(function(rt,st){st===void 0&&(st={}),_e.current&&(typeof rt=="number"?a.navigate(rt):a.navigate(rt,_extends$2({fromRouteId:o},st)))},[a,o])}function Route(a){invariant(!1)}function Router(a){let{basename:o="/",children:_e=null,location:tt,navigationType:rt=Action.Pop,navigator:st,static:at=!1}=a;useInRouterContext()&&invariant(!1);let ut=o.replace(/^\/*/,"/"),s=reactExports.useMemo(()=>({basename:ut,navigator:st,static:at}),[ut,st,at]);typeof tt=="string"&&(tt=parsePath(tt));let{pathname:et="/",search:ot="",hash:lt="",state:St=null,key:pt="default"}=tt,gt=reactExports.useMemo(()=>{let ct=stripBasename(et,ut);return ct==null?null:{location:{pathname:ct,search:ot,hash:lt,state:St,key:pt},navigationType:rt}},[ut,et,ot,lt,St,pt,rt]);return gt==null?null:reactExports.createElement(NavigationContext.Provider,{value:s},reactExports.createElement(LocationContext.Provider,{children:_e,value:gt}))}function Routes(a){let{children:o,location:_e}=a;return useRoutes(createRoutesFromChildren(o),_e)}new Promise(()=>{});function createRoutesFromChildren(a,o){o===void 0&&(o=[]);let _e=[];return reactExports.Children.forEach(a,(tt,rt)=>{if(!reactExports.isValidElement(tt))return;let st=[...o,rt];if(tt.type===reactExports.Fragment){_e.push.apply(_e,createRoutesFromChildren(tt.props.children,st));return}tt.type!==Route&&invariant(!1),!tt.props.index||!tt.props.children||invariant(!1);let at={id:tt.props.id||st.join("-"),caseSensitive:tt.props.caseSensitive,element:tt.props.element,Component:tt.props.Component,index:tt.props.index,path:tt.props.path,loader:tt.props.loader,action:tt.props.action,errorElement:tt.props.errorElement,ErrorBoundary:tt.props.ErrorBoundary,hasErrorBoundary:tt.props.ErrorBoundary!=null||tt.props.errorElement!=null,shouldRevalidate:tt.props.shouldRevalidate,handle:tt.props.handle,lazy:tt.props.lazy};tt.props.children&&(at.children=createRoutesFromChildren(tt.props.children,st)),_e.push(at)}),_e}/**
 * React Router DOM v6.17.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function createSearchParams(a){return a===void 0&&(a=""),new URLSearchParams(typeof a=="string"||Array.isArray(a)||a instanceof URLSearchParams?a:Object.keys(a).reduce((o,_e)=>{let tt=a[_e];return o.concat(Array.isArray(tt)?tt.map(rt=>[_e,rt]):[[_e,tt]])},[]))}function getSearchParamsForLocation(a,o){let _e=createSearchParams(a);return o&&o.forEach((tt,rt)=>{_e.has(rt)||o.getAll(rt).forEach(st=>{_e.append(rt,st)})}),_e}const START_TRANSITION="startTransition",startTransitionImpl=React$2[START_TRANSITION];function BrowserRouter(a){let{basename:o,children:_e,future:tt,window:rt}=a,st=reactExports.useRef();st.current==null&&(st.current=createBrowserHistory({window:rt,v5Compat:!0}));let at=st.current,[ut,s]=reactExports.useState({action:at.action,location:at.location}),{v7_startTransition:et}=tt||{},ot=reactExports.useCallback(lt=>{et&&startTransitionImpl?startTransitionImpl(()=>s(lt)):s(lt)},[s,et]);return reactExports.useLayoutEffect(()=>at.listen(ot),[at,ot]),reactExports.createElement(Router,{basename:o,children:_e,location:ut.location,navigationType:ut.action,navigator:at})}var DataRouterHook;(function(a){a.UseScrollRestoration="useScrollRestoration",a.UseSubmit="useSubmit",a.UseSubmitFetcher="useSubmitFetcher",a.UseFetcher="useFetcher",a.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(a){a.UseFetchers="useFetchers",a.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useSearchParams(a){let o=reactExports.useRef(createSearchParams(a)),_e=reactExports.useRef(!1),tt=useLocation(),rt=reactExports.useMemo(()=>getSearchParamsForLocation(tt.search,_e.current?null:o.current),[tt.search]),st=useNavigate(),at=reactExports.useCallback((ut,s)=>{const et=createSearchParams(typeof ut=="function"?ut(rt):ut);_e.current=!0,st("?"+et,s)},[st,rt]);return[rt,at]}var lib={},uaParser_min={exports:{}};(function(a,o){(function(_e,tt){var rt="1.0.36",st="",at="?",ut="function",s="undefined",et="object",ot="string",lt="major",St="model",pt="name",gt="type",ct="vendor",ht="version",it="architecture",ft="console",mt="mobile",Tt="tablet",It="smarttv",Pt="wearable",At="embedded",Nt=350,Ot="Amazon",Mt="Apple",bt="ASUS",Wt="BlackBerry",zt="Browser",Bt="Chrome",rn="Edge",gn="Firefox",tn="Google",Ht="Huawei",fn="LG",bn="Microsoft",In="Motorola",un="Opera",mn="Samsung",yn="Sharp",pn="Sony",Tn="Xiaomi",kn="Zebra",xn="Facebook",Mn="Chromium OS",Dn="Mac OS",An=function(_n,Ln){var vn={};for(var On in _n)Ln[On]&&Ln[On].length%2===0?vn[On]=Ln[On].concat(_n[On]):vn[On]=_n[On];return vn},Nn=function(_n){for(var Ln={},vn=0;vn<_n.length;vn++)Ln[_n[vn].toUpperCase()]=_n[vn];return Ln},Un=function(_n,Ln){return typeof _n===ot?Qn(Ln).indexOf(Qn(_n))!==-1:!1},Qn=function(_n){return _n.toLowerCase()},er=function(_n){return typeof _n===ot?_n.replace(/[^\d\.]/g,st).split(".")[0]:tt},zn=function(_n,Ln){if(typeof _n===ot)return _n=_n.replace(/^\s\s*/,st),typeof Ln===s?_n:_n.substring(0,Nt)},lr=function(_n,Ln){for(var vn=0,On,Kt,Rt,nt,Ct,yt;vn<Ln.length&&!Ct;){var xt=Ln[vn],wt=Ln[vn+1];for(On=Kt=0;On<xt.length&&!Ct&&xt[On];)if(Ct=xt[On++].exec(_n),Ct)for(Rt=0;Rt<wt.length;Rt++)yt=Ct[++Kt],nt=wt[Rt],typeof nt===et&&nt.length>0?nt.length===2?typeof nt[1]==ut?this[nt[0]]=nt[1].call(this,yt):this[nt[0]]=nt[1]:nt.length===3?typeof nt[1]===ut&&!(nt[1].exec&&nt[1].test)?this[nt[0]]=yt?nt[1].call(this,yt,nt[2]):tt:this[nt[0]]=yt?yt.replace(nt[1],nt[2]):tt:nt.length===4&&(this[nt[0]]=yt?nt[3].call(this,yt.replace(nt[1],nt[2])):tt):this[nt]=yt||tt;vn+=2}},cn=function(_n,Ln){for(var vn in Ln)if(typeof Ln[vn]===et&&Ln[vn].length>0){for(var On=0;On<Ln[vn].length;On++)if(Un(Ln[vn][On],_n))return vn===at?tt:vn}else if(Un(Ln[vn],_n))return vn===at?tt:vn;return _n},Gn={"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Yn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},or={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[ht,[pt,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[ht,[pt,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[pt,ht],[/opios[\/ ]+([\w\.]+)/i],[ht,[pt,un+" Mini"]],[/\bopr\/([\w\.]+)/i],[ht,[pt,un]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[pt,ht],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[ht,[pt,"UC"+zt]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[ht,[pt,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[ht,[pt,"WeChat"]],[/konqueror\/([\w\.]+)/i],[ht,[pt,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[ht,[pt,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[ht,[pt,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[pt,/(.+)/,"$1 Secure "+zt],ht],[/\bfocus\/([\w\.]+)/i],[ht,[pt,gn+" Focus"]],[/\bopt\/([\w\.]+)/i],[ht,[pt,un+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[ht,[pt,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[ht,[pt,"Dolphin"]],[/coast\/([\w\.]+)/i],[ht,[pt,un+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[ht,[pt,"MIUI "+zt]],[/fxios\/([-\w\.]+)/i],[ht,[pt,gn]],[/\bqihu|(qi?ho?o?|360)browser/i],[[pt,"360 "+zt]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[pt,/(.+)/,"$1 "+zt],ht],[/(comodo_dragon)\/([\w\.]+)/i],[[pt,/_/g," "],ht],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[pt,ht],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[pt],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[pt,xn],ht],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[pt,ht],[/\bgsa\/([\w\.]+) .*safari\//i],[ht,[pt,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[ht,[pt,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[ht,[pt,Bt+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[pt,Bt+" WebView"],ht],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[ht,[pt,"Android "+zt]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[pt,ht],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[ht,[pt,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[ht,pt],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[pt,[ht,cn,Gn]],[/(webkit|khtml)\/([\w\.]+)/i],[pt,ht],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[pt,"Netscape"],ht],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[ht,[pt,gn+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[pt,ht],[/(cobalt)\/([\w\.]+)/i],[pt,[ht,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[it,"amd64"]],[/(ia32(?=;))/i],[[it,Qn]],[/((?:i[346]|x)86)[;\)]/i],[[it,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[it,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[it,"armhf"]],[/windows (ce|mobile); ppc;/i],[[it,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[it,/ower/,st,Qn]],[/(sun4\w)[;\)]/i],[[it,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[it,Qn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[St,[ct,mn],[gt,Tt]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[St,[ct,mn],[gt,mt]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[St,[ct,Mt],[gt,mt]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[St,[ct,Mt],[gt,Tt]],[/(macintosh);/i],[St,[ct,Mt]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[St,[ct,yn],[gt,mt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[St,[ct,Ht],[gt,Tt]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[St,[ct,Ht],[gt,mt]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[St,/_/g," "],[ct,Tn],[gt,mt]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[St,/_/g," "],[ct,Tn],[gt,Tt]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[St,[ct,"OPPO"],[gt,mt]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[St,[ct,"Vivo"],[gt,mt]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[St,[ct,"Realme"],[gt,mt]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[St,[ct,In],[gt,mt]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[St,[ct,In],[gt,Tt]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[St,[ct,fn],[gt,Tt]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[St,[ct,fn],[gt,mt]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[St,[ct,"Lenovo"],[gt,Tt]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[St,/_/g," "],[ct,"Nokia"],[gt,mt]],[/(pixel c)\b/i],[St,[ct,tn],[gt,Tt]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[St,[ct,tn],[gt,mt]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[St,[ct,pn],[gt,mt]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[St,"Xperia Tablet"],[ct,pn],[gt,Tt]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[St,[ct,"OnePlus"],[gt,mt]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[St,[ct,Ot],[gt,Tt]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[St,/(.+)/g,"Fire Phone $1"],[ct,Ot],[gt,mt]],[/(playbook);[-\w\),; ]+(rim)/i],[St,ct,[gt,Tt]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[St,[ct,Wt],[gt,mt]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[St,[ct,bt],[gt,Tt]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[St,[ct,bt],[gt,mt]],[/(nexus 9)/i],[St,[ct,"HTC"],[gt,Tt]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[ct,[St,/_/g," "],[gt,mt]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[St,[ct,"Acer"],[gt,Tt]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[St,[ct,"Meizu"],[gt,mt]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[ct,St,[gt,mt]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[ct,St,[gt,Tt]],[/(surface duo)/i],[St,[ct,bn],[gt,Tt]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[St,[ct,"Fairphone"],[gt,mt]],[/(u304aa)/i],[St,[ct,"AT&T"],[gt,mt]],[/\bsie-(\w*)/i],[St,[ct,"Siemens"],[gt,mt]],[/\b(rct\w+) b/i],[St,[ct,"RCA"],[gt,Tt]],[/\b(venue[\d ]{2,7}) b/i],[St,[ct,"Dell"],[gt,Tt]],[/\b(q(?:mv|ta)\w+) b/i],[St,[ct,"Verizon"],[gt,Tt]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[St,[ct,"Barnes & Noble"],[gt,Tt]],[/\b(tm\d{3}\w+) b/i],[St,[ct,"NuVision"],[gt,Tt]],[/\b(k88) b/i],[St,[ct,"ZTE"],[gt,Tt]],[/\b(nx\d{3}j) b/i],[St,[ct,"ZTE"],[gt,mt]],[/\b(gen\d{3}) b.+49h/i],[St,[ct,"Swiss"],[gt,mt]],[/\b(zur\d{3}) b/i],[St,[ct,"Swiss"],[gt,Tt]],[/\b((zeki)?tb.*\b) b/i],[St,[ct,"Zeki"],[gt,Tt]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[ct,"Dragon Touch"],St,[gt,Tt]],[/\b(ns-?\w{0,9}) b/i],[St,[ct,"Insignia"],[gt,Tt]],[/\b((nxa|next)-?\w{0,9}) b/i],[St,[ct,"NextBook"],[gt,Tt]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[ct,"Voice"],St,[gt,mt]],[/\b(lvtel\-)?(v1[12]) b/i],[[ct,"LvTel"],St,[gt,mt]],[/\b(ph-1) /i],[St,[ct,"Essential"],[gt,mt]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[St,[ct,"Envizen"],[gt,Tt]],[/\b(trio[-\w\. ]+) b/i],[St,[ct,"MachSpeed"],[gt,Tt]],[/\btu_(1491) b/i],[St,[ct,"Rotor"],[gt,Tt]],[/(shield[\w ]+) b/i],[St,[ct,"Nvidia"],[gt,Tt]],[/(sprint) (\w+)/i],[ct,St,[gt,mt]],[/(kin\.[onetw]{3})/i],[[St,/\./g," "],[ct,bn],[gt,mt]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[St,[ct,kn],[gt,Tt]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[St,[ct,kn],[gt,mt]],[/smart-tv.+(samsung)/i],[ct,[gt,It]],[/hbbtv.+maple;(\d+)/i],[[St,/^/,"SmartTV"],[ct,mn],[gt,It]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[ct,fn],[gt,It]],[/(apple) ?tv/i],[ct,[St,Mt+" TV"],[gt,It]],[/crkey/i],[[St,Bt+"cast"],[ct,tn],[gt,It]],[/droid.+aft(\w+)( bui|\))/i],[St,[ct,Ot],[gt,It]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[St,[ct,yn],[gt,It]],[/(bravia[\w ]+)( bui|\))/i],[St,[ct,pn],[gt,It]],[/(mitv-\w{5}) bui/i],[St,[ct,Tn],[gt,It]],[/Hbbtv.*(technisat) (.*);/i],[ct,St,[gt,It]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[ct,zn],[St,zn],[gt,It]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[gt,It]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[ct,St,[gt,ft]],[/droid.+; (shield) bui/i],[St,[ct,"Nvidia"],[gt,ft]],[/(playstation [345portablevi]+)/i],[St,[ct,pn],[gt,ft]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[St,[ct,bn],[gt,ft]],[/((pebble))app/i],[ct,St,[gt,Pt]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[St,[ct,Mt],[gt,Pt]],[/droid.+; (glass) \d/i],[St,[ct,tn],[gt,Pt]],[/droid.+; (wt63?0{2,3})\)/i],[St,[ct,kn],[gt,Pt]],[/(quest( 2| pro)?)/i],[St,[ct,xn],[gt,Pt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[ct,[gt,At]],[/(aeobc)\b/i],[St,[ct,Ot],[gt,At]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[St,[gt,mt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[St,[gt,Tt]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[gt,Tt]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[gt,mt]],[/(android[-\w\. ]{0,9});.+buil/i],[St,[ct,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[ht,[pt,rn+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[ht,[pt,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[pt,ht],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[ht,pt]],os:[[/microsoft (windows) (vista|xp)/i],[pt,ht],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[pt,[ht,cn,Yn]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[pt,"Windows"],[ht,cn,Yn]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[ht,/_/g,"."],[pt,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[pt,Dn],[ht,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[ht,pt],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[pt,ht],[/\(bb(10);/i],[ht,[pt,Wt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[ht,[pt,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[ht,[pt,gn+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[ht,[pt,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[ht,[pt,"watchOS"]],[/crkey\/([\d\.]+)/i],[ht,[pt,Bt+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[pt,Mn],ht],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[pt,ht],[/(sunos) ?([\w\.\d]*)/i],[[pt,"Solaris"],ht],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[pt,ht]]},Bn=function(_n,Ln){if(typeof _n===et&&(Ln=_n,_n=tt),!(this instanceof Bn))return new Bn(_n,Ln).getResult();var vn=typeof _e!==s&&_e.navigator?_e.navigator:tt,On=_n||(vn&&vn.userAgent?vn.userAgent:st),Kt=vn&&vn.userAgentData?vn.userAgentData:tt,Rt=Ln?An(or,Ln):or,nt=vn&&vn.userAgent==On;return this.getBrowser=function(){var Ct={};return Ct[pt]=tt,Ct[ht]=tt,lr.call(Ct,On,Rt.browser),Ct[lt]=er(Ct[ht]),nt&&vn&&vn.brave&&typeof vn.brave.isBrave==ut&&(Ct[pt]="Brave"),Ct},this.getCPU=function(){var Ct={};return Ct[it]=tt,lr.call(Ct,On,Rt.cpu),Ct},this.getDevice=function(){var Ct={};return Ct[ct]=tt,Ct[St]=tt,Ct[gt]=tt,lr.call(Ct,On,Rt.device),nt&&!Ct[gt]&&Kt&&Kt.mobile&&(Ct[gt]=mt),nt&&Ct[St]=="Macintosh"&&vn&&typeof vn.standalone!==s&&vn.maxTouchPoints&&vn.maxTouchPoints>2&&(Ct[St]="iPad",Ct[gt]=Tt),Ct},this.getEngine=function(){var Ct={};return Ct[pt]=tt,Ct[ht]=tt,lr.call(Ct,On,Rt.engine),Ct},this.getOS=function(){var Ct={};return Ct[pt]=tt,Ct[ht]=tt,lr.call(Ct,On,Rt.os),nt&&!Ct[pt]&&Kt&&Kt.platform!="Unknown"&&(Ct[pt]=Kt.platform.replace(/chrome os/i,Mn).replace(/macos/i,Dn)),Ct},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return On},this.setUA=function(Ct){return On=typeof Ct===ot&&Ct.length>Nt?zn(Ct,Nt):Ct,this},this.setUA(On),this};Bn.VERSION=rt,Bn.BROWSER=Nn([pt,ht,lt]),Bn.CPU=Nn([it]),Bn.DEVICE=Nn([St,ct,gt,ft,mt,It,Tt,Pt,At]),Bn.ENGINE=Bn.OS=Nn([pt,ht]),a.exports&&(o=a.exports=Bn),o.UAParser=Bn;var rr=typeof _e!==s&&(_e.jQuery||_e.Zepto);if(rr&&!rr.ua){var Zn=new Bn;rr.ua=Zn.getResult(),rr.ua.get=function(){return Zn.getUA()},rr.ua.set=function(_n){Zn.setUA(_n);var Ln=Zn.getResult();for(var vn in Ln)rr.ua[vn]=Ln[vn]}}})(typeof window=="object"?window:commonjsGlobal)})(uaParser_min,uaParser_min.exports);var uaParser_minExports=uaParser_min.exports;Object.defineProperty(lib,"__esModule",{value:!0});function _interopDefault(a){return a&&typeof a=="object"&&"default"in a?a.default:a}var React=reactExports,React__default=_interopDefault(React),UAParser$1=uaParser_minExports,ClientUAInstance=new UAParser$1,browser=ClientUAInstance.getBrowser(),cpu=ClientUAInstance.getCPU(),device=ClientUAInstance.getDevice(),engine=ClientUAInstance.getEngine(),os=ClientUAInstance.getOS(),ua=ClientUAInstance.getUA(),setUa=function(o){return ClientUAInstance.setUA(o)},parseUserAgent=function(o){if(!o){console.error("No userAgent string was provided");return}var _e=new UAParser$1(o);return{UA:_e,browser:_e.getBrowser(),cpu:_e.getCPU(),device:_e.getDevice(),engine:_e.getEngine(),os:_e.getOS(),ua:_e.getUA(),setUserAgent:function(rt){return _e.setUA(rt)}}},UAHelper=Object.freeze({ClientUAInstance,browser,cpu,device,engine,os,ua,setUa,parseUserAgent});function ownKeys(a,o){var _e=Object.keys(a);if(Object.getOwnPropertySymbols){var tt=Object.getOwnPropertySymbols(a);o&&(tt=tt.filter(function(rt){return Object.getOwnPropertyDescriptor(a,rt).enumerable})),_e.push.apply(_e,tt)}return _e}function _objectSpread2(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o]!=null?arguments[o]:{};o%2?ownKeys(Object(_e),!0).forEach(function(tt){_defineProperty(a,tt,_e[tt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(_e)):ownKeys(Object(_e)).forEach(function(tt){Object.defineProperty(a,tt,Object.getOwnPropertyDescriptor(_e,tt))})}return a}function _typeof(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(o){return typeof o}:_typeof=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(a)}function _classCallCheck(a,o){if(!(a instanceof o))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,o){for(var _e=0;_e<o.length;_e++){var tt=o[_e];tt.enumerable=tt.enumerable||!1,tt.configurable=!0,"value"in tt&&(tt.writable=!0),Object.defineProperty(a,tt.key,tt)}}function _createClass(a,o,_e){return o&&_defineProperties(a.prototype,o),_e&&_defineProperties(a,_e),a}function _defineProperty(a,o,_e){return o in a?Object.defineProperty(a,o,{value:_e,enumerable:!0,configurable:!0,writable:!0}):a[o]=_e,a}function _extends$1(){return _extends$1=Object.assign||function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var tt in _e)Object.prototype.hasOwnProperty.call(_e,tt)&&(a[tt]=_e[tt])}return a},_extends$1.apply(this,arguments)}function _inherits(a,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(o&&o.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),o&&_setPrototypeOf$1(a,o)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(_e){return _e.__proto__||Object.getPrototypeOf(_e)},_getPrototypeOf(a)}function _setPrototypeOf$1(a,o){return _setPrototypeOf$1=Object.setPrototypeOf||function(tt,rt){return tt.__proto__=rt,tt},_setPrototypeOf$1(a,o)}function _objectWithoutPropertiesLoose$1(a,o){if(a==null)return{};var _e={},tt=Object.keys(a),rt,st;for(st=0;st<tt.length;st++)rt=tt[st],!(o.indexOf(rt)>=0)&&(_e[rt]=a[rt]);return _e}function _objectWithoutProperties(a,o){if(a==null)return{};var _e=_objectWithoutPropertiesLoose$1(a,o),tt,rt;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(a);for(rt=0;rt<st.length;rt++)tt=st[rt],!(o.indexOf(tt)>=0)&&Object.prototype.propertyIsEnumerable.call(a,tt)&&(_e[tt]=a[tt])}return _e}function _assertThisInitialized$1(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _possibleConstructorReturn(a,o){if(o&&(typeof o=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(a)}function _slicedToArray(a,o){return _arrayWithHoles(a)||_iterableToArrayLimit(a,o)||_unsupportedIterableToArray(a,o)||_nonIterableRest()}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _iterableToArrayLimit(a,o){var _e=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(_e!=null){var tt=[],rt=!0,st=!1,at,ut;try{for(_e=_e.call(a);!(rt=(at=_e.next()).done)&&(tt.push(at.value),!(o&&tt.length===o));rt=!0);}catch(s){st=!0,ut=s}finally{try{!rt&&_e.return!=null&&_e.return()}finally{if(st)throw ut}}return tt}}function _unsupportedIterableToArray(a,o){if(a){if(typeof a=="string")return _arrayLikeToArray(a,o);var _e=Object.prototype.toString.call(a).slice(8,-1);if(_e==="Object"&&a.constructor&&(_e=a.constructor.name),_e==="Map"||_e==="Set")return Array.from(a);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return _arrayLikeToArray(a,o)}}function _arrayLikeToArray(a,o){(o==null||o>a.length)&&(o=a.length);for(var _e=0,tt=new Array(o);_e<o;_e++)tt[_e]=a[_e];return tt}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var DeviceTypes={Mobile:"mobile",Tablet:"tablet",SmartTv:"smarttv",Console:"console",Wearable:"wearable",Embedded:"embedded",Browser:void 0},BrowserTypes={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",EdgeChromium:"Edge Chromium",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},OsTypes={IOS:"iOS",Android:"Android",WindowsPhone:"Windows Phone",Windows:"Windows",MAC_OS:"Mac OS"},InitialDeviceTypes={isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1},checkDeviceType=function(o){switch(o){case DeviceTypes.Mobile:return{isMobile:!0};case DeviceTypes.Tablet:return{isTablet:!0};case DeviceTypes.SmartTv:return{isSmartTV:!0};case DeviceTypes.Console:return{isConsole:!0};case DeviceTypes.Wearable:return{isWearable:!0};case DeviceTypes.Browser:return{isBrowser:!0};case DeviceTypes.Embedded:return{isEmbedded:!0};default:return InitialDeviceTypes}},setUserAgent=function(o){return setUa(o)},setDefaults=function(o){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none";return o||_e},getNavigatorInstance=function(){return typeof window<"u"&&(window.navigator||navigator)?window.navigator||navigator:!1},isIOS13Check=function(o){var _e=getNavigatorInstance();return _e&&_e.platform&&(_e.platform.indexOf(o)!==-1||_e.platform==="MacIntel"&&_e.maxTouchPoints>1&&!window.MSStream)},browserPayload=function(o,_e,tt,rt,st){return{isBrowser:o,browserMajorVersion:setDefaults(_e.major),browserFullVersion:setDefaults(_e.version),browserName:setDefaults(_e.name),engineName:setDefaults(tt.name),engineVersion:setDefaults(tt.version),osName:setDefaults(rt.name),osVersion:setDefaults(rt.version),userAgent:setDefaults(st)}},mobilePayload=function(o,_e,tt,rt){return _objectSpread2({},o,{vendor:setDefaults(_e.vendor),model:setDefaults(_e.model),os:setDefaults(tt.name),osVersion:setDefaults(tt.version),ua:setDefaults(rt)})},smartTvPayload=function(o,_e,tt,rt){return{isSmartTV:o,engineName:setDefaults(_e.name),engineVersion:setDefaults(_e.version),osName:setDefaults(tt.name),osVersion:setDefaults(tt.version),userAgent:setDefaults(rt)}},consolePayload=function(o,_e,tt,rt){return{isConsole:o,engineName:setDefaults(_e.name),engineVersion:setDefaults(_e.version),osName:setDefaults(tt.name),osVersion:setDefaults(tt.version),userAgent:setDefaults(rt)}},wearablePayload=function(o,_e,tt,rt){return{isWearable:o,engineName:setDefaults(_e.name),engineVersion:setDefaults(_e.version),osName:setDefaults(tt.name),osVersion:setDefaults(tt.version),userAgent:setDefaults(rt)}},embeddedPayload=function(o,_e,tt,rt,st){return{isEmbedded:o,vendor:setDefaults(_e.vendor),model:setDefaults(_e.model),engineName:setDefaults(tt.name),engineVersion:setDefaults(tt.version),osName:setDefaults(rt.name),osVersion:setDefaults(rt.version),userAgent:setDefaults(st)}};function deviceDetect(a){var o=a?parseUserAgent(a):UAHelper,_e=o.device,tt=o.browser,rt=o.engine,st=o.os,at=o.ua,ut=checkDeviceType(_e.type),s=ut.isBrowser,et=ut.isMobile,ot=ut.isTablet,lt=ut.isSmartTV,St=ut.isConsole,pt=ut.isWearable,gt=ut.isEmbedded;if(s)return browserPayload(s,tt,rt,st,at);if(lt)return smartTvPayload(lt,rt,st,at);if(St)return consolePayload(St,rt,st,at);if(et||ot)return mobilePayload(ut,_e,st,at);if(pt)return wearablePayload(pt,rt,st,at);if(gt)return embeddedPayload(gt,_e,rt,st,at)}var isMobileType=function(o){var _e=o.type;return _e===DeviceTypes.Mobile},isTabletType=function(o){var _e=o.type;return _e===DeviceTypes.Tablet},isMobileAndTabletType=function(o){var _e=o.type;return _e===DeviceTypes.Mobile||_e===DeviceTypes.Tablet},isSmartTVType=function(o){var _e=o.type;return _e===DeviceTypes.SmartTv},isBrowserType=function(o){var _e=o.type;return _e===DeviceTypes.Browser},isWearableType=function(o){var _e=o.type;return _e===DeviceTypes.Wearable},isConsoleType=function(o){var _e=o.type;return _e===DeviceTypes.Console},isEmbeddedType=function(o){var _e=o.type;return _e===DeviceTypes.Embedded},getMobileVendor=function(o){var _e=o.vendor;return setDefaults(_e)},getMobileModel=function(o){var _e=o.model;return setDefaults(_e)},getDeviceType=function(o){var _e=o.type;return setDefaults(_e,"browser")},isAndroidType=function(o){var _e=o.name;return _e===OsTypes.Android},isWindowsType=function(o){var _e=o.name;return _e===OsTypes.Windows},isMacOsType=function(o){var _e=o.name;return _e===OsTypes.MAC_OS},isWinPhoneType=function(o){var _e=o.name;return _e===OsTypes.WindowsPhone},isIOSType=function(o){var _e=o.name;return _e===OsTypes.IOS},getOsVersion=function(o){var _e=o.version;return setDefaults(_e)},getOsName=function(o){var _e=o.name;return setDefaults(_e)},isChromeType=function(o){var _e=o.name;return _e===BrowserTypes.Chrome},isFirefoxType=function(o){var _e=o.name;return _e===BrowserTypes.Firefox},isChromiumType=function(o){var _e=o.name;return _e===BrowserTypes.Chromium},isEdgeType=function(o){var _e=o.name;return _e===BrowserTypes.Edge},isYandexType=function(o){var _e=o.name;return _e===BrowserTypes.Yandex},isSafariType=function(o){var _e=o.name;return _e===BrowserTypes.Safari||_e===BrowserTypes.MobileSafari},isMobileSafariType=function(o){var _e=o.name;return _e===BrowserTypes.MobileSafari},isOperaType=function(o){var _e=o.name;return _e===BrowserTypes.Opera},isIEType=function(o){var _e=o.name;return _e===BrowserTypes.InternetExplorer||_e===BrowserTypes.Ie},isMIUIType=function(o){var _e=o.name;return _e===BrowserTypes.MIUI},isSamsungBrowserType=function(o){var _e=o.name;return _e===BrowserTypes.SamsungBrowser},getBrowserFullVersion=function(o){var _e=o.version;return setDefaults(_e)},getBrowserVersion=function(o){var _e=o.major;return setDefaults(_e)},getBrowserName=function(o){var _e=o.name;return setDefaults(_e)},getEngineName=function(o){var _e=o.name;return setDefaults(_e)},getEngineVersion=function(o){var _e=o.version;return setDefaults(_e)},isElectronType=function(){var o=getNavigatorInstance(),_e=o&&o.userAgent&&o.userAgent.toLowerCase();return typeof _e=="string"?/electron/.test(_e):!1},isEdgeChromiumType=function(o){return typeof o=="string"&&o.indexOf("Edg/")!==-1},getIOS13=function(){var o=getNavigatorInstance();return o&&(/iPad|iPhone|iPod/.test(o.platform)||o.platform==="MacIntel"&&o.maxTouchPoints>1)&&!window.MSStream},getIPad13=function(){return isIOS13Check("iPad")},getIphone13=function(){return isIOS13Check("iPhone")},getIPod13=function(){return isIOS13Check("iPod")},getUseragent=function(o){return setDefaults(o)};function buildSelectorsObject(a){var o=a||UAHelper,_e=o.device,tt=o.browser,rt=o.os,st=o.engine,at=o.ua;return{isSmartTV:isSmartTVType(_e),isConsole:isConsoleType(_e),isWearable:isWearableType(_e),isEmbedded:isEmbeddedType(_e),isMobileSafari:isMobileSafariType(tt)||getIPad13(),isChromium:isChromiumType(tt),isMobile:isMobileAndTabletType(_e)||getIPad13(),isMobileOnly:isMobileType(_e),isTablet:isTabletType(_e)||getIPad13(),isBrowser:isBrowserType(_e),isDesktop:isBrowserType(_e),isAndroid:isAndroidType(rt),isWinPhone:isWinPhoneType(rt),isIOS:isIOSType(rt)||getIPad13(),isChrome:isChromeType(tt),isFirefox:isFirefoxType(tt),isSafari:isSafariType(tt),isOpera:isOperaType(tt),isIE:isIEType(tt),osVersion:getOsVersion(rt),osName:getOsName(rt),fullBrowserVersion:getBrowserFullVersion(tt),browserVersion:getBrowserVersion(tt),browserName:getBrowserName(tt),mobileVendor:getMobileVendor(_e),mobileModel:getMobileModel(_e),engineName:getEngineName(st),engineVersion:getEngineVersion(st),getUA:getUseragent(at),isEdge:isEdgeType(tt)||isEdgeChromiumType(at),isYandex:isYandexType(tt),deviceType:getDeviceType(_e),isIOS13:getIOS13(),isIPad13:getIPad13(),isIPhone13:getIphone13(),isIPod13:getIPod13(),isElectron:isElectronType(),isEdgeChromium:isEdgeChromiumType(at),isLegacyEdge:isEdgeType(tt)&&!isEdgeChromiumType(at),isWindows:isWindowsType(rt),isMacOs:isMacOsType(rt),isMIUI:isMIUIType(tt),isSamsungBrowser:isSamsungBrowserType(tt)}}var isSmartTV=isSmartTVType(device),isConsole=isConsoleType(device),isWearable=isWearableType(device),isEmbedded=isEmbeddedType(device),isMobileSafari=isMobileSafariType(browser)||getIPad13(),isChromium=isChromiumType(browser),isMobile=isMobileAndTabletType(device)||getIPad13(),isMobileOnly=isMobileType(device),isTablet=isTabletType(device)||getIPad13(),isBrowser$1=isBrowserType(device),isDesktop=isBrowserType(device),isAndroid=isAndroidType(os),isWinPhone=isWinPhoneType(os),isIOS=isIOSType(os)||getIPad13(),isChrome=isChromeType(browser),isFirefox=isFirefoxType(browser),isSafari=isSafariType(browser),isOpera=isOperaType(browser),isIE=isIEType(browser),osVersion=getOsVersion(os),osName=getOsName(os),fullBrowserVersion=getBrowserFullVersion(browser),browserVersion=getBrowserVersion(browser),browserName=getBrowserName(browser),mobileVendor=getMobileVendor(device),mobileModel=getMobileModel(device),engineName=getEngineName(engine),engineVersion=getEngineVersion(engine),getUA=getUseragent(ua),isEdge=isEdgeType(browser)||isEdgeChromiumType(ua),isYandex=isYandexType(browser),deviceType=getDeviceType(device),isIOS13=getIOS13(),isIPad13=getIPad13(),isIPhone13=getIphone13(),isIPod13=getIPod13(),isElectron=isElectronType(),isEdgeChromium=isEdgeChromiumType(ua),isLegacyEdge=isEdgeType(browser)&&!isEdgeChromiumType(ua),isWindows=isWindowsType(os),isMacOs=isMacOsType(os),isMIUI=isMIUIType(browser),isSamsungBrowser=isSamsungBrowserType(browser),getSelectorsByUserAgent=function(o){if(!o||typeof o!="string"){console.error("No valid user agent string was provided");return}var _e=parseUserAgent(o),tt=_e.device,rt=_e.browser,st=_e.os,at=_e.engine,ut=_e.ua;return buildSelectorsObject({device:tt,browser:rt,os:st,engine:at,ua:ut})},AndroidView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isAndroid?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},BrowserView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isBrowser$1?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},IEView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isIE?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},IOSView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isIOS?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},MobileView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isMobile?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},TabletView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isTablet?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},WinPhoneView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isWinPhone?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},MobileOnlyView=function(o){var _e=o.renderWithFragment,tt=o.children;o.viewClassName,o.style;var rt=_objectWithoutProperties(o,["renderWithFragment","children","viewClassName","style"]);return isMobileOnly?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},SmartTVView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isSmartTV?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},ConsoleView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isConsole?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},WearableView=function(o){var _e=o.renderWithFragment,tt=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isWearable?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",rt,tt):null},CustomView=function(o){var _e=o.renderWithFragment,tt=o.children;o.viewClassName,o.style;var rt=o.condition,st=_objectWithoutProperties(o,["renderWithFragment","children","viewClassName","style","condition"]);return rt?_e?React__default.createElement(React.Fragment,null,tt):React__default.createElement("div",st,tt):null};function withOrientationChange(a){return function(o){_inherits(_e,o);function _e(tt){var rt;return _classCallCheck(this,_e),rt=_possibleConstructorReturn(this,_getPrototypeOf(_e).call(this,tt)),rt.isEventListenerAdded=!1,rt.handleOrientationChange=rt.handleOrientationChange.bind(_assertThisInitialized$1(rt)),rt.onOrientationChange=rt.onOrientationChange.bind(_assertThisInitialized$1(rt)),rt.onPageLoad=rt.onPageLoad.bind(_assertThisInitialized$1(rt)),rt.state={isLandscape:!1,isPortrait:!1},rt}return _createClass(_e,[{key:"handleOrientationChange",value:function(){this.isEventListenerAdded||(this.isEventListenerAdded=!0);var rt=window.innerWidth>window.innerHeight?90:0;this.setState({isPortrait:rt===0,isLandscape:rt===90})}},{key:"onOrientationChange",value:function(){this.handleOrientationChange()}},{key:"onPageLoad",value:function(){this.handleOrientationChange()}},{key:"componentDidMount",value:function(){(typeof window>"u"?"undefined":_typeof(window))!==void 0&&isMobile&&(this.isEventListenerAdded?window.removeEventListener("load",this.onPageLoad,!1):(this.handleOrientationChange(),window.addEventListener("load",this.onPageLoad,!1)),window.addEventListener("resize",this.onOrientationChange,!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onOrientationChange,!1)}},{key:"render",value:function(){return React__default.createElement(a,_extends$1({},this.props,{isLandscape:this.state.isLandscape,isPortrait:this.state.isPortrait}))}}]),_e}(React__default.Component)}function useMobileOrientation(){var a=React.useState(function(){var st=window.innerWidth>window.innerHeight?90:0;return{isPortrait:st===0,isLandscape:st===90,orientation:st===0?"portrait":"landscape"}}),o=_slicedToArray(a,2),_e=o[0],tt=o[1],rt=React.useCallback(function(){var st=window.innerWidth>window.innerHeight?90:0,at={isPortrait:st===0,isLandscape:st===90,orientation:st===0?"portrait":"landscape"};_e.orientation!==at.orientation&&tt(at)},[_e.orientation]);return React.useEffect(function(){return(typeof window>"u"?"undefined":_typeof(window))!==void 0&&isMobile&&(rt(),window.addEventListener("load",rt,!1),window.addEventListener("resize",rt,!1)),function(){window.removeEventListener("resize",rt,!1),window.removeEventListener("load",rt,!1)}},[rt]),_e}function useDeviceData(a){var o=a||window.navigator.userAgent;return parseUserAgent(o)}function useDeviceSelectors(a){var o=a||window.navigator.userAgent,_e=useDeviceData(o),tt=buildSelectorsObject(_e);return[tt,_e]}lib.AndroidView=AndroidView;lib.BrowserTypes=BrowserTypes;lib.BrowserView=BrowserView;lib.ConsoleView=ConsoleView;lib.CustomView=CustomView;lib.IEView=IEView;lib.IOSView=IOSView;lib.MobileOnlyView=MobileOnlyView;lib.MobileView=MobileView;lib.OsTypes=OsTypes;lib.SmartTVView=SmartTVView;lib.TabletView=TabletView;lib.WearableView=WearableView;lib.WinPhoneView=WinPhoneView;lib.browserName=browserName;lib.browserVersion=browserVersion;lib.deviceDetect=deviceDetect;lib.deviceType=deviceType;lib.engineName=engineName;lib.engineVersion=engineVersion;lib.fullBrowserVersion=fullBrowserVersion;lib.getSelectorsByUserAgent=getSelectorsByUserAgent;lib.getUA=getUA;lib.isAndroid=isAndroid;lib.isBrowser=isBrowser$1;lib.isChrome=isChrome;lib.isChromium=isChromium;lib.isConsole=isConsole;lib.isDesktop=isDesktop;lib.isEdge=isEdge;lib.isEdgeChromium=isEdgeChromium;lib.isElectron=isElectron;lib.isEmbedded=isEmbedded;lib.isFirefox=isFirefox;lib.isIE=isIE;lib.isIOS=isIOS;lib.isIOS13=isIOS13;lib.isIPad13=isIPad13;lib.isIPhone13=isIPhone13;lib.isIPod13=isIPod13;lib.isLegacyEdge=isLegacyEdge;lib.isMIUI=isMIUI;lib.isMacOs=isMacOs;var isMobile_1=lib.isMobile=isMobile;lib.isMobileOnly=isMobileOnly;lib.isMobileSafari=isMobileSafari;lib.isOpera=isOpera;lib.isSafari=isSafari;lib.isSamsungBrowser=isSamsungBrowser;lib.isSmartTV=isSmartTV;lib.isTablet=isTablet;lib.isWearable=isWearable;lib.isWinPhone=isWinPhone;lib.isWindows=isWindows;lib.isYandex=isYandex;lib.mobileModel=mobileModel;lib.mobileVendor=mobileVendor;lib.osName=osName;lib.osVersion=osVersion;lib.parseUserAgent=parseUserAgent;lib.setUserAgent=setUserAgent;lib.useDeviceData=useDeviceData;lib.useDeviceSelectors=useDeviceSelectors;lib.useMobileOrientation=useMobileOrientation;lib.withOrientationChange=withOrientationChange;var uaParser={exports:{}};(function(a,o){(function(_e,tt){var rt="1.0.36",st="",at="?",ut="function",s="undefined",et="object",ot="string",lt="major",St="model",pt="name",gt="type",ct="vendor",ht="version",it="architecture",ft="console",mt="mobile",Tt="tablet",It="smarttv",Pt="wearable",At="embedded",Nt=350,Ot="Amazon",Mt="Apple",bt="ASUS",Wt="BlackBerry",zt="Browser",Bt="Chrome",rn="Edge",gn="Firefox",tn="Google",Ht="Huawei",fn="LG",bn="Microsoft",In="Motorola",un="Opera",mn="Samsung",yn="Sharp",pn="Sony",Tn="Xiaomi",kn="Zebra",xn="Facebook",Mn="Chromium OS",Dn="Mac OS",An=function(_n,Ln){var vn={};for(var On in _n)Ln[On]&&Ln[On].length%2===0?vn[On]=Ln[On].concat(_n[On]):vn[On]=_n[On];return vn},Nn=function(_n){for(var Ln={},vn=0;vn<_n.length;vn++)Ln[_n[vn].toUpperCase()]=_n[vn];return Ln},Un=function(_n,Ln){return typeof _n===ot?Qn(Ln).indexOf(Qn(_n))!==-1:!1},Qn=function(_n){return _n.toLowerCase()},er=function(_n){return typeof _n===ot?_n.replace(/[^\d\.]/g,st).split(".")[0]:tt},zn=function(_n,Ln){if(typeof _n===ot)return _n=_n.replace(/^\s\s*/,st),typeof Ln===s?_n:_n.substring(0,Nt)},lr=function(_n,Ln){for(var vn=0,On,Kt,Rt,nt,Ct,yt;vn<Ln.length&&!Ct;){var xt=Ln[vn],wt=Ln[vn+1];for(On=Kt=0;On<xt.length&&!Ct&&xt[On];)if(Ct=xt[On++].exec(_n),Ct)for(Rt=0;Rt<wt.length;Rt++)yt=Ct[++Kt],nt=wt[Rt],typeof nt===et&&nt.length>0?nt.length===2?typeof nt[1]==ut?this[nt[0]]=nt[1].call(this,yt):this[nt[0]]=nt[1]:nt.length===3?typeof nt[1]===ut&&!(nt[1].exec&&nt[1].test)?this[nt[0]]=yt?nt[1].call(this,yt,nt[2]):tt:this[nt[0]]=yt?yt.replace(nt[1],nt[2]):tt:nt.length===4&&(this[nt[0]]=yt?nt[3].call(this,yt.replace(nt[1],nt[2])):tt):this[nt]=yt||tt;vn+=2}},cn=function(_n,Ln){for(var vn in Ln)if(typeof Ln[vn]===et&&Ln[vn].length>0){for(var On=0;On<Ln[vn].length;On++)if(Un(Ln[vn][On],_n))return vn===at?tt:vn}else if(Un(Ln[vn],_n))return vn===at?tt:vn;return _n},Gn={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Yn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},or={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[ht,[pt,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[ht,[pt,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[pt,ht],[/opios[\/ ]+([\w\.]+)/i],[ht,[pt,un+" Mini"]],[/\bopr\/([\w\.]+)/i],[ht,[pt,un]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[pt,ht],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[ht,[pt,"UC"+zt]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[ht,[pt,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[ht,[pt,"WeChat"]],[/konqueror\/([\w\.]+)/i],[ht,[pt,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[ht,[pt,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[ht,[pt,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[pt,/(.+)/,"$1 Secure "+zt],ht],[/\bfocus\/([\w\.]+)/i],[ht,[pt,gn+" Focus"]],[/\bopt\/([\w\.]+)/i],[ht,[pt,un+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[ht,[pt,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[ht,[pt,"Dolphin"]],[/coast\/([\w\.]+)/i],[ht,[pt,un+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[ht,[pt,"MIUI "+zt]],[/fxios\/([-\w\.]+)/i],[ht,[pt,gn]],[/\bqihu|(qi?ho?o?|360)browser/i],[[pt,"360 "+zt]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[pt,/(.+)/,"$1 "+zt],ht],[/(comodo_dragon)\/([\w\.]+)/i],[[pt,/_/g," "],ht],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[pt,ht],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[pt],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[pt,xn],ht],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[pt,ht],[/\bgsa\/([\w\.]+) .*safari\//i],[ht,[pt,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[ht,[pt,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[ht,[pt,Bt+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[pt,Bt+" WebView"],ht],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[ht,[pt,"Android "+zt]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[pt,ht],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[ht,[pt,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[ht,pt],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[pt,[ht,cn,Gn]],[/(webkit|khtml)\/([\w\.]+)/i],[pt,ht],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[pt,"Netscape"],ht],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[ht,[pt,gn+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[pt,ht],[/(cobalt)\/([\w\.]+)/i],[pt,[ht,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[it,"amd64"]],[/(ia32(?=;))/i],[[it,Qn]],[/((?:i[346]|x)86)[;\)]/i],[[it,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[it,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[it,"armhf"]],[/windows (ce|mobile); ppc;/i],[[it,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[it,/ower/,st,Qn]],[/(sun4\w)[;\)]/i],[[it,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[it,Qn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[St,[ct,mn],[gt,Tt]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[St,[ct,mn],[gt,mt]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[St,[ct,Mt],[gt,mt]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[St,[ct,Mt],[gt,Tt]],[/(macintosh);/i],[St,[ct,Mt]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[St,[ct,yn],[gt,mt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[St,[ct,Ht],[gt,Tt]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[St,[ct,Ht],[gt,mt]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[St,/_/g," "],[ct,Tn],[gt,mt]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[St,/_/g," "],[ct,Tn],[gt,Tt]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[St,[ct,"OPPO"],[gt,mt]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[St,[ct,"Vivo"],[gt,mt]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[St,[ct,"Realme"],[gt,mt]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[St,[ct,In],[gt,mt]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[St,[ct,In],[gt,Tt]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[St,[ct,fn],[gt,Tt]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[St,[ct,fn],[gt,mt]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[St,[ct,"Lenovo"],[gt,Tt]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[St,/_/g," "],[ct,"Nokia"],[gt,mt]],[/(pixel c)\b/i],[St,[ct,tn],[gt,Tt]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[St,[ct,tn],[gt,mt]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[St,[ct,pn],[gt,mt]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[St,"Xperia Tablet"],[ct,pn],[gt,Tt]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[St,[ct,"OnePlus"],[gt,mt]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[St,[ct,Ot],[gt,Tt]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[St,/(.+)/g,"Fire Phone $1"],[ct,Ot],[gt,mt]],[/(playbook);[-\w\),; ]+(rim)/i],[St,ct,[gt,Tt]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[St,[ct,Wt],[gt,mt]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[St,[ct,bt],[gt,Tt]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[St,[ct,bt],[gt,mt]],[/(nexus 9)/i],[St,[ct,"HTC"],[gt,Tt]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[ct,[St,/_/g," "],[gt,mt]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[St,[ct,"Acer"],[gt,Tt]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[St,[ct,"Meizu"],[gt,mt]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[ct,St,[gt,mt]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[ct,St,[gt,Tt]],[/(surface duo)/i],[St,[ct,bn],[gt,Tt]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[St,[ct,"Fairphone"],[gt,mt]],[/(u304aa)/i],[St,[ct,"AT&T"],[gt,mt]],[/\bsie-(\w*)/i],[St,[ct,"Siemens"],[gt,mt]],[/\b(rct\w+) b/i],[St,[ct,"RCA"],[gt,Tt]],[/\b(venue[\d ]{2,7}) b/i],[St,[ct,"Dell"],[gt,Tt]],[/\b(q(?:mv|ta)\w+) b/i],[St,[ct,"Verizon"],[gt,Tt]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[St,[ct,"Barnes & Noble"],[gt,Tt]],[/\b(tm\d{3}\w+) b/i],[St,[ct,"NuVision"],[gt,Tt]],[/\b(k88) b/i],[St,[ct,"ZTE"],[gt,Tt]],[/\b(nx\d{3}j) b/i],[St,[ct,"ZTE"],[gt,mt]],[/\b(gen\d{3}) b.+49h/i],[St,[ct,"Swiss"],[gt,mt]],[/\b(zur\d{3}) b/i],[St,[ct,"Swiss"],[gt,Tt]],[/\b((zeki)?tb.*\b) b/i],[St,[ct,"Zeki"],[gt,Tt]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[ct,"Dragon Touch"],St,[gt,Tt]],[/\b(ns-?\w{0,9}) b/i],[St,[ct,"Insignia"],[gt,Tt]],[/\b((nxa|next)-?\w{0,9}) b/i],[St,[ct,"NextBook"],[gt,Tt]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[ct,"Voice"],St,[gt,mt]],[/\b(lvtel\-)?(v1[12]) b/i],[[ct,"LvTel"],St,[gt,mt]],[/\b(ph-1) /i],[St,[ct,"Essential"],[gt,mt]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[St,[ct,"Envizen"],[gt,Tt]],[/\b(trio[-\w\. ]+) b/i],[St,[ct,"MachSpeed"],[gt,Tt]],[/\btu_(1491) b/i],[St,[ct,"Rotor"],[gt,Tt]],[/(shield[\w ]+) b/i],[St,[ct,"Nvidia"],[gt,Tt]],[/(sprint) (\w+)/i],[ct,St,[gt,mt]],[/(kin\.[onetw]{3})/i],[[St,/\./g," "],[ct,bn],[gt,mt]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[St,[ct,kn],[gt,Tt]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[St,[ct,kn],[gt,mt]],[/smart-tv.+(samsung)/i],[ct,[gt,It]],[/hbbtv.+maple;(\d+)/i],[[St,/^/,"SmartTV"],[ct,mn],[gt,It]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[ct,fn],[gt,It]],[/(apple) ?tv/i],[ct,[St,Mt+" TV"],[gt,It]],[/crkey/i],[[St,Bt+"cast"],[ct,tn],[gt,It]],[/droid.+aft(\w+)( bui|\))/i],[St,[ct,Ot],[gt,It]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[St,[ct,yn],[gt,It]],[/(bravia[\w ]+)( bui|\))/i],[St,[ct,pn],[gt,It]],[/(mitv-\w{5}) bui/i],[St,[ct,Tn],[gt,It]],[/Hbbtv.*(technisat) (.*);/i],[ct,St,[gt,It]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[ct,zn],[St,zn],[gt,It]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[gt,It]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[ct,St,[gt,ft]],[/droid.+; (shield) bui/i],[St,[ct,"Nvidia"],[gt,ft]],[/(playstation [345portablevi]+)/i],[St,[ct,pn],[gt,ft]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[St,[ct,bn],[gt,ft]],[/((pebble))app/i],[ct,St,[gt,Pt]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[St,[ct,Mt],[gt,Pt]],[/droid.+; (glass) \d/i],[St,[ct,tn],[gt,Pt]],[/droid.+; (wt63?0{2,3})\)/i],[St,[ct,kn],[gt,Pt]],[/(quest( 2| pro)?)/i],[St,[ct,xn],[gt,Pt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[ct,[gt,At]],[/(aeobc)\b/i],[St,[ct,Ot],[gt,At]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[St,[gt,mt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[St,[gt,Tt]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[gt,Tt]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[gt,mt]],[/(android[-\w\. ]{0,9});.+buil/i],[St,[ct,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[ht,[pt,rn+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[ht,[pt,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[pt,ht],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[ht,pt]],os:[[/microsoft (windows) (vista|xp)/i],[pt,ht],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[pt,[ht,cn,Yn]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[pt,"Windows"],[ht,cn,Yn]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[ht,/_/g,"."],[pt,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[pt,Dn],[ht,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[ht,pt],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[pt,ht],[/\(bb(10);/i],[ht,[pt,Wt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[ht,[pt,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[ht,[pt,gn+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[ht,[pt,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[ht,[pt,"watchOS"]],[/crkey\/([\d\.]+)/i],[ht,[pt,Bt+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[pt,Mn],ht],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[pt,ht],[/(sunos) ?([\w\.\d]*)/i],[[pt,"Solaris"],ht],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[pt,ht]]},Bn=function(_n,Ln){if(typeof _n===et&&(Ln=_n,_n=tt),!(this instanceof Bn))return new Bn(_n,Ln).getResult();var vn=typeof _e!==s&&_e.navigator?_e.navigator:tt,On=_n||(vn&&vn.userAgent?vn.userAgent:st),Kt=vn&&vn.userAgentData?vn.userAgentData:tt,Rt=Ln?An(or,Ln):or,nt=vn&&vn.userAgent==On;return this.getBrowser=function(){var Ct={};return Ct[pt]=tt,Ct[ht]=tt,lr.call(Ct,On,Rt.browser),Ct[lt]=er(Ct[ht]),nt&&vn&&vn.brave&&typeof vn.brave.isBrave==ut&&(Ct[pt]="Brave"),Ct},this.getCPU=function(){var Ct={};return Ct[it]=tt,lr.call(Ct,On,Rt.cpu),Ct},this.getDevice=function(){var Ct={};return Ct[ct]=tt,Ct[St]=tt,Ct[gt]=tt,lr.call(Ct,On,Rt.device),nt&&!Ct[gt]&&Kt&&Kt.mobile&&(Ct[gt]=mt),nt&&Ct[St]=="Macintosh"&&vn&&typeof vn.standalone!==s&&vn.maxTouchPoints&&vn.maxTouchPoints>2&&(Ct[St]="iPad",Ct[gt]=Tt),Ct},this.getEngine=function(){var Ct={};return Ct[pt]=tt,Ct[ht]=tt,lr.call(Ct,On,Rt.engine),Ct},this.getOS=function(){var Ct={};return Ct[pt]=tt,Ct[ht]=tt,lr.call(Ct,On,Rt.os),nt&&!Ct[pt]&&Kt&&Kt.platform!="Unknown"&&(Ct[pt]=Kt.platform.replace(/chrome os/i,Mn).replace(/macos/i,Dn)),Ct},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return On},this.setUA=function(Ct){return On=typeof Ct===ot&&Ct.length>Nt?zn(Ct,Nt):Ct,this},this.setUA(On),this};Bn.VERSION=rt,Bn.BROWSER=Nn([pt,ht,lt]),Bn.CPU=Nn([it]),Bn.DEVICE=Nn([St,ct,gt,ft,mt,It,Tt,Pt,At]),Bn.ENGINE=Bn.OS=Nn([pt,ht]),a.exports&&(o=a.exports=Bn),o.UAParser=Bn;var rr=typeof _e!==s&&(_e.jQuery||_e.Zepto);if(rr&&!rr.ua){var Zn=new Bn;rr.ua=Zn.getResult(),rr.ua.get=function(){return Zn.getUA()},rr.ua.set=function(_n){Zn.setUA(_n);var Ln=Zn.getResult();for(var vn in Ln)rr.ua[vn]=Ln[vn]}}})(typeof window=="object"?window:commonjsGlobal)})(uaParser,uaParser.exports);var uaParserExports=uaParser.exports,base64={exports:{}};/*! https://mths.be/base64 v1.0.0 by @mathias | MIT license */base64.exports;(function(a,o){(function(_e){var tt=o,rt=a&&a.exports==tt&&a,st=typeof commonjsGlobal=="object"&&commonjsGlobal;(st.global===st||st.window===st)&&(_e=st);var at=function(gt){this.message=gt};at.prototype=new Error,at.prototype.name="InvalidCharacterError";var ut=function(gt){throw new at(gt)},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",et=/[\t\n\f\r ]/g,ot=function(gt){gt=String(gt).replace(et,"");var ct=gt.length;ct%4==0&&(gt=gt.replace(/==?$/,""),ct=gt.length),(ct%4==1||/[^+a-zA-Z0-9/]/.test(gt))&&ut("Invalid character: the string to be decoded is not correctly encoded.");for(var ht=0,it,ft,mt="",Tt=-1;++Tt<ct;)ft=s.indexOf(gt.charAt(Tt)),it=ht%4?it*64+ft:ft,ht++%4&&(mt+=String.fromCharCode(255&it>>(-2*ht&6)));return mt},lt=function(gt){gt=String(gt),/[^\0-\xFF]/.test(gt)&&ut("The string to be encoded contains characters outside of the Latin1 range.");for(var ct=gt.length%3,ht="",it=-1,ft,mt,Tt,It,Pt=gt.length-ct;++it<Pt;)ft=gt.charCodeAt(it)<<16,mt=gt.charCodeAt(++it)<<8,Tt=gt.charCodeAt(++it),It=ft+mt+Tt,ht+=s.charAt(It>>18&63)+s.charAt(It>>12&63)+s.charAt(It>>6&63)+s.charAt(It&63);return ct==2?(ft=gt.charCodeAt(it)<<8,mt=gt.charCodeAt(++it),It=ft+mt,ht+=s.charAt(It>>10)+s.charAt(It>>4&63)+s.charAt(It<<2&63)+"="):ct==1&&(It=gt.charCodeAt(it),ht+=s.charAt(It>>2)+s.charAt(It<<4&63)+"=="),ht},St={encode:lt,decode:ot,version:"1.0.0"};if(tt&&!tt.nodeType)if(rt)rt.exports=St;else for(var pt in St)St.hasOwnProperty(pt)&&(tt[pt]=St[pt]);else _e.base64=St})(commonjsGlobal)})(base64,base64.exports);var base64Exports=base64.exports;function commonjsRequire(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var apiRTC_min={exports:{}};(function(a,o){(function(tt){a.exports=tt()})(function(){return function(){function tt(rt,st,at){function ut(ot,lt){if(!st[ot]){if(!rt[ot]){var St=typeof commonjsRequire=="function"&&commonjsRequire;if(!lt&&St)return St(ot,!0);if(s)return s(ot,!0);var pt=new Error("Cannot find module '"+ot+"'");throw pt.code="MODULE_NOT_FOUND",pt}var gt=st[ot]={exports:{}};rt[ot][0].call(gt.exports,function(ct){return ut(rt[ot][1][ct]||ct)},gt,gt.exports,tt,rt,st,at)}return st[ot].exports}for(var s=typeof commonjsRequire=="function"&&commonjsRequire,et=0;et<at.length;et++)ut(at[et]);return ut}return tt}()({1:[function(tt,rt,st){var at=(0,tt("./adapter_factory.js").adapterFactory)({window});rt.exports=at},{"./adapter_factory.js":2}],2:[function(tt,rt,st){function at(pt){if(pt&&pt.__esModule)return pt;var gt={};if(pt!=null)for(var ct in pt)Object.prototype.hasOwnProperty.call(pt,ct)&&(gt[ct]=pt[ct]);return gt.default=pt,gt}Object.defineProperty(st,"__esModule",{value:!0}),st.adapterFactory=function(){var pt=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).window,gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},ct=ut.log,ht=ut.detectBrowser(pt),it={browserDetails:ht,commonShim:St,extractVersion:ut.extractVersion,disableLog:ut.disableLog,disableWarnings:ut.disableWarnings};switch(ht.browser){case"chrome":if(!s||!s.shimPeerConnection||!gt.shimChrome)return ct("Chrome shim is not included in this adapter release."),it;ct("adapter.js shimming chrome."),it.browserShim=s,s.shimGetUserMedia(pt),s.shimMediaStream(pt),s.shimPeerConnection(pt),s.shimOnTrack(pt),s.shimAddTrackRemoveTrack(pt),s.shimGetSendersWithDtmf(pt),s.shimGetStats(pt),s.shimSenderReceiverGetStats(pt),s.fixNegotiationNeeded(pt),St.shimRTCIceCandidate(pt),St.shimConnectionState(pt),St.shimMaxMessageSize(pt),St.shimSendThrowTypeError(pt),St.removeAllowExtmapMixed(pt);break;case"firefox":if(!ot||!ot.shimPeerConnection||!gt.shimFirefox)return ct("Firefox shim is not included in this adapter release."),it;ct("adapter.js shimming firefox."),it.browserShim=ot,ot.shimGetUserMedia(pt),ot.shimPeerConnection(pt),ot.shimOnTrack(pt),ot.shimRemoveStream(pt),ot.shimSenderGetStats(pt),ot.shimReceiverGetStats(pt),ot.shimRTCDataChannel(pt),St.shimRTCIceCandidate(pt),St.shimConnectionState(pt),St.shimMaxMessageSize(pt),St.shimSendThrowTypeError(pt);break;case"edge":if(!et||!et.shimPeerConnection||!gt.shimEdge)return ct("MS edge shim is not included in this adapter release."),it;ct("adapter.js shimming edge."),it.browserShim=et,et.shimGetUserMedia(pt),et.shimGetDisplayMedia(pt),et.shimPeerConnection(pt),et.shimReplaceTrack(pt),St.shimMaxMessageSize(pt),St.shimSendThrowTypeError(pt);break;case"safari":if(!lt||!gt.shimSafari)return ct("Safari shim is not included in this adapter release."),it;ct("adapter.js shimming safari."),it.browserShim=lt,lt.shimRTCIceServerUrls(pt),lt.shimCreateOfferLegacy(pt),lt.shimCallbacksAPI(pt),lt.shimLocalStreamsAPI(pt),lt.shimRemoteStreamsAPI(pt),lt.shimTrackEventTransceiver(pt),lt.shimGetUserMedia(pt),St.shimRTCIceCandidate(pt),St.shimMaxMessageSize(pt),St.shimSendThrowTypeError(pt),St.removeAllowExtmapMixed(pt);break;default:ct("Unsupported browser!")}return it};var ut=at(tt("./utils")),s=at(tt("./chrome/chrome_shim")),et=at(tt("./edge/edge_shim")),ot=at(tt("./firefox/firefox_shim")),lt=at(tt("./safari/safari_shim")),St=at(tt("./common_shim"))},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(tt,rt,st){function at(lt){lt.RTCPeerConnection.prototype.getLocalStreams=function(){var ht=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(it){return ht._shimmedLocalStreams[it][0]})};var St=lt.RTCPeerConnection.prototype.addTrack;lt.RTCPeerConnection.prototype.addTrack=function(ht,it){if(!it)return St.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var ft=St.apply(this,arguments);return this._shimmedLocalStreams[it.id]?this._shimmedLocalStreams[it.id].indexOf(ft)===-1&&this._shimmedLocalStreams[it.id].push(ft):this._shimmedLocalStreams[it.id]=[it,ft],ft};var pt=lt.RTCPeerConnection.prototype.addStream;lt.RTCPeerConnection.prototype.addStream=function(ht){var it=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},ht.getTracks().forEach(function(Tt){if(it.getSenders().find(function(It){return It.track===Tt}))throw new DOMException("Track already exists.","InvalidAccessError")});var ft=this.getSenders();pt.apply(this,arguments);var mt=this.getSenders().filter(function(Tt){return ft.indexOf(Tt)===-1});this._shimmedLocalStreams[ht.id]=[ht].concat(mt)};var gt=lt.RTCPeerConnection.prototype.removeStream;lt.RTCPeerConnection.prototype.removeStream=function(ht){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[ht.id],gt.apply(this,arguments)};var ct=lt.RTCPeerConnection.prototype.removeTrack;lt.RTCPeerConnection.prototype.removeTrack=function(ht){var it=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},ht&&Object.keys(this._shimmedLocalStreams).forEach(function(ft){var mt=it._shimmedLocalStreams[ft].indexOf(ht);mt!==-1&&it._shimmedLocalStreams[ft].splice(mt,1),it._shimmedLocalStreams[ft].length===1&&delete it._shimmedLocalStreams[ft]}),ct.apply(this,arguments)}}Object.defineProperty(st,"__esModule",{value:!0}),st.shimGetDisplayMedia=st.shimGetUserMedia=void 0;var ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(lt){return typeof lt}:function(lt){return lt&&typeof Symbol=="function"&&lt.constructor===Symbol&&lt!==Symbol.prototype?"symbol":typeof lt},s=tt("./getusermedia");Object.defineProperty(st,"shimGetUserMedia",{enumerable:!0,get:function(){return s.shimGetUserMedia}});var et=tt("./getdisplaymedia");Object.defineProperty(st,"shimGetDisplayMedia",{enumerable:!0,get:function(){return et.shimGetDisplayMedia}}),st.shimMediaStream=function(lt){lt.MediaStream=lt.MediaStream||lt.webkitMediaStream},st.shimOnTrack=function(lt){if((lt===void 0?"undefined":ut(lt))!=="object"||!lt.RTCPeerConnection||"ontrack"in lt.RTCPeerConnection.prototype)ot.wrapPeerConnectionEvent(lt,"track",function(pt){return pt.transceiver||Object.defineProperty(pt,"transceiver",{value:{receiver:pt.receiver}}),pt});else{Object.defineProperty(lt.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(pt){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=pt)},enumerable:!0,configurable:!0});var St=lt.RTCPeerConnection.prototype.setRemoteDescription;lt.RTCPeerConnection.prototype.setRemoteDescription=function(){var pt=this;return this._ontrackpoly||(this._ontrackpoly=function(gt){gt.stream.addEventListener("addtrack",function(ct){var ht=void 0;ht=lt.RTCPeerConnection.prototype.getReceivers?pt.getReceivers().find(function(ft){return ft.track&&ft.track.id===ct.track.id}):{track:ct.track};var it=new Event("track");it.track=ct.track,it.receiver=ht,it.transceiver={receiver:ht},it.streams=[gt.stream],pt.dispatchEvent(it)}),gt.stream.getTracks().forEach(function(ct){var ht=void 0;ht=lt.RTCPeerConnection.prototype.getReceivers?pt.getReceivers().find(function(ft){return ft.track&&ft.track.id===ct.id}):{track:ct};var it=new Event("track");it.track=ct,it.receiver=ht,it.transceiver={receiver:ht},it.streams=[gt.stream],pt.dispatchEvent(it)})},this.addEventListener("addstream",this._ontrackpoly)),St.apply(this,arguments)}}},st.shimGetSendersWithDtmf=function(lt){if((lt===void 0?"undefined":ut(lt))==="object"&&lt.RTCPeerConnection&&!("getSenders"in lt.RTCPeerConnection.prototype)&&"createDTMFSender"in lt.RTCPeerConnection.prototype){var St=function(ft,mt){return{track:mt,get dtmf(){return this._dtmf===void 0&&(mt.kind==="audio"?this._dtmf=ft.createDTMFSender(mt):this._dtmf=null),this._dtmf},_pc:ft}};if(!lt.RTCPeerConnection.prototype.getSenders){lt.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var pt=lt.RTCPeerConnection.prototype.addTrack;lt.RTCPeerConnection.prototype.addTrack=function(ft,mt){var Tt=pt.apply(this,arguments);return Tt||(Tt=St(this,ft),this._senders.push(Tt)),Tt};var gt=lt.RTCPeerConnection.prototype.removeTrack;lt.RTCPeerConnection.prototype.removeTrack=function(ft){gt.apply(this,arguments);var mt=this._senders.indexOf(ft);mt!==-1&&this._senders.splice(mt,1)}}var ct=lt.RTCPeerConnection.prototype.addStream;lt.RTCPeerConnection.prototype.addStream=function(ft){var mt=this;this._senders=this._senders||[],ct.apply(this,[ft]),ft.getTracks().forEach(function(Tt){mt._senders.push(St(mt,Tt))})};var ht=lt.RTCPeerConnection.prototype.removeStream;lt.RTCPeerConnection.prototype.removeStream=function(ft){var mt=this;this._senders=this._senders||[],ht.apply(this,[ft]),ft.getTracks().forEach(function(Tt){var It=mt._senders.find(function(Pt){return Pt.track===Tt});It&&mt._senders.splice(mt._senders.indexOf(It),1)})}}else if((lt===void 0?"undefined":ut(lt))==="object"&&lt.RTCPeerConnection&&"getSenders"in lt.RTCPeerConnection.prototype&&"createDTMFSender"in lt.RTCPeerConnection.prototype&&lt.RTCRtpSender&&!("dtmf"in lt.RTCRtpSender.prototype)){var it=lt.RTCPeerConnection.prototype.getSenders;lt.RTCPeerConnection.prototype.getSenders=function(){var ft=this,mt=it.apply(this,[]);return mt.forEach(function(Tt){return Tt._pc=ft}),mt},Object.defineProperty(lt.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},st.shimGetStats=function(lt){if(lt.RTCPeerConnection){var St=lt.RTCPeerConnection.prototype.getStats;lt.RTCPeerConnection.prototype.getStats=function(pt,gt,ct){var ht=this,it=arguments;if(arguments.length>0&&typeof pt=="function")return St.apply(this,arguments);if(St.length===0&&(arguments.length===0||typeof arguments[0]!="function"))return St.apply(this,[]);var ft=function(It){var Pt={};return It.result().forEach(function(At){var Nt={id:At.id,timestamp:At.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[At.type]||At.type};At.names().forEach(function(Ot){Nt[Ot]=At.stat(Ot)}),Pt[Nt.id]=Nt}),Pt},mt=function(It){return new Map(Object.keys(It).map(function(Pt){return[Pt,It[Pt]]}))};if(arguments.length>=2){var Tt=function(It){it[1](mt(ft(It)))};return St.apply(this,[Tt,arguments[0]])}return new Promise(function(It,Pt){St.apply(ht,[function(At){It(mt(ft(At)))},Pt])}).then(gt,ct)}}},st.shimSenderReceiverGetStats=function(lt){if((lt===void 0?"undefined":ut(lt))==="object"&&lt.RTCPeerConnection&&lt.RTCRtpSender&&lt.RTCRtpReceiver){if(!("getStats"in lt.RTCRtpSender.prototype)){var St=lt.RTCPeerConnection.prototype.getSenders;St&&(lt.RTCPeerConnection.prototype.getSenders=function(){var ht=this,it=St.apply(this,[]);return it.forEach(function(ft){return ft._pc=ht}),it});var pt=lt.RTCPeerConnection.prototype.addTrack;pt&&(lt.RTCPeerConnection.prototype.addTrack=function(){var ht=pt.apply(this,arguments);return ht._pc=this,ht}),lt.RTCRtpSender.prototype.getStats=function(){var ht=this;return this._pc.getStats().then(function(it){return ot.filterStats(it,ht.track,!0)})}}if(!("getStats"in lt.RTCRtpReceiver.prototype)){var gt=lt.RTCPeerConnection.prototype.getReceivers;gt&&(lt.RTCPeerConnection.prototype.getReceivers=function(){var ht=this,it=gt.apply(this,[]);return it.forEach(function(ft){return ft._pc=ht}),it}),ot.wrapPeerConnectionEvent(lt,"track",function(ht){return ht.receiver._pc=ht.srcElement,ht}),lt.RTCRtpReceiver.prototype.getStats=function(){var ht=this;return this._pc.getStats().then(function(it){return ot.filterStats(it,ht.track,!1)})}}if("getStats"in lt.RTCRtpSender.prototype&&"getStats"in lt.RTCRtpReceiver.prototype){var ct=lt.RTCPeerConnection.prototype.getStats;lt.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof lt.MediaStreamTrack){var ht=arguments[0],it=void 0,ft=void 0,mt=void 0;return this.getSenders().forEach(function(Tt){Tt.track===ht&&(it?mt=!0:it=Tt)}),this.getReceivers().forEach(function(Tt){return Tt.track===ht&&(ft?mt=!0:ft=Tt),Tt.track===ht}),mt||it&&ft?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):it?it.getStats():ft?ft.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return ct.apply(this,arguments)}}}},st.shimAddTrackRemoveTrackWithNative=at,st.shimAddTrackRemoveTrack=function(lt){function St(Tt,It){var Pt=It.sdp;return Object.keys(Tt._reverseStreams||[]).forEach(function(At){var Nt=Tt._reverseStreams[At],Ot=Tt._streams[Nt.id];Pt=Pt.replace(new RegExp(Ot.id,"g"),Nt.id)}),new RTCSessionDescription({type:It.type,sdp:Pt})}function pt(Tt,It){var Pt=It.sdp;return Object.keys(Tt._reverseStreams||[]).forEach(function(At){var Nt=Tt._reverseStreams[At],Ot=Tt._streams[Nt.id];Pt=Pt.replace(new RegExp(Nt.id,"g"),Ot.id)}),new RTCSessionDescription({type:It.type,sdp:Pt})}if(lt.RTCPeerConnection){var gt=ot.detectBrowser(lt);if(lt.RTCPeerConnection.prototype.addTrack&&gt.version>=65)return at(lt);var ct=lt.RTCPeerConnection.prototype.getLocalStreams;lt.RTCPeerConnection.prototype.getLocalStreams=function(){var Tt=this,It=ct.apply(this);return this._reverseStreams=this._reverseStreams||{},It.map(function(Pt){return Tt._reverseStreams[Pt.id]})};var ht=lt.RTCPeerConnection.prototype.addStream;lt.RTCPeerConnection.prototype.addStream=function(Tt){var It=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},Tt.getTracks().forEach(function(At){if(It.getSenders().find(function(Nt){return Nt.track===At}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[Tt.id]){var Pt=new lt.MediaStream(Tt.getTracks());this._streams[Tt.id]=Pt,this._reverseStreams[Pt.id]=Tt,Tt=Pt}ht.apply(this,[Tt])};var it=lt.RTCPeerConnection.prototype.removeStream;lt.RTCPeerConnection.prototype.removeStream=function(Tt){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},it.apply(this,[this._streams[Tt.id]||Tt]),delete this._reverseStreams[this._streams[Tt.id]?this._streams[Tt.id].id:Tt.id],delete this._streams[Tt.id]},lt.RTCPeerConnection.prototype.addTrack=function(Tt,It){var Pt=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var At=[].slice.call(arguments,1);if(At.length!==1||!At[0].getTracks().find(function(Mt){return Mt===Tt}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(Mt){return Mt.track===Tt}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var Nt=this._streams[It.id];if(Nt)Nt.addTrack(Tt),Promise.resolve().then(function(){Pt.dispatchEvent(new Event("negotiationneeded"))});else{var Ot=new lt.MediaStream([Tt]);this._streams[It.id]=Ot,this._reverseStreams[Ot.id]=It,this.addStream(Ot)}return this.getSenders().find(function(Mt){return Mt.track===Tt})},["createOffer","createAnswer"].forEach(function(Tt){var It=lt.RTCPeerConnection.prototype[Tt];lt.RTCPeerConnection.prototype[Tt]=function(){var Pt=this,At=arguments;return arguments.length&&typeof arguments[0]=="function"?It.apply(this,[function(Nt){var Ot=St(Pt,Nt);At[0].apply(null,[Ot])},function(Nt){At[1]&&At[1].apply(null,Nt)},arguments[2]]):It.apply(this,arguments).then(function(Nt){return St(Pt,Nt)})}});var ft=lt.RTCPeerConnection.prototype.setLocalDescription;lt.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=pt(this,arguments[0]),ft.apply(this,arguments)):ft.apply(this,arguments)};var mt=Object.getOwnPropertyDescriptor(lt.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(lt.RTCPeerConnection.prototype,"localDescription",{get:function(){var Tt=mt.get.apply(this);return Tt.type===""?Tt:St(this,Tt)}}),lt.RTCPeerConnection.prototype.removeTrack=function(Tt){var It=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!Tt._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(Tt._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var Pt=void 0;Object.keys(this._streams).forEach(function(At){It._streams[At].getTracks().find(function(Nt){return Tt.track===Nt})&&(Pt=It._streams[At])}),Pt&&(Pt.getTracks().length===1?this.removeStream(this._reverseStreams[Pt.id]):Pt.removeTrack(Tt.track),this.dispatchEvent(new Event("negotiationneeded")))}}},st.shimPeerConnection=function(lt){if(!lt.RTCPeerConnection&&lt.webkitRTCPeerConnection&&(lt.RTCPeerConnection=lt.webkitRTCPeerConnection),lt.RTCPeerConnection){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(pt){var gt=lt.RTCPeerConnection.prototype[pt];lt.RTCPeerConnection.prototype[pt]=function(){return arguments[0]=new(pt==="addIceCandidate"?lt.RTCIceCandidate:lt.RTCSessionDescription)(arguments[0]),gt.apply(this,arguments)}});var St=lt.RTCPeerConnection.prototype.addIceCandidate;lt.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?St.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},st.fixNegotiationNeeded=function(lt){ot.wrapPeerConnectionEvent(lt,"negotiationneeded",function(St){if(St.target.signalingState==="stable")return St})};var ot=function(lt){if(lt&&lt.__esModule)return lt;var St={};if(lt!=null)for(var pt in lt)Object.prototype.hasOwnProperty.call(lt,pt)&&(St[pt]=lt[pt]);return St.default=lt,St}(tt("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0}),st.shimGetDisplayMedia=function(at,ut){at.navigator.mediaDevices&&"getDisplayMedia"in at.navigator.mediaDevices||at.navigator.mediaDevices&&(typeof ut=="function"?at.navigator.mediaDevices.getDisplayMedia=function(s){return ut(s).then(function(et){var ot=s.video&&s.video.width,lt=s.video&&s.video.height,St=s.video&&s.video.frameRate;return s.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:et,maxFrameRate:St||3}},ot&&(s.video.mandatory.maxWidth=ot),lt&&(s.video.mandatory.maxHeight=lt),at.navigator.mediaDevices.getUserMedia(s)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],5:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0});var at=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et};st.shimGetUserMedia=function(et){var ot=et&&et.navigator;if(ot.mediaDevices){var lt=ut.detectBrowser(et),St=function(ht){if((ht===void 0?"undefined":at(ht))!=="object"||ht.mandatory||ht.optional)return ht;var it={};return Object.keys(ht).forEach(function(ft){if(ft!=="require"&&ft!=="advanced"&&ft!=="mediaSource"){var mt=at(ht[ft])==="object"?ht[ft]:{ideal:ht[ft]};mt.exact!==void 0&&typeof mt.exact=="number"&&(mt.min=mt.max=mt.exact);var Tt=function(Pt,At){return Pt?Pt+At.charAt(0).toUpperCase()+At.slice(1):At==="deviceId"?"sourceId":At};if(mt.ideal!==void 0){it.optional=it.optional||[];var It={};typeof mt.ideal=="number"?(It[Tt("min",ft)]=mt.ideal,it.optional.push(It),(It={})[Tt("max",ft)]=mt.ideal,it.optional.push(It)):(It[Tt("",ft)]=mt.ideal,it.optional.push(It))}mt.exact!==void 0&&typeof mt.exact!="number"?(it.mandatory=it.mandatory||{},it.mandatory[Tt("",ft)]=mt.exact):["min","max"].forEach(function(Pt){mt[Pt]!==void 0&&(it.mandatory=it.mandatory||{},it.mandatory[Tt(Pt,ft)]=mt[Pt])})}}),ht.advanced&&(it.optional=(it.optional||[]).concat(ht.advanced)),it},pt=function(ht,it){if(lt.version>=61)return it(ht);if((ht=JSON.parse(JSON.stringify(ht)))&&at(ht.audio)==="object"){var ft=function(Pt,At,Nt){At in Pt&&!(Nt in Pt)&&(Pt[Nt]=Pt[At],delete Pt[At])};ft((ht=JSON.parse(JSON.stringify(ht))).audio,"autoGainControl","googAutoGainControl"),ft(ht.audio,"noiseSuppression","googNoiseSuppression"),ht.audio=St(ht.audio)}if(ht&&at(ht.video)==="object"){var mt=ht.video.facingMode;mt=mt&&((mt===void 0?"undefined":at(mt))==="object"?mt:{ideal:mt});var Tt=lt.version<66;if(mt&&(mt.exact==="user"||mt.exact==="environment"||mt.ideal==="user"||mt.ideal==="environment")&&(!ot.mediaDevices.getSupportedConstraints||!ot.mediaDevices.getSupportedConstraints().facingMode||Tt)){delete ht.video.facingMode;var It=void 0;if(mt.exact==="environment"||mt.ideal==="environment"?It=["back","rear"]:mt.exact!=="user"&&mt.ideal!=="user"||(It=["front"]),It)return ot.mediaDevices.enumerateDevices().then(function(Pt){var At=(Pt=Pt.filter(function(Nt){return Nt.kind==="videoinput"})).find(function(Nt){return It.some(function(Ot){return Nt.label.toLowerCase().includes(Ot)})});return!At&&Pt.length&&It.includes("back")&&(At=Pt[Pt.length-1]),At&&(ht.video.deviceId=mt.exact?{exact:At.deviceId}:{ideal:At.deviceId}),ht.video=St(ht.video),s("chrome: "+JSON.stringify(ht)),it(ht)})}ht.video=St(ht.video)}return s("chrome: "+JSON.stringify(ht)),it(ht)},gt=function(ht){return lt.version>=64?ht:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[ht.name]||ht.name,message:ht.message,constraint:ht.constraint||ht.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(ot.getUserMedia=(function(ht,it,ft){pt(ht,function(mt){ot.webkitGetUserMedia(mt,it,function(Tt){ft&&ft(gt(Tt))})})}).bind(ot),ot.mediaDevices.getUserMedia){var ct=ot.mediaDevices.getUserMedia.bind(ot.mediaDevices);ot.mediaDevices.getUserMedia=function(ht){return pt(ht,function(it){return ct(it).then(function(ft){if(it.audio&&!ft.getAudioTracks().length||it.video&&!ft.getVideoTracks().length)throw ft.getTracks().forEach(function(mt){mt.stop()}),new DOMException("","NotFoundError");return ft},function(ft){return Promise.reject(gt(ft))})})}}}};var ut=function(et){if(et&&et.__esModule)return et;var ot={};if(et!=null)for(var lt in et)Object.prototype.hasOwnProperty.call(et,lt)&&(ot[lt]=et[lt]);return ot.default=et,ot}(tt("../utils.js")),s=ut.log},{"../utils.js":15}],6:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0});var at=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et};st.shimRTCIceCandidate=function(et){if(et.RTCIceCandidate&&!(et.RTCIceCandidate&&"foundation"in et.RTCIceCandidate.prototype)){var ot=et.RTCIceCandidate;et.RTCIceCandidate=function(lt){if((lt===void 0?"undefined":at(lt))==="object"&&lt.candidate&&lt.candidate.indexOf("a=")===0&&((lt=JSON.parse(JSON.stringify(lt))).candidate=lt.candidate.substr(2)),lt.candidate&&lt.candidate.length){var St=new ot(lt),pt=ut.default.parseCandidate(lt.candidate),gt=Object.assign(St,pt);return gt.toJSON=function(){return{candidate:gt.candidate,sdpMid:gt.sdpMid,sdpMLineIndex:gt.sdpMLineIndex,usernameFragment:gt.usernameFragment}},gt}return new ot(lt)},et.RTCIceCandidate.prototype=ot.prototype,s.wrapPeerConnectionEvent(et,"icecandidate",function(lt){return lt.candidate&&Object.defineProperty(lt,"candidate",{value:new et.RTCIceCandidate(lt.candidate),writable:"false"}),lt})}},st.shimMaxMessageSize=function(et){if(!et.RTCSctpTransport&&et.RTCPeerConnection){var ot=s.detectBrowser(et);"sctp"in et.RTCPeerConnection.prototype||Object.defineProperty(et.RTCPeerConnection.prototype,"sctp",{get:function(){return this._sctp===void 0?null:this._sctp}});var lt=function(ht){if(!ht||!ht.sdp)return!1;var it=ut.default.splitSections(ht.sdp);return it.shift(),it.some(function(ft){var mt=ut.default.parseMLine(ft);return mt&&mt.kind==="application"&&mt.protocol.indexOf("SCTP")!==-1})},St=function(ht){var it=ht.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(it===null||it.length<2)return-1;var ft=parseInt(it[1],10);return ft!==ft?-1:ft},pt=function(ht){var it=65536;return ot.browser==="firefox"&&(it=ot.version<57?ht===-1?16384:2147483637:ot.version<60?ot.version===57?65535:65536:2147483637),it},gt=function(ht,it){var ft=65536;ot.browser==="firefox"&&ot.version===57&&(ft=65535);var mt=ut.default.matchPrefix(ht.sdp,"a=max-message-size:");return mt.length>0?ft=parseInt(mt[0].substr(19),10):ot.browser==="firefox"&&it!==-1&&(ft=2147483637),ft},ct=et.RTCPeerConnection.prototype.setRemoteDescription;et.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,lt(arguments[0])){var ht=St(arguments[0]),it=pt(ht),ft=gt(arguments[0],ht),mt=void 0;mt=it===0&&ft===0?Number.POSITIVE_INFINITY:it===0||ft===0?Math.max(it,ft):Math.min(it,ft);var Tt={};Object.defineProperty(Tt,"maxMessageSize",{get:function(){return mt}}),this._sctp=Tt}return ct.apply(this,arguments)}}},st.shimSendThrowTypeError=function(et){function ot(St,pt){var gt=St.send;St.send=function(){var ct=arguments[0],ht=ct.length||ct.size||ct.byteLength;if(St.readyState==="open"&&pt.sctp&&ht>pt.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+pt.sctp.maxMessageSize+" bytes)");return gt.apply(St,arguments)}}if(et.RTCPeerConnection&&"createDataChannel"in et.RTCPeerConnection.prototype){var lt=et.RTCPeerConnection.prototype.createDataChannel;et.RTCPeerConnection.prototype.createDataChannel=function(){var St=lt.apply(this,arguments);return ot(St,this),St},s.wrapPeerConnectionEvent(et,"datachannel",function(St){return ot(St.channel,St.target),St})}},st.shimConnectionState=function(et){if(et.RTCPeerConnection&&!("connectionState"in et.RTCPeerConnection.prototype)){var ot=et.RTCPeerConnection.prototype;Object.defineProperty(ot,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(ot,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(lt){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),lt&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=lt)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(lt){var St=ot[lt];ot[lt]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(pt){var gt=pt.target;if(gt._lastConnectionState!==gt.connectionState){gt._lastConnectionState=gt.connectionState;var ct=new Event("connectionstatechange",pt);gt.dispatchEvent(ct)}return pt},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),St.apply(this,arguments)}})}},st.removeAllowExtmapMixed=function(et){if(et.RTCPeerConnection){var ot=s.detectBrowser(et);if(!(ot.browser==="chrome"&&ot.version>=71||ot.browser==="safari"&&ot.version>=605)){var lt=et.RTCPeerConnection.prototype.setRemoteDescription;et.RTCPeerConnection.prototype.setRemoteDescription=function(St){return St&&St.sdp&&St.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1&&(St.sdp=St.sdp.split(`
`).filter(function(pt){return pt.trim()!=="a=extmap-allow-mixed"}).join(`
`)),lt.apply(this,arguments)}}}};var ut=function(et){return et&&et.__esModule?et:{default:et}}(tt("sdp")),s=function(et){if(et&&et.__esModule)return et;var ot={};if(et!=null)for(var lt in et)Object.prototype.hasOwnProperty.call(et,lt)&&(ot[lt]=et[lt]);return ot.default=et,ot}(tt("./utils"))},{"./utils":15,sdp:17}],7:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0}),st.shimGetDisplayMedia=st.shimGetUserMedia=void 0;var at=tt("./getusermedia");Object.defineProperty(st,"shimGetUserMedia",{enumerable:!0,get:function(){return at.shimGetUserMedia}});var ut=tt("./getdisplaymedia");Object.defineProperty(st,"shimGetDisplayMedia",{enumerable:!0,get:function(){return ut.shimGetDisplayMedia}}),st.shimPeerConnection=function(lt){var St=s.detectBrowser(lt);if(lt.RTCIceGatherer&&(lt.RTCIceCandidate||(lt.RTCIceCandidate=function(ct){return ct}),lt.RTCSessionDescription||(lt.RTCSessionDescription=function(ct){return ct}),St.version<15025)){var pt=Object.getOwnPropertyDescriptor(lt.MediaStreamTrack.prototype,"enabled");Object.defineProperty(lt.MediaStreamTrack.prototype,"enabled",{set:function(ct){pt.set.call(this,ct);var ht=new Event("enabled");ht.enabled=ct,this.dispatchEvent(ht)}})}!lt.RTCRtpSender||"dtmf"in lt.RTCRtpSender.prototype||Object.defineProperty(lt.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new lt.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),lt.RTCDtmfSender&&!lt.RTCDTMFSender&&(lt.RTCDTMFSender=lt.RTCDtmfSender);var gt=(0,ot.default)(lt,St.version);lt.RTCPeerConnection=function(ct){return ct&&ct.iceServers&&(ct.iceServers=(0,et.filterIceServers)(ct.iceServers,St.version),s.log("ICE servers after filtering:",ct.iceServers)),new gt(ct)},lt.RTCPeerConnection.prototype=gt.prototype},st.shimReplaceTrack=function(lt){!lt.RTCRtpSender||"replaceTrack"in lt.RTCRtpSender.prototype||(lt.RTCRtpSender.prototype.replaceTrack=lt.RTCRtpSender.prototype.setTrack)};var s=function(lt){if(lt&&lt.__esModule)return lt;var St={};if(lt!=null)for(var pt in lt)Object.prototype.hasOwnProperty.call(lt,pt)&&(St[pt]=lt[pt]);return St.default=lt,St}(tt("../utils")),et=tt("./filtericeservers"),ot=function(lt){return lt&&lt.__esModule?lt:{default:lt}}(tt("rtcpeerconnection-shim"))},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0}),st.filterIceServers=function(ut,s){var et=!1;return(ut=JSON.parse(JSON.stringify(ut))).filter(function(ot){if(ot&&(ot.urls||ot.url)){var lt=ot.urls||ot.url;ot.url&&!ot.urls&&at.deprecated("RTCIceServer.url","RTCIceServer.urls");var St=typeof lt=="string";return St&&(lt=[lt]),lt=lt.filter(function(pt){if(pt.indexOf("stun:")===0)return!1;var gt=pt.startsWith("turn")&&!pt.startsWith("turn:[")&&pt.includes("transport=udp");return gt&&!et?(et=!0,!0):gt&&!et}),delete ot.url,ot.urls=St?lt[0]:lt,!!lt.length}})};var at=function(ut){if(ut&&ut.__esModule)return ut;var s={};if(ut!=null)for(var et in ut)Object.prototype.hasOwnProperty.call(ut,et)&&(s[et]=ut[et]);return s.default=ut,s}(tt("../utils"))},{"../utils":15}],9:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0}),st.shimGetDisplayMedia=function(at){"getDisplayMedia"in at.navigator&&at.navigator.mediaDevices&&(at.navigator.mediaDevices&&"getDisplayMedia"in at.navigator.mediaDevices||(at.navigator.mediaDevices.getDisplayMedia=at.navigator.getDisplayMedia.bind(at.navigator)))}},{}],10:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0}),st.shimGetUserMedia=function(at){var ut=at&&at.navigator,s=function(ot){return{name:{PermissionDeniedError:"NotAllowedError"}[ot.name]||ot.name,message:ot.message,constraint:ot.constraint,toString:function(){return this.name}}},et=ut.mediaDevices.getUserMedia.bind(ut.mediaDevices);ut.mediaDevices.getUserMedia=function(ot){return et(ot).catch(function(lt){return Promise.reject(s(lt))})}}},{}],11:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0}),st.shimGetDisplayMedia=st.shimGetUserMedia=void 0;var at=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ot){return typeof ot}:function(ot){return ot&&typeof Symbol=="function"&&ot.constructor===Symbol&&ot!==Symbol.prototype?"symbol":typeof ot},ut=tt("./getusermedia");Object.defineProperty(st,"shimGetUserMedia",{enumerable:!0,get:function(){return ut.shimGetUserMedia}});var s=tt("./getdisplaymedia");Object.defineProperty(st,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}}),st.shimOnTrack=function(ot){(ot===void 0?"undefined":at(ot))==="object"&&ot.RTCTrackEvent&&"receiver"in ot.RTCTrackEvent.prototype&&!("transceiver"in ot.RTCTrackEvent.prototype)&&Object.defineProperty(ot.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},st.shimPeerConnection=function(ot){var lt=et.detectBrowser(ot);if((ot===void 0?"undefined":at(ot))==="object"&&(ot.RTCPeerConnection||ot.mozRTCPeerConnection)){!ot.RTCPeerConnection&&ot.mozRTCPeerConnection&&(ot.RTCPeerConnection=ot.mozRTCPeerConnection),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(ct){var ht=ot.RTCPeerConnection.prototype[ct];ot.RTCPeerConnection.prototype[ct]=function(){return arguments[0]=new(ct==="addIceCandidate"?ot.RTCIceCandidate:ot.RTCSessionDescription)(arguments[0]),ht.apply(this,arguments)}});var St=ot.RTCPeerConnection.prototype.addIceCandidate;ot.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?St.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var pt={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},gt=ot.RTCPeerConnection.prototype.getStats;ot.RTCPeerConnection.prototype.getStats=function(ct,ht,it){return gt.apply(this,[ct||null]).then(function(ft){if(lt.version<53&&!ht)try{ft.forEach(function(mt){mt.type=pt[mt.type]||mt.type})}catch(mt){if(mt.name!=="TypeError")throw mt;ft.forEach(function(Tt,It){ft.set(It,Object.assign({},Tt,{type:pt[Tt.type]||Tt.type}))})}return ft}).then(ht,it)}}},st.shimSenderGetStats=function(ot){if((ot===void 0?"undefined":at(ot))==="object"&&ot.RTCPeerConnection&&ot.RTCRtpSender&&!(ot.RTCRtpSender&&"getStats"in ot.RTCRtpSender.prototype)){var lt=ot.RTCPeerConnection.prototype.getSenders;lt&&(ot.RTCPeerConnection.prototype.getSenders=function(){var pt=this,gt=lt.apply(this,[]);return gt.forEach(function(ct){return ct._pc=pt}),gt});var St=ot.RTCPeerConnection.prototype.addTrack;St&&(ot.RTCPeerConnection.prototype.addTrack=function(){var pt=St.apply(this,arguments);return pt._pc=this,pt}),ot.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},st.shimReceiverGetStats=function(ot){if((ot===void 0?"undefined":at(ot))==="object"&&ot.RTCPeerConnection&&ot.RTCRtpSender&&!(ot.RTCRtpSender&&"getStats"in ot.RTCRtpReceiver.prototype)){var lt=ot.RTCPeerConnection.prototype.getReceivers;lt&&(ot.RTCPeerConnection.prototype.getReceivers=function(){var St=this,pt=lt.apply(this,[]);return pt.forEach(function(gt){return gt._pc=St}),pt}),et.wrapPeerConnectionEvent(ot,"track",function(St){return St.receiver._pc=St.srcElement,St}),ot.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},st.shimRemoveStream=function(ot){!ot.RTCPeerConnection||"removeStream"in ot.RTCPeerConnection.prototype||(ot.RTCPeerConnection.prototype.removeStream=function(lt){var St=this;et.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(pt){pt.track&&lt.getTracks().includes(pt.track)&&St.removeTrack(pt)})})},st.shimRTCDataChannel=function(ot){ot.DataChannel&&!ot.RTCDataChannel&&(ot.RTCDataChannel=ot.DataChannel)};var et=function(ot){if(ot&&ot.__esModule)return ot;var lt={};if(ot!=null)for(var St in ot)Object.prototype.hasOwnProperty.call(ot,St)&&(lt[St]=ot[St]);return lt.default=ot,lt}(tt("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0}),st.shimGetDisplayMedia=function(at,ut){at.navigator.mediaDevices&&"getDisplayMedia"in at.navigator.mediaDevices||at.navigator.mediaDevices&&(at.navigator.mediaDevices.getDisplayMedia=function(s){if(!s||!s.video){var et=new DOMException("getDisplayMedia without video constraints is undefined");return et.name="NotFoundError",et.code=8,Promise.reject(et)}return s.video===!0?s.video={mediaSource:ut}:s.video.mediaSource=ut,at.navigator.mediaDevices.getUserMedia(s)})}},{}],13:[function(tt,rt,st){Object.defineProperty(st,"__esModule",{value:!0});var at=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s};st.shimGetUserMedia=function(s){var et=ut.detectBrowser(s),ot=s&&s.navigator,lt=s&&s.MediaStreamTrack;if(ot.getUserMedia=function(ht,it,ft){ut.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),ot.mediaDevices.getUserMedia(ht).then(it,ft)},!(et.version>55&&"autoGainControl"in ot.mediaDevices.getSupportedConstraints())){var St=function(ht,it,ft){it in ht&&!(ft in ht)&&(ht[ft]=ht[it],delete ht[it])},pt=ot.mediaDevices.getUserMedia.bind(ot.mediaDevices);if(ot.mediaDevices.getUserMedia=function(ht){return(ht===void 0?"undefined":at(ht))==="object"&&at(ht.audio)==="object"&&(ht=JSON.parse(JSON.stringify(ht)),St(ht.audio,"autoGainControl","mozAutoGainControl"),St(ht.audio,"noiseSuppression","mozNoiseSuppression")),pt(ht)},lt&&lt.prototype.getSettings){var gt=lt.prototype.getSettings;lt.prototype.getSettings=function(){var ht=gt.apply(this,arguments);return St(ht,"mozAutoGainControl","autoGainControl"),St(ht,"mozNoiseSuppression","noiseSuppression"),ht}}if(lt&&lt.prototype.applyConstraints){var ct=lt.prototype.applyConstraints;lt.prototype.applyConstraints=function(ht){return this.kind==="audio"&&(ht===void 0?"undefined":at(ht))==="object"&&(ht=JSON.parse(JSON.stringify(ht)),St(ht,"autoGainControl","mozAutoGainControl"),St(ht,"noiseSuppression","mozNoiseSuppression")),ct.apply(this,[ht])}}}};var ut=function(s){if(s&&s.__esModule)return s;var et={};if(s!=null)for(var ot in s)Object.prototype.hasOwnProperty.call(s,ot)&&(et[ot]=s[ot]);return et.default=s,et}(tt("../utils"))},{"../utils":15}],14:[function(tt,rt,st){function at(et){return et&&et.video!==void 0?Object.assign({},et,{video:s.compactObject(et.video)}):et}Object.defineProperty(st,"__esModule",{value:!0});var ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et};st.shimLocalStreamsAPI=function(et){if((et===void 0?"undefined":ut(et))==="object"&&et.RTCPeerConnection){if("getLocalStreams"in et.RTCPeerConnection.prototype||(et.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in et.RTCPeerConnection.prototype)){var ot=et.RTCPeerConnection.prototype.addTrack;et.RTCPeerConnection.prototype.addStream=function(lt){var St=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(lt)||this._localStreams.push(lt),lt.getTracks().forEach(function(pt){return ot.call(St,pt,lt)})},et.RTCPeerConnection.prototype.addTrack=function(lt,St){return St&&(this._localStreams?this._localStreams.includes(St)||this._localStreams.push(St):this._localStreams=[St]),ot.call(this,lt,St)}}"removeStream"in et.RTCPeerConnection.prototype||(et.RTCPeerConnection.prototype.removeStream=function(lt){var St=this;this._localStreams||(this._localStreams=[]);var pt=this._localStreams.indexOf(lt);if(pt!==-1){this._localStreams.splice(pt,1);var gt=lt.getTracks();this.getSenders().forEach(function(ct){gt.includes(ct.track)&&St.removeTrack(ct)})}})}},st.shimRemoteStreamsAPI=function(et){if((et===void 0?"undefined":ut(et))==="object"&&et.RTCPeerConnection&&("getRemoteStreams"in et.RTCPeerConnection.prototype||(et.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in et.RTCPeerConnection.prototype))){Object.defineProperty(et.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(lt){var St=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=lt),this.addEventListener("track",this._onaddstreampoly=function(pt){pt.streams.forEach(function(gt){if(St._remoteStreams||(St._remoteStreams=[]),!St._remoteStreams.includes(gt)){St._remoteStreams.push(gt);var ct=new Event("addstream");ct.stream=gt,St.dispatchEvent(ct)}})})}});var ot=et.RTCPeerConnection.prototype.setRemoteDescription;et.RTCPeerConnection.prototype.setRemoteDescription=function(){var lt=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(St){St.streams.forEach(function(pt){if(lt._remoteStreams||(lt._remoteStreams=[]),!(lt._remoteStreams.indexOf(pt)>=0)){lt._remoteStreams.push(pt);var gt=new Event("addstream");gt.stream=pt,lt.dispatchEvent(gt)}})}),ot.apply(lt,arguments)}}},st.shimCallbacksAPI=function(et){if((et===void 0?"undefined":ut(et))==="object"&&et.RTCPeerConnection){var ot=et.RTCPeerConnection.prototype,lt=ot.createOffer,St=ot.createAnswer,pt=ot.setLocalDescription,gt=ot.setRemoteDescription,ct=ot.addIceCandidate;ot.createOffer=function(it,ft){var mt=arguments.length>=2?arguments[2]:arguments[0],Tt=lt.apply(this,[mt]);return ft?(Tt.then(it,ft),Promise.resolve()):Tt},ot.createAnswer=function(it,ft){var mt=arguments.length>=2?arguments[2]:arguments[0],Tt=St.apply(this,[mt]);return ft?(Tt.then(it,ft),Promise.resolve()):Tt};var ht=function(it,ft,mt){var Tt=pt.apply(this,[it]);return mt?(Tt.then(ft,mt),Promise.resolve()):Tt};ot.setLocalDescription=ht,ht=function(it,ft,mt){var Tt=gt.apply(this,[it]);return mt?(Tt.then(ft,mt),Promise.resolve()):Tt},ot.setRemoteDescription=ht,ht=function(it,ft,mt){var Tt=ct.apply(this,[it]);return mt?(Tt.then(ft,mt),Promise.resolve()):Tt},ot.addIceCandidate=ht}},st.shimGetUserMedia=function(et){var ot=et&&et.navigator;if(ot.mediaDevices&&ot.mediaDevices.getUserMedia){var lt=ot.mediaDevices,St=lt.getUserMedia.bind(lt);ot.mediaDevices.getUserMedia=function(pt){return St(at(pt))}}!ot.getUserMedia&&ot.mediaDevices&&ot.mediaDevices.getUserMedia&&(ot.getUserMedia=(function(pt,gt,ct){ot.mediaDevices.getUserMedia(pt).then(gt,ct)}).bind(ot))},st.shimConstraints=at,st.shimRTCIceServerUrls=function(et){var ot=et.RTCPeerConnection;et.RTCPeerConnection=function(lt,St){if(lt&&lt.iceServers){for(var pt=[],gt=0;gt<lt.iceServers.length;gt++){var ct=lt.iceServers[gt];!ct.hasOwnProperty("urls")&&ct.hasOwnProperty("url")?(s.deprecated("RTCIceServer.url","RTCIceServer.urls"),(ct=JSON.parse(JSON.stringify(ct))).urls=ct.url,delete ct.url,pt.push(ct)):pt.push(lt.iceServers[gt])}lt.iceServers=pt}return new ot(lt,St)},et.RTCPeerConnection.prototype=ot.prototype,"generateCertificate"in et.RTCPeerConnection&&Object.defineProperty(et.RTCPeerConnection,"generateCertificate",{get:function(){return ot.generateCertificate}})},st.shimTrackEventTransceiver=function(et){(et===void 0?"undefined":ut(et))==="object"&&et.RTCPeerConnection&&"receiver"in et.RTCTrackEvent.prototype&&!et.RTCTransceiver&&Object.defineProperty(et.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},st.shimCreateOfferLegacy=function(et){var ot=et.RTCPeerConnection.prototype.createOffer;et.RTCPeerConnection.prototype.createOffer=function(lt){if(lt){lt.offerToReceiveAudio!==void 0&&(lt.offerToReceiveAudio=!!lt.offerToReceiveAudio);var St=this.getTransceivers().find(function(gt){return gt.receiver.track.kind==="audio"});lt.offerToReceiveAudio===!1&&St?St.direction==="sendrecv"?St.setDirection?St.setDirection("sendonly"):St.direction="sendonly":St.direction==="recvonly"&&(St.setDirection?St.setDirection("inactive"):St.direction="inactive"):lt.offerToReceiveAudio!==!0||St||this.addTransceiver("audio"),lt.offerToReceiveVideo!==void 0&&(lt.offerToReceiveVideo=!!lt.offerToReceiveVideo);var pt=this.getTransceivers().find(function(gt){return gt.receiver.track.kind==="video"});lt.offerToReceiveVideo===!1&&pt?pt.direction==="sendrecv"?pt.setDirection?pt.setDirection("sendonly"):pt.direction="sendonly":pt.direction==="recvonly"&&(pt.setDirection?pt.setDirection("inactive"):pt.direction="inactive"):lt.offerToReceiveVideo!==!0||pt||this.addTransceiver("video")}return ot.apply(this,arguments)}};var s=function(et){if(et&&et.__esModule)return et;var ot={};if(et!=null)for(var lt in et)Object.prototype.hasOwnProperty.call(et,lt)&&(ot[lt]=et[lt]);return ot.default=et,ot}(tt("../utils"))},{"../utils":15}],15:[function(tt,rt,st){function at(pt,gt,ct){return gt in pt?Object.defineProperty(pt,gt,{value:ct,enumerable:!0,configurable:!0,writable:!0}):pt[gt]=ct,pt}function ut(pt,gt,ct){var ht=pt.match(gt);return ht&&ht.length>=ct&&parseInt(ht[ct],10)}function s(pt){return(pt===void 0?"undefined":ot(pt))!=="object"?pt:Object.keys(pt).reduce(function(gt,ct){var ht=ot(pt[ct])==="object",it=ht?s(pt[ct]):pt[ct],ft=ht&&!Object.keys(it).length;return it===void 0||ft?gt:Object.assign(gt,at({},ct,it))},{})}function et(pt,gt,ct){gt&&!ct.has(gt.id)&&(ct.set(gt.id,gt),Object.keys(gt).forEach(function(ht){ht.endsWith("Id")?et(pt,pt.get(gt[ht]),ct):ht.endsWith("Ids")&&gt[ht].forEach(function(it){et(pt,pt.get(it),ct)})}))}Object.defineProperty(st,"__esModule",{value:!0});var ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(pt){return typeof pt}:function(pt){return pt&&typeof Symbol=="function"&&pt.constructor===Symbol&&pt!==Symbol.prototype?"symbol":typeof pt};st.extractVersion=ut,st.wrapPeerConnectionEvent=function(pt,gt,ct){if(pt.RTCPeerConnection){var ht=pt.RTCPeerConnection.prototype,it=ht.addEventListener;ht.addEventListener=function(mt,Tt){if(mt!==gt)return it.apply(this,arguments);var It=function(Pt){var At=ct(Pt);At&&Tt(At)};return this._eventMap=this._eventMap||{},this._eventMap[Tt]=It,it.apply(this,[mt,It])};var ft=ht.removeEventListener;ht.removeEventListener=function(mt,Tt){if(mt!==gt||!this._eventMap||!this._eventMap[Tt])return ft.apply(this,arguments);var It=this._eventMap[Tt];return delete this._eventMap[Tt],ft.apply(this,[mt,It])},Object.defineProperty(ht,"on"+gt,{get:function(){return this["_on"+gt]},set:function(mt){this["_on"+gt]&&(this.removeEventListener(gt,this["_on"+gt]),delete this["_on"+gt]),mt&&this.addEventListener(gt,this["_on"+gt]=mt)},enumerable:!0,configurable:!0})}},st.disableLog=function(pt){return typeof pt!="boolean"?new Error("Argument type: "+(pt===void 0?"undefined":ot(pt))+". Please use a boolean."):(lt=pt,pt?"adapter.js logging disabled":"adapter.js logging enabled")},st.disableWarnings=function(pt){return typeof pt!="boolean"?new Error("Argument type: "+(pt===void 0?"undefined":ot(pt))+". Please use a boolean."):(St=!pt,"adapter.js deprecation warnings "+(pt?"disabled":"enabled"))},st.log=function(){if((typeof window>"u"?"undefined":ot(window))==="object"){if(lt)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}},st.deprecated=function(pt,gt){St&&console.warn(pt+" is deprecated, please use "+gt+" instead.")},st.detectBrowser=function(pt){var gt=pt.navigator,ct={browser:null,version:null};if(pt===void 0||!pt.navigator)return ct.browser="Not a browser.",ct;if(gt.mozGetUserMedia)ct.browser="firefox",ct.version=ut(gt.userAgent,/Firefox\/(\d+)\./,1);else if(gt.webkitGetUserMedia||pt.isSecureContext===!1&&pt.webkitRTCPeerConnection&&!pt.RTCIceGatherer)ct.browser="chrome",ct.version=ut(gt.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(gt.mediaDevices&&gt.userAgent.match(/Edge\/(\d+).(\d+)$/))ct.browser="edge",ct.version=ut(gt.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!pt.RTCPeerConnection||!gt.userAgent.match(/AppleWebKit\/(\d+)\./))return ct.browser="Not a supported browser.",ct;ct.browser="safari",ct.version=ut(gt.userAgent,/AppleWebKit\/(\d+)\./,1)}return ct},st.compactObject=s,st.walkStats=et,st.filterStats=function(pt,gt,ct){var ht=ct?"outbound-rtp":"inbound-rtp",it=new Map;if(gt===null)return it;var ft=[];return pt.forEach(function(mt){mt.type==="track"&&mt.trackIdentifier===gt.id&&ft.push(mt)}),ft.forEach(function(mt){pt.forEach(function(Tt){Tt.type===ht&&Tt.trackId===mt.id&&et(pt,Tt,it)})}),it};var lt=!0,St=!0},{}],16:[function(tt,rt,st){function at(gt){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[gt.type]||gt.type}function ut(gt,ct,ht,it,ft){var mt=pt.writeRtpDescription(gt.kind,ct);if(mt+=pt.writeIceParameters(gt.iceGatherer.getLocalParameters()),mt+=pt.writeDtlsParameters(gt.dtlsTransport.getLocalParameters(),ht==="offer"?"actpass":ft||"active"),mt+="a=mid:"+gt.mid+`\r
`,gt.rtpSender&&gt.rtpReceiver?mt+=`a=sendrecv\r
`:gt.rtpSender?mt+=`a=sendonly\r
`:gt.rtpReceiver?mt+=`a=recvonly\r
`:mt+=`a=inactive\r
`,gt.rtpSender){var Tt=gt.rtpSender._initialTrackId||gt.rtpSender.track.id;gt.rtpSender._initialTrackId=Tt;var It="msid:"+(it?it.id:"-")+" "+Tt+`\r
`;mt+="a="+It,mt+="a=ssrc:"+gt.sendEncodingParameters[0].ssrc+" "+It,gt.sendEncodingParameters[0].rtx&&(mt+="a=ssrc:"+gt.sendEncodingParameters[0].rtx.ssrc+" "+It,mt+="a=ssrc-group:FID "+gt.sendEncodingParameters[0].ssrc+" "+gt.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return mt+="a=ssrc:"+gt.sendEncodingParameters[0].ssrc+" cname:"+pt.localCName+`\r
`,gt.rtpSender&&gt.sendEncodingParameters[0].rtx&&(mt+="a=ssrc:"+gt.sendEncodingParameters[0].rtx.ssrc+" cname:"+pt.localCName+`\r
`),mt}function s(gt,ct){var ht=!1;return(gt=JSON.parse(JSON.stringify(gt))).filter(function(it){if(it&&(it.urls||it.url)){var ft=it.urls||it.url;it.url&&!it.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var mt=typeof ft=="string";return mt&&(ft=[ft]),ft=ft.filter(function(Tt){return Tt.indexOf("turn:")===0&&Tt.indexOf("transport=udp")!==-1&&Tt.indexOf("turn:[")===-1&&!ht?(ht=!0,!0):Tt.indexOf("stun:")===0&&ct>=14393&&Tt.indexOf("?transport=udp")===-1}),delete it.url,it.urls=mt?ft[0]:ft,!!ft.length}})}function et(gt,ct){var ht={codecs:[],headerExtensions:[],fecMechanisms:[]},it=function(mt,Tt){mt=parseInt(mt,10);for(var It=0;It<Tt.length;It++)if(Tt[It].payloadType===mt||Tt[It].preferredPayloadType===mt)return Tt[It]},ft=function(mt,Tt,It,Pt){var At=it(mt.parameters.apt,It),Nt=it(Tt.parameters.apt,Pt);return At&&Nt&&At.name.toLowerCase()===Nt.name.toLowerCase()};return gt.codecs.forEach(function(mt){for(var Tt=0;Tt<ct.codecs.length;Tt++){var It=ct.codecs[Tt];if(mt.name.toLowerCase()===It.name.toLowerCase()&&mt.clockRate===It.clockRate){if(mt.name.toLowerCase()==="rtx"&&mt.parameters&&It.parameters.apt&&!ft(mt,It,gt.codecs,ct.codecs))continue;(It=JSON.parse(JSON.stringify(It))).numChannels=Math.min(mt.numChannels,It.numChannels),ht.codecs.push(It),It.rtcpFeedback=It.rtcpFeedback.filter(function(Pt){for(var At=0;At<mt.rtcpFeedback.length;At++)if(mt.rtcpFeedback[At].type===Pt.type&&mt.rtcpFeedback[At].parameter===Pt.parameter)return!0;return!1});break}}}),gt.headerExtensions.forEach(function(mt){for(var Tt=0;Tt<ct.headerExtensions.length;Tt++){var It=ct.headerExtensions[Tt];if(mt.uri===It.uri){ht.headerExtensions.push(It);break}}}),ht}function ot(gt,ct,ht){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[ct][gt].indexOf(ht)!==-1}function lt(gt,ct){var ht=gt.getRemoteCandidates().find(function(it){return ct.foundation===it.foundation&&ct.ip===it.ip&&ct.port===it.port&&ct.priority===it.priority&&ct.protocol===it.protocol&&ct.type===it.type});return ht||gt.addRemoteCandidate(ct),!ht}function St(gt,ct){var ht=new Error(ct);return ht.name=gt,ht.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[gt],ht}var pt=tt("sdp");rt.exports=function(gt,ct){function ht(It,Pt){Pt.addTrack(It),Pt.dispatchEvent(new gt.MediaStreamTrackEvent("addtrack",{track:It}))}function it(It,Pt){Pt.removeTrack(It),Pt.dispatchEvent(new gt.MediaStreamTrackEvent("removetrack",{track:It}))}function ft(It,Pt,At,Nt){var Ot=new Event("track");Ot.track=Pt,Ot.receiver=At,Ot.transceiver={receiver:At},Ot.streams=Nt,gt.setTimeout(function(){It._dispatchEvent("track",Ot)})}var mt=function(It){var Pt=this,At=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(Ot){Pt[Ot]=At[Ot].bind(At)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",It=JSON.parse(JSON.stringify(It||{})),this.usingBundle=It.bundlePolicy==="max-bundle",It.rtcpMuxPolicy==="negotiate")throw St("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(It.rtcpMuxPolicy||(It.rtcpMuxPolicy="require"),It.iceTransportPolicy){case"all":case"relay":break;default:It.iceTransportPolicy="all"}switch(It.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:It.bundlePolicy="balanced"}if(It.iceServers=s(It.iceServers||[],ct),this._iceGatherers=[],It.iceCandidatePoolSize)for(var Nt=It.iceCandidatePoolSize;Nt>0;Nt--)this._iceGatherers.push(new gt.RTCIceGatherer({iceServers:It.iceServers,gatherPolicy:It.iceTransportPolicy}));else It.iceCandidatePoolSize=0;this._config=It,this.transceivers=[],this._sdpSessionId=pt.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(mt.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(mt.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),mt.prototype.onicecandidate=null,mt.prototype.onaddstream=null,mt.prototype.ontrack=null,mt.prototype.onremovestream=null,mt.prototype.onsignalingstatechange=null,mt.prototype.oniceconnectionstatechange=null,mt.prototype.onconnectionstatechange=null,mt.prototype.onicegatheringstatechange=null,mt.prototype.onnegotiationneeded=null,mt.prototype.ondatachannel=null,mt.prototype._dispatchEvent=function(It,Pt){this._isClosed||(this.dispatchEvent(Pt),typeof this["on"+It]=="function"&&this["on"+It](Pt))},mt.prototype._emitGatheringStateChange=function(){var It=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",It)},mt.prototype.getConfiguration=function(){return this._config},mt.prototype.getLocalStreams=function(){return this.localStreams},mt.prototype.getRemoteStreams=function(){return this.remoteStreams},mt.prototype._createTransceiver=function(It,Pt){var At=this.transceivers.length>0,Nt={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:It,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&At)Nt.iceTransport=this.transceivers[0].iceTransport,Nt.dtlsTransport=this.transceivers[0].dtlsTransport;else{var Ot=this._createIceAndDtlsTransports();Nt.iceTransport=Ot.iceTransport,Nt.dtlsTransport=Ot.dtlsTransport}return Pt||this.transceivers.push(Nt),Nt},mt.prototype.addTrack=function(It,Pt){if(this._isClosed)throw St("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(Ot){return Ot.track===It}))throw St("InvalidAccessError","Track already exists.");for(var At,Nt=0;Nt<this.transceivers.length;Nt++)this.transceivers[Nt].track||this.transceivers[Nt].kind!==It.kind||(At=this.transceivers[Nt]);return At||(At=this._createTransceiver(It.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(Pt)===-1&&this.localStreams.push(Pt),At.track=It,At.stream=Pt,At.rtpSender=new gt.RTCRtpSender(It,At.dtlsTransport),At.rtpSender},mt.prototype.addStream=function(It){var Pt=this;if(ct>=15025)It.getTracks().forEach(function(Nt){Pt.addTrack(Nt,It)});else{var At=It.clone();It.getTracks().forEach(function(Nt,Ot){var Mt=At.getTracks()[Ot];Nt.addEventListener("enabled",function(bt){Mt.enabled=bt.enabled})}),At.getTracks().forEach(function(Nt){Pt.addTrack(Nt,At)})}},mt.prototype.removeTrack=function(It){if(this._isClosed)throw St("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(It instanceof gt.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var Pt=this.transceivers.find(function(Nt){return Nt.rtpSender===It});if(!Pt)throw St("InvalidAccessError","Sender was not created by this connection.");var At=Pt.stream;Pt.rtpSender.stop(),Pt.rtpSender=null,Pt.track=null,Pt.stream=null,this.transceivers.map(function(Nt){return Nt.stream}).indexOf(At)===-1&&this.localStreams.indexOf(At)>-1&&this.localStreams.splice(this.localStreams.indexOf(At),1),this._maybeFireNegotiationNeeded()},mt.prototype.removeStream=function(It){var Pt=this;It.getTracks().forEach(function(At){var Nt=Pt.getSenders().find(function(Ot){return Ot.track===At});Nt&&Pt.removeTrack(Nt)})},mt.prototype.getSenders=function(){return this.transceivers.filter(function(It){return!!It.rtpSender}).map(function(It){return It.rtpSender})},mt.prototype.getReceivers=function(){return this.transceivers.filter(function(It){return!!It.rtpReceiver}).map(function(It){return It.rtpReceiver})},mt.prototype._createIceGatherer=function(It,Pt){var At=this;if(Pt&&It>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var Nt=new gt.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(Nt,"state",{value:"new",writable:!0}),this.transceivers[It].bufferedCandidateEvents=[],this.transceivers[It].bufferCandidates=function(Ot){var Mt=!Ot.candidate||Object.keys(Ot.candidate).length===0;Nt.state=Mt?"completed":"gathering",At.transceivers[It].bufferedCandidateEvents!==null&&At.transceivers[It].bufferedCandidateEvents.push(Ot)},Nt.addEventListener("localcandidate",this.transceivers[It].bufferCandidates),Nt},mt.prototype._gather=function(It,Pt){var At=this,Nt=this.transceivers[Pt].iceGatherer;if(!Nt.onlocalcandidate){var Ot=this.transceivers[Pt].bufferedCandidateEvents;this.transceivers[Pt].bufferedCandidateEvents=null,Nt.removeEventListener("localcandidate",this.transceivers[Pt].bufferCandidates),Nt.onlocalcandidate=function(Mt){if(!(At.usingBundle&&Pt>0)){var bt=new Event("icecandidate");bt.candidate={sdpMid:It,sdpMLineIndex:Pt};var Wt=Mt.candidate,zt=!Wt||Object.keys(Wt).length===0;if(zt)Nt.state!=="new"&&Nt.state!=="gathering"||(Nt.state="completed");else{Nt.state==="new"&&(Nt.state="gathering"),Wt.component=1,Wt.ufrag=Nt.getLocalParameters().usernameFragment;var Bt=pt.writeCandidate(Wt);bt.candidate=Object.assign(bt.candidate,pt.parseCandidate(Bt)),bt.candidate.candidate=Bt,bt.candidate.toJSON=function(){return{candidate:bt.candidate.candidate,sdpMid:bt.candidate.sdpMid,sdpMLineIndex:bt.candidate.sdpMLineIndex,usernameFragment:bt.candidate.usernameFragment}}}var rn=pt.getMediaSections(At._localDescription.sdp);rn[bt.candidate.sdpMLineIndex]+=zt?`a=end-of-candidates\r
`:"a="+bt.candidate.candidate+`\r
`,At._localDescription.sdp=pt.getDescription(At._localDescription.sdp)+rn.join("");var gn=At.transceivers.every(function(tn){return tn.iceGatherer&&tn.iceGatherer.state==="completed"});At.iceGatheringState!=="gathering"&&(At.iceGatheringState="gathering",At._emitGatheringStateChange()),zt||At._dispatchEvent("icecandidate",bt),gn&&(At._dispatchEvent("icecandidate",new Event("icecandidate")),At.iceGatheringState="complete",At._emitGatheringStateChange())}},gt.setTimeout(function(){Ot.forEach(function(Mt){Nt.onlocalcandidate(Mt)})},0)}},mt.prototype._createIceAndDtlsTransports=function(){var It=this,Pt=new gt.RTCIceTransport(null);Pt.onicestatechange=function(){It._updateIceConnectionState(),It._updateConnectionState()};var At=new gt.RTCDtlsTransport(Pt);return At.ondtlsstatechange=function(){It._updateConnectionState()},At.onerror=function(){Object.defineProperty(At,"state",{value:"failed",writable:!0}),It._updateConnectionState()},{iceTransport:Pt,dtlsTransport:At}},mt.prototype._disposeIceAndDtlsTransports=function(It){var Pt=this.transceivers[It].iceGatherer;Pt&&(delete Pt.onlocalcandidate,delete this.transceivers[It].iceGatherer);var At=this.transceivers[It].iceTransport;At&&(delete At.onicestatechange,delete this.transceivers[It].iceTransport);var Nt=this.transceivers[It].dtlsTransport;Nt&&(delete Nt.ondtlsstatechange,delete Nt.onerror,delete this.transceivers[It].dtlsTransport)},mt.prototype._transceive=function(It,Pt,At){var Nt=et(It.localCapabilities,It.remoteCapabilities);Pt&&It.rtpSender&&(Nt.encodings=It.sendEncodingParameters,Nt.rtcp={cname:pt.localCName,compound:It.rtcpParameters.compound},It.recvEncodingParameters.length&&(Nt.rtcp.ssrc=It.recvEncodingParameters[0].ssrc),It.rtpSender.send(Nt)),At&&It.rtpReceiver&&Nt.codecs.length>0&&(It.kind==="video"&&It.recvEncodingParameters&&ct<15019&&It.recvEncodingParameters.forEach(function(Ot){delete Ot.rtx}),It.recvEncodingParameters.length?Nt.encodings=It.recvEncodingParameters:Nt.encodings=[{}],Nt.rtcp={compound:It.rtcpParameters.compound},It.rtcpParameters.cname&&(Nt.rtcp.cname=It.rtcpParameters.cname),It.sendEncodingParameters.length&&(Nt.rtcp.ssrc=It.sendEncodingParameters[0].ssrc),It.rtpReceiver.receive(Nt))},mt.prototype.setLocalDescription=function(It){var Pt=this;if(["offer","answer"].indexOf(It.type)===-1)return Promise.reject(St("TypeError",'Unsupported type "'+It.type+'"'));if(!ot("setLocalDescription",It.type,Pt.signalingState)||Pt._isClosed)return Promise.reject(St("InvalidStateError","Can not set local "+It.type+" in state "+Pt.signalingState));var At,Nt;if(It.type==="offer")At=pt.splitSections(It.sdp),Nt=At.shift(),At.forEach(function(Mt,bt){var Wt=pt.parseRtpParameters(Mt);Pt.transceivers[bt].localCapabilities=Wt}),Pt.transceivers.forEach(function(Mt,bt){Pt._gather(Mt.mid,bt)});else if(It.type==="answer"){At=pt.splitSections(Pt._remoteDescription.sdp),Nt=At.shift();var Ot=pt.matchPrefix(Nt,"a=ice-lite").length>0;At.forEach(function(Mt,bt){var Wt=Pt.transceivers[bt],zt=Wt.iceGatherer,Bt=Wt.iceTransport,rn=Wt.dtlsTransport,gn=Wt.localCapabilities,tn=Wt.remoteCapabilities;if(!(pt.isRejected(Mt)&&pt.matchPrefix(Mt,"a=bundle-only").length===0)&&!Wt.rejected){var Ht=pt.getIceParameters(Mt,Nt),fn=pt.getDtlsParameters(Mt,Nt);Ot&&(fn.role="server"),Pt.usingBundle&&bt!==0||(Pt._gather(Wt.mid,bt),Bt.state==="new"&&Bt.start(zt,Ht,Ot?"controlling":"controlled"),rn.state==="new"&&rn.start(fn));var bn=et(gn,tn);Pt._transceive(Wt,bn.codecs.length>0,!1)}})}return Pt._localDescription={type:It.type,sdp:It.sdp},It.type==="offer"?Pt._updateSignalingState("have-local-offer"):Pt._updateSignalingState("stable"),Promise.resolve()},mt.prototype.setRemoteDescription=function(It){var Pt=this;if(["offer","answer"].indexOf(It.type)===-1)return Promise.reject(St("TypeError",'Unsupported type "'+It.type+'"'));if(!ot("setRemoteDescription",It.type,Pt.signalingState)||Pt._isClosed)return Promise.reject(St("InvalidStateError","Can not set remote "+It.type+" in state "+Pt.signalingState));var At={};Pt.remoteStreams.forEach(function(Bt){At[Bt.id]=Bt});var Nt=[],Ot=pt.splitSections(It.sdp),Mt=Ot.shift(),bt=pt.matchPrefix(Mt,"a=ice-lite").length>0,Wt=pt.matchPrefix(Mt,"a=group:BUNDLE ").length>0;Pt.usingBundle=Wt;var zt=pt.matchPrefix(Mt,"a=ice-options:")[0];return Pt.canTrickleIceCandidates=!!zt&&zt.substr(14).split(" ").indexOf("trickle")>=0,Ot.forEach(function(Bt,rn){var gn=pt.splitLines(Bt),tn=pt.getKind(Bt),Ht=pt.isRejected(Bt)&&pt.matchPrefix(Bt,"a=bundle-only").length===0,fn=gn[0].substr(2).split(" ")[2],bn=pt.getDirection(Bt,Mt),In=pt.parseMsid(Bt),un=pt.getMid(Bt)||pt.generateIdentifier();if(Ht||tn==="application"&&(fn==="DTLS/SCTP"||fn==="UDP/DTLS/SCTP"))Pt.transceivers[rn]={mid:un,kind:tn,protocol:fn,rejected:!0};else{!Ht&&Pt.transceivers[rn]&&Pt.transceivers[rn].rejected&&(Pt.transceivers[rn]=Pt._createTransceiver(tn,!0));var mn,yn,pn,Tn,kn,xn,Mn,Dn,An,Nn,Un,Qn=pt.parseRtpParameters(Bt);Ht||(Nn=pt.getIceParameters(Bt,Mt),(Un=pt.getDtlsParameters(Bt,Mt)).role="client"),Mn=pt.parseRtpEncodingParameters(Bt);var er=pt.parseRtcpParameters(Bt),zn=pt.matchPrefix(Bt,"a=end-of-candidates",Mt).length>0,lr=pt.matchPrefix(Bt,"a=candidate:").map(function(Yn){return pt.parseCandidate(Yn)}).filter(function(Yn){return Yn.component===1});if((It.type==="offer"||It.type==="answer")&&!Ht&&Wt&&rn>0&&Pt.transceivers[rn]&&(Pt._disposeIceAndDtlsTransports(rn),Pt.transceivers[rn].iceGatherer=Pt.transceivers[0].iceGatherer,Pt.transceivers[rn].iceTransport=Pt.transceivers[0].iceTransport,Pt.transceivers[rn].dtlsTransport=Pt.transceivers[0].dtlsTransport,Pt.transceivers[rn].rtpSender&&Pt.transceivers[rn].rtpSender.setTransport(Pt.transceivers[0].dtlsTransport),Pt.transceivers[rn].rtpReceiver&&Pt.transceivers[rn].rtpReceiver.setTransport(Pt.transceivers[0].dtlsTransport)),It.type!=="offer"||Ht)It.type!=="answer"||Ht||(yn=(mn=Pt.transceivers[rn]).iceGatherer,pn=mn.iceTransport,Tn=mn.dtlsTransport,kn=mn.rtpReceiver,xn=mn.sendEncodingParameters,Dn=mn.localCapabilities,Pt.transceivers[rn].recvEncodingParameters=Mn,Pt.transceivers[rn].remoteCapabilities=Qn,Pt.transceivers[rn].rtcpParameters=er,lr.length&&pn.state==="new"&&(!bt&&!zn||Wt&&rn!==0?lr.forEach(function(Yn){lt(mn.iceTransport,Yn)}):pn.setRemoteCandidates(lr)),Wt&&rn!==0||(pn.state==="new"&&pn.start(yn,Nn,"controlling"),Tn.state==="new"&&Tn.start(Un)),!et(mn.localCapabilities,mn.remoteCapabilities).codecs.filter(function(Yn){return Yn.name.toLowerCase()==="rtx"}).length&&mn.sendEncodingParameters[0].rtx&&delete mn.sendEncodingParameters[0].rtx,Pt._transceive(mn,bn==="sendrecv"||bn==="recvonly",bn==="sendrecv"||bn==="sendonly"),!kn||bn!=="sendrecv"&&bn!=="sendonly"?delete mn.rtpReceiver:(An=kn.track,In?(At[In.stream]||(At[In.stream]=new gt.MediaStream),ht(An,At[In.stream]),Nt.push([An,kn,At[In.stream]])):(At.default||(At.default=new gt.MediaStream),ht(An,At.default),Nt.push([An,kn,At.default]))));else{(mn=Pt.transceivers[rn]||Pt._createTransceiver(tn)).mid=un,mn.iceGatherer||(mn.iceGatherer=Pt._createIceGatherer(rn,Wt)),lr.length&&mn.iceTransport.state==="new"&&(!zn||Wt&&rn!==0?lr.forEach(function(Yn){lt(mn.iceTransport,Yn)}):mn.iceTransport.setRemoteCandidates(lr)),Dn=gt.RTCRtpReceiver.getCapabilities(tn),ct<15019&&(Dn.codecs=Dn.codecs.filter(function(Yn){return Yn.name!=="rtx"})),xn=mn.sendEncodingParameters||[{ssrc:1001*(2*rn+2)}];var cn=!1;if(bn==="sendrecv"||bn==="sendonly"){if(cn=!mn.rtpReceiver,kn=mn.rtpReceiver||new gt.RTCRtpReceiver(mn.dtlsTransport,tn),cn){var Gn;An=kn.track,In&&In.stream==="-"||(In?(At[In.stream]||(At[In.stream]=new gt.MediaStream,Object.defineProperty(At[In.stream],"id",{get:function(){return In.stream}})),Object.defineProperty(An,"id",{get:function(){return In.track}}),Gn=At[In.stream]):(At.default||(At.default=new gt.MediaStream),Gn=At.default)),Gn&&(ht(An,Gn),mn.associatedRemoteMediaStreams.push(Gn)),Nt.push([An,kn,Gn])}}else mn.rtpReceiver&&mn.rtpReceiver.track&&(mn.associatedRemoteMediaStreams.forEach(function(Yn){var or=Yn.getTracks().find(function(Bn){return Bn.id===mn.rtpReceiver.track.id});or&&it(or,Yn)}),mn.associatedRemoteMediaStreams=[]);mn.localCapabilities=Dn,mn.remoteCapabilities=Qn,mn.rtpReceiver=kn,mn.rtcpParameters=er,mn.sendEncodingParameters=xn,mn.recvEncodingParameters=Mn,Pt._transceive(Pt.transceivers[rn],!1,cn)}}}),Pt._dtlsRole===void 0&&(Pt._dtlsRole=It.type==="offer"?"active":"passive"),Pt._remoteDescription={type:It.type,sdp:It.sdp},It.type==="offer"?Pt._updateSignalingState("have-remote-offer"):Pt._updateSignalingState("stable"),Object.keys(At).forEach(function(Bt){var rn=At[Bt];if(rn.getTracks().length){if(Pt.remoteStreams.indexOf(rn)===-1){Pt.remoteStreams.push(rn);var gn=new Event("addstream");gn.stream=rn,gt.setTimeout(function(){Pt._dispatchEvent("addstream",gn)})}Nt.forEach(function(tn){var Ht=tn[0],fn=tn[1];rn.id===tn[2].id&&ft(Pt,Ht,fn,[rn])})}}),Nt.forEach(function(Bt){Bt[2]||ft(Pt,Bt[0],Bt[1],[])}),gt.setTimeout(function(){Pt&&Pt.transceivers&&Pt.transceivers.forEach(function(Bt){Bt.iceTransport&&Bt.iceTransport.state==="new"&&Bt.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),Bt.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},mt.prototype.close=function(){this.transceivers.forEach(function(It){It.iceTransport&&It.iceTransport.stop(),It.dtlsTransport&&It.dtlsTransport.stop(),It.rtpSender&&It.rtpSender.stop(),It.rtpReceiver&&It.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},mt.prototype._updateSignalingState=function(It){this.signalingState=It;var Pt=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",Pt)},mt.prototype._maybeFireNegotiationNeeded=function(){var It=this;this.signalingState==="stable"&&this.needNegotiation!==!0&&(this.needNegotiation=!0,gt.setTimeout(function(){if(It.needNegotiation){It.needNegotiation=!1;var Pt=new Event("negotiationneeded");It._dispatchEvent("negotiationneeded",Pt)}},0))},mt.prototype._updateIceConnectionState=function(){var It,Pt={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(Nt){Nt.iceTransport&&!Nt.rejected&&Pt[Nt.iceTransport.state]++}),It="new",Pt.failed>0?It="failed":Pt.checking>0?It="checking":Pt.disconnected>0?It="disconnected":Pt.new>0?It="new":Pt.connected>0?It="connected":Pt.completed>0&&(It="completed"),It!==this.iceConnectionState){this.iceConnectionState=It;var At=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",At)}},mt.prototype._updateConnectionState=function(){var It,Pt={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(Nt){Nt.iceTransport&&Nt.dtlsTransport&&!Nt.rejected&&(Pt[Nt.iceTransport.state]++,Pt[Nt.dtlsTransport.state]++)}),Pt.connected+=Pt.completed,It="new",Pt.failed>0?It="failed":Pt.connecting>0?It="connecting":Pt.disconnected>0?It="disconnected":Pt.new>0?It="new":Pt.connected>0&&(It="connected"),It!==this.connectionState){this.connectionState=It;var At=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",At)}},mt.prototype.createOffer=function(){var It=this;if(It._isClosed)return Promise.reject(St("InvalidStateError","Can not call createOffer after close"));var Pt=It.transceivers.filter(function(bt){return bt.kind==="audio"}).length,At=It.transceivers.filter(function(bt){return bt.kind==="video"}).length,Nt=arguments[0];if(Nt){if(Nt.mandatory||Nt.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");Nt.offerToReceiveAudio!==void 0&&(Pt=Nt.offerToReceiveAudio===!0?1:Nt.offerToReceiveAudio===!1?0:Nt.offerToReceiveAudio),Nt.offerToReceiveVideo!==void 0&&(At=Nt.offerToReceiveVideo===!0?1:Nt.offerToReceiveVideo===!1?0:Nt.offerToReceiveVideo)}for(It.transceivers.forEach(function(bt){bt.kind==="audio"?--Pt<0&&(bt.wantReceive=!1):bt.kind==="video"&&--At<0&&(bt.wantReceive=!1)});Pt>0||At>0;)Pt>0&&(It._createTransceiver("audio"),Pt--),At>0&&(It._createTransceiver("video"),At--);var Ot=pt.writeSessionBoilerplate(It._sdpSessionId,It._sdpSessionVersion++);It.transceivers.forEach(function(bt,Wt){var zt=bt.track,Bt=bt.kind,rn=bt.mid||pt.generateIdentifier();bt.mid=rn,bt.iceGatherer||(bt.iceGatherer=It._createIceGatherer(Wt,It.usingBundle));var gn=gt.RTCRtpSender.getCapabilities(Bt);ct<15019&&(gn.codecs=gn.codecs.filter(function(Ht){return Ht.name!=="rtx"})),gn.codecs.forEach(function(Ht){Ht.name==="H264"&&Ht.parameters["level-asymmetry-allowed"]===void 0&&(Ht.parameters["level-asymmetry-allowed"]="1"),bt.remoteCapabilities&&bt.remoteCapabilities.codecs&&bt.remoteCapabilities.codecs.forEach(function(fn){Ht.name.toLowerCase()===fn.name.toLowerCase()&&Ht.clockRate===fn.clockRate&&(Ht.preferredPayloadType=fn.payloadType)})}),gn.headerExtensions.forEach(function(Ht){(bt.remoteCapabilities&&bt.remoteCapabilities.headerExtensions||[]).forEach(function(fn){Ht.uri===fn.uri&&(Ht.id=fn.id)})});var tn=bt.sendEncodingParameters||[{ssrc:1001*(2*Wt+1)}];zt&&ct>=15019&&Bt==="video"&&!tn[0].rtx&&(tn[0].rtx={ssrc:tn[0].ssrc+1}),bt.wantReceive&&(bt.rtpReceiver=new gt.RTCRtpReceiver(bt.dtlsTransport,Bt)),bt.localCapabilities=gn,bt.sendEncodingParameters=tn}),It._config.bundlePolicy!=="max-compat"&&(Ot+="a=group:BUNDLE "+It.transceivers.map(function(bt){return bt.mid}).join(" ")+`\r
`),Ot+=`a=ice-options:trickle\r
`,It.transceivers.forEach(function(bt,Wt){Ot+=ut(bt,bt.localCapabilities,"offer",bt.stream,It._dtlsRole),Ot+=`a=rtcp-rsize\r
`,!bt.iceGatherer||It.iceGatheringState==="new"||Wt!==0&&It.usingBundle||(bt.iceGatherer.getLocalCandidates().forEach(function(zt){zt.component=1,Ot+="a="+pt.writeCandidate(zt)+`\r
`}),bt.iceGatherer.state==="completed"&&(Ot+=`a=end-of-candidates\r
`))});var Mt=new gt.RTCSessionDescription({type:"offer",sdp:Ot});return Promise.resolve(Mt)},mt.prototype.createAnswer=function(){var It=this;if(It._isClosed)return Promise.reject(St("InvalidStateError","Can not call createAnswer after close"));if(It.signalingState!=="have-remote-offer"&&It.signalingState!=="have-local-pranswer")return Promise.reject(St("InvalidStateError","Can not call createAnswer in signalingState "+It.signalingState));var Pt=pt.writeSessionBoilerplate(It._sdpSessionId,It._sdpSessionVersion++);It.usingBundle&&(Pt+="a=group:BUNDLE "+It.transceivers.map(function(Ot){return Ot.mid}).join(" ")+`\r
`),Pt+=`a=ice-options:trickle\r
`;var At=pt.getMediaSections(It._remoteDescription.sdp).length;It.transceivers.forEach(function(Ot,Mt){if(!(Mt+1>At)){if(Ot.rejected)return Ot.kind==="application"?Ot.protocol==="DTLS/SCTP"?Pt+=`m=application 0 DTLS/SCTP 5000\r
`:Pt+="m=application 0 "+Ot.protocol+` webrtc-datachannel\r
`:Ot.kind==="audio"?Pt+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:Ot.kind==="video"&&(Pt+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),void(Pt+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+Ot.mid+`\r
`);if(Ot.stream){var bt;Ot.kind==="audio"?bt=Ot.stream.getAudioTracks()[0]:Ot.kind==="video"&&(bt=Ot.stream.getVideoTracks()[0]),bt&&ct>=15019&&Ot.kind==="video"&&!Ot.sendEncodingParameters[0].rtx&&(Ot.sendEncodingParameters[0].rtx={ssrc:Ot.sendEncodingParameters[0].ssrc+1})}var Wt=et(Ot.localCapabilities,Ot.remoteCapabilities);!Wt.codecs.filter(function(zt){return zt.name.toLowerCase()==="rtx"}).length&&Ot.sendEncodingParameters[0].rtx&&delete Ot.sendEncodingParameters[0].rtx,Pt+=ut(Ot,Wt,"answer",Ot.stream,It._dtlsRole),Ot.rtcpParameters&&Ot.rtcpParameters.reducedSize&&(Pt+=`a=rtcp-rsize\r
`)}});var Nt=new gt.RTCSessionDescription({type:"answer",sdp:Pt});return Promise.resolve(Nt)},mt.prototype.addIceCandidate=function(It){var Pt,At=this;return It&&It.sdpMLineIndex===void 0&&!It.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(Nt,Ot){if(!At._remoteDescription)return Ot(St("InvalidStateError","Can not add ICE candidate without a remote description"));if(It&&It.candidate!==""){var Mt=It.sdpMLineIndex;if(It.sdpMid){for(var bt=0;bt<At.transceivers.length;bt++)if(At.transceivers[bt].mid===It.sdpMid){Mt=bt;break}}var Wt=At.transceivers[Mt];if(!Wt)return Ot(St("OperationError","Can not add ICE candidate"));if(Wt.rejected)return Nt();var zt=Object.keys(It.candidate).length>0?pt.parseCandidate(It.candidate):{};if(zt.protocol==="tcp"&&(zt.port===0||zt.port===9)||zt.component&&zt.component!==1)return Nt();if((Mt===0||Mt>0&&Wt.iceTransport!==At.transceivers[0].iceTransport)&&!lt(Wt.iceTransport,zt))return Ot(St("OperationError","Can not add ICE candidate"));var Bt=It.candidate.trim();Bt.indexOf("a=")===0&&(Bt=Bt.substr(2)),(Pt=pt.getMediaSections(At._remoteDescription.sdp))[Mt]+="a="+(zt.type?Bt:"end-of-candidates")+`\r
`,At._remoteDescription.sdp=pt.getDescription(At._remoteDescription.sdp)+Pt.join("")}else for(var rn=0;rn<At.transceivers.length&&(At.transceivers[rn].rejected||(At.transceivers[rn].iceTransport.addRemoteCandidate({}),Pt=pt.getMediaSections(At._remoteDescription.sdp),Pt[rn]+=`a=end-of-candidates\r
`,At._remoteDescription.sdp=pt.getDescription(At._remoteDescription.sdp)+Pt.join(""),!At.usingBundle));rn++);Nt()})},mt.prototype.getStats=function(It){if(It&&It instanceof gt.MediaStreamTrack){var Pt=null;if(this.transceivers.forEach(function(Nt){Nt.rtpSender&&Nt.rtpSender.track===It?Pt=Nt.rtpSender:Nt.rtpReceiver&&Nt.rtpReceiver.track===It&&(Pt=Nt.rtpReceiver)}),!Pt)throw St("InvalidAccessError","Invalid selector.");return Pt.getStats()}var At=[];return this.transceivers.forEach(function(Nt){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(Ot){Nt[Ot]&&At.push(Nt[Ot].getStats())})}),Promise.all(At).then(function(Nt){var Ot=new Map;return Nt.forEach(function(Mt){Mt.forEach(function(bt){Ot.set(bt.id,bt)})}),Ot})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(It){var Pt=gt[It];if(Pt&&Pt.prototype&&Pt.prototype.getStats){var At=Pt.prototype.getStats;Pt.prototype.getStats=function(){return At.apply(this).then(function(Nt){var Ot=new Map;return Object.keys(Nt).forEach(function(Mt){Nt[Mt].type=at(Nt[Mt]),Ot.set(Mt,Nt[Mt])}),Ot})}}});var Tt=["createOffer","createAnswer"];return Tt.forEach(function(It){var Pt=mt.prototype[It];mt.prototype[It]=function(){var At=arguments;return typeof At[0]=="function"||typeof At[1]=="function"?Pt.apply(this,[arguments[2]]).then(function(Nt){typeof At[0]=="function"&&At[0].apply(null,[Nt])},function(Nt){typeof At[1]=="function"&&At[1].apply(null,[Nt])}):Pt.apply(this,arguments)}}),(Tt=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(It){var Pt=mt.prototype[It];mt.prototype[It]=function(){var At=arguments;return typeof At[1]=="function"||typeof At[2]=="function"?Pt.apply(this,arguments).then(function(){typeof At[1]=="function"&&At[1].apply(null)},function(Nt){typeof At[2]=="function"&&At[2].apply(null,[Nt])}):Pt.apply(this,arguments)}}),["getStats"].forEach(function(It){var Pt=mt.prototype[It];mt.prototype[It]=function(){var At=arguments;return typeof At[1]=="function"?Pt.apply(this,arguments).then(function(){typeof At[1]=="function"&&At[1].apply(null)}):Pt.apply(this,arguments)}}),mt}},{sdp:17}],17:[function(tt,rt,st){var at={};at.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},at.localCName=at.generateIdentifier(),at.splitLines=function(ut){return ut.trim().split(`
`).map(function(s){return s.trim()})},at.splitSections=function(ut){return ut.split(`
m=`).map(function(s,et){return(et>0?"m="+s:s).trim()+`\r
`})},at.getDescription=function(ut){var s=at.splitSections(ut);return s&&s[0]},at.getMediaSections=function(ut){var s=at.splitSections(ut);return s.shift(),s},at.matchPrefix=function(ut,s){return at.splitLines(ut).filter(function(et){return et.indexOf(s)===0})},at.parseCandidate=function(ut){for(var s,et={foundation:(s=ut.indexOf("a=candidate:")===0?ut.substring(12).split(" "):ut.substring(10).split(" "))[0],component:parseInt(s[1],10),protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]},ot=8;ot<s.length;ot+=2)switch(s[ot]){case"raddr":et.relatedAddress=s[ot+1];break;case"rport":et.relatedPort=parseInt(s[ot+1],10);break;case"tcptype":et.tcpType=s[ot+1];break;case"ufrag":et.ufrag=s[ot+1],et.usernameFragment=s[ot+1];break;default:et[s[ot]]=s[ot+1]}return et},at.writeCandidate=function(ut){var s=[];s.push(ut.foundation),s.push(ut.component),s.push(ut.protocol.toUpperCase()),s.push(ut.priority),s.push(ut.address||ut.ip),s.push(ut.port);var et=ut.type;return s.push("typ"),s.push(et),et!=="host"&&ut.relatedAddress&&ut.relatedPort&&(s.push("raddr"),s.push(ut.relatedAddress),s.push("rport"),s.push(ut.relatedPort)),ut.tcpType&&ut.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(ut.tcpType)),(ut.usernameFragment||ut.ufrag)&&(s.push("ufrag"),s.push(ut.usernameFragment||ut.ufrag)),"candidate:"+s.join(" ")},at.parseIceOptions=function(ut){return ut.substr(14).split(" ")},at.parseRtpMap=function(ut){var s=ut.substr(9).split(" "),et={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),et.name=s[0],et.clockRate=parseInt(s[1],10),et.channels=s.length===3?parseInt(s[2],10):1,et.numChannels=et.channels,et},at.writeRtpMap=function(ut){var s=ut.payloadType;ut.preferredPayloadType!==void 0&&(s=ut.preferredPayloadType);var et=ut.channels||ut.numChannels||1;return"a=rtpmap:"+s+" "+ut.name+"/"+ut.clockRate+(et!==1?"/"+et:"")+`\r
`},at.parseExtmap=function(ut){var s=ut.substr(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1]}},at.writeExtmap=function(ut){return"a=extmap:"+(ut.id||ut.preferredId)+(ut.direction&&ut.direction!=="sendrecv"?"/"+ut.direction:"")+" "+ut.uri+`\r
`},at.parseFmtp=function(ut){for(var s,et={},ot=ut.substr(ut.indexOf(" ")+1).split(";"),lt=0;lt<ot.length;lt++)et[(s=ot[lt].trim().split("="))[0].trim()]=s[1];return et},at.writeFmtp=function(ut){var s="",et=ut.payloadType;if(ut.preferredPayloadType!==void 0&&(et=ut.preferredPayloadType),ut.parameters&&Object.keys(ut.parameters).length){var ot=[];Object.keys(ut.parameters).forEach(function(lt){ut.parameters[lt]?ot.push(lt+"="+ut.parameters[lt]):ot.push(lt)}),s+="a=fmtp:"+et+" "+ot.join(";")+`\r
`}return s},at.parseRtcpFb=function(ut){var s=ut.substr(ut.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},at.writeRtcpFb=function(ut){var s="",et=ut.payloadType;return ut.preferredPayloadType!==void 0&&(et=ut.preferredPayloadType),ut.rtcpFeedback&&ut.rtcpFeedback.length&&ut.rtcpFeedback.forEach(function(ot){s+="a=rtcp-fb:"+et+" "+ot.type+(ot.parameter&&ot.parameter.length?" "+ot.parameter:"")+`\r
`}),s},at.parseSsrcMedia=function(ut){var s=ut.indexOf(" "),et={ssrc:parseInt(ut.substr(7,s-7),10)},ot=ut.indexOf(":",s);return ot>-1?(et.attribute=ut.substr(s+1,ot-s-1),et.value=ut.substr(ot+1)):et.attribute=ut.substr(s+1),et},at.parseSsrcGroup=function(ut){var s=ut.substr(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(function(et){return parseInt(et,10)})}},at.getMid=function(ut){var s=at.matchPrefix(ut,"a=mid:")[0];if(s)return s.substr(6)},at.parseFingerprint=function(ut){var s=ut.substr(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1]}},at.getDtlsParameters=function(ut,s){return{role:"auto",fingerprints:at.matchPrefix(ut+s,"a=fingerprint:").map(at.parseFingerprint)}},at.writeDtlsParameters=function(ut,s){var et="a=setup:"+s+`\r
`;return ut.fingerprints.forEach(function(ot){et+="a=fingerprint:"+ot.algorithm+" "+ot.value+`\r
`}),et},at.getIceParameters=function(ut,s){var et=at.splitLines(ut);return{usernameFragment:(et=et.concat(at.splitLines(s))).filter(function(ot){return ot.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:et.filter(function(ot){return ot.indexOf("a=ice-pwd:")===0})[0].substr(10)}},at.writeIceParameters=function(ut){return"a=ice-ufrag:"+ut.usernameFragment+`\r
a=ice-pwd:`+ut.password+`\r
`},at.parseRtpParameters=function(ut){for(var s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},et=at.splitLines(ut)[0].split(" "),ot=3;ot<et.length;ot++){var lt=et[ot],St=at.matchPrefix(ut,"a=rtpmap:"+lt+" ")[0];if(St){var pt=at.parseRtpMap(St),gt=at.matchPrefix(ut,"a=fmtp:"+lt+" ");switch(pt.parameters=gt.length?at.parseFmtp(gt[0]):{},pt.rtcpFeedback=at.matchPrefix(ut,"a=rtcp-fb:"+lt+" ").map(at.parseRtcpFb),s.codecs.push(pt),pt.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(pt.name.toUpperCase())}}}return at.matchPrefix(ut,"a=extmap:").forEach(function(ct){s.headerExtensions.push(at.parseExtmap(ct))}),s},at.writeRtpDescription=function(ut,s){var et="";et+="m="+ut+" ",et+=s.codecs.length>0?"9":"0",et+=" UDP/TLS/RTP/SAVPF ",et+=s.codecs.map(function(lt){return lt.preferredPayloadType!==void 0?lt.preferredPayloadType:lt.payloadType}).join(" ")+`\r
`,et+=`c=IN IP4 0.0.0.0\r
`,et+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(function(lt){et+=at.writeRtpMap(lt),et+=at.writeFmtp(lt),et+=at.writeRtcpFb(lt)});var ot=0;return s.codecs.forEach(function(lt){lt.maxptime>ot&&(ot=lt.maxptime)}),ot>0&&(et+="a=maxptime:"+ot+`\r
`),et+=`a=rtcp-mux\r
`,s.headerExtensions&&s.headerExtensions.forEach(function(lt){et+=at.writeExtmap(lt)}),et},at.parseRtpEncodingParameters=function(ut){var s,et=[],ot=at.parseRtpParameters(ut),lt=ot.fecMechanisms.indexOf("RED")!==-1,St=ot.fecMechanisms.indexOf("ULPFEC")!==-1,pt=at.matchPrefix(ut,"a=ssrc:").map(function(it){return at.parseSsrcMedia(it)}).filter(function(it){return it.attribute==="cname"}),gt=pt.length>0&&pt[0].ssrc,ct=at.matchPrefix(ut,"a=ssrc-group:FID").map(function(it){return it.substr(17).split(" ").map(function(ft){return parseInt(ft,10)})});ct.length>0&&ct[0].length>1&&ct[0][0]===gt&&(s=ct[0][1]),ot.codecs.forEach(function(it){if(it.name.toUpperCase()==="RTX"&&it.parameters.apt){var ft={ssrc:gt,codecPayloadType:parseInt(it.parameters.apt,10)};gt&&s&&(ft.rtx={ssrc:s}),et.push(ft),lt&&((ft=JSON.parse(JSON.stringify(ft))).fec={ssrc:gt,mechanism:St?"red+ulpfec":"red"},et.push(ft))}}),et.length===0&&gt&&et.push({ssrc:gt});var ht=at.matchPrefix(ut,"b=");return ht.length&&(ht=ht[0].indexOf("b=TIAS:")===0?parseInt(ht[0].substr(7),10):ht[0].indexOf("b=AS:")===0?1e3*parseInt(ht[0].substr(5),10)*.95-16e3:void 0,et.forEach(function(it){it.maxBitrate=ht})),et},at.parseRtcpParameters=function(ut){var s={},et=at.matchPrefix(ut,"a=ssrc:").map(function(St){return at.parseSsrcMedia(St)}).filter(function(St){return St.attribute==="cname"})[0];et&&(s.cname=et.value,s.ssrc=et.ssrc);var ot=at.matchPrefix(ut,"a=rtcp-rsize");s.reducedSize=ot.length>0,s.compound=ot.length===0;var lt=at.matchPrefix(ut,"a=rtcp-mux");return s.mux=lt.length>0,s},at.parseMsid=function(ut){var s,et=at.matchPrefix(ut,"a=msid:");if(et.length===1)return s=et[0].substr(7).split(" "),{stream:s[0],track:s[1]};var ot=at.matchPrefix(ut,"a=ssrc:").map(function(lt){return at.parseSsrcMedia(lt)}).filter(function(lt){return lt.attribute==="msid"});return ot.length>0?(s=ot[0].value.split(" "),{stream:s[0],track:s[1]}):void 0},at.generateSessionId=function(){return Math.random().toString().substr(2,21)},at.writeSessionBoilerplate=function(ut,s,et){var ot,lt=s!==void 0?s:2;return ot=ut||at.generateSessionId(),`v=0\r
o=`+(et||"thisisadapterortc")+" "+ot+" "+lt+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},at.writeMediaSection=function(ut,s,et,ot){var lt=at.writeRtpDescription(ut.kind,s);if(lt+=at.writeIceParameters(ut.iceGatherer.getLocalParameters()),lt+=at.writeDtlsParameters(ut.dtlsTransport.getLocalParameters(),et==="offer"?"actpass":"active"),lt+="a=mid:"+ut.mid+`\r
`,ut.direction?lt+="a="+ut.direction+`\r
`:ut.rtpSender&&ut.rtpReceiver?lt+=`a=sendrecv\r
`:ut.rtpSender?lt+=`a=sendonly\r
`:ut.rtpReceiver?lt+=`a=recvonly\r
`:lt+=`a=inactive\r
`,ut.rtpSender){var St="msid:"+ot.id+" "+ut.rtpSender.track.id+`\r
`;lt+="a="+St,lt+="a=ssrc:"+ut.sendEncodingParameters[0].ssrc+" "+St,ut.sendEncodingParameters[0].rtx&&(lt+="a=ssrc:"+ut.sendEncodingParameters[0].rtx.ssrc+" "+St,lt+="a=ssrc-group:FID "+ut.sendEncodingParameters[0].ssrc+" "+ut.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return lt+="a=ssrc:"+ut.sendEncodingParameters[0].ssrc+" cname:"+at.localCName+`\r
`,ut.rtpSender&&ut.sendEncodingParameters[0].rtx&&(lt+="a=ssrc:"+ut.sendEncodingParameters[0].rtx.ssrc+" cname:"+at.localCName+`\r
`),lt},at.getDirection=function(ut,s){for(var et=at.splitLines(ut),ot=0;ot<et.length;ot++)switch(et[ot]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return et[ot].substr(2)}return s?at.getDirection(s):"sendrecv"},at.getKind=function(ut){return at.splitLines(ut)[0].split(" ")[0].substr(2)},at.isRejected=function(ut){return ut.split(" ",2)[1]==="0"},at.parseMLine=function(ut){var s=at.splitLines(ut)[0].substr(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},at.parseOLine=function(ut){var s=at.matchPrefix(ut,"o=")[0].substr(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},at.isValidSDP=function(ut){if(typeof ut!="string"||ut.length===0)return!1;for(var s=at.splitLines(ut),et=0;et<s.length;et++)if(s[et].length<2||s[et].charAt(1)!=="=")return!1;return!0},typeof rt=="object"&&(rt.exports=at)},{}]},{},[1])(1)}),function(tt){function rt(Mt){if(typeof Mt!="string"&&(Mt=String(Mt)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(Mt))throw new TypeError("Invalid character in header field name");return Mt.toLowerCase()}function st(Mt){return typeof Mt!="string"&&(Mt=String(Mt)),Mt}function at(Mt){var bt={next:function(){var Wt=Mt.shift();return{done:Wt===void 0,value:Wt}}};return Tt.iterable&&(bt[Symbol.iterator]=function(){return bt}),bt}function ut(Mt){this.map={},Mt instanceof ut?Mt.forEach(function(bt,Wt){this.append(Wt,bt)},this):Array.isArray(Mt)?Mt.forEach(function(bt){this.append(bt[0],bt[1])},this):Mt&&Object.getOwnPropertyNames(Mt).forEach(function(bt){this.append(bt,Mt[bt])},this)}function s(Mt){if(Mt.bodyUsed)return Promise.reject(new TypeError("Already read"));Mt.bodyUsed=!0}function et(Mt){return new Promise(function(bt,Wt){Mt.onload=function(){bt(Mt.result)},Mt.onerror=function(){Wt(Mt.error)}})}function ot(Mt){var bt=new FileReader,Wt=et(bt);return bt.readAsArrayBuffer(Mt),Wt}function lt(Mt){var bt=new FileReader,Wt=et(bt);return bt.readAsText(Mt),Wt}function St(Mt){for(var bt=new Uint8Array(Mt),Wt=new Array(bt.length),zt=0;zt<bt.length;zt++)Wt[zt]=String.fromCharCode(bt[zt]);return Wt.join("")}function pt(Mt){if(Mt.slice)return Mt.slice(0);var bt=new Uint8Array(Mt.byteLength);return bt.set(new Uint8Array(Mt)),bt.buffer}function gt(){return this.bodyUsed=!1,this._initBody=function(Mt){if(this._bodyInit=Mt,Mt)if(typeof Mt=="string")this._bodyText=Mt;else if(Tt.blob&&Blob.prototype.isPrototypeOf(Mt))this._bodyBlob=Mt;else if(Tt.formData&&FormData.prototype.isPrototypeOf(Mt))this._bodyFormData=Mt;else if(Tt.searchParams&&URLSearchParams.prototype.isPrototypeOf(Mt))this._bodyText=Mt.toString();else if(Tt.arrayBuffer&&Tt.blob&&Pt(Mt))this._bodyArrayBuffer=pt(Mt.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!Tt.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(Mt)&&!At(Mt))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=pt(Mt)}else this._bodyText="";this.headers.get("content-type")||(typeof Mt=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Tt.searchParams&&URLSearchParams.prototype.isPrototypeOf(Mt)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Tt.blob&&(this.blob=function(){var Mt=s(this);if(Mt)return Mt;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?s(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ot)}),this.text=function(){var Mt=s(this);if(Mt)return Mt;if(this._bodyBlob)return lt(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(St(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Tt.formData&&(this.formData=function(){return this.text().then(it)}),this.json=function(){return this.text().then(JSON.parse)},this}function ct(Mt){var bt=Mt.toUpperCase();return Nt.indexOf(bt)>-1?bt:Mt}function ht(Mt,bt){var Wt=(bt=bt||{}).body;if(Mt instanceof ht){if(Mt.bodyUsed)throw new TypeError("Already read");this.url=Mt.url,this.credentials=Mt.credentials,bt.headers||(this.headers=new ut(Mt.headers)),this.method=Mt.method,this.mode=Mt.mode,Wt||Mt._bodyInit==null||(Wt=Mt._bodyInit,Mt.bodyUsed=!0)}else this.url=String(Mt);if(this.credentials=bt.credentials||this.credentials||"omit",!bt.headers&&this.headers||(this.headers=new ut(bt.headers)),this.method=ct(bt.method||this.method||"GET"),this.mode=bt.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Wt)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Wt)}function it(Mt){var bt=new FormData;return Mt.trim().split("&").forEach(function(Wt){if(Wt){var zt=Wt.split("="),Bt=zt.shift().replace(/\+/g," "),rn=zt.join("=").replace(/\+/g," ");bt.append(decodeURIComponent(Bt),decodeURIComponent(rn))}}),bt}function ft(Mt){var bt=new ut;return Mt.split(/\r?\n/).forEach(function(Wt){var zt=Wt.split(":"),Bt=zt.shift().trim();if(Bt){var rn=zt.join(":").trim();bt.append(Bt,rn)}}),bt}function mt(Mt,bt){bt||(bt={}),this.type="default",this.status="status"in bt?bt.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in bt?bt.statusText:"OK",this.headers=new ut(bt.headers),this.url=bt.url||"",this._initBody(Mt)}if(!tt.fetch){var Tt={searchParams:"URLSearchParams"in tt,iterable:"Symbol"in tt&&"iterator"in Symbol,blob:"FileReader"in tt&&"Blob"in tt&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in tt,arrayBuffer:"ArrayBuffer"in tt};if(Tt.arrayBuffer)var It=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Pt=function(Mt){return Mt&&DataView.prototype.isPrototypeOf(Mt)},At=ArrayBuffer.isView||function(Mt){return Mt&&It.indexOf(Object.prototype.toString.call(Mt))>-1};ut.prototype.append=function(Mt,bt){Mt=rt(Mt),bt=st(bt);var Wt=this.map[Mt];this.map[Mt]=Wt?Wt+","+bt:bt},ut.prototype.delete=function(Mt){delete this.map[rt(Mt)]},ut.prototype.get=function(Mt){return Mt=rt(Mt),this.has(Mt)?this.map[Mt]:null},ut.prototype.has=function(Mt){return this.map.hasOwnProperty(rt(Mt))},ut.prototype.set=function(Mt,bt){this.map[rt(Mt)]=st(bt)},ut.prototype.forEach=function(Mt,bt){for(var Wt in this.map)this.map.hasOwnProperty(Wt)&&Mt.call(bt,this.map[Wt],Wt,this)},ut.prototype.keys=function(){var Mt=[];return this.forEach(function(bt,Wt){Mt.push(Wt)}),at(Mt)},ut.prototype.values=function(){var Mt=[];return this.forEach(function(bt){Mt.push(bt)}),at(Mt)},ut.prototype.entries=function(){var Mt=[];return this.forEach(function(bt,Wt){Mt.push([Wt,bt])}),at(Mt)},Tt.iterable&&(ut.prototype[Symbol.iterator]=ut.prototype.entries);var Nt=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];ht.prototype.clone=function(){return new ht(this,{body:this._bodyInit})},gt.call(ht.prototype),gt.call(mt.prototype),mt.prototype.clone=function(){return new mt(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new ut(this.headers),url:this.url})},mt.error=function(){var Mt=new mt(null,{status:0,statusText:""});return Mt.type="error",Mt};var Ot=[301,302,303,307,308];mt.redirect=function(Mt,bt){if(Ot.indexOf(bt)===-1)throw new RangeError("Invalid status code");return new mt(null,{status:bt,headers:{location:Mt}})},tt.Headers=ut,tt.Request=ht,tt.Response=mt,tt.fetch=function(Mt,bt){return new Promise(function(Wt,zt){var Bt=new ht(Mt,bt),rn=new XMLHttpRequest;rn.onload=function(){var gn={status:rn.status,statusText:rn.statusText,headers:ft(rn.getAllResponseHeaders()||"")};gn.url="responseURL"in rn?rn.responseURL:gn.headers.get("X-Request-URL");var tn="response"in rn?rn.response:rn.responseText;Wt(new mt(tn,gn))},rn.onerror=function(){zt(new TypeError("Network request failed"))},rn.ontimeout=function(){zt(new TypeError("Network request failed"))},rn.open(Bt.method,Bt.url,!0),Bt.credentials==="include"&&(rn.withCredentials=!0),"responseType"in rn&&Tt.blob&&(rn.responseType="blob"),Bt.headers.forEach(function(gn,tn){rn.setRequestHeader(tn,gn)}),rn.send(Bt._bodyInit===void 0?null:Bt._bodyInit)})},tt.fetch.polyfill=!0}}(typeof self<"u"?self:commonjsGlobal);var _e={};_e=function(){function tt(gt,ct){var ht,it,ft,mt=[],Tt=(gt=gt.push?gt:[gt]).length,It=Tt;for(ht=function(Pt,At){At.length&&mt.push(Pt),--It||ct(mt)};Tt--;)it=gt[Tt],(ft=lt[it])?ht(it,ft):(St[it]=St[it]||[]).push(ht)}function rt(gt,ct){if(gt){var ht=St[gt];if(lt[gt]=ct,ht)for(;ht.length;)ht[0](gt,ct),ht.splice(0,1)}}function st(gt,ct){gt.call&&(gt={success:gt}),ct.length?(gt.error||et)(ct):(gt.success||et)(gt)}function at(gt,ct,ht,it){var ft,mt,Tt=document,It=ht.async,Pt=(ht.numRetries||0)+1,At=ht.before||et,Nt=gt.replace(/^(css|img)!/,""),Ot=ht.reqdelay||0;it=it||0,/(^css!|\.css$)/.test(gt)?(ft=!0,(mt=Tt.createElement("link")).rel="stylesheet",mt.href=Nt):/(^img!|\.(png|gif|jpg|svg)$)/.test(gt)?(mt=Tt.createElement("img")).src=Nt:((mt=Tt.createElement("script")).src=gt,mt.async=It===void 0||It),mt.onload=mt.onerror=mt.onbeforeload=function(Mt){var bt=Mt.type[0];if(ft&&"hideFocus"in mt)try{mt.sheet.cssText.length||(bt="e")}catch{bt="e"}if(bt=="e"&&(it+=1)<Pt)return pt=Ot*it,setTimeout(function(){at(gt,ct,ht,it)},pt),void(ht.retrycb&&ht.retrycb(it,pt));ct(gt,bt,Mt.defaultPrevented)},At(gt,mt)!==!1&&Tt.head.appendChild(mt)}function ut(gt,ct,ht){var it,ft,mt=(gt=gt.push?gt:[gt]).length,Tt=mt,It=[];for(it=function(Pt,At,Nt){if(At=="e"&&It.push(Pt),At=="b"){if(!Nt)return;It.push(Pt)}--mt||ct(It)},ft=0;ft<Tt;ft++)at(gt[ft],it,ht)}function s(gt,ct,ht){var it,ft;ct&&ct.trim&&(it=ct),ut(gt,function(mt){st(ft,mt),rt(it,mt)},ft=(it?ht:ct)||{})}var et=function(){},ot={},lt={},St={},pt=0;return s.ready=function(gt,ct){return tt(gt,function(ht){st(ct,ht)}),s},s.done=function(gt){rt(gt,[])},s.reset=function(){ot={},lt={},St={}},s.isDefined=function(gt){return gt in ot},s}(),function(tt,rt){var st={};st.load=function(at,ut,s){if(typeof _e!==void 0&&typeof apiRTC_React>"u"){var et={async:!0,numRetries:ut.extJsLoadingRetryNb||100,reqdelay:ut.extJsLoadingRetryDelay||200,success:function(){tt.rtcio=io,s.success()},error:function(ot){console.error("socket.io loading error"),s.error()},retrycb:function(ot,lt){console.warn("socket.io loading retry :"+ot+" ,delay before retry :"+lt),s.retrycb()}};ut.socketioUrl!==void 0?_e([ut.socketioUrl],"socketio",et):_e([at+"://"+ut.ccsServer+"/socket.io/v3/socket.io.js"],"socketio",et)}else console.log("Else loadjs io"),tt.rtcio=io,s.success()},tt.apiRTC_sioLoader=st}(window);/*! For license information please see apiRTC-srcTmp.js.LICENSE.txt */(function(tt,rt){a.exports=rt()})(self,()=>(()=>{var tt={8364:function(at,ut,s){var et,ot=this&&this.__extends||(et=function(Pt,At){return(et=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(Nt,Ot){Nt.__proto__=Ot}:function(Nt,Ot){for(var Mt in Ot)Object.prototype.hasOwnProperty.call(Ot,Mt)&&(Nt[Mt]=Ot[Mt])}))(Pt,At)},function(Pt,At){if(typeof At!="function"&&At!==null)throw new TypeError("Class extends value "+String(At)+" is not a constructor or null");function Nt(){this.constructor=Pt}et(Pt,At),Pt.prototype=At===null?Object.create(At):(Nt.prototype=At.prototype,new Nt)}),lt=(Object.defineProperty(ut,"__esModule",{value:!0}),s(2043)),St=s(7987),pt=lt.getLogger("CloudAPI"),gt=(St.reg(lt),St.apply(pt,{format:function(Pt,At,Nt){return"".concat(Nt," - [").concat(Pt,"] ").concat(At," : ")}}),pt.setDefaultLevel("error"),pt.setLevel("error"),"https://cloud.apizee.com"),ct="/api/v2/media/upload",ht="/api/v2/conversation/{convId}/media",it="/api/v2/conferences",ft={updateWebconfTags:{fetchRetryCount:3,fetchRetryDelay:500}},mt=null,Tt=function(){function Pt(){if(this.cloudUrl=gt,this.JWTApzToken="",this.fetchRetries=100,this.fetchRetryDelay=200,mt!==null)return pt.debug("Cannot construct multiple CloudAPI, this is a singleton."),mt;mt=this}return Pt.get=function(){return mt=mt===null?new Pt:mt},Pt.prototype.setLogLevel=function(At){pt.setLevel(At)},Pt.prototype.getLogLevel=function(){var At="";switch(pt.getLevel()){case 0:At="trace";break;case 1:At="debug";break;case 2:At="info";break;case 3:At="warn";break;case 4:At="error";break;case 5:At="silent"}return At},Pt.prototype.setCloudURL=function(At){pt.debug("setCloudURL :",At),this.cloudUrl=At},Pt.prototype.setJWTApzToken=function(At){this.JWTApzToken=At},Pt.prototype.setFetchRetries=function(At){pt.debug("setFetchRetries :",At),At!=null&&(this.fetchRetries=At)},Pt.prototype.setFetchRetryDelay=function(At){pt.log("setFetchRetryDelay :",At),At!=null&&(this.fetchRetryDelay=At)},Pt.prototype.request=function(At,Nt,Ot,Mt,bt,Wt){bt===void 0&&(bt={}),Wt===void 0&&(Wt={});var zt=At.indexOf(this.cloudUrl)===-1?this.cloudUrl+At:At,Bt=null;return new Promise(function(rn,gn){var tn,Ht=new XMLHttpRequest;if(Wt.hasOwnProperty("withCredentials")&&(Ht.withCredentials=Wt.withCredentials),Ht.onreadystatechange=function(yn){if(Ht.readyState===XMLHttpRequest.DONE)if(pt.debug("request onreadystatechange status :",Ht.status),200<=Ht.status&&Ht.status<300)if(Ht.responseText){var pn=null;try{pn=JSON.parse(Ht.responseText)}catch{pn=Ht.responseText}rn(pn)}else rn("No_responseTest");else{if(pn={status:Ht.status,text:Ht.statusText},Ht.responseText)try{pn.response=JSON.parse(Ht.responseText)}catch{pn.responseText=Ht.responseText}gn(pn)}},Ht.onprogress=function(yn){typeof Mt=="function"&&Mt(yn)},Ht.onerror=function(yn){gn(yn)},Ot==="GET")0<Object.keys(Nt).length&&(tn=new URLSearchParams(Nt),pt.debug("johann",tn,tn.toString,Nt),zt+="?"+tn.toString());else{Bt=new FormData;for(var fn=0,bn=Object.keys(Nt);fn<bn.length;fn++){var In=bn[fn];Bt.append(In,Nt[In])}}if(Ht.open(Ot,zt,!0),bt!=null)for(var un=0,mn=Object.keys(bt);un<mn.length;un++)In=mn[un],Ht.setRequestHeader(In,bt[In]);Ht.send(Bt)})},Pt.prototype.get=function(At,Nt,Ot,Mt){return Ot===void 0&&(Ot={}),Mt===void 0&&(Mt={}),pt.log("Send HTTP request : GET ".concat(At)),this.request(At,Nt,"GET",null,Ot,Mt)},Pt.prototype.post=function(At,Nt,Ot,Mt){return pt.log("Send HTTP request : POST ".concat(At)),this.request(At,Nt,"POST",Ot,Mt)},Pt.prototype.put=function(At,Nt,Ot,Mt){return pt.log("Send HTTP request : PUT ".concat(At)),(Nt=Nt!==null&&typeof Nt=="object"?Nt:{})._method="PUT",this.request(At,Nt,"POST",Ot,Mt)},Pt.prototype.delete=function(At,Nt,Ot){return pt.log("Send HTTP request : DELETE ".concat(At)),(Nt=Nt!==null&&typeof Nt=="object"?Nt:{})._method="DELETE",this.request(At,Nt,"POST",null,Ot)},Pt.prototype.cloudRequest=function(At,Nt,Ot,Mt){var bt=this;return Mt===void 0&&(Mt={}),new Promise(function(Wt,zt){pt.trace(Ot+" cloudRequest to "+mt.cloudUrl,Nt);var Bt={method:Ot.toUpperCase()},rn=mt.cloudUrl+At;if(Bt.method==="GET")0<Object.keys(Nt).length&&(rn+="?"+new URLSearchParams(Nt).toString());else{for(var gn=new FormData,tn=0,Ht=Object.keys(Nt);tn<Ht.length;tn++){var fn=Ht[tn];gn.append(fn,Nt[fn])}Bt.body=gn}Mt.hasOwnProperty("bearerToken")?Bt.headers={Authorization:"Bearer "+Mt.bearerToken}:bt.JWTApzToken!==""&&(Bt.headers={Authorization:"Bearer "+bt.JWTApzToken}),Mt.hasOwnProperty("fetchRetryCount")?Bt.retries=Mt.fetchRetryCount:Bt.retries=bt.fetchRetries,Mt.hasOwnProperty("fetchRetryDelay")?Bt.retryDelay=Mt.fetchRetryDelay:Bt.retryDelay=bt.fetchRetryDelay,function(bn,In){pt.log("fetchRetry");var un=3,mn=1e3,yn=[];if(In&&In.retries&&(un=In.retries),In&&In.retryDelay&&(mn=In.retryDelay),In&&In.retryOn){if(!(In.retryOn instanceof Array))throw{name:"ArgumentError",message:"retryOn property expects an array"};yn=In.retryOn}return new Promise(function(pn,Tn){function kn(Mn){var Dn,An;pt.log("wrappedFetch n:",Mn),window.fetch!==void 0?fetch(bn,In).then(function(Nn){yn.indexOf(Nn.status)===-1?pn(Nn):0<Mn?xn(Mn):Tn(Nn)}).catch(function(Nn){0<Mn?xn(Mn):Tn(Nn)}):(pt.debug("Cannot use fetch in this browser, using XHR"),Dn=Tt.get(),An={},In.body&&In.body.forEach(function(Nn,Un){return An[Un]=Nn}),Dn.request(bn,An,In.method,null,In.headers).then(function(Nn){pn({gettype:"cloudApiNoFetch",response:Nn})}).catch(function(Nn){pt.error("error :",Nn),Tn(Nn)}))}function xn(Mn){pt.error("retry n:",Mn);var Dn=un-Mn+1;pt.error("retry number is :",Dn),setTimeout(function(){kn(--Mn)},mn*Dn)}kn(un)})}(rn,Bt).then(function(bn){if(bn.gettype==="cloudApiNoFetch")return Wt(bn.response);bn.json().then(function(In){var un;if(bn.status<200||299<bn.status)return un="cloudRequest - response status Code: "+bn.status,pt.warn(un),un=new It(un,13,bn.status,In),zt(un);Wt(In)}).catch(function(In){return pt.error("json err :",In),zt(new It("cloudRequest - json() Error: "+In.text,0,bn.status,{}))})}).catch(function(bn){return pt.error("Fetch Error :",bn),zt(new It("cloudRequest - Fetch Error: "+bn.text,13,bn.status,bn.response))})})},Pt.prototype.cloudFetchMedia=function(At){var Nt=this;return new Promise(function(Ot,Mt){var bt={};Nt.JWTApzToken!==""&&(bt={Authorization:"Bearer "+Nt.JWTApzToken}),fetch(At,{headers:bt}).then(function(Wt){return Wt.blob()}).then(function(Wt){Ot(Wt)}).catch(function(Wt){Mt(Wt)})})},Pt.prototype.authentication=function(At,Nt,Ot){return pt.debug("authentication to "+mt.cloudUrl),At={username:At,password:Nt},Ot!==void 0&&Ot!==""&&(At.captcha_token=Ot),this.cloudRequest("/api/v3/authenticate",At,"POST")},Pt.prototype.getConnectedUserInformation=function(At){return pt.debug("getConnectedUserInformation to "+mt.cloudUrl),this.cloudRequest("/api/v2/users/me",{},"GET",{bearerToken:At})},Pt.prototype.getUserProfile=function(At,Nt,Ot){return pt.debug("getUserProfile to "+mt.cloudUrl),typeof At!="string"||typeof Nt!="string"?Promise.reject("wrongArguments"):(At={apiKey:At},this.cloudRequest("/api/v3/users/{userId}/profile".replace("{userId}",Nt),At,"GET",{bearerToken:Ot}))},Pt.prototype.getSiteAgents=function(At,Nt,Ot){return Ot===void 0&&(Ot={}),pt.debug("getSiteAgents to "+mt.cloudUrl),typeof At!="string"||typeof Nt!="string"?Promise.reject("wrongArguments"):(At={apiKey:At},Ot.useAcd&&(At.useAcd=1),Ot.usePresence&&(At.usePresence=1),Ot.convId&&(At.convId=Ot.convId),this.cloudRequest("/api/v2/sites/{siteKey}/agents".replace("{siteKey}",Nt),At,"GET"))},Pt.prototype.getEnterpriseInformation=function(At,Nt){return At===void 0&&(At={}),pt.debug("getEnterpriseInformation to "+mt.cloudUrl),this.cloudRequest("/api/v3/enterpriseInformation",At,"GET",{bearerToken:Nt})},Pt.prototype.getPreferredCCS=function(At){return pt.debug("getPreferredCCS to "+mt.cloudUrl),this.cloudRequest("/api/v2/preferredCCS",{apiKey:At},"GET")},Pt.prototype.checkUserToken=function(At){return pt.debug("checkUserToken to "+mt.cloudUrl),this.cloudRequest("/api/v2/checkToken",{},"GET",{bearerToken:At})},Pt.prototype.invalidateUserToken=function(At){return pt.debug("invalidateUserToken to "+mt.cloudUrl),this.cloudRequest("/api/v2/invalidateToken",{},"POST",{bearerToken:At})},Pt.prototype.uploadFile=function(At,Nt,Ot){pt.debug("uploadMedia to "+mt.cloudUrl);var Mt={file:At};if(Ot!=null)for(var bt=0,Wt=Object.keys(Ot);bt<Wt.length;bt++){var zt=Wt[bt];Mt[zt]=Ot[zt]}return this.cloudRequest(ct,Mt,"POST",{bearerToken:Nt})},Pt.prototype.uploadSnapshot=function(At,Nt,Ot){Ot===void 0&&(Ot={}),pt.debug("uploadSnapshot to "+mt.cloudUrl);for(var Mt={dataUri:1,file:At},bt=0,Wt=Object.keys(Ot);bt<Wt.length;bt++){var zt=Wt[bt];Mt[zt]=Ot[zt]}return this.cloudRequest(ct,Mt,"POST",{bearerToken:Nt})},Pt.prototype.getEnterpriseUserList=function(At,Nt){return pt.debug("getEnterpriseUserList to "+mt.cloudUrl),this.cloudRequest("/api/v2/enterprises/{enterpriseId}/users".replace("{enterpriseId}",At),{json:!0},"GET",{bearerToken:Nt})},Pt.prototype.getEnterpriseTagList=function(At,Nt,Ot){return Ot===void 0&&(Ot={}),pt.debug("getEnterpriseTagList to "+mt.cloudUrl),Ot.hasOwnProperty("webconfId")&&Ot.webconfId,this.cloudRequest("/api/v2/enterprises/{enterpriseId}/tags".replace("{enterpriseId}",At),{},"GET",{bearerToken:Nt})},Pt.prototype.updateWebconfTags=function(At,Nt,Ot,Mt){return pt.debug("updateWebconfTags to "+mt.cloudUrl),Ot={_method:"PUT",tags:Ot.join(",")},function(bt,Wt){if(bt!==null&&typeof bt=="object"||(bt={}),ft.hasOwnProperty(Wt))for(var zt=ft[Wt],Bt=0,rn=["fetchRetryCount","fetchRetryDelay"];Bt<rn.length;Bt++){var gn=rn[Bt];zt.hasOwnProperty(gn)&&(bt[gn]=zt[gn])}}(Mt={bearerToken:Mt},"updateWebconfTags"),this.cloudRequest("/api/enterprises/{enterpriseId}/conferences/{conferenceId}".replace("{enterpriseId}",At).replace("{conferenceId}",Nt),Ot,"POST",Mt)},Pt.prototype.getConferenceList=function(At){return pt.debug("getConferenceList to "+mt.cloudUrl),this.cloudRequest(it,{},"GET",{bearerToken:At})},Pt.prototype.getOrCreateConversation=function(At,Nt,Ot){return Ot===void 0&&(Ot={}),pt.debug("getOrCreateConversation to "+mt.cloudUrl),At===null||typeof At!="object"||typeof Nt!="string"?Promise.reject("wrongArguments"):(At={name:At._getTechnicalName(),type:At.getType(),apiKey:Nt},Nt={},Ot.hasOwnProperty("token")&&Ot.token&&(Nt.bearerToken=Ot.token),Ot.hasOwnProperty("active")&&typeof Ot.active=="boolean"&&(At.active=1),this.cloudRequest("/api/v2/conversation",At,"POST",Nt))},Pt.prototype.createConference=function(At,Nt,Ot){return Ot===void 0&&(Ot={}),pt.debug("createConference to "+mt.cloudUrl),Nt={name:Nt},Ot.hasOwnProperty("password")&&(Nt.password=Ot.password),this.cloudRequest(it,Nt,"POST",{bearerToken:At})},Pt.prototype.checkConferenceAccess=function(At,Nt,Ot){var Mt;return Ot===void 0&&(Ot={}),pt.debug("checkConferenceAccess for "+At+" to "+mt.cloudUrl),typeof Nt!="string"?Promise.reject("wrongArguments"):(Nt={apiKey:Nt},Ot.convId&&(Nt.conv_id=Ot.convId),Ot.hasOwnProperty("password")&&(Nt.password=Ot.password),Mt={},Ot.hasOwnProperty("session")&&typeof Ot.session.getToken=="function"&&Ot.session.getToken()!==null&&(Mt.bearerToken=Ot.session.getToken()),this.cloudRequest("/api/v2/conferences/{roomname}/checkAccess".replace("{roomname}",At),Nt,"POST",Mt))},Pt.prototype.getWebconf=function(At,Nt){Nt===void 0&&(Nt={}),pt.debug("getWebconf for "+At+" to "+mt.cloudUrl);var Ot={};return Nt.hasOwnProperty("token")&&Nt.token&&(Ot.bearerToken=Nt.token),this.cloudRequest("/api/v2/conferences/{roomname}".replace("{roomname}",At),{},"GET",Ot)},Pt.prototype.getWebconfConversation=function(At,Nt,Ot){var Mt;return Ot===void 0&&(Ot={}),pt.debug("getWebconfConversation for "+At+" to "+mt.cloudUrl),typeof Nt!="string"?Promise.reject("wrongArguments"):(Nt={apiKey:Nt},Mt={},Ot.hasOwnProperty("token")&&Ot.token&&(Mt.bearerToken=Ot.token),this.cloudRequest("/api/v2/conferences/{roomname}/conversation".replace("{roomname}",At),Nt,"GET",Mt))},Pt.prototype.updateConferencePresence=function(At,Nt,Ot){pt.trace("updateConferencePresence for "+At.getName()+" to "+mt.cloudUrl),Ot={ccid:Nt.getId(),name:Nt.getUserAgent().getUsername(),instanceId:At.getInstanceId(),apiKey:Ot};var Mt={};return Nt.getToken()!==null&&(Mt.bearerToken=Nt.getToken()),this.cloudRequest("/api/v2/conferences/{roomname}/updatePresence".replace("{roomname}",At._getTechnicalName()),Ot,"POST",Mt)},Pt.prototype.closeConferenceInstance=function(At,Nt){pt.debug("closeConferenceInstance for "+At.getName()+" to "+mt.cloudUrl);var Ot={instanceId:At.getInstanceId()};return this.cloudRequest("/api/v2/conferences/{roomname}/closeInstance".replace("{roomname}",At._getTechnicalName()),Ot,"POST",{bearerToken:Nt.getToken()})},Pt.prototype.getConversationMediaList=function(At,Nt,Ot){var Mt;return Ot===void 0&&(Ot={}),pt.debug("getConversationMediaList for "+At+" to "+mt.cloudUrl),At&&typeof Nt=="string"?(Nt={apiKey:Nt},Mt={},Ot.hasOwnProperty("token")&&Ot.token&&(Mt.bearerToken=Ot.token),Ot.hasOwnProperty("offset")&&(Nt.offset=Ot.offset),Ot.hasOwnProperty("limit")&&(Nt.limit=Ot.limit),this.cloudRequest(ht.replace("{convId}",At.toString()),Nt,"GET",Mt)):Promise.reject("wrongArguments")},Pt.prototype.pushConversationMedia=function(At,Nt,Ot,Mt){return Mt===void 0&&(Mt={}),pt.debug("pushConversationMedia for "+At+" to "+mt.cloudUrl),At&&Nt&&typeof Ot=="string"?(Nt={media:Nt,apiKey:Ot},Ot={},Mt.hasOwnProperty("token")&&Mt.token&&(Ot.bearerToken=Mt.token),Mt.hasOwnProperty("metadata")&&Mt.metadata&&(Nt.metadata=Mt.metadata),Mt.hasOwnProperty("asFile")&&Mt.asFile&&(Nt.asFile=Mt.asFile),Mt.hasOwnProperty("filename")&&Mt.filename&&(Nt.filename=Mt.filename),Mt.overwrite===!0&&(Nt.overwrite=1),typeof Mt.ttl=="number"&&0<Mt.ttl&&(Nt.ttl=Mt.ttl),this.cloudRequest(ht.replace("{convId}",At.toString()),Nt,"POST",Ot)):Promise.reject("wrongArguments")},Pt.prototype.setConversationData=function(At,Nt,Ot,Mt){return Mt===void 0&&(Mt={}),pt.debug("setConversationData for "+At+" to "+mt.cloudUrl),At&&typeof Nt=="string"&&typeof Ot=="string"?(Nt={data:Nt,apiKey:Ot},Ot={},Mt.hasOwnProperty("token")&&Mt.token&&(Ot.bearerToken=Mt.token),this.cloudRequest("/api/v2/conversation/{convId}/data".replace("{convId}",At.toString()),Nt,"POST",Ot)):Promise.reject("wrongArguments")},Pt.prototype.getSessionHistory=function(At,Nt,Ot){Ot===void 0&&(Ot={}),pt.debug("getSessionHistory to "+mt.cloudUrl);var Mt={sessionId:At};if(Ot!=null)for(var bt=0,Wt=Object.keys(Ot);bt<Wt.length;bt++){var zt=Wt[bt];Mt[zt]=Ot[zt]}return this.cloudRequest("/api/v2/messages",Mt,"GET",{bearerToken:Nt})},Pt.prototype.getWebSession=function(At,Nt,Ot){return pt.debug("getSessionHistory to "+mt.cloudUrl),typeof Ot!="string"?Promise.reject("wrongArguments"):(Nt={destId:Nt.getId(),apiKey:Ot},Ot={},At.getToken()!==null?Ot.bearerToken=At.getToken():Nt.userId=At.getId(),this.cloudRequest("/api/v2/webSession",Nt,"GET",Ot))},Pt.prototype.saveNewMessage=function(At,Nt,Ot,Mt,bt,Wt){return pt.debug("saveNewMessage to "+mt.cloudUrl),bt={uuid:bt,destId:Ot,message:Mt,sessionId:At,userId:Nt.getId(),apiKey:Wt},Ot={},Nt.getToken()!==null&&(Ot.bearerToken=Nt.getToken()),this.cloudRequest("/api/v2/messages",bt,"POST",Ot)},Pt.prototype.saveGroupChatMessage=function(At,Nt,Ot,Mt,bt,Wt){return Wt===void 0&&(Wt={}),pt.debug("saveGroupChatMessage to "+mt.cloudUrl),Ot={apiKey:Ot,message:Mt,ccid:Nt.getId(),name:Nt.getUserAgent().getUsername(),parent_conv_id:At.getCloudConversationId(),uuid:bt,htmlEnable:Wt.metadata&&Wt.metadata.htmlEnable||!1},Mt={},Wt.token!==void 0&&Wt.token!==null?Mt.bearerToken=Wt.token:Nt.getToken()!==null?Mt.bearerToken=Nt.getToken():Ot.userId=Nt.getId(),this.cloudRequest("/api/v2/groupChatMessages",Ot,"POST",Mt)},Pt.prototype.loadGroupChatMessages=function(At,Nt,Ot){Ot===void 0&&(Ot=""),pt.debug("loadGroupChatMessages to "+mt.cloudUrl),At={parent_conv_id:At.getCloudConversationId()};var Mt={};return Mt.bearerToken=Ot!==""?Ot:Nt.getToken(),this.cloudRequest("/api/v2/groupChatMessages",At,"GET",Mt)},Pt}(),It=(ut.default=Tt,function(Pt){function At(Nt,Ot,Mt,bt){return(Nt=Pt.call(this,Nt)||this).name=Nt.constructor.name,Nt.code=Ot,Nt.httpCode=Mt,Nt.cloudResponse=bt,Nt}return ot(At,Pt),At}(Error))},128:(at,ut,s)=>{s.d(ut,{_:()=>lt}),s(2564);var et=s(1549).Y.get("ApiCCDataClient"),ot=apiCC.myWebRTC_Event,lt=function(St){this.sendData=function(pt,gt,ct){et.info("Call sending data function .... to :"+pt+" message :",gt);var ht,it,ft=St.channel.getNewCSeq(),mt=null;return ht={type:"dataMessage",senderId:St.apiCCId,dstRoomId:pt,data:gt,cSeq:ft},it=JSON.stringify(ht),et.log("C->S: "+it),ct!==void 0?(et.log("Ack management activated"),mt=setTimeout(function(){ct({reason:"timeoutReached",cSeq:ft}),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[ft]},St.messageTimeOutTimer),et.log("timeOutId: "+mt),St.messageTimeOutTable[ft]=mt,St.channel.socket.emit("dataMessage",it,function(Tt){et.log("callback on dataMessage"),et.log("callback reason :"+Tt.reason),et.log("cSeq :"+Tt.cSeq),ct(Tt),apiCC.session.messageTimeOutTable[ft]!==void 0?(et.log("clearing timeOutId: "+apiCC.session.messageTimeOutTable[ft]),clearTimeout(apiCC.session.messageTimeOutTable[ft]),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[ft]):et.warn("messageTimeOutTable was already deleted : timeout may have been reached before Ack")})):(et.log("Ack management not activated"),St.channel.socket.emit("dataMessage",it)),ft},this.sendDataToGroup=function(pt,gt){et.info("[ApiCCDataClient] sendDataToGroup - "+pt);var ct,ht=St.getConnectedUsersList(pt);for(ct=0;ct<ht.length;ct++)St.apiCCId!=ht[ct].userId&&this.sendData(ht[ct].userId,gt)},this.receiveData=function(pt){et.info("receiveData :"+pt.data),ot.createReceiveDataEvent(pt.senderId,pt.dstRoomId,pt.data)}}},6844:(at,ut,s)=>{s.d(ut,{U:()=>gt}),s(9554),s(1539),s(4747),s(2564),s(2526),s(1817),s(2165),s(6992),s(8783),s(3948);var et=s(1549),ot=s(4708),lt=s(940);function St(ct){return St=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ht){return typeof ht}:function(ht){return ht&&typeof Symbol=="function"&&ht.constructor===Symbol&&ht!==Symbol.prototype?"symbol":typeof ht},St(ct)}var pt=et.Y.get("ApiCCIMClient"),gt=function(ct,ht){this.convTable=[],this.myWebRTC_Event=apiCC.myWebRTC_Event,this.nickname=ct.nickname,this.photoURL=null,this.userDataSetted=!1,this.myWebRTC_Stack=new lt.S(ct.channel.socket),this.findIMIdWithDestID=function(it){var ft,mt=this.convTable.length;for(pt.log("findIMIdWithDestID = "+it),ft=0;ft<mt;ft+=1)if(pt.log("this.convTable[i].dest_roomId = "+this.convTable[ft].dest_roomId),this.convTable[ft].dest_roomId==it)return this.convTable[ft].IMId;return pt.log("Conversation IMId not found"),0},this.addInConvTable=function(it){pt.debug("addInConvTable");var ft,mt=this.convTable.length;for(ft=0;ft<mt;ft+=1)if(pt.log("this.convTable[i].dest_roomId = "+this.convTable[ft].dest_roomId),this.convTable[ft].dest_roomId==it.dest_roomId)return void(this.convTable[ft].IMId=it.IMId);pt.log("Conversation not found in the table, adding .."),this.convTable.push(it)},this.sendMessage=function(it,ft,mt,Tt){pt.info("Call sending message function .... from :"+this.nickname+" message :"+ft);var It,Pt=this.findIMIdWithDestID(it),At=null,Nt=null,Ot=null,Mt=ct.channel.getNewCSeq();return Pt===0?pt.log("Creation of a new IM conversation"):pt.log("Message is for existing conversation with ID : "+Pt),pt.log("IMConvId :"+Pt),At={type:"IMMessage",IMId:Pt,senderId:ct.apiCCId,nickname:this.nickname,photoURL:this.photoURL,dstRoomId:it,data:ft,cSeq:Mt,convData:Tt},ct.getConnectedUserIdsList().forEach(function(bt){bt.userId==it&&bt.hasOwnProperty("userData")&&bt.userData!==null&&St(bt.userData.hasOwnProperty("isChatbot"))&&bt.userData.isChatbot&&(At.pubSub="BotConnector")}),It=JSON.stringify(At),Nt=document.createElement("message"),pt.log("C->S: "+It),mt!==void 0?(pt.log("Ack management activated"),Ot=setTimeout(function(){mt({reason:"timeoutReached",cSeq:Mt}),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[Mt]},ct.messageTimeOutTimer),pt.log("timeOutId: "+Ot),ct.messageTimeOutTable[Mt]=Ot,ct.channel.socket.emit("IMMessage",It,function(bt){pt.log("callback on IMMessage"),pt.log("data :",bt),pt.log("callback reason :"+bt.reason),pt.log("callback convId :"+bt.convId),pt.log("cSeq :"+bt.cSeq),mt(bt),apiCC.session.messageTimeOutTable[Mt]!==void 0?(pt.log("clearing timeOutId: "+apiCC.session.messageTimeOutTable[Mt]),clearTimeout(apiCC.session.messageTimeOutTable[Mt]),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[Mt]):pt.warn("messageTimeOutTable was already deleted : timeout may have been reached before Ack")})):(pt.log("Ack management not activated"),ct.channel.socket.emit("IMMessage",It)),this.conversation!==null&&(Nt.innerHTML="<b>me :</b> "+Tt+"<br>",this.conversation.appendChild(Nt),this.conversation.scrollTop=this.conversation.scrollHeight),Mt},this.newConversationCreated=function(it){pt.debug("newConversationCreated :"+it),pt.log("msg.dstRoomId :"+it.dstRoomId),pt.log("msg.IMId :"+it.IMId);var ft={dest_roomId:it.dstRoomId,IMId:it.IMId};this.addInConvTable(ft)},this.receiveMessage=function(it){pt.info("Call receiveMessage message :"+it);var ft,mt=null;ft={dest_roomId:it.senderId,IMId:it.IMId},this.addInConvTable(ft),this.conversation!==null&&((mt=document.createElement("message")).innerHTML="<b>"+it.nickname+":</b> "+it.data+"<br>",this.conversation.appendChild(mt),this.conversation.scrollTop=this.conversation.scrollHeight),this.myWebRTC_Event.createReceiveIMMessageEvent(it.senderId,it.nickname,it.photoURL,it.data,it.UUCSeq,it.IMId)},this.createGroupChat=function(it,ft){var mt,Tt;pt.info("createGroupChat with contacts : "+it+","+ft),mt={type:"createGroupChat",nickname:this.nickname,photoURL:this.photoURL,contactId1:it,contactId2:ft},Tt=JSON.stringify(mt),pt.log("C->S: "+Tt),ct.channel.socket.emit("createGroupChat",Tt)},this.groupChatCreation=function(it){pt.debug("groupChatCreation"),this.myWebRTC_Event.createGroupChatCreationEvent(it.status,it.groupChatId,it.contactId1,it.invitationSendedToInitialDestId,it.contactId2,it.invitationSendedToNewContactId)},this.joinGroupChat=function(it){var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};pt.debug("joinGroupChat : "+it);var mt=null,Tt=null;mt={type:"joinGroupChat",groupChatId:it},ft.convId&&(mt.data={},mt.data.cloudConvId=ft.convId),Tt=JSON.stringify(mt),pt.log("C->S: "+Tt),ct.channel.socket.emit("joinGroupChat",Tt)},this.groupChatInvitation=function(it){pt.debug("groupChatInvitation"),this.myWebRTC_Event.createGroupChatInvitationEvent(it.groupChatId,it.senderId,it.senderNickname,it.senderPhotoURL,it.contactList)},this.answerToGroupChatInvitation=function(it,ft){var mt,Tt;pt.debug("answerToGroupChatInvitation: "+it+" : "+ft),ft===!0||ft===!1?(mt={type:"groupChatInvitationAnswer",groupChatId:it,senderId:ct.apiCCId,nickname:this.nickname,photoURL:this.photoURL,accept:ft},Tt=JSON.stringify(mt),pt.log("C->S: "+Tt),ct.channel.socket.emit("groupChatInvitationAnswer",Tt)):pt.log("accept value is not correct")},this.groupChatMemberUpdate=function(it){pt.info("groupChatMemberUpdate"),this.myWebRTC_Event.createGroupChatMemberUpdateEvent(it.groupChatId,it.contactList,it.status)},this.addUserInGroupChat=function(it,ft){var mt,Tt;pt.debug("addUser : "+ft+"in Group Chat with Id :"+it),mt={type:"addUserInGroupChat",groupChatId:it,nickname:this.nickname,photoURL:this.photoURL,contactId:ft},Tt=JSON.stringify(mt),pt.log("C->S: "+Tt),ct.channel.socket.emit("addUserInGroupChat",Tt)},this.addUserInGroupChatAnswer=function(it){pt.info("addUserInGroupChatAnswer"),this.myWebRTC_Event.createAddUserInGroupChatEvent(it.invitationSended,it.groupChatId,it.contactId)},this.leaveGroupChat=function(it){var ft,mt;pt.info("Leave Group Chat with Id :"+it),ft={type:"leaveGroupChat",groupChatId:it,nickname:this.nickname,photoURL:this.photoURL},mt=JSON.stringify(ft),pt.log("C->S: "+mt),ct.channel.socket.emit("leaveGroupChat",mt)},this.sendMessageToGroupChat=function(it,ft,mt){var Tt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};pt.info("Call sending message to Group Chat .... from :"+this.nickname+" message :"+ft);var It=null,Pt=null,At=apiCC.session.channel.getNewCSeq();It={type:"groupChatMessage",groupChatId:it,senderId:ct.apiCCId,nickname:this.nickname,cSeq:At,data:ft},(0,ot.Ym)(Tt,"metadata","object")&&(It.metadata=Tt.metadata),Pt=JSON.stringify(It),mt!==null&&typeof mt=="function"?(apiCC.session.messageTimeOutTable[At]=setTimeout(function(){mt({reason:"timeoutReached",cSeq:At}),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[At]},apiCC.session.messageTimeOutTimer),pt.log("C->S: "+Pt),ct.channel.socket.emit("groupChatMessage",Pt,function(Nt){clearTimeout(apiCC.session.messageTimeOutTable[Nt.cSeq]),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[Nt.cSeq],mt(Nt)})):(pt.log("C->S: "+Pt),ct.channel.socket.emit("groupChatMessage",Pt))},this.receiveGroupChatMessage=function(it){pt.info("receiveGroupChatMessage"),this.myWebRTC_Event.createReceiveGroupChatMessageEvent(it.groupChatId,it.senderId,it.nickname,it.data,it.metadata)},this.getConversationHistory=function(it){var ft,mt;pt.debug("getConversationHistory"),ft={type:"getConversationHistory",convId:it},mt=JSON.stringify(ft),pt.log("C->S: "+mt),ct.channel.socket.emit("getConversationHistory",mt)},this.receiveConversationHistory=function(it){pt.debug("receiveConversationHistory"),pt.log("msg.convId :"+it.convId);var ft,mt=0,Tt=[],It=null;if(it.convHistory!==null)for(pt.log("msg.convHistory.length :"+it.convHistory.length),mt=it.convHistory.length,Tt=[],ft=0;ft<mt;ft+=1)It=JSON.parse(it.convHistory[ft]),Tt.push(It);this.myWebRTC_Event.createReceiveConversationHistoryEvent(it.convId,Tt,it.status)},this.setUserData=function(it){var ft,mt;pt.info("setUserData"),this.photoURL=it.photoURL,ct.photoURL=it.photoURL,pt.log("photoURL :"+this.photoURL),ft={type:"setUserData",nickname:this.nickname,photoURL:this.photoURL},mt=JSON.stringify(ft),pt.log("C->S: "+mt),ct.channel.socket.emit("setUserData",mt),this.userDataSetted=!0},this.getUserData=function(it){var ft,mt;pt.info("getUserData"),ft={type:"getUserData",contactId:it},mt=JSON.stringify(ft),pt.log("C->S: "+mt),ct.channel.socket.emit("getUserData",mt)},this.receiveUserDataAnswer=function(it){pt.info("receiveUserDataAnswer"),this.myWebRTC_Event.createUserDataAnswerEvent(it.userFound,it.contactId,it.nickname,it.photoURL)},this.receiveFetchUserDataAnswer=function(it){pt.info("receiveFetchUserDataAnswer"),this.myWebRTC_Event.createFetchUserDataAnswerEvent(it)},this.initialize=function(it){var ft,mt;this.conversation=document.getElementById(it),this.conversation===null&&(pt.log("conversationElementId Div Name is not correct : INCORRECT_DIV_NAME_CONVERSATION"),pt.log("conversationElementId is null")),ft={type:"registerIM",username:this.nickname},mt=JSON.stringify(ft),pt.log("C->S: "+mt),ct.channel.socket.emit("registerIM",mt)},this.initialize(ht)}},9213:(at,ut,s)=>{s.d(ut,{X:()=>St}),s(2564),s(2526),s(1817),s(1539);var et=s(1549),ot=s(4708),lt=et.Y.get("ApiCCPointerSharingClient"),St=function pt(gt){this.roomTable={},this.getRoomIds=function(){var ct=[],ht=null;for(ht in this.roomTable)ct.push(ht);return ct},this.roomExists=function(ct){return this.roomTable.hasOwnProperty(ct)},this.roomActive=function(ct){return this.roomTable.hasOwnProperty(ct)&&this.roomTable[ct].state===pt.STATE_ACTIVE},this.joinRoom=function(ct,ht){var it=this;lt.info("ApiCCPointerSharingClient::joinRoom()"),(0,ot.Ym)(ht,"object")||(ht={}),(0,ot.ki)(ht,"success","function")||(ht.success=function(){}),(0,ot.ki)(ht,"failure","function")||(ht.failure=function(){}),this.roomTable.hasOwnProperty(ct)?ht.failure("room already joined",ct):(this.roomTable[ct]={roomId:ct,state:pt.STATE_JOINING,joinRoomCallbacks:ht},this.roomTable[ct].joinRoomTimeoutId=setTimeout(function(){delete it.roomTable[ct],ht.failure("timeout",ct)},15e3),apiCC.session.roomMgr.joinRoom(ct,"pointerSharing"))},this.leaveRoom=function(ct){this.roomTable.hasOwnProperty(ct)&&delete this.roomTable[ct],apiCC.session.roomMgr.leaveRoom(ct,"pointerSharing")},this.inviteInRoom=function(ct,ht,it){lt.info("ApiCCPointerSharingClient::inviteInRoom()"),apiCC.session.roomMgr.inviteInRoom(ct,ht,"pointerSharing",it)},this.sendPointerLocation=function(ct,ht,it,ft,mt){var Tt;return!(!this.roomTable.hasOwnProperty(ct)||this.roomTable[ct].state!==pt.STATE_ACTIVE||(Tt={type:"pointerLocation",source:ht,x:it,y:ft},(0,ot.Ym)(mt,"object")&&(Tt.data=mt),apiCC.session.roomMgr.sendMessageToRoom(ct,"pointerSharing",Tt),0))},this.processMessageRoomJoin=function(ct){this.roomTable.hasOwnProperty(ct.roomId)&&this.roomTable[ct.roomId].state===pt.STATE_JOINING&&(clearTimeout(this.roomTable[ct.roomId].joinRoomTimeoutId),delete this.roomTable[ct.roomId].joinRoomTimeoutId,this.roomTable[ct.roomId].state=pt.STATE_ACTIVE,this.roomTable[ct.roomId].joinRoomCallbacks.success(ct.roomId),delete this.roomTable[ct.roomId].joinRoomCallbacks)},this.stop=function(){for(var ct=this.getRoomIds(),ht=ct.length;--ht>=0;)this.leaveRoom(ct[ht])}};St.STATE_IDLE=Symbol("idle"),St.STATE_JOINING=Symbol("joining"),St.STATE_ACTIVE=Symbol("active"),St.STATE_ERROR=Symbol("error")},3720:(at,ut,s)=>{s.d(ut,{K:()=>Pt}),s(1058),s(8309),s(3710),s(1539),s(9714),s(2564),s(9554),s(4747),s(2772),s(561),s(6699),s(2479),s(2707),s(9601),s(2526),s(1817),s(2165),s(6992),s(8783),s(3948);var et=s(1549),ot=et.Y.get("RoomManager"),lt=function(At,Nt){ot.debug("RoomManager"),this.myWebRTC_Event=apiCC.myWebRTC_Event,this.createRoom=function(Ot){var Mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ot.info("RoomManager:createRoom with roomType : "+Ot);var bt={type:"createRoom",roomType:Ot,nickname:At.nickname,photoURL:At.photoURL};Mt.convId&&(bt.data||(bt.data={}),bt.data.cloudConvId=Mt.convId),Mt.webconf===!0&&(bt.data||(bt.data={}),bt.data.webconf=!0);var Wt=JSON.stringify(bt);ot.log("C->S: "+Wt),At.channel.socket.emit("createRoom",Wt)},this.roomCreation=function(Ot){ot.info("RoomManager:roomCreation"),this.myWebRTC_Event.createRoomCreationEvent(Ot.status,Ot.roomId,Ot.roomType),Nt(Ot)},this.roomJoin=function(Ot){ot.info("RoomManager:roomJoin"),this.myWebRTC_Event.createRoomJoinedEvent(Ot.status,Ot.roomId,Ot.roomType),Nt(Ot)},this.inviteInRoom=function(Ot,Mt,bt,Wt){var zt=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};ot.info("RoomManager:inviteInRoom with roomType:",bt);var Bt={type:"inviteInRoom",roomId:Ot,contactId:Mt,roomType:bt,nickname:At.nickname,photoURL:At.photoURL,context:Wt};zt.convId&&(Bt.data||(Bt.data={}),Bt.data.cloudConvId=zt.convId),zt.webconf===!0&&(Bt.data||(Bt.data={}),Bt.data.webconf=!0);var rn=JSON.stringify(Bt);ot.log("C->S: "+rn),At.channel.socket.emit("inviteInRoom",rn)},this.inviteInRoomStatus=function(Ot){ot.info("inviteInRoomStatus"),Nt(Ot)},this.roomInvitation=function(Ot){ot.info("roomInvitation",Ot);var Mt={};Ot.data&&(Ot.data.cloudConvId&&(Mt.cloudConvId=Ot.data.cloudConvId),Ot.data.webconf===!0&&(Mt.webconf=!0)),this.myWebRTC_Event.createRoomInvitationEvent(Ot.roomId,Ot.senderId,Ot.senderNickname,Ot.senderPhotoURL,Ot.contactList,Ot.roomType,Mt),Nt(Ot)},this.requestContactListInRoom=function(Ot){ot.info("requestContactListInRoom :"+Ot);var Mt={type:"requestContactListInRoom",roomId:Ot},bt=JSON.stringify(Mt);At.channel.socket.emit("requestContactListInRoom",bt)},this.onContactListInRoom=function(Ot){ot.info("onContactListInRoom :"+Ot),this.myWebRTC_Event.createContactListInRoomEvent(Ot.roomId,Ot.contactList,Ot.roomType),Nt(Ot)},this.answerToRoomInvitation=function(Ot,Mt,bt){if(ot.info("answerToRoomInvitation:",Ot,Mt),Mt===!0||Mt===!1){var Wt={type:"roomInvitationAnswer",roomId:Ot,senderId:At.apiCCId,nickname:At.nickname,photoURL:At.photoURL,accept:Mt,roomType:bt},zt=JSON.stringify(Wt);ot.log("C->S: "+zt),At.channel.socket.emit("roomInvitationAnswer",zt)}else ot.log("accept value is not correct")},this.roomMemberUpdate=function(Ot){ot.info("roomMemberUpdate"),this.myWebRTC_Event.createRoomMemberUpdateEvent(Ot.roomId,Ot.contactList,Ot.status,Ot.roomType),Nt(Ot)},this.sendMessageToRoom=function(Ot,Mt,bt){ot.info("Call sending message to Room .... from :"+At.apiCCId+" message :"+bt);var Wt={type:"roomMessage",roomId:Ot,senderId:At.apiCCId,nickname:At.nickname,roomType:Mt,data:bt},zt=JSON.stringify(Wt);ot.log("C->S: "+zt),At.channel.socket.emit("roomMessage",zt)},this.receiveRoomMessage=function(Ot){ot.info("receiveRoomMessage"),this.myWebRTC_Event.createReceiveRoomMessageEvent(Ot.roomId,Ot.senderId,Ot.nickname,Ot.data,Ot.roomType),Nt(Ot)},this.joinRoom=function(Ot,Mt){var bt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ot.info("Join Room with Id:",Ot);var Wt={type:"joinRoom",roomId:Ot,nickname:At.nickname,photoURL:At.photoURL,roomType:Mt};bt.convId&&(Wt.data||(Wt.data={}),Wt.data.cloudConvId=bt.convId),bt.webconf===!0&&(Wt.data||(Wt.data={}),Wt.data.webconf=!0);var zt=JSON.stringify(Wt);ot.log("C->S: "+zt),At.channel.socket.emit("joinRoom",zt)},this.leaveRoom=function(Ot,Mt){ot.info("Leave Room with Id:",Ot);var bt={type:"leaveRoom",roomId:Ot,nickname:At.nickname,photoURL:At.photoURL,roomType:Mt},Wt=JSON.stringify(bt);ot.log("C->S: "+Wt),At.channel.socket.emit("leaveRoom",Wt)}},St=(s(2023),s(7042),s(1038),s(4916),s(9753),s(8765)),pt=s(5945);function gt(At,Nt){(Nt==null||Nt>At.length)&&(Nt=At.length);for(var Ot=0,Mt=new Array(Nt);Ot<Nt;Ot++)Mt[Ot]=At[Ot];return Mt}var ct=et.Y.get("ApiCC_Channel"),ht=function(At){ct.debug("ApiCC_Channel"),this.channelReady=!1,this.socket=null,this.channelId=At.apiCCId,this.myWebRTC_Event=new St.K,this.channelHasBeenDisconnected=!1,this.cSeq=0,this.updatePresenceGroupIsNeeded=!1,this.oldPresenceGroup=null,this.newPresenceGroup=null,this.updateSubscribeToPresenceGroupIsNeeded=!1,this.oldSubscribeToPresenceGroup=null,this.newSubscribeToPresenceGroup=null,this.initialize=function(){ct.info("ApiCC_Channel::initialize()"),this.openChannel()},this.getNewCSeq=function(){return this.cSeq=this.cSeq+1,this.cSeq},this.openChannel=function(){var Nt,Ot,Mt,bt="",Wt=null,zt=null,Bt=null,rn=null;ct.debug("openChannel channelId :"+this.channelId),ct.debug("session.apiKey :"+At.apiKey),ct.log("session.sessionId :"+At.sessionId),At.xhrPolling=!0,ct.log("CCSserver used : "+At.ccsServer),Ot=At.appId!==void 0?"&appId="+At.appId:"",Mt=At.siteId!==void 0?"&siteId="+At.siteId:"",At.userData!==void 0&&(ct.log("Defined userData : ",At.userData),Wt=JSON.stringify(At.userData),ct.log("stringUserData.length :"+Wt.length),Wt.length<=1e3?bt="&userData="+encodeURIComponent(Wt):ct.warn("userData length is too long :"+Wt.length+" .Need to be <= 500")),At.presenceGroup!==void 0&&(ct.log("Defined presenceGroup : "+At.presenceGroup),zt=JSON.stringify(At.presenceGroup),ct.log("stringPresenceGroup.length :"+zt.length),zt.length<=750?bt+="&presenceGroup="+encodeURIComponent(zt):ct.warn("presenceGroup length is too long :"+zt.length+" .Need to be <= 750")),At.subscribeToPresenceGroup!==void 0&&(ct.log("Defined subscribeToPresenceGroup : "+At.subscribeToPresenceGroup),Bt=JSON.stringify(At.subscribeToPresenceGroup),ct.log("stringsubscribeToPresenceGroup.length :"+Bt.length),Bt.length<=750?bt+="&subscribeToPresenceGroup="+encodeURIComponent(Bt):ct.warn("subscribeToPresenceGroup length is too long :"+Bt.length+" .Need to be <= 750")),At.token!==void 0&&(ct.log("Defined token : "+At.token),bt+="&token="+At.token),At.conversationSpace!==void 0&&At.conversationSpace!==null&&(ct.log("Defined conversationSpace : "+At.conversationSpace),bt+="&conversationSpace="+At.conversationSpace),typeof apiRTC_React>"u"&&(ct.log("ApplicationUUID : "+window.location.hostname),bt+="&applicationUUID="+window.location.hostname),bt+="&apiLibType=apiRTC_JS",ct.log("requestOptions on connect :"+bt),ct.log("session.ccsServer :"+At.ccsServer),Nt="?channelId="+this.channelId+"&apiKey="+At.apiKey+"&apiVersion="+apiCC.version+"&apiCCSessionId="+At.apiCCSessionId+"&sessionId="+At.sessionId+Ot+Mt+bt,rn=typeof apiRTC_React<"u"?"https":window.location.protocol==="http:"?"http":"https",pt.ag.name!=="iOS"&&pt.ag.name!=="Android"||(ct.log(pt.ag.name+" detected forcing protocol to https"),rn="https"),ct.info("CCS Connect, socket url is : "+rn+"://"+At.ccsServer+"/"+Nt),this.ccsConnectionRetryNb=At.ccsConnectionRetryNb,this.ccsConnectionRetryDelay=At.ccsConnectionRetryDelay,this.socket=window.rtcio.connect(rn+"://"+At.ccsServer+"/"+Nt,{forceNew:!0,multiplex:!1,withCredentials:!0,reconnectionAttempts:this.ccsConnectionRetryNb,reconnectionDelay:this.ccsConnectionRetryDelay}),this.socket.on("connect",this.callback(this,"onChannelOpened")).on("connect_error",this.callback(this,"onChannelConnectError")).on("message",this.callbackWithParams(this,"onChannelMessage")).on("disconnect",this.callback(this,"onChannelDisconnect")),this.socket.io.on("error",this.callback(this,"onChannelError")).on("reconnect",this.callback(this,"onChannelReconnect")).on("reconnect_attempt",this.callback(this,"onChannelReconnectAttempt")).on("reconnect_error",this.callback(this,"onChannelReconnectError")).on("reconnect_failed",this.callback(this,"onChannelReconnect_failed"))},this.onWhiteBoardDisconnection=function(){ct.info("onWhiteBoardDisconnection"),apiCC.session.closeWhiteBoardClient("NETWORK_DISCONNECTION")},this.onChannelDisconnect=function(Nt){ct.info("onChannelDisconnect");var Ot=Date();ct.debug("date :"+Ot),apiCC.session.connectedUsersList.splice(0,apiCC.session.connectedUsersList.length),this.myWebRTC_Event.createChannelEvent("onChannelDisconnect",Nt),this.channelHasBeenDisconnected=!0,apiCC.myApiCCWhiteBoardClient!==null&&(ct.log("apiCC.myApiCCWhiteBoardClient.roomId :"+apiCC.myApiCCWhiteBoardClient.roomId),apiCC.myApiCCWhiteBoardClient.roomId!==null?(ct.log("Disconnection with an ongoing whiteboard"),ct.error("Whiteboard disconnectionTimer is set to:",apiCC.myApiCCWhiteBoardClient.disconnectionTimer),apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId=setTimeout(this.callback(this,"onWhiteBoardDisconnection"),apiCC.myApiCCWhiteBoardClient.disconnectionTimer)):ct.log("Disconnection without an ongoing whiteboard")),apiCC.session.JWTApzTokentimeOutId!==-1&&clearTimeout(apiCC.session.JWTApzTokentimeOutId)},this.onChannelReconnect_failed=function(){ct.info("onChannelReconnect_failed"),this.myWebRTC_Event.createChannelEvent("onChannelReconnect_failed")},this.onChannelReconnect=function(Nt){ct.error("onChannelReconnect",Nt);var Ot,Mt=null,bt=0,Wt=[],zt=null,Bt=null,rn=null,gn=!1,tn=0,Ht=null,fn=null;if(At.conversationSpace!==null&&At.conversationSpace!==void 0?(ct.debug("conversationSpace is set :",At.conversationSpace),At.joinConversationSpace(At.conversationSpace)):ct.debug("no conversationSpace defined"),At.userData!==void 0&&At.userData!==null&&(ct.debug("sending userData :",At.userData),At.setUserData(At.userData,!0)),At.presenceGroup!==null?(ct.debug("presenceGroup is set :",At.presenceGroup),At.sendPresenceGroupManagementCommand("join",At.presenceGroup)):ct.debug("no presenceGroup defined"),At.subscribeToPresenceGroup!==null?(ct.debug("subscribeToPresenceGroup is set :",At.subscribeToPresenceGroup),At.sendPresenceGroupManagementCommand("subscribe",At.subscribeToPresenceGroup)):ct.debug("no subscribeToPresenceGroup defined"),apiCC.session.apiCCIMClient!==null?apiCC.session.apiCCIMClient.userDataSetted===!0?(Mt={photoURL:apiCC.session.apiCCIMClient.photoURL},apiCC.session.apiCCIMClient.setUserData(Mt)):ct.log("apiCC.session.apiCCIMClient.userDataSetted !== true"):ct.log("apiCC.session.apiCCIMClient === null"),apiCC.session.apiCCWebRTCClient!==null){if(apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.length>0)for(gn=!0,Ot=0;Ot<apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.length;Ot+=1)zt={destId:(fn=apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable[Ot]).remoteId,convId:fn.userMediaId,callType:fn.callType,roomId:fn.roomId,data:fn.data,meshPublish:!0},Wt.push(zt);if((bt=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length)!==0){for(ct.log("Reconnecting with calls ongoing"),Ot=0;Ot<bt;Ot+=1)apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[Ot]!==null&&apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[Ot]!==void 0?(fn=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[Ot],ct.debug("call.iceState =",fn.iceState),fn.data!==null?fn.data.type!=="publish"&&fn.data.type!=="subscribe"?(ct.log("Call is P2P, updating media"),fn.updateMediaWithRetryManagement(!0),zt={destId:fn.remoteId,convId:fn.callId,callType:fn.callType,roomId:fn.dest_roomId,data:fn.data},Wt.push(zt)):(ct.log("Call is in an MCU session"),zt={destId:fn.remoteId,convId:fn.callId,callType:fn.callType,roomId:fn.dest_roomId,data:fn.data},Wt.push(zt)):(ct.log("Call is P2P, updating media - no data"),fn.updateMediaWithRetryManagement(!0),zt={destId:fn.remoteId,convId:fn.callId,callType:fn.callType,roomId:fn.dest_roomId,data:fn.data},Wt.push(zt))):ct.log("call no more exist");gn=!0}else ct.log("Reconnecting without calls ongoing");for(var bn=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs,In=0;In<bn.length;In+=1){ct.log("Reconnecting with an ongoing sessionMCU");var un=[];un.push(bn[In].roomName),apiCC.session.sendPresenceGroupManagementCommand("join",un),apiCC.session.sendPresenceGroupManagementCommand("subscribe",un)}}if(apiCC.myApiCCWhiteBoardClient!==null&&(apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId!==0&&(ct.debug("clearing whiteBoardDisconnectionTimeoutId"),clearTimeout(apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId),apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId=0),ct.log("apiCC.myApiCCWhiteBoardClient.roomId :"+apiCC.myApiCCWhiteBoardClient.roomId),apiCC.myApiCCWhiteBoardClient.roomId!==null?(ct.log("Reconnection with an ongoing whiteboard"),tn=apiCC.myApiCCWhiteBoardClient.roomId,gn=!0,ct.debug("Reconnection , sending request to get most recent whiteboard data"),apiCC.myApiCCWhiteBoardClient.paperSheetId=0,apiCC.myApiCCWhiteBoardClient.drawingId=0,apiCC.myApiCCWhiteBoardClient.sendDataToRoom({tool:"void",needCatchUp:"*||-1"})):ct.log("Reconnecting without an ongoing whiteboard")),apiCC.session.apiCCPointerSharingClient!==null&&(Ht=apiCC.session.apiCCPointerSharingClient.getRoomIds()).length>0&&(gn=!0),gn===!0){ct.log("Sending reconnectContext to CCS"),Bt={type:"reconnectContext",callList:Wt,whiteBoardRoomId:tn},Ht!==null&&Ht.length>0&&(Bt.pointerSharingRoomIds=Ht);var mn=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs;if(mn.length>0){Bt.updateSession=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.createJoinSessionMessage(null),Bt.updateSession.type="updateSession",Bt.updateSessions=[];var yn,pn=function(xn,Mn){var Dn=typeof Symbol<"u"&&xn[Symbol.iterator]||xn["@@iterator"];if(!Dn){if(Array.isArray(xn)||(Dn=function(zn,lr){if(zn){if(typeof zn=="string")return gt(zn,lr);var cn=Object.prototype.toString.call(zn).slice(8,-1);return cn==="Object"&&zn.constructor&&(cn=zn.constructor.name),cn==="Map"||cn==="Set"?Array.from(zn):cn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(cn)?gt(zn,lr):void 0}}(xn))||Mn&&xn&&typeof xn.length=="number"){Dn&&(xn=Dn);var An=0,Nn=function(){};return{s:Nn,n:function(){return An>=xn.length?{done:!0}:{done:!1,value:xn[An++]}},e:function(zn){throw zn},f:Nn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Un,Qn=!0,er=!1;return{s:function(){Dn=Dn.call(xn)},n:function(){var zn=Dn.next();return Qn=zn.done,zn},e:function(zn){er=!0,Un=zn},f:function(){try{Qn||Dn.return==null||Dn.return()}finally{if(er)throw Un}}}}(mn);try{for(pn.s();!(yn=pn.n()).done;){var Tn=yn.value,kn=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.createJoinSessionMessage(null,{sessionMCU:Tn});kn.type="updateSession",Bt.updateSessions.push(kn)}}catch(xn){pn.e(xn)}finally{pn.f()}}rn=JSON.stringify(Bt),ct.log("C->S: "+rn),apiCC.session.channel.socket.emit("reconnectContext",rn)}Wt.splice(0,Wt.length),this.myWebRTC_Event.createChannelEvent("onChannelReconnect",Nt)},this.onChannelReconnecting=function(Nt){ct.info("onChannelReconnecting",Nt);var Ot=Date();ct.debug("date :"+Ot),this.myWebRTC_Event.createChannelEvent("onChannelReconnecting",Nt)},this.onChannelOpened=function(){ct.info("Channel opened"),ct.log("this.channelId :"+this.channelId),this.channelReady=!0,this.channelHasBeenDisconnected===!1?At.onChannelOpened():(ct.log("onChannelOpened after a disconnection, no change on session"),this.channelHasBeenDisconnected=!1,At.ApiDBActivated!==!1&&At.ApiDBActivated!==void 0&&At.ApiDBActivated!==null&&(ct.log("apiDB initialisation"),apiDB.init(At.channel.socket))),this.updatePresenceGroupIsNeeded===!0&&(ct.log("Updating presence group"),At.leavePresenceGroup(this.oldPresenceGroup),At.joinPresenceGroup(this.newPresenceGroup)),this.updateSubscribeToPresenceGroupIsNeeded===!0&&(ct.log("Updating subscribe to presence group"),At.unsubscribePresenceGroup(this.oldSubscribeToPresenceGroup),At.subscribePresenceGroup(this.newSubscribeToPresenceGroup)),this.myWebRTC_Event.createChannelEvent("onChannelOpened")},this.onChannelMessage=function(Nt,Ot){var Mt,bt=null,Wt=null;try{bt=JSON.parse(Nt)}catch{return}(Mt=bt.type==="checkCallStatus"||bt.type==="apiRTCDataMessage"&&bt.data&&["activeSpeaker","stopSpeaking"].indexOf(bt.data.type)>=0)||ct.info("onChannelMessage S->C: "+Nt),bt.type==="IMMessage"&&(ct.log("IMMessage convId :"+bt.IMId),Wt=bt.IMId),Ot!==void 0&&(ct.trace("ack on message reception"),ct.trace("convId :"+Wt),Ot({reason:"ack",convId:Wt})),At.processSignalingMessage(bt,{quiet:Mt})},this.onChannelConnectError=function(Nt){ct.error("onChannelConnectError :",Nt.message),this.myWebRTC_Event.createChannelEvent("onChannelConnectError",Nt),this.checkIfConnectionAttemptNeedToBeStopped(Nt)},this.onChannelReconnectError=function(Nt){ct.log("onChannelReconnectError :",Nt.message),this.myWebRTC_Event.createChannelEvent("onChannelReconnectError",Nt),this.checkIfConnectionAttemptNeedToBeStopped(Nt)},this.onChannelReconnectAttempt=function(Nt){ct.log("onChannelReconnectAttempt :",Nt),this.myWebRTC_Event.createChannelEvent("onChannelReconnectAttempt",Nt),this.onChannelReconnecting(Nt)},this.onChannelError=function(Nt){ct.error("Channel error :",Nt.message),this.checkIfConnectionAttemptNeedToBeStopped(Nt),this.myWebRTC_Event.createChannelEvent("onChannelError",Nt)},this.checkIfConnectionAttemptNeedToBeStopped=function(Nt){ct.debug("checkIfConnectionAttemptNeedToBeStopped"),(Nt.message==="not authorized"||Nt.message.includes("access token failure:")||Nt.message.includes("DISABLED_ENTERPRISE")||Nt.message.includes("An account is needed")||Nt.message.includes("ApiRTC update is needed")||Nt.message.includes("applicationUUID is not authorized"))&&(ct.error("Stopping connection attempts"),this.socket.disconnect())},this.callback=function(Nt,Ot){return this.closureHandler=function(Mt){return Nt[Ot](Mt)},this.closureHandler},this.callbackWithParams=function(Nt,Ot){return this.closureHandler=function(Mt,bt,Wt){return Nt[Ot](Mt,bt,Wt)},this.closureHandler}},it=s(4708),ft=s(940);function mt(At){return mt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Nt){return typeof Nt}:function(Nt){return Nt&&typeof Symbol=="function"&&Nt.constructor===Symbol&&Nt!==Symbol.prototype?"symbol":typeof Nt},mt(At)}var Tt=et.Y.get("ApiCCSession"),It=apiCC.myWebRTC_Event,Pt=function(At){var Nt=this;if(this.apiCCId=null,this.apiCCSessionId=apiCC.randomString(22),this.apiKey=null,this.nickname=null,this.photoURL=null,this.apiCCWebRTCClient=null,this.apiCCIMClient=null,this.apiCCDataClient=null,this.apiCCIDSessionStorage=null,this.apiKeySessionStorage=null,this.apiCCIdPersistenceTimeout=5e3,this.channel=null,this.recordActivated=At.recordActivated,this.sessionId=null,this.apiCCPointerSharingClient=null,this.apiCCWhiteBoardClient=null,this.ccsServer=At.ccsServer,this.userData=At.userData,this.apiDBActivated=!0,At.ApiDBActivated=!0,this.webRTCPluginActivated=At.webRTCPluginActivated,this.token=At.token,this.JWTApzToken=null,this.JWTApzTokenRefreshTimer=396e5,this.JWTApzTokentimeOutId=-1,this.conversationSpace=At.conversationSpace,this.tryAudioCallAfterUserMediaError=At.tryAudioCallAfterUserMediaError,this.deactivateReloadOnCancel=At.deactivateReloadOnCancel,this.connectedUsersList=[],this.messageTimeOutTable=[],this.ccsConnectionRetryNb=At.ccsConnectionRetryNb,this.ccsConnectionRetryDelay=At.ccsConnectionRetryDelay,this.sequentialMessagesStorage={},this.cloudIsSecured=At.cloudIsSecured,At.messageTimeOutTimer!==void 0?this.messageTimeOutTimer=At.messageTimeOutTimer:this.messageTimeOutTimer=1e4,Tt.log("messageTimeOutTimer set to : "+this.messageTimeOutTimer),At.presenceGroup!==void 0?this.presenceGroup=At.presenceGroup:this.presenceGroup=["default"],At.subscribeToPresenceGroup!==void 0?this.subscribeToPresenceGroup=At.subscribeToPresenceGroup:this.subscribeToPresenceGroup=["default"],this.presenceGroupAddedByApiRTC=[],this.subscribeToPresenceGroupAddedByApiRTC=[],this.remoteAccessInvitation=null,this.isDeviceWebRTCCompliant=function(){return apiCC.isWebRTCCompliant()},this.isDeviceDTLSCompliant=function(){var bt=pt.E2.getBrowser(),Wt=parseInt(bt.version,10);return!(bt.name==="Chrome"&&Wt<44&&(Tt.log("isDeviceDTLSCompliant FALSE : Chrome V < 44"),1))},this.userData===void 0||this.userData===null?(this.userData={},this.userData.webRtcCompliant=apiCC.webRTCCompliant,this.userData.dtlsCompliant=this.isDeviceDTLSCompliant()):this.userData.webRtcCompliant===void 0||this.userData.webRtcCompliant===null?(this.userData.webRtcCompliant=apiCC.webRTCCompliant,this.userData.dtlsCompliant=this.isDeviceDTLSCompliant()):Tt.log("userData webRtcCompliant set to :",this.userData.webRtcCompliant),this.userData.osName=pt.BF,this.userData.osVersion=pt.MM,this.userData.browser=pt.Xh,this.userData.deviceType=pt.vO,this.userData.deviceVendor=pt.Cm,this.userData.deviceModel=pt.Ak,this.userData.browser_version=pt.dc,this.userData.browser_major_version=pt.PR,this.userData.apiRTCVersion=apiCC.version,this.userData.cpuArchitecture=pt.Ne,this.userData.engineName=pt.AA,this.userData.engineVersion=pt.TI,apiRTC.userAgentInstance!==void 0&&(this.userData.remoteAccessUserSupport=apiRTC.userAgentInstance.getCapabilities().remoteAccessUser),pt.BF==="Android"&&typeof cordova<"u"&&(this.userData.platform="Android"),typeof apiRTC_React<"u"&&(this.userData.react=!0),this.roomManagerEventHandler=function(bt){if(Tt.debug("roomManagerEventHandler, roomId :"+bt.roomId+", type :"+bt.type+", roomType :"+bt.roomType),bt.roomType==="whiteBoard"){if(apiCC.myApiCCWhiteBoardClient===null||apiCC.myApiCCWhiteBoardClient===void 0)return void Tt.log("No whiteBoard created, leaving msg processing");bt.type==="roomCreation"&&(Tt.log("whiteBoard : roomCreation"),apiCC.myApiCCWhiteBoardClient.roomId=bt.roomId,apiCC.myApiCCWhiteBoardClient.paperSheetId++,apiCC.myApiCCWhiteBoardClient.drawingId=0,apiCC.myApiCCWhiteBoardClient.sendDataToRoom({tool:"void",needCatchUp:"*||-1"})),bt.type==="roomInvitation"&&(Tt.log("whiteBoard : roomInvitation"),apiCC.myApiCCWhiteBoardClient.roomId=bt.roomId),bt.type==="roomMessage"&&apiCC.myApiCCWhiteBoardClient.messageProcessing(bt.data),bt.type==="roomJoin"&&(Tt.log("whiteBoard : roomJoin"),apiCC.myApiCCWhiteBoardClient.roomJoined=!0,apiCC.myApiCCWhiteBoardClient.roomId=bt.roomId)}else bt.roomType==="pointerSharing"?apiCC.session.apiCCPointerSharingClient&&bt.type==="roomJoin"&&apiCC.session.apiCCPointerSharingClient.processMessageRoomJoin(bt):bt.roomType==="coBrowsing"?bt.type==="roomMessage"&&Tt.log("coBrowsing : roomMessage :"+bt):Tt.log("roomManagerEventHandler for msg.roomType :"+bt.roomType)},this.callback=function(bt,Wt){return this.closureHandler=function(zt){return bt[Wt](zt)},this.closureHandler},this.roomMgr=new lt(this,this.callback(this,"roomManagerEventHandler")),At.xhrPolling===!0?this.xhrPolling=!0:this.xhrPolling=!1,this.getSessionStorage=function(bt){var Wt=sessionStorage.getItem(bt);if(Wt===null)return null;try{var zt=JSON.parse(Wt),Bt=new Date(zt.expiresAt);return new Date>=Bt?(sessionStorage.removeItem(bt),null):zt.value}catch{Tt.error("Something went wrong when parsing JSON from session storage values")}},this.generateApiCCID=function(){Tt.debug("apiCCId is not defined by user, checking if apiCCId exist in sessionStorage"),typeof apiRTC_React>"u"&&(this.apiCCIDSessionStorage=this.getSessionStorage("apiCCId"),this.apiKeySessionStorage=this.getSessionStorage("apiKey")),this.apiCCIDSessionStorage!==null?(Tt.log("apiCCId exist in sessionStorage : "+this.apiCCIDSessionStorage),this.apiKeySessionStorage!==null?(Tt.log("apiKey exist in sessionStorage : "+this.apiKeySessionStorage),this.apiKeySessionStorage===this.apiKey?(Tt.log("apiKey is the same, keeping apiCCId"),this.apiCCId=this.apiCCIDSessionStorage):(Tt.log("apiKey is not the same, generating an  apiCCId"),this.apiCCId=Math.floor(1000001*Math.random()).toString(),Tt.log("Creation of new ApiRTC session with Id : "+this.apiCCId))):this.apiCCId=this.apiCCIDSessionStorage):(Tt.log(" No apiCCId found on sessionStorage : generating an apiCCId"),this.apiCCId=String(1e5+Math.floor(9e5*Math.random())),Tt.log("Creation of new ApiRTC session with Id : "+this.apiCCId))},this.getNumericIdFromAlpha=function(bt){Tt.log("getNumericIdFromAlpha new : "+bt);var Wt,zt=0;if(bt.length===0)return zt;for(Wt=0;Wt<bt.length;Wt++)zt=(zt<<5)-zt+bt.charCodeAt(Wt),zt&=zt;return Tt.log("getNumericIdFromAlpha returned value: "+(zt>>>0)),zt>>>0},At.appId!==void 0&&(this.appId=At.appId),At.siteId!==void 0&&(this.siteId=At.siteId),At.apiKey===void 0)return Tt.error('Error : Initialisation parameters: "apikey" for session creation is not defined'),null;if(Tt.log("Session creation with apiKey : "+At.apiKey),Tt.log("Session creation with apiCCId : "+At.apiCCId),this.apiKey=At.apiKey,At.onReady===void 0&&typeof apiRTC_React>"u")return Tt.error('Error : Initialisation parameters: "onReady" for session creation is not defined'),null;if(apiCC.addEventListener("sessionReady",At.onReady),typeof apiRTC_React>"u"&&(this.sessionId=this.getSessionStorage("sessionId")),At.apiCCId===void 0||At.apiCCId===""||At.apiCCId===null)this.generateApiCCID();else if(Tt.log("Session creation with apiCCId defined by user : "+At.apiCCId),Tt.debug("params.idConversionActivated : "+At.idConversionActivated),At.idConversionActivated===void 0||At.idConversionActivated===!0)if((0,it._C)(At.apiCCId))this.apiCCId=At.apiCCId.toString();else{Tt.log("Converting this Id in a numeric one");var Ot=this.getNumericIdFromAlpha(At.apiCCId);Ot+="",Tt.log("Numeric Id is : "+Ot),(0,it._C)(Ot)?(Tt.warn("Id has been converted to a numeric one"),this.apiCCId=Ot.toString()):(Tt.warn("Error : Defined apiCCId :"+At.apiCCId+" is not numeric. ApiCCID is generated"),this.generateApiCCID())}else Tt.log("String id convertion is deactivated"),this.apiCCId=At.apiCCId.toString();function Mt(bt){return bt instanceof Array?(Tt.log("data instanceof Array"),!0):(Tt.log("data not instanceof Array"),!1)}At.apiCCIdPersistenceTimeout!==null&&typeof At.apiCCIdPersistenceTimeout=="number"&&At.apiCCIdPersistenceTimeout>=0&&(this.apiCCIdPersistenceTimeout=At.apiCCIdPersistenceTimeout),this.channel!==null&&(Tt.log("this.channel is defined"),delete this.channel),this.channel=new ht(this),this.channel.initialize(),At.nickname!==null&&At.nickname!==void 0?(Tt.log("Nickname is defined :"+At.nickname),this.nickname=At.nickname):(Tt.log("Nickname is not defined, setting to apiCCId value :"+this.apiCCId),this.nickname=this.apiCCId),At.photoURL!==null&&At.photoURL!==void 0?(Tt.log("photoURL is defined :"+At.photoURL),this.photoURL=At.photoURL):(Tt.log("photoURL is not defined"),this.photoURL=null),this.reOpenChannel=function(bt,Wt){Tt.info("reOpenChannel"),this.apiCCId=bt.toString(),this.apiKey=Wt,this.channel.socket!==void 0&&this.channel.socket!==null&&this.channel.socket.disconnect(),this.channel.channelReady=!1,this.channel.socket=null,this.channel.channelId=this.apiCCId,this.channel.initialize(),this.apiCCWebRTCClient!==null&&this.apiCCWebRTCClient.webRTCClient!==null&&(this.apiCCWebRTCClient.webRTCClient.socket=this.channel.socket)},this.onChannelOpened=function(){Tt.debug("ApiCCSession onChannelOpened"),At.ApiDBActivated!==!1&&At.ApiDBActivated!==void 0&&At.ApiDBActivated!==null&&(Tt.log("apiDB initialisation"),apiDB.init(this.channel.socket)),It.createSessionReadyEvent(apiCC.session.apiCCId)},this.createWebRTCClient=function(bt){Tt.debug("createWebRTCClient");var Wt={};this.apiCCWebRTCClient=new apiCC.ApiCCWebRTCClient(this),apiCC.session.apiCCWebRTCClient.webRTCClient.setGumConfigWithDevicePresent(),Wt.audioDevicePresent=apiCC.mediaDeviceMgr.audioDevicePresent,Wt.videoDevicePresent=apiCC.mediaDeviceMgr.videoDevicePresent,apiCC.session.setUserData(Wt),setTimeout(function(){It.createWebRTCClientCreatedEvent()});var zt=apiCC.getUserMediaStreamIds(),Bt=zt.length;for(Tt.debug("listing accessToLocalMedia "+Bt);--Bt>=0;)if(apiCC.getUserMediaStream(zt[Bt]).accessToLocalMedia()){Tt.debug("setting accessToLocalMedia to true"),this.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0;break}return this.apiCCWebRTCClient},this.createPointerSharingClient=function(){return this.apiCCPointerSharingClient===null&&(this.apiCCPointerSharingClient=new apiCC.ApiCCPointerSharingClient(this)),this.apiCCPointerSharingClient},this.closePointerSharingClient=function(){this.apiCCPointerSharingClient!==null&&this.apiCCPointerSharingClient instanceof apiCC.ApiCCPointerSharingClient&&(this.apiCCPointerSharingClient.stop(),this.apiCCPointerSharingClient=null)},this.createWhiteBoard=function(bt,Wt,zt,Bt){return Tt.info("createWhiteBoard"),this.apiCCWhiteBoardClient=apiCC.createWhiteBoard(bt,Wt,zt,Bt),this.apiCCWhiteBoardClient},this.closeWhiteBoardClient=function(bt){Tt.info("closeWhiteBoardClient"),apiCC.closeWhiteBoardClient(bt)},this.createIMClient=function(bt){return Tt.debug("createIMClient"),this.apiCCIMClient=new apiCC.ApiCCIMClient(this,bt),this.apiCCIMClient},this.createDataClient=function(){return Tt.info("createDataClient"),this.apiCCDataClient=new apiCC.ApiCCDataClient(this),this.apiCCDataClient},this.updatingQuery=function(bt){Tt.debug("updatingQuery");var Wt=null,zt=null,Bt=null;return Wt=(0,it.dD)(bt),this.userData!==void 0?(zt=JSON.stringify(this.userData),Bt=encodeURIComponent(zt),Wt.userData=Bt,(0,it.Wc)(Wt)):bt},this.setUserData=function(bt,Wt){Tt.debug("setUserData in session :",bt);var zt,Bt,rn,gn=[],tn=this.userData;if(this.userData!==void 0){if(this.userData=(0,it.S6)(this.userData,bt),Tt.debug("this.userData :",this.userData),Tt.debug("actualUserData :",tn),Tt.debug("forceSendData :",Wt),Wt!==!0&&JSON.stringify(this.userData)===JSON.stringify(tn))return void Tt.debug("userData is not changed, leaving userData processing")}else this.userData=bt;for(zt={type:"setUserData",userData:bt},Bt=JSON.stringify(zt),Tt.log("C->S: "+Bt),this.channel.socket.emit("setUserData",Bt),Tt.log("socket.io 1.X : socket.io.opts.query :"+this.channel.socket.io.opts.query),this.channel.socket.io.opts.query=this.updatingQuery(this.channel.socket.io.opts.query),Tt.log("socket.io 1.X : after update : socket.io.opts.query :"+this.channel.socket.io.opts.query),rn=0;rn<this.connectedUsersList.length;rn+=1)this.apiCCId===this.connectedUsersList[rn].userId&&(this.connectedUsersList[rn].userData=this.userData,gn[0]=this.apiCCId,It.createConnectedUsersListUpdateEvent(this.connectedUsersList[rn].group,gn,"userDataUpdate","userDataUpdate"))},this.sendPresenceGroupManagementCommand=function(bt,Wt){if(Tt.debug("sendPresenceGroupManagementCommand :"+bt+" for group : "+Wt),Mt(Wt)===!0){var zt,Bt,rn,gn=Wt.length;if(bt==="unsubscribe")for(rn=0;rn<gn;rn+=1)this.removeGroupDataFromConnectedUsersList(Wt[rn]);gn!==1||Wt[0]!=="deactivated"?(zt={type:"presenceGroupManagement",command:bt,group:Wt},Bt=JSON.stringify(zt),Tt.log("C->S: "+Bt),this.channel.socket.emit("presenceGroupManagement",Bt)):Tt.debug("leaving sendPresenceGroupManagementCommand for group deactivated")}else Tt.error("group parameter value is not correct, need to be a JSON array")},this.sendConversationSpaceCommand=function(bt,Wt){var zt,Bt;Tt.debug("sendConversationSpaceCommand :"+bt+" for conversationSpace : "+Wt),zt={type:"conversationSpaceManagement",command:bt,conversationSpace:Wt},Bt=JSON.stringify(zt),Tt.log("C->S: "+Bt),this.channel.socket.emit("conversationSpaceManagement",Bt)},this.joinPresenceGroup=function(bt,Wt){var zt=this;Wt||((Wt={}).doneByApiRTC=!1),Tt.debug("joinPresenceGroup :"+bt),Mt(bt)===!0?(this.sendPresenceGroupManagementCommand("join",bt),bt.forEach(function(Bt){var rn=zt.presenceGroupAddedByApiRTC.indexOf(Bt);zt.presenceGroup.indexOf(Bt)===-1&&(zt.presenceGroup.push(Bt),Wt.doneByApiRTC&&rn===-1&&zt.presenceGroupAddedByApiRTC.push(Bt)),Wt.doneByApiRTC===!1&&rn!==-1&&zt.presenceGroupAddedByApiRTC.splice(rn,1)})):Tt.log("group parameter value is not correct, need to be a JSON array"),Tt.debug("this.presenceGroup :"+this.presenceGroup)},this.leavePresenceGroup=function(bt,Wt){var zt=this;Wt||((Wt={}).doneByApiRTC=!1),Tt.debug("leavePresenceGroup :"+bt),Mt(bt)===!0?bt.forEach(function(Bt){var rn=zt.presenceGroupAddedByApiRTC.indexOf(Bt);if(Wt.doneByApiRTC===!1||Wt.doneByApiRTC===!0&&rn!==-1){var gn=zt.presenceGroup.indexOf(Bt);gn!==-1&&zt.presenceGroup.splice(gn,1),zt.sendPresenceGroupManagementCommand("leave",[Bt])}rn!==-1&&zt.presenceGroupAddedByApiRTC.splice(rn,1)}):Tt.log("group parameter value is not correct, need to be a JSON array"),Tt.debug("this.presenceGroup :"+this.presenceGroup)},this.subscribePresenceGroup=function(bt,Wt){var zt=this;Wt||((Wt={}).doneByApiRTC=!1),Tt.debug("subscribePresenceGroup :"+bt),Mt(bt)===!0?(this.sendPresenceGroupManagementCommand("subscribe",bt),bt.forEach(function(Bt){var rn=zt.subscribeToPresenceGroupAddedByApiRTC.indexOf(Bt);zt.subscribeToPresenceGroup.indexOf(Bt)===-1&&(zt.subscribeToPresenceGroup.push(Bt),Wt.doneByApiRTC&&zt.subscribeToPresenceGroupAddedByApiRTC.indexOf(Bt)===-1&&zt.subscribeToPresenceGroupAddedByApiRTC.push(Bt)),Wt.doneByApiRTC===!1&&rn!==-1&&zt.subscribeToPresenceGroupAddedByApiRTC.splice(rn,1)})):Tt.log("group parameter value is not correct, need to be a JSON array"),Tt.debug("this.subscribeToPresenceGroup :"+this.subscribeToPresenceGroup)},this.unsubscribePresenceGroup=function(bt,Wt){var zt=this;Wt||((Wt={}).doneByApiRTC=!1),Tt.debug("unsubscribePresenceGroup :"+bt),Mt(bt)===!0?bt.forEach(function(Bt){var rn=zt.subscribeToPresenceGroupAddedByApiRTC.indexOf(Bt);if(Wt.doneByApiRTC===!1||Wt.doneByApiRTC===!0&&rn!==-1){var gn=zt.subscribeToPresenceGroup.indexOf(Bt);gn!==-1&&zt.subscribeToPresenceGroup.splice(gn,1),zt.sendPresenceGroupManagementCommand("unsubscribe",[Bt])}rn!==-1&&zt.subscribeToPresenceGroupAddedByApiRTC.splice(rn,1)}):Tt.log("group parameter value is not correct, need to be a JSON array"),Tt.debug("this.subscribeToPresenceGroup :"+this.subscribeToPresenceGroup)},this.joinConversationSpace=function(bt){Tt.info("joinConversationSpace :"+bt),this.sendConversationSpaceCommand("join",bt),this.conversationSpace=bt},this.leaveConversationSpace=function(bt){Tt.info("leaveConversationSpace :"+bt),bt!=null&&this.conversationSpace===bt?(this.sendConversationSpaceCommand("leave",bt),this.conversationSpace=null):Tt.debug("socket is not in the conversationSpace, we request to leave")},this.subscribeToCloudEvent=function(bt,Wt){this.sendCloudEventsCommand("subscribe",bt,Wt)},this.unsubscribeToCloudEvent=function(bt,Wt){this.sendCloudEventsCommand("unsubscribe",bt,Wt)},this.sendCloudEventsCommand=function(bt,Wt,zt){if(["subscribe","unsubscribe"].includes(bt))if(Wt&&typeof Wt=="string"){if(zt){if(mt(zt)!=="object")return void Tt.error("wrong headers format");for(var Bt=0,rn=Object.values(zt);Bt<rn.length;Bt++){var gn=rn[Bt];if(!gn||typeof gn!="string")return void Tt.error("wrong headers format")}}var tn={type:"cloudEvents",command:bt,topic:Wt};zt&&(tn.headers=zt);var Ht=JSON.stringify(tn);Tt.log("C->S:",Ht),this.channel.socket.emit("cloudEvents",Ht)}else Tt.error("wrong topic format");else Tt.error("wrong command")},this.getConversationList=function(bt){Tt.info("getConversationList request");var Wt,zt;zt=bt!==void 0?{type:"getConversationList",lastConversationNb:bt}:{type:"getConversationList",lastConversationNb:50},Wt=JSON.stringify(zt),Tt.log("C->S: "+Wt),this.channel.socket.emit("getConversationList",Wt)},this.receiveConversationListAnswer=function(bt){Tt.info("receiveConversationListAnswer"),Tt.log("msg.convList.length :"+bt.convList.length);var Wt,zt=bt.convList.length,Bt=[],rn=null;for(Wt=0;Wt<zt;Wt+=1)Tt.log("i ="+Wt),rn=JSON.parse(bt.convList[Wt]),Bt.push(rn);It.createReceiveConversationListAnswerEvent(Bt)},this.getContactOccurrencesFromConversationList=function(bt){Tt.info("getContactOccurrencesFromConversationList request");var Wt,zt;zt=bt!==void 0?{type:"getContactOccurrencesFromConversationList",lastConversationNb:bt}:{type:"getContactOccurrencesFromConversationList",lastConversationNb:50},Wt=JSON.stringify(zt),Tt.log("C->S: "+Wt),this.channel.socket.emit("getContactOccurrencesFromConversationList",Wt)},this.receiveContactOccurrencesFromConversationListAnswer=function(bt){Tt.info("receiveContactOccurrencesFromConversationListAnswer"),Tt.log("msg.contactOccurrencesTable.length :"+bt.contactOccurrencesTable.length),It.createReceiveContactOccurrencesFromConversationListAnswerEvent(bt.contactOccurrencesTable)},this.getConversationDetailReport=function(bt){var Wt,zt;Tt.info("getConversationDetailReport for convId :"+bt),Wt={type:"getConversationDetailReport",convId:bt},zt=JSON.stringify(Wt),Tt.log("C->S: "+zt),this.channel.socket.emit("getConversationDetailReport",zt)},this.receiveConversationDetailReportAnswer=function(bt){Tt.info("receiveConversationDetailReportAnswer"),Tt.log("msg.CDR :"+bt.CDR),It.createReceiveConversationDetailReportAnswerEvent(bt.CDR)},this.manageConnectedUsersList=function(bt,Wt,zt,Bt){Tt.debug("manageConnectedUsersList");var rn,gn,tn,Ht=!1,fn=0,bn=!1,In="unset";for(Tt.trace("manageConnectedUsersList.length :"+bt.length),Tt.trace("this.connectedUsersList.length :"+this.connectedUsersList.length),Tt.log("state :"+Wt),Tt.log("group :"+zt),tn=0;tn<bt.length;tn+=1)bt[tn].group=zt;if(Wt==="online")for(Tt.log("state : online"),rn=0;rn<bt.length;rn+=1){if(Tt.log("msgConnectedUsersListWithStatus  :"+rn),Ht=!1,this.connectedUsersList.length===0){Tt.log("this.connectedUsersList is empty"),this.connectedUsersList=bt,Tt.log("this.connectedUsersList[0].group :"+this.connectedUsersList[0].group),It.createConnectedUsersListUpdateEvent(zt,Bt,Wt,"newConnectionState");break}for(gn=0;gn<this.connectedUsersList.length;gn+=1)if(bn=!1,bt[rn].userId===this.connectedUsersList[gn].userId&&bt[rn].group===this.connectedUsersList[gn].group){Ht=!0,JSON.stringify(this.connectedUsersList[gn].userData)!==JSON.stringify(bt[rn].userData)&&(Tt.log("userData is updated"),this.connectedUsersList[gn].userData=bt[rn].userData,bn=!0,In="userDataUpdate"),this.connectedUsersList[gn].callState!==bt[rn].callState&&(Tt.log("callState is updated"),this.connectedUsersList[gn].callState=bt[rn].callState,bn=!0,In="callState"),bn===!0&&It.createConnectedUsersListUpdateEvent(zt,Bt,Wt,In);break}if(Ht===!1){Tt.log("Adding user in connectedUsersList :"+bt[rn].userId),this.connectedUsersList.push(bt[rn]);var un=[];un[0]=bt[rn].userId,It.createConnectedUsersListUpdateEvent(zt,un,Wt,"newConnectionState")}}else for(Tt.log("state : offline"),rn=0;rn<bt.length;rn+=1)for(Tt.log("msgConnectedUsersListWithStatus  :"+rn),fn=this.connectedUsersList.length,gn=0;gn<fn;gn+=1)if(bt[rn].userId===this.connectedUsersList[gn].userId&&bt[rn].group===this.connectedUsersList[gn].group){Tt.log("Removing user in connectedUsersList :"+bt[rn].userId),Tt.log("... in group :"+bt[rn].group),this.connectedUsersList.splice(gn,1),It.createConnectedUsersListUpdateEvent(zt,Bt,Wt,"newConnectionState");break}},this.removeGroupDataFromConnectedUsersList=function(bt){Tt.debug("removeGroupDataFromConnectedUsersList for group :",bt);var Wt,zt=this.connectedUsersList.length,Bt=[],rn=0;for(Tt.debug("this.connectedUsersList.length :",this.connectedUsersList.length),Wt=0;Wt<zt;Wt+=1)Tt.debug("this.connectedUsersList[j].group :",this.connectedUsersList[Wt-rn].group),Tt.debug("group :",bt),this.connectedUsersList[Wt-rn].group===bt&&(Tt.log("Removing user in connectedUsersList :"+this.connectedUsersList[Wt-rn].userId),Bt[0]=this.connectedUsersList[Wt-rn].userId,this.connectedUsersList.splice(Wt-rn,1),rn+=1,It.createConnectedUsersListUpdateEvent(bt,Bt,"offline","newConnectionState"))},this.getConnectedUsersList=function(bt){bt!==void 0?Tt.log("getConnectedUsersList for group : "+bt):Tt.log("getConnectedUsersList : complete users list");var Wt,zt=[];if(bt==null)return this.connectedUsersList;for(Tt.log("filtering list for group : "+bt),Wt=0;Wt<this.connectedUsersList.length;Wt+=1)this.connectedUsersList[Wt].group===bt&&zt.push(this.connectedUsersList[Wt]);return zt},this.isClientWebRtcCompliant=function(bt){var Wt,zt,Bt=null,rn=null;if(bt!==void 0)for(Wt=this.getConnectedUsersList(),zt=0;zt<Wt.length;zt++)Wt[zt].userId===bt&&(rn=Wt[zt].userData)!=null&&rn.webRtcCompliant!==void 0&&(Bt=rn.webRtcCompliant);return Bt},this.isClientDTLSCompliant=function(bt){var Wt,zt,Bt=!0,rn=null;if(bt!==void 0)for(Wt=this.getConnectedUsersList(),zt=0;zt<Wt.length;zt++)Wt[zt].userId===bt&&(rn=Wt[zt].userData,Tt.log("userData :",rn),rn!=null&&rn.dtlsCompliant!==void 0&&(Bt=rn.dtlsCompliant));return Bt},this.getConnectedUserIdsList=function(bt){Tt.info("getConnectedUserIdsList, group :",bt);var Wt,zt,Bt=[],rn=!1,gn={},tn=[];if(bt!==void 0?Tt.log("getConnectedUserIdsList for group : "+bt):Tt.log("getConnectedUserIdsList : complete users list"),bt==null)tn=JSON.parse(JSON.stringify(this.connectedUsersList));else for(Wt=0;Wt<this.connectedUsersList.length;Wt+=1)this.connectedUsersList[Wt].group===bt&&tn.push(this.connectedUsersList[Wt]);for(Wt=0;Wt<tn.length;Wt+=1){for(rn=!1,zt=0;zt<Bt.length;zt++)if(Bt[zt].userId===tn[Wt].userId){rn=!0;break}rn===!1&&((gn={}).userId=tn[Wt].userId,gn.callState=tn[Wt].callState,gn.userData=tn[Wt].userData,Bt.push(gn))}return Bt},this.getGroupsFromConnectedUsersList=function(bt){Tt.info("getGroupsFroConnectedUsersList");var Wt,zt=[],Bt=!1;for(Wt=0;Wt<this.connectedUsersList.length;Wt+=1)this.connectedUsersList[Wt].userId===bt&&(Tt.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[Wt].group)),Bt=!0,zt.push(this.connectedUsersList[Wt].group));return Bt===!0?JSON.stringify(zt):"User_Not_Found"},this.getConnectedUserInfo=function(bt,Wt){Tt.info("getConnectedUserInfo"),Tt.log("getConnectedUserInfo userId :",bt),Tt.log("getConnectedUserInfo infoType :",Wt);var zt,Bt=null,rn=null;switch(Wt){case"all":for(Tt.log("all"),zt=0;zt<this.connectedUsersList.length;zt+=1)if(this.connectedUsersList[zt].userId===bt)return Tt.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[zt])),Bt=this.getGroupsFromConnectedUsersList(bt),(rn=JSON.parse(JSON.stringify(this.connectedUsersList[zt]))).groups=Bt,delete rn.group,JSON.stringify(rn);break;case"callState":for(Tt.log("callState"),zt=0;zt<this.connectedUsersList.length;zt+=1)if(this.connectedUsersList[zt].userId===bt)return Tt.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[zt].callState)),this.connectedUsersList[zt].callState;break;case"userData":for(Tt.log("userData"),zt=0;zt<this.connectedUsersList.length;zt+=1)if(this.connectedUsersList[zt].userId===bt)return Tt.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[zt].userData)),JSON.stringify(this.connectedUsersList[zt].userData);break;case"groups":return Tt.log("groups"),this.getGroupsFromConnectedUsersList(bt);default:Tt.log("infoType not defined switch case : "+Wt)}return"User_Not_Found"},this.isConnectedUser=function(bt){Tt.info("isConnectedUser");var Wt,zt=!1;for(Wt=0;Wt<this.connectedUsersList.length;Wt+=1)if(Tt.log(JSON.stringify(this.connectedUsersList[Wt])),this.connectedUsersList[Wt].userId===bt)return zt=!0,Tt.log("isConnected :"+zt),zt;return Tt.log("isConnected :"+zt),zt},this.displayConnectedUsersList=function(){var bt;for(Tt.debug("displayConnectedUsersList"),bt=0;bt<this.connectedUsersList.length;bt+=1)Tt.log("User :"+this.connectedUsersList[bt].userId+" on group :"+this.connectedUsersList[bt].group)},this.updatePresence=function(bt){try{Tt.debug("updatePresence : ",JSON.stringify(bt))}catch(Wt){Tt.debug(Wt)}Tt.log("updatePresence for group :"+bt.group),this.manageConnectedUsersList(bt.connectedUsersListWithStatus,bt.state,bt.group,bt.connectedUsersList),It.createUpdatePresenceEvent(bt.connectedUsersList,bt.state,bt.connectedUsersListWithStatus)},this.processCloudEventOccurred=function(bt){Tt.debug("processCloudEventOccurred",bt),It.createCloudEventOccurredEvent(bt.event.type,bt.event.target)},this.updateUserStatus=function(bt){Tt.info("updateUserStatus"+bt),It.createUpdateUserStatusEvent(bt)},this.sendDebugCommand=function(bt,Wt,zt){Tt.info("sendDebugCommand :"+bt),new ft.S(this.channel.socket).sendDebugCommand("getClientSocketsInfo",Wt,zt)},this.processSignalingMessage=function(bt){var Wt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},zt=null,Bt=null,rn=!1,gn=null,tn=null,Ht=!1,fn=null;if(bt.type==="invite")this.apiCCWebRTCClient?(Tt.log("this.webRTCPluginActivated =",this.webRTCPluginActivated),(pt.Xh==="IE"||pt.Xh==="Safari"&&pt.PR<11)&&this.webRTCPluginActivated===!0?(Tt.log("managing call with WebRTC Plugin"),apiCC.manageWebRTCPlugin(function(){Tt.log("manageWebRTCPlugin cb on Invite"),apiCC.session.apiCCWebRTCClient.webRTCClient.processInvite(bt)},function(){Tt.log("actionOnInstallationNeeded"),Tt.log("sending bye to be done"),new ft.S(apiCC.session.channel.socket).sendBye(bt.callId,bt.calleeId,bt.roomId,bt.callerId,"WebRTC_Plugin_Installation_needed",bt.data)})):(Tt.log("managing call with browser"),this.apiCCWebRTCClient.webRTCClient.processInvite(bt))):Tt.warn("WebRTCClient is not created");else if(bt.type==="200OK")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.process200OK(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="candidate")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processCandidate(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="bye")this.apiCCWebRTCClient?(Tt.log("bye message from:"+bt.clientId+" for callId : "+bt.callId),this.apiCCWebRTCClient.webRTCClient.onRemoteHangup(bt.callId,bt.clientId,bt.roomId,bt.reason,bt.confId,bt.data)):Tt.warn("WebRTCClient is not created");else if(bt.type==="update")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processUpdate(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="200update")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.process200Update(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="newConversationCreated")this.apiCCIMClient?this.apiCCIMClient.newConversationCreated(bt):Tt.warn("IMClient is not created");else if(bt.type==="IMMessage")this.apiCCIMClient?this.apiCCIMClient.receiveMessage(bt):Tt.warn("IMClient is not created");else if(bt.type==="groupChatCreation")this.apiCCIMClient?this.apiCCIMClient.groupChatCreation(bt):Tt.warn("IMClient is not created");else if(bt.type==="groupChatInvitation")this.apiCCIMClient?this.apiCCIMClient.groupChatInvitation(bt):Tt.warn("IMClient is not created");else if(bt.type==="groupChatMemberUpdate")this.apiCCIMClient?this.apiCCIMClient.groupChatMemberUpdate(bt):Tt.warn("IMClient is not created");else if(bt.type==="addUserInGroupChatAnswer")this.apiCCIMClient?this.apiCCIMClient.addUserInGroupChatAnswer(bt):Tt.warn("IMClient is not created");else if(bt.type==="groupChatMessage")this.apiCCIMClient?this.apiCCIMClient.receiveGroupChatMessage(bt):Tt.warn("IMClient is not created");else if(bt.type==="conversationHistoryAnswer")this.apiCCIMClient?this.apiCCIMClient.receiveConversationHistory(bt):Tt.warn("IMClient is not created");else if(bt.type==="getUserDataAnswer")this.apiCCIMClient?this.apiCCIMClient.receiveUserDataAnswer(bt):Tt.warn("IMClient is not created");else if(bt.type==="fetchUserDataAnswer")this.apiCCIMClient?this.apiCCIMClient.receiveFetchUserDataAnswer(bt):Tt.warn("IMClient is not created");else if(bt.type==="dataMessage")this.apiCCDataClient?this.apiCCDataClient.receiveData(bt):Tt.warn("DataClient is not created");else if(bt.type==="dataAck")this.apiCCWebRTCClient.webRTCClient.processDataAck(bt);else if(bt.type==="dataEndAck")this.apiCCWebRTCClient.webRTCClient.processDataEndAck(bt);else if(bt.type==="updateVideoQuality")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processUpdateVideoQuality(bt.callId,bt.profile);else if(bt.type==="apiRTCDataMessage")if(Wt.quiet||Tt.debug("apiRTCDataMessage:",bt),(0,it.Ym)(bt.data,"object"))if(bt.data.type==="joinSessionAnswer")if(this.apiCCWebRTCClient){var bn={roomName:bt.data.roomId};(0,it.ki)(bt.data,"convId","string")&&(bn.convId=bt.data.convId),(0,it.ki)(bt.data,["data","mode"],"string")&&(bn.data={mode:bt.data.data.mode}),(0,it.ki)(bt.data,["data","transition"],"string")&&bt.data.data.transition==="mesh2janus"?this.apiCCWebRTCClient.webRTCClient.MCUClient.changeSessionMode(bn,"mesh2janus"):this.apiCCWebRTCClient.webRTCClient.MCUClient.updateSessionAnswer(bn,{createSession:!0})}else Tt.warn("WebRTCClient is not created");else if(bt.data.type==="slowLink"){if(this.apiCCWebRTCClient){var In={};bt.data.advice&&(In.advice=bt.data.advice),this.apiCCWebRTCClient.webRTCClient.processSlowLink(bt.data.callId,In)}}else if(bt.data.type==="videoQualityChanged")It.createVideoQualityChangedEvent(bt.data.callId,bt.data.roomId,bt.data.hint,bt.data.profile);else if(bt.data.type==="distantIceError")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processDistantIceError(bt.data);else if(bt.data.type==="streamTrackChanged")this.apiCCWebRTCClient&&bt.data.hasOwnProperty("mline")&&bt.data.hasOwnProperty("muted")&&this.apiCCWebRTCClient.webRTCClient.processStreamTrackMuteChanged(bt.data.callId,bt.data.mline,bt.data.muted);else if(bt.data.type==="streamTrackStatusChanged")this.apiCCWebRTCClient&&bt.data.hasOwnProperty("mline")&&bt.data.hasOwnProperty("change")&&bt.data.hasOwnProperty(bt.data.change)&&this.apiCCWebRTCClient.webRTCClient.processStreamTrackStatusChanged(bt.data.callId,bt.data.mline,bt.data[bt.data.change]);else if(bt.data.type==="configureEncodings")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processConfigureEncodings(bt.data);else if(bt.data.type==="activeSpeaker")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processAudioAmplitude(bt.data,!0);else if(bt.data.type==="stopSpeaking")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processAudioAmplitude(bt.data,!1);else if(bt.data.type==="updateStream")this.apiCCWebRTCClient&&bt.data.callId&&bt.data.mline&&bt.data.direction&&this.apiCCWebRTCClient.webRTCClient.processUpdateStream(bt.data.callId,bt.data.mline,bt.data.direction);else if(bt.data.type==="startRecording"){if(this.apiCCWebRTCClient)if(bt.data.callId==="COMPOSITE")this.apiCCWebRTCClient.webRTCClient.MCUClient.startCompositeRecording(bt.data.mediaType,bt.data.customIdInFilename,bt.data.convId,bt.data.data);else{for(fn=this.apiCCWebRTCClient.webRTCClient.callsTable.length;--fn>=0;)if(this.apiCCWebRTCClient.webRTCClient.callsTable[fn].callId===bt.data.callId){Ht=!0;break}Ht?this.apiCCWebRTCClient.webRTCClient.MCUClient.startRecording(bt.data.mediaType,bt.data.customIdInFilename,bt.data.convId,bt.data.callId,bt.data.data):Tt.info("cannot start recording (call not found)")}}else if(bt.data.type==="startStreaming"){if(this.apiCCWebRTCClient){for(fn=this.apiCCWebRTCClient.webRTCClient.callsTable.length;--fn>=0;)if(this.apiCCWebRTCClient.webRTCClient.callsTable[fn].callId===bt.data.callId){Ht=!0;break}Ht?this.apiCCWebRTCClient.webRTCClient.MCUClient.startStreaming(bt.data.service,bt.data.server,bt.data.streamKey,bt.data.callId):Tt.info("cannot start streaming (call not found)")}}else if(bt.data.type==="startCallStatsMonitoring"){if(this.apiCCWebRTCClient){for(Tt.debug("startCallStatsMonitoring",bt.data.callId),fn=this.apiCCWebRTCClient.webRTCClient.callsTable.length;--fn>=0;)if(this.apiCCWebRTCClient.webRTCClient.callsTable[fn].callId===bt.data.callId){Bt=this.apiCCWebRTCClient.webRTCClient.callsTable[fn];break}Bt?["chrome","firefox"].indexOf(it.wL.type)>=0?Bt.csmIntervalId?Tt.debug("call stats monitoring already started"):Bt.csmIntervalId=setInterval(Bt.callback(Bt,"csmHandler"),Bt.csmIntervalMs):Tt.debug("call stats are only supported on chrome and firefox"):Tt.debug("no such call")}}else bt.data.type==="callOrder"?(Tt.log("callOrder received"),this.apiCCWebRTCClient?(this.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector=bt.senderId,zt=this.apiCCWebRTCClient.webRTCClient.callWithNumber(bt.data.caller,!0,{MCUType:"MCU-Callee",confId:bt.data.confId,convId:bt.data.convId},gn),this.apiCCWebRTCClient.webRTCClient.myWebRTC_Event.createIncomingCallEvent(this.clientId,bt.data.caller,bt.data.caller,zt,!1,1,!1,"video",!0,"web","media")):Tt.warn("WebRTCClient is not created")):bt.data.type==="subscribeOrder"?(Tt.log("subscribeOrder received"),this.apiCCWebRTCClient?(this.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector=bt.senderId,bt.data.data.subscribeOrder=!0,(tn=[]).push(bt.data.stream),this.apiCCWebRTCClient.webRTCClient.MCUClient.subscribeToStreams(tn,"VIDEO",bt.data.data,gn,{noStreamCheck:!0})):Tt.warn("WebRTCClient is not created")):bt.data.type==="distantCallEstablished"?this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processDistantCallEstablished(bt.data):bt.data.type==="simulcastFeedChanged"?this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processSimulcastFeedChanged(bt.data):Tt.log("msg.data.type is not managed :"+bt.data.type);else Tt.log("msg.data === undefined");else if(bt.type==="conversationListAnswer")this.receiveConversationListAnswer(bt);else if(bt.type==="contactOccurrencesFromConversationListAnswer")this.receiveContactOccurrencesFromConversationListAnswer(bt);else if(bt.type==="conversationDetailReport")this.receiveConversationDetailReportAnswer(bt);else if(bt.type==="updatePresence")Tt.log("updatePresence"),this.updatePresence(bt);else if(bt.type==="updateUserStatus")Tt.log("updateUserStatus"),this.updateUserStatus(bt);else if(bt.type==="receiveMCUSessionId")Tt.log("receiveMCUSessionId"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.receiveSessionId(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="joinSessionAnswer")Tt.log("joinSessionAnswer"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.joinSessionAnswer(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="updateSessionAnswer")Tt.log("updateSessionAnswer"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.updateSessionAnswer(bt,{updateCalls:!0}):Tt.warn("WebRTCClient is not created");else if(bt.type==="availableStreams")this.apiCCWebRTCClient?(Tt.log("message availableStreams received"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.newAvailableStream(bt.msg,"regular",function(mn,yn,pn){It.createMCUAvailableStreamEvent([yn],mn)}):Tt.warn("WebRTCClient is not created")):Tt.warn("WebRTCClient is not created");else if(bt.type==="availableReplay")this.apiCCWebRTCClient?(Tt.log("message availableReplay received"),this.apiCCWebRTCClient?(rn=this.apiCCWebRTCClient.webRTCClient.MCUClient.newAvailableReplay(bt.msg),It.createMCUAvailableReplayEvent(bt.msg,rn)):Tt.warn("WebRTCClient is not created")):Tt.warn("WebRTCClient is not created");else if(bt.type==="availableComposite")this.apiCCWebRTCClient?(Tt.log("message availableComposite received"),this.apiCCWebRTCClient?(rn=this.apiCCWebRTCClient.webRTCClient.MCUClient.newAvailableStream(bt.msg,"composite"),It.createMCUAvailableCompositeEvent(bt.msg,rn)):Tt.warn("WebRTCClient is not created")):Tt.warn("WebRTCClient is not created");else if(bt.type==="onRemoveStream")this.apiCCWebRTCClient?(Tt.log("message onRemoveStream received:",bt),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.removeMCUStream(bt.callId,bt.msg.id,bt.msg.reason):Tt.warn("WebRTCClient is not created")):Tt.warn("WebRTCClient is not created");else if(bt.type==="availableStreamsUpdate")this.apiCCWebRTCClient?(Tt.log("message availableStreamsUpdate received"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.updateAvailableStream(bt.msg,"regular",function(mn,yn,pn,Tn){It.createMCUAvailableStreamUpdateEvent([yn],mn)}):Tt.warn("WebRTCClient is not created")):Tt.warn("WebRTCClient is not created");else if(bt.type==="checkCallStatus")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processCheckCallStatus(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="MCUSessionInvitation")Tt.log("MCUSessionInvitation"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.receiveSessionInvitation(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="MCUSessionInvitationToGroupChat")Tt.log("MCUSessionInvitationToGroupChat"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.receiveSessionInvitation(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="participantEjected")Tt.log("participantEjected"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.participantEjected(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="recordingStarted")Tt.log("recordingStarted"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.recordingStarted(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="recordingStopped")Tt.log("recordingStopped"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.recordingStopped(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="recordingStreamAvailable")Tt.log("recordingStreamAvailable"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.recordingStreamAvailable(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="streamingStarted")Tt.log("streamingStarted"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.streamingStarted(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="streamingStopped")Tt.log("streamingStopped"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.streamingStopped(bt):Tt.warn("WebRTCClient is not created");else if(bt.type==="sessionId")Tt.log("sessionId :"+bt.sessionId),this.sessionId=bt.sessionId,bt.JWTApzToken!==void 0&&this.handleJWTApzToken(bt.JWTApzToken);else if(bt.type==="JWTTokenRefreshAnswer")Tt.log("JWTTokenRefreshAnswer"),bt.JWTApzToken!==void 0&&this.handleJWTApzToken(bt.JWTApzToken);else if(bt.type==="roomCreation")Tt.log("roomCreation"),this.roomMgr.roomCreation(bt);else if(bt.type==="roomJoin")Tt.log("roomJoined"),this.roomMgr.roomJoin(bt);else if(bt.type==="inviteInRoomStatus")Tt.log("inviteInRoomStatus"),this.roomMgr.inviteInRoomStatus(bt);else if(bt.type==="contactListInRoom")Tt.log("contactListInRoom"),this.roomMgr.onContactListInRoom(bt);else if(bt.type==="roomInvitation")Tt.log("roomInvitation"),this.roomMgr.roomInvitation(bt);else if(bt.type==="roomMessage")Tt.log("roomMessage"),this.roomMgr.receiveRoomMessage(bt);else if(bt.type==="roomMemberUpdate")Tt.log("roomMemberUpdate"),this.roomMgr.roomMemberUpdate(bt);else if(bt.type==="agentReconnect"){var un=this.apiCCWebRTCClient.webRTCClient.findCallWithCallId(bt.callId);un!=null&&un.getUserMediaOnCall()}else bt.type==="sequence"?(Tt.log("Sequential message"),this.handleSequentialMessage(bt)):bt.type==="Ack"?Tt.log("Ack received"):bt.type==="receipt"?this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processReceipt(bt):bt.type==="error"?(Tt.log("error received"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processError(bt):It.createErrorEvent(bt.errorInfo,bt.errorCode,bt.callId,bt.roomId,null,null,bt.convId)):bt.type==="enterpriseConfig"?(Tt.log("enterpriseConfig received"),this.handleEnterpriseConfigMessage(bt)):bt.type==="AIEMessage"?(Tt.log("AIEMessage received"),this.handleAIEMessage(bt)):bt.type==="cloudEventOccurred"?this.processCloudEventOccurred(bt):Tt.log("Error : No type for this message")},this.handleSequentialMessage=function(bt){if(bt.id!==void 0&&bt.packetNum!==void 0&&bt.totalPacketsNum!==void 0&&bt.data!==void 0){Tt.debug("Handle sequential message packet "+bt.packetNum+"/"+bt.totalPacketsNum,bt);var Wt=[];if(Nt.sequentialMessagesStorage[bt.id]!==void 0&&(Wt=Nt.sequentialMessagesStorage[bt.id]),Wt.push(bt),Nt.sequentialMessagesStorage[bt.id]=Wt,Wt.length===bt.totalPacketsNum){Wt.sort(function(rn,gn){return rn.packetNum-gn.packetNum});var zt="";Wt.forEach(function(rn){zt+=rn.data}),delete Nt.sequentialMessagesStorage[bt.id];var Bt=null;try{Bt=JSON.parse(zt)}catch(rn){return void Tt.error("Error : can't parse sequential message JSON :",rn)}if(!Bt)return void Tt.error("Error : can't restore sequential message, it's null");Tt.debug("Restored sequential message :",zt),Nt.processSignalingMessage(Bt)}}else Tt.error("Error : sequential message is inconsistent :",bt)},this.handleEnterpriseConfigMessage=function(bt){if(Tt.debug("handleEnterpriseConfigMessage :",bt),(0,it.ki)(bt,"sentry","boolean")&&bt.sentry===!0){var Wt;Wt=window!==void 0&&window.location!==void 0&&window.location.protocol!==void 0&&window.location.protocol!=="https:"?"http":"https",apiCC.loadSentry(apiCC.initApiKey,Wt)}if((0,it.ki)(bt,"customJson","string")&&bt.customJson!=="")try{Tt.debug("customJson :",bt.customJson),bt.customJson=JSON.parse(bt.customJson)}catch(zt){Tt.error(zt)}if((0,it.ki)(bt,"iceServers","string")&&bt.iceServers!=="")try{Tt.debug("iceServers :",bt.iceServers),bt.iceServers=JSON.parse(bt.iceServers),Nt.apiCCWebRTCClient.setPcConfig(bt.iceServers)}catch(zt){Tt.error(zt)}(0,it.ki)(bt,"logLevel","string")&&bt.logLevel!==""&&!isNaN(parseInt(bt.logLevel))&&apiRTC.setLogLevel(parseInt(bt.logLevel)),(0,it.ki)(bt,"ccs","object")&&(Nt.ccsInfo=Object.assign({},bt.ccs))},this.handleAIEMessage=function(bt){switch(Tt.debug("handleAIEMessage :",bt),bt.detail){case"modelLoaded":if(apiCC!==void 0&&bt.userMediaStreamId!==void 0){var Wt=apiCC.getUserMediaStream(bt.userMediaStreamId).mediaFilterManager;for(var zt in Wt.filters)Wt.filters[zt]!==void 0&&Wt.filters[zt].streamAIE!==null&&Wt.filters[zt].streamAIE.modelLoaded(bt)}break;case"unknownModelName":Tt.error("Unknown model name :",bt.modelName);break;case"loadModelError":Tt.error("Error while loading model :",bt.info);break;default:Tt.debug("Unknown detail :",bt.detail)}},this.handleJWTApzToken=function(bt){Tt.debug("handleJWTApzToken :",bt),Nt.JWTApzToken=bt,Nt.cloudIsSecured===!0?(Tt.debug("Setting JWTApzToken on cloudAPI"),apiCC.CloudApi.setJWTApzToken(Nt.JWTApzToken)):Tt.debug("JWTApzToken is not set on cloudAPI"),Nt.JWTApzTokentimeOutId!==-1&&clearTimeout(Nt.JWTApzTokentimeOutId),Nt.JWTApzTokentimeOutId=setTimeout(function(){var Wt=JSON.stringify({type:"JWTTokenRefreshRequest"});Tt.log("C->S: "+Wt),apiCC.session.channel.socket.emit("JWTTokenRefreshRequest",Wt)},Nt.JWTApzTokenRefreshTimer)},this.fetchUserData=function(bt){var Wt,zt;Tt.debug("fetchUserData"),Wt={type:"fetchUserData",id:bt.id,apiKey:bt.apiKey,timeout:bt.timeout},zt=JSON.stringify(Wt),Tt.log("C->S: "+zt),this.channel.socket.emit("fetchUserData",zt)}}},7323:(at,ut,s)=>{s.d(ut,{q:()=>Lt}),s(4363),s(9653),s(3710),s(1539),s(9714),s(561),s(2564),s(4812),s(8309),s(9753),s(9554),s(4747),s(8674),s(7042),s(1038),s(8783),s(4916),s(2526),s(1817),s(2165),s(6992),s(3948);var et=s(1549),ot=s(5945),lt=s(4708);function St(Et,$t){for(var Jt=0;Jt<$t.length;Jt++){var en=$t[Jt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}s(2479),s(9070),s(8304),s(489),s(2419),s(8011);var pt=function(){function Et(){(function(en,qt){if(!(en instanceof qt))throw new TypeError("Cannot call a class as a function")})(this,Et)}var $t,Jt;return $t=Et,(Jt=[{key:"applyFilter",value:function(en,qt){}},{key:"release",value:function(){}}])&&St($t.prototype,Jt),Object.defineProperty($t,"prototype",{writable:!1}),Et}();function gt(Et,$t){return function(Jt){if(Array.isArray(Jt))return Jt}(Et)||function(Jt,en){var qt=Jt==null?null:typeof Symbol<"u"&&Jt[Symbol.iterator]||Jt["@@iterator"];if(qt!=null){var on,hn,nn=[],dn=!0,Sn=!1;try{for(qt=qt.call(Jt);!(dn=(on=qt.next()).done)&&(nn.push(on.value),!en||nn.length!==en);dn=!0);}catch(wn){Sn=!0,hn=wn}finally{try{dn||qt.return==null||qt.return()}finally{if(Sn)throw hn}}return nn}}(Et,$t)||function(Jt,en){if(Jt){if(typeof Jt=="string")return ct(Jt,en);var qt=Object.prototype.toString.call(Jt).slice(8,-1);return qt==="Object"&&Jt.constructor&&(qt=Jt.constructor.name),qt==="Map"||qt==="Set"?Array.from(Jt):qt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(qt)?ct(Jt,en):void 0}}(Et,$t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ct(Et,$t){($t==null||$t>Et.length)&&($t=Et.length);for(var Jt=0,en=new Array($t);Jt<$t;Jt++)en[Jt]=Et[Jt];return en}function ht(Et,$t){for(var Jt=0;Jt<$t.length;Jt++){var en=$t[Jt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}function it(Et,$t){var Jt;return Jt=(Et/=255)<.09804?.01894124847001224*Et:Et<.2?.5695370733621028*(Et-.09804)+.001857:Et<.298?1.292329661362709*(Et-.2)+.05993:Et<.4?1.5339348764221266*(Et-.298)+.1866:Et<.498?1.5697674418604652*(Et-.4)+.343:Et<.6?1.570223617104747*(Et-.498)+.4969:Et<.698?1.536107711138311*(Et-.6)+.657:Et<.8?1.2995292271479013*(Et-.698)+.8076:Et<.898?.5868013055895552*(Et-.8)+.9401:.023568065908199296*(Et-.898)+.9976,255*Math.pow(Jt,$t)}function ft(Et,$t){return 255*Math.pow(Et/255,$t)}s(9575),s(9743),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(7327);var mt=function(){function Et(en,qt,on){(function(hn,nn){if(!(hn instanceof nn))throw new TypeError("Cannot call a class as a function")})(this,Et),this.image=en,this.width=qt,this.height=on,this.length=this.width*this.height}var $t,Jt;return $t=Et,Jt=[{key:"mean",value:function(){var en=arguments.length>0&&arguments[0]!==void 0&&arguments[0],qt=0,on=0,hn=0;if(en)for(var nn=0;nn<this.length;nn++)qt+=Math.pow(this.image.data[4*nn+0],2)/(255*this.length),on+=Math.pow(this.image.data[4*nn+1],2)/(255*this.length),hn+=Math.pow(this.image.data[4*nn+2],2)/(255*this.length);else for(var dn=0;dn<this.length;dn++)qt+=this.image.data[4*dn+0]/this.length,on+=this.image.data[4*dn+1]/this.length,hn+=this.image.data[4*dn+2]/this.length;return[qt,on,hn]}},{key:"mad",value:function(){var en=arguments.length>0&&arguments[0]!==void 0&&arguments[0],qt=this.mean(en),on=gt(qt,3),hn=on[0],nn=on[1],dn=on[2],Sn=0,wn=0,En=0;if(en)for(var Pn=0;Pn<this.length;Pn++)Sn+=Math.abs(Math.pow(this.image.data[4*Pn+0],2)/255-hn)/this.length,wn+=Math.abs(Math.pow(this.image.data[4*Pn+1],2)/255-nn)/this.length,En+=Math.abs(Math.pow(this.image.data[4*Pn+2],2)/255-dn)/this.length;else for(var Wn=0;Wn<this.length;Wn++)Sn+=Math.abs(this.image.data[4*Wn+0]-hn)/this.length,wn+=Math.abs(this.image.data[4*Wn+1]-nn)/this.length,En+=Math.abs(this.image.data[4*Wn+2]-dn)/this.length;return[Sn,wn,En]}},{key:"std",value:function(){var en=arguments.length>0&&arguments[0]!==void 0&&arguments[0],qt=this.mean(en),on=gt(qt,3),hn=on[0],nn=on[1],dn=on[2],Sn=0,wn=0,En=0;if(en)for(var Pn=0;Pn<this.length;Pn++)Sn+=Math.pow(Math.pow(this.image.data[4*Pn+0],2)/255-hn,2)/this.length,wn+=Math.pow(Math.pow(this.image.data[4*Pn+1],2)/255-nn,2)/this.length,En+=Math.pow(Math.pow(this.image.data[4*Pn+2],2)/255-dn,2)/this.length;else for(var Wn=0;Wn<this.length;Wn++)Sn+=Math.pow(this.image.data[4*Wn+0]-hn,2)/this.length,wn+=Math.pow(this.image.data[4*Wn+1]-nn,2)/this.length,En+=Math.pow(this.image.data[4*Wn+2]-dn,2)/this.length;return[Sn=Math.sqrt(Sn),wn=Math.sqrt(wn),En=Math.sqrt(En)]}},{key:"blur",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:5,qt=new OffscreenCanvas(this.width,this.height),on=qt.getContext("2d");qt.width=this.width,qt.height=this.height,on.putImageData(this.image,0,0),on.filter="blur("+en+"px)",on.drawImage(qt,0,0);var hn=on.getImageData(0,0,this.width,this.height);return hn}},{key:"threshold",value:function(en,qt,on){var hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,nn=arguments.length>4&&arguments[4]!==void 0&&arguments[4],dn=new ImageData(this.image.data,this.width,this.height),Sn=0;if(nn){var wn=Sn;Sn=hn,hn=wn}for(var En=0;En<this.length;En++)this.image.data[4*En+0]<en?dn.data[4*En+0]=Sn:dn.data[4*En+0]=hn,this.image.data[4*En+1]<qt?dn.data[4*En+1]=Sn:dn.data[4*En+1]=hn,this.image.data[4*En+2]<on?dn.data[4*En+2]=Sn:dn.data[4*En+2]=hn;return dn}},{key:"powerFilter",value:function(en){var qt=new Uint8ClampedArray(4*this.length);if(en===1)return this.image;for(var on=0;on<this.length;on++)qt[4*on+0]=ft(this.image.data[4*on+0],en),qt[4*on+1]=ft(this.image.data[4*on+1],en),qt[4*on+2]=ft(this.image.data[4*on+2],en),qt[4*on+3]=255;return new ImageData(qt,this.width,this.height)}},{key:"sigmoidFilter",value:function(en){for(var qt=new Uint8ClampedArray(4*this.length),on=0;on<this.length;on++)qt[4*on+0]=it(this.image.data[4*on+0],en),qt[4*on+1]=it(this.image.data[4*on+1],en),qt[4*on+2]=it(this.image.data[4*on+2],en),qt[4*on+3]=255;return new ImageData(qt,this.width,this.height)}},{key:"weightedSum",value:function(en,qt){for(var on=new Uint8ClampedArray(4*this.length),hn=0;hn<this.length;hn++)on[4*hn+0]=qt*this.image.data[4*hn+0]+(1-qt)*en.data[4*hn+0],on[4*hn+1]=qt*this.image.data[4*hn+1]+(1-qt)*en.data[4*hn+1],on[4*hn+2]=qt*this.image.data[4*hn+2]+(1-qt)*en.data[4*hn+2],on[4*hn+3]=255;return new ImageData(on,this.width,this.height)}},{key:"weightedSumMask",value:function(en,qt){for(var on=new Uint8ClampedArray(4*this.length),hn=0;hn<this.length;hn++){var nn=qt.data[4*hn]/255;on[4*hn+0]=nn*this.image.data[4*hn+0]+(1-nn)*en.data[4*hn+0],on[4*hn+1]=nn*this.image.data[4*hn+1]+(1-nn)*en.data[4*hn+1],on[4*hn+2]=nn*this.image.data[4*hn+2]+(1-nn)*en.data[4*hn+2],on[4*hn+3]=255}return new ImageData(on,this.width,this.height)}}],Jt&&ht($t.prototype,Jt),Object.defineProperty($t,"prototype",{writable:!1}),Et}();function Tt(Et,$t){if(!(Et instanceof $t))throw new TypeError("Cannot call a class as a function")}function It(Et,$t){for(var Jt=0;Jt<$t.length;Jt++){var en=$t[Jt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}var Pt=function(){function Et(){var en=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],qt=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],on=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;Tt(this,Et),this.blurMask=en,this.smoothBorder=qt,this.blurFactor=on,this.smoothingFactor=hn,this.maskImage=null,this.net=null}var $t,Jt;return $t=Et,Jt=[{key:"loadModel",value:function(){var en=this;return new Promise(function(qt,on){bodyPix.load({architecture:"MobileNetV1",outputStride:16,multiplier:.75,quantBytes:2}).then(function(hn){en.net=hn,qt()})})}},{key:"computeMask",value:function(en){var qt=this;return new Promise(function(on,hn){qt.net.segmentPerson(en).then(function(nn){qt.width=nn.width,qt.height=nn.height,qt.length=qt.width*qt.height;for(var dn=new Uint8ClampedArray(4*qt.length),Sn=0;Sn<qt.length;Sn++){var wn=255*nn.data[Sn];dn[4*Sn+0]=wn,dn[4*Sn+1]=wn,dn[4*Sn+2]=wn,dn[4*Sn+3]=255}var En=document.createElement("canvas"),Pn=En.getContext("2d");En.width=qt.width,En.height=qt.height;var Wn=new ImageData(dn,qt.width,qt.height);if(Pn.putImageData(Wn,0,0),qt.blurMask&&(Pn.filter="blur("+qt.blurFactor+"px)"),Pn.drawImage(En,0,0,qt.width,qt.height),qt.maskImage=Pn.getImageData(0,0,qt.width,qt.height),qt.blurMask)if(qt.smoothBorder){if(qt.smoothingFactor!==-1){var ir=new mt(qt.maskImage,qt.width,qt.height);qt.maskImage=ir.sigmoidFilter(qt.smoothingFactor)}}else{var fr=new mt(qt.maskImage,qt.width,qt.height);qt.maskImage=fr.threshold(40,40,40,255,!1)}on(qt.maskImage)})})}},{key:"applyTransparency",value:function(en){var qt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;qt===null&&(qt=this.maskImage);for(var on=new Uint8ClampedArray(en.width*en.height*4),hn=0;hn<en.width*en.height;hn++)on[4*hn+0]=en.data[4*hn+0],on[4*hn+1]=en.data[4*hn+1],on[4*hn+2]=en.data[4*hn+2],on[4*hn+3]=qt.data[4*hn];var nn=new ImageData(on,en.width,en.height);return nn}},{key:"superposeImages",value:function(en,qt,on){var hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;hn===null&&(hn=this.maskImage);var nn=new mt(qt,en.width,en.height),dn=nn.weightedSumMask(on,hn);return dn}},{key:"setBackground",value:function(en,qt){var on=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.superposeImages(en,en,qt,on)}},{key:"blurBackground",value:function(en){var qt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,on=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,hn=new mt(en,en.width,en.height),nn=hn.blur(qt);return this.setBackground(en,nn,on)}}],Jt&&It($t.prototype,Jt),Object.defineProperty($t,"prototype",{writable:!1}),Et}();function At(Et,$t){if(!(Et instanceof $t))throw new TypeError("Cannot call a class as a function")}function Nt(Et,$t){for(var Jt=0;Jt<$t.length;Jt++){var en=$t[Jt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}var Ot=et.Y.get("StreamSegmentation"),Mt=apiCC.myWebRTC_Event,bt=function(){function Et(en){var qt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:480,on=arguments.length>2&&arguments[2]!==void 0?arguments[2]:360,hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;At(this,Et),this.mediaStream=en,this.backgroundMode="none",this.backgroundBlurFactor=10,this.canvasWidth=qt,this.canvasHeight=on,this.length=this.canvasWidth*this.canvasHeight,this.userMediaStreamId=hn;for(var nn=new Uint8ClampedArray(4*this.length),dn=0;dn<4*this.length;dn++)nn[dn]=255;this.backgroundImage=new ImageData(nn,this.canvasWidth,this.canvasHeight);var Sn=!0,wn=!0,En=5,Pn=-1;this.backSub=new Pt(Sn,wn,En,Pn),this.modelLoaded=!1,this.maskStreamLaunched=!1,this.backgroundSubtractionActivated=!1}var $t,Jt;return $t=Et,Jt=[{key:"setBackgroundMode",value:function(en){this.backgroundMode=en}},{key:"setBackgroundImage",value:function(en){this.backgroundImage=en}},{key:"setBackgroundBlurFactor",value:function(en){this.backgroundBlurFactor=en}},{key:"loadModel",value:function(){Ot.debug("Loading model");var en=this;return new Promise(function(qt,on){en.backSub.loadModel().then(function(hn){en.modelLoaded=!0,Ot.debug("Model loaded"),qt()})})}},{key:"getMaskStream",value:function(){var en=document.createElement("video");en.srcObject=this.mediaStream;var qt=document.createElement("canvas"),on=qt.getContext("2d");qt.width=this.canvasWidth,qt.height=this.canvasHeight;var hn=document.createElement("canvas"),nn=hn.getContext("2d");hn.width=this.canvasWidth,hn.height=this.canvasHeight;var dn=this;en.addEventListener("loadeddata",function(){en.play(),requestAnimationFrame(gr),dn.modelLoaded?Wn=!0:dn.loadModel().then(function(yr){Wn=!0})});for(var Sn=!0,wn=new Uint8ClampedArray(4*this.length),En=0;En<4*this.length;En++)wn[En]=255;var Pn=new ImageData(wn,this.canvasWidth,this.canvasHeight);nn.putImageData(Pn,0,0);var Wn=!1,ir=0,fr=!0;function gr(){on.drawImage(en,0,0,qt.width,qt.height);var yr=on.getImageData(0,0,qt.width,qt.height);if(dn.modelLoaded&&Sn&&Wn&&(fr||dn.backgroundMode!=="none")){fr&&(fr=!1);var Rr=new Date;Sn=!1,dn.backSub.computeMask(yr).then(function(kr){Sn=!0,1/((new Date-Rr)/1e3)<1&&++ir>=10&&(Wn=!1,Ot.error("The segmentation process cannot be handled"),Mt.createBackgroundSubstractionStopComputeTimeEvent(dn.userMediaStreamId))})}dn.modelLoaded&&dn.backSub.maskImage!==null&&Wn?nn.putImageData(dn.backSub.maskImage,0,0):nn.putImageData(Pn,0,0),dn.continueMaskComputation?requestAnimationFrame(gr):(Ot.debug("Mask computation stoped"),dn.continueMaskComputation=!0)}return this.continueMaskComputation=!0,this.maskMediaStream=hn.captureStream(),this.maskStreamLaunched=!0,this.maskMediaStream}},{key:"activateBackgroundSubtraction",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(en!==null&&this.setBackgroundMode(en),this.backgroundSubtractionActivated)return this.processedMediaStream;this.maskStreamLaunched||this.getMaskStream();var qt=document.createElement("video");qt.srcObject=this.mediaStream;var on=document.createElement("video");on.srcObject=this.maskMediaStream;var hn=document.createElement("canvas"),nn=hn.getContext("2d");hn.width=this.canvasWidth,hn.height=this.canvasHeight;var dn=document.createElement("canvas"),Sn=dn.getContext("2d");dn.width=this.canvasWidth,dn.height=this.canvasHeight,this.continueBackgroundSubtraction=!0;var wn=this;function En(){nn.drawImage(qt,0,0,hn.width,hn.height);var Pn=nn.getImageData(0,0,hn.width,hn.height);if(wn.backgroundMode==="none")Sn.putImageData(Pn,0,0);else{nn.drawImage(on,0,0,hn.width,hn.height);var Wn=nn.getImageData(0,0,hn.width,hn.height),ir=null;switch(wn.backgroundMode){case"image":ir=wn.backSub.setBackground(Pn,wn.backgroundImage,Wn);break;case"blur":default:ir=wn.backSub.blurBackground(Pn,wn.backgroundBlurFactor,Wn);break;case"transparent":ir=wn.backSub.applyTransparency(Pn,Wn)}Sn.putImageData(ir,0,0)}wn.continueBackgroundSubtraction?requestAnimationFrame(En):(Ot.debug("Mask application stoped"),wn.continueBackgroundSubtraction=!0)}return qt.addEventListener("loadeddata",function(){qt.play(),on.play(),requestAnimationFrame(En)}),this.processedMediaStream=dn.captureStream(30),this.backgroundSubtractionActivated=!0,this.processedMediaStream}},{key:"deactivateBackgroundSubtraction",value:function(){this.setBackgroundMode("none"),this.processedMediaStream=this.mediaStream,this.backgroundSubtractionActivated=!1,this.continueBackgroundSubtraction=!1,this.maskMediaStream=null,this.maskStreamLaunched=!1,this.continueMaskComputation=!1}}],Jt&&Nt($t.prototype,Jt),Object.defineProperty($t,"prototype",{writable:!1}),Et}();function Wt(Et){return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($t){return typeof $t}:function($t){return $t&&typeof Symbol=="function"&&$t.constructor===Symbol&&$t!==Symbol.prototype?"symbol":typeof $t},Wt(Et)}function zt(Et,$t){for(var Jt=0;Jt<$t.length;Jt++){var en=$t[Jt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}function Bt(Et,$t){return Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Jt,en){return Jt.__proto__=en,Jt},Bt(Et,$t)}function rn(Et,$t){if($t&&(Wt($t)==="object"||typeof $t=="function"))return $t;if($t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Jt){if(Jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Jt}(Et)}function gn(Et){return gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function($t){return $t.__proto__||Object.getPrototypeOf($t)},gn(Et)}var tn=et.Y.get("OldMediaFilterBackgroundSubtraction"),Ht=function(Et){(function(nn,dn){if(typeof dn!="function"&&dn!==null)throw new TypeError("Super expression must either be null or a function");nn.prototype=Object.create(dn&&dn.prototype,{constructor:{value:nn,writable:!0,configurable:!0}}),Object.defineProperty(nn,"prototype",{writable:!1}),dn&&Bt(nn,dn)})(hn,Et);var $t,Jt,en,qt,on=(en=hn,qt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var nn,dn=gn(en);if(qt){var Sn=gn(this).constructor;nn=Reflect.construct(dn,arguments,Sn)}else nn=dn.apply(this,arguments);return rn(this,nn)});function hn(){var nn;return function(dn,Sn){if(!(dn instanceof Sn))throw new TypeError("Cannot call a class as a function")}(this,hn),(nn=on.call(this)).streamSegmentation=null,nn.userMediaStreamId=null,nn}return $t=hn,(Jt=[{key:"applyFilter",value:function(nn,dn){var Sn=this;tn.debug("Apply filter with descriptor:",dn);var wn=nn.getAudioTracks();wn.length>0&&wn.forEach(function(Wn){nn.removeTrack(Wn)});var En=nn.getVideoTracks();if(En.length===0)return Promise.reject("MediaStream has no video tracks");var Pn=En[0].getSettings();return dn.options!==void 0&&dn.options.userMediaStreamId!==void 0&&(this.userMediaStreamId=dn.options.userMediaStreamId),this.streamSegmentation=new bt(nn,Pn.width,Pn.height,this.userMediaStreamId),this.loadTensorflow().then(function(Wn){return Sn.loadTensorflowModel()}).then(function(Wn){return new Promise(function(ir,fr){tn.debug("Model loading..."),Sn.streamSegmentation.loadModel().then(function(gr){tn.debug("Model loaded");var yr=null;dn.options!==void 0&&dn.options.backgroundMode!==void 0&&(dn.options.backgroundMode==="image"&&dn.options.image instanceof ImageData&&Sn.streamSegmentation.setBackgroundImage(dn.options.image),yr=dn.options.backgroundMode);var Rr=Sn.streamSegmentation.activateBackgroundSubtraction(yr);wn.forEach(function(kr){Rr.addTrack(kr)}),ir(Rr)})})}).catch(function(Wn){return Promise.reject(Wn)})}},{key:"release",value:function(){this.streamSegmentation.deactivateBackgroundSubtraction(),this.streamSegmentation=null}},{key:"loadTensorflow",value:function(){return tn.debug("Tensorflow script loading..."),new Promise(function(nn,dn){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){tn.debug("Tensorflow script loaded"),nn()},error:function(wn){dn("Resources loading failed, depsNotFound: "+wn)},retrycb:function(wn,En){tn.warn("Tensorflow loading retry :"+wn+" ,delay before retry :"+En)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.2"],"tensorflow",Sn)})}},{key:"loadTensorflowModel",value:function(){return tn.debug("Tensorflow model script loading..."),new Promise(function(nn,dn){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){tn.debug("Tensorflow model script loaded"),nn()},error:function(wn){dn("Resources loading failed, depsNotFound: "+wn)},retrycb:function(wn,En){tn.warn("Tensorflow model loading retry :"+wn+" ,delay before retry :"+En)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.0"],"tensorflow-model",Sn)})}}])&&zt($t.prototype,Jt),Object.defineProperty($t,"prototype",{writable:!1}),hn}(pt);function fn(Et,$t){var Jt=typeof Symbol<"u"&&Et[Symbol.iterator]||Et["@@iterator"];if(!Jt){if(Array.isArray(Et)||(Jt=function(dn,Sn){if(dn){if(typeof dn=="string")return bn(dn,Sn);var wn=Object.prototype.toString.call(dn).slice(8,-1);return wn==="Object"&&dn.constructor&&(wn=dn.constructor.name),wn==="Map"||wn==="Set"?Array.from(dn):wn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(wn)?bn(dn,Sn):void 0}}(Et))||$t&&Et&&typeof Et.length=="number"){Jt&&(Et=Jt);var en=0,qt=function(){};return{s:qt,n:function(){return en>=Et.length?{done:!0}:{done:!1,value:Et[en++]}},e:function(dn){throw dn},f:qt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var on,hn=!0,nn=!1;return{s:function(){Jt=Jt.call(Et)},n:function(){var dn=Jt.next();return hn=dn.done,dn},e:function(dn){nn=!0,on=dn},f:function(){try{hn||Jt.return==null||Jt.return()}finally{if(nn)throw on}}}}function bn(Et,$t){($t==null||$t>Et.length)&&($t=Et.length);for(var Jt=0,en=new Array($t);Jt<$t;Jt++)en[Jt]=Et[Jt];return en}function In(Et){return(Et[2]-Et[0])*(Et[3]-Et[1])}function un(Et,$t){var Jt=Et[0],en=Et[1],qt=Et[2],on=Et[3],hn=$t[0],nn=$t[1],dn=$t[2],Sn=$t[3],wn=In([Math.max(Jt,hn),Math.max(en,nn),Math.min(qt,dn),Math.min(on,Sn)]);return wn/(In(Et)+In($t)-wn)}function mn(Et){var $t,Jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.2,en=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,qt=Et.yolo,on={yolo:[]},hn=fn(qt);try{for(hn.s();!($t=hn.n()).done;){var nn=$t.value,dn=nn.objectness;if(dn>Jt)if(en!==null){var Sn,wn=nn.bounding_box,En=In(wn),Pn=0,Wn=null,ir=0,fr=fn(qt);try{for(fr.s();!(Sn=fr.n()).done;){var gr=Sn.value,yr=gr.bounding_box,Rr=un(wn,yr);Rr!==1&&Rr>Pn&&(Pn=Rr,Wn=gr,ir=In(gr.bounding_box))}}catch(kr){fr.e(kr)}finally{fr.f()}(Wn===null||Pn<en||ir<En)&&on.yolo.push(nn)}else on.yolo.push(nn)}}catch(kr){hn.e(kr)}finally{hn.f()}return on}function yn(Et,$t){var Jt,en=Et.yolo,qt={yolo:[]},on=fn($t.yolo);try{for(on.s();!(Jt=on.n()).done;){var hn,nn=Jt.value,dn=nn.class,Sn=nn.bounding_box,wn=nn.objectness,En=wn,Pn=fn(en);try{for(Pn.s();!(hn=Pn.n()).done;){var Wn=hn.value;if(Wn.class===dn){var ir=un(Wn.bounding_box,Sn);ir>0&&(En=wn+.75*(1-wn)*ir*Wn.objectness)}}}catch(gr){Pn.e(gr)}finally{Pn.f()}var fr={class:dn,objectness:En,bounding_box:Sn};qt.yolo.push(fr)}}catch(gr){on.e(gr)}finally{on.f()}return qt}function pn(Et,$t){return function(Jt){if(Array.isArray(Jt))return Jt}(Et)||function(Jt,en){var qt=Jt==null?null:typeof Symbol<"u"&&Jt[Symbol.iterator]||Jt["@@iterator"];if(qt!=null){var on,hn,nn=[],dn=!0,Sn=!1;try{for(qt=qt.call(Jt);!(dn=(on=qt.next()).done)&&(nn.push(on.value),!en||nn.length!==en);dn=!0);}catch(wn){Sn=!0,hn=wn}finally{try{dn||qt.return==null||qt.return()}finally{if(Sn)throw hn}}return nn}}(Et,$t)||function(Jt,en){if(Jt){if(typeof Jt=="string")return Tn(Jt,en);var qt=Object.prototype.toString.call(Jt).slice(8,-1);return qt==="Object"&&Jt.constructor&&(qt=Jt.constructor.name),qt==="Map"||qt==="Set"?Array.from(Jt):qt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(qt)?Tn(Jt,en):void 0}}(Et,$t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Tn(Et,$t){($t==null||$t>Et.length)&&($t=Et.length);for(var Jt=0,en=new Array($t);Jt<$t;Jt++)en[Jt]=Et[Jt];return en}function kn(Et,$t){for(var Jt=0;Jt<$t.length;Jt++){var en=$t[Jt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}s(3123),s(4723),s(2472),s(6699),s(2023),s(9720),s(9600),s(2707),s(1058);var xn=et.Y.get("StreamAIE"),Mn=apiCC.myWebRTC_Event,Dn=function(){function Et(en,qt){(function(hn,nn){if(!(hn instanceof nn))throw new TypeError("Cannot call a class as a function")})(this,Et),this.mediaStream=en,this.descriptorOptions=qt,this.modelName=qt.modelName,this.maxBoxes=qt.maxBoxes||null,this.scoreThresh=qt.scoreThresh||null,this.forceReload=qt.forceReload||!1,this.classFilter=this.descriptorOptions.classFilter||"all",this.drawingConfig=this.descriptorOptions.drawingConfig||{},this.userMediaStreamId=qt.userMediaStreamId,this.clientId=qt.clientId;var on=this.mediaStream.getVideoTracks();on.length===0&&(this.mediaSettings=null),this.mediaSettings=on[0].getSettings(),this.canvasWidth=this.mediaSettings.width||480,this.canvasHeight=this.mediaSettings.height||480,this.length=this.canvasWidth*this.canvasHeight,this.snapshot=!1,this.log=!1,this.minSnapshotPeriod=0,this.memoryTime=0,this.lastAnnotations={yolo:[]},this.lastRawAnnotations={yolo:[]},this.objectDetectionActivated=!1,this.drawAnnotationsBool=!1,this.aieUrl=null,this.token=null,this.loadedModel=null,this.promises=[],this.isReleased=!1,this.resinzingSize=416,this.callId=null}var $t,Jt;return $t=Et,Jt=[{key:"activateLogs",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.memoryTime=en,this.log=!0}},{key:"stopLogs",value:function(){this.log=!1,this.memoryTime=0}},{key:"activateSnapshots",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.snapshot=!0,this.minSnapshotPeriod=en}},{key:"stopSnapshots",value:function(){this.snapshot=!1,this.minSnapshotPeriod=0}},{key:"activateAnnotations",value:function(){this.lastAnnotations={yolo:[]},this.drawAnnotationsBool=!0,this.getAnnotations()}},{key:"stopAnnotations",value:function(){this.drawAnnotationsBool=!1}},{key:"getAnnotations",value:function(){var en=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],qt=document.createElement("video");qt.srcObject=this.mediaStream;var on=document.createElement("canvas"),hn=on.getContext("2d");on.width=this.canvasWidth,on.height=this.canvasHeight;var nn=document.createElement("canvas"),dn=nn.getContext("2d");nn.width=this.canvasWidth,nn.height=this.canvasHeight;var Sn=this;function wn(Sr,Nr){for(var wr=Sr.split(","),Ar=wr[0].match(/:(.*?);/)[1],Lr=atob(wr[1]),Hr=Lr.length,na=new Uint8Array(Hr);Hr--;)na[Hr]=Lr.charCodeAt(Hr);return new File([na],Nr,{type:Ar})}qt.addEventListener("loadeddata",function(){qt.play(),requestAnimationFrame(function(){Yr(Sn.aieUrl,Sn.token,Sn.loadedModel)})});var En=!0,Pn={},Wn=null,ir=new Date;function fr(Sr,Nr,wr){var Ar=wn(on.toDataURL("image/jpeg")),Lr={pipelineCallId:Sn.getOrCreatePipeline(),file:Ar,transferType:"plugin",pluginName:"httpPost",pluginData:{url:Sr,headers:{Authorization:"Token "+Nr},formData:{file:"$DATA",angled:1,model:wr,size:Sn.resinzingSize}}};apiCC.session.apiCCWebRTCClient.webRTCClient.pushData(null,Lr,null,{success:function(Hr){var na=(new Date-Wn)/1e3,Vn=1/na;return xn.debug("Computation time:",na,"s ,FPS:",Vn),Yr(Sr,Nr,wr),Hr.data.error!==void 0?xn.error("http post error :",Hr.data.error):Hr.data.result===void 0?xn.error("An error occured when trying to annotate a snapshot"):void gr(Hr.data)},failure:function(Hr,na,Vn){xn.error("## pushData:failure",na,Vn,Hr)}})}function gr(Sr){var Nr=Sr.result;Sn.isReleased||(Sn.lastRawAnnotations=Nr,Nr.yolo!==void 0&&Rr(Nr),Nr.ocr===void 0&&Nr.codes===void 0||yr(Nr))}function yr(Sr){Sn.lastAnnotations={ocr:Sr.ocr,codes:Sr.codes};var Nr="";if(Sr.ocr.length>1){Nr+="Words found : ";for(var wr=0;wr<Sr.ocr.length;wr++)Nr=Nr+Sr.ocr[wr].text+", "}if(Sr.codes.length>1){Nr+="Codes found : ";for(var Ar=0;Ar<Sr.codes.length;Ar++)Nr=Nr+Sr.codes[Ar].code+", "}kr(Nr),Qr()}function Rr(Sr){Sr.yolo.length>0&&(en&&(Sr=yn(Sn.lastRawAnnotations,Sr)),Sn.scoreThresh!==null&&(Sr=mn(Sr,Sn.scoreThresh)));for(var Nr={yolo:[]},wr={},Ar=Sn.classFilter.split(", "),Lr=0;Lr<Sr.yolo.length;Lr++){var Hr=Sr.yolo[Lr];(Sn.classFilter==="all"||Ar.includes(Hr.class))&&(Hr.class in wr||(wr[Hr.class]=0),wr[Hr.class]+=1,Nr.yolo.push(Hr))}if(Sr=Nr,Sn.lastAnnotations=Sr,Sn.log||Sn.snapshot){for(var na=new Date,Vn=[],ar=0,Hn=Object.entries(wr);ar<Hn.length;ar++){var vr=pn(Hn[ar],2),qn=vr[0],jr=vr[1];Vn.push(jr+" "+qn+"(s) detected."),(!(qn in Pn)||na-Pn[qn]>1e3*Sn.memoryTime)&&(Pn[qn]=na)}var _r=Vn.sort().join(" ");_r!==""&&(kr(_r),Qr())}}function kr(Sr){Sn.log&&Mn.createAIELogEvent(Sn.userMediaStreamId,Sr)}function Qr(){if(Sn.snapshot){var Sr=new Date,Nr=hn.getImageData(0,0,on.width,on.height);if(Sr-ir>1e3*Sn.minSnapshotPeriod){dn.putImageData(Nr,0,0),Sn.drawAnnotations(Sn.lastAnnotations,dn,Sn.drawingConfig);var wr=nn.toDataURL("image/png"),Ar=new Image;Ar.src=wr,Mn.createAIESnapshotEvent(Sn.userMediaStreamId,Ar),ir=Sr}}}function Yr(Sr,Nr,wr){hn.drawImage(qt,0,0,on.width,on.height),(En||Sn.drawAnnotationsBool)&&(En&&(En=!1),Wn=new Date,fr(Sr,Nr,wr))}}},{key:"getOrCreatePipeline",value:function(){if(this.callId!==null)return this.callId;var en=this;return this.callId=apiCC.session.apiCCWebRTCClient.webRTCClient.pushData(null,{transferType:"pipeline"},null,{failure:function(qt){qt==="dataChannelClosed"?(xn.debug("dataChannelClosed : no activity on dataChannel timeout"),en.callId=null):xn.error("dataChannel failure",qt)}}),this.callId}},{key:"drawAnnotations",value:function(en,qt){var on=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},hn=on.color||"#ED5131",nn=on.textColor||"#FFFFFF",dn=on.colorMap||null,Sn=Object.prototype.hasOwnProperty.call(on,Sn)?on.lineWidth:3,wn=on.font||"15px Arial";if(en.yolo!==void 0&&en.yolo.length>0)for(var En=0;En<en.yolo.length;En++){var Pn=en.yolo[En],Wn=Pn.bounding_box,ir=Wn[0],fr=Wn[1],gr=Wn[2],yr=Wn[3];this.modelName==="mask_augmented_refined"&&(gr-=ir,yr-=fr);var Rr=hn;dn!==null&&Pn.class in dn&&(Rr=dn[Pn.class]),qt.lineWidth=Sn,qt.strokeStyle=Rr,qt.strokeRect(ir,fr,gr,yr),qt.font=wn;var kr=parseInt(wn,10),Qr=Pn.class,Yr=qt.measureText(Qr).width;qt.fillStyle=Rr,qt.fillRect(ir-Sn/2,fr-Math.round(4*kr/3),Yr+kr+Sn,Math.round(4*kr/3)),qt.fillStyle=nn,qt.fillText(Qr,ir+Math.round(kr/2)-Sn/2,fr-Math.round(kr/2))}if(en.ocr!==void 0&&en.ocr.length>0){wn=on.font||"25px Arial";for(var Sr=0;Sr<en.ocr.length;Sr++){var Nr=en.ocr[Sr],wr=Nr.bounding_box,Ar=wr[0],Lr=wr[1],Hr=wr[2],na=wr[3];this.modelName==="mask_augmented_refined"&&(Hr-=Ar,na-=Lr),qt.lineWidth=Sn,qt.strokeStyle=hn,qt.strokeRect(Ar,Lr,Hr,na),qt.font=wn;var Vn=parseInt(wn,10),ar=Nr.text,Hn=qt.measureText(ar).width;qt.fillStyle=hn,qt.fillRect(Ar-Sn/2,Lr-Math.round(4*Vn/3),Hn+Vn+Sn,Math.round(4*Vn/3)),qt.fillStyle=nn,qt.fillText(ar,Ar+Math.round(Vn/2)-Sn/2,Lr-Math.round(Vn/2))}}if(en.codes!==void 0&&en.codes.length>0){wn=on.font||"25px Arial";for(var vr=0;vr<en.codes.length;vr++){var qn=en.codes[vr],jr=qn.bounding_box,_r=jr[0],Er=jr[1],Fn=jr[2],pr=jr[3];this.modelName==="mask_augmented_refined"&&(Fn-=_r,pr-=Er),qt.lineWidth=Sn,qt.strokeStyle=hn,qt.strokeRect(_r,Er,Fn,pr),qt.font=wn;var Pr=parseInt(wn,10),Tr=qn.code,qr=qt.measureText(Tr).width;qt.fillStyle=hn,qt.fillRect(_r-Sn/2,Er-Math.round(4*Pr/3),qr+Pr+Sn,Math.round(4*Pr/3)),qt.fillStyle=nn,qt.fillText(Tr,_r+Math.round(Pr/2)-Sn/2,Er-Math.round(Pr/2))}}}},{key:"activateObjectDetection",value:function(){if(this.objectDetectionActivated)return this.processedMediaStream;var en=document.createElement("video");en.srcObject=this.mediaStream;var qt=document.createElement("canvas"),on=qt.getContext("2d");qt.width=this.canvasWidth,qt.height=this.canvasHeight;var hn=document.createElement("canvas"),nn=hn.getContext("2d");hn.width=this.canvasWidth,hn.height=this.canvasHeight;var dn=this;function Sn(){on.drawImage(en,0,0,qt.width,qt.height);var wn=on.getImageData(0,0,qt.width,qt.height);nn.putImageData(wn,0,0),dn.drawAnnotationsBool&&dn.drawAnnotations(dn.lastAnnotations,nn,dn.drawingConfig),requestAnimationFrame(Sn)}return en.addEventListener("loadeddata",function(){en.play(),requestAnimationFrame(Sn)}),this.processedMediaStream=hn.captureStream(),this.objectDetectionActivated=!0,this.processedMediaStream}},{key:"loadModel",value:function(){var en=this;return new Promise(function(qt,on){xn.debug("loading model");var hn={modelName:en.modelName,maxBoxes:en.maxBoxes,scoreThresh:en.scoreThresh,forceReload:en.forceReload};en.sendMessage(hn,"AIELoadModel",qt,on)})}},{key:"sendMessage",value:function(en,qt,on,hn){var nn=setTimeout(hn,5e3);this.promises.push({timeout:nn,resolve:on}),en.timeout=nn,this.sendMessageToCCS(en,qt)}},{key:"sendMessageToCCS",value:function(en,qt){if(en.userMediaStreamId=this.userMediaStreamId,en.clientId=this.clientId,en.data={pubSub:"AieConnector"},en.type=qt,apiCC!==void 0){var on=apiCC.session.apiCCWebRTCClient.webRTCClient.socket;try{var hn=JSON.stringify(en);on.emit(qt,hn)}catch(nn){xn.error("JSON Stringify error : ",nn)}}}},{key:"modelLoaded",value:function(en){xn.debug("Loaded model name :",en.modelName),this.aieUrl=en.url,this.loadedModel=en.modelName,this.token=en.token;var qt=this.activateObjectDetection();this.promises.forEach(function(on){en.timeout===on.timeout&&(clearTimeout(on.timeout),on.resolve(qt))})}},{key:"release",value:function(){this.isReleased=!0,this.stopLogs(),this.stopSnapshots(),this.stopAnnotations(),this.sendMessageToCCS({},"AIELogout")}}],Jt&&kn($t.prototype,Jt),Object.defineProperty($t,"prototype",{writable:!1}),Et}();function An(Et){return An=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($t){return typeof $t}:function($t){return $t&&typeof Symbol=="function"&&$t.constructor===Symbol&&$t!==Symbol.prototype?"symbol":typeof $t},An(Et)}function Nn(Et,$t){for(var Jt=0;Jt<$t.length;Jt++){var en=$t[Jt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}function Un(Et,$t){return Un=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Jt,en){return Jt.__proto__=en,Jt},Un(Et,$t)}function Qn(Et,$t){if($t&&(An($t)==="object"||typeof $t=="function"))return $t;if($t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Jt){if(Jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Jt}(Et)}function er(Et){return er=Object.setPrototypeOf?Object.getPrototypeOf.bind():function($t){return $t.__proto__||Object.getPrototypeOf($t)},er(Et)}var zn=et.Y.get("MediaFilterAIE"),lr=function(Et){(function(nn,dn){if(typeof dn!="function"&&dn!==null)throw new TypeError("Super expression must either be null or a function");nn.prototype=Object.create(dn&&dn.prototype,{constructor:{value:nn,writable:!0,configurable:!0}}),Object.defineProperty(nn,"prototype",{writable:!1}),dn&&Un(nn,dn)})(hn,Et);var $t,Jt,en,qt,on=(en=hn,qt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var nn,dn=er(en);if(qt){var Sn=er(this).constructor;nn=Reflect.construct(dn,arguments,Sn)}else nn=dn.apply(this,arguments);return Qn(this,nn)});function hn(){var nn;return function(dn,Sn){if(!(dn instanceof Sn))throw new TypeError("Cannot call a class as a function")}(this,hn),(nn=on.call(this)).userMediaStreamId=null,nn.streamAIE=null,nn}return $t=hn,(Jt=[{key:"applyFilter",value:function(nn,dn){var Sn=this;return new Promise(function(wn,En){if(zn.debug("Apply filter with descriptor :",dn),dn.options===void 0&&En("Filter options object required"),dn.options.modelName===void 0)En("modelName options required");else{var Pn=nn.getAudioTracks();Pn.length>0&&Pn.forEach(function(Wn){nn.removeTrack(Wn)}),Sn.streamAIE=new Dn(nn,dn.options),Sn.streamAIE.loadModel().then(function(Wn){Pn.forEach(function(ir){Wn.addTrack(ir)}),wn(Wn)}).catch(function(Wn){En(Wn)})}})}},{key:"release",value:function(){this.streamAIE.release()}}])&&Nn($t.prototype,Jt),Object.defineProperty($t,"prototype",{writable:!1}),hn}(pt);function cn(Et){return cn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($t){return typeof $t}:function($t){return $t&&typeof Symbol=="function"&&$t.constructor===Symbol&&$t!==Symbol.prototype?"symbol":typeof $t},cn(Et)}function Gn(Et,$t){for(var Jt=0;Jt<$t.length;Jt++){var en=$t[Jt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}function Yn(Et,$t){return Yn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Jt,en){return Jt.__proto__=en,Jt},Yn(Et,$t)}function or(Et,$t){if($t&&(cn($t)==="object"||typeof $t=="function"))return $t;if($t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Jt){if(Jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Jt}(Et)}function Bn(Et){return Bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function($t){return $t.__proto__||Object.getPrototypeOf($t)},Bn(Et)}var rr=et.Y.get("MediaFilterBackgroundSubstraction"),Zn=function(Et){(function(nn,dn){if(typeof dn!="function"&&dn!==null)throw new TypeError("Super expression must either be null or a function");nn.prototype=Object.create(dn&&dn.prototype,{constructor:{value:nn,writable:!0,configurable:!0}}),Object.defineProperty(nn,"prototype",{writable:!1}),dn&&Yn(nn,dn)})(hn,Et);var $t,Jt,en,qt,on=(en=hn,qt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var nn,dn=Bn(en);if(qt){var Sn=Bn(this).constructor;nn=Reflect.construct(dn,arguments,Sn)}else nn=dn.apply(this,arguments);return or(this,nn)});function hn(){var nn;return function(dn,Sn){if(!(dn instanceof Sn))throw new TypeError("Cannot call a class as a function")}(this,hn),(nn=on.call(this)).mediaStream=null,nn.mediaStreamSettings=null,nn.processedMediaStream=null,nn.net=null,nn.lossRatio=null,nn.processBackground=!1,nn.bgImageData=null,nn.videoElement=document.createElement("video"),nn.canvas=document.createElement("canvas"),nn.canvasContext=nn.canvas.getContext("2d"),nn}return $t=hn,(Jt=[{key:"applyFilter",value:function(nn,dn){var Sn=this;return new Promise(function(wn,En){var Pn=nn.getAudioTracks();Pn.length>0&&Pn.forEach(function(Wn){nn.removeTrack(Wn)}),Sn.loadTensorflow().then(function(){Sn.loadTensorflowModel().then(function(){Sn.videoElement.srcObject=nn;var Wn=Sn;Sn.videoElement.addEventListener("loadeddata",function(){Wn.videoElement.play(),Wn.mediaStream=nn,Wn.descriptors=dn,Wn.processedMediaStream=Wn.canvas.captureStream(),Wn.mediaStreamSettings=Wn.mediaStream.getVideoTracks()[0].getSettings(),Wn.videoElement.height=240,Wn.lossRatio=Wn.mediaStreamSettings.height/Wn.videoElement.height,Wn.videoElement.width=Wn.videoElement.height*Wn.mediaStreamSettings.aspectRatio,Wn.videoElement.onplaying=function(){Wn.canvas.height=Wn.videoElement.videoHeight,Wn.canvas.width=Wn.videoElement.videoWidth},Wn.loadBodyPix().then(function(){Pn.forEach(function(ir){Wn.processedMediaStream.addTrack(ir)}),wn(Wn.processedMediaStream)}).catch(function(ir){rr.error(ir)})})}).catch(function(Wn){rr.error(Wn)})}).catch(function(Wn){rr.error(Wn)})})}},{key:"loadTensorflow",value:function(){return rr.debug("Tensorflow script loading..."),new Promise(function(nn,dn){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){rr.debug("Tensorflow script loaded"),nn()},error:function(wn){dn("Resources loading failed, depsNotFound: "+wn)},retrycb:function(wn,En){rr.warn("Tensorflow loading retry :"+wn+" ,delay before retry :"+En)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.2"],"tensorflow",Sn)})}},{key:"loadTensorflowModel",value:function(){return rr.debug("Tensorflow model script loading..."),new Promise(function(nn,dn){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){rr.debug("Tensorflow model script loaded"),nn()},error:function(wn){dn("Resources loading failed, depsNotFound: "+wn)},retrycb:function(wn,En){rr.warn("Tensorflow model loading retry :"+wn+" ,delay before retry :"+En)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.0"],"tensorflow-model",Sn)})}},{key:"loadBodyPix",value:function(){var nn=this;return new Promise(function(dn,Sn){bodyPix.load({multiplier:.75,stride:32,quantBytes:4}).then(function(wn){nn.net=wn,nn.perform(),dn()}).catch(function(wn){return Sn(wn)})})}},{key:"perform",value:function(){if(this.descriptors.options!==void 0&&this.descriptors.options.backgroundMode!==void 0)switch(this.processBackground=!0,this.descriptors.options.backgroundMode){case"blur":rr.warn("This method is deprecated, please use Stream#blur method now."),this.videoElement.height=this.mediaStreamSettings.height,this.videoElement.width=this.mediaStreamSettings.width,this.canvas.height=this.videoElement.height,this.canvas.width=this.videoElement.width,this.blurBackground();break;case"transparent":this.noBackground();break;case"image":this.descriptors.options.image!==void 0?(this.resizeImageData(this.descriptors.options.image),this.imageBackground()):rr.error("image option is required when creating the filter");break;default:rr.debug("The backgroundMode : ",this.descriptors.options.backgroundMode," is not implemented. Refer to documentation for accepted values."),this.blurBackground()}else rr.error("backgroundMode option is required")}},{key:"blurBackground",value:function(){var nn=this;this.net.segmentPerson(this.videoElement).then(function(dn){nn.blurBackground(),bodyPix.drawBokehEffect(nn.canvas,nn.videoElement,dn,9,2,!1)})}},{key:"noBackground",value:function(){var nn=this;this.net.segmentPerson(this.videoElement).then(function(dn){nn.canvasContext.drawImage(nn.videoElement,0,0,nn.videoElement.width,nn.videoElement.height);for(var Sn=nn.canvasContext.getImageData(0,0,nn.videoElement.width,nn.videoElement.height),wn=Sn.data,En=0;En<wn.length;En+=4)dn.data[En/4]===0&&(wn[En+3]=0);var Pn=nn.scaleImageData(Sn,nn.lossRatio);nn.canvasContext.imageSmoothingEnabled=!0,nn.canvasContext.putImageData(Pn,0,0),nn.processBackground&&nn.noBackground()})}},{key:"imageBackground",value:function(){var nn=this;this.net.segmentPerson(this.videoElement).then(function(dn){nn.canvasContext.putImageData(nn.bgImageData,0,0,0,0,nn.videoElement.width,nn.videoElement.height);var Sn=nn.canvasContext.getImageData(0,0,nn.videoElement.width,nn.videoElement.height);nn.canvasContext.drawImage(nn.videoElement,0,0,nn.videoElement.width,nn.videoElement.height);for(var wn=nn.canvasContext.getImageData(0,0,nn.videoElement.width,nn.videoElement.height),En=wn.data,Pn=0;Pn<En.length;Pn+=4)dn.data[Pn/4]===0&&(En[Pn]=Sn.data[Pn],En[Pn+1]=Sn.data[Pn+1],En[Pn+2]=Sn.data[Pn+2],En[Pn+3]=Sn.data[Pn+3]);var Wn=nn.scaleImageData(wn,nn.lossRatio);nn.canvasContext.imageSmoothingEnabled=!0,nn.canvasContext.putImageData(Wn,0,0),nn.processBackground&&nn.imageBackground()})}},{key:"resizeImageData",value:function(nn){var dn=this.videoElement.width/nn.width,Sn=this.videoElement.height/nn.height;this.bgImageData=dn>=Sn?this.scaleImageData(nn,dn):this.scaleImageData(nn,Sn)}},{key:"noBackgroundWithFullResolution",value:function(){var nn=this;this.net.segmentPerson(this.videoElement).then(function(dn){nn.canvasContext.drawImage(nn.videoElement,0,0,nn.canvas.width,nn.canvas.height);for(var Sn=nn.canvasContext.getImageData(0,0,nn.canvas.width,nn.canvas.height),wn=new Uint8ClampedArray(4*dn.width*dn.height),En=0;En<wn.length;En+=4)dn.data[En/4]!==0&&(wn[En+3]=255);var Pn=new ImageData(wn,dn.width,dn.height);Pn=nn.scaleImageData(Pn,nn.lossRatio);for(var Wn=0;Wn<Sn.data.length;Wn+=4)Pn.data[Wn+3]===0&&(Sn.data[Wn+3]=0);nn.canvasContext.imageSmoothingEnabled=!0,nn.canvasContext.putImageData(Sn,0,0),nn.processBackground&&nn.noBackgroundWithFullResolution()})}},{key:"scaleImageData",value:function(nn,dn){var Sn=document.createElement("canvas");Sn.width=nn.width,Sn.height=nn.height,Sn.getContext("2d").putImageData(nn,0,0);var wn=document.createElement("canvas");wn.width=this.canvas.width,wn.height=this.canvas.height;var En=wn.getContext("2d");return En.scale(dn,dn),En.drawImage(Sn,0,0),En.getImageData(0,0,wn.width,wn.height)}},{key:"release",value:function(){this.processedMediaStream=this.mediaStream,this.processBackground=!1}}])&&Gn($t.prototype,Jt),Object.defineProperty($t,"prototype",{writable:!1}),hn}(pt);function _n(Et,$t){for(var Jt=0;Jt<$t.length;Jt++){var en=$t[Jt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}var Ln=et.Y.get("MediaFilterManager"),vn=apiCC.myWebRTC_Event,On={oldBackgroundSubtraction:Ht,AIEFilter:lr,backgroundSubtraction:Zn},Kt=function(){function Et(en,qt,on){(function(hn,nn){if(!(hn instanceof nn))throw new TypeError("Cannot call a class as a function")})(this,Et),this.mediaStream=en,this.descriptors=qt,this.userMediaStreamId=on,this.filters={}}var $t,Jt;return $t=Et,(Jt=[{key:"getOrCreateFilter",value:function(en){if(this.filters[en.type]!==void 0)return this.filters[en.type];var qt=On[en.type];if(qt===void 0)return Ln.error("Unknown filter type: "+en.type),null;var on=new qt;return this.filters[on]=on,on}},{key:"applyFilters",value:function(){var en=this;if(Ln.info("Apply filters",this.descriptors),!Array.isArray(this.descriptors)||this.descriptors.length===0)return Ln.error("No filter can be applied, filter descriptors have wrong format, it should be an array and contain at least one element",this.descriptors),Promise.reject(this.mediaStream);var qt=Promise.resolve(this.mediaStream);return this.descriptors.forEach(function(on){var hn=en.getOrCreateFilter(on);hn!==null?(on.options!==void 0&&(on.options.userMediaStreamId=en.userMediaStreamId,on.options.clientId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId),qt=qt.then(function(nn){return hn.applyFilter(nn,on)})):Ln.error("Filter "+on.type+" will be skipped. No implemented filter has this type")}),Ln.info("Filters attached"),document.addEventListener("visibilitychange",function(){en.createBackgroundSubstractionStopVisibilityChangeEvent(en.userMediaStreamId)}),qt.catch(function(on){return Ln.error(on)}),qt}},{key:"createBackgroundSubstractionStopVisibilityChangeEvent",value:function(en){document.hidden&&vn.createBackgroundSubstractionStopVisibilityChangeEvent(en)}},{key:"release",value:function(){Object.values(this.filters).forEach(function(en){en.release()}),document.removeEventListener("visibilitychange",this.createBackgroundSubstractionStopVisibilityChangeEvent),this.filters=null,this.mediaStream=null}}])&&_n($t.prototype,Jt),Object.defineProperty($t,"prototype",{writable:!1}),Et}();function Rt(Et){return Rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($t){return typeof $t}:function($t){return $t&&typeof Symbol=="function"&&$t.constructor===Symbol&&$t!==Symbol.prototype?"symbol":typeof $t},Rt(Et)}function nt(Et,$t){var Jt=typeof Symbol<"u"&&Et[Symbol.iterator]||Et["@@iterator"];if(!Jt){if(Array.isArray(Et)||(Jt=function(dn,Sn){if(dn){if(typeof dn=="string")return Ct(dn,Sn);var wn=Object.prototype.toString.call(dn).slice(8,-1);return wn==="Object"&&dn.constructor&&(wn=dn.constructor.name),wn==="Map"||wn==="Set"?Array.from(dn):wn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(wn)?Ct(dn,Sn):void 0}}(Et))||$t&&Et&&typeof Et.length=="number"){Jt&&(Et=Jt);var en=0,qt=function(){};return{s:qt,n:function(){return en>=Et.length?{done:!0}:{done:!1,value:Et[en++]}},e:function(dn){throw dn},f:qt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var on,hn=!0,nn=!1;return{s:function(){Jt=Jt.call(Et)},n:function(){var dn=Jt.next();return hn=dn.done,dn},e:function(dn){nn=!0,on=dn},f:function(){try{hn||Jt.return==null||Jt.return()}finally{if(nn)throw on}}}}function Ct(Et,$t){($t==null||$t>Et.length)&&($t=Et.length);for(var Jt=0,en=new Array($t);Jt<$t;Jt++)en[Jt]=Et[Jt];return en}var yt=et.Y.get("ApiCCUserMediaStream"),xt=apiCC.myWebRTC_Event,wt="getUserMediaAccessAllowed",Lt=function(){Number.MAX_SAFE_INTEGER!==void 0?this.userMediaStreamId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():this.userMediaStreamId=Math.floor(1000001*Math.random()).toString(),ot.Xh==="Edge"&&ot.PR>=15&&apiRTC.browserDetails.type!=="chrome"?this.gum_config={audio:!0,video:!0}:ot.Xh==="Chrome"&&ot.PR<49||ot.Xh==="Firefox"&&ot.PR<50?this.gum_config={audio:{mandatory:{},optional:[]},video:{mandatory:{},optional:[]}}:this.gum_config={audio:{},video:{}},this.inputs={},this.callbacks={},this.callType=null,this.audio=!1,this.audioDeviceLabel=null,this.audioMuted=!1,this.audioSilent=!1,this.video=!1,this.videoDeviceLabel=null,this.videoMuted=!1,this.videoSilent=!1,this.stream=null,this.streamStolen=!1,this.notifyUserMediaSuccess=!0,this.notifyUserMediaStop=!0,apiCC.session!==null&&apiCC.session!==void 0?this.tryAudioCallAfterUserMediaError=apiCC.session.tryAudioCallAfterUserMediaError:this.tryAudioCallAfterUserMediaError=!1,this.callInfoList=[],this.iOSMediaSelectionWorkAroundApplied=!1,this.getUserMediaTimeoutId=null,lt.wL.type==="chrome"&&lt.wL.version>=72&&lt.wL.version<=73?this.displayMediaStreamConstraints={video:!0,audio:!1}:this.displayMediaStreamConstraints={video:!0,audio:!0},this.forceExtensionOnChrome=!1,this.filters=null,this.mediaFilterManager=null,this.videoSettings=!1,this.getVideoTrack=function(){if(!this.stream||typeof this.stream.getVideoTracks!="function")return null;var Et=this.stream.getVideoTracks();return Et&&Et.length===1?Et[0]:null},this.release=function(){var Et=0,$t=null,Jt=null,en=null;if(yt.debug("[ApiCCUserMediaStream] release; userMediaStreamId: "+this.userMediaStreamId),this.mediaFilterManager!==null&&(this.mediaFilterManager.release(),this.mediaFilterManager=null),apiCC.audioProcessor.stopAudioNodeCtx(this.nodeCtx),apiRTC.userAgentInstance!==void 0&&apiRTC.userAgentInstance!==null&&apiRTC.userAgentInstance.apiRTCStreamsList!==void 0&&apiRTC.userAgentInstance.apiRTCStreamsList!==null&&apiRTC.userAgentInstance.apiRTCStreamsList.delete(Number(this.userMediaStreamId)),this.stream!==null){if(this.streamStolen!==!0)if(typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0)cordova!==void 0&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0&&(yt.debug("[ApiCCUserMediaStream] release on iosrtc cordova"),this.stream.onended=null);else if(ot.Xh==="Chrome"&&ot.PR<45||ot.Xh==="Firefox"&&ot.PR<44||ot.Xh==="Opera"&&ot.PR<34||ot.Xh==="Chromium"&&ot.PR<44||ot.Xh==="Chrome WebView"&&ot.PR<45)this.stream.onended=null,this.stream.stop();else for(this.stream.onended=null,Et=($t=this.stream.getTracks()).length;--Et>=0;)$t[Et].onended=null,$t[Et].stop();this.stream=null,this.streamStolen=!1,this.notifyUserMediaStop===!0&&((en=this.getOwnerCallInfo())!==null&&(Jt=en.callId),xt.createUserMediaStopEvent(Jt,this.callType,this.userMediaStreamId)),this.callbacks.release(this)}},this.getUserMedia=function(){var Et=this;if(yt.debug("[ApiCCUserMediaStream] getUserMedia; userMediaStreamId: "+this.userMediaStreamId),this.stream===null)try{if(this.callType==="media")this.gum_config=apiCC.setAudioSourceIdInConstraint(this.inputs.audioSourceId,this.gum_config),this.gum_config=apiCC.setVideoSourceIdInConstraint(this.inputs.videoSourceId,this.gum_config),this.gum_config=apiCC.setVideoFacingModeInConstraint(this.inputs.facingMode,this.gum_config);else if(this.callType==="audio")this.gum_config=apiCC.setAudioSourceIdInConstraint(this.inputs.audioSourceId,this.gum_config),this.gum_config.video=!1;else{if(this.callType!=="videoOnly")return function($t){for(var Jt=apiCC.userMediaStreamTable.length;--Jt>=0;)if(apiCC.userMediaStreamTable[Jt].userMediaStreamId===$t){apiCC.userMediaStreamTable.splice(Jt,1);break}}(this.userMediaStreamId),void setTimeout(this.callbacks.failure.bind(this,this,"wrong type"));this.gum_config.audio=!1,this.gum_config=apiCC.setVideoSourceIdInConstraint(this.inputs.videoSourceId,this.gum_config),this.gum_config=apiCC.setVideoFacingModeInConstraint(this.inputs.facingMode,this.gum_config)}apiCC.checkConstraintDependingOnDevice(this.gum_config),ot.Xh==="IE"&&ot.dc>8?apiCC.getUserMediaWithCB(this.gum_config,this.callback(this,"onUserMediaSuccess"),this.callback(this,"onUserMediaError")):(ot.Xh==="Chrome"&&this.isUserMediaAccessAllowed()===!0&&(this.getUserMediaTimeoutId=setTimeout(function(){Et.onUserMediaError("timeout")},1e4)),apiCC.getUserMedia(this.gum_config).then(this.callback(this,"onUserMediaSuccess")).catch(this.callback(this,"onUserMediaError")))}catch($t){yt.error("getUserMedia() failed. Is this a WebRTC capable browser?"),yt.log("getUserMedia failed with exception: "+$t.message)}},this.listenForMuteEvents=function(){var Et,$t=this,Jt=function(hn){var nn=null,dn=null;hn.onmute=function(Sn){yt.debug("mute event :",hn),hn.kind==="audio"&&nn===null?nn=setTimeout(function(){$t.audioSilent=!0,nn=null,$t.notifyMLineMuted(hn.kind,!0,"muted")},2520):hn.kind==="video"&&dn===null&&(dn=setTimeout(function(){$t.videoSilent=!0,dn=null,$t.notifyMLineMuted(hn.kind,!0,"muted")},2520))},hn.onunmute=function(Sn){yt.debug(hn.kind+" unmute event"),hn.kind==="audio"&&nn!==null?(clearTimeout(nn),nn=null):hn.kind==="video"&&dn!==null?(clearTimeout(dn),dn=null):(hn.kind==="audio"?$t.audioSilent=!1:hn.kind==="video"&&($t.videoSilent=!1),$t.notifyMLineMuted(hn.kind,!1,"muted"))},hn.onended=function(Sn){yt.debug(hn.kind+" ended event"),hn.kind==="audio"&&nn!==null?(clearTimeout(nn),nn=null):hn.kind==="video"&&(dn!==null&&(clearTimeout(dn),dn=null),$t.callType!=="screenSharing"&&$t.callType!=="screenSharingWithAudio"||$t.stopScreenSharing())}},en=nt(this.stream.getVideoTracks());try{for(en.s();!(Et=en.n()).done;)Jt(Et.value)}catch(hn){en.e(hn)}finally{en.f()}var qt,on=nt(this.stream.getAudioTracks());try{for(on.s();!(qt=on.n()).done;)Jt(qt.value)}catch(hn){on.e(hn)}finally{on.f()}this.callType!=="screenSharing"&&this.callType!=="screenSharingWithAudio"||(this.stream.onended=this.callback(this,"stopScreenSharing"))},this.onUserMediaSuccess=function(Et){var $t=this;this.applyFiltersIfNeeded(Et).then(function(Jt){var en=null,qt=null,on=!1,hn=$t.getOwnerCallInfo(),nn=$t.getCall(hn);yt.info("[ApiCCUserMediaStream] onUserMediaSuccess; userMediaStreamId: "+$t.userMediaStreamId),$t.getUserMediaTimeoutId!==null&&(clearTimeout($t.getUserMediaTimeoutId),$t.getUserMediaTimeoutId=null),nn&&(yt.debug("call exist"),qt=nn.callee?nn.callerId:nn.calleeId,on=nn.restarted),$t.updateMediaProperties(Jt),$t.stream=Jt,ot.Xh==="Chrome"&&$t.setUserMediaAccessAllowed(!0),$t.notifyUserMediaSuccess===!0&&(hn&&(en=hn.callId),xt.createUserMediaSuccessEvent(en!==null,$t.audio,$t.audioDeviceLabel,$t.video,$t.videoDeviceLabel,$t.callType,en,Jt,qt,on,$t.userMediaStreamId)),$t.listenForMuteEvents(),yt.debug("Starting a new getMediaDevices after userMediaSuccess"),apiCC.mediaDeviceMgr.getMediaDevices("updatedAfterGetUserMediaSuccess"),$t.callbacks.success($t)})},this.updateMediaProperties=function(Et){var $t=!1,Jt="Unknown",en="Unknown",qt=!1,on="Unknown";Et.getAudioTracks().length>0&&($t=!0,Et.getAudioTracks()[0].label&&(Jt=Et.getAudioTracks()[0].label,en=Et.getAudioTracks()[0].id,apiCC.audioProcessor.listenToAudio(Et,this)),Et.getAudioTracks()[0].enabled===!1&&(this.audioMuted=!0),Et.getAudioTracks()[0].muted===!0&&(this.audioSilent=!0)),Et.getVideoTracks().length>0&&(qt=!0,Et.getVideoTracks()[0].label&&(on=Et.getVideoTracks()[0].label),Et.getVideoTracks()[0].enabled===!1&&(this.videoMuted=!0),Et.getVideoTracks()[0].muted===!0&&(this.videoSilent=!0)),this.audio=$t,this.audioDeviceLabel=Jt,this.audioDeviceId=en,this.video=qt,this.videoDeviceLabel=on},this.manageFailure=function(Et){var $t={};Rt(Et)==="object"?($t.message=Et.message,$t.code=Et.code,$t.name=Et.name):$t=Et,this.callbacks.failure(this,$t)},this.onUserMediaError=function(Et){var $t=function(on){for(var hn=apiCC.userMediaStreamTable.length;--hn>=0;)if(apiCC.userMediaStreamTable[hn].userMediaStreamId===on){apiCC.userMediaStreamTable.splice(hn,1);break}},Jt=null,en=this.getOwnerCallInfo();if(yt.info("[ApiCCUserMediaStream] onUserMediaError; userMediaStreamId: "+this.userMediaStreamId+", error: "+Et),this.getUserMediaTimeoutId!==null&&(Et!=="timeout"&&clearTimeout(this.getUserMediaTimeoutId),this.getUserMediaTimeoutId=null),ot.$6!=="electron"&&ot.Xh==="Chrome"&&ot.PR>47&&window.location.protocol!=="https:"&&yt.error("HTTPS is now mandatory to use getUserMedia()"),en!==null&&(Jt=en.callId),this.callType==="media"&&ot.ag.name==="iOS"&&ot.Xh==="Mobile Safari"&&this.iOSMediaSelectionWorkAroundApplied===!1||xt.createUserMediaErrorEvent(Jt!==null,this.callType,Et,this.userMediaStreamId,Jt,this.tryAudioCallAfterUserMediaError,this.gum_config),Et!=="timeout"&&this.callType==="media")if(ot.ag.name==="iOS"&&ot.Xh==="Mobile Safari"&&this.iOSMediaSelectionWorkAroundApplied===!1){yt.warn("try mediaDevice selection workaround on iOS / Mobile Safari - after MediaError"),this.iOSMediaSelectionWorkAroundApplied=!0,this.gum_config.video={};var qt=apiCC.getMediaDeviceLabelFromDeviceid(this.inputs.videoSourceId);yt.log("getMediaDeviceLabelFromDeviceid :",qt),qt==="Caméra arrière"||qt==="Back Camera"?(yt.log("Setting FacingMode to environment :",qt),this.gum_config=apiCC.setVideoFacingModeInConstraint("environment",this.gum_config)):(yt.log("Setting FacingMode to user :",qt),this.gum_config=apiCC.setVideoFacingModeInConstraint("user",this.gum_config)),this.inputs.videoSourceId=null,this.getUserMedia()}else this.tryAudioCallAfterUserMediaError===!0?(yt.warn("try AudioCall after UserMediaError is activated"),this.tryAudioCallAfterUserMediaError=!1,this.gum_config.video!==!1?(yt.debug("[ApiCCUserMediaStream] Trying to getUserMedia with audioOnly"),this.inputs.videoSourceId=null,this.gum_config.video=!1,this.getUserMedia()):($t(this.userMediaStreamId),this.manageFailure(Et))):($t(this.userMediaStreamId),this.manageFailure(Et));else $t(this.userMediaStreamId),this.manageFailure(Et)},this.getDisplayMediaProcess=function(){var Et=this;yt.debug("using getDisplayMedia with browser :",ot.Xh),yt.debug("displayMediaStreamConstraints :",this.displayMediaStreamConstraints),Rt(this.displayMediaStreamConstraints)==="object"&&Array.isArray(this.displayMediaStreamConstraints)!==!0||(yt.warn("Defined displayMediaStreamConstraints format is not correct, reinitialization ..."),lt.wL.type==="chrome"&&lt.wL.version>=72&&lt.wL.version<=73?this.displayMediaStreamConstraints={video:!0,audio:!1}:this.displayMediaStreamConstraints={video:!0,audio:!0},yt.debug("displayMediaStreamConstraints :",this.displayMediaStreamConstraints)),typeof apiRTC_React<"u"?(yt.debug("getDisplayMedia - React version"),mediaDevices.getDisplayMedia(this.displayMediaStreamConstraints).then(function($t){yt.info("getDisplayMedia React stream available"),Et.onUserMediaSuccess($t)}).catch(function($t){yt.debug("getDisplayMedia - React version error : ",$t),Et.onUserMediaError($t)})):navigator.getDisplayMedia?(yt.debug("navigator.getDisplayMedia defined"),navigator.getDisplayMedia(this.displayMediaStreamConstraints).then(function($t){yt.debug("getDisplayMedia stream available"),Et.onUserMediaSuccess($t)}).catch(function($t){yt.debug("getDisplayMedia error :",$t),Et.onUserMediaError($t)})):navigator.mediaDevices.getDisplayMedia?(yt.debug("navigator.mediaDevices.getDisplayMedia defined"),navigator.mediaDevices.getDisplayMedia(this.displayMediaStreamConstraints).then(function($t){yt.debug("getDisplayMedia stream available"),Et.onUserMediaSuccess($t)}).catch(function($t){yt.debug("getDisplayMedia error :",$t),Et.onUserMediaError($t)})):(yt.debug("getDisplayMedia not available"),xt.createDesktopCaptureEvent("Browser_Not_Compatible"))},this.getScreenMedia=function(){if(yt.debug("[ApiCCUserMediaStream] getScreenMedia; userMediaStreamId: "+this.userMediaStreamId),this.stream===null)if(ot.Xh==="Chrome"||ot.Xh==="Firefox"&&ot.PR>=52)if(ot.Xh==="Chrome")if(yt.log("shareScreen on Chrome"),ot.PR>=72&&this.forceExtensionOnChrome===!1)this.getDisplayMediaProcess();else{if(yt.debug("this.captureSourceType :",this.captureSourceType),apiCC.apiRTCExtensionInstalled===!1)return apiCC.waitingShareScreenUserMediaStreamId=this.userMediaStreamId,function(Et){yt.debug("[ApiCCUserMediaStream] moveUserMediaEntryInWaitingScreen: "+Et);for(var $t=apiCC.userMediaStreamTable.length;--$t>=0;)if(apiCC.userMediaStreamTable[$t].userMediaStreamId===Et){apiCC.waitingShareScreenUserMediaStream=apiCC.userMediaStreamTable.splice($t,1);break}}(this.userMediaStreamId),void apiCC.manageNotInstalledExtension("getScreenMedia","getScreenMedia",this.captureSourceType);this.captureSourceType!==void 0&&this.captureSourceType!==null||(this.captureSourceType=["screen","window","tab"]),Array.isArray(this.captureSourceType)===!1&&(yt.warn("Defined captureSourceType format is not correct, reinitialization ..."),this.captureSourceType=["screen","window","tab"],yt.debug("this.captureSourceType :",this.captureSourceType)),window.postMessage({command:"getDesktopId",callNumber:this.userMediaStreamId,remoteId:"getScreenMedia",captureSourceType:this.captureSourceType,browser_major_version:ot.PR},"*")}else yt.log("shareScreen on Firefox"),ot.PR>=67?this.getDisplayMediaProcess():(this.captureSourceType!==void 0&&this.captureSourceType!==null||(this.captureSourceType="screen"),typeof this.captureSourceType=="string"&&(yt.warn("Defined captureSourceType format is not correct, reinitialization ..."),this.captureSourceType="screen",yt.debug("this.captureSourceType :",this.captureSourceType)),this.registerScreenMedia(this.captureSourceType));else this.getDisplayMediaProcess()},this.registerScreenMedia=function(Et,$t){var Jt=null,en=this.getOwnerCallInfo(),qt=this.getCall(en),on=null;if(yt.debug("[ApiCCUserMediaStream] registerScreenMedia; userMediaStreamId: "+this.userMediaStreamId),$t==="mediaError")qt!==null?(on=qt.callee===!0?qt.callerId:qt.calleeId,qt.callType==="screenSharing"||qt.callType==="screenSharingWithAudio"?apiCC.session.apiCCWebRTCClient.webRTCClient.removeCallFromTableWithCallIdandRemoteId(qt.callId,on,"Media_Error"):yt.log("switch video / screen : call is not removed"),window.location.protocol!=="https:"&&yt.log("Please connect to your web page using 'HTTPS'. This is mandatory for desktop capture"),xt.createDesktopCaptureEvent("UserMediaError",qt.callId,on)):(yt.log("Call not found on message EventListener"),xt.createDesktopCaptureEvent("UserMediaError")),function(hn){for(var nn=apiCC.userMediaStreamTable.length;--nn>=0;)if(apiCC.userMediaStreamTable[nn].userMediaStreamId===hn){apiCC.userMediaStreamTable.splice(nn,1);break}}(this.userMediaStreamId),this.callbacks.failure(this,"UserMediaError");else try{if(ot.Xh==="Chrome")yt.log("desktopId: "+$t),Jt={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:$t}}};else{if(yt.log("captureSourceType: "+Et),Et!=="screen"&&Et!=="window"&&Et!=="application")return void yt.error("captureSourceType value is not correct");Jt={video:{mediaSource:Et}}}ot.Xh==="IE"&&ot.dc>8?apiCC.getUserMediaWithCB(Jt,this.callback(this,"onUserMediaSuccess"),this.callback(this,"onUserMediaError")):apiCC.getUserMedia(Jt).then(this.callback(this,"onUserMediaSuccess")).catch(this.callback(this,"onUserMediaError"))}catch(hn){yt.error("getUserMedia() failed. Is this a WebRTC capable browser?"),yt.log("getUserMedia failed with exception: "+hn.message)}},this.stopScreenSharing=function(){yt.debug("[ApiCCUserMediaStream] stopScreenSharing; userMediaStreamId: "+this.userMediaStreamId);var Et=!0;if(apiRTC.session.remoteAccessInvitation!==null&&this.userMediaStreamId===apiRTC.session.remoteAccessInvitation.screenSharingStreamId&&(yt.debug("this is a remote access screenSharing, need to stop remote access"),apiRTC.session.remoteAccessInvitation.stop(!0,{code:"SCREEN_SHARING_STOP"})),apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var $t=this.callInfoList.length;--$t>=0;)this.callInfoList[$t].owner===!0&&(Et=!1),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(this.callInfoList[$t].callId);Et===!0&&this.release()},this.getCall=function(Et){var $t=null;return Et&&apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient&&(Et.flavor==="call"?$t=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Et.callId):Et.flavor==="userMedia"&&($t=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Et.callId))),$t},this.getOwnerCallInfo=function(){for(var Et=this.callInfoList.length;--Et>=0;)if(this.callInfoList[Et].owner===!0)return this.callInfoList[Et];return null},this.getCallInfo=function(Et){for(var $t=this.callInfoList.length;--$t>=0;)if(this.callInfoList[$t].callId===Et)return this.callInfoList[$t];return null},this.containsCallInfo=function(Et){for(var $t=!1,Jt=this.callInfoList.length;--Jt>=0;)if(this.callInfoList[Jt].callId===Et){$t=!0;break}return $t},this.addCallInfo=function(Et,$t,Jt){return Et!==null&&typeof Et=="string"&&($t!=="call"&&$t!=="userMedia"&&($t="call"),Jt!==null&&typeof Jt=="boolean"||(Jt=!1),!this.containsCallInfo(Et))&&(this.callInfoList.push({callId:Et,flavor:$t,owner:Jt}),!0)},this.removeCallInfo=function(Et){for(var $t=!1,Jt=this.callInfoList.length;--Jt>=0;)if(this.callInfoList[Jt].callId===Et){this.callInfoList.splice(Jt,1),$t=!0;break}return $t},this.accessToLocalMedia=function(){return this.callType!=="screenSharing"&&this.callType!=="screenSharingWithAudio"&&this.callType!=="data"&&this.stream!==null},this.muteAudioOnStreams=function(){var Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return yt.debug("[ApiCCUserMediaStream] muteAudioOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getAudioTracks().forEach(function($t){$t.enabled=!1}),Et==="enabled"?this.audioMuted=!0:Et==="muted"&&(this.audioSilent=!0),this.notifyMLineMuted("audio",!0,Et),{type:"audio",muted:!0}},this.unMuteAudioOnStreams=function(){var Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return yt.debug("[ApiCCUserMediaStream] unMuteAudioOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getAudioTracks().forEach(function($t){$t.enabled=!0}),Et==="enabled"?this.audioMuted=!1:Et==="muted"&&(this.audioSilent=!1),this.notifyMLineMuted("audio",!1,Et),{type:"audio",muted:!1}},this.muteVideoOnStreams=function(){var Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return yt.debug("[ApiCCUserMediaStream] muteVideoOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getVideoTracks().forEach(function($t){$t.enabled=!1}),Et==="enabled"?this.videoMuted=!0:Et==="muted"&&(this.videoSilent=!0),this.notifyMLineMuted("video",!0,Et),{type:"video",muted:!0}},this.unMuteVideoOnStreams=function(){var Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return yt.debug("[ApiCCUserMediaStream] unMuteVideoOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getVideoTracks().forEach(function($t){$t.enabled=!0}),Et==="enabled"?this.videoMuted=!1:Et==="muted"&&(this.videoSilent=!1),this.notifyMLineMuted("video",!1,Et),{type:"video",muted:!1}},this.removeVideoTrackOnStreams=function(){var Et;return yt.debug("[ApiCCUserMediaStream] removeVideoTrackOnStreams; userMediaStreamId: "+this.userMediaStreamId),(Et=this.stream.getVideoTracks()).length>0&&this.stream.removeTrack(Et[0]),this.video=!1,{type:"video",present:!1}},this.notifyMLineMuted=function(Et,$t,Jt){var en,qt,on=!0;if(apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var hn=this.callInfoList.length;--hn>=0;)this.callInfoList[hn].flavor==="call"?(en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callInfoList[hn].callId),this.notifyMLineMutedCall(Et,$t,Jt,en,null)):this.callInfoList[hn].flavor==="userMedia"&&(qt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(this.callInfoList[hn].callId),this.notifyMLineMutedCall(Et,$t,Jt,null,qt)),this.callInfoList[hn].owner===!0&&(on=!1);on===!0&&this.notifyMLineMutedCall(Et,$t,Jt,null,null)},this.notifyMLineMutedCall=function(Et,$t,Jt,en,qt){yt.debug("notifyMLineMutedCall; mline: "+Et+", muted: "+$t);var on=[];Jt==="enabled"?on=[Et+"IsMuted"]:Jt==="muted"&&(on=[Et+"IsSilent"]);var hn={available:this.audio,deviceLabel:this.audioDeviceLabel,active:!0,muted:this.audioMuted,silent:this.audioSilent},nn={available:this.video,deviceLabel:this.videoDeviceLabel,active:!0,muted:this.videoMuted,silent:this.videoSilent},dn=null;en?(Et==="audio"?en.isLocalAudioMuted=$t:Et==="video"&&(en.isLocalVideoMuted=$t),en.belongsToRoom()?(dn={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:en.callId,roomId:en.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,mline:Et},en.data.mesh&&(dn.mesh=en.data.mesh),Jt==="muted"?(dn.change="silent",dn.silent=$t,en.myWebRTC_Stack.sendInfo("streamTrackStatusChanged",dn)):Jt==="enabled"&&(dn.muted=$t,en.myWebRTC_Stack.sendInfo("streamTrackChanged",dn))):(dn={callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,calleeId:en.callee?en.callerId:en.calleeId,callId:en.callId,mline:Et},Jt==="muted"?(dn.type="streamTrackStatusChanged",dn.change="silent",dn.silent=$t):Jt==="enabled"&&(dn.type="streamTrackChanged",dn.muted=$t),en.myWebRTC_Stack.sendDataMessage(apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,dn)),hn.active=en.localCallProfile.audioActive,nn.active=en.localCallProfile.videoActive,xt.createLocalStreamUpdatedEvent(on,hn,nn,!0,en.callType,en.callId,this.stream,this.userMediaStreamId,"userAction")):qt?(dn={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:qt.userMediaId,roomId:qt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,mline:Et},Jt==="muted"?(dn.change="silent",dn.silent=$t,qt.myWebRTC_Stack.sendInfo("streamTrackStatusChanged",dn)):Jt==="enabled"&&(dn.muted=$t,qt.myWebRTC_Stack.sendInfo("streamTrackChanged",dn)),qt.audioSdpDirection==="inactive"&&(hn.active=!1),qt.videoSdpDirection==="inactive"&&(nn.active=!1),xt.createLocalStreamUpdatedEvent(on,hn,nn,!0,qt.callType,qt.userMediaId,this.stream,this.userMediaStreamId,"userAction")):xt.createLocalStreamUpdatedEvent(on,hn,nn,!1,null,null,this.stream,this.userMediaStreamId,"userAction")},this.notifyActiveSpeaker=function(Et){var $t,Jt,en=!0;if(apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var qt=this.callInfoList.length;--qt>=0;)this.callInfoList[qt].flavor==="call"?($t=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callInfoList[qt].callId),this.notifyActiveSpeakerCall(Et,$t,null)):this.callInfoList[qt].flavor==="userMedia"&&(Jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(this.callInfoList[qt].callId),this.notifyActiveSpeakerCall(Et,null,Jt)),this.callInfoList[qt].owner===!0&&(en=!1);en===!0&&this.notifyActiveSpeakerCall(Et,null,null)},this.notifyActiveSpeakerCall=function(Et,$t,Jt){var en=null;$t?($t.belongsToRoom()?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:$t.callId,roomId:$t.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},$t.data.mesh&&(en.mesh=$t.data.mesh),$t.myWebRTC_Stack.sendInfo("activeSpeaker",en)):(en={type:"activeSpeaker",callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,calleeId:$t.callee?$t.callerId:$t.calleeId,callId:$t.callId,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},$t.myWebRTC_Stack.sendDataMessage(apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,en)),xt.createAudioAmplitudeEvent(Et,!0,$t.callId,this.userMediaStreamId)):Jt?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Jt.userMediaId,roomId:Jt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},Jt.myWebRTC_Stack.sendInfo("activeSpeaker",en),xt.createAudioAmplitudeEvent(Et,!0,Jt.userMediaId,this.userMediaStreamId)):xt.createAudioAmplitudeEvent(Et,!0,null,this.userMediaStreamId)},this.notifyNotActiveSpeaker=function(Et){var $t,Jt,en=!0;if(apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var qt=this.callInfoList.length;--qt>=0;)this.callInfoList[qt].flavor==="call"?($t=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callInfoList[qt].callId),this.notifyNotActiveSpeakerCall(Et,$t,null)):this.callInfoList[qt].flavor==="userMedia"&&(Jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(this.callInfoList[qt].callId),this.notifyNotActiveSpeakerCall(Et,null,Jt)),this.callInfoList[qt].owner===!0&&(en=!1);en===!0&&this.notifyNotActiveSpeakerCall(Et,null,null)},this.notifyNotActiveSpeakerCall=function(Et,$t,Jt){var en=null;$t?($t.belongsToRoom()?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:$t.callId,roomId:$t.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},$t.data.mesh&&(en.mesh=$t.data.mesh),$t.myWebRTC_Stack.sendInfo("stopSpeaking",en)):(en={type:"stopSpeaking",callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,calleeId:$t.callee?$t.callerId:$t.calleeId,callId:$t.callId,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},$t.myWebRTC_Stack.sendDataMessage(apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,en)),xt.createAudioAmplitudeEvent(Et,!1,$t.callId,this.userMediaStreamId)):Jt?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Jt.userMediaId,roomId:Jt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},Jt.myWebRTC_Stack.sendInfo("stopSpeaking",en),xt.createAudioAmplitudeEvent(Et,!1,Jt.userMediaId,this.userMediaStreamId)):xt.createAudioAmplitudeEvent(Et,!1,null,this.userMediaStreamId)},this.callback=function(Et,$t){return this.closureHandler=function(Jt,en){return Et[$t](Jt,en)},this.closureHandler},this.isUserMediaAccessAllowed=function(){return localStorage!==null&&(typeof localStorage>"u"?"undefined":Rt(localStorage))==="object"&&typeof localStorage.getItem=="function"?localStorage.getItem(wt)==="true":null},this.setUserMediaAccessAllowed=function(Et){return localStorage!==null&&(typeof localStorage>"u"?"undefined":Rt(localStorage))==="object"&&typeof localStorage.setItem=="function"?(localStorage.setItem(wt,Et?"true":"false"),!!Et):null},this.applyFiltersIfNeeded=function(Et){return this.filters===null?Promise.resolve(Et):(this.mediaFilterManager=new Kt(Et,this.filters,this.userMediaStreamId),this.mediaFilterManager.applyFilters())},this.getVideoSettings=function(){if(this.videoSettings!==!1)return this.videoSettings;var Et=this.getVideoTrack();if(!Et||typeof Et.getSettings!="function")return this.videoSettings=null,this.videoSettings;var $t=Et.getSettings();return $t?(this.videoSettings={},Object.prototype.hasOwnProperty.call($t,"width")&&(this.videoSettings.width=$t.width),Object.prototype.hasOwnProperty.call($t,"height")&&(this.videoSettings.height=$t.height),Object.prototype.hasOwnProperty.call($t,"frameRate")&&(this.videoSettings.frameRate=$t.frameRate),this.videoSettings):(this.videoSettings=null,this.videoSettings)},this.isSimulcastCompliant=function(){return!!this.getVideoSettings()},this.getSimulcastProfile=function(){var Et=this.getVideoSettings();if(!Et)return null;var $t={substream:{high:{active:!0,selectable:!0},medium:{active:!0,selectable:!0},low:{active:!0,selectable:!0}},temporal:{high:{active:!0,selectable:!0},medium:{active:!0,selectable:!0},low:{active:!0,selectable:!0}}};return lt.wL.type==="chrome"&&((Et.width<1280||Et.height<720)&&($t.substream.low.selectable=!1),$t.temporal.high.active=!1,$t.temporal.high.selectable=!1),$t}}},1192:(at,ut,s)=>{s.d(ut,{D:()=>On}),s(3710),s(1539),s(9714),s(2772),s(8674);var et=s(1549),ot=(s(4916),s(5306),s(2564),s(4812),s(561),s(5735),s(3753),s(4603),s(6755),s(9554),s(4747),s(6992),s(8783),s(3948),s(9601),s(8309),s(8264),s(9575),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(7042),s(7941),s(2526),s(1817),s(2165),s(5945)),lt=s(4708),St=s(940);function pt(Kt){return pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Rt){return typeof Rt}:function(Rt){return Rt&&typeof Symbol=="function"&&Rt.constructor===Symbol&&Rt!==Symbol.prototype?"symbol":typeof Rt},pt(Kt)}function gt(){this.sdp={original:null,global:[],mlines:[]},this.mlines=[]}function ct(Kt){var Rt=new gt,nt=Kt.split(`\r
`),Ct=0,yt=null,xt=null,wt=null,Lt=null;for(Rt.sdp.original=Kt;Ct<nt.length;)if((yt=nt[Ct]).length!==0)if(wt!==null)if(yt.match(/^m=/))xt=null,wt=null;else if(yt.match(/^a=/)){if(xt.push(yt),!(Lt=yt.match(/^a=([\w-]+):(\d+) (.+)$/))||Lt[1]!=="rtpmap"&&Lt[1]!=="rtcp-fb"&&Lt[1]!=="fmtp"){if(Lt=yt.match(/^a=mid:(\w+)$/))wt.mid=Lt[1];else if(yt==="a=sendrecv")wt.direction="sendrecv";else if(yt==="a=recvonly")wt.direction="recvonly";else if(yt==="a=sendonly")wt.direction="sendonly";else if(yt==="a=inactive")wt.direction="inactive";else if(Lt=yt.match(/^a=ssrc-group:SIM (.+)$/)){var Et=Lt[1].split(" ");wt.ssrc_groups.sim.push(Et.slice())}else if(Lt=yt.match(/^a=ssrc-group:FID (.+)$/)){var $t=Lt[1].split(" ");wt.ssrc_groups.fid.push($t.slice())}else if(Lt=yt.match(/^a=ssrc:(\d+) (.+)$/)){var Jt=wt.ssrcs.find(function(Sn){return Sn.original===Lt[1]});Jt||(Jt={original:Lt[1],ssrc:Lt[1],content:{}},wt.ssrcs.push(Jt));var en=Lt[2].match(/^(\w+):(.+)$/);if(!en)throw new Error("cannot parse ssrc parameters (regex failure): "+Lt[2]);if(en[1]==="cname")Jt.content.cname=en[2];else if(en[1]==="msid")Jt.content.msid=en[2];else if(en[1]==="mslabel")Jt.content.mslabel=en[2];else{if(en[1]!=="label")throw new Error("cannot parse ssrc parameters (wrong attribute): "+en[1]);Jt.content.label=en[2]}}}else if(Lt[1]==="rtpmap")wt.codecs[Lt[2]].codec=Lt[3].split("/")[0].toLowerCase(),wt.codecs[Lt[2]].rtpmap=Lt[3];else if(Lt[1]==="rtcp-fb")wt.codecs[Lt[2]]["rtcp-fb"]||(wt.codecs[Lt[2]]["rtcp-fb"]=[]),wt.codecs[Lt[2]]["rtcp-fb"].push(Lt[3]);else if(Lt[1]==="fmtp"){wt.codecs[Lt[2]].fmtp=[];for(var qt=Lt[3].split(";"),on=0;on<qt.length;on+=1){var hn=qt[on].split("=");hn.length===2&&wt.codecs[Lt[2]].fmtp.push(hn)}}Ct+=1}else if(yt.match(/^b=/)){if(xt.push(yt),Lt=yt.match(/^b=AS:(\d+)$/)){wt.bandwidth=parseInt(Lt[1],10),Ct+=1;continue}Ct+=1}else xt.push(yt),Ct+=1;else{if(Lt=yt.match(/^m=([a-z]+) (\d+) ([A-Z/]+) ([0-9 ]+)$/)){xt=[],Rt.sdp.mlines.push(xt),xt.push(yt),wt={type:Lt[1],port:parseInt(Lt[2],10),proto:Lt[3],payload_types:[],direction:"sendrecv",mid:Lt[1],bandwidth:0,codecs:{},ssrc_groups:{sim:[],fid:[]},ssrcs:[]};for(var nn=Lt[4].split(" "),dn=0;dn<nn.length;dn+=1)wt.payload_types.push(nn[dn]),wt.codecs[nn[dn]]={};Rt.mlines.push(wt),Ct+=1;continue}Rt.sdp.global.push(yt),Ct+=1}else Ct+=1;for(Rt.unifiedPlan=!0,Ct=Rt.mlines.length;--Ct>=0;)Rt.mlines[Ct].type!=="audio"||Rt.audio?Rt.mlines[Ct].type!=="video"||Rt.video||(Rt.video=Rt.mlines[Ct]):Rt.audio=Rt.mlines[Ct],Rt.unifiedPlan===!0&&Rt.mlines[Ct].mid!==String(Ct)&&(Rt.unifiedPlan=!1);return Rt.isAudioActive=ht.bind(null,Rt,"audio"),Rt.isVideoActive=ht.bind(null,Rt,"video"),Rt}function ht(Kt,Rt){return!(Rt!=="audio"&&Rt!=="video"||Kt===null||pt(Kt)!=="object"||!Object.prototype.hasOwnProperty.call(Kt,Rt)||Kt[Rt]===null||pt(Kt[Rt])!=="object"||Kt[Rt].direction!=="sendrecv"&&Kt[Rt].direction!=="sendonly"&&Kt[Rt].direction!=="recvonly")}s(3123),s(4765),s(4723),s(9600),s(1058),s(9826),gt.prototype.mungeForSimulcasting=function(){if(this.simulcasting!==!0){this.simulcasting=!0;for(var Kt=0;Kt<this.mlines.length;Kt+=1){var Rt=this.mlines[Kt];if(Rt.type==="video"){var nt=Rt.ssrcs[0].content.cname,Ct=Rt.ssrcs[0].content.msid,yt=Rt.ssrcs[0].content.mslabel,xt=Rt.ssrcs[0].content.label,wt=[];wt.push(Rt.ssrcs[0].ssrc);for(var Lt=2;--Lt>=0;){var Et=Math.floor(4294967295*Math.random());Rt.ssrcs.push({original:Et,ssrc:Et,content:{cname:nt,msid:Ct,mslabel:yt,label:xt}});var $t=Math.floor(4294967295*Math.random());Rt.ssrcs.push({original:$t,ssrc:$t,content:{cname:nt,msid:Ct,mslabel:yt,label:xt}}),Rt.ssrc_groups.fid.push([Et,$t]),wt.push(Et)}Rt.ssrc_groups.sim.push(wt)}}}},gt.prototype.generate=function(){for(var Kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Rt=[],nt=0;nt<this.sdp.global.length;nt+=1){var Ct=this.sdp.global[nt],yt=Ct.match(/^a=group:BUNDLE([\w ]+)$/);if(yt){Rt.push("a=group:BUNDLE");for(var xt=0;xt<this.mlines.length;xt+=1)this.mlines[xt].direction==="inactive"&&Kt.stripInactiveMLines===!0||(Rt.push(" "),Rt.push(this.mlines[xt].mid));Rt.push(`\r
`)}else Rt.push(Ct),Rt.push(`\r
`)}for(var wt=0;wt<this.sdp.mlines.length;wt+=1){var Lt=this.mlines[wt];if(Lt.direction!=="inactive"||Kt.stripInactiveMLines!==!0)for(var Et=!1,$t=this.sdp.mlines[wt],Jt=0;Jt<$t.length;Jt+=1){var en=$t[Jt];if(en.match(/^m=/))Rt.push("m="),Rt.push(Lt.type),Rt.push(" "),Rt.push(Lt.port),Rt.push(" "),Rt.push(Lt.proto),Rt.push(" "),Rt.push(Lt.payload_types.join(" ")),Rt.push(`\r
`);else if(en.match(/^a=/)){var qt=en.match(/^a=([\w-]+):(\d+) (.+)$/);if(qt&&(qt[1]==="rtpmap"||qt[1]==="rtcp-fb"||qt[1]==="fmtp")){if(qt[1]==="rtpmap"){var on=qt[2];if(Lt.codecs[on]){Rt.push("a=rtpmap:"),Rt.push(on),Rt.push(" "),Rt.push(Lt.codecs[on].rtpmap),Rt.push(`\r
`);var hn=Lt.codecs[on]["rtcp-fb"];if(hn)for(var nn=0;nn<hn.length;nn+=1)Rt.push("a=rtcp-fb:"),Rt.push(on),Rt.push(" "),Rt.push(hn[nn]),Rt.push(`\r
`);var dn=Lt.codecs[on].fmtp;if(dn){for(var Sn=[],wn=0;wn<dn.length;wn+=1)Sn.push(dn[wn].join("="));Sn.length>0&&(Rt.push("a=fmtp:"),Rt.push(on),Rt.push(" "),Rt.push(Sn.join(";")),Rt.push(`\r
`))}continue}continue}if(qt[1]==="rtcp-fb"||qt[1]==="fmtp")continue;throw new Error("internal error")}if(en.match(/^a=mid:(\w+)$/))Rt.push("a=mid:"),Rt.push(Lt.mid),Rt.push(`\r
`),Lt.bandwidth>0&&(Rt.push("b=AS:"),Rt.push(Lt.bandwidth),Rt.push(`\r
`),Rt.push("b=TIAS:"),Rt.push(Lt.bandwidth),Rt.push("000"),Rt.push(`\r
`));else if(en!=="a=sendrecv"&&en!=="a=recvonly"&&en!=="a=sendonly"&&en!=="a=inactive"){if(!en.match(/^a=ssrc-group:SIM (.+)$/)){if(!en.match(/^a=ssrc-group:FID (.+)$/)){if(en.match(/^a=ssrc:(\d+) (.+)$/)){if(Et)continue;Et=!0;for(var En=0;En<Lt.ssrc_groups.sim.length;En+=1)Rt.push("a=ssrc-group:SIM "),Rt.push(Lt.ssrc_groups.sim[En].join(" ")),Rt.push(`\r
`);for(var Pn=0;Pn<Lt.ssrc_groups.fid.length;Pn+=1)Rt.push("a=ssrc-group:FID "),Rt.push(Lt.ssrc_groups.fid[Pn].join(" ")),Rt.push(`\r
`);for(var Wn=function(fr){var gr=Lt.ssrcs[fr];["cname","msid","mslabel","label"].forEach(function(yr){Object.prototype.hasOwnProperty.call(gr.content,yr)&&(Rt.push("a=ssrc:"),Rt.push(gr.ssrc),Rt.push(" "),Rt.push(yr),Rt.push(":"),Rt.push(gr.content[yr]),Rt.push(`\r
`))})},ir=0;ir<Lt.ssrcs.length;ir+=1)Wn(ir);continue}Rt.push(en),Rt.push(`\r
`);continue}}}else Rt.push("a="),Rt.push(Lt.direction),Rt.push(`\r
`)}else{if(en.match(/^b=/))continue;Rt.push(en),Rt.push(`\r
`)}}}return Rt.join("")};var it=et.Y.get("SDPManager"),ft=function(){it.debug("SDPManager"),this.getSDPLines=function(Kt){it.debug("SDPManager::getSDPLines");var Rt,nt=Kt.split(`\r
`);for(Rt=0;Rt<nt.length;Rt+=1)it.log("sdpLines[i] : "+nt[Rt]);return nt},this.getAudioMediaDescriptionPart=function(Kt){it.debug("SDPManager::getAudioMediaDescriptionPart");var Rt=Kt.split("m=audio"),nt=null;return Rt[1]!==void 0&&Rt[1]!==null?(nt=Rt[1].split("m=video"),it.log("SDP audio part : "+nt[0]),nt[0]):null},this.getVideoMediaDescriptionPart=function(Kt){it.debug("SDPManager::getVideoMediaDescriptionPart");var Rt,nt=Kt.split("m=video");for(Rt=0;Rt<nt.length;Rt+=1)it.log("sdpMediaPart[i] : "+nt[Rt]);return nt[1]},this.searchMediaDescriptionForRecvOnly=function(Kt){return it.debug("searchMediaDescriptionForRecvOnly"),Kt.search("a=recvonly")!==-1?(it.log("recvonly found in media description"),!0):(it.log("recvonly not found in media description"),!1)},this.searchSDPForRecvOnly=function(Kt){return Kt!==void 0?(it.log("sdpPart !== undefined"),this.searchMediaDescriptionForRecvOnly(Kt)):(it.log("recvonly not found in SDP"),!1)},this.searchMediaDescriptionForSendOnly=function(Kt){return it.debug("searchMediaDescriptionForSendOnly"),Kt.search("a=sendonly")!==-1?(it.log("sendonly found in media description"),!0):(it.log("sendonly not found in media description"),!1)},this.searchSDPForSendOnly=function(Kt){return Kt!==void 0?(it.log("sdpPart !== undefined"),this.searchMediaDescriptionForSendOnly(Kt)):(it.log("sendonly not found in SDP"),!1)},this.searchMediaDescriptionForInactive=function(Kt){return it.debug("searchMediaDescriptionForInactive"),Kt.search("a=inactive")!==-1?(it.log("inactive found in media description"),!0):(it.log("inactive not found in media description"),!1)},this.searchSDPForInactive=function(Kt){return Kt!==void 0?(it.log("sdpPart !== undefined"),this.searchMediaDescriptionForInactive(Kt)):(it.log("inactive not found in SDP"),!1)},this.stripAudioMediaDescriptionFromSDP=function(Kt){it.debug("SDPManager::stripAudioMediaDescriptionFromSDP");var Rt=this.createGuideline(Kt);return Rt.audio?(Rt.audio.direction="inactive",Rt.generate({stripInactiveMLines:!0})):Kt},this.stripVideoMediaDescriptionFromSDP=function(Kt){it.debug("SDPManager::stripVideoMediaDescriptionFromSDP");var Rt=this.createGuideline(Kt);return Rt.video?(Rt.video.direction="inactive",Rt.generate({stripInactiveMLines:!0})):Kt},this.setAudioBandwidth=function(Kt,Rt){return it.info("SDPManager::setAudioBandwidth",Rt),Rt?Kt=Kt.replace(/a=mid:audio\r\n/g,`a=mid:audio\r
b=AS:`+Rt+`\r
`):(it.warn("No maxAudioBW !"),Kt)},this.setVideoBandwidth=function(Kt,Rt){if(it.info("SDPManager::setVideoBandwidth",Rt),!Rt)return it.warn("No maxVideoBW !"),Kt;for(var nt=[],Ct=Kt.split(`\r
`),yt=0,xt=null,wt=null;yt<Ct.length;)if((xt=Ct[yt]).length!==0)if(wt!==null)xt.match(/^m=/)?wt=null:xt.match(/^a=mid:(\w+)$/)?(nt.push(xt),nt.push(`\r
`),nt.push("b=AS:"),nt.push(Rt),nt.push(`\r
`),nt.push("b=TIAS:"),nt.push(Rt),nt.push("000"),nt.push(`\r
`),yt+=1):(xt.match(/^b=([A-Z]+):(\w+)$/)||(nt.push(xt),nt.push(`\r
`)),yt+=1);else{var Lt=xt.match(/^m=([a-z]+)(.+)$/);if(Lt&&Lt[1]==="video"){wt="video",nt.push(xt),nt.push(`\r
`),yt+=1;continue}nt.push(xt),nt.push(`\r
`),yt+=1}else yt+=1;return nt.join("")},this.setDataBandwidth=function(Kt,Rt){return it.info("SDPManager::setDataBandwidth",Rt),Rt?Kt=Kt.replace(/a=mid:data\r\n/g,`a=mid:data\r
b=AS:`+Rt+`\r
`):(it.warn("No maxDataBW !"),Kt)},this.setSendOnlyForAudio=function(Kt){it.debug("SDPManager::setSendOnlyForAudio");var Rt=this.createGuideline(Kt);return(0,lt.ki)(Rt,"audio","object")&&(Rt.audio.direction="sendonly"),Rt.generate()},this.setSendOnlyForVideo=function(Kt){it.debug("SDPManager::setSendOnlyForVideo");var Rt=this.createGuideline(Kt);return(0,lt.ki)(Rt,"video","object")&&(Rt.video.direction="sendonly"),Rt.generate()},this.setSendOnly=function(Kt){it.debug("SDPManager::setSendOnly : global");var Rt=this.createGuideline(Kt);return(0,lt.ki)(Rt,"audio","object")&&(Rt.audio.direction="sendonly"),(0,lt.ki)(Rt,"video","object")&&(Rt.video.direction="sendonly"),Rt.generate()},this.setRecvOnlyForAudio=function(Kt){it.debug("SDPManager::setRecvOnlyForAudio");var Rt=this.createGuideline(Kt);return Rt.audio&&Rt.audio.direction!=="inactive"&&(Rt.audio.direction="recvonly"),Rt.generate()},this.setRecvOnlyForVideo=function(Kt){it.debug("SDPManager::setRecvOnlyForVideo");var Rt=this.createGuideline(Kt);return Rt.video&&Rt.video.direction!=="inactive"&&(Rt.video.direction="recvonly"),Rt.generate()},this.setRecvOnly=function(Kt){it.debug("SDPManager::setRecvOnly : global");var Rt=this.createGuideline(Kt);return Rt.audio&&Rt.audio.direction!=="inactive"&&(Rt.audio.direction="recvonly"),Rt.video&&Rt.video.direction!=="inactive"&&(Rt.video.direction="recvonly"),Rt.generate()},this.updateSDPcodecs=function(Kt,Rt,nt,Ct){var yt,xt,wt,Lt,Et,$t,Jt,en,qt=!1,on=new RegExp(`\r
$`),hn=!1,nn=null,dn="",Sn="",wn="",En="",Pn="",Wn="",ir="",fr="";if(it.log(`updateSDPcodecs():
	sdpType = `+Rt+`
	mediaType = `+nt+`
	availableCodecSet = `+Ct+`
`),Ct=="")return Kt;for(wt=(wt=RTCSessionDescription&&Kt instanceof RTCSessionDescription?Kt.sdp:window.SessionDescription&&Kt instanceof SessionDescription?Kt.toSdp():Kt).split(`\r
m=`),on.test(wt[wt.length-2])===!1&&(wt[wt.length-2]=wt[wt.length-2]+`\r
`,hn=!0),yt=0;yt<wt.length;yt++)if(wt[yt].indexOf(nt)===0){for(nn=wt[yt].split(`\r
`)[0].split(" "),xt=3;xt<nn.length;xt++)if(Lt=!0,isNaN(nn[xt])===!1){switch(Sn="a=rtpmap:"+nn[xt]+" ",(Et=wt[yt].indexOf(Sn))!==-1&&($t=wt[yt].indexOf(`\r
`,Et)),nn[xt]){case 0:dn="PCMU/8000";break;case 8:dn="PCMA/8000";break;case 9:dn="G722/8000";break;case 13:dn="CN/8000";break;case 18:dn="G729/8000";break;default:Et!==-1&&(dn=wt[yt].substring(Et+Sn.length,$t))}dn!=""&&Ct.indexOf(dn)!==-1?it.log("PT("+nn[xt]+"): "+dn+` FOUND in availableCodecSet.
`):(Lt=!1,it.log("PT("+nn[xt]+"): "+dn+` NOT FOUND in availableCodecSet.
`)),Lt||(wn=Sn+`.*\r
`,En="a=fmtp:"+nn[xt]+` .*\r
`,ir="a=rtcp-fb:"+nn[xt]+` .*\r
`,Pn=" "+nn[xt]+" ",Wn=" "+nn[xt]+"\r",wt[yt]=wt[yt].replace(new RegExp(wn,"g"),""),wt[yt]=wt[yt].replace(new RegExp(En,"g"),""),wt[yt]=wt[yt].replace(new RegExp(ir,"g"),""),(en=(Jt=wt[yt].split(`
`))[0].split("RTP"))[1]=en[1].replace(Pn," "),en[1]=en[1].replace(Wn,"\r"),Jt[0]=en.join("RTP"),wt[yt]=Jt.join(`
`),nt==="video"&&(ir="a=rtcp-fb:"+nn[xt]+` .*\r
`,wt[yt]=wt[yt].replace(new RegExp(ir,"g"),""),dn!=""&&dn.substr(0,4)==="rtx/"&&(fr=`a=ssrc-group:FID .*\r
`,wt[yt]=wt[yt].replace(new RegExp(fr,"g"),""),(Jt=wt[yt].split(`\r
a=`)).splice(Jt.length-8,4),wt[yt]=Jt.join(`\r
a=`))),qt=!0)}break}return hn&&(wt[wt.length-2]=wt[wt.length-2].substr(0,wt[wt.length-2].length-2)),wt=wt.join(`\r
m=`),qt===!0?(it.log("updateSDPcodecs(), SDP has been updated."),RTCSessionDescription&&Kt instanceof RTCSessionDescription?new RTCSessionDescription({type:Rt,sdp:wt}):window.SessionDescription&&Kt instanceof SessionDescription?new SessionDescription(wt):wt):(it.log("updateSDPcodecs(), SDP has not been updated."),Kt)},this.preferOpus=function(Kt){var Rt,nt=Kt.split(`\r
`),Ct=0,yt=null;for(Rt=0;Rt<nt.length;Rt+=1)if(nt[Rt].search("m=audio")!==-1){Ct=Rt;break}if(Ct===0)return Kt;for(Rt=0;Rt<nt.length;Rt+=1)if(nt[Rt].search("opus/48000")!==-1){(yt=this.extractSdp(nt[Rt],/:(\d+) opus\/48000/i))&&(nt[Ct]=this.setDefaultCodec(nt[Ct],yt));break}return(nt=this.removeCN(nt,Ct)).join(`\r
`)},this.removeCN=function(Kt,Rt){var nt=0,Ct=Kt[Rt].split(" "),yt=null,xt=0;for(nt=Kt.length-1;nt>=0;nt--)(yt=this.extractSdp(Kt[nt],/a=rtpmap:(\d+) CN\/\d+/i))&&((xt=Ct.indexOf(yt))!==-1&&Ct.splice(xt,1),Kt.splice(nt,1));return Kt[Rt]=Ct.join(" "),Kt},this.extractSdp=function(Kt,Rt){var nt=Kt.match(Rt);return nt&&nt.length==2?nt[1]:null},this.setDefaultCodec=function(Kt,Rt){var nt=0,Ct=Kt.split(" "),yt=Ct.slice(0,3);for(yt.push(Rt),nt=3;nt<Ct.length;nt++)Ct[nt]!==Rt&&yt.push(Ct[nt]);return yt.join(" ")},this.findLineInRange=function(Kt,Rt,nt,Ct,yt){var xt,wt=nt!==-1?nt:Kt.length;for(xt=Rt;xt<wt;++xt)if(Kt[xt].indexOf(Ct)===0&&(!yt||Kt[xt].toLowerCase().indexOf(yt.toLowerCase())!==-1))return xt;return null},this.findLine=function(Kt,Rt,nt){return this.findLineInRange(Kt,0,-1,Rt,nt)},this.getCodecPayloadType=function(Kt,Rt){var nt=this.findLine(Kt,"a=rtpmap",Rt);return nt?this.getCodecPayloadTypeFromLine(Kt[nt]):null},this.getCodecPayloadTypeFromLine=function(Kt){var Rt=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),nt=Kt.match(Rt);return nt&&nt.length===2?nt[1]:null},this.findFmtpLine=function(Kt,Rt){var nt=this.getCodecPayloadType(Kt,Rt);return nt?this.findLine(Kt,"a=fmtp:"+nt.toString()):null},this.writeFmtpLine=function(Kt){if(!Kt.hasOwnProperty("pt")||!Kt.hasOwnProperty("params"))return null;var Rt=Kt.pt,nt=Kt.params,Ct=[],yt=0,xt=null;for(xt in nt)Ct[yt]=xt+"="+nt[xt],++yt;return yt===0?null:"a=fmtp:"+Rt.toString()+" "+Ct.join("; ")},this.setCodecParam=function(Kt,Rt,nt,Ct){var yt=Kt.split(`\r
`),xt=this.findFmtpLine(yt,Rt),wt={},Lt=null,Et=null;if(xt===null){if((Et=this.findLine(yt,"a=rtpmap",Rt))===null)return Kt;Lt=this.getCodecPayloadTypeFromLine(yt[Et]),wt.pt=Lt.toString(),wt.params={},wt.params[nt]=Ct,yt.splice(Et+1,0,this.writeFmtpLine(wt))}else(wt=function($t){var Jt,en={},qt=$t.indexOf(" "),on=$t.substring(qt+1).split("; "),hn=new RegExp("a=fmtp:(\\d+)"),nn=$t.match(hn),dn={},Sn=null;if(!nn||nn.length!==2)return null;for(en.pt=nn[1],Jt=0;Jt<on.length;++Jt)(Sn=on[Jt].split("=")).length===2&&(dn[Sn[0]]=Sn[1]);return en.params=dn,en}(yt[xt])).params[nt]=Ct,yt[xt]=this.writeFmtpLine(wt);return yt.join(`\r
`)},this.maybePreferCodec=function(Kt,Rt,nt){var Ct,yt,xt=Rt+" codec",wt=null;return nt?(it.log("Prefer "+xt+": "+nt),wt=Kt.split(`\r
`),(Ct=this.findLine(wt,"m=",Rt))===null?(it.log("mLineIndex === null"),Kt):((yt=this.getCodecPayloadType(wt,nt))&&(wt[Ct]=this.setDefaultCodec(wt[Ct],yt)),Kt=wt.join(`\r
`))):(it.log("No preference on "+xt+"."),Kt)},this.createGuideline=ct};function mt(Kt,Rt){(Rt==null||Rt>Kt.length)&&(Rt=Kt.length);for(var nt=0,Ct=new Array(Rt);nt<Rt;nt++)Ct[nt]=Kt[nt];return Ct}function Tt(Kt,Rt){for(var nt=0;nt<Rt.length;nt++){var Ct=Rt[nt];Ct.enumerable=Ct.enumerable||!1,Ct.configurable=!0,"value"in Ct&&(Ct.writable=!0),Object.defineProperty(Kt,Ct.key,Ct)}}function It(){return!0}function Pt(Kt){return Kt===null}function At(Kt){return Kt!==null}s(9753),s(1038),s(4553),s(9070);var Nt=function(){function Kt(){(function(Ct,yt){if(!(Ct instanceof yt))throw new TypeError("Cannot call a class as a function")})(this,Kt),this._callbacks=[],this._timeout=null,this._err=null,this._data=null,this._interrupted=null,this._fulfilled=!1}var Rt,nt;return Rt=Kt,nt=[{key:"err",get:function(){if(!this._fulfilled)throw new Error("not fulfilled yet");return this._err}},{key:"data",get:function(){if(!this._fulfilled)throw new Error("not fulfilled yet");return this._data}},{key:"interrupted",get:function(){if(!this._fulfilled)throw new Error("not fulfilled yet");return this._interrupted}},{key:"fulfilled",get:function(){return this._fulfilled}},{key:"_fulfill",value:function(Ct,yt,xt){this._err=Ct,this._data=yt,this._interrupted=xt,this._fulfilled=!0;var wt=this._callbacks.slice();this.clear();var Lt,Et=function(qt,on){var hn=typeof Symbol<"u"&&qt[Symbol.iterator]||qt["@@iterator"];if(!hn){if(Array.isArray(qt)||(hn=function(Pn,Wn){if(Pn){if(typeof Pn=="string")return mt(Pn,Wn);var ir=Object.prototype.toString.call(Pn).slice(8,-1);return ir==="Object"&&Pn.constructor&&(ir=Pn.constructor.name),ir==="Map"||ir==="Set"?Array.from(Pn):ir==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ir)?mt(Pn,Wn):void 0}}(qt))||on&&qt&&typeof qt.length=="number"){hn&&(qt=hn);var nn=0,dn=function(){};return{s:dn,n:function(){return nn>=qt.length?{done:!0}:{done:!1,value:qt[nn++]}},e:function(Pn){throw Pn},f:dn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Sn,wn=!0,En=!1;return{s:function(){hn=hn.call(qt)},n:function(){var Pn=hn.next();return wn=Pn.done,Pn},e:function(Pn){En=!0,Sn=Pn},f:function(){try{wn||hn.return==null||hn.return()}finally{if(En)throw Sn}}}}(wt);try{for(Et.s();!(Lt=Et.n()).done;){var $t=Lt.value,Jt=$t.match,en=$t.callback;Jt(this._err)&&en(this._err,this._data,this._interrupted)}}catch(qt){Et.e(qt)}finally{Et.f()}}},{key:"clear",value:function(){this.clearTimeout(),this.removeCallback()}},{key:"setTimeout",value:function(Ct){function yt(xt,wt,Lt){return Ct.apply(this,arguments)}return yt.toString=function(){return Ct.toString()},yt}(function(Ct,yt,xt){var wt=this;this.clearTimeout(),this._timeout=setTimeout(yt===null?function(){wt._fulfill(null,xt,!0)}:function(){wt._fulfill(typeof yt=="string"?new Error(yt):yt,void 0,!0)},Ct)})},{key:"clearTimeout",value:function(Ct){function yt(){return Ct.apply(this,arguments)}return yt.toString=function(){return Ct.toString()},yt}(function(){this._timeout!==null&&(clearTimeout(this._timeout),this._timeout=null)})},{key:"onFulfillment",value:function(Ct){this._callbacks.push({match:It,callback:Ct})}},{key:"onSuccess",value:function(Ct){this._callbacks.push({match:Pt,callback:Ct})}},{key:"onFailure",value:function(Ct){this._callbacks.push({match:At,callback:Ct})}},{key:"removeCallback",value:function(Ct){if(typeof Ct=="function"){var yt=this._callbacks.findIndex(function(xt){return xt.callback===Ct});yt>=0&&this._callbacks.splice(yt,1)}else this._callbacks.splice(0,this._callbacks.length)}},{key:"fulfill",value:function(Ct,yt){Ct===null?this._fulfill(null,yt,!1):this._fulfill(typeof Ct=="string"?new Error(Ct):Ct,void 0,!1)}}],nt&&Tt(Rt.prototype,nt),Object.defineProperty(Rt,"prototype",{writable:!1}),Kt}(),Ot=(s(1249),s(7327),s(3843),function(Kt,Rt,nt,Ct,yt,xt,wt,Lt){this.rawStats={},this.rawStats.connectedPair=[],this.rawStats.audio_send=[],this.rawStats.audio_recv=[],this.rawStats.video_send=[],this.rawStats.video_recv=[],this.instantRTT=0,this.moyRttCP=[0,0,0,0,0,0,0,0,0,0],this.moyRttAS=[0,0,0,0,0,0,0,0,0,0],this.moyRttVS=[0,0,0,0,0,0,0,0,0,0],this.tauxPacketLossAS=[0],this.oldLostAS=this.oldSentAS=0,this.oldLostVS=this.oldLostVS=0,this.cptTaux=0,this.tauxPacketLossVS=[0],this.oldBandwidthAS=0,this.oldBandwidthVS=0,this.oldBandwidthAR=0,this.oldBandwidthVR=0,this.bandwidthAS=[0,0,0,0,0,0,0,0,0,0],this.bandwidthAR=[0,0,0,0,0,0,0,0,0,0],this.bandwidthVS=[0,0,0,0,0,0,0,0,0,0],this.bandwidthVR=[0,0,0,0,0,0,0,0,0,0],this.qosIn=0,this.qosInAverage=0,this.qosInAverageCount=0,this.qosAudioIn=0,this.qosAudioInAverage=0,this.qosAudioInAverageCount=0,this.qosVideoIn=0,this.qosVideoInAverage=0,this.qosVideoInAverageCount=0,this.qosOut=0,this.qosOutAverage=0,this.qosOutAverageCount=0,this.qosAudioOut=0,this.qosAudioOutAverage=0,this.qosAudioOutAverageCount=0,this.qosVideoOut=0,this.qosVideoOutAverage=0,this.qosVideoOutAverageCount=0,this.onQosChange=Rt,this.onQosAudioChange=nt,this.onQosVideoChange=Ct,this.cpt=0,this.cptRes=5,this.cptDb=60,this.saveStatsFlag=!0,this.tabQosIn=[],this.tabQosAudioIn=[],this.tabQosVideoIn=[],this.tabQosOut=[],this.tabQosAudioOut=[],this.tabQosVideoOut=[],this.tabTimestamp=[],this.tabDelay=[],this.tabJitterBufferAudio=[],this.tabJitterBufferVideo=[],this.tabAudioRtt=[],this.tabVideoRtt=[],this.tabAudioBW=[],this.tabVideoBW=[],this.clientId=wt,this.callId=yt,this.apiKey=xt,this.socket=Lt,this.interval=Kt,this.insertStats=function(Et,$t,Jt,en){var qt,on,hn,nn=null;for(this.cpt=this.cpt+this.interval,qt=0;qt<Et.length;++qt){var dn=Et[qt];switch(dn.type){case"googCandidatePair":for(nn=dn.names(),hn=0;hn<nn.length;++hn)if(nn[hn]=="googActiveConnection"&&dn.stat(nn[hn])=="true")for(on=0;on<nn.length;++on)nn[on]=="bytesSent"&&dn.stat(nn[on])!==void 0&&(this.rawStats.connectedPair.bytesSent=dn.stat(nn[on])),nn[on]=="bytesReceived"&&dn.stat(nn[on])!==void 0&&(this.rawStats.connectedPair.bytesReceived=dn.stat(nn[on])),nn[on]=="googRtt"&&dn.stat(nn[on])!==void 0&&(this.rawStats.connectedPair.googRtt=dn.stat(nn[on]));break;case"ssrc":for(nn=dn.names(),hn=0;hn<nn.length;++hn){if(nn[hn]=="audioOutputLevel")for(on=0;on<nn.length;++on)nn[on]=="packetsLost"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_recv.packetsLost=dn.stat(nn[on])),nn[on]=="googDecodingPLC"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_recv.googDecodingPLC=dn.stat(nn[on])),nn[on]=="googJitterReceived"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_recv.googJitterReceived=dn.stat(nn[on])),nn[on]=="googJitterBufferMs"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_recv.googJitterBufferMs=dn.stat(nn[on])),nn[on]=="googCurrentDelayMs"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_recv.googCurrentDelayMs=dn.stat(nn[on])),nn[on]=="bytesReceived"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_recv.bytesReceived=dn.stat(nn[on]));if(nn[hn]=="audioInputLevel")for(on=0;on<nn.length;++on)nn[on]=="googRtt"&&dn.stat(nn[on])!==void 0&&dn.stat(nn[on])!=-1&&(this.rawStats.audio_send.googRtt=dn.stat(nn[on])),nn[on]=="packetsLost"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_send.packetsLost=dn.stat(nn[on])),nn[on]=="packetsSent"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_send.packetsSent=dn.stat(nn[on])),nn[on]=="bytesSent"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_send.bytesSent=dn.stat(nn[on])),nn[on]=="googJitterReceived"&&dn.stat(nn[on])!==void 0&&(this.rawStats.audio_send.googJitterReceived=dn.stat(nn[on]));if(nn[hn]=="googFrameHeightReceived")for(on=0;on<nn.length;++on)nn[on]=="googFrameHeightReceived"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_recv.FrameHeight=dn.stat(nn[on])),nn[on]=="googFrameWidthReceived"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_recv.FrameWidth=dn.stat(nn[on])),nn[on]=="googCurrentDelayMs"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_recv.delay=dn.stat(nn[on])),nn[on]=="packetsLost"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_recv.packetsLost=dn.stat(nn[on])),nn[on]=="googNacksSent"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_recv.googNacksSent=dn.stat(nn[on])),nn[on]=="googJitterBufferMs"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_recv.googJitterBufferMs=dn.stat(nn[on])),nn[on]=="bytesReceived"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_recv.bytesReceived=dn.stat(nn[on])),nn[on]=="googFrameRateReceived"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_recv.googFrameRateReceived=dn.stat(nn[on]));if(nn[hn]=="googFrameHeightSent")for(on=0;on<nn.length;++on)nn[on]=="googFrameHeightSent"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_send.FrameHeight=dn.stat(nn[on])),nn[on]=="googFrameWidthSent"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_send.FrameWidth=dn.stat(nn[on])),nn[on]=="packetsLost"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_send.packetsLost=dn.stat(nn[on])),nn[on]=="googNacksReceived"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_send.googNacksReceived=dn.stat(nn[on])),nn[on]=="googRtt"&&dn.stat(nn[on])!==void 0&&dn.stat(nn[on])!=-1&&(this.rawStats.video_send.googRtt=dn.stat(nn[on])),nn[on]=="packetsSent"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_send.packetsSent=dn.stat(nn[on])),nn[on]=="bytesSent"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_send.bytesSent=dn.stat(nn[on])),nn[on]=="googEncodeUsagePercent"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_send.googEncodeUsagePercent=dn.stat(nn[on])),nn[on]=="googCpuLimitedResolution"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_send.googCpuLimitedResolution=dn.stat(nn[on])),nn[on]=="googBandwidthLimitedResolution"&&dn.stat(nn[on])!==void 0&&(this.rawStats.video_send.googBandwidthLimitedResolution=dn.stat(nn[on]))}}}this.computeStats($t,Jt,en),this.cpt%this.cptRes==0&&this.saveStatsLocal(),this.cpt%this.cptDb==0&&this.saveStatsToDb(!1)},this.saveStatsLocal=function(){if(this.saveStatsFlag){var Et=Date.now();this.tabTimestamp.push(Et),this.tabQosIn.push(this.qosIn),this.tabQosAudioIn.push(this.qosAudioIn),this.qosVideoIn!==0&&this.tabQosVideoIn.push(this.qosVideoIn),this.tabQosOut.push(this.qosOut),this.tabQosAudioOut.push(this.qosAudioOut),this.qosVideoOut!==0&&this.tabQosVideoOut.push(this.qosVideoOut),this.tabJitterBufferAudio.push(this.rawStats.audio_recv.googJitterBufferMs),this.rawStats.video_recv.googJitterBufferMs!==void 0&&this.tabJitterBufferVideo.push(this.rawStats.video_recv.googJitterBufferMs),this.rawStats.video_send.googRtt!==void 0&&this.tabVideoRtt.push(this.rawStats.video_send.googRtt),this.tabAudioRtt.push(this.rawStats.audio_send.googRtt),this.bandwidthAS!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthAS)/1024),this.bandwidthVS!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthVS)/1024),this.bandwidthAR!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthAR)/1024),this.bandwidthVR!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthVR)/1024)}},this.saveStatsToDb=function(Et){},this.saveStatsToDb=function(Et){this.saveStatsFlag=Et},this.computeStats=function(Et,$t,Jt){var en=0;this.rawStats.connectedPair.googRtt!==-1&&this.rawStats.connectedPair.googRtt!==0&&this.rawStats.connectedPair.googRtt!==void 0&&this.add(this.rawStats.connectedPair.googRtt,this.moyRttCP),this.rawStats.video_send.googRtt!==-1&&this.rawStats.video_send.googRtt!==0&&this.rawStats.video_send.googRtt!==void 0&&(this.add(this.rawStats.video_send.googRtt,this.moyRttVS),this.instantRTT=this.rawStats.video_send.googRtt),this.rawStats.audio_send.googRtt!==-1&&this.rawStats.audio_send.googRtt!==0&&this.rawStats.audio_send.googRtt!==void 0&&this.add(this.rawStats.audio_send.googRtt,this.moyRttAS),this.rawStats.audio_send.packetsLost!==-1&&this.rawStats.audio_send.packetsLost!==void 0&&this.rawStats.audio_send.packetsSent!==-1&&this.rawStats.audio_send.packetsSent!==0&&this.rawStats.audio_send.packetsSent!==void 0&&(en=100*(this.rawStats.audio_send.packetsLost-this.oldLostAS)/(this.rawStats.audio_send.packetsSent-this.oldSentAS),this.oldLostAS=this.rawStats.audio_send.packetsLost,this.oldSentAS=this.rawStats.audio_send.packetsSent,this.add(en,this.tauxPacketLossAS)),this.rawStats.video_send.packetsLost!==-1&&this.rawStats.video_send.packetsLost!==void 0&&this.rawStats.video_send.packetsSent!==-1&&this.rawStats.video_send.packetsSent!==0&&this.rawStats.video_send.packetsSent!==void 0&&(en=100*(this.rawStats.video_send.packetsLost-this.oldLostVS)/(this.rawStats.video_send.packetsSent-this.oldSentVS),this.oldLostVS=this.rawStats.video_send.packetsLost,this.oldSentVS=this.rawStats.video_send.packetsSent,this.add(en,this.tauxPacketLossVS)),this.rawStats.audio_recv.bytesReceived!==-1&&this.rawStats.audio_recv.bytesReceived!==void 0&&(this.oldBandwidthAR===void 0&&(this.oldBandwidthAR=0),this.add((this.rawStats.audio_recv.bytesReceived-this.oldBandwidthAR)/this.interval,this.bandwidthAR),this.oldBandwidthAR=this.rawStats.audio_recv.bytesReceived),this.rawStats.video_recv.bytesReceived!==-1&&this.rawStats.video_recv.bytesReceived!==void 0&&(this.oldBandwidthVR===void 0&&(this.oldBandwidthVR=0),this.add((this.rawStats.video_recv.bytesReceived-this.oldBandwidthVR)/this.interval,this.bandwidthVR),this.oldBandwidthVR=this.rawStats.video_recv.bytesReceived),this.rawStats.audio_send.bytesSent!==-1&&this.rawStats.audio_send.bytesSent!==void 0&&(this.oldBandwidthAS===void 0&&(this.oldBandwidthAS=0),this.add((this.rawStats.audio_send.bytesSent-this.oldBandwidthAS)/this.interval,this.bandwidthAS),this.oldBandwidthAS=this.rawStats.audio_send.bytesSent),this.rawStats.video_send.bytesSent!==-1&&this.rawStats.video_send.bytesSent!==void 0&&(this.oldBandwidthVS===void 0&&(this.oldBandwidthVS=0),this.add((this.rawStats.video_send.bytesSent-this.oldBandwidthVS)/this.interval,this.bandwidthVS),this.oldBandwidthVS=this.rawStats.video_send.bytesSent);var qt=0,on=0,hn=0,nn=0,dn=0,Sn=0,wn=0,En=0,Pn=0,Wn=0,ir=this.getCodecs($t),fr=8*this.Average(this.bandwidthAS)/1024;if(fr<5?qt=1:fr>=5&&fr<10?qt=2:fr>=10&&(qt=3),ir!==null&&ir[1]){var gr=8*this.Average(this.bandwidthVS)/1024;gr<240?nn=1:gr>=240&&gr<330?nn=2:gr>=330&&(nn=3)}this.rawStats.audio_recv.googJitterBufferMs<60?on=3:this.rawStats.audio_recv.googJitterBufferMs>=60&&this.rawStats.audio_recv.googJitterBufferMs<100?on=2:this.rawStats.audio_recv.googJitterBufferMs>=100&&(on=1),this.rawStats.audio_recv.googCurrentDelayMs<100?hn=3:this.rawStats.audio_recv.googCurrentDelayMs>=100&&this.rawStats.audio_recv.googCurrentDelayMs<200?hn=2:this.rawStats.audio_recv.googCurrentDelayMs>=200&&(hn=1),ir!==null&&ir[1]&&(this.rawStats.video_recv.googJitterBufferMs<100?dn=3:this.rawStats.video_recv.googJitterBufferMs>=100&&this.rawStats.video_recv.googJitterBufferMs<200?dn=2:this.rawStats.video_recv.googJitterBufferMs>=200&&(dn=1));var yr=!1,Rr=!1,kr=!1;ir!==null&&ir[1]?(Math.ceil((qt+2*nn+dn+on+hn)/6)!=this.qosIn&&(yr=!0),this.qosIn=Math.ceil((qt+2*nn+dn+on+hn)/6),this.qosInAverage=(this.qosInAverage*this.qosInAverageCount+this.qosIn)/(this.qosInAverageCount+1),this.qosInAverageCount++,Math.ceil((qt+on+hn)/3)!=this.qosAudioIn&&(Rr=!0),this.qosAudioIn=Math.ceil((qt+on+hn)/3),this.qosAudioInAverage=(this.qosAudioInAverage*this.qosAudioInAverageCount+this.qosAudioIn)/(this.qosAudioInAverageCount+1),this.qosAudioInAverageCount++,Math.ceil((2*nn+dn)/3)!=this.qosVideoIn&&(kr=!0),this.qosVideoIn=Math.ceil((2*nn+dn)/3),this.qosVideoInAverage=(this.qosVideoInAverage*this.qosVideoInAverageCount+this.qosVideoIn)/(this.qosVideoInAverageCount+1),this.qosVideoInAverageCount++):(Math.ceil((qt+on+hn)/3)!=this.qosOut&&(yr=!0),this.qosIn=Math.ceil((qt+on+hn)/3),this.qosInAverage=(this.qosInAverage*this.qosInAverageCount+this.qosIn)/(this.qosInAverageCount+1),this.qosInAverageCount++,Math.ceil((qt+on+hn)/3)!=this.qosAudioIn&&(Rr=!0),this.qosAudioIn=Math.ceil((qt+on+hn)/3),this.qosAudioInAverage=(this.qosAudioInAverage*this.qosAudioInAverageCount+this.qosAudioIn)/(this.qosAudioInAverageCount+1),this.qosAudioInAverageCount++),this.RttAverage(this.moyRttAS)<80?wn=3:this.RttAverage(this.moyRttAS)>=80&&this.RttAverage(this.moyRttAS)<150?wn=2:this.RttAverage(this.moyRttAS)>=150&&(wn=1),this.tauxPacketLossAS<=5?Sn=3:this.tauxPacketLossAS>5&&this.tauxPacketLossAS<10?Sn=2:this.tauxPacketLossAS>=10&&(Sn=1),this.rawStats.audio_recv.googJitterReceived<80?En=3:this.rawStats.audio_recv.googJitterReceived>=80&&this.rawStats.audio_recv.googJitterReceived<150?En=2:this.rawStats.audio_recv.googJitterReceived>=150&&(En=1),ir!==null&&ir[1]&&(this.tauxPacketLossVS<=5?Pn=3:this.tauxPacketLossVS>5&&this.tauxPacketLossVS<10?Pn=2:this.tauxPacketLossVS>=10&&(Pn=1),this.RttAverage(this.moyRttVS)<80?Wn=3:this.RttAverage(this.moyRttVS)>=80&&this.RttAverage(this.moyRttVS)<150?Wn=2:this.RttAverage(this.moyRttVS)>=150&&(Wn=1)),ir!==null&&ir[1]?(Math.ceil((wn+2*Sn+En+2*Pn+Wn)/7)!=this.qosOut&&(yr=!0),this.qosOut=Math.ceil((wn+2*Sn+En+2*Pn+Wn)/7),this.qosOutAverage=(this.qosOutAverage*this.qosOutAverageCount+this.qosOut)/(this.qosOutAverageCount+1),this.qosOutAverageCount++,Math.ceil((wn+2*Sn+En)/4)!=this.qosAudioOut&&(Rr=!0),this.qosAudioOut=Math.ceil((wn+2*Sn+En)/4),this.qosAudioOutAverage=(this.qosAudioOutAverage*this.qosAudioOutAverageCount+this.qosAudioOut)/(this.qosAudioOutAverageCount+1),this.qosAudioOutAverageCount++,Math.ceil((2*Pn+Wn)/3)!=this.qosVideoOut&&(kr=!0),this.qosVideoOut=Math.ceil((2*Pn+Wn)/3),this.qosVideoOutAverage=(this.qosVideoOutAverage*this.qosVideoOutAverageCount+this.qosVideoOut)/(this.qosVideoOutAverageCount+1),this.qosVideoOutAverageCount++):(Math.ceil((wn+2*Sn+En)/4)!=this.qosOut&&(yr=!0),this.qosOut=Math.ceil((wn+2*Sn+En)/4),this.qosOutAverage=(this.qosOutAverage*this.qosOutAverageCount+this.qosOut)/(this.qosOutAverageCount+1),this.qosOutAverageCount++,Math.ceil((wn+2*Sn+En)/4)!=this.qosAudioOut&&(Rr=!0),this.qosAudioOut=Math.ceil((wn+2*Sn+En)/4),this.qosAudioOutAverage=(this.qosAudioOutAverage*this.qosAudioOutAverageCount+this.qosAudioOut)/(this.qosAudioOutAverageCount+1),this.qosAudioOutAverageCount++),yr&&this.onQosChange(this.qosIn,this.qosOut),Rr&&this.onQosAudioChange(this.qosAudioIn,this.qosAudioOut),kr&&this.onQosVideoChange(this.qosVideoIn,this.qosVideoOut)},this.getCodecs=function(Et){var $t=!1,Jt=!1,en=null,qt=null;if(Et!=null&&Et.sdp!==void 0){for(var on=Et.sdp.split(`
`),hn=0;hn<on.length;hn++)on[hn].indexOf("a=mid:audio")!=-1&&($t=!0),on[hn].indexOf("a=mid:video")!=-1&&(Jt=!0),$t&&on[hn].indexOf("a=rtpmap:")!=-1&&(en=on[hn],$t=!1),Jt&&on[hn].indexOf("a=rtpmap:")!=-1&&(qt=on[hn],Jt=!1);return[en,qt]}return null},this.getQosScore=function(){return[this.qosIn,this.qosOut,this.qosAudioIn,this.qosAudioOut,this.qosVideoIn,this.qosVideoOut]},this.getStat=function(Et){switch(Et){case"AudioOutBandwidth":return 8*this.Average(this.bandwidthAS)/1024;case"VideoOutBandwidth":return 8*this.Average(this.bandwidthVS)/1024;case"AudioInBandwidth":return 8*this.Average(this.bandwidthAR)/1024;case"VideoInBandwidth":return 8*this.Average(this.bandwidthVR)/1024;case"AudioInJitterReceived":return this.rawStats.audio_recv.googJitterReceived;case"AudioInJitterBufferMs":return this.rawStats.audio_recv.googJitterBufferMs;case"AudioInDelay":return this.rawStats.audio_recv.googCurrentDelayMs;case"AudioOutLossRate":return this.tauxPacketLossAS;case"AudioOutRtt":return this.RttAverage(this.moyRttAS);case"AudioOutJitterReceived":return this.rawStats.audio_send.googJitterReceived;case"VideoInJitterBufferMs":return this.rawStats.video_recv.googJitterBufferMs;case"VideoOutLossRate":return this.tauxPacketLossVS;case"VideoOutRtt":return this.RttAverage(this.moyRttVS)}},this.getAllStats=function(){for(var Et={AudioRecv:{},AudioSend:{},VideoRecv:{},VideoSend:{}},$t={AudioRecv:"audio_recv",VideoRecv:"video_recv",AudioSend:"audio_send",VideoSend:"video_send"},Jt=Object.keys($t),en=0;en<Jt.length;en++)for(var qt=Object.keys(this.rawStats[$t[Jt[en]]]),on=0;on<qt.length;on++)Et[Jt[en]][qt[on]]=this.rawStats[$t[Jt[en]]][qt[on]];return Et.AudioRecv.bandwidth=8*this.Average(this.bandwidthAR)/1024,Et.VideoRecv.bandwidth=8*this.Average(this.bandwidthVR)/1024,Et.AudioSend.bandwidth=8*this.Average(this.bandwidthAS)/1024,Et.VideoSend.bandwidth=8*this.Average(this.bandwidthVS)/1024,Et.AudioRecv.jitterReceived=this.rawStats.audio_recv.googJitterReceived,Et.AudioRecv.jitterBufferMs=this.rawStats.audio_recv.googJitterBufferMs,Et.VideoRecv.jitterBufferMs=this.rawStats.video_recv.googJitterBufferMs,Et.AudioRecv.delay=this.rawStats.audio_recv.googCurrentDelayMs,Et.AudioSend.rtt=this.RttAverage(this.moyRttAS),Et.VideoSend.moyRtt=this.RttAverage(this.moyRttVS),Et.VideoSend.rtt=this.instantRTT,Et.VideoSend.FrameHeight=this.rawStats.video_send.FrameHeight,Et.VideoSend.FrameWidth=this.rawStats.video_send.FrameWidth,Et.AudioSend.packetLostRatio=this.tauxPacketLossAS[this.tauxPacketLossAS.length-1],Et.VideoSend.packetLostRatio=this.tauxPacketLossVS[this.tauxPacketLossVS.length-1],Et.VideoSend.googEncodeUsagePercent=this.rawStats.video_send.googEncodeUsagePercent,Et.VideoSend.googCpuLimitedResolution=this.rawStats.video_send.googCpuLimitedResolution,Et.VideoSend.googBandwidthLimitedResolution=this.rawStats.video_send.googBandwidthLimitedResolution,delete Et.AudioRecv.googCurrentDelayMs,delete Et.AudioRecv.googJitterReceived,delete Et.AudioRecv.googJitterBufferMs,delete Et.VideoRecv.googJitterBufferMs,delete Et.AudioSend.googRtt,delete Et.VideoSend.googRtt,Et},this.displayComputedStats=function(){console.log("Audio IN JitterReceived:"+this.rawStats.audio_recv.googJitterReceived+" jitterbufferMs:"+this.rawStats.audio_recv.googJitterBufferMs+" delay:"+this.rawStats.audio_recv.googCurrentDelayMs+" bandwidth :"+8*this.Average(this.bandwidthAS)/1024+" kBits/s"),console.log("Audio OUT  lossRate:"+this.tauxPacketLossAS+" rtt:"+this.RttAverage(this.moyRttAS)+" googJitterReceived:"+this.rawStats.audio_recv.googJitterReceived),console.log("Video IN jitter buffer ms:"+this.rawStats.video_recv.googJitterBufferMs+" bandwidth:"+8*this.Average(this.bandwidthVS)/1024+" kBits/s"),console.log("Video OUT loss rate:"+this.tauxPacketLossVS+" rtt:"+this.RttAverage(this.moyRttVS))},this.RttAverage=function(Et){for(var $t=0,Jt=0,en=0;en<Et.length;++en)Et[en]!==0&&Et[en]!==-1&&Et[en]!==void 0&&($t+=parseInt(Et[en],10),Jt++);return parseInt($t/Jt,10)},this.Average=function(Et){for(var $t=0,Jt=0,en=0;en<Et.length;++en)Et[en]!=-1&&Et[en]!==void 0&&($t+=parseInt(Et[en],10),Jt++);return parseInt($t/Jt,10)},this.add=function(Et,$t){$t.pop(),$t.unshift(Et)},this.displayTab=function(Et){for(var $t in Et)console.log($t+" = "+Et[$t])}}),Mt=et.Y.get("DataChannelFileSender"),bt=apiCC.myWebRTC_Event,Wt=1<<17,zt=function(Kt){this.call=Kt,this.sendChunkNb=0,this.send=function(Rt,nt,Ct){var yt=12e3,xt={},wt=null,Lt={},Et=!1,$t={};if(Mt.info("DataChannelFileSender send"),Mt.log("data.name :"+Rt.name),Rt.file instanceof Blob?(Mt.log("Blob"),this.blob=Rt.file,this.contentType=Rt.file.type,this.size=Rt.file.size,this.originalDataType="Blob"):Rt.file instanceof ArrayBuffer?(Mt.log("ArrayBuffer"),this.blob=Rt.file,this.contentType="application/octet-stream",this.size=Rt.file.byteLength,this.originalDataType="ArrayBuffer"):Rt.file instanceof String||typeof Rt.file=="string"?(Mt.log("string"),this.blob=Rt.file,this.size=Rt.file.length,this.contentType="application/octet-stream",this.originalDataType="String"):(Mt.log("unknown type"),this.blob=Rt.file,this.contentType="application/octet-stream",this.size=Rt.file.length||Rt.file.byteLength||Rt.file.size,this.originalDataType="Unknown"),this.contentType||(this.contentType="application/octet-stream"),this.size===0)return Mt.log("sending done"),Ct!==void 0&&(Mt.log("onProgress"),this.transferDuration=new Date-this.startingDate,Ct({sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Kt.callId,uuid:Rt.uuid,remoteId:Kt.remoteId,lastPacket:Et,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!0})),bt.createEvent({eventType:"onFileProgress",sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Kt.callId,uuid:Rt.uuid,remoteId:Kt.remoteId,lastPacket:Et,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!0}),void bt.createEvent({eventType:"onFileSended",callId:Kt.callId,remoteId:Kt.remoteId,name:Rt.name,uuid:Rt.uuid});if(nt)if(nt.readyState==="open"){if(this.sendChunkNb===0&&Mt.log("first packet"),this.sendChunkNb===0){Rt.uuid=(Math.random()*new Date().getTime()).toString(36).replace(/\./g,"-"),Lt={name:Rt.name,type:Rt.type,size:this.size,contentType:this.contentType,uuid:Rt.uuid},Mt.log("first packet",Lt),this.fileSize=this.size,Ct!==void 0&&(Mt.log("onProgress"),this.startingDate=new Date,this.transferDuration=0,Ct({sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Kt.callId,uuid:Rt.uuid,remoteId:Kt.remoteId,lastPacket:Et,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}),bt.createEvent({eventType:"onFileProgress",sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Kt.callId,uuid:Rt.uuid,remoteId:Kt.remoteId,lastPacket:Et,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}));try{nt.send(JSON.stringify(Lt))}catch(Jt){Mt.warn("error detected when sending on datachannel :",nt),Mt.warn("error is :",Jt)}bt.createEvent({eventType:"onFileSending",callId:Kt.callId,remoteId:Kt.remoteId,name:Rt.name,uuid:Rt.uuid})}else{yt<this.size?(Mt.log("sending chunk"),xt=this.blob.slice(0,yt)):(Mt.log("sending last chunk"),xt=this.blob.slice(0),Et=!0),Mt.log("dataToSend.byteLength ="+xt.byteLength),this.originalDataType==="ArrayBuffer"?$t.message=lt.cw.encode(xt):$t.message=xt,$t.messageSize=xt.byteLength,$t.uuid=Rt.uuid,$t.originalDataType=this.originalDataType,Ct!==void 0&&(Mt.log("onProgress"),this.transferDuration=new Date-this.startingDate,Ct({sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Kt.callId,uuid:Rt.uuid,remoteId:Kt.remoteId,startingDate:this.startingDate,lastPacket:Et,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}),bt.createEvent({eventType:"onFileProgress",sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Kt.callId,uuid:Rt.uuid,remoteId:Kt.remoteId,startingDate:this.startingDate,lastPacket:Et,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}));try{nt.send(JSON.stringify($t))}catch(Jt){Mt.warn("error detected when sending on datachannel :",nt),Mt.warn("error is :",Jt)}}wt=this.sendChunkNb===0?this.blob:this.blob.slice(yt),Et===!1?this.sendChunkNb++:this.sendChunkNb=0,Rt.file=wt,setTimeout((function(){this.send(Rt,nt,Ct)}).bind(this))}else Mt.log("Trying to send on a closed channel");else Mt.log("No data channel to send data")},this.terminateTransfer=function(){var Rt=this;Mt.debug("terminateTransfer; terminated: "+this.terminated),this.channel!==null?this.useBufferedAmount===!0&&this.channel.bufferedAmount>0&&this.canceled!==!0?setTimeout(this.terminateTransfer.bind(this)):this.terminated!==!0&&(this.terminated=!0,this.recvDataEndAckTimeoutId&&(clearTimeout(this.recvDataEndAckTimeoutId),delete this.recvDataEndAckTimeoutId),delete this.call.dcfs,Mt.debug("terminateTransfer; terminating"),this.call.pipelineCallId?(this.call.pipelineCall&&(delete this.call.pipelineCall.clientCall,delete this.call.pipelineCall,this.call.sendDataChannel=null),this.channel=null):setTimeout(function(){Rt.channel.close(),Rt.channel=null}),setTimeout(function(){if(Rt.canceled===!0)bt.createEvent({eventType:"onFileSended",callId:Rt.call.callId,remoteId:Rt.call.remoteId,name:Rt.call.data.filename,error:"canceled"}),Rt.call.callbacks.failure("canceled");else if(Rt.call.failure)bt.createEvent({eventType:"onFileSended",callId:Rt.call.callId,remoteId:Rt.call.remoteId,name:Rt.call.data.filename,error:Rt.call.failure}),Rt.call.callbacks.failure(Rt.call.failure);else{var nt={eventType:"onFileSended",callId:Rt.call.callId,remoteId:Rt.call.remoteId,name:Rt.call.data.filename};Rt.call.success.data&&(nt.data=Rt.call.success.data),bt.createEvent(nt),Rt.call.callbacks.success(Rt.call.success)}apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Rt.call.callId)})):Mt.warn("No data channel to send data, leaving terminateTransfer")},this.recvDataEndAckTimeout=function(){Mt.error("recvDataEndAckTimeout"),this.call.failure="ackNotReceived",setTimeout(this.terminateTransfer.bind(this))},this.subsequentTransfer=function(){var Rt,nt=!1;if(Mt.debug("subsequentTransfer; remByteCount: "+this.remByteCount),this.canceled!==!0)if(this.channel!==null)if(this.useBufferedAmount===!0&&this.channel.bufferedAmount>Wt)setTimeout(this.subsequentTransfer.bind(this));else try{for(;;){if(!(this.remByteCount>=this.chunkLength)){Rt=this.data.slice(this.offset,this.offset+this.remByteCount),this.channel.send(Rt),this.packetsSent+=1,Mt.debug("packetSent "+this.packetsSent+" "+this.remByteCount),this.offset+=this.remByteCount,this.remByteCount-=this.remByteCount,nt=!0;break}if(Rt=this.data.slice(this.offset,this.offset+this.chunkLength),this.channel.send(Rt),this.packetsSent+=1,Mt.debug("packetSent "+this.packetsSent+" "+this.chunkLength),this.offset+=this.chunkLength,this.remByteCount-=this.chunkLength,this.remByteCount<=0){nt=!0;break}if(this.useBufferedAmount!==!0||this.channel.bufferedAmount>Wt)break}nt===!0?(bt.createEvent({eventType:"onFileProgress",name:this.call.data.filename,sendChunkNb:this.packetsSent,fileSize:this.call.data.size,remainingSize:this.remByteCount,callId:this.call.callId,remoteId:this.call.remoteId,percentage:100}),this.call.callbacks.progress({state:"complete",filename:this.call.data.filename,size:this.call.data.size,remBytes:0,progress:100}),this.call.success={state:"complete",filename:this.call.data.filename,size:this.call.data.size,mediaURL:this.call.mediaURL,mediaId:this.call.mediaId},this.recvDataEndAckTimeoutId=setTimeout(this.recvDataEndAckTimeout.bind(this),3e4)):(bt.createEvent({eventType:"onFileProgress",name:this.call.data.filename,sendChunkNb:this.packetsSent,fileSize:this.call.data.size,remainingSize:this.remByteCount,callId:this.call.callId,remoteId:this.call.remoteId,percentage:Math.floor(100*this.offset/this.call.data.size)}),this.call.callbacks.progress({state:"incomplete",filename:this.call.data.filename,size:this.call.data.size,remBytes:this.remByteCount,progress:Math.floor(100*this.offset/this.call.data.size)}),setTimeout(this.subsequentTransfer.bind(this)))}catch(Ct){return Mt.error("transfer: "+Ct),this.call.failure="dataChannelFailed",void setTimeout(this.terminateTransfer.bind(this))}else Mt.warn("No data channel to send data, leaving subsequentTransfer");else setTimeout(this.terminateTransfer.bind(this))},this.transfer=function(Rt,nt,Ct){var yt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},xt=yt.hasOwnProperty("delay")?yt.delay:100;if(Mt.info("transfer",nt,xt),this.call.beginTimeoutId&&(clearTimeout(this.call.beginTimeoutId),delete this.call.beginTimeoutId),this.data=Rt,this.channel=Ct,this.channel!==null){typeof this.channel.bufferedAmount=="number"&&this.channel.bufferedAmount>=0&&(Mt.debug("browserDetails",lt.wL),lt.wL.type==="chrome"?lt.wL.version>=37&&(this.useBufferedAmount=!0,Mt.debug("useBufferedAmount enabled")):(this.useBufferedAmount=!0,Mt.debug("useBufferedAmount enabled"))),this.chunkLength=8192,nt>0?(this.offset=Math.floor(nt/this.chunkLength)*this.chunkLength,this.remByteCount=this.data.byteLength-this.offset):(this.offset=0,this.remByteCount=this.data.byteLength),this.packetsSent=0;try{var wt={chunkLength:this.chunkLength,offset:this.offset,remBytes:this.remByteCount};this.call.pipelineCallId&&(wt.pluginName=Kt.data.pluginName,wt.pluginData=Kt.data.pluginData,Kt.data.context&&(wt.context=Kt.data.context)),this.channel.send(JSON.stringify(wt))}catch(Lt){return Mt.error("transfer:",Lt),this.call.failure="dataChannelFailed",void setTimeout(this.terminateTransfer.bind(this))}bt.createEvent({eventType:"onFileSending",callId:this.call.callId,remoteId:this.call.remoteId,name:this.call.data.filename}),setTimeout(this.subsequentTransfer.bind(this),xt)}else Mt.warn("No data channel to send data, leaving transfer")}},Bt=(et.Y.get("CallStatsMonitor"),function(Kt,Rt,nt,Ct){this.interval=Kt,this.browserType=Rt,this.browserVersion=nt,this.flavor=Ct,this.prevData={},this.prevDataThreshold=10/Kt,this.prevDataThreshold<2&&(this.prevDataThreshold=2),this.STANDARD_STAT_KEYS={audioReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},videoReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteAudioSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteVideoSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},audioSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},videoSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteAudioReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteVideoReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1}},this.refineStats_chrome_proprietary=function(yt,xt){var wt,Lt;for(wt=0;wt<xt.length;wt+=1){var Et=xt[wt],$t=null,Jt=null;if(Et.type==="ssrc"){if(Et.id.indexOf("recv")>=0){if(Et.stat("mediaType")==="audio")for(yt.audioReceived={timestamp:Math.floor(Date.parse(Et.timestamp))/1e3,type:"inbound-rtp",isRemote:!1,mediaType:"audio",packetsReceived:0,bytesReceived:0},$t=Et.names(),Lt=0;Lt<$t.length;Lt+=1)(Jt=$t[Lt])==="packetsReceived"?yt.audioReceived.packetsReceived=parseInt(Et.stat("packetsReceived"),10):Jt==="bytesReceived"&&(yt.audioReceived.bytesReceived=parseInt(Et.stat("bytesReceived"),10));else if(Et.stat("mediaType")==="video")for(yt.videoReceived={timestamp:Math.floor(Date.parse(Et.timestamp))/1e3,type:"outbound-rtp",isRemote:!1,mediaType:"video",framesDecoded:0,packetsReceived:0,bytesReceived:0},$t=Et.names(),Lt=0;Lt<$t.length;Lt+=1)(Jt=$t[Lt])==="framesDecoded"?yt.videoReceived.framesDecoded=parseInt(Et.stat("framesDecoded"),10):Jt==="packetsReceived"?yt.videoReceived.packetsReceived=parseInt(Et.stat("packetsReceived"),10):Jt==="bytesReceived"&&(yt.videoReceived.bytesReceived=parseInt(Et.stat("bytesReceived"),10))}else if(Et.id.indexOf("send")>=0){if(Et.stat("mediaType")==="audio")for(yt.audioSent={timestamp:Math.floor(Date.parse(Et.timestamp))/1e3,type:"outbound-rtp",isRemote:!1,mediaType:"audio",packetsSent:0,bytesSent:0},$t=Et.names(),Lt=0;Lt<$t.length;Lt+=1)(Jt=$t[Lt])==="packetsSent"?yt.audioSent.packetsSent=parseInt(Et.stat("packetsSent"),10):Jt==="bytesSent"&&(yt.audioSent.bytesSent=parseInt(Et.stat("bytesSent"),10));else if(Et.stat("mediaType")==="video")for(yt.videoSent={timestamp:Math.floor(Date.parse(Et.timestamp))/1e3,type:"outbound-rtp",isRemote:!1,mediaType:"video",framesEncoded:0,packetsSent:0,bytesSent:0},$t=Et.names(),Lt=0;Lt<$t.length;Lt+=1)(Jt=$t[Lt])==="framesEncoded"?yt.videoSent.framesEncoded=parseInt(Et.stat("framesEncoded"),10):Jt==="packetsSent"?yt.videoSent.packetsSent=parseInt(Et.stat("packetsSent"),10):Jt==="bytesSent"&&(yt.videoSent.bytesSent=parseInt(Et.stat("bytesSent"),10))}}}return!1},this.refineStats_chrome_legacy=function(yt,xt){var wt=!1;return xt.forEach(function(Lt){var Et=null,$t=null;if(Lt.type==="ssrc"&&Lt.id.indexOf("recv")>=0){if(Lt.mediaType==="audio"){for($t in yt.audioReceived={},Et=Math.floor(Date.parse(Lt.timestamp)/1e3),Lt)$t==="timestamp"?yt.audioReceived.timestamp=Et:yt.audioReceived[$t]=Lt[$t];wt=!0}else if(Lt.mediaType==="video"){for($t in yt.videoReceived={},Et=Math.floor(Date.parse(Lt.timestamp)/1e3),Lt)$t==="timestamp"?yt.videoReceived.timestamp=Et:yt.videoReceived[$t]=Lt[$t];wt=!0}}else if(Lt.type==="ssrc"&&Lt.id.indexOf("send")>=0){if(Lt.mediaType==="audio"){for($t in yt.audioSent={},Et=Math.floor(Date.parse(Lt.timestamp)/1e3),Lt)$t==="timestamp"?yt.audioSent.timestamp=Et:yt.audioSent[$t]=Lt[$t];wt=!0}else if(Lt.mediaType==="video"){for($t in yt.videoSent={},Et=Math.floor(Date.parse(Lt.timestamp)/1e3),Lt)$t==="timestamp"?yt.videoSent.timestamp=Et:yt.videoSent[$t]=Lt[$t];wt=!0}}}),wt},this.refineStats_chrome_58=function(yt,xt){var wt=this,Lt=!1;return xt.forEach(function(Et){if(Et.type!=="inbound-rtp"||Et.isRemote){if(Et.type==="outbound-rtp"&&!Et.isRemote){if(Et.mediaType==="audio"){yt.audioSent={};var $t=Math.floor(Et.timestamp/1e3);for(var Jt in Et)wt.STANDARD_STAT_KEYS.audioSent[Jt]!==!1&&(Jt==="timestamp"?yt.audioSent.timestamp=$t:yt.audioSent[Jt]=Et[Jt]);Lt=!0}else if(Et.mediaType==="video"){yt.videoSent={};var en=Math.floor(Et.timestamp/1e3);for(var qt in Et)wt.STANDARD_STAT_KEYS.videoSent[qt]!==!1&&(qt==="timestamp"?yt.videoSent.timestamp=en:yt.videoSent[qt]=Et[qt]);Lt=!0}}}else if(Et.mediaType==="audio"||Et.id.indexOf("Audio")>=0){yt.audioReceived={};var on=Math.floor(Et.timestamp/1e3);for(var hn in Et)wt.STANDARD_STAT_KEYS.audioReceived[hn]!==!1&&(hn==="timestamp"?yt.audioReceived.timestamp=on:yt.audioReceived[hn]=Et[hn]);Lt=!0}else if(Et.mediaType==="video"||Et.id.indexOf("Video")>=0){yt.videoReceived={};var nn=Math.floor(Et.timestamp/1e3);for(var dn in Et)wt.STANDARD_STAT_KEYS.videoReceived[dn]!==!1&&(dn==="timestamp"?yt.videoReceived.timestamp=nn:yt.videoReceived[dn]=Et[dn]);Lt=!0}}),Lt},this.refineStats_firefox_legacy=function(yt,xt){var wt=!1,Lt=this;return xt.forEach(function(Et){var $t=null,Jt=null;if(Et.type==="inbound-rtp"&&Et.isRemote===!1){if(Et.mediaType==="audio"){for($t in yt.audioReceived={packetsReceived:0,bytesReceived:0},Jt=Math.floor(Et.timestamp/1e3),Et)Lt.STANDARD_STAT_KEYS.audioReceived[$t]!==!1&&($t==="timestamp"?yt.audioReceived.timestamp=Jt:yt.audioReceived[$t]=Et[$t]);wt=!0}else if(Et.mediaType==="video"){for($t in yt.videoReceived={packetsReceived:0,bytesReceived:0,framesDecoded:0},Jt=Math.floor(Et.timestamp/1e3),Et)Lt.STANDARD_STAT_KEYS.videoReceived[$t]!==!1&&($t==="timestamp"?yt.videoReceived.timestamp=Jt:yt.videoReceived[$t]=Et[$t]);wt=!0}}else if(Et.type==="outbound-rtp"&&Et.isRemote===!1){if(Et.mediaType==="audio"){for($t in yt.audioSent={packetsSent:0,bytesSent:0},Jt=Math.floor(Et.timestamp/1e3),Et)Lt.STANDARD_STAT_KEYS.audioSent[$t]!==!1&&($t==="timestamp"?yt.audioSent.timestamp=Jt:yt.audioSent[$t]=Et[$t]);wt=!0}else if(Et.mediaType==="video"){for($t in yt.videoSent={packetsSent:0,bytesSent:0,framesEncoded:0},Jt=Math.floor(Et.timestamp/1e3),Et)Lt.STANDARD_STAT_KEYS.videoSent[$t]!==!1&&($t==="timestamp"?yt.videoSent.timestamp=Jt:yt.videoSent[$t]=Et[$t]);wt=!0}}}),wt},this.refineStats_firefox_63=function(yt,xt){var wt=!1,Lt=this;return xt.forEach(function(Et){if(Et.type!=="inbound-rtp"||Et.isRemote){if(Et.type==="outbound-rtp"&&!Et.isRemote){if(Et.kind==="audio"){yt.audioSent={packetsSent:0,bytesSent:0};var $t=Math.floor(Et.timestamp/1e3);for(var Jt in Et)Lt.STANDARD_STAT_KEYS.audioSent[Jt]!==!1&&(Jt==="timestamp"?yt.audioSent.timestamp=$t:yt.audioSent[Jt]=Et[Jt]);wt=!0}else if(Et.kind==="video"){yt.videoSent={packetsSent:0,bytesSent:0,framesEncoded:0};var en=Math.floor(Et.timestamp/1e3);for(var qt in Et)Lt.STANDARD_STAT_KEYS.videoSent[qt]!==!1&&(qt==="timestamp"?yt.videoSent.timestamp=en:yt.videoSent[qt]=Et[qt]);wt=!0}}}else if(Et.kind==="audio"){yt.audioReceived={packetsReceived:0,bytesReceived:0};var on=Math.floor(Et.timestamp/1e3);for(var hn in Et)Lt.STANDARD_STAT_KEYS.audioReceived[hn]!==!1&&(hn==="timestamp"?yt.audioReceived.timestamp=on:yt.audioReceived[hn]=Et[hn]);wt=!0}else if(Et.kind==="video"){yt.videoReceived={packetsReceived:0,bytesReceived:0,framesDecoded:0};var nn=Math.floor(Et.timestamp/1e3);for(var dn in Et)Lt.STANDARD_STAT_KEYS.videoReceived[dn]!==!1&&(dn==="timestamp"?yt.videoReceived.timestamp=nn:yt.videoReceived[dn]=Et[dn]);wt=!0}}),wt},this.addCallStats=function(yt){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},wt={};if(this.refineStats!==void 0){if(this.refineStats(wt,yt),wt.audioReceived!==void 0){if(this.prevData.audioReceived!==void 0){var Lt=wt.audioReceived.timestamp-this.prevData.audioReceived[0].timestamp;Lt>0?(wt.audioReceived.packetsReceivedPerSecond===void 0&&(wt.audioReceived.packetsReceivedPerSecond=Math.floor((wt.audioReceived.packetsReceived-this.prevData.audioReceived[0].packetsReceived)/Lt)),wt.audioReceived.bitsReceivedPerSecond===void 0&&(wt.audioReceived.bitsReceivedPerSecond=Math.floor(8*(wt.audioReceived.bytesReceived-this.prevData.audioReceived[0].bytesReceived)/Lt)),wt.audioReceived.packetsLostPerSecond===void 0&&(wt.audioReceived.packetsLostPerSecond=Math.floor((wt.audioReceived.packetsLost-this.prevData.audioReceived[0].packetsLost)/Lt)),wt.audioReceived.packetLossRatio===void 0&&(wt.audioReceived.packetLossRatio=100*(wt.audioReceived.packetsLost-this.prevData.audioReceived[0].packetsLost)/(wt.audioReceived.packetsReceived-this.prevData.audioReceived[0].packetsReceived)),wt.audioReceived.samplingInterval=Lt):(wt.audioReceived.packetsReceivedPerSecond===void 0&&(wt.audioReceived.packetsReceivedPerSecond=0),wt.audioReceived.bitsReceivedPerSecond===void 0&&(wt.audioReceived.bitsReceivedPerSecond=0),wt.audioReceived.packetsLostPerSecond===void 0&&(wt.audioReceived.packetsLostPerSecond=0),wt.audioReceived.packetLossRatio===void 0&&(wt.audioReceived.packetLossRatio=0),wt.audioReceived.samplingInterval=0)}else wt.audioReceived.packetsReceivedPerSecond===void 0&&(wt.audioReceived.packetsReceivedPerSecond=0),wt.audioReceived.bitsReceivedPerSecond===void 0&&(wt.audioReceived.bitsReceivedPerSecond=0),wt.audioReceived.packetsLostPerSecond===void 0&&(wt.audioReceived.packetsLostPerSecond=0),wt.audioReceived.packetLossRatio===void 0&&(wt.audioReceived.packetLossRatio=0),wt.audioReceived.samplingInterval=0,this.prevData.audioReceived=[];for(this.prevData.audioReceived.push(wt.audioReceived);this.prevData.audioReceived.length>this.prevDataThreshold;)this.prevData.audioReceived.shift()}if(wt.videoReceived!==void 0){if(this.prevData.videoReceived!==void 0){var Et=wt.videoReceived.timestamp-this.prevData.videoReceived[0].timestamp;Et>0?(wt.videoReceived.packetsReceivedPerSecond===void 0&&(wt.videoReceived.packetsReceivedPerSecond=Math.floor((wt.videoReceived.packetsReceived-this.prevData.videoReceived[0].packetsReceived)/Et)),wt.videoReceived.bitsReceivedPerSecond===void 0&&(wt.videoReceived.bitsReceivedPerSecond=Math.floor(8*(wt.videoReceived.bytesReceived-this.prevData.videoReceived[0].bytesReceived)/Et)),wt.videoReceived.packetsLostPerSecond===void 0&&(wt.videoReceived.packetsLostPerSecond=Math.floor((wt.videoReceived.packetsLost-this.prevData.videoReceived[0].packetsLost)/Et)),wt.videoReceived.framesDecodedPerSecond===void 0&&(wt.videoReceived.framesDecodedPerSecond=Math.floor((wt.videoReceived.framesDecoded-this.prevData.videoReceived[0].framesDecoded)/Et)),wt.videoReceived.packetLossRatio===void 0&&(wt.videoReceived.packetLossRatio=100*(wt.videoReceived.packetsLost-this.prevData.videoReceived[0].packetsLost)/(wt.videoReceived.packetsReceived-this.prevData.videoReceived[0].packetsReceived)),wt.videoReceived.samplingInterval=Et):(wt.videoReceived.packetsReceivedPerSecond===void 0&&(wt.videoReceived.packetsReceivedPerSecond=0),wt.videoReceived.bitsReceivedPerSecond===void 0&&(wt.videoReceived.bitsReceivedPerSecond=0),wt.videoReceived.packetsLostPerSecond===void 0&&(wt.videoReceived.packetsLostPerSecond=0),wt.videoReceived.framesDecodedPerSecond===void 0&&(wt.videoReceived.framesDecodedPerSecond=0),wt.videoReceived.packetLossRatio===void 0&&(wt.videoReceived.packetLossRatio=0),wt.videoReceived.samplingInterval=0)}else wt.videoReceived.packetsReceivedPerSecond===void 0&&(wt.videoReceived.packetsReceivedPerSecond=0),wt.videoReceived.bitsReceivedPerSecond===void 0&&(wt.videoReceived.bitsReceivedPerSecond=0),wt.videoReceived.packetsLostPerSecond===void 0&&(wt.videoReceived.packetsLostPerSecond=0),wt.videoReceived.framesDecodedPerSecond===void 0&&(wt.videoReceived.framesDecodedPerSecond=0),wt.videoReceived.packetLossRatio===void 0&&(wt.videoReceived.packetLossRatio=0),wt.videoReceived.samplingInterval=0,this.prevData.videoReceived=[];for(this.prevData.videoReceived.push(wt.videoReceived);this.prevData.videoReceived.length>this.prevDataThreshold;)this.prevData.videoReceived.shift()}if(wt.audioSent!==void 0){if(this.prevData.audioSent!==void 0){var $t=wt.audioSent.timestamp-this.prevData.audioSent[0].timestamp;$t>0?(wt.audioSent.packetsSentPerSecond===void 0&&(wt.audioSent.packetsSentPerSecond=Math.floor((wt.audioSent.packetsSent-this.prevData.audioSent[0].packetsSent)/$t)),wt.audioSent.bitsSentPerSecond===void 0&&(wt.audioSent.bitsSentPerSecond=Math.floor(8*(wt.audioSent.bytesSent-this.prevData.audioSent[0].bytesSent)/$t)),wt.audioSent.samplingInterval=$t):(wt.audioSent.packetsSentPerSecond===void 0&&(wt.audioSent.packetsSentPerSecond=0),wt.audioSent.bitsSentPerSecond===void 0&&(wt.audioSent.bitsSentPerSecond=0),wt.audioSent.samplingInterval=0)}else wt.audioSent.packetsSentPerSecond===void 0&&(wt.audioSent.packetsSentPerSecond=0),wt.audioSent.bitsSentPerSecond===void 0&&(wt.audioSent.bitsSentPerSecond=0),wt.audioSent.samplingInterval=0,this.prevData.audioSent=[];for(this.prevData.audioSent.push(wt.audioSent);this.prevData.audioSent.length>this.prevDataThreshold;)this.prevData.audioSent.shift()}if(wt.videoSent!==void 0){if(this.prevData.videoSent!==void 0){var Jt=wt.videoSent.timestamp-this.prevData.videoSent[0].timestamp;Jt>0?(wt.videoSent.packetsSentPerSecond===void 0&&(wt.videoSent.packetsSentPerSecond=Math.floor((wt.videoSent.packetsSent-this.prevData.videoSent[0].packetsSent)/Jt)),wt.videoSent.bitsSentPerSecond===void 0&&(wt.videoSent.bitsSentPerSecond=Math.floor(8*(wt.videoSent.bytesSent-this.prevData.videoSent[0].bytesSent)/Jt)),wt.videoSent.framesEncodedPerSecond===void 0&&(wt.videoSent.framesEncodedPerSecond=Math.floor((wt.videoSent.framesEncoded-this.prevData.videoSent[0].framesEncoded)/Jt)),wt.videoSent.samplingInterval=Jt):(wt.videoSent.packetsSentPerSecond===void 0&&(wt.videoSent.packetsSentPerSecond=0),wt.videoSent.bitsSentPerSecond===void 0&&(wt.videoSent.bitsSentPerSecond=0),wt.videoSent.framesEncodedPerSecond===void 0&&(wt.videoSent.framesEncodedPerSecond=0),wt.videoSent.samplingInterval=0)}else wt.videoSent.packetsSentPerSecond===void 0&&(wt.videoSent.packetsSentPerSecond=0),wt.videoSent.bitsSentPerSecond===void 0&&(wt.videoSent.bitsSentPerSecond=0),wt.videoSent.framesEncodedPerSecond===void 0&&(wt.videoSent.framesEncodedPerSecond=0),wt.videoSent.samplingInterval=0,this.prevData.videoSent=[];for(this.prevData.videoSent.push(wt.videoSent);this.prevData.videoSent.length>this.prevDataThreshold;)this.prevData.videoSent.shift()}}return Object.keys(wt).length>0&&typeof xt.post=="function"&&xt.post(wt),wt},this.browserType==="chrome"?Ct==="proprietary"?this.refineStats=this.refineStats_chrome_proprietary:this.browserVersion>=58?this.refineStats=this.refineStats_chrome_58:this.refineStats=this.refineStats_chrome_legacy:this.browserType==="firefox"?this.browserVersion>=63?this.refineStats=this.refineStats_firefox_63:this.refineStats=this.refineStats_firefox_legacy:this.browserType==="safari"&&(this.refineStats=this.refineStats_chrome_58)}),rn=(s(658),function(){this.NarrowBandSpeechQuality=function(Kt,Rt){var nt,Ct,yt=1,xt=1+Kt/10,wt=1+Kt/150,Lt=(94.769-(nt=80+2.5*(65-40*Math.log10(xt/wt)+6*Math.exp(Kt*Kt*-.3)-14)))*(94.769-nt)/4+100;return(Ct=93.193-((94.769-nt)/2+Math.sqrt(Lt)-1)*(1-Math.exp(-Kt))-(0+Rt/(Rt+4.3)*95))<0&&(yt=1),Ct<100&Ct>0&&(yt=1+.035*Ct+Ct*(Ct-60)*(100-Ct)*7*1e-6),Ct>100&&(yt=4.5),yt},this.WideBandspeechQuality=function(Kt,Rt){var nt,Ct,yt,xt=0,wt=1;Kt<100&&(xt=.08-Kt+10),Kt>=100&&(xt=18);var Lt=1+Kt/10,Et=1+Kt/150,$t=(129-(nt=80+3*(65+xt-40*Math.log10(Lt/Et)+6*Math.exp(Kt*Kt*-.3)-14)))*(129-nt)/4+100;return(yt=(Ct=129-((129-nt)/2+Math.sqrt($t)-1)*(1-Math.exp(-Kt))-(0+Rt/(Rt+4.3)*95))/1.29)<=0&&(wt=1),yt<100&yt>0&&(wt=1+.035*Ct+Ct*(Ct-60)*(100-Ct)*7*1e-6),yt>=100&&(wt=4.5),wt},this.videoQuality=function(Kt,Rt,nt,Ct,yt){var xt,wt,Lt,Et,$t,Jt,en,qt,on;return on=Rt>720?[0,2.77,.009,3.95,460,1.28,2.12,32e-5,1.28,262,1.98,22.84,7.999]:Rt>576?[0,6.31,.008,3.68,262,1.28,1.97,33e-5,1.24,343,2.76,6.25,6.013]:Rt>480?[0,6.96,.007,3.58,214,1.2,1.75,63e-5,1.13,171,4.25,7.98,12.001]:Rt>288?[0,5.61,.01,3.38,182,1.31,2.23,75e-5,1.51,136,4.05,20.16,22.332]:[0,3.988,.013,3.625,89.25,1.125,.713,0,1.542,245.5,3.011,39.31,16.67],Jt=1+Math.pow(Ct/on[4],on[5]),xt=on[3]-on[3]/Jt,wt=on[1]+on[2]*Ct,Lt=on[6]+on[7]*Ct,en=Math.pow(Math.log(yt)-Math.log(wt),2),qt=2*Math.pow(Lt,2),Et=xt*Math.exp(-en/qt),$t=on[10]+on[11]*Math.exp(-yt/on[8])+on[12]*Math.exp(-Ct/on[9]),1+Et*Math.exp(-nt/$t)},this.audiovisualQuality=function(Kt,Rt,nt,Ct){var yt,xt,wt,Lt,Et;return Kt>0&&Rt>0?(yt=(Et=[0,-.6966,-.8127,.4562,3.003,-.1638,.3626,.1291,.5457,-1251e-7,3.763,-.001065,.01465,-.001002,0])[9]*(nt+Ct)+Et[10],nt>=Ct&&(xt=Math.min(Et[11]*(nt-Ct)+Et[12],0)),nt<Ct&&(xt=Math.min(Et[13]*(Ct-nt)+Et[14],0)),wt=Math.max(yt+xt,1),Et[1]*(Lt=Et[5]*Kt+Et[6]*Rt+Et[7]*Kt*Rt+Et[8])+Et[2]*wt+Et[3]*Lt*wt+Et[4]):"NoAudiovisualStream"}});function gn(Kt,Rt){var nt=typeof Symbol<"u"&&Kt[Symbol.iterator]||Kt["@@iterator"];if(!nt){if(Array.isArray(Kt)||(nt=function(Et,$t){if(Et){if(typeof Et=="string")return tn(Et,$t);var Jt=Object.prototype.toString.call(Et).slice(8,-1);return Jt==="Object"&&Et.constructor&&(Jt=Et.constructor.name),Jt==="Map"||Jt==="Set"?Array.from(Et):Jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Jt)?tn(Et,$t):void 0}}(Kt))||Rt&&Kt&&typeof Kt.length=="number"){nt&&(Kt=nt);var Ct=0,yt=function(){};return{s:yt,n:function(){return Ct>=Kt.length?{done:!0}:{done:!1,value:Kt[Ct++]}},e:function(Et){throw Et},f:yt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xt,wt=!0,Lt=!1;return{s:function(){nt=nt.call(Kt)},n:function(){var Et=nt.next();return wt=Et.done,Et},e:function(Et){Lt=!0,xt=Et},f:function(){try{wt||nt.return==null||nt.return()}finally{if(Lt)throw xt}}}}function tn(Kt,Rt){(Rt==null||Rt>Kt.length)&&(Rt=Kt.length);for(var nt=0,Ct=new Array(Rt);nt<Rt;nt++)Ct[nt]=Kt[nt];return Ct}var Ht=et.Y.get("WebRTC_Call"),fn=apiCC.myWebRTC_Event,bn=function(Kt){this.dest_roomId="",this.pc=null,this.callId=0,this.callee=!1,this.callerId=0,this.calleeId=0,this.started=!1,this.localDescriptionSetted=!1,this.remoteDescriptionSetted=!1,this.sendedSdpOfferMessage=null,this.receivedSdpOfferMessage=null,this.myWebRTC_Stack=new St.S(Kt.socket),this.remoteMediaStreams=[],this.rtpSenders={audio:[],video:[]},this.addingUserMedia=!1,this.myWebRTC_Event=apiCC.myWebRTC_Event,this.dtmfSender=null,this.incomingcandidatesQueue=[],ot.Xh==="Firefox"?ot.PR>43?(this.mediaConstraintsAudioOnly={offerToReceiveAudio:!0,offerToReceiveVideo:!1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}):(this.mediaConstraintsAudioOnly={mandatory:{offerToReceiveAudio:!0,offerToReceiveVideo:!1}},this.mediaConstraints={mandatory:{offerToReceiveAudio:!0,offerToReceiveVideo:!0}}):ot.Xh==="Chrome"?ot.PR<55?(this.mediaConstraintsAudioOnly={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},this.mediaConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}}):(this.mediaConstraintsAudioOnly={offerToReceiveAudio:1,offerToReceiveVideo:1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}):ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"?(this.mediaConstraintsAudioOnly={offerToReceiveAudio:!0,offerToReceiveVideo:!1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}):(this.mediaConstraintsAudioOnly={offerToReceiveAudio:1,offerToReceiveVideo:1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}),ot.ag.name==="iOS"&&(Ht.log("Defining mediaConstraints for iOS "),this.mediaConstraints={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),this.trickleIce=Kt.trickleIce,this.callLocalStream=null,this.generatedLocalStream=!1,this.audioOnly=!1,this.inviteSended=!1,this.sendInviteTrickleIceFalseTimeOutId=0,this.sendInviteTrickleIceFalseTimer=5e3,this.message200OKSended=!1,this.send200OKTrickleIceFalseTimeOutId=0,this.send200OKTrickleIceFalseTimer=5e3,this.message200OKReceived=!1,this.callCancelled=!1,this.screenSharing=!1,this.desktopId=0,this.pc_config=Kt.pc_config,this.pc_constraints=Kt.pc_constraints,this.audioFileMediaElement=null,this.videoReceivedWidth=640,this.videoReceivedHeight=480,this.videoSendWidth=640,this.videoSendHeight=480,this.videoReceivedDelay=0,this.audioReceivedDelay=0,this.audioSendDelay=0,this.videoSendDelay=0,this.videoSendPacketLossRatio=0,this.audioSendPacketLossRatio=0,this.getStatsInterval=Kt.qosInterval,this.qm=null,this.statisticId=null,this.csmIntervalMs=Kt.csmIntervalMs,this.csmIntervalId=null,this.remoteId=0,this.callType="media",this.localCallProfile={audio:!1,audioActive:!1,video:!1,videoActive:!1},this.remoteCallProfile={audio:!1,audioActive:!1,video:!1,videoActive:!1},this.disconnectionTimeoutId=0,this.disconnectionTimer=4e4,this.disconnectionWarningDelay=9e3,this.disconnectionWarningInterval=0,this.disconnectionWarningTimeout=0,this.disconnectionWarningCount=0,this.checkCandidateTypesTimer=1e4,this.checkCandidateTypesTimeoutId=0,this.checkCandidateTypesTimeoutTable=[],this.data={},this.screenStream=null,this.screenIsDisplayed=!1,this.addingDataChannelOnCallOngoing=!1,this.sendDataChannel=null,this.receiveDataChannel=null,this.receiveChunkNb={},this.firstDataPacket={},this.receivedSize={},this.receiveArrayToStoreChunks={},this.destCallType="media",this.mcuRemoteStream=null,this.userMediaAccessRequired=!0,this.settingUpMode="normal",this.remoteType="web",this.mediaTypeForIncomingCall=Kt.mediaTypeForIncomingCall,this.mediaTypeForOutgoingCall=Kt.mediaTypeForOutgoingCall,this.mediaRoutingMode=Kt.mediaRoutingMode,this.stripAudioSDPActivated=!1,this.stripVideoSDPActivated=!1,this.iceState="notdefined",this.restarted=!1,this.audioSdpDirection=null,this.videoSdpDirection=null,this.isLocalAudioMuted=!1,this.isLocalVideoMuted=!1,this.isRemoteAudioMuted=!1,this.isRemoteVideoMuted=!1,this.isRemoteAudioSilent=!1,this.isRemoteVideoSilent=!1,this.isAccepted=!1,this.accessToMedia=!1,this.callConfiguration=null,this.captureSourceType=null,this.preferH264Codec=!1,this.preferVP8Codec=!1,this.preferVP9Codec=!1,this.candidateNb=0,this.sessionMCU=null,this.instanceId=0,this.retryUpdateMedia=!1,this.updateMediaOngoing=!1,this.setCallTurnServer=function(Rt){Ht.info("setCallTurnServer :",Rt);var nt=JSON.stringify(this.pc_config);nt=nt.replace(/mp1.apizee.com/g,Rt),this.pc_config=JSON.parse(nt)},this.setCallMediaRoutingMode=function(Rt){Ht.info("setCallMediaRoutingMode :",Rt),Rt==="hostOnly"?this.mediaRoutingMode=Kt.mediaRoutingModeEnum.hostOnly:Rt==="stun"?this.mediaRoutingMode=Kt.mediaRoutingModeEnum.stun:Rt==="stunOnly"?this.mediaRoutingMode=Kt.mediaRoutingModeEnum.stunOnly:Rt==="turn"?this.mediaRoutingMode=Kt.mediaRoutingModeEnum.turn:Rt==="turnOnly"?this.mediaRoutingMode=Kt.mediaRoutingModeEnum.turnOnly:(Ht.log("parameter error when calling function : setCallMediaRoutingMode()"),this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setCallMediaRoutingMode()","PARAMETER_ERROR_SETCALLMEDIAROUTINGMODE"))},this.checkDTLSCompliancy=function(){if(Ht.debug("checkDTLSCompliancy"),apiCC.session.isDeviceDTLSCompliant()===!1)Ht.log("Device not DTLS compliant, setting DtlsSrtpKeyAgreement: false"),this.pc_constraints={optional:[{DtlsSrtpKeyAgreement:!1}]};else{var Rt=apiCC.session.isClientDTLSCompliant(this.remoteId);Rt!==!1&&Rt!=="false"||(Ht.log("Remote Device not DTLS compliant, setting DtlsSrtpKeyAgreement: false"),this.pc_constraints={optional:[{DtlsSrtpKeyAgreement:!1}]})}},this.sendData=function(Rt,nt){Ht.info("datachannel - sendData");var Ct=null,yt=null;if(Rt.file instanceof File)return Ht.log("File"),this.contentType=Rt.file.type,this.originalDataType="File",Ct=new FileReader,yt=this,Ct.onload=function(xt){var wt=xt.target.result||Ct.result;yt.sendData({file:wt,name:Rt.name,type:Rt.type},nt)},void Ct.readAsArrayBuffer(Rt.file);new zt(this).send(Rt,this.sendDataChannel,nt)},Ht.log("New Call for client with Id :"+Kt.clientId),this.generateCallId=function(){this.callId=apiCC.generateCallId(),Ht.info("new call with callId :"+this.callId)},this.sendInviteTrickleIceFalse=function(){Ht.log("sendInviteTrickleIceFalse"),Ht.log("sendInvite on candidate timer reached"),this.myWebRTC_Stack.sendInvite(this.callId,this.callerId,Kt.nickname,this.dest_roomId,this.dest_roomId,this.callType,{offer:this.pc.localDescription,data:this.data,stream:this.mcuRemoteStream,volatile:!!this.restarted}),this.inviteSended=!0},this.send200OkTrickleIceFalse=function(){Ht.log("send200OkTrickleIceFalse"),this.myWebRTC_Stack.send200OK(this.callId,this.callerId,this.calleeId,Kt.nickname,this.dest_roomId,this.pc.localDescription,this.data),this.message200OKSended=!0},this.onSetLocalDescriptionSuccess=function(){Ht.info("onSetLocalDescriptionSuccess"),this.localDescriptionSetted=!0,this.asyncCallbacks&&this.asyncCallbacks.type==="subscribe"&&delete this.asyncCallbacks,this.trickleIce===!1&&(this.callee===!0?(Ht.info("starting send200OKTrickleIceFalseTimeOutId"),this.send200OKTrickleIceFalseTimeOutId=setTimeout(this.callback(this,"send200OkTrickleIceFalse"),this.send200OKTrickleIceFalseTimer)):(Ht.info("starting sendInviteTrickleIceFalseTimeOutId"),this.sendInviteTrickleIceFalseTimeOutId=setTimeout(this.callback(this,"sendInviteTrickleIceFalse"),this.sendInviteTrickleIceFalseTimer))),Kt.rtpSenderSetParamatersCapable&&Kt.evaluateVideoCap(this)},this.onSetLocalDescriptionFailure=function(Rt){Ht.warn("onSetLocalDescriptionFailure",Rt);var nt=null,Ct=null;this.callControl&&(nt=this.callControl.roomName,Ct=this.callControl.type),fn.createErrorEvent("Set local Description Failure","SET_LOCAL_DESCRIPTION_FAILURE",this.callId,nt,Ct),Kt.onHangup(this.callId,"Local_Description_Failure")},this.onSetRemoteDescriptionSuccess=function(){Ht.info("onSetRemoteDescriptionSuccess");var Rt=null;for(this.remoteDescriptionSetted=!0,this.restarting===!0&&delete this.restarting,this.data&&(this.data.mesh||this.data.subscribeOrder)||fn.createCallEstablishedEvent(this.calleeId,this.callType,this.callId,this.destCallType);this.incomingcandidatesQueue.length;)Rt=this.incomingcandidatesQueue.shift(),this.processCandidateMsg(Rt);if(Kt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId]!==void 0){for(Ht.debug("Restoring candidate from client, this.callId :"+this.callId+" , instanceId :"+this.instanceId);Kt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId].length;)Rt=Kt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId].shift(),this.processCandidateMsg(Rt);delete Kt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId]}if(this.asyncCallbacks&&(this.asyncCallbacks.type==="addingUserMedia"?(this.asyncCallbacks.resolve(this.callConfiguration.userMediaStreamId),this.asyncCallbacks.timeoutId&&(clearTimeout(this.asyncCallbacks.timeoutId),delete this.asyncCallbacks.timeoutId),delete this.asyncCallbacks):this.asyncCallbacks.type==="updateCallConfiguration"&&(this.asyncCallbacks.resolve(),this.asyncCallbacks.timeoutId&&(clearTimeout(this.asyncCallbacks.timeoutId),delete this.asyncCallbacks.timeoutId),delete this.asyncCallbacks)),this.updateMediaOngoing=!1,this.retryUpdateMedia===!0){Ht.debug("an updateMedia was waiting for sig stable state or an other updateMedia end, updating Media now ..."),this.retryUpdateMedia=!1;var nt=this.updateMedia(!1);Ht.debug("Retried updateMediaResult :",nt)}},this.processCandidateMsg=function(Rt){Ht.info("processCandidateMsg :",Rt);var nt=null;this.pc!==null?(Rt.completeCandidate!==void 0?(Ht.trace("new behavior of 2.13.8"),nt=new apiCC.myWebRTC_Adapter.RTCIceCandidate(Rt.completeCandidate)):(Ht.log("old behavior < 2.13.8"),nt=new apiCC.myWebRTC_Adapter.RTCIceCandidate({sdpMLineIndex:Rt.label,candidate:Rt.candidate})),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("addIceCandidate"),this.pc.addIceCandidate(nt,function(){Ht.trace("addIceCandidate success")},function(Ct){Ht.warn("addIceCandidate failure: "+Ct),Ct=null})):(Ht.log("addIceCandidate - Promise version"),this.pc.addIceCandidate(nt).then(function(){Ht.trace("addIceCandidate success")}).catch(function(Ct){Ht.warn("addIceCandidate failure: "+Ct),Ct=null}))):Ht.error("Error, call is not null but pc is null")},this.onSetRemoteDescriptionFailure=function(Rt){Ht.warn("onSetRemoteDescriptionFailure :",Rt);var nt=null,Ct=null;this.callControl&&(nt=this.callControl.roomName,Ct=this.callControl.type),fn.createErrorEvent("Set remote Description Failure","SET_REMOTE_DESCRIPTION_FAILURE",this.callId,nt,Ct),Kt.onHangup(this.callId,"Remote_Description_Failure")},this.getUserMediaOnCall=function(){var Rt=this,nt=!1;if(Ht.info("getUserMediaOnCall, audio Only :"+this.audioOnly),Ht.info("getUserMediaOnCall, screenSharing activated :"+this.screenSharing),Ht.log("webRTCClient.gum_config :",Kt.gum_config),this.callerId===Kt.clientId){if(Ht.log("outgoing call"),this.mediaTypeForOutgoingCall==="VIDEO"||this.mediaTypeForOutgoingCall==="VIDEOONLY")if(Ht.log("mediaTypeForOutgoingCall :"+this.mediaTypeForOutgoingCall),this.mediaTypeForOutgoingCall==="VIDEOONLY"&&(nt=!0),this.screenSharing!==!0){if(apiCC.mediaDeviceMgr.videoDevicePresent===!1){if(apiCC.mediaDeviceMgr.audioDevicePresent===!1)return Ht.log("getUserMediaOnCall without any device, calling without device"),void this.onUserMediaSuccessOnCall();Ht.log("video is not present :"+this.callType),this.callType==="media"&&(Ht.log("callType is media, but no webcam present, forcing callType to audio"),this.callType="audio",this.audioOnly=!0)}}else Ht.log("screenSharing, no device checking");else if(this.mediaTypeForOutgoingCall==="AUDIO")Ht.log("mediaTypeForOutgoingCall is AUDIO, setting call to audioOnly"),this.callType="audio",this.audioOnly=!0;else if(this.mediaTypeForOutgoingCall==="NONE"||this.mediaTypeForOutgoingCall==="DATA")return Ht.log("mediaTypeForOutgoingCall is NONE, call will be recvOnly"),void this.onUserMediaSuccessOnCall()}else if(Ht.log("incoming call"),this.mediaTypeForIncomingCall==="VIDEO"||this.mediaTypeForIncomingCall==="VIDEOONLY"){if(Ht.log("mediaTypeForIncomingCall :"+this.mediaTypeForIncomingCall),this.mediaTypeForIncomingCall==="VIDEOONLY"&&(nt=!0),apiCC.mediaDeviceMgr.videoDevicePresent===!1){if(apiCC.mediaDeviceMgr.audioDevicePresent===!1)return Ht.log("getUserMediaOnCall without any device, calling without device"),void this.onUserMediaSuccessOnCall();Ht.log("video is not present :"+this.callType),this.callType==="media"&&(Ht.log("callType is media, but no webcam present, forcing callType to audio"),this.callType="audio",this.audioOnly=!0)}}else if(this.mediaTypeForIncomingCall==="AUDIO")Ht.log("mediaTypeForIncomingCall is AUDIO, setting call to audioOnly"),this.callType="audio",this.audioOnly=!0;else if(this.mediaTypeForIncomingCall==="NONE"||this.mediaTypeForIncomingCall==="DATA")return Ht.log("mediaTypeForIncomingCall is NONE, call will be recvOnly"),void this.onUserMediaSuccessOnCall();Kt.getUserMediaOnGoing=!0;var Ct=null,yt=null;if(Ht.log("this.screenSharing :"+this.screenSharing),Ht.log("this.audioOnly :"+this.audioOnly),this.screenSharing===!0)if(Ht.log("getScreenMedia"),ot.Xh==="Chrome")Ht.log("this.desktopId :"+this.desktopId),Ct={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:this.desktopId}}};else{if(Ht.log("this.captureSourceType :"+this.captureSourceType),this.captureSourceType!=="screen"&&this.captureSourceType!=="window"&&this.captureSourceType!=="application")return void Ht.error("captureSourceType value is not correct");Ct={video:{mediaSource:this.captureSourceType}}}else this.audioOnly===!0?(Ht.log("this.audioOnly = true"),Kt.gum_config=apiCC.setAudioSourceIdInConstraint(Kt.audioSourceId,Kt.gum_config),yt=JSON.parse(JSON.stringify(Kt.gum_config)),Kt.allowAsymetricMediaCalls===!1?yt.video=!1:Ht.log("allow AsymetricMediaCalls is activated"),Ct=yt):(Ht.log("audio and video call"),Ct=(0,lt.ws)({},Kt.gum_config),nt?Ct.audio=!1:Ct=apiCC.setAudioSourceIdInConstraint(Kt.audioSourceId,Ct),Ct=apiCC.setVideoSourceIdInConstraint(Kt.videoSourceId,Ct),Ct=apiCC.setVideoFacingModeInConstraint(Kt.facingMode,Ct),typeof apiRTC_React<"u"&&(Ct={audio:!0,video:{mandatory:{minWidth:500,minHeight:300,minFrameRate:30},facingMode:"user"}}));apiCC.createUserMediaStream({callId:this.callId,type:this.callType,gum_config:Ct,success:function(xt){Ht.debug("[getUserMediaOnCall] success; userMediaStreamId: "+xt.userMediaStreamId),Rt.callConfiguration!==void 0&&Rt.callConfiguration!==null||(Rt.callConfiguration={}),Rt.callConfiguration.userMediaStreamId=xt.userMediaStreamId,Rt.onUserMediaSuccessOnCall(xt.stream)},failure:function(xt,wt){Ht.debug("[getUserMediaOnCall] failure; userMediaStreamId: "+xt.userMediaStreamId),Rt.onUserMediaErrorOnCall(wt)}})},this.handleToneChangeEvent=function(Rt){Ht.debug("handleToneChangeEvent :",Rt.tone),Rt.tone!==""?Ht.debug("Tone played: "+Rt.tone):Ht.debug("All tones have played.")},this.sendTones=function(Rt,nt,Ct){Ht.debug("sendTones :"),this.dtmfSender&&(Ht.debug("sendTones : Tones, duration, gap: ",Rt,nt,Ct),this.dtmfSender.insertDTMF(Rt,nt,Ct))},this.addStream=function(Rt){var nt,Ct=null,yt=null,xt=0,wt=!1,Lt=null,Et=[];if(ot.Xh==="Firefox"&&ot.PR<51||ot.Xh==="Chrome"&&ot.PR<65||ot.Xh==="Safari"&&ot.dc<12.1||ot.Xh==="Mobile Safari"&&ot.dc<12.1||apiRTC.osName==="iOS"&&typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0)Ht.info("using addStream method"),this.pc.addStream(Rt),Ht.debug("end addStream method");else{if(!(ot.Xh==="Firefox"&&ot.PR<59||ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"||typeof apiRTC_React<"u")){for(Ht.info("using addTrack/replaceTrack method"),Ct=Rt.getTracks(),nt=0;nt<Ct.length;nt+=1){for(wt=!1,yt=this.rtpSenders[Ct[nt].kind],xt=0;xt<yt.length;xt+=1)if(yt[xt].track===null){wt=!0;break}if(wt===!0)Et.push(yt[xt].replaceTrack(Ct[nt])),Ht.debug("addStream -> replaceTrack",yt[xt]);else{if(this.simulcast==="RID"&&Ct[nt].kind==="video"&&lt.wL.type==="chrome"){var $t=[{rid:"h",active:!0,maxBitrate:9e5},{rid:"m",active:!0,maxBitrate:3e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:1e5,scaleResolutionDownBy:4}];this.callControl.callConfiguration.simulcast&&this.callControl.callConfiguration.simulcast.sendEncodings&&($t=this.callControl.callConfiguration.simulcast.sendEncodings.slice()),Lt=this.pc.addTransceiver(Ct[nt],{direction:"sendonly",streams:[Rt],sendEncodings:$t}).sender}else if(Lt=this.pc.addTrack(Ct[nt],Rt),this.simulcast==="RID"&&Ct[nt].kind==="video"&&lt.wL.type==="firefox"){var Jt=Lt.getParameters();Jt||(Jt={}),this.callControl.callConfiguration.simulcast&&this.callControl.callConfiguration.simulcast.sendEncodings?Jt.encodings=this.callControl.callConfiguration.simulcast.sendEncodings.slice():Jt.encodings=[{rid:"h",active:!0,maxBitrate:9e5},{rid:"m",active:!0,maxBitrate:3e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:1e5,scaleResolutionDownBy:4}],Et.push(Lt.setParameters(Jt))}Ht.debug("addStream -> addTrack",Lt),this.rtpSenders[Ct[nt].kind].push(Lt)}}return Ht.debug("end addTrack/replaceTrack method"),this.rtpSenders.audio.length>0&&(this.dtmfSender=this.rtpSenders.audio[0].dtmf,this.dtmfSender&&(this.dtmfSender.ontonechange=this.handleToneChangeEvent)),new Promise(function(en,qt){Promise.all(Et).then(function(on){en()}).catch(qt)})}for(Ht.info("using addTrack method"),Ct=Rt.getTracks(),nt=0;nt<Ct.length;nt+=1)this.pc.addTrack(Ct[nt],Rt);Ht.debug("end addTrack method")}return Promise.resolve()},this.removeStream=function(Rt){var nt,Ct=null,yt=[];if(Ht.info("removeStream in call",Rt.id),ot.Xh==="Firefox"&&ot.PR<51||ot.Xh==="Chrome"&&ot.PR<65||ot.Xh==="Safari"&&ot.dc<12.1||ot.Xh==="Mobile Safari"&&ot.dc<12.1||apiRTC.osName==="iOS"&&typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0)Ht.info("using removeStream method"),this.pc.removeStream(Rt),Ht.debug("end removeStream method");else{if(!(ot.Xh==="Firefox"&&ot.PR<59||ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome")){for(Ht.info("using replaceTrack method"),nt=0;nt<this.rtpSenders.audio.length;nt+=1)yt.push(this.rtpSenders.audio[nt].replaceTrack(null));for(nt=0;nt<this.rtpSenders.video.length;nt+=1)yt.push(this.rtpSenders.video[nt].replaceTrack(null));return Ht.debug("end replaceTrack method"),new Promise(function(xt,wt){Promise.all(yt).then(function(Lt){xt()}).catch(wt)})}for(Ht.info("using removeTrack method"),Ct=this.pc.getSenders(),Ht.debug("senders :",Ct),nt=0;nt<Ct.length;nt+=1)this.pc.removeTrack(Ct[nt]);Ht.debug("end removeTrack method")}return Promise.resolve()},this.stopStream=function(Rt){Ht.info("stopStream in call");var nt,Ct=null;if(ot.Xh==="Chrome"&&ot.PR<45||ot.Xh==="Firefox"&&ot.PR<44||ot.Xh==="Opera"&&ot.PR<34||ot.Xh==="Chromium"&&ot.PR<44||ot.Xh==="Chrome WebView"&&ot.PR<45)Ht.log("... using MediaStream.stop"),Rt.stop();else{for(Ht.log("... using MediaStreamTrack.stop"),Ct=Rt.getTracks(),nt=0;nt<Ct.length;nt+=1)Ct[nt].stop();Ht.log("... tracks stopped")}Rt=null},this.addVideoMedia=function(){var Rt=this;Ht.info("addVideoMedia");var nt=Kt.gum_config;apiCC.createUserMediaStream({callId:this.callId,type:"media",gum_config:nt,success:function(Ct){Ht.debug("[addVideoMedia] success; userMediaStreamId: "+Ct.userMediaStreamId);var yt=apiCC.getUserMediaStream(Rt.callConfiguration.userMediaStreamId),xt=Promise.resolve();yt&&(xt=Rt.removeStream(yt.stream).then(function(){Kt.myWebRTC_Event.createLocalStreamRemovedEvent(Rt.callType,Rt.callId,yt.stream,Rt.remoteId,Rt.destCallType),apiCC.releaseUserMediaStream(yt.userMediaStreamId,Rt.callId)})),xt.then(function(){Rt.callConfiguration.userMediaStreamId=Ct.userMediaStreamId,Rt.callLocalStream=Ct.stream,Rt.addStream(Ct.stream),Rt.updateMediaWithRetryManagement(!1)}).catch(function(wt){Ht.error("Failed to addVideoMedia",wt);var Lt=null,Et=null;Rt.callControl&&(Lt=Rt.callControl.roomName,Et=Rt.callControl.type),Kt.myWebRTC_Event.createErrorEvent("Failed to addVideoMedia","MEDIA_UPDATE_ERROR",Rt.callId,Lt,Et)})},failure:function(Ct,yt){Ht.debug("[addVideoMedia] failure; userMediaStreamId: "+Ct.userMediaStreamId),Rt.onUserMediaErrorOnCall(yt)}})},this.stopScreenSharing=function(){Ht.debug("stopScreenSharing detected"),Kt.removeCallFromTableWithCallIdAndSendBye(this.callId,"stop_ScreenSharing")},this.checkingMutingState=function(){var Rt=this,nt=null;Ht.debug("checkingMutingState");var Ct=function(){(0,lt.ki)(Rt,"mcuRemoteStream","object")||(Rt.mcuRemoteStream={}),Rt.mcuRemoteStream.videoMuted=!0},yt=function(){(0,lt.ki)(Rt,"mcuRemoteStream","object")||(Rt.mcuRemoteStream={}),Rt.mcuRemoteStream.audioMuted=!0};(0,lt.ki)(this.callConfiguration,"userMediaStreamId","string")&&(nt=apiCC.getUserMediaStream(this.callConfiguration.userMediaStreamId))&&(nt.videoMuted?(Ct(),this.isLocalVideoMuted=!0):this.isLocalVideoMuted=!1,nt.audioMuted?(yt(),this.isLocalAudioMuted=!0):this.isLocalAudioMuted=!1);var xt=function(){Rt.isLocalVideoMuted||(nt?nt.video&&!nt.videoMuted&&nt.muteVideoOnStreams("enabled"):Rt.callLocalStream&&(Kt.muteTracks(Rt.callLocalStream.getVideoTracks()),Rt.isLocalVideoMuted=!0),Ct())},wt=function(){Rt.isLocalAudioMuted||(nt?nt.audio&&!nt.audioMuted&&nt.muteAudioOnStreams("enabled"):Rt.callLocalStream&&(Kt.muteTracks(Rt.callLocalStream.getAudioTracks()),Rt.isLocalAudioMuted=!0),yt())};Kt.isVideoMuted===!0&&(Ht.log("Client is video muted, applying to call"),xt()),Kt.isAudioMuted===!0&&(Ht.log("Client is audio muted, applying to call"),wt()),(0,lt.ki)(this.callConfiguration,"muted","string")&&(Ht.log("callConfiguration muted is set :",this.callConfiguration.muted),this.callConfiguration.muted==="VIDEO"&&(xt(),wt()),this.callConfiguration.muted==="AUDIOONLY"&&wt(),this.callConfiguration.muted==="VIDEOONLY"&&xt(),delete this.callConfiguration.muted)},this.onUserMediaSuccessOnCall=function(Rt){Ht.info("onUserMediaSuccessOnCall");var nt=(0,lt.Pj)(),Ct={};Kt.userMediaErrorDetected===!0&&(Kt.userMediaErrorDetected=!1,Ct.userMediaErrorDetected=Kt.userMediaErrorDetected,apiCC.session.setUserData(Ct)),Ht.log("isHTTPS()"+nt),Kt.getUserMediaOnGoing=!1,Ht.log("User has granted access to local media."),Kt.accessToLocalMedia=!0,this.accessToMedia=!0,this.screenSharing===!0?(this.callType="screenSharing",Rt!=null&&(Rt.onended=this.callback(this,"stopScreenSharing"),Rt.getVideoTracks().length>0&&(Rt.getVideoTracks()[0].onended=this.callback(this,"stopScreenSharing")))):this.audioOnly===!0&&(this.callType="audio"),Rt!==void 0&&(this.callLocalStream=Rt),(0,lt.yJ)()?(Ht.log("isHTTP true"),this.establishCall()):(Ht.log("webRTCClient.userAcceptOnIncomingCall :"+Kt.userAcceptOnIncomingCall),Ht.log("this.callee :"+this.callee),this.data!==void 0&&Ht.log("this.data.MCUType :"+this.data.MCUType),Kt.userAcceptOnIncomingCall!==!0||this.callee!==!0&&this.data.MCUType!=="MCU-Callee"||this.isAccepted!==!1?this.calleeId!=="LOCAL"?this.establishCall():Ht.log("call is not established as this is a LOCAL stream request"):Ht.log("Stand-by :: wait for establishCall"))},this.establishCall=function(){var Rt=this;Ht.debug("establishCall()"),this.started!==!0||this.addingUserMedia!==!0||!this.belongsToRoom()||this.settingUpType!=="publish"||this.data&&this.data.hasOwnProperty("MCUType")||!this.sessionMCU||this.sessionMCU.hasOwnProperty("roomMode")||(this.restarting=!0,this.pc.close(),this.pc=null,this.started=!1,this.localDescriptionSetted=!1,this.remoteDescriptionSetted=!1,this.sendedSdpOfferMessage=null,this.receivedSdpOfferMessage=null,this.rtpSenders={audio:[],video:[]},this.addingUserMedia=!1,this.updateUserMedia=!1,this.updateCause=null,this.incomingcandidatesQueue=[],this.message200OKReceived=!1,this.statisticId&&(clearInterval(this.statisticId),this.statisticId=null),this.csmIntervalId&&(clearInterval(this.csmIntervalId),this.csmIntervalId=null),this.instanceId=apiCC.generateInstanceId(),this.data.instanceId=this.instanceId),this.dataCall!==!0&&this.checkingMutingState(),this.maybeStart();var nt=null;this.callee&&this.addingUserMedia!==!0&&this.updateUserMedia!==!0?(nt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(this.receivedSdpOfferMessage),Ht.log("Avant setRemote pour le callee :",nt),this.pc!==null?(Kt.preferSendingH264Codec&&(Ht.log("Modification of SDP to set H264 as prefered sending codec"),nt.sdp=Kt.mySDPManager.maybePreferCodec(nt.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("establishCall : before setRemoteDescription for callee"),this.pc.setRemoteDescription(nt,this.callback(this,"onSetRemoteDescriptionSuccess"),this.callback(this,"onSetRemoteDescriptionFailure"))):(Ht.log("establishCall : before setRemoteDescription for callee - Promise version"),this.pc.setRemoteDescription(nt).then(this.callback(this,"onSetRemoteDescriptionSuccess")).catch(this.callback(this,"onSetRemoteDescriptionFailure")))):Ht.log("Error : PC is null"),this.doAnswer()):this.addingUserMedia===!0?(Ht.log("Adding local stream 1."),this.pc!==null?(this.callLocalStream===null&&Kt.localStream!==null&&(this.callLocalStream=Kt.localStream),this.callLocalStream!==null?(Ht.log("Add Stream of callLocalStream"),this.addStream(this.callLocalStream).then(function(){Rt.updateMediaWithRetryManagement(!1)}).catch(function(Ct){Ht.error("failed to add stream",Ct)})):(Ht.log("No Stream to addStream"),this.updateMediaWithRetryManagement(!1))):Ht.error("Error : PC is null")):this.updateUserMedia===!0&&this.updateMediaWithRetryManagement(!1),Ht.log("End of establishCall()")},this.onUserMediaSuccessTestUni=function(){Kt.getUserMediaOnGoing=!1,Ht.info("onUserMediaSuccessTestUni : User has not granted access to local media.");var Rt=null,nt={};Kt.userMediaErrorDetected===!0&&(Kt.userMediaErrorDetected=!1,nt.userMediaErrorDetected=Kt.userMediaErrorDetected,apiCC.session.setUserData(nt)),Kt.accessToLocalMedia=!0,this.maybeStart(),this.callee&&(Rt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(this.receivedSdpOfferMessage),Kt.preferSendingH264Codec&&(Ht.log("Modification of SDP to set H264 as prefered sending codec"),Rt.sdp=Kt.mySDPManager.maybePreferCodec(Rt.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("onUserMediaSuccessTestUni : before setRemoteDescription for callee"),this.pc.setRemoteDescription(Rt,this.callback(this,"onSetRemoteDescriptionSuccess"),this.callback(this,"onSetRemoteDescriptionFailure"))):(Ht.log("onUserMediaSuccessTestUni : before setRemoteDescription for callee - Promise version"),this.pc.setRemoteDescription(Rt).then(this.callback(this,"onSetRemoteDescriptionSuccess")).catch(this.callback(this,"onSetRemoteDescriptionFailure"))),this.doAnswer())},this.onUserMediaErrorOnCall=function(Rt){var nt=this;Ht.log("onUserMediaErrorOnCall");var Ct={};Kt.getUserMediaOnGoing=!1,setTimeout(function(){fn.createErrorEvent(Rt,"USER_MEDIA_ERROR",nt.callId)}),Ht.error("Failed to get access to local media. Error code was "+Rt.code),Ht.error(Rt),Rt=null,ot.$6!=="electron"&&ot.Xh==="Chrome"&&ot.PR>47&&(Ht.log("browser_version > 47"),window.location.protocol!=="https:"&&Ht.error("HTTPS is now mandatory to use getUserMedia()")),this.screenSharing===!0&&(this.callType="screenSharing",window.location.protocol!=="https:"?(Ht.log("You need to be connected using HTTPS for screenSharing"),fn.createDesktopCaptureEvent("UserMediaError_HTTPS_needed",this.callId,this.remoteId)):(Ht.log("screenSharing UserMediaError"),fn.createDesktopCaptureEvent("UserMediaError",this.callId,this.remoteId))),this.callee===!0?(this.myWebRTC_Stack.sendBye(this.callId,this.calleeId,this.dest_roomId,this.callerId,"User_Media_Error",this.data),Kt.removeCallFromTableWithCallIdandRemoteId(this.callId,this.callerId,"User_Media_Error")):(this.data!==void 0&&this.data!==null&&this.data.MCUType==="MCU-Callee"&&this.myWebRTC_Stack.sendBye(this.callId,this.callerId,this.dest_roomId,this.calleeId,"User_Media_Error",this.data),Kt.removeCallFromTableWithCallIdandRemoteId(this.callId,this.calleeId,"User_Media_Error")),this.screenSharing===!1&&(Kt.userMediaErrorDetected=!0,Ct.userMediaErrorDetected=Kt.userMediaErrorDetected,apiCC.session.setUserData(Ct))},this.maybeStart=function(){Ht.debug("maybeStart"),!this.started&&Kt.channelReady&&(Kt.accessToLocalMedia||this.dataCall)&&(Ht.log("Creating PeerConnection."),this.createPeerConnection(),Kt.unidirectionelCallOnly||this.screenSharing===!0?this.callee===!1&&(Ht.log("Adding local stream 2."),this.callLocalStream!==null?(Ht.log("Add Stream of callLocalStream"),this.addStream(this.callLocalStream)):Kt.localStream!==null?(Ht.log("Add Stream of client.localStream"),this.addStream(Kt.localStream),this.callLocalStream=Kt.localStream):Ht.log("No Stream to add")):this.dataCall||(Ht.log("Adding local stream 3."),this.callLocalStream!==null?(Ht.log("Add Stream of callLocalStream"),this.addStream(this.callLocalStream)):Kt.localStream!==null?(Ht.log("Add Stream of client.localStream"),this.addStream(Kt.localStream),this.callLocalStream=Kt.localStream):(Ht.log("No Stream to add"),this.belongsToRoom()||lt.wL.type!=="safari"||typeof this.pc.addTransceiver!="function"||(Ht.debug("add transceivers"),this.pc.addTransceiver("audio",{direction:"recvonly"}),this.pc.addTransceiver("video",{direction:"recvonly"})))),this.started=!0,this.callee===!1&&(Ht.log("Before doCall()"),this.doCall())),Ht.log("End of maybeStart")},this.createDataChannel=function(){if(Ht.info("createDataChannel"),ot.Xh==="Edge"&&ot.PR<79&&apiRTC.browserDetails.type!=="chrome")Ht.warn("Cannot create DataChannel as it is not supported on Edge");else if(this.sendDataChannel===null)try{this.sendDataChannel=this.pc.createDataChannel("apiRTCDataChannel",{}),this.sendDataChannel.binaryType="arraybuffer",Ht.log("Created data channel"),Ht.log("Subscribing to dc events"),this.sendDataChannel.onopen=this.callback(this,"onSendDataChannelOpen"),this.sendDataChannel.onclose=this.callback(this,"onSendDataChannelClose"),this.sendDataChannel.onmessage=this.callback(this,"onSendDataChannelMessage"),this.sendDataChannel.onerror=this.callback(this,"onSendDataChannelError")}catch(Rt){Ht.log("createDataChannel() failed with exception: "+Rt.message)}else Ht.log("Datachannel already exist")},this.createPeerConnection=function(){Ht.info("createPeerConnection");try{Ht.log("createPeerConnection with pc_config:",JSON.stringify(this.pc_config)),Ht.log("and pc_constraints:",JSON.stringify(this.pc_constraints)),lt.wL.type==="chrome"&&lt.wL.version>=72&&lt.wL.version<78?(Ht.debug("Chrome 72=+ and 78-, force sdpSemantics plan-b"),this.pc_config.sdpSemantics="plan-b"):apiRTC.osName==="iOS"&&typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0?(Ht.debug("Cordova, force sdpSemantics plan-b"),this.pc_config.sdpSemantics="plan-b"):Ht.debug("sdpSemantics unified-plan is being used"),this.pc=new apiCC.myWebRTC_Adapter.RTCPeerConnection(this.pc_config,this.pc_constraints),this.dataCall&&this.createDataChannel(),this.pc.onicecandidate=this.callback(this,"onIceCandidate")}catch(Rt){return Ht.log("Failed to create PeerConnection, exception: "+Rt.message),void Ht.error("Cannot create RTCPeerConnection object; WebRTC is not supported by this browser.")}ot.Xh==="Firefox"&&ot.PR>=53||ot.Xh==="Edge"||lt.wL.type==="chrome"&&lt.wL.version>=64?(this.pc.ontrack=this.callback(this,"onRemoteTrackAdded"),this.pc.onaddstream=this.callback(this,"onRemoteStreamAdded")):ot.Xh==="Safari"&&ot.PR>=12||ot.Xh==="Mobile Safari"&&ot.PR>=12||typeof apiRTC_React<"u"?this.pc.ontrack=this.callback(this,"onRemoteTrackAdded"):this.pc.onaddstream=this.callback(this,"onRemoteStreamAdded"),this.pc.onremovestream=this.callback(this,"onRemoteStreamRemoved"),this.pc.onnegotiationneeded=this.callback(this,"onNegotiationNeeded"),this.pc.onsignalingstatechange=this.callback(this,"onSignalingStateChange"),this.pc.oniceconnectionstatechange=this.callback(this,"onIceConnectionStateChange"),this.pc.ondatachannel=this.callback(this,"onDataChannel"),this.pc.onicegatheringstatechange=this.callback(this,"onIceGatheringStateChange"),this.pc.onconnectionstatechange=this.callback(this,"onConnectionStateChange"),Kt.qosEnable&&(this.statisticId=setInterval(this.callback(this,"getStatistics"),this.getStatsInterval)),Kt.csmEnable&&(this.csmLastResults={},this.csmIntervalId=setInterval(this.callback(this,"csmHandler"),this.csmIntervalMs))},this.onIceGatheringStateChange=function(Rt){Ht.log("onIceGatheringStateChange"),this.pc!==null&&(Ht.info("onIceGatheringStateChange, Ice Gathering State is now : "+this.pc.iceGatheringState),this.pc.iceGatheringState==="complete"&&this.candidateNb===0&&Ht.warn("Warning, no candidate where retrieved for this call on client"))},this.onConnectionStateChange=function(Rt){Ht.log("onConnectionStateChange event :",Rt)},this.onDataChannel=function(Rt){Ht.info("onDataChannel event"),this.receiveDataChannel=Rt.channel,this.receiveDataChannel.binaryType="arraybuffer",this.sendDataChannel===null&&(Ht.log("Setting this.sendDataChannel with receivedDataChannel"),this.sendDataChannel=Rt.channel,this.sendDataChannel.onopen=this.callback(this,"onSendDataChannelOpen"),this.sendDataChannel.onclose=this.callback(this,"onSendDataChannelClose"),this.sendDataChannel.onmessage=this.callback(this,"onSendDataChannelMessage"),this.sendDataChannel.onerror=this.callback(this,"onSendDataChannelError")),Ht.log("got dataChannel",Rt.channel.label),Ht.log("Subscribing to dc events"),this.receiveDataChannel.onopen=this.callback(this,"onReceiveDataChannelOpen"),this.receiveDataChannel.onclose=this.callback(this,"onReceiveDataChannelClose"),this.receiveDataChannel.onmessage=this.callback(this,"onReceiveDataChannelMessage"),this.receiveDataChannel.onerror=this.callback(this,"onReceiveDataChannelError")},this.onSendDataChannelOpen=function(Rt){Ht.info("onSendDataChannelOpen"),this.callType==="data"&&this.calleeId==="dataChannelConnector"&&(this.pushDataStatus&&this.pushDataStatus.type==="pipeline"?(this.pushDataStatus.state="ready",setTimeout(function(){Kt.startNextPushData()})):this.transferStarted!==!0&&this.startTransfer()),fn.createEvent({eventType:"sendDataChannelOpen",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.onSendDataChannelClose=function(Rt){Ht.info("onSendDataChannelClose"),this.sendDataChannel=null,fn!==null&&fn.createEvent({eventType:"sendDataChannelClose",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.processOnDataChannelMessage=function(Rt){var nt,Ct,yt=null,xt=null,wt="",Lt=0;if(Ht.info("processOnDataChannelMessage"),yt=JSON.parse(Rt.data),Ht.log("data.uuid :"+yt.uuid),Ht.log("data.messageSize :"+yt.messageSize),Ht.log("data.originalDataType :"+yt.originalDataType),nt=yt.uuid,yt.originalDataType==="ArrayBuffer"&&(Ht.log("ArrayBuffer conversion"),yt.message=lt.cw.decode(yt.message)),Ht.log("data :"+yt),Ht.log("data.uuid :"+nt),Ht.log("receiveChunkNb[uuid] :"+this.receiveChunkNb[nt]),this.receiveChunkNb[nt]===void 0)Ht.log("receiving first packet for uuid :"+nt),Ht.log("evt.data.message :"+Rt.data),this.firstDataPacket[nt]=yt,this.receiveChunkNb[nt]=1,this.receivedSize[nt]=0,this.startingDate=new Date,this.transferDuration=0,fn.createEvent({eventType:"onFileReceiving",remoteId:this.remoteId,callId:this.callId,name:yt.name,uuid:nt}),fn.createEvent({eventType:"onFileProgress",sendChunkNb:this.receiveChunkNb[nt],fileSize:this.firstDataPacket[nt].size,remainingSize:this.firstDataPacket[nt].size,callId:this.callId,uuid:nt,remoteId:this.remoteId,lastPacket:!1,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:0,transferEnded:!1});else if(Ht.log("new packet for uuid :"+nt),this.receiveChunkNb[nt]+=1,Ht.log("data.messageSize :"+yt.messageSize),Ht.log("data.message.length :"+yt.message.length),Lt=yt.messageSize||yt.message.length,Ht.log("receivedSize :"+Lt),this.receiveArrayToStoreChunks[nt]||(this.receiveArrayToStoreChunks[nt]=[]),this.receiveArrayToStoreChunks[nt].push(yt.message),this.receivedSize[nt]+=Lt,this.transferDuration=new Date-this.startingDate,this.receivedSize[nt]===this.firstDataPacket[nt].size){if(Ht.log("End of data transfert"),Ht.log("this.firstDataPacket.type :"+this.firstDataPacket[nt].type),this.firstDataPacket[nt].type==="image/png-dataUrl"){for(Ht.log("Photo received from a takeSnapshot"),Ct=0;Ct<this.receiveArrayToStoreChunks[nt].length;Ct+=1)wt+=this.receiveArrayToStoreChunks[nt][Ct];xt=wt}else xt=new window.Blob(this.receiveArrayToStoreChunks[nt]);fn.createEvent({eventType:"onFileProgress",sendChunkNb:this.receiveChunkNb[nt],fileSize:this.firstDataPacket[nt].size,remainingSize:0,callId:this.callId,uuid:nt,remoteId:this.remoteId,lastPacket:!1,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:100,transferEnded:!0}),fn.createEvent({eventType:"onFileReceived",callId:this.callId,uuid:nt,remoteId:this.remoteId,callerId:this.callerId,calleeId:this.calleeId,data:{file:xt,name:this.firstDataPacket[nt].name,type:this.firstDataPacket[nt].type,uuid:nt},details:Rt}),delete this.receiveArrayToStoreChunks[nt],delete this.receivedSize[nt],delete this.receiveChunkNb[nt],delete this.firstDataPacket[nt]}else fn.createEvent({eventType:"onFileProgress",sendChunkNb:this.receiveChunkNb[nt],fileSize:this.firstDataPacket[nt].size,remainingSize:this.firstDataPacket[nt].size-this.receivedSize[nt],callId:this.callId,uuid:nt,remoteId:this.remoteId,lastPacket:!1,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*this.receivedSize[nt]/this.firstDataPacket[nt].size,10),transferEnded:!1})},this.onSendDataChannelMessage=function(Rt){Ht.info("onSendDataChannelMessage :",Rt),this.processOnDataChannelMessage(Rt)},this.onSendDataChannelError=function(Rt){Ht.info("onSendDataChannelError"),this.sendDataChannel=null,fn.createEvent({eventType:"sendDataChannelError",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.onReceiveDataChannelOpen=function(Rt){Ht.info("onReceiveChannelOpen"),fn.createEvent({eventType:"receiveDataChannelOpen",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.onReceiveDataChannelClose=function(Rt){Ht.info("onReceiveDataChannelClose"),this.receiveDataChannel=null,fn!==null&&fn.createEvent({eventType:"receiveDataChannelClose",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.onReceiveDataChannelMessage=function(Rt){Ht.info("onReceiveChannelMessage"),this.processOnDataChannelMessage(Rt)},this.onReceiveDataChannelError=function(Rt){Ht.info("onReceiveChannelError"),fn.createEvent({eventType:"receiveDataChannelError",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.startTransfer=function(){var Rt=this,nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ct=nt.hasOwnProperty("delay")?nt.delay:100;this.transferStarted!==!0&&(Ht.info("startTransfer",Ct),this.transferStarted=!0,setTimeout(function(){Rt.dcfs||(Rt.dcfs=new zt(Rt),Rt.data.offset>0?Rt.dcfs.transfer(Rt.fileContent.buffer,Rt.data.offset,Rt.sendDataChannel,{delay:Ct}):Rt.dcfs.transfer(Rt.fileContent.buffer,0,Rt.sendDataChannel,{delay:Ct}))},Ct))},this.statisticsAnswer=function(Rt){var nt=Rt.result(),Ct=null;this.qm||(this.qm=new Ot(this.getStatsInterval/1e3,this.callback(this,"onQosChange"),this.callback(this,"onQosAudioChange"),this.callback(this,"onQosVideoChange"),this.callId,Kt.apiKey,Kt.clientId,Kt.socket)),nt&&(this.qm.insertStats(nt,this.sendedSdpOfferMessage,this.receivedSdpOfferMessage,Kt.remoteVideo),Ct=this.qm.getAllStats(),Kt.qosEnable&&fn.createEvent({eventType:"onQosStatsUpdate",callId:this.callId,remoteId:this.remoteId,stats:Ct}),this.videoReceivedWidth=Ct.VideoRecv.FrameWidth,this.videoReceivedHeight=Ct.VideoRecv.FrameHeight,this.videoSendWidth=Ct.VideoSend.FrameWidth,this.videoSendHeight=Ct.VideoSend.FrameHeight,this.videoReceivedDelay=Ct.VideoRecv.delay,this.audioReceivedDelay=Ct.AudioRecv.delay,this.audioSendDelay=Ct.AudioSend.rtt,this.videoSendDelay=Ct.VideoSend.rtt,this.videoSendMoyDelay=Ct.VideoSend.moyRtt,this.videoSendPacketLossRatio=Ct.VideoSend.packetLostRatio,this.audioSendPacketLossRatio=Ct.AudioSend.packetLostRatio,this.videoSendEncodeUsagePercent=Ct.VideoSend.googEncodeUsagePercent,this.videoSendCpuLimitedResolution=Ct.VideoSend.googCpuLimitedResolution,this.videoSendBandwidthLimitedResolution=Ct.VideoSend.googBandwidthLimitedResolution,this.videoSendCpuLimitedResolution!==void 0&&JSON.parse(this.videoSendCpuLimitedResolution)===!0&&fn.createEvent({eventType:"cpuLimited",callId:this.callId,encodeUsagePercent:this.videoSendEncodeUsagePercent}),this.videoSendBandwidthLimitedResolution!==void 0&&JSON.parse(this.videoSendBandwidthLimitedResolution)===!0&&fn.createEvent({eventType:"bandwidthLimited",callId:this.callId}))},this.csmGetStatsHandler=function(Rt){var nt,Ct=this,yt=null,xt=null,wt={};if(this.csm||(this.csm=new Bt(this.csmIntervalMs/1e3,lt.wL.type,lt.wL.version,"standard"),this.csm.browserInfo={browserAbout:ot.Xh+" "+ot.dc,browserType:lt.wL.type,browserVersion:lt.wL.version},(0,lt.Ym)(this.mcuRemoteStream,"attributes","object")&&(this.mcuRemoteStream.replay===!0?(0,lt.Ym)(this.mcuRemoteStream.attributes.callerId,"string")&&(0,lt.Ym)(this.mcuRemoteStream.attributes.callId,"string")&&(0,lt.Ym)(this.mcuRemoteStream.attributes.recId,"string")&&(this.csm.callFeed={clientId:this.mcuRemoteStream.attributes.callerId,callId:this.mcuRemoteStream.attributes.callId,modifier:"replay",recId:this.mcuRemoteStream.attributes.recId}):(0,lt.Ym)(this.mcuRemoteStream.attributes.callerId,"string")&&(0,lt.Ym)(this.mcuRemoteStream.attributes.callId,"string")&&(this.csm.callFeed={clientId:this.mcuRemoteStream.attributes.callerId,callId:this.mcuRemoteStream.attributes.callId}))),wt.post=function(Et){Ct.mos||(Ct.mos=new rn),Et.quality={},Et.audioReceived?Ct.isRemoteAudioMuted?Et.quality.mosS="Muted":Et.audioReceived.bitsReceivedPerSecond!==0?(Et.audioReceived.delay=parseInt(Ct.audioReceivedDelay,10),Et.quality.mosS=Ct.mos.NarrowBandSpeechQuality(Et.audioReceived.delay,Et.audioReceived.packetLossRatio)):Et.quality.mosS="NoStream":Et.quality.mosS="NoStream",Et.videoReceived?Ct.isRemoteVideoMuted?Et.quality.mosV="Muted":Et.videoReceived.bitsReceivedPerSecond!==0?(Et.videoReceived.width=Ct.videoReceivedWidth,Et.videoReceived.height=Ct.videoReceivedHeight,Et.videoReceived.delay=parseInt(Ct.videoReceivedDelay,10),Et.quality.mosV=Ct.mos.videoQuality(Et.videoReceived.width,Et.videoReceived.height,Et.videoReceived.packetLossRatio,Math.floor(Et.videoReceived.bitsReceivedPerSecond/1e3),Et.videoReceived.framesDecodedPerSecond)):Et.quality.mosV="NoStream":Et.quality.mosV="NoStream",Et.audioReceived&&Et.videoReceived&&(Et.quality.mosAV=Ct.mos.audiovisualQuality(Et.quality.mosS,Et.quality.mosV,Et.audioReceived.delay,Et.videoReceived.delay)),Et.audioSent?Ct.isLocalAudioMuted?Et.quality.mosSS="Muted":Et.audioSent.bitsSentPerSecond!==0?(Et.audioSent.delay=parseInt(Ct.audioSendDelay,10),Et.audioSent.packetLossRatio=Ct.audioSendPacketLossRatio,Et.quality.mosSS=Ct.mos.NarrowBandSpeechQuality(Et.audioSent.delay,Et.audioSent.packetLossRatio)):Et.quality.mosSS="NoStream":Et.quality.mosSS="NoStream",Et.videoSent?Ct.isLocalVideoMuted?Et.quality.mosSV="Muted":Et.videoSent.bitsSentPerSecond!==0?(Et.videoSent.width=Ct.videoSendWidth,Et.videoSent.height=Ct.videoSendHeight,Et.videoSent.delay=parseInt(Ct.videoSendDelay,10),Et.videoSent.moyDelay=parseInt(Ct.videoSendMoyDelay,10),Et.videoSent.packetLossRatio=Ct.videoSendPacketLossRatio,Et.videoSent.encodeUsagePercent=Ct.videoSendEncodeUsagePercent,Et.videoSent.cpuLimitedResolution=Ct.videoSendCpuLimitedResolution,Et.videoSent.bandwidthLimitedResolution=Ct.videoSendBandwidthLimitedResolution,Et.quality.mosSV=Ct.mos.videoQuality(Et.videoSent.width,Et.videoSent.height,Et.videoSent.packetLossRatio,Math.floor(Et.videoSent.bitsSentPerSecond/1e3),Et.videoSent.framesEncodedPerSecond)):Et.quality.mosSV="NoStream":Et.quality.mosSV="NoStream",Et.audioSent&&Et.videoSent&&(Et.quality.mosSAV=Ct.mos.audiovisualQuality(Et.quality.mosSS,Et.quality.mosSV,Et.audioSent.delay,Et.videoSent.delay))},nt=this.csm.addCallStats(Rt,wt),Object.keys(nt).length!==0){!nt.quality||nt.quality.mosS==="Muted"&&nt.quality.mosV==="Muted"&&nt.quality.mosSS==="Muted"&&nt.quality.mosSV==="Muted"||Kt.qualityScoreEnable&&fn.createEvent({eventType:"onCallScoreUpdate",callId:this.callId,score:nt.quality}),this.csmLastResults=nt,this.callLocalStream&&typeof this.callLocalStream.getVideoTracks=="function"&&(yt=this.callLocalStream.getVideoTracks())&&yt[0]&&typeof yt[0].getSettings=="function"&&(xt=yt[0].getSettings());var Lt={save:!0,clientId:Kt.clientId,callId:this.callId,instanceId:this.instanceId,browserInfo:this.csm.browserInfo,stats:nt};this.sessionMCU&&(Lt.roomId=this.sessionMCU.roomName,Lt.pubSub=Kt.MCUClient.pubConnector),this.csm.callFeed&&(Lt.callFeed=this.csm.callFeed),xt&&(Lt.videoSettings=xt),this.data.mesh&&(Lt.mesh=this.data.mesh),this.myWebRTC_Stack.sendInfo("callStats",Lt),Kt.csmEnable&&(this.data&&this.data.mesh&&(this.data.mesh.calleeCompositeUserId?this.data.mesh.calleeCompositeUserId===Kt.compositeClientId:this.data.mesh.calleeId===Kt.clientId)?fn.createEvent({eventType:"onCallStatsUpdate",callId:this.data.mesh.calleeCallId,userId:this.data.mesh.callerId,stats:nt}):fn.createEvent({eventType:"onCallStatsUpdate",callId:this.callId,stats:nt}))}},this.onQosChange=function(Rt,nt){fn.createEvent({eventType:"onQosChange",callId:this.callId,remoteId:this.remoteId,qosIn:Rt,qosOut:nt})},this.onQosAudioChange=function(Rt,nt){fn.createEvent({eventType:"onQosAudioChange",callId:this.callId,remoteId:this.remoteId,qosAudioIn:Rt,qosAudioOut:nt})},this.onQosVideoChange=function(Rt,nt){fn.createEvent({eventType:"onQosVideoChange",callId:this.callId,remoteId:this.remoteId,qosVideoIn:Rt,qosVideoOut:nt})},this.getStatistics=function(){this.pc&&(ot.Xh==="Chrome"&&ot.PR>112?Ht.debug("getStats with callback in now deprecated on Chrome, getStatistics() / QoSMonitor can no more be used"):this.pc.getStats&&ot.Xh==="Chrome"&&this.pc.getStats(this.callback(this,"statisticsAnswer")))},this.csmHandler=function(){this.statisticId||this.getStatistics(),this.pc&&typeof this.pc.getStats=="function"&&this.pc.getStats(null).then(this.callback(this,"csmGetStatsHandler")).catch(function(Rt){Ht.warn("failed to get stats",Rt)})},this.doCall=function(){var Rt=null;Ht.log("Sending offer to peer"),this.audioOnly?(Ht.log("audioOnly call :",this.mediaConstraintsAudioOnly),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraintsAudioOnly)):(Ht.log("createOffer - Promise version"),this.pc.createOffer(this.mediaConstraintsAudioOnly).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure")))):this.screenSharing===!0?(Ht.log("screenSharing call : one way media :",Rt),Rt={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),Rt)):(Ht.log("createOffer - Promise version"),this.pc.createOffer(Rt).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure")))):this.dataCall===!0?(Ht.log("call is data only :",Rt),Rt=ot.Xh==="Firefox"&&ot.PR>43?{offerToReceiveAudio:!1,offerToReceiveVideo:!1}:{mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),Rt)):(Ht.log("createOffer - Promise version"),this.pc.createOffer(Rt).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure")))):(Ht.log("call is audio & video :",this.mediaConstraints),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraints)):(Ht.log("createOffer - Promise version"),this.pc.createOffer(this.mediaConstraints).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure"))))},this.doAnswer=function(){Ht.info("doAnswer");var Rt=null;this.audioOnly?(Ht.log("audioOnly call"),Rt=this.mediaConstraintsAudioOnly):Rt=this.mediaConstraints,ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("createAnswer"),this.pc.createAnswer(this.callback(this,"setLocalAndSendMessage"),this.callback(this,"onCreateAnswerFailure"),Rt)):(Ht.log("createAnswer - Promise version"),this.pc.createAnswer(Rt).then(this.callback(this,"setLocalAndSendMessage")).catch(this.callback(this,"onCreateAnswerFailure")))},this.doUpdateAnswer=function(){Ht.info("doUpdateAnswer");var Rt=null;this.audioOnly?(Ht.log("audioOnly call"),Rt=this.mediaConstraintsAudioOnly):Rt=this.mediaConstraints,ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("createAnswer"),this.pc.createAnswer(this.callback(this,"setLocalAndSendMessageUpdate"),this.callback(this,"onCreateAnswerFailure"),Rt)):(Ht.log("createAnswer - Promise version"),this.pc.createAnswer(Rt).then(this.callback(this,"setLocalAndSendMessageUpdate")).catch(this.callback(this,"onCreateAnswerFailure")))},this.updateMediaWithRetryManagement=function(Rt){Ht.debug("updateMediaWithRetryManagement");var nt=this.updateMedia(Rt);Ht.debug("updateMediaResult :",nt),nt.reason!=="Sig_state_not_stable"&&nt.reason!=="Update_already_ongoing"||(Ht.debug("updateMedia will be retried later for reason :",nt.reason),this.retryUpdateMedia=!0)},this.updateMedia=function(Rt){return Ht.debug("updateMedia, callId :",this.callId),Ht.log("iceRestartActivated :",Rt),this.pc===null?(Ht.log("updateMedia, pc no more exist"),{status:"Not_Done",reason:"PC_Not_Exit"}):this.updateMediaOngoing===!0?(Ht.log("updateMedia, already ongoing"),{status:"Not_Done",reason:"Update_already_ongoing"}):(this.updateMediaOngoing=!0,this.pc.signalingState!=="stable"?{status:"Not_Done",reason:"Sig_state_not_stable"}:(Ht.log("Sending Update offer to peer."),this.audioOnly?(Ht.log("audioOnly call :",this.mediaConstraintsAudioOnly),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("createOffer"),this.mediaConstraintsAudioOnly.mandatory!==void 0?this.mediaConstraintsAudioOnly.mandatory.IceRestart=!0:this.mediaConstraintsAudioOnly.iceRestart=!0,Ht.log("this.mediaConstraints :",this.mediaConstraintsAudioOnly),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOfferUpdate"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraintsAudioOnly)):(Ht.log("createOffer - Promise version"),Rt===!0&&(this.mediaConstraintsAudioOnly.iceRestart=!0),Ht.log("this.mediaConstraints :",this.mediaConstraintsAudioOnly),this.pc.createOffer(this.mediaConstraintsAudioOnly).then(this.callback(this,"setLocalAndSendMessageonOfferUpdate")).catch(this.callback(this,"onCreateOfferFailure")))):ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("createOffer"),Rt===!0&&(this.mediaConstraints.mandatory!==void 0?this.mediaConstraints.mandatory.IceRestart=!0:this.mediaConstraints.iceRestart=!0),Ht.log("this.mediaConstraints :",this.mediaConstraints),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOfferUpdate"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraints)):(Ht.log("createOffer - Promise version"),Rt===!0&&(this.mediaConstraints.iceRestart=!0),Ht.log("this.mediaConstraints :",this.mediaConstraints),this.pc.createOffer(this.mediaConstraints).then(this.callback(this,"setLocalAndSendMessageonOfferUpdate")).catch(this.callback(this,"onCreateOfferFailure"))),{status:"OnGoing",reason:"OK"}))},this.manipulateSDP=function(Rt,nt){var Ct=null,yt=!1;return Ht.log("manipulateSDP with type :",nt),Kt.receiveMediaDeactivated===!0&&(Ht.log("setting receiveMediaDeactivated in SDP :"+Kt.receiveMediaDeactivated),Rt.sdp=Kt.mySDPManager.setSendOnly(Rt.sdp)),Kt.RTPMedia===!0&&(Rt.sdp=Rt.sdp.replace(/RTP\/SAVPF/g,"RTP/SF")),Kt.audioBandwidth!==null&&(Ht.log("setting audioBandwidth in SDP :"+Kt.audioBandwidth),Rt.sdp=Kt.mySDPManager.setAudioBandwidth(Rt.sdp,Kt.audioBandwidth)),Kt.videoBandwidth!==null&&(Ht.log("setting videoBandwidth in SDP :"+Kt.videoBandwidth),Rt.sdp=Kt.mySDPManager.setVideoBandwidth(Rt.sdp,Kt.videoBandwidth)),Kt.dataBandwidth!==null&&(Ht.log("setting dataBandwidth in SDP :"+Kt.dataBandwidth),Rt.sdp=Kt.mySDPManager.setDataBandwidth(Rt.sdp,Kt.dataBandwidth)),Kt.preferOpusCodec===!0&&(Ht.log("setting preferOpusCodec"),Rt.sdp=Kt.mySDPManager.preferOpus(Rt.sdp)),Kt.preferVP9Codec!==!0&&this.preferVP9Codec!==!0||(Ht.log("Call prefer VP9 Codec"),Rt.sdp=Kt.mySDPManager.maybePreferCodec(Rt.sdp,"video","VP9")),Kt.preferH264Codec!==!0&&this.preferH264Codec!==!0||(Ht.log("Call prefer H264 Codec"),Rt.sdp=Kt.mySDPManager.maybePreferCodec(Rt.sdp,"video","H264")),this.preferVP8Codec===!0&&(Ht.log("Call prefer VP8 Codec"),Rt.sdp=Kt.mySDPManager.maybePreferCodec(Rt.sdp,"video","VP8")),Kt.setStereo===!0&&(Ht.log("Set Stereo"),Rt.sdp=Kt.mySDPManager.setCodecParam(Rt.sdp,"opus/48000","stereo","1")),Rt=Kt.mySDPManager.updateSDPcodecs(Rt,Rt.type,"audio",Kt.allowedAudioCodecs),Rt=Kt.mySDPManager.updateSDPcodecs(Rt,Rt.type,"video",Kt.allowedVideoCodecs),nt==="OFFER"?this.settingUpType==="publish"&&this.mediaTypeForIncomingCall==="NONE"?(Ct=Kt.mySDPManager.createGuideline(Rt.sdp),this.mediaTypeForOutgoingCall==="VIDEO"?((0,lt.ki)(Ct,"audio","object")&&Ct.audio.direction!=="sendonly"&&(Ct.audio.direction="sendonly",yt=!0),(0,lt.ki)(Ct,"video","object")&&Ct.video.direction!=="sendonly"&&(Ct.video.direction="sendonly",yt=!0)):this.mediaTypeForOutgoingCall==="AUDIO"?((0,lt.ki)(Ct,"audio","object")&&Ct.audio.direction!=="sendonly"&&(Ct.audio.direction="sendonly",yt=!0),(0,lt.ki)(Ct,"video","object")&&Ct.video.direction!=="inactive"&&(Ct.video.direction="inactive",yt=!0)):this.mediaTypeForOutgoingCall==="VIDEOONLY"&&((0,lt.ki)(Ct,"audio","object")&&Ct.audio.direction!=="inactive"&&(Ct.audio.direction="inactive",yt=!0),(0,lt.ki)(Ct,"video","object")&&Ct.video.direction!=="sendonly"&&(Ct.video.direction="sendonly",yt=!0)),yt===!0&&(Rt.sdp=Ct.generate())):this.mediaTypeForOutgoingCall==="VIDEO"?Ht.log("mediaTypeForOutgoingCall is VIDEO"):this.mediaTypeForOutgoingCall==="AUDIO"||this.audioOnly===!0?(Ht.log("mediaTypeForOutgoingCall is AUDIO"),Rt.sdp=Kt.mySDPManager.setRecvOnlyForVideo(Rt.sdp)):this.mediaTypeForOutgoingCall==="VIDEOONLY"?(Ht.log("mediaTypeForOutgoingCall is VIDEOONLY"),Rt.sdp=Kt.mySDPManager.setRecvOnlyForAudio(Rt.sdp)):this.mediaTypeForOutgoingCall==="NONE"&&(Ht.log("mediaTypeForOutgoingCall is NONE"),Rt.sdp=Kt.mySDPManager.setRecvOnly(Rt.sdp)):nt==="ANSWER"&&(this.mediaTypeForIncomingCall==="VIDEO"?Ht.log("mediaTypeForIncomingCall is VIDEO"):this.mediaTypeForIncomingCall==="AUDIO"||this.audioOnly===!0?(Ht.log("mediaTypeForIncomingCall is AUDIO"),Rt.sdp=Kt.mySDPManager.setRecvOnlyForVideo(Rt.sdp)):this.mediaTypeForIncomingCall==="VIDEOONLY"?(Ht.log("mediaTypeForIncomingCall is VIDEOONLY"),Rt.sdp=Kt.mySDPManager.setRecvOnlyForAudio(Rt.sdp)):this.mediaTypeForIncomingCall==="NONE"&&(Ht.log("mediaTypeForIncomingCall is NONE"),Rt.sdp=Kt.mySDPManager.setRecvOnly(Rt.sdp))),this.simulcast==="SDP"&&nt==="OFFER"&&this.settingUpType==="publish"&&((Ct=Kt.mySDPManager.createGuideline(Rt.sdp)).mungeForSimulcasting(),Rt.sdp=Ct.generate()),Rt},this.setLocalAndSendMessageonOffer=function(Rt){Ht.info("setLocalAndSendMessageonOffer"),Ht.log("sessionDescription = ",Rt),Ht.log("sessionDescription.sdp = ",Rt.sdp);var nt=null;Rt.sdp=this.manipulateSDP(Rt,"OFFER").sdp,Ht.log("manipulated sessionDescription.sdp = ",Rt.sdp),this.stripAudioSDPActivated===!0&&(Rt.sdp=Kt.mySDPManager.stripAudioMediaDescriptionFromSDP(Rt.sdp)),this.stripVideoSDPActivated===!0&&(Rt.sdp=Kt.mySDPManager.stripVideoMediaDescriptionFromSDP(Rt.sdp)),this.setLocalCallProfile(Kt.evalCallProfileWithSdp(Rt.sdp,"local","send")),this.sendedSdpOfferMessage=Rt,this.dataCall===!0&&(Ht.log("setLocalAndSendMessageonOffer : data Call"),this.callType="data"),this.callCancelled===!1?Kt.NtoNConf===!1?(Ht.log("Conf N to 1"),this.screenSharing===!0&&(nt=Kt.mySDPManager.getAudioMediaDescriptionPart(this.sendedSdpOfferMessage.sdp),this.callType=nt!=null?"screenSharingWithAudio":"screenSharing"),this.trickleIce===!0&&(this.myWebRTC_Stack.sendInvite(this.callId,this.callerId,Kt.nickname,this.dest_roomId,this.dest_roomId,this.callType,{offer:Rt,data:this.data,stream:this.mcuRemoteStream,volatile:!!this.restarted}),this.inviteSended=!0),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("setLocalAndSendMessageonOffer : before setLocalDescription"),this.pc.setLocalDescription(this.sendedSdpOfferMessage,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Ht.log("setLocalAndSendMessageonOffer : before setLocalDescription - Promise version"),this.pc.setLocalDescription(this.sendedSdpOfferMessage).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure")))):(Ht.log("Conf N to N"),this.myWebRTC_Stack.sendInviteBroadcast(this.callId,this.callerId,Kt.nickname,this.dest_roomId,this.dest_roomId,Rt),this.inviteSended=!0):(Ht.warn("Invite is not sent has call has been canceled"),Kt.removeCallFromTableWithCallIdandRemoteId(this.callId,this.calleeId,"Call_Cancelled"),Kt.callsTable.length===0&&Ht.log("No more established calls for client"))},this.setLocalAndSendMessageonOfferUpdate=function(Rt){var nt,Ct=null;Ht.info("setLocalAndSendMessageonOfferUpdate, sessionDescription :"+Rt),this.sendedSdpOfferMessage=Rt,Ht.log("sessionDescription.sdp = ",Rt.sdp),((0,lt.Ym)(this.audioSdpDirection,"string")||(0,lt.Ym)(this.videoSdpDirection,"string"))&&(Ct=Kt.mySDPManager.createGuideline(Rt.sdp),(0,lt.ki)(Ct,"audio","object")&&(0,lt.Ym)(this.audioSdpDirection,"string")&&(Ct.audio.direction=this.audioSdpDirection),(0,lt.ki)(Ct,"video","object")&&(0,lt.Ym)(this.videoSdpDirection,"string")&&(Ct.video.direction=this.videoSdpDirection),Rt.sdp=Ct.generate()),this.setLocalCallProfile(Kt.evalCallProfileWithSdp(Rt.sdp,"local","send"),!0),nt=this.callee?this.callerId:this.calleeId,this.trickleIce===!0?(this.myWebRTC_Stack.sendUpdate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt,this.callType,this.data),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription"),this.pc.setLocalDescription(Rt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Ht.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Rt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure")))):(Ht.log("Updating PC offer and answer after switch Stream"),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription"),this.pc.setLocalDescription(Rt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Ht.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Rt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure"))),Kt.preferSendingH264Codec&&(Ht.log("Modification of SDP to set H264 as prefered sending codec"),this.pc.remoteDescription.sdp=Kt.mySDPManager.maybePreferCodec(this.pc.remoteDescription.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("setLocalAndSendMessageonOfferUpdate : before setRemoteDescription"),this.pc.setRemoteDescription(this.pc.remoteDescription,this.callback(this,"onSetRemoteDescriptionSuccess"),this.callback(this,"onSetRemoteDescriptionFailure"))):(Ht.log("setLocalAndSendMessageonOfferUpdate : before setRemoteDescription - Promise version"),this.pc.setRemoteDescription(this.pc.remoteDescription).then(this.callback(this,"onSetRemoteDescriptionSuccess")).catch(this.callback(this,"onSetRemoteDescriptionFailure"))))},this.onCreateOfferFailure=function(Rt){Ht.info("onCreateOfferFailure"+Rt),Rt=null},this.onCreateAnswerFailure=function(Rt){Ht.info("onCreateAnswerFailure"+Rt),Rt=null},this.setLocalAndSendMessage=function(Rt){var nt;Ht.info("setLocalAndSendMessage"),Ht.log("sessionDescription.sdp = ",Rt.sdp),this.pc!==null?(Rt=this.manipulateSDP(Rt,"ANSWER"),nt=Kt.mySDPManager.createGuideline(Rt.sdp),this.setLocalCallProfile(Kt.evalCallProfileWithSdpGuideline(nt,Rt.sdp,"local","send")),this.setRemoteCallProfile(Kt.evalCallProfileWithSdpGuideline(nt,Rt.sdp,"local","receive")),Ht.log("manipulated sessionDescription.sdp = ",Rt.sdp),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("setLocalAndSendMessage : before setLocalDescription"),this.pc.setLocalDescription(Rt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Ht.log("setLocalAndSendMessage : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Rt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure"))),this.sendedSdpOfferMessage=Rt,this.trickleIce===!0&&this.myWebRTC_Stack.send200OK(this.callId,this.callerId,this.calleeId,Kt.nickname,this.dest_roomId,Rt,this.data)):Ht.log("setLocalAndSendMessage, pc no more exist")},this.setLocalAndSendMessageUpdate=function(Rt){var nt;if(this.pc!==null){lt.wL.type==="safari"&&(Rt.sdp=this.manipulateSDP(Rt,"OFFER").sdp),nt=Kt.mySDPManager.createGuideline(Rt.sdp),this.mediaType==="AUDIOONLY"?nt.hasOwnProperty("video")&&nt.video.direction!=="inactive"&&(Ht.debug("Only audio was requested at call setup: deactivating video"),nt.video.direction="inactive",Rt.sdp=nt.generate()):this.mediaType==="VIDEOONLY"&&nt.hasOwnProperty("audio")&&nt.audio.direction!=="inactive"&&(Ht.debug("Only video was requested at call setup: deactivating audio"),nt.audio.direction="inactive",Rt.sdp=nt.generate()),this.setLocalCallProfile(Kt.evalCallProfileWithSdpGuideline(nt,Rt.sdp,"local","send"),!0),this.setRemoteCallProfile(Kt.evalCallProfileWithSdpGuideline(nt,Rt.sdp,"local","receive"),!0),this.updateOngoingTimeoutId&&(clearTimeout(this.updateOngoingTimeoutId),delete this.updateOngoingTimeoutId),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Ht.log("setLocalAndSendMessageUpdate : before setLocalDescription"),this.pc.setLocalDescription(Rt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Ht.log("setLocalAndSendMessageUpdate : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Rt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure")));var Ct;Ct=this.callee?this.callerId:this.calleeId,this.myWebRTC_Stack.send200Update(this.callId,this.callerId,this.calleeId,this.dest_roomId,Ct,Rt,this.data),this.asyncCallbacks&&this.asyncCallbacks.type==="updateMediaType"&&(Ht.debug("asyncCallbacks resolve"),this.asyncCallbacks.resolve(),this.asyncCallbacks.timeoutId&&(clearTimeout(this.asyncCallbacks.timeoutId),delete this.asyncCallbacks.timeoutId),delete this.asyncCallbacks)}else Ht.log("setLocalAndSendMessageUpdate, pc no more exist")},this.onIceCandidate=function(Rt){try{Ht.debug("onIceCandidate :",JSON.stringify(Rt.candidate))}catch(xt){Ht.error(xt)}var nt,Ct=0,yt=0;nt=this.callee?this.callerId:this.calleeId,this.pc!==null&&(Ht.debug("Ice Connection State is now : "+this.pc.iceConnectionState),Ht.debug("Ice Gathering State is now : "+this.pc.iceGatheringState)),Rt.candidate?(this.candidateNb+=1,this.trickleIce===!0?this.mediaRoutingMode===Kt.mediaRoutingModeEnum.hostOnly?(Ct=Rt.candidate.candidate.search("host"))!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted}):Ht.log("Media routing mode is hostOnly and not a HOST Candidate : ignoring message"):this.mediaRoutingMode===Kt.mediaRoutingModeEnum.stun?(Ct=Rt.candidate.candidate.search("host"),yt=Rt.candidate.candidate.search("srflx"),Ct!==-1||yt!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted}):Ht.log("Media routing mode is stun and not a HOST or SRFLX Candidate : ignoring message")):this.mediaRoutingMode===Kt.mediaRoutingModeEnum.stunOnly?(Ct=Rt.candidate.candidate.search("srflx"))!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted}):Ht.log("Media routing mode is stunOnly and not a SRFLX Candidate : ignoring message"):this.mediaRoutingMode===Kt.mediaRoutingModeEnum.turn?(Ht.log("Media routing mode is turn : all candidates are considered"),this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted})):this.mediaRoutingMode===Kt.mediaRoutingModeEnum.turnOnly&&((Ct=Rt.candidate.candidate.search("relay"))!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted}):Ht.log("Media routing mode is TurnOnly and not a RELAY Candidate : ignoring message")):Ht.log("trickleIce is deactivated : candidates are not sended")):(Ht.info("End of candidates."),this.trickleIce===!1&&(Ht.log("trickleIce === false"),this.callee===!0?(this.send200OKTrickleIceFalseTimeOutId!==0&&(clearTimeout(this.send200OKTrickleIceFalseTimeOutId),this.send200OKTrickleIceFalseTimeOutId=0),this.message200OKSended===!1?this.myWebRTC_Stack.send200OK(this.callId,this.callerId,this.calleeId,Kt.nickname,this.dest_roomId,this.pc.localDescription,this.data):Ht.log("200OK already sended")):this.pc!==null&&(this.sendInviteTrickleIceFalseTimeOutId!==0&&(clearTimeout(this.sendInviteTrickleIceFalseTimeOutId),this.sendInviteTrickleIceFalseTimeOutId=0),this.inviteSended===!1?(Ht.log("sendInvite on end of candidate"),this.myWebRTC_Stack.sendInvite(this.callId,this.callerId,Kt.nickname,this.dest_roomId,this.dest_roomId,this.callType,{offer:this.pc.localDescription,data:this.data,stream:this.mcuRemoteStream,volatile:!!this.restarted}),this.inviteSended=!0):Ht.log("Invite already sended"))))},this.combineRemoteStreams=function(Rt,nt,Ct,yt){var xt=Rt.getTracks(),wt=Ct.getTracks();if(xt.length===1&&wt.length===1&&(xt[0].kind==="audio"&&wt[0].kind==="video"||xt[0].kind==="video"&&wt[0].kind==="audio")){Ht.debug("combineRemoteStreams");var Lt=new MediaStream;return Lt.addTrack(xt[0]),Lt.addTrack(wt[0]),yt==="internal"&&(Ct.removeTrack(wt[0]),this.onRemoteStreamRemoved({stream:Ct})),nt==="internal"&&(Rt.removeTrack(xt[0]),this.onRemoteStreamRemoved({stream:Rt})),this.onRemoteStreamAdded({stream:Lt}),!0}return!1},this.checkRemoteStreamExists=function(Rt,nt){var Ct=!1,yt=null,xt=null,wt=null,Lt=null,Et=null;for(nt&&Array.isArray(nt)&&(Lt=nt.slice(0)),yt=this.remoteMediaStreams.length;--yt>=0;){if(this.remoteMediaStreams[yt].id===Rt){Ct=!0;break}if(Lt)for(wt=(xt=this.remoteMediaStreams[yt].getTracks()).length;--wt>=0;)(Et=nt.indexOf(xt[wt].id))>=0&&(Lt[Et]=!0)}if(!Ct&&Lt){for(Et=0,wt=Lt.length;--wt>=0;)Lt[wt]===!0&&(Et+=1);Et===Lt.length&&(Ct=!0)}return Ct},this.onRemoteStreamAdded=function(Rt){var nt,Ct,yt=this;if(Ht.info("onRemoteStreamAdded",Rt),this.checkRemoteStreamExists(Rt.stream.id,Rt.stream.getTracks().map(function(qt){return qt.id})))Ht.debug("onRemoteStreamAdded: ignoring event; stream/track already known");else if(this.remoteMediaStreams.length!==1||!this.combineRemoteStreams(this.remoteMediaStreams[0],"internal",Rt.stream,"event")){Ht.debug("onRemoteStreamAdded adding",Rt.stream.id),this.remoteMediaStreams.push(Rt.stream),Ht.log("CallId is :"+this.callId),Ht.log("ClientId is :"+Kt.clientId),this.sessionMCU&&this.sessionMCU.modeChangeKind==="new"&&Kt.processRemoteStreamAdded(this,Rt.stream),this.screenSharing===!0?this.callType="screenSharing":this.audioOnly===!0&&(this.callType="audio");var xt,wt=function(qt){var on=null,hn=null;qt.onmute=function(nn){Ht.debug(qt.kind+" mute event");var dn="";qt.kind==="audio"&&on===null?on=setTimeout(function(){yt.isRemoteAudioSilent=!0,dn="audioIsSilentLocally";var Sn={},wn={},En=[];En.push(dn),Sn.available=yt.remoteCallProfile.audio,Sn.active=yt.remoteCallProfile.audioActive,Sn.muted=yt.isRemoteAudioMuted,Sn.silent=yt.isRemoteAudioSilent,wn.available=yt.remoteCallProfile.video,wn.active=yt.remoteCallProfile.videoActive,wn.muted=yt.isRemoteVideoMuted,wn.silent=yt.isRemoteVideoSilent,yt.myWebRTC_Event.createRemoteStreamUpdatedEvent(En,Sn,wn,yt.destCallType,yt.callId,"browserAction"),on=null},2520):qt.kind==="video"&&hn===null&&(hn=setTimeout(function(){yt.isRemoteVideoSilent=!0,dn="videoIsSilentLocally";var Sn={},wn={},En=[];En.push(dn),Sn.available=yt.remoteCallProfile.audio,Sn.active=yt.remoteCallProfile.audioActive,Sn.muted=yt.isRemoteAudioMuted,Sn.silent=yt.isRemoteAudioSilent,wn.available=yt.remoteCallProfile.video,wn.active=yt.remoteCallProfile.videoActive,wn.muted=yt.isRemoteVideoMuted,wn.silent=yt.isRemoteVideoSilent,yt.myWebRTC_Event.createRemoteStreamUpdatedEvent(En,Sn,wn,yt.destCallType,yt.callId,"browserAction"),hn=null},2520))},qt.onunmute=function(nn){if(Ht.debug(qt.kind+" unmute event"),qt.kind==="audio"&&on!==null)clearTimeout(on),on=null;else if(qt.kind==="video"&&hn!==null)clearTimeout(hn),hn=null;else{var dn="";qt.kind==="audio"?(yt.isRemoteAudioSilent=!1,dn="audioIsSilentLocally"):qt.kind==="video"&&(yt.isRemoteVideoSilent=!1,dn="videoIsSilentLocally");var Sn={},wn={},En=[];En.push(dn),Sn.available=yt.remoteCallProfile.audio,Sn.active=yt.remoteCallProfile.audioActive,Sn.muted=yt.isRemoteAudioMuted,Sn.silent=yt.isRemoteAudioSilent,wn.available=yt.remoteCallProfile.video,wn.active=yt.remoteCallProfile.videoActive,wn.muted=yt.isRemoteVideoMuted,wn.silent=yt.isRemoteVideoSilent,yt.myWebRTC_Event.createRemoteStreamUpdatedEvent(En,Sn,wn,yt.destCallType,yt.callId,"browserAction")}},qt.onended=function(nn){Ht.debug(qt.kind+" ended event"),qt.kind==="audio"&&on!==null?(clearTimeout(on),on=null):qt.kind==="video"&&hn!==null&&(clearTimeout(hn),hn=null)}},Lt=gn(Rt.stream.getVideoTracks());try{for(Lt.s();!(xt=Lt.n()).done;){var Et=xt.value;wt(Et),this.isRemoteVideoSilent=Et.muted}}catch(qt){Lt.e(qt)}finally{Lt.f()}var $t,Jt=gn(Rt.stream.getAudioTracks());try{for(Jt.s();!($t=Jt.n()).done;){var en=$t.value;wt(en),this.isRemoteAudioSilent=en.muted}}catch(qt){Jt.e(qt)}finally{Jt.f()}nt={available:this.remoteCallProfile.audio,active:this.remoteCallProfile.audioActive,muted:this.isRemoteAudioMuted,silent:this.isRemoteAudioSilent},Ct={available:this.remoteCallProfile.video,active:this.remoteCallProfile.videoActive,muted:this.isRemoteVideoMuted,silent:this.isRemoteVideoSilent},this.data!==null?this.data.mesh!==void 0?Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.stream,this.remoteId,this.destCallType,nt,Ct):this.data.type==="publish"&&this.data.mode!=="passive"?Ht.warn("Filtering Remote stream added event (behavior on Chrome 44), no remote stream on publish calls"):this.data.subscribeOrder===!0&&this.data.pubCallId!==void 0?(Ht.debug("substitute callId: "+this.callId+" -> "+this.data.pubCallId),Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.data.pubCallId,Rt.stream,this.remoteId,this.destCallType,nt,Ct)):Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.stream,this.remoteId,this.destCallType,nt,Ct):Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.stream,this.remoteId,this.destCallType,nt,Ct)}},this.onRemoteTrackAdded=function(Rt){var nt,Ct;if(Ht.info("onRemoteTrackAdded",Rt),Rt.streams[0]!==void 0&&Rt.track!==void 0){if(this.checkRemoteStreamExists(Rt.streams[0].id,[Rt.track.id]))Ht.debug("onRemoteTrackAdded: ignoring event; stream/track already known");else if(this.remoteMediaStreams.length!==1||!this.combineRemoteStreams(this.remoteMediaStreams[0],"internal",Rt.streams[0],"event")){if(this.belongsToRoom()){if(this.callType==="audio"&&Rt.track.kind!=="audio"||this.callType==="videoOnly"&&Rt.track.kind!=="video"||this.callType==="media"&&Rt.track.kind!=="video"||this.callType==="screenSharing"&&Rt.track.kind!=="video"||this.callType==="screenSharingWithAudio"&&Rt.track.kind!=="video")return void Ht.debug("onRemoteTrackAdded: ignoring event; callType: "+this.callType+", event.track.kind: "+Rt.track.kind)}else if(this.destCallType==="audio"&&Rt.track.kind!=="audio"||this.destCallType==="videoOnly"&&Rt.track.kind!=="video"||this.destCallType==="media"&&Rt.track.kind!=="video"||this.destCallType==="screenSharing"&&Rt.track.kind!=="video"||this.destCallType==="screenSharingWithAudio"&&Rt.track.kind!=="video")return Ht.debug("onRemoteTrackAdded: ignoring event; destCallType: "+this.destCallType+", event.track.kind: "+Rt.track.kind),void(this.remoteMediaStreams.length===2&&this.combineRemoveStreams(this.remoteMediaStreams[0],"internal",this.remoteMediaStreams[1],"internal"));Ht.debug("onRemoteTrackAdded adding; stream.id: "+Rt.streams[0].id),this.remoteMediaStreams.push(Rt.streams[0]),Ht.log("CallId is :"+this.callId),Ht.log("ClientId is :"+Kt.clientId),Ht.log("this.callType :"+this.callType),this.screenSharing===!0?this.callType="screenSharing":this.audioOnly===!0&&(this.callType="audio"),this.sessionMCU&&this.sessionMCU.modeChangeKind==="new"&&Kt.processRemoteStreamAdded(this,Rt.streams[0]),Rt.streams[0].onaddtrack=function(yt){Ht.debug("onRemoteTrackAdded ontrack.onaddtrack",yt)},Rt.streams[0].onremovetrack=(function(yt){var xt=null;if(Ht.debug("onRemoteTrackAdded ontrack.onremovetrack",yt),this.updateOngoingTimeoutId)return Ht.debug("onRemoteTrackAdded onremovetrack: update ongoing"),void Ht.debug("onRemoteTrackAdded onremovetrack: ignoring event",yt.track.kind);if(this.callType==="audio"&&yt.track.kind!=="audio"||this.callType==="videoOnly"&&yt.track.kind!=="video"||this.callType==="media"&&yt.track.kind!=="video"||this.callType==="screenSharing"&&yt.track.kind!=="video"||this.callType==="screenSharingWithAudio"&&yt.track.kind!=="video")Ht.debug("onRemoteTrackAdded onremovetrack: ignoring event",yt.track.kind);else if(yt.target instanceof MediaStream){for(xt=this.remoteMediaStreams.length;--xt>=0;)if(this.remoteMediaStreams[xt].id===yt.target.id){Ht.debug("onRemoteTrackAdded onremovetrack removing",yt.target.id),this.remoteMediaStreams.splice(xt,1);break}Kt.myWebRTC_Event.createRemoteStreamRemovedEvent(this.callType,this.callId,yt.target,this.remoteId,this.destCallType)}else Ht.debug("onRemoteTrackAdded onremovetrack: ignoring event target not MediaStream")}).bind(this),nt={available:this.remoteCallProfile.audio,active:this.remoteCallProfile.audioActive,muted:this.isRemoteAudioMuted,silent:this.isRemoteAudioSilent},Ct={available:this.remoteCallProfile.video,active:this.remoteCallProfile.videoActive,muted:this.isRemoteVideoMuted,silent:this.isRemoteVideoSilent},this.data!==null?this.data.mesh!==void 0?(this.callType==="audio"&&Rt.track.kind==="audio"||this.callType==="videoOnly"&&Rt.track.kind==="video"||this.callType==="media"&&Rt.track.kind==="video"||this.callType==="screenSharing"&&Rt.track.kind==="video"||this.callType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,Ct):this.data.type==="publish"&&this.data.mode!=="passive"?Ht.warn("Filtering Remote stream added event (behavior on Chrome 44), no remote stream on publish calls"):this.belongsToRoom()?(this.callType==="audio"&&Rt.track.kind==="audio"||this.callType==="videoOnly"&&Rt.track.kind==="video"||this.callType==="media"&&Rt.track.kind==="video"||this.callType==="screenSharing"&&Rt.track.kind==="video"||this.callType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&(this.data.subscribeOrder===!0&&this.data.pubCallId!==void 0?(Ht.debug("substitute callId: "+this.callId+" -> "+this.data.pubCallId),Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.data.pubCallId,Rt.streams[0],this.remoteId,this.destCallType,nt,Ct)):Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,Ct)):(this.destCallType==="audio"&&Rt.track.kind==="audio"||this.destCallType==="videoOnly"&&Rt.track.kind==="video"||this.destCallType==="media"&&Rt.track.kind==="video"||this.destCallType==="screenSharing"&&Rt.track.kind==="video"||this.destCallType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,Ct):this.belongsToRoom()?(this.callType==="audio"&&Rt.track.kind==="audio"||this.callType==="videoOnly"&&Rt.track.kind==="video"||this.callType==="media"&&Rt.track.kind==="video"||this.callType==="screenSharing"&&Rt.track.kind==="video"||this.callType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,Ct):(this.destCallType==="audio"&&Rt.track.kind==="audio"||this.destCallType==="videoOnly"&&Rt.track.kind==="video"||this.destCallType==="media"&&Rt.track.kind==="video"||this.destCallType==="screenSharing"&&Rt.track.kind==="video"||this.destCallType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&Kt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,Ct)}}else Ht.debug("onRemoteTrackAdded: ignoring event; event data are not correct")},this.onRemoteStreamRemoved=function(Rt){var nt=null;for(Ht.info("onRemoteStreamRemoved",Rt),nt=this.remoteMediaStreams.length;--nt>=0;)if(this.remoteMediaStreams[nt].id===Rt.stream.id){Ht.debug("onRemoteStreamRemoved removing",Rt.stream.id),this.remoteMediaStreams.splice(nt,1);break}Kt.myWebRTC_Event.createRemoteStreamRemovedEvent(this.callType,this.callId,Rt.stream,this.remoteId,this.destCallType),Rt=null},this.onNegotiationNeeded=function(Rt){Ht.debug("onNegotiationNeeded",Rt),Rt=null,this.addingDataChannelOnCallOngoing&&(this.updateMediaWithRetryManagement(!1),this.addingDataChannelOnCallOngoing=!1)},this.onSignalingStateChange=function(Rt){Ht.debug("onSignalingStateChange",Rt),Rt=null},this.onCallDisconnection=function(){Ht.info("onCallDisconnection; callId: "+this.callId);var Rt=new Date;Ht.debug("date:",Rt),this.disconnectionWarningInterval!==0&&(Ht.debug("date:",Rt),Ht.debug("clearing disconnectionWarningInterval"),clearInterval(this.disconnectionWarningInterval),this.disconnectionWarningInterval=0),this.disconnectionWarningTimeout!==0&&(Ht.debug("date:",Rt),Ht.debug("clearing disconnectionWarningTimeout"),clearTimeout(this.disconnectionWarningTimeout),this.disconnectionWarningTimeout=0),this.belongsToRoom()?Kt.onHangup(this.callId,"disconnected"):Kt.onHangup(this.callId,"Ice_disconnected")},this.sendDisconnectionWarning=function(){Ht.log("sendDisconnectionWarning()");var Rt=null,nt=null;if(this.callControl&&(Rt=this.callControl.roomName,nt=this.callControl.type),this.disconnectionWarningCount++,fn.createEvent({eventType:"disconnectionWarning",callId:this.callId,remoteId:this.remoteId,tries:this.disconnectionWarningCount,roomName:Rt,settingUpType:nt}),(this.disconnectionWarningCount-1)*this.disconnectionWarningDelay>=this.disconnectionTimer&&this.disconnectionWarningInterval!==0){var Ct=Date();Ht.debug("date :"+Ct),Ht.debug("clearing disconnectionWarningInterval : no more warnings"),clearInterval(this.disconnectionWarningInterval),this.disconnectionWarningInterval=0}},this.createIceErrorDescriptor=function(Rt,nt){var Ct={};return Rt==="disconnected"?Ct.iceState="disconnected":Rt==="failed"?(Ct.iceState="failed",nt===!0&&(Ct.previousIceState="disconnected")):Ct.iceState="unknown",Ct.callType=this.callType,this.belongsToRoom()?(Ct.context="conf",this.data.mesh?(Ct.mode="mesh",(this.data.mesh.callerCompositeUserId?this.data.mesh.callerCompositeUserId===Kt.compositeClientId:this.data.mesh.callerId===Kt.clientId)?(Ct.type="subscribe",Ct.clientId=this.data.mesh.callerId,Ct.remoteId=this.data.mesh.calleeId):(this.data.mesh.calleeCompositeUserId?this.data.mesh.calleeCompositeUserId===Kt.compositeClientId:this.data.mesh.calleeId===Kt.clientId)?(Ct.type="publish",Ct.clientId=this.data.mesh.calleeId,Ct.remoteId=this.data.mesh.callerId):Ct.type="unknown",Ct.mesh=this.data.mesh):(Ct.mode="sfu",this.settingUpType==="publish"||this.settingUpType==="shareScreen"?Ct.type="publish":this.settingUpType==="subscribe"?Ct.type="subscribe":Ct.type="unknown",this.callee?(Ct.clientId=this.calleeId,Ct.remoteId=this.callerId):(Ct.clientId=this.callerId,Ct.remoteId=this.calleeId)),this.mcuRemoteStream&&(Ct.stream=this.mcuRemoteStream)):(Ct.context="call",Ct.mode="p2p",this.callerId===Kt.clientId?(Ct.clientId=this.callerId,Ct.remoteId=this.calleeId):this.calleeId===Kt.clientId&&(Ct.clientId=this.calleeId,Ct.remoteId=this.callerId)),Ct},this.onIceConnectionStateChange=function(Rt){Ht.debug("onIceConnectionStateChange: ",Rt),Rt=null;var nt=0,Ct=null,yt=null,xt=null;this.pc!==null?(Ht.info("Ice Connection State is now : "+this.pc.iceConnectionState),this.iceState=this.pc.iceConnectionState,this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed"||this.pc.iceConnectionState==="checking"?(Ht.debug("iceConnectionState === connected or completed or checking"),Ht.debug("this.disconnectionTimeoutId :"+this.disconnectionTimeoutId),this.disconnectionTimeoutId!==0&&(nt=Date(),Ht.debug("date:",nt),Ht.debug("clearing disconnectionTimeout"),clearTimeout(this.disconnectionTimeoutId),this.disconnectionTimeoutId=0),this.disconnectionWarningInterval!==0&&(nt=Date(),Ht.debug("date:",nt),Ht.debug("clearing disconnectionWarningInterval"),clearInterval(this.disconnectionWarningInterval),this.disconnectionWarningInterval=0),this.pc.iceConnectionState!=="checking"&&(this.checkCandidateTypesTimeoutId=setTimeout(this.callback(this,"checkCandidateTypes"),this.checkCandidateTypesTimer),this.checkCandidateTypesTimeoutTable.push(this.checkCandidateTypesTimeoutId))):this.pc.iceConnectionState==="disconnected"?(this.callControl&&(Ct=this.callControl.roomName,yt=this.callControl.type),(xt=this.createIceErrorDescriptor("disconnected")).context==="conf"&&this.myWebRTC_Stack.sendInfo("iceError",{clientId:Kt.clientId,callId:this.callId,roomId:this.sessionMCU.roomName,pubSub:Kt.MCUClient.pubConnector,descriptor:xt}),Ht.warn("disconnection detected"),fn.createErrorEvent("iceDisconnection detected","ICE_CONNECTION_STATE_DISCONNECTED",this.callId,Ct,yt,xt),nt=new Date,Ht.debug("date:",nt),this.disconnectionTimeoutId=setTimeout(this.callback(this,"onCallDisconnection"),this.disconnectionTimer),this.disconnectionWarningCount=0,this.disconnectionWarningTimeout=setTimeout(this.callback(this,"sendDisconnectionWarning"),2e3),this.disconnectionWarningInterval=setInterval(this.callback(this,"sendDisconnectionWarning"),this.disconnectionWarningDelay)):this.pc.iceConnectionState==="failed"&&(this.callControl&&(Ct=this.callControl.roomName,yt=this.callControl.type),(xt=this.createIceErrorDescriptor("failed",this.disconnectionTimeoutId!==0)).context==="conf"&&this.myWebRTC_Stack.sendInfo("iceError",{clientId:Kt.clientId,callId:this.callId,roomId:this.sessionMCU.roomName,pubSub:Kt.MCUClient.pubConnector,descriptor:xt}),Ht.warn("iceConnection failed detected"),fn.createErrorEvent("iceConnection failed detected","ICE_CONNECTION_STATE_FAILED",this.callId,Ct,yt,xt),this.disconnectionTimeoutId!==0?this.belongsToRoom()&&(clearTimeout(this.disconnectionTimeoutId),this.disconnectionTimeoutId=0,Kt.onHangup(this.callId,"disconnected")):this.belongsToRoom()&&(0,lt.ki)(this.callControl,["autoRestart","counter"],"number")&&this.callControl.autoRestart.counter>0?Kt.onHangup(this.callId,"disconnected"):(Ht.warn("Removing call with callId: "+this.callId),Kt.removeCallFromTableWithCallIdAndSendBye(this.callId,"Ice_failed")))):Ht.log("Ice Connection State change with pc is null")},this.callback=function(Rt,nt){return this.closureHandler=function(Ct,yt){return Rt[nt](Ct,yt)},this.closureHandler},this.onSelectedCandidate=function(Rt){if(this.selectedCandidate===void 0||this.selectedCandidate===null||this.selectedCandidate.LocalCandidateType!==Rt.LocalCandidateType||this.selectedCandidate.RemoteCandidateType!==Rt.RemoteCandidateType||this.selectedCandidate.LocalAddress!==Rt.LocalAddress||this.selectedCandidate.RemoteAddress!==Rt.RemoteAddress||this.selectedCandidate.TransportType!==Rt.TransportType||this.selectedCandidate.LocalTransportType!==Rt.LocalTransportType){Ht.debug("WebRTC_Call::onSelectedCandidate() :",Rt),this.selectedCandidate=Rt,this.callControl&&this.callControl.autoRestart&&(Ht.debug("selectedCandidate, this.callControl.autoRestart.counter:",this.callControl.autoRestart.counter),Ht.debug("selectedCandidate, this.callControl.autoRestart.callIdWhenStartingTimer:",this.callControl.autoRestart.callIdWhenStartingTimer),this.callControl.autoRestart.counter&&(Ht.debug("Reinit of autoRestart.counter"),this.callControl.autoRestart.counter=0,this.callControl.autoRestart.callIdWhenStartingTimer!==void 0&&Kt.stopMaxCallRetriesTimer(this.callControl.autoRestart.callIdWhenStartingTimer))),this.myWebRTC_Event.createSelectedICECandidateEvent(this.callId,Rt.LocalCandidateType,Rt.RemoteCandidateType,Rt.LocalAddress,Rt.RemoteAddress,Rt.TransportType,Rt.LocalTransportType);var nt=Rt;nt.callId=this.callId,nt.clientId=Kt.clientId,nt.roomId=this.dest_roomId,this.data.pubSub!==void 0&&(nt.pubSub=this.data.pubSub),this.data.confId!==void 0&&(nt.confId=this.data.confId),this.data.mesh!==void 0&&(nt.mesh=this.data.mesh),this.data.instanceId!==void 0&&(nt.instanceId=this.data.instanceId),this.myWebRTC_Stack.sendInfo("callSelectedCandidate",nt)}else Ht.debug("filtering duplicate candidate")},this.checkCandidateTypes=function(){Ht.debug("WebRTC_Call::checkCandidatesTypes()");var Rt=this,nt={LocalCandidateType:"unknow",RemoteCandidateType:"unknow",LocalAddress:"unknow",RemoteAddress:"unknow",TransportType:"unknow",LocalTransportType:"unknow",relayTransportType:"unknow"},Ct=["googLocalAddress","googLocalCandidateType","googRemoteAddress","googRemoteCandidateType","googTransportType"];this.pc===null?(Ht.warn("Peer connection is null : no candidates"),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt)):typeof apiRTC_React<"u"?(Ht.debug("apiRTC_React : WebRTC_Call::checkCandidatesTypes()"),this.pc.getStats().then(function(yt){var xt=null;if(yt.forEach(function(Et){Et.nominated===!0&&(xt=Et)}),xt!==null){var wt=yt.get(xt.localCandidateId),Lt=yt.get(xt.remoteCandidateId);nt.LocalCandidateType=wt.candidateType,nt.RemoteCandidateType=Lt.candidateType,wt.address&&wt.port&&(nt.LocalAddress=wt.address+":"+wt.port),Lt.address&&Lt.port&&(nt.RemoteAddress=Lt.address+":"+Lt.port),nt.TransportType=wt.protocol,wt.candidateType==="relay"&&wt.relayProtocol!==void 0&&(nt.relayTransportType=wt.relayProtocol),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt)}}).catch(function(yt){Ht.error(yt)})):lt.wL.type==="chrome"&&ot.PR<=112?(Ht.debug("WebRTC_Call::checkCandidatesTypes() chrome <= 112"),this.pc.getStats(function(yt){var xt=yt.result().filter(function(wt){return wt.id.indexOf("Conn-")===0&&wt.stat("googActiveConnection")==="true"})[0];xt?(Ct.forEach(function(wt){nt[wt.replace("goog","")]=xt.stat(wt)}),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt)):(Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt))})):lt.wL.type==="chrome"||lt.wL.type==="firefox"||lt.wL.type==="safari"?(Ht.debug("WebRTC_Call::checkCandidatesTypes()"),this.pc.getStats(null).then(function(yt){var xt=null;if(yt.forEach(function(Et){Et.selected===!0&&lt.wL.type==="firefox"?(xt!==null&&Ht.warn("multiple selected candidate-pairs"),xt=Et):Et.nominated===!0&&(xt=Et)}),xt!==null){var wt=yt.get(xt.localCandidateId),Lt=yt.get(xt.remoteCandidateId);nt.LocalCandidateType=wt.candidateType,nt.RemoteCandidateType=Lt.candidateType,wt.address&&wt.port?nt.LocalAddress=wt.address+":"+wt.port:wt.ipAddress&&wt.portNumber&&(nt.LocalAddress=wt.ipAddress+":"+wt.portNumber),Lt.address&&Lt.port?nt.RemoteAddress=Lt.address+":"+Lt.port:Lt.ipAddress&&Lt.portNumber&&(nt.RemoteAddress=Lt.ipAddress+":"+Lt.portNumber),nt.TransportType=wt.protocol,wt.candidateType==="relay"&&wt.relayProtocol!==void 0&&(nt.relayTransportType=wt.relayProtocol),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt)}}).catch(function(yt){Ht.warn("failed to get stats",yt)})):(Ht.debug("checkCandidateTypes not Chrome or Firefox"),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt))},this.belongsToRoom=function(){return!!(0,lt.ki)(this.sessionMCU,"roomName","string")&&((0,lt.ki)(this.data,"MCUType","string")&&(this.data.MCUType==="MCU-Caller"||this.data.MCUType==="MCU-Callee")&&(0,lt.ki)(this.data,"confId","string")?this.data.confId===this.sessionMCU.roomName:this.dest_roomId===this.sessionMCU.roomName)},this.setLocalCallProfile=function(Rt){var nt=arguments.length>1&&arguments[1]!==void 0&&arguments[1],Ct=[],yt={},xt={},wt=null,Lt=null,Et="adaptation";this.dataCall!==!0&&this.settingUpType!=="subscribe"&&(this.localCallProfile.audioActive!==Rt.audioActive&&Ct.push("audioIsActive"),this.localCallProfile.videoActive!==Rt.videoActive&&Ct.push("videoIsActive"),this.localCallProfile=Rt,this.screenSharing===!0?this.localCallProfile.audioActive===!0&&this.localCallProfile.videoActive===!0?this.callType!=="screenSharingWithAudio"&&(this.callType="screenSharingWithAudio",Ct.push("callType")):this.localCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",Ct.push("callType")):this.localCallProfile.videoActive===!0?this.callType!=="screenSharing"&&(this.callType="screenSharing",Ct.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",Ct.push("callType")):this.localCallProfile.audioActive===!0&&this.localCallProfile.videoActive===!0?this.callType!=="media"&&(this.callType="media",Ct.push("callType")):this.localCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",Ct.push("callType")):this.localCallProfile.videoActive===!0?this.callType!=="videoOnly"&&(this.callType="videoOnly",Ct.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",Ct.push("callType")),nt===!0&&Ct.length>0&&(yt.available=this.localCallProfile.audio,yt.active=this.localCallProfile.audioActive,yt.muted=this.isLocalAudioMuted,yt.silent=this.isRemoteAudioSilent,xt.available=this.localCallProfile.video,xt.active=this.localCallProfile.videoActive,xt.muted=this.isLocalVideoMuted,xt.silent=this.isRemoteVideoSilent,this.callConfiguration&&this.callConfiguration.userMediaStreamId&&(wt=this.callConfiguration.userMediaStreamId,(Lt=apiCC.getUserMediaStream(wt))&&(yt.deviceLabel=Lt.audioDeviceLabel,xt.deviceLabel=Lt.videoDeviceLabel)),this.updateCause&&(Et=this.updateCause),this.myWebRTC_Event.createLocalStreamUpdatedEvent(Ct,yt,xt,!0,this.callType,this.callId,this.callLocalStream,wt,Et)))},this.setRemoteCallProfile=function(Rt){var nt=arguments.length>1&&arguments[1]!==void 0&&arguments[1],Ct=[],yt={},xt={},wt="adaptation";this.dataCall!==!0&&(this.remoteCallProfile.audioActive!==Rt.audioActive&&Ct.push("audioIsActive"),this.remoteCallProfile.videoActive!==Rt.videoActive&&Ct.push("videoIsActive"),this.remoteCallProfile=Rt,this.settingUpType==="subscribe"?(this.screenSharing===!0?this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.callType!=="screenSharingWithAudio"&&(this.callType="screenSharingWithAudio",Ct.push("callType")):this.remoteCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",Ct.push("callType")):this.remoteCallProfile.videoActive===!0?this.callType!=="screenSharing"&&(this.callType="screenSharing",Ct.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",Ct.push("callType")):this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.callType!=="media"&&(this.callType="media",Ct.push("callType")):this.remoteCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",Ct.push("callType")):this.remoteCallProfile.videoActive===!0?this.callType!=="videoOnly"&&(this.callType="videoOnly",Ct.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",Ct.push("callType")),nt===!0&&Ct.length>0&&(yt.available=this.remoteCallProfile.audio,yt.active=this.remoteCallProfile.audioActive,yt.muted=this.isRemoteAudioMuted,yt.silent=this.isRemoteAudioSilent,xt.available=this.remoteCallProfile.video,xt.active=this.remoteCallProfile.videoActive,xt.muted=this.isRemoteVideoMuted,xt.silent=this.isRemoteVideoSilent,this.updateCause&&(wt=this.updateCause),this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Ct,yt,xt,this.callType,this.callId,wt))):(this.screenSharing===!0?this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.destCallType!=="screenSharingWithAudio"&&(this.destCallType="screenSharingWithAudio",Ct.push("callType")):this.remoteCallProfile.audioActive===!0?this.destCallType!=="audio"&&(this.destCallType="audio",Ct.push("callType")):this.remoteCallProfile.videoActive===!0?this.destCallType!=="screenSharing"&&(this.destCallType="screenSharing",Ct.push("callType")):this.destCallType!=="inactive"&&(this.destCallType="inactive",Ct.push("callType")):this.settingUpType!=="publish"&&this.settingUpType!=="shareScreen"||(this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.destCallType!=="media"&&(this.destCallType="media",Ct.push("callType")):this.remoteCallProfile.audioActive===!0?this.destCallType!=="audio"&&(this.destCallType="audio",Ct.push("callType")):this.remoteCallProfile.videoActive===!0?this.destCallType!=="videoOnly"&&(this.destCallType="videoOnly",Ct.push("callType")):this.destCallType!=="inactive"&&(this.destCallType="inactive",Ct.push("callType"))),nt===!0&&Ct.length>0&&(yt.available=this.remoteCallProfile.audio,yt.active=this.remoteCallProfile.audioActive,yt.muted=this.isRemoteAudioMuted,yt.silent=this.isRemoteAudioSilent,xt.available=this.remoteCallProfile.video,xt.active=this.remoteCallProfile.videoActive,xt.muted=this.isRemoteVideoMuted,xt.silent=this.isRemoteVideoSilent,this.updateCause&&(wt=this.updateCause),this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Ct,yt,xt,this.destCallType,this.callId,wt))))},this.setMediaConstraintsToSendOnlyOffer=function(){lt.wL.type==="firefox"?ot.PR>43?this.mediaConstraints={offerToReceiveAudio:!1,offerToReceiveVideo:!1}:this.mediaConstraints={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}:lt.wL.type==="edge"?this.mediaConstraints={offerToReceiveAudio:0,offerToReceiveVideo:0}:lt.wL.type==="chrome"&&lt.wL.version<55?this.mediaConstraints={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}:this.mediaConstraints={offerToReceiveAudio:!1,offerToReceiveVideo:!1,mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},this.mediaConstraintsAudioOnly=this.mediaConstraints},this.applyOutgoingBitrate=function(Rt){var nt=this;Ht.debug("applyOutgoingBitrate",this.callId,Rt);for(var Ct=null,yt=0;yt<this.rtpSenders.video.length;yt+=1)if(this.rtpSenders.video[yt].track){Ct=this.rtpSenders.video[yt];break}if(Ct)if(typeof Ct.getParameters=="function"&&typeof Ct.setParameters=="function"){var xt=Ct.getParameters();if(Object.prototype.hasOwnProperty.call(xt,"encodings")){if(xt.encodings.length!==1)return void Ht.debug("encodings cannot be changed",this.callId,xt.encodings.length)}else xt.encodings=[{}];if(Rt!==null&&typeof Rt=="number"){Rt<50&&(Rt=50);var wt=1e3*Rt;if(xt.encodings[0].maxBitrate===wt)return;xt.encodings[0].maxBitrate=wt}else{if(!Object.prototype.hasOwnProperty.call(xt.encodings[0],"maxBitrate"))return;delete xt.encodings[0].maxBitrate}Ct.setParameters(xt).catch(function(Lt){Ht.error("applyOutgoingBitrate - setParameters",nt.callId,Lt)})}else Ht.warn("no such functions: getParameters/setParameters",this.callId);else Ht.warn("no such video rtpSender",this.callId)},this.configureSimulcastEncodings=function(Rt){var nt=this,Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Ht.debug("configureSimulcastEncodings",this.callId,Rt,Ct.maxBitrate),this.simulcast==="RID"){for(var yt=null,xt=0;xt<this.rtpSenders.video.length;xt+=1)if(this.rtpSenders.video[xt].track){yt=this.rtpSenders.video[xt];break}if(yt)if(typeof yt.getParameters=="function"&&typeof yt.setParameters=="function"){var wt=yt.getParameters();if(Object.prototype.hasOwnProperty.call(wt,"encodings"))if(wt.encodings.length===3){for(var Lt=null,Et=null,$t=null,Jt=wt.encodings.length;--Jt>=0;){var en=wt.encodings[Jt];Lt||en.rid!=="h"?Et||en.rid!=="m"?$t||en.rid!=="l"||($t=en):Et=en:Lt=en}if(Lt&&Object.prototype.hasOwnProperty.call(Lt,"maxBitrate")&&Et&&Object.prototype.hasOwnProperty.call(Et,"maxBitrate")&&$t&&Object.prototype.hasOwnProperty.call($t,"maxBitrate")){var qt=!1,on=Math.floor($t.maxBitrate/1e3),hn=!1,nn=!1;if(Lt.active&&Lt.maxBitrate>1&&(on+=Math.floor(Lt.maxBitrate/1e3),hn=!0),Et.active&&Et.maxBitrate>1&&(on+=Math.floor(Et.maxBitrate/1e3),nn=!0),Ht.debug("currentStatus",on,hn,nn),Rt==="changeMaxBitrate"){if(!(0,lt.ki)(Ct,"maxBitrate","number"))return;var dn=Ct.maxBitrate;on<=dn?(nn||on+this.callConfiguration.simulcast.encodings.medium.maxBitrate<=dn&&(lt.wL.type==="chrome"?Et.active=!0:lt.wL.type==="firefox"&&(Et.maxBitrate=1e3*this.callConfiguration.simulcast.encodings.medium.maxBitrate),this.callConfiguration.simulcast.encodings.medium.active=!0,nn=!0,on+=this.callConfiguration.simulcast.encodings.medium.maxBitrate,qt=!0),hn||on+this.callConfiguration.simulcast.encodings.high.maxBitrate<=dn&&(lt.wL.type==="chrome"?Lt.active=!0:lt.wL.type==="firefox"&&(Lt.maxBitrate=1e3*this.callConfiguration.simulcast.encodings.high.maxBitrate),this.callConfiguration.simulcast.encodings.high.active=!0,hn=!0,on+=this.callConfiguration.simulcast.encodings.high.maxBitrate,qt=!0)):(hn&&(hn=!1,this.callConfiguration.simulcast.encodings.high.active=!1,on-=Math.floor(Lt.maxBitrate/1e3),lt.wL.type==="chrome"?Lt.active=!1:lt.wL.type==="firefox"&&(Lt.maxBitrate=1),qt=!0),on>dn&&nn&&(nn=!1,this.callConfiguration.simulcast.encodings.medium.active=!1,on-=Math.floor(Et.maxBitrate/1e3),lt.wL.type==="chrome"?Et.active=!1:lt.wL.type==="firefox"&&(Et.maxBitrate=1),qt=!0))}else Rt==="disableEncoding"&&(hn?(hn=!1,this.callConfiguration.simulcast.encodings.high.active=!1,on-=Math.floor(Lt.maxBitrate/1e3),lt.wL.type==="chrome"?Lt.active=!1:lt.wL.type==="firefox"&&(Lt.maxBitrate=1),qt=!0):nn&&(nn=!1,this.callConfiguration.simulcast.encodings.medium.active=!1,on-=Math.floor(Et.maxBitrate/1e3),lt.wL.type==="chrome"?Et.active=!1:lt.wL.type==="firefox"&&(Et.maxBitrate=1),qt=!0));Ht.debug("applyChanges",on,hn,nn,qt),qt&&(yt.setParameters(wt).catch(function(Sn){Ht.error("configureEncodings - setParameters",nt.callId,Sn)}),this.myWebRTC_Stack.sendInfo("configureEncodings",{pubSub:Kt.MCUClient.pubConnector,clientId:Kt.clientId,roomId:this.sessionMCU.roomName,callId:this.callId,instanceId:this.instanceId,hint:"simulcast",encodings:this.callConfiguration.simulcast.encodings}))}else Ht.warn("cannot find h/m/l encodings",this.callId)}else Ht.warn("wrong encodings",this.callId,wt.encodings.length);else Ht.warn("no encodings configured",this.callId)}else Ht.warn("no such functions: getParameters/setParameters",this.callId);else Ht.warn("no such video rtpSender",this.callId)}}},In=(s(4363),s(9653),function(Kt){this.disconnectionTimer=15e3,Number.MAX_SAFE_INTEGER!==void 0?this.userMediaId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():this.userMediaId=Math.floor(1000001*Math.random()).toString(),this.callType="media",this.audio=!1,this.video=!1,this.audioSdpDirection=null,this.videoSdpDirection=null,this.callConfiguration={},this.sessionMCU=null,this.myWebRTC_Stack=new St.S(Kt.socket),this.getUserMediaStream=function(){return this.callConfiguration&&this.callConfiguration.userMediaStreamId?apiCC.getUserMediaStream(this.callConfiguration.userMediaStreamId):null},this.releaseUserMediaStream=function(){if(this.callConfiguration&&this.callConfiguration.userMediaStreamId){var Rt=this.callConfiguration.userMediaStreamId;return delete this.callConfiguration.userMediaStreamId,apiCC.releaseUserMediaStream(Rt,this.userMediaId)}return!1},this.close=function(){(this.addAck||this.addTimeoutId)&&(delete this.addAck,clearTimeout(this.addTimeoutId),delete this.addTimeoutId)}});function un(Kt){return un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Rt){return typeof Rt}:function(Rt){return Rt&&typeof Symbol=="function"&&Rt.constructor===Symbol&&Rt!==Symbol.prototype?"symbol":typeof Rt},un(Kt)}function mn(Kt,Rt){var nt=typeof Symbol<"u"&&Kt[Symbol.iterator]||Kt["@@iterator"];if(!nt){if(Array.isArray(Kt)||(nt=function(Et,$t){if(Et){if(typeof Et=="string")return yn(Et,$t);var Jt=Object.prototype.toString.call(Et).slice(8,-1);return Jt==="Object"&&Et.constructor&&(Jt=Et.constructor.name),Jt==="Map"||Jt==="Set"?Array.from(Et):Jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Jt)?yn(Et,$t):void 0}}(Kt))||Rt&&Kt&&typeof Kt.length=="number"){nt&&(Kt=nt);var Ct=0,yt=function(){};return{s:yt,n:function(){return Ct>=Kt.length?{done:!0}:{done:!1,value:Kt[Ct++]}},e:function(Et){throw Et},f:yt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xt,wt=!0,Lt=!1;return{s:function(){nt=nt.call(Kt)},n:function(){var Et=nt.next();return wt=Et.done,Et},e:function(Et){Lt=!0,xt=Et},f:function(){try{wt||nt.return==null||nt.return()}finally{if(Lt)throw xt}}}}function yn(Kt,Rt){(Rt==null||Rt>Kt.length)&&(Rt=Kt.length);for(var nt=0,Ct=new Array(Rt);nt<Rt;nt++)Ct[nt]=Kt[nt];return Ct}var pn=et.Y.get("ApiCCMCUClient"),Tn=apiCC.myWebRTC_Event,kn=3e4,xn=function(Kt,Rt){pn.debug("ApiCCMCUClient creation"),this.pubConnector="janusConnector",this.meshModeEnabled=!1,this.sessionMCUs=[],this.distantCalls=[],this.streamList=[],this.disputableStreamList=[],this.publishCallId=null,this.joinSessionReqs=[],this.transitionCount=0,this.browserCapabilities={updateStream:!0,mesh2janusTransition:!0,checkCallStatus:!0},this.receiveSessionId=function(nt){pn.debug("receiveSessionId()"),Tn.createMCUSessionCreationEvent(nt.sessionId,nt.token),this.publish(nt.sessionId,nt.token)},this.sendSessionInvitation=function(nt,Ct,yt){var xt,wt;pn.debug("sendSessionInvitation()"),Ct!=null?(yt===void 0&&(yt=0),xt={type:"MCUSessionInvitation",srcId:Rt,destId:nt,sessionId:Ct,groupChatId:yt},wt=JSON.stringify(xt),pn.log("C->S: "+wt),apiCC.session.channel.socket.emit("MCUSessionInvitation",wt)):pn.log("Session is null or undefined, MCU Session invitation is not sended")},this.sendSessionInvitationToGroupChat=function(nt,Ct){if(pn.debug("sendSessionInvitationToGroupChat()"),nt!=null)if(Ct!=null){var yt,xt;yt={type:"MCUSessionInvitationToGroupChat",srcId:Rt,groupChatId:nt,sessionId:Ct},xt=JSON.stringify(yt),pn.log("C->S: "+xt),apiCC.session.channel.socket.emit("MCUSessionInvitationToGroupChat",xt)}else pn.log("Session is null or undefined, MCU Session invitation is not sended");else pn.log("groupChatId is null or undefined, MCU Session invitation is not sended")},this.receiveSessionInvitation=function(nt){pn.debug("receiveSessionInvitation()"),pn.log("msg.sessionId :"+nt.sessionId),pn.log("msg.token :"+nt.token),pn.log("msg.groupChatId :"+nt.groupChatId),Tn.createReceiveMCUSessionInvitationEvent(nt.sessionId,nt.token,nt.groupChatId,nt.srcId)},this.acceptSessionInvitation=function(nt,Ct){pn.debug("acceptSessionInvitation()"),pn.log("sessionId :"+nt),pn.log("token :"+Ct),this.publish(nt,Ct)},this.leaveSession=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};pn.info("leaveSession()");var yt=null,xt=null,wt=null;if(!(wt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0})))return new Error("leaveSession: session not set");Ct.noHangup!==!0&&(apiCC.session.apiCCWebRTCClient.webRTCClient.removeAllCallsFromRoom(wt.roomName,"leaveSession"),this.meshOnHangup(null,null,{roomId:wt.roomName}));var Lt=[],Et={};Lt.push(wt.roomName),Et.doneByApiRTC=!0,apiCC.session.leavePresenceGroup(Lt,Et),apiCC.session.unsubscribePresenceGroup(Lt,Et),yt={type:"leaveSession",roomId:wt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector}},xt=JSON.stringify(yt),pn.log("C->S: "+xt),apiCC.session.channel.socket.emit("leaveSession",xt),pn.debug("leaveSession: distant call clean up");for(var $t=this.distantCalls.length;--$t>=0;)this.distantCalls[$t].roomId===wt.roomName&&(pn.debug("leaveSession: remove distant call descriptor",this.distantCalls[$t]),this.distantCalls.splice($t,1));apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({multi:!0,roomName:wt.roomName});for(var Jt=this.streamList.length;--Jt>=0;)this.streamList[Jt].roomId===wt.roomName&&this.streamList.splice(Jt,1);return this.removeSessionMCU(wt),"OK"},this.createJoinSessionMessage=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=null;nt||(yt=Ct.hasOwnProperty("sessionMCU")?Ct.sessionMCU:this.getSessionMCU(null,{first:!0}))&&(nt=yt.roomName);var xt=yt&&yt.roomMode==="mesh"||this.meshModeEnabled===!0||Ct.meshModeEnabled===!0,wt=yt&&yt.meshOnly===!0||Ct.meshOnlyEnabled===!0,Lt={type:"joinSession",roomId:nt,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector,meshModeEnabled:xt,meshOnlyEnabled:wt,videoBandwidthSettings:apiCC.session.apiCCWebRTCClient.webRTCClient.videoBandwidthSettings,browserInfo:{browserAbout:ot.Xh+" "+ot.dc,browserType:lt.wL.type,browserVersion:lt.wL.version,osName:ot.BF,osVersion:ot.MM,deviceType:ot.vO}}};if(Ct.hasOwnProperty("transactionId")&&(Lt.transactionId=Ct.transactionId),Ct.hasOwnProperty("convId")?Lt.data.convId=Ct.convId:yt&&yt.hasOwnProperty("convId")&&(Lt.data.convId=yt.convId),Ct.moderationEnabled&&(Lt.data.moderationEnabled=!0),Ct.moderator&&(Lt.data.moderator=!0),Ct.qualityAdaptationEnabled&&(Lt.data.qualityAdaptationEnabled=!0),Array.isArray(Ct.supportedVideoCodecs)){Lt.data.supportedVideoCodecs=[];var Et,$t=mn(Ct.supportedVideoCodecs);try{for($t.s();!(Et=$t.n()).done;){var Jt=Et.value;Jt==="h264"?Lt.data.supportedVideoCodecs.push({codec:"h264",profilelevelid:"42e01f"}):typeof Jt=="string"?Lt.data.supportedVideoCodecs.push({codec:Jt}):Lt.data.supportedVideoCodecs.push(Jt)}}catch(en){$t.e(en)}finally{$t.f()}}else lt.wL.type==="safari"&&(ot.Xh==="Safari"&&ot.dc<12.1||ot.Xh==="Mobile Safari"&&ot.dc<12.1)&&(Lt.data.supportedVideoCodecs=[{codec:"h264",profilelevelid:"42e01f"}]);return Lt.data.capabilities=this.browserCapabilities,Lt},this.createSessionDescriptor=function(nt){var Ct={roomId:nt.roomName};return nt.convId&&(Ct.convId=nt.convId),nt.roomMode&&(Ct.roomMode=nt.roomMode),nt.modeChangeKind&&(Ct.modeChangeKind=nt.modeChangeKind),Ct},this.joinSession=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.getSessionMCU(nt))return pn.warn("joinSession: session already set"),new Error("joinSession: session already set");if(this.getJoinSessionReq(nt))return pn.warn("joinSession: session already requested"),new Error("joinSession: session already requested");var yt={};yt.roomId=nt,yt.transactionId=apiCC.randomString(12),this.joinSessionReqs.push(yt);var xt=Object.assign({},Ct);xt.transactionId=yt.transactionId,pn.info("joinSession() on ApiRTC MCU with roomId:",nt);var wt=this.createJoinSessionMessage(nt,xt),Lt=JSON.stringify(wt);return pn.log("C->S: "+Lt),apiCC.session.channel.socket.emit("joinSession",Lt),"OK"},this.joinSessionAnswer=function(nt){if(pn.debug("joinSessionAnswer()"),this.getSessionMCU(nt.roomName))pn.warn("joinSessionAnswer: session already set");else{var Ct=null;if(nt.hasOwnProperty("transactionId")&&(Ct=this.getJoinSessionReq(null,{transactionId:nt.transactionId})),Ct||(Ct=this.getJoinSessionReq(nt.roomName)),Ct){this.removeJoinSessionReq(Ct);var yt={};if(yt.roomID=nt.sessionId,yt.roomName=nt.roomName,nt.hasOwnProperty("convId")&&(yt.convId=nt.convId),yt.joinSessionAnswer={},(0,lt.ki)(nt,"data","object")?(nt.data.failed===!0?(yt.joinSessionAnswer.failed=!0,yt.joinSessionAnswer.reason=nt.data.reason):yt.joinSessionAnswer.failed=!1,nt.data.mode&&typeof nt.data.mode=="string"&&(yt.roomMode=nt.data.mode,pn.debug("session joined with mode; roomMode: "+yt.roomMode)),yt.roomMode==="mesh"&&nt.data.meshOnly===!0&&(yt.meshOnly=!0,pn.debug("meshOnly"))):yt.joinSessionAnswer.failed=!1,this.sessionMCUs.push(yt),!yt.joinSessionAnswer.failed){var xt=[],wt={};xt.push(nt.roomName),wt.doneByApiRTC=!0,apiCC.session.joinPresenceGroup(xt,wt),apiCC.session.subscribePresenceGroup(xt,wt)}Tn.createJoinMCUSessionAnswerEvent(nt.sessionId,nt.token,nt.groupChatId,nt.initiator,yt)}else pn.debug("joinSessionAnswer: no joinSession requested")}},this.changeSessionMode=function(nt,Ct){var yt=this.getSessionMCU(nt.roomName);if(yt)if(yt.roomMode==="mesh"){for(var xt=0,wt=Kt.userMediaTable.length;--wt>=0;)if(Kt.userMediaTable[wt].sessionMCU===yt){pn.debug("changeSessionMode: userMedia",Kt.userMediaTable[wt]),Kt.userMediaTable[wt].distantCalls=[],xt+=1;for(var Lt=this.distantCalls.length;--Lt>=0;)pn.debug("changeSessionMode: distantCall",this.distantCalls[Lt]),this.distantCalls[Lt].callMode==="mesh"&&this.distantCalls[Lt].callFeed.callId===Kt.userMediaTable[wt].userMediaId&&(pn.debug("changeSessionMode: match"),Kt.userMediaTable[wt].distantCalls.push(this.distantCalls[Lt]))}for(var Et=0,$t=Kt.callControlTable.length;--$t>=0;)Kt.callControlTable[$t].type==="subscribe"&&Kt.callControlTable[$t].roomName===yt.roomName&&(Et+=1,Kt.callControlTable[$t].autoRestart.force=!0);if(Tn.createMCURoomModeChangedEvent(yt.roomName,"mesh","sfu","ongoing"),xt===0&&Et===0)delete yt.roomMode,Tn.createMCURoomModeChangedEvent(yt.roomName,"mesh","sfu","complete");else{yt.modeChangeKind="old";var Jt={};Jt.roomID=nt.roomName,Jt.roomName=nt.roomName,nt.hasOwnProperty("convId")&&(Jt.convId=nt.convId),Jt.joinSessionAnswer={failed:!1},Jt.modeChangeKind="new",Jt.transitionTimeoutId=setTimeout((function(en,qt){delete qt.transitionTimeoutId,Kt.finalizeMeshToJanusTransition(en,qt,{force:!0})}).bind(this,yt,Jt),3e4),this.sessionMCUs.push(Jt),this.transitionCount+=1}}else pn.warn("changeSessionMode: session not using mesh mode");else pn.warn("changeSessionMode: no session")},this.updateSessionAnswer=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};pn.debug("updateSessionAnswer");var yt=this.getSessionMCU(nt.roomName);if(!yt){if(!Ct.createSession)return void pn.warn("updateSessionAnswer: no such session",nt.roomName);pn.debug("force session creation; roomName: "+nt.roomName),(yt={}).roomID=nt.roomName,yt.roomName=nt.roomName,nt.hasOwnProperty("convId")&&(yt.convId=nt.convId),yt.joinSessionAnswer={failed:!1},this.sessionMCUs.push(yt);for(var xt=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length;--xt>=0;){var wt=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[xt];!wt.data||wt.data.MCUType!=="MCU-Caller"&&wt.data.MCUType!=="MCU-Callee"||wt.data.confId!==yt.roomName||(wt.sessionMCU=yt)}}var Lt=!1;if(nt.data&&nt.data.mode==="mesh"?(yt.roomMode="mesh",nt.data.meshOnly===!0&&(yt.meshOnly=!0)):(yt.roomMode==="mesh"&&(Lt=!0),delete yt.roomMode),yt.modeChangeKind==="new"){pn.debug("transition already ongoing");var Et=this.getSessionMCU(null,{callback:function(dn){return dn.roomName===yt.roomName&&dn.modeChangeKind==="old"}});Et&&Kt.finalizeMeshToJanusTransition(Et,yt,{force:!0})}else if(Lt){pn.debug("transition NOT ongoing but should be"),Tn.createMCURoomModeChangedEvent(yt.roomName,"mesh","sfu","ongoing"),yt.modeChangeKind="old";var $t={};$t.roomID=yt.roomID,$t.roomName=yt.roomName,yt.hasOwnProperty("convId")&&($t.convId=yt.convId),$t.joinSessionAnswer={failed:!1},$t.modeChangeKind="new",this.sessionMCUs.push($t),this.transitionCount+=1,Kt.finalizeMeshToJanusTransition(yt,$t,{force:!0})}if(Ct.updateCalls)if(pn.debug("update stream list (prune)"),this.updateStreamList(nt,{prune:!0}),yt.roomMode==="mesh"){pn.debug("restart publish/shareScreen calls");for(var Jt=Kt.userMediaTable.slice(),en=Jt.length;--en>=0;){var qt=Jt[en];qt.sessionMCU===yt&&Kt.onHangup(qt.userMediaId,"disconnected")}}else{pn.debug("roomMode is SFU, checking calls");for(var on=Kt.callsTable.slice(),hn=on.length;--hn>=0;){var nn=on[hn];nn.sessionMCU===yt&&(nn.settingUpType!=="publish"&&nn.settingUpType!=="shareScreen"||nn.data&&nn.data.mesh||nn.pc?nn.message200OKReceived===!1&&(pn.debug("restart call without 200OK received"),Kt.onHangup(nn.callId,"disconnected")):(pn.debug("restart publish/shareScreen calls with no PeerConnection"),Kt.onHangup(nn.callId,"disconnected")))}}},this.processCheckCallStatus=function(nt){this.updateStreamList(nt)},this.updateStreamList=function(nt){for(var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=(0,lt.ki)(nt,"availableStreams","array")?nt.availableStreams.slice():null,xt=(0,lt.ki)(nt,"availableComposite","array")?nt.availableComposite.slice():null,wt=(0,lt.ki)(nt,"availableReplay","array")?nt.availableReplay.slice():null,Lt=this.streamList.length;--Lt>=0;){var Et=this.streamList[Lt];if(Et.type==="regular"){if(!yt)continue;for(var $t=yt.length;--$t>=0&&yt[$t].id!==Et.streamInfo.id;);if($t>=0){(0,lt.ki)(Et,"clearDisputableEntry","function")&&Et.clearDisputableEntry(),yt.splice($t,1);continue}Ct.prune===!0?((0,lt.ki)(Et,"clearDisputableEntry","function")&&Et.clearDisputableEntry(),apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({type:"subscribe",stream:Et.streamInfo}),Tn.createMCURemovedStreamEvent(Et.streamInfo.id),this.streamList.splice(Lt,1)):Et.disputableTimeoutId||(Et.disputableTimeoutId=setTimeout(Mn.bind(this,Et.streamInfo.id),kn),Et.clearDisputableEntry=Dn.bind(this,Et.streamInfo.id),this.disputableStreamList.push(Et))}else if(Et.type==="composite"){if(!xt)continue;for(var Jt=xt.length;--Jt>=0&&xt[Jt].id!==Et.streamInfo.id;);if(Jt>=0){xt.splice(Jt,1);continue}apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({type:"subscribe",stream:Et.streamInfo}),Tn.createMCURemovedStreamEvent(Et.streamInfo.id),this.streamList.splice(Lt,1)}else if(Et.type==="replay"){if(!wt)continue;for(var en=wt.length;--en>=0&&wt[en].id!==Et.streamInfo.id;);en>=0&&wt.splice(en,1)}}if(yt)for(var qt=0;qt<yt.length;qt+=1){var on=[];on.push(yt[qt]);var hn=this.newAvailableStream(on,"regular");Tn.createMCUAvailableStreamEvent(on,hn)}if(xt)for(var nn=0;nn<xt.length;nn+=1){var dn=[];dn.push(xt[nn]);var Sn=this.newAvailableStream(dn,"composite");Tn.createMCUAvailableCompositeEvent(dn,Sn)}if(wt)for(var wn=0;wn<wt.length;wn+=1){var En=[];En.push(wt[wn]);var Pn=this.newAvailableReplay(En);Tn.createMCUAvailableReplayEvent(En,Pn)}},this.getStreamList=function(){return pn.debug("getStreamList :",this.streamList),this.streamList},this.getStreamFromList=function(nt){var Ct;for(pn.debug("getStreamFromList() with Id :",nt),pn.log("this.streamList :",this.streamList),Ct=0;Ct<this.streamList.length;Ct+=1){if(this.streamList[Ct].streamInfo.id===nt)return pn.log("stream found",this.streamList[Ct].streamInfo),this.streamList[Ct].streamInfo;pn.log("not the same stream",nt)}return null},this.getStreamIdOfUser=function(nt){var Ct;for(pn.debug("getStreamIdOfUser() with Id :",nt),pn.log("this.streamList :",this.streamList),Ct=0;Ct<this.streamList.length;Ct+=1)if(this.streamList[Ct].type!=="replay"){if(this.streamList[Ct].userId===nt)return pn.log("stream found",this.streamList[Ct].streamInfo),this.streamList[Ct].streamInfo.id;pn.log("not the same userId",nt)}return null},this.getStreamOfUserCall=function(nt,Ct){var yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},xt=this.streamList.length,wt=!1;for((0,lt.ki)(yt,"replay","boolean")&&yt.replay===!0&&(wt=!0);--xt>=0;){if(wt===!0){if(this.streamList[xt].type!=="replay")continue}else if(this.streamList[xt].type==="replay")continue;if(this.streamList[xt].userId===nt&&this.streamList[xt].streamInfo.attributes.callId===Ct)return this.streamList[xt].streamInfo}return null},this.newAvailableStream=function(nt,Ct,yt){pn.debug("newAvailableStream():",nt);var xt=!1,wt=!1,Lt=this.getSessionMCU(nt[0].room);if(Lt){nt[0].attributes.callerId!==Rt&&(xt=!0);for(var Et=Kt.getCallControls(["publish","shareScreen"],{addUserMedia:!0}),$t=0;$t<nt.length;$t+=1){for(var Jt=this.streamList.length;--Jt>=0&&(this.streamList[Jt].type!=="regular"||nt[$t].id!==this.streamList[Jt].streamInfo.id););Jt>=0?(wt=!0,(0,lt.ki)(this.streamList[Jt],"clearDisputableEntry","function")?this.streamList[Jt].clearDisputableEntry():pn.debug("clearDisputableEntry is not set")):pn.debug("streamList is empty"),xt=!Object.prototype.hasOwnProperty.call(Et,nt[$t].attributes.callId);var en={type:Ct,userId:nt[$t].attributes.callerId,roomId:Lt.roomName,isRemoteStream:xt,streamInfo:nt[$t]};if(wt===!0?this.streamList[Jt]=en:this.streamList.push(en),pn.log("this.streamList :",this.streamList),xt!==!0)if(Lt.roomMode==="mesh"){var qt=Kt.findUserMediaById(nt[$t].attributes.callId);qt&&qt.addAck===!0&&(delete qt.addAck,clearTimeout(qt.addTimeoutId),delete qt.addTimeoutId,Tn.createCallEstablishedEvent(Lt.roomName,qt.callType,qt.userMediaId,"none"))}else{var on=Kt.findCallWithCallId(nt[$t].attributes.callId),hn=apiCC.getUserMediaStream(on.callConfiguration.userMediaStreamId);if(on&&hn)for(var nn=0,dn=["audioMuted","videoMuted"];nn<dn.length;nn++){var Sn=dn[nn],wn=Sn==="audioMuted"?"audio":"video";hn[Sn]!==nt[$t][Sn]&&hn.notifyMLineMutedCall(wn,hn[Sn],"enabled",on,null)}}var En=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallControl({type:"subscribe",stream:nt[$t]});if(En&&!En.autoRestart.pending){pn.info("[newAvailableStream] auto subscribing to stream");var Pn=!!En.autoRestart.force;delete En.autoRestart.force;var Wn=En.callId,ir=Kt.findCallWithCallId(Wn);ir!==null&&ir.sessionMCU!==null&&ir.sessionMCU.modeChangeKind==="old"&&(pn.debug("Re-init of autoRestart.counter"),delete En.autoRestart.counter);var fr=this.subscribeToStreams([nt[$t]],En.mediaType,En.data,En.callConfiguration,{noStreamCheck:!0,force:Pn});Wn&&fr[0]&&Tn.createCallRestartingEvent(En.callType,En.audioOnly,Wn,fr[0],"subscribe",apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,En.roomName,En.roomName,nt[$t].id)}if(wt!==!0&&(0,lt.Ym)(yt,"function")&&yt(xt,nt[$t],Ct),nt[$t].context!==void 0&&nt[$t].context.remoteAccessCtx!==void 0){var gr=nt[$t].context.remoteAccessCtx.invitationId;pn.debug("remoteAccess stream for invitationId : ",gr),apiRTC.session.remoteAccessInvitation!==null&&gr===apiRTC.session.remoteAccessInvitation.id&&xt===!0?(pn.debug("Setting screenSharingStreamId for remote"),apiRTC.session.remoteAccessInvitation.screenSharingStreamId=nt[$t].id,pn.debug("apiRTC.session.remoteAccessInvitation.screenSharingStreamId :",apiRTC.session.remoteAccessInvitation.screenSharingStreamId),apiRTC.session.remoteAccessInvitation.screenWidth=nt[$t].context.remoteAccessCtx.screenWidth,apiRTC.session.remoteAccessInvitation.screenHeight=nt[$t].context.remoteAccessCtx.screenHeight):pn.debug("Stream not linked to remoteAccessInvitation or this is localStream")}}return xt}pn.debug("newAvailableStream() but client is not in session")},this.updateAvailableStream=function(nt,Ct,yt){pn.info("updateAvailableStream():",nt);var xt=!1;if(this.getSessionMCU(nt[0].room)){nt[0].attributes.callerId!==Rt&&(xt=!0);for(var wt=0;wt<nt.length;wt+=1)for(var Lt=this.streamList.length;--Lt>=0;)if(this.streamList[Lt].streamInfo.id===nt[wt].id){for(var Et=[],$t=0,Jt=["audio","audioMuted","video","videoMuted"];$t<Jt.length;$t++){var en=Jt[$t];this.streamList[Lt].streamInfo[en]!==nt[wt][en]&&(this.streamList[Lt].streamInfo[en]=nt[wt][en],Et.push(en))}this.streamList[Lt].streamInfo.attributes.callType!==nt[wt].attributes.callType&&(this.streamList[Lt].streamInfo.attributes.callType=nt[wt].attributes.callType,Et.push("callType")),this.streamList[Lt].streamInfo.attributes.descriptor&&nt[wt].attributes.descriptor&&this.streamList[Lt].streamInfo.attributes.descriptor.priority!==nt[wt].attributes.descriptor.priority&&(this.streamList[Lt].streamInfo.attributes.descriptor.priority=nt[wt].attributes.descriptor.priority,Et.push("priority")),Et.length>0&&(0,lt.Ym)(yt,"function")&&yt(xt,nt[wt],Ct,Et);break}return xt}pn.log("updateAvailableStream() but client is not in session")},this.newAvailableReplay=function(nt){pn.info("newAvailableReplay() :",nt);var Ct=!1,yt=this.getSessionMCU(nt[0].room);if(yt){nt[0].attributes.callerId!==Rt&&(Ct=!0);for(var xt=0;xt<nt.length;xt+=1){var wt={type:"replay",userId:nt[xt].attributes.callerId,roomId:yt.roomName,isRemoteStream:Ct,streamInfo:nt[xt]};this.streamList.push(wt)}return Ct}pn.log("newAvailableReplay() but client is not in session")},this.subscribeToStreams=function(nt,Ct,yt,xt){var wt=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};pn.info("subscribeToStreams():",nt);var Lt,Et,$t=[],Jt=null,en=null,qt=null,on=function(nn){return setTimeout(function(){pn.warn("invite + SDP offer not received -> restart call"),Kt.onHangup(nn,"disconnected")},15e3)};for(qt in nt){if(Lt=nt[qt],apiCC.session===null||apiCC.session===void 0)return pn.debug("no session, leaving subscribeToStreams()"),$t;if((Jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithStreamId(Lt.id,{ignoreModeChangeKindOld:!0}))!==null){if(pn.debug("call already exists"),wt.force!==!0){$t[qt]=Jt.callId;continue}pn.debug("Force is true")}else pn.debug("call does not exist");for(Et=this.streamList.length;--Et>=0&&this.streamList[Et].streamInfo.id!==Lt.id;);if(Et>=0){if(pn.debug("stream exists"),this.streamList[Et].disputableTimeoutId){pn.debug("stream temporarily not available"),$t[qt]=null,wt.autoSub===!0&&((en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallControl({type:"subscribe",stream:Lt}))||apiCC.session.apiCCWebRTCClient.webRTCClient.createCallControl({type:"subscribe",roomName:Lt.room,mediaType:Ct,callConfiguration:xt,data:yt,stream:Lt}));continue}}else if(pn.debug("stream does not exist"),wt.noStreamCheck!==!0){$t[qt]=null,Tn.createErrorEvent("stream not available","STREAM_NOT_AVAILABLE",null,Lt.room,null,{stream:Lt});continue}pn.info("stream:",Lt);var hn=this.getSessionMCU(Lt.room);hn&&((en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallControl({type:"subscribe",stream:Lt}))||(en=apiCC.session.apiCCWebRTCClient.webRTCClient.createCallControl({type:"subscribe",roomName:hn.roomName,mediaType:Ct,callConfiguration:xt,data:yt,stream:Lt})),Lt.attributes.callType!=="COMPOSITE"&&this.pubConnector==="janusConnector"?(yt===void 0&&(yt={}),yt.mesh&&delete yt.mesh,(0,lt.Ym)(xt,"qos","object")?(yt.qos={},xt.qos.videoForbidInactive===!1?yt.qos.videoForbidInactive=!1:yt.qos.videoForbidInactive=!0):(yt.qos={},yt.qos.videoForbidInactive=!0),(0,lt.Ym)(xt,"simulcast","object")&&(yt.simulcast={},xt.simulcast.streamQuality&&(xt.simulcast.streamQuality==="high"?yt.simulcast.substream=2:xt.simulcast.streamQuality==="medium"?yt.simulcast.substream=1:xt.simulcast.streamQuality==="low"&&(yt.simulcast.substream=0)),xt.simulcast.streamFrameRate&&(xt.simulcast.streamFrameRate==="high"?yt.simulcast.temporal=2:xt.simulcast.streamFrameRate==="medium"?yt.simulcast.temporal=1:xt.simulcast.streamFrameRate==="low"&&(yt.simulcast.temporal=0))),(Jt=new bn(apiCC.session.apiCCWebRTCClient.webRTCClient)).instanceId=apiCC.generateInstanceId(),Jt.callControl=en,(0,lt.ki)(Jt.callControl.autoRestart,"counter","number")?(Jt.callControl.autoRestart.counter+=1,Jt.restarted=!0):Jt.callControl.autoRestart.counter=0,Jt.settingUpType="subscribe",xt!=null&&xt.turnServerAddress!==void 0&&xt.turnServerAddress!==null&&Jt.setCallTurnServer(xt.turnServerAddress),Jt.generateCallId(),en.callId=Jt.callId,Jt.setupTimeoutId=on(Jt.callId),Jt.callerId=hn.roomName,Jt.calleeId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Jt.callee=!0,Jt.mcuRemoteStream=Lt,Jt.dest_roomId=hn.roomName,Jt.callType=Lt.attributes.callType,Jt.callControl.callType=Lt.attributes.callType,Lt.attributes.callType!=="audio"&&Ct!=="AUDIOONLY"||(Jt.audioOnly=!0,Jt.callControl.audioOnly=!0),Jt.remoteId=Lt.attributes.callerId,Jt.remoteMailAddress=Lt.attributes.mailAddress,Jt.streamId=Lt.id,Jt.mediaType=Ct,Jt.sessionMCU=hn,pn.log("call.streamId: "+Jt.streamId),(0,lt.Ym)(yt,"object")?Jt.data=(0,lt.ws)({},yt):Jt.data={},Jt.data.pubSub="janusConnector",Jt.data.type="subscribe",Jt.data.mode="passive",Jt.data.mediaType=Ct,Jt.data.capabilities=this.browserCapabilities,Jt.data.cloudConvId=hn.convId,Jt.data.instanceId=Jt.instanceId,apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Jt),$t[qt]=Jt.callId,Jt.myWebRTC_Stack.sendInvite(Jt.callId,apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,hn.roomName,hn.roomName,Lt.attributes.callType,{mode:"passive",data:Jt.data,stream:Lt,volatile:!!Jt.restarted})):((Jt=new bn(apiCC.session.apiCCWebRTCClient.webRTCClient)).instanceId=apiCC.generateInstanceId(),Jt.callControl=en,(0,lt.ki)(Jt.callControl.autoRestart,"counter","number")?(Jt.callControl.autoRestart.counter+=1,Jt.restarted=!0):Jt.callControl.autoRestart.counter=0,Jt.settingUpType="subscribe",xt!=null&&xt.turnServerAddress!==void 0&&xt.turnServerAddress!==null&&Jt.setCallTurnServer(xt.turnServerAddress),yt===void 0&&(yt={}),Jt.data=yt,Jt.data.pubSub=this.pubConnector,Jt.data.type="subscribe",Jt.data.capabilities=this.browserCapabilities,Jt.data.cloudConvId=hn.convId,Jt.data.instanceId=Jt.instanceId,pn.log("mediaType: ",Ct),pn.log("stream.attributes.callType: ",Lt.attributes.callType),Jt.callType=Lt.attributes.callType,Jt.callControl.callType=Lt.attributes.callType,Lt.attributes.callType==="COMPOSITE"&&this.pubConnector==="janusConnector"||Lt.attributes.callType==="audio"||Ct==="AUDIOONLY"?(pn.log("Setting call as audioOnly"),Jt.audioOnly=!0,Jt.callControl.audioOnly=!0,Jt.stripVideoSDPActivated=!0):Ct==="VIDEOONLY"&&(Jt.stripAudioSDPActivated=!0,Jt.callType="videoOnly",Jt.callControl.callType="videoOnly"),Jt.mcuRemoteStream=Lt,Jt.dest_roomId=hn.roomName,Jt.calleeId=hn.roomName,Jt.generateCallId(),en.callId=Jt.callId,Jt.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Jt.sessionMCU=hn,apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Jt),Jt.createPeerConnection(),Jt.doCall(),Jt.started=!0,Jt.callType=Lt.attributes.callType,Jt.remoteId=Lt.attributes.callerId,Jt.remoteMailAddress=Lt.attributes.mailAddress,Lt.audio===!0?Lt.video===!0?Jt.destCallType="media":Jt.destCallType="audio":Lt.video===!0&&(Jt.destCallType="videoOnly"),Lt.id===void 0&&pn.log("stream.id is undefined :",Lt),Jt.streamId=Lt.id,Jt.mediaType=Ct,pn.log("stream.attributes.callType: ",Lt.attributes.callType),$t[qt]=Jt.callId),Jt.asyncCallbacks={},Jt.asyncCallbacks.type="subscribe")}return $t},this.unsubscribe=function(nt){pn.info("unsubscribe() :",nt);var Ct=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithStreamId(nt);Ct===null?pn.log("error call not found on unsubscribe"):Ct.callId!==void 0&&apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Ct.callId)},this.publish=function(nt,Ct,yt,xt,wt,Lt){pn.info("publish roomName :",nt),pn.log("publish sessionId :",Ct),pn.log("publish token :",yt),pn.log("publish callConfiguration :",xt);var Et=null,$t=!1,Jt=!1,en=null,qt=null,on=this.getSessionMCU(nt);if(!on)return pn.error("roomName does not match any sessionMCU"),null;if(wt!==null&&un(wt)==="object"||(wt={}),this.pubConnector==="janusConnector"&&!wt.mesh&&Lt&&Lt.callControl&&Lt.callControl.callId&&apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Lt.callControl.callId))return pn.debug("call already exists",Lt.callControl.callId),Lt.callControl.callId;if(xt===!0||xt==="true"?(pn.log("DEPRECATED ... please use callConfiguration JSON parameter : callConfiguration.audioOnly instead of audioOnly"),$t=!0,xt={}):xt===!1||xt==="false"?(pn.log("DEPRECATED ... please use callConfiguration JSON parameter : callConfiguration.audioOnly instead of audioOnly"),xt={}):xt!==null&&un(xt)==="object"||(xt={}),xt.audioOnly===!0&&xt.videoOnly===!0)return Tn.createErrorEvent("Cannot publish without audio nor video","PUBLISH_FAILURE",null,nt),null;if(xt.audioOnly===!0&&($t=!0),xt.videoOnly===!0&&(Jt=!0),["audioOnly","videoOnly","record","private"].forEach(function(nn){xt.hasOwnProperty(nn)&&((0,lt.ki)(wt,"callConfiguration","object")||(wt.callConfiguration={}),wt.callConfiguration[nn]=xt[nn])}),on.convId&&(wt.cloudConvId=on.convId),(0,lt.Ym)(xt,"qos","object")?(wt.qos={},xt.qos.videoMinBitrate?wt.qos.videoMinBitrate=xt.qos.videoMinBitrate:xt.qos.videoMinQuality&&["excellent","good","medium","bad"].indexOf(xt.qos.videoMinQuality)>=0?wt.qos.videoMinQuality=xt.qos.videoMinQuality:wt.qos.videoMinQuality="bad",xt.qos.videoStartBitrate?wt.qos.videoStartBitrate=xt.qos.videoStartBitrate:xt.qos.videoStartQuality&&["upper","excellent","good","medium","bad"].indexOf(xt.qos.videoStartQuality)>=0&&(wt.qos.videoStartQuality=xt.qos.videoStartQuality),xt.qos.videoForbidInactive===!1?wt.qos.videoForbidInactive=!1:wt.qos.videoForbidInactive=!0):wt.qos={videoMinQuality:"bad",videoForbidInactive:!0},xt.simulcast&&(xt.userMediaStreamId&&(qt=apiCC.getUserMediaStream(xt.userMediaStreamId))&&qt.isSimulcastCompliant()||delete xt.simulcast),function(nn){if(!(0,lt.ki)(nn,"simulcast","object")||lt.wL.type==="safari"&&nn.simulcast.mode!=="SDP")return delete nn.simulcast,!1;delete nn.simulcast.sendEncodings,(0,lt.ki)(nn.simulcast,"maxBitrate","number")?lt.wL.type==="chrome"&&lt.wL.version>=78&&nn.simulcast.mode!=="SDP"?(pn.debug("configure simulcast RID chrome maxBitrate"),!Un(nn.simulcast,nn.simulcast.maxBitrate)&&(pn.warn("cannot configure simulcast"),delete nn.simulcast)):lt.wL.type==="firefox"?(pn.debug("configure simulcast RID firefox maxBitrate"),!Un(nn.simulcast,nn.simulcast.maxBitrate)&&(pn.warn("cannot configure simulcast"),delete nn.simulcast)):delete nn.simulcast.encodings:(0,lt.ki)(nn.simulcast,"encodings","object")?lt.wL.type==="chrome"&&lt.wL.version>=78&&nn.simulcast.mode!=="SDP"?(pn.debug("configure simulcast RID chrome encodings"),!Nn(nn.simulcast)&&(pn.warn("cannot configure simulcast"),delete nn.simulcast)):lt.wL.type==="firefox"?(pn.debug("configure simulcast RID firefox encodings"),!Nn(nn.simulcast)&&(pn.warn("cannot configure simulcast"),delete nn.simulcast)):delete nn.simulcast.encodings:lt.wL.type==="chrome"&&lt.wL.version>=78&&nn.simulcast.mode!=="SDP"?(pn.debug("configure simulcast RID chrome default"),nn.simulcast.encodings={high:{maxBitrate:900},medium:{maxBitrate:300,scaleResolutionDownBy:2},low:{maxBitrate:100,scaleResolutionDownBy:4}},!Nn(nn.simulcast)&&delete nn.simulcast):lt.wL.type==="firefox"&&(pn.debug("configure simulcast RID firefox default"),nn.simulcast.encodings={high:{maxBitrate:900},medium:{maxBitrate:300,scaleResolutionDownBy:2},low:{maxBitrate:100,scaleResolutionDownBy:4}},!Nn(nn.simulcast))&&delete nn.simulcast}(xt),xt.distributedBroadcastEnabled&&!xt.simulcast&&(wt.distributedBroadcastEnabled=!0),["audioLabels","videoLabels"].forEach(function(nn){(0,lt.Ym)(xt[nn],"array")&&(wt[nn]=[],xt[nn].forEach(function(dn){(0,lt.Ym)(dn,"string")&&wt[nn].push(dn)}))}),(0,lt.Ym)(xt,"context","object"))try{JSON.stringify(xt.context),wt.context=xt.context}catch{}if((0,lt.Ym)(xt,"profileType","string")&&(wt.profileType=xt.profileType),(0,lt.Ym)(xt,"priority","number")&&xt.priority>=0&&(wt.priority=xt.priority),(0,lt.Ym)(xt,"downgradeProfileList","array")&&(wt.downgradeProfileList=xt.downgradeProfileList),pn.debug("callConfiguration; audioOnly: "+$t+", videoOnly: "+Jt),Lt&&Lt.forceScreenSharingCallType===!0)pn.debug("publish screenSharing");else if(apiCC.mediaDeviceMgr.videoDevicePresent===!1){if(apiCC.mediaDeviceMgr.audioDevicePresent===!1)return pn.debug("publish without any device, leaving publish ..."),wt.publishWithoutMediaDeviceDetected=!0,apiCC.session.setUserData(wt),Tn.createErrorEvent("Cannot publish without audio nor video","PUBLISH_FAILURE",null,nt),null;$t!==!0&&(pn.debug("publish video, but no webcam present, forcing callType to audio"),$t=!0)}else apiCC.mediaDeviceMgr.audioDevicePresent===!1&&Jt!==!0&&(pn.debug("publish video, but no microphone present, forcing callType to videoOnly"),Jt=!0);if(Et=new bn(apiCC.session.apiCCWebRTCClient.webRTCClient),wt.mesh!==void 0&&wt.instanceId!==void 0?(pn.debug("keeping instanceId "),Et.instanceId=wt.instanceId):Et.instanceId=apiCC.generateInstanceId(),this.pubConnector!=="janusConnector"||wt.mesh?(Et.settingUpType="publish",Et.generateCallId()):(Et.settingUpType="publish",Lt&&Lt.callControl?(Et.callControl=Lt.callControl,Et.callControl.autoRestart.counter+=1,Et.callId=Et.callControl.callId,Et.restarted=!0):(Et.callControl=apiCC.session.apiCCWebRTCClient.webRTCClient.createCallControl({type:"publish",roomName:nt,callConfiguration:xt,data:wt}),Et.callControl.sessionId=Ct,Et.callControl.token=yt,Et.callControl.autoRestart.counter=0,Et.generateCallId(),Et.callControl.callId=Et.callId)),xt!=null&&xt.turnServerAddress!==void 0&&xt.turnServerAddress!==null&&Et.setCallTurnServer(xt.turnServerAddress),xt.userMediaStreamId&&((qt=apiCC.getUserMediaStream(xt.userMediaStreamId))?(Et.callType=qt.callType,pn.debug("Setting callType to "+Et.callType),Et.callType==="screenSharing"&&(Et.screenSharing=!0)):(pn.debug("callConfiguration.userMediaStreamId is setted but stream is not present"),delete xt.userMediaStreamId)),Et.data=wt,Et.data.instanceId=Et.instanceId,Ct==="restarted"&&(Et.restarted=!0),Et.mediaTypeForIncomingCall="NONE",$t===!0?(pn.log("Setting call as audioOnly"),Et.audioOnly=!0,Et.callType="audio",Et.mediaTypeForOutgoingCall="AUDIO"):Jt===!0?(pn.log("Setting call as videoOnly"),Et.callType="videoOnly",Et.mediaTypeForOutgoingCall="VIDEOONLY"):pn.log("Not Setting call as audioOnly nor videoOnly"),Et.dest_roomId=on.roomName,Et.calleeId=on.roomName,Et.data.pubSub=this.pubConnector,Et.data.type="publish",Et.data.capabilities=this.browserCapabilities,Et.data.cloudConvId=on.convId,Et.callConfiguration=xt,Et.sessionMCU=on,Et.setMediaConstraintsToSendOnlyOffer(),Et.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,(0,lt.Ym)(xt,"simulcast","object")){var hn=null;qt&&(hn=qt.getSimulcastProfile()),lt.wL.type==="chrome"&&lt.wL.version>=78&&xt.simulcast.mode!=="SDP"?(pn.debug("simulcast chrome 78+ -> RID",xt.simulcast),Et.simulcast="RID",Et.data.simulcast={enabled:!0,mode:"RID"},Et.data.simulcast.encodings=Object.assign({},xt.simulcast.encodings),hn&&(Et.data.simulcast.profile=hn)):lt.wL.type==="chrome"?(pn.debug("simulcast chrome -> SDP",xt.simulcast),Et.simulcast="SDP",Et.data.simulcast={enabled:!0,mode:"SDP"}):lt.wL.type==="firefox"?(pn.debug("simulcast firefox -> RID",xt.simulcast),Et.simulcast="RID",Et.data.simulcast={enabled:!0,mode:"RID"},Et.data.simulcast.encodings=Object.assign({},xt.simulcast.encodings),hn&&(Et.data.simulcast.profile=hn)):lt.wL.type==="safari"&&(pn.debug("simulcast safari -> SDP",xt.simulcast),Et.simulcast="SDP",Et.data.simulcast={enabled:!0,mode:"SDP"})}return pn.log("webRTCClient.accessToLocalMedia :",Kt.accessToLocalMedia),apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Et),this.publishCallId=Et.callId,Et.callControl&&Et.callControl.autoRestart.stream&&pn.debug("call.callControl.autoRestart.stream.active :",Et.callControl.autoRestart.stream.active),this.pubConnector==="janusConnector"&&Et.callControl&&Et.callControl.autoRestart.stream&&Et.callControl.autoRestart.stream.active?(apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Et.callLocalStream=Et.callControl.autoRestart.stream,Et.establishCall(),Et.callId):(wt.mesh!==void 0&&(en=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(wt.mesh.calleeCallId))!==null&&en.callConfiguration&&en.callConfiguration.userMediaStreamId&&(Et.callType=en.callType,xt.userMediaStreamId=en.callConfiguration.userMediaStreamId),xt.userMediaStreamId?((qt=apiCC.getUserMediaStream(xt.userMediaStreamId)).addCallInfo(Et.callId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,this.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=qt.stream),Et.callConfiguration.userMediaStreamId=qt.userMediaStreamId,Et.callLocalStream=qt.stream,Et.establishCall(),Et.callId):apiCC.userMediaStreamTable.length>0?((qt=apiCC.userMediaStreamTable[0]).addCallInfo(Et.callId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,this.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=qt.stream),Et.callConfiguration.userMediaStreamId=qt.userMediaStreamId,Et.callLocalStream=qt.stream,Et.establishCall(),Et.callId):(apiCC.createUserMediaStream({callId:Et.callId,type:Et.callType,audioSourceId:Kt.audioSourceId,videoSourceId:Kt.videoSourceId,success:function(nn){pn.debug("[publish] success; userMediaStreamId: "+nn.userMediaStreamId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=nn.stream),Et.callConfiguration.userMediaStreamId=nn.userMediaStreamId,Et.callLocalStream=nn.stream,Et.establishCall()}}),Et.callId))},this.publishScreen=function(nt,Ct,yt,xt){pn.info("publishScreen()");var wt=this.getSessionMCU(nt);return wt?(Ct==null&&(Ct={}),yt==null&&(yt={}),yt.record!==void 0&&(Ct.callConfiguration!==void 0||(Ct.callConfiguration={}),Ct.callConfiguration.record=yt.record),yt.private!==void 0&&(Ct.callConfiguration!==void 0||(Ct.callConfiguration={}),Ct.callConfiguration.private=yt.private),Ct.pubSub=this.pubConnector,Ct.type="publish",apiCC.session.apiCCWebRTCClient.webRTCClient.shareScreen(wt.roomName,Ct,xt,yt)):(pn.error("roomId does not match any sessionMCU"),null)},this.unpublish=function(nt){pn.info("unpublish call with callId :",nt),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(nt),this.publishCallId=null},this.removeMCUStream=function(nt,Ct,yt){var xt,wt=!1;for(yt!=="Broken_by_MCU"&&yt!=="disconnected"||(wt=!0),pn.debug("streamId:",Ct),pn.debug("reason:",yt),pn.debug("quiet:",wt),xt=0;xt<this.streamList.length;xt+=1)if(pn.log("this.streamList[i].streamInfo.id :",this.streamList[xt].streamInfo.id),this.streamList[xt].streamInfo.id===Ct){wt===!0?(pn.debug("add stream into disputableStreamList: ",Ct),this.streamList[xt].disputableTimeoutId=setTimeout(Mn.bind(this,this.streamList[xt].streamInfo.id),kn),this.streamList[xt].clearDisputableEntry=Dn.bind(this,this.streamList[xt].streamInfo.id),this.disputableStreamList.push(this.streamList[xt])):(pn.debug("remove stream from streamList:",Ct),apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({type:"subscribe",stream:this.streamList[xt].streamInfo}),this.streamList.splice(xt,1));break}nt!==void 0&&apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(nt),wt!==!0&&Tn.createMCURemovedStreamEvent(Ct)},this.startStreaming=function(nt,Ct,yt,xt){pn.info("startStreaming");var wt,Lt,Et=nt!=null&&nt.length>0,$t=Ct!=null&&Ct.length>0,Jt={};if(!Et&&!$t||yt==null||yt.length===0)return!1;if(xt===void 0){if(this.publishCallId===null)return pn.log("Cannot start streaming as no stream is published"),!1;xt=this.publishCallId}var en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(xt);return en||(en=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(xt))?en.sessionMCU?(Et||(nt="custom"),Jt.pubSub=this.pubConnector,Jt.service=nt,$t&&(Jt.server=Ct),Jt.streamKey=yt,pn.log("startStreaming() on ApiRTC MCU with roomId:",en.sessionMCU.roomName),wt={type:"startStreaming",roomId:en.sessionMCU.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:xt,data:Jt},Lt=JSON.stringify(wt),pn.log("C->S: "+Lt),apiCC.session.channel.socket.emit("startStreaming",Lt),!0):(pn.error("no such sessionMCU"),!1):(pn.error("callIdToStream does not match any call"),!1)},this.stopStreaming=function(nt){var Ct,yt;if(pn.info("stopStreaming"),nt===void 0){if(this.publishCallId===null)return pn.log("Cannot stop streaming as no stream is published"),!1;nt=this.publishCallId}var xt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(nt);if(!xt)return pn.error("callIdToStream does not match any call"),!1;var wt=this.getSessionMCU(xt.dest_roomId);return wt?(pn.log("stopStreaming() on ApiRTC MCU with roomId:",wt.roomName),Ct={type:"stopStreaming",roomId:wt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:nt,data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("stopStreaming",yt),!0):(pn.error("dest_roomId does not match any sessionMCU"),!1)},this.startRecording=function(nt,Ct,yt,xt,wt){var Lt,Et;if(pn.info("startRecording"),xt==null){if(this.publishCallId===null)return void pn.log("Call recording can not start as stream is not published");xt=this.publishCallId}var $t=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(xt);return $t||($t=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(xt))?$t.sessionMCU?(nt!=="AUDIO-ONLY"&&nt!=="VIDEO-ONLY"&&(nt="AUDIO-VIDEO"),wt==null&&(wt={}),wt.pubSub=this.pubConnector,pn.log("startRecording() on ApiRTC MCU with roomId :",$t.sessionMCU.roomName),Lt={type:"startRecording",roomId:$t.sessionMCU.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:xt,data:wt,customIdInFilename:Ct,mediaType:nt,convId:yt},Et=JSON.stringify(Lt),pn.log("C->S: "+Et),void apiCC.session.channel.socket.emit("startRecording",Et)):(pn.error("no such sessionMCU"),!1):(pn.error("callIdToRecord does not match any call"),!1)},this.stopRecording=function(nt){var Ct,yt;if(pn.info("stopRecording"),nt===void 0){if(this.publishCallId===null)return void pn.log("Call recording can not stop as stream is not published");nt=this.publishCallId}var xt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(nt);if(!xt)return pn.error("callIdToRecord does not match any call"),!1;var wt=this.getSessionMCU(xt.dest_roomId);if(!wt)return pn.error("dest_roomId does not match any sessionMCU"),!1;pn.log("stopRecording() on ApiRTC MCU with roomId :",wt.roomName),Ct={type:"stopRecording",roomId:wt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:nt,data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("stopRecording",yt)},this.recordingStarted=function(nt){pn.info("recordingStarted:",nt),Tn.createMCURecordingStartedEvent(nt.roomName,nt.callId,nt.clientId,nt.recordType,nt.time,nt.convId,nt.mediaId,nt.mediaURL,nt.remoteId,nt.recordedFileName,nt.mediaType,nt.descriptor)},this.recordingStopped=function(nt){pn.info("recordingStopped:",nt),Tn.createMCURecordingStoppedEvent(nt.roomName,nt.callId,nt.clientId,nt.recordType,nt.time,nt.convId,nt.mediaId,nt.mediaURL,nt.remoteId,nt.recordedFileName,nt.mediaType,nt.descriptor)},this.recordingStreamAvailable=function(nt){pn.info("recordingStreamAvailable :",nt),Tn.createMCURecordedStreamsAvailableEvent(nt.roomName,nt.callId,nt.clientId,nt.recordedFileName,nt.convId,nt.mediaId,nt.mediaURL,nt.recordType,nt.remoteId,nt.mediaType,nt.descriptor),this.pubConnector==="janusConnector"&&nt.hasOwnProperty("confId")&&nt.hasOwnProperty("remoteId")&&Tn.createRecordedStreamsAvailableEvent(nt.confId,nt.clientId,nt.remoteId,nt.callId,nt.convId,nt.mediaId,nt.mediaURL)},this.streamingStarted=function(nt){pn.info("streamingStarted: ",nt),Tn.createMCUStreamingStartedEvent(nt.roomName,nt.callId,nt.clientId,nt.time)},this.streamingStopped=function(nt){pn.info("streamingStopped: ",nt),Tn.createMCUStreamingStoppedEvent(nt.roomName,nt.callId,nt.clientId,nt.time)},this.startComposite=function(nt){var Ct,yt,xt;(xt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0}))?(pn.log("startComposite() on ApiRTC MCU with roomId :",xt.roomName),Ct={type:"startComposite",roomId:xt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("startComposite",yt)):pn.log("startComposite() but client is not in session")},this.stopComposite=function(nt){var Ct,yt,xt;(xt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0}))?(pn.log("stopComposite() on ApiRTC MCU with roomId :",xt.roomName),Ct={type:"stopComposite",roomId:xt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("stopComposite",yt)):pn.log("stopComposite() but client is not in session")},this.startCompositeRecording=function(nt,Ct,yt,xt,wt){pn.info("startCompositeRecording with convId :",yt);var Lt,Et,$t;($t=wt?this.getSessionMCU(wt):this.getSessionMCU(null,{first:!0}))?(nt!=="AUDIO-ONLY"&&nt!=="VIDEO-ONLY"&&(nt="AUDIO-VIDEO"),(xt=(0,lt.Ym)(xt,"object")?(0,lt.ws)({},xt):{}).pubSub=this.pubConnector,["complete","efficient","audioOnly"].indexOf(xt.mode)<0&&(xt.mode="complete"),xt.labelEnabled=xt.labelEnabled===!0,(0,lt.Ym)(xt,"labels","array")||(xt.labels=["microphone","camera","screenSharing","sip"]),pn.log("startRecording() on ApiRTC MCU with roomId :",$t.roomName),Lt={type:"startRecording",roomId:$t.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:"COMPOSITE",data:xt,customIdInFilename:Ct,mediaType:nt,convId:yt},Et=JSON.stringify(Lt),pn.log("C->S: "+Et),apiCC.session.channel.socket.emit("startRecording",Et)):pn.log("startCompositeRecording() but client is not in session")},this.stopCompositeRecording=function(nt){pn.info("stopCompositeRecording");var Ct,yt,xt;(xt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0}))?(pn.log("stopRecording() on ApiRTC MCU with roomId :",xt.roomName),Ct={type:"stopRecording",roomId:xt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:"COMPOSITE",data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("stopRecording",yt)):pn.log("stopCompositeRecording() but client is not in session")},this.inviteVoIP=function(nt,Ct,yt){var xt=this;return new Promise(function(wt,Lt){if(!nt||typeof nt!="string")return Lt(new Error("wrong roomId"));if(!xt.getSessionMCU(nt))return Lt(new Error("no such session"));if(!Ct||typeof Ct!="string")return Lt(new Error("wrong convId"));if(!yt||typeof yt!="string")return Lt(new Error("wrong phoneNumber"));var Et="inviteVoIP-"+yt;try{if(Kt.hasReceiptHook(Et))return Lt(new Error("busy"));var $t=new Nt;$t.onSuccess(function(){return wt()}),$t.onFailure(function(qt){return Lt(qt)}),$t.setTimeout(1e4,"timeout"),Kt.createReceiptHook(Et,$t)}catch(qt){return pn.debug("inviteVoIP: createReceiptHook",qt),Lt(new Error("internal error"))}var Jt={type:"inviteVoIP",clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,roomId:nt,convId:Ct,phoneNumber:yt,receiptId:Et,data:{pubSub:"sipConnector"}},en=JSON.stringify(Jt);pn.debug("C->S:",en),apiCC.session.channel.socket.emit("inviteVoIP",en)})},this.enforceMCU=function(nt){var Ct;if(Ct=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0})){var yt={type:"info",infoType:"enforceMCU",data:{clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,roomId:Ct.roomName,pubSub:this.pubConnector}},xt=JSON.stringify(yt);pn.log("C->S: "+xt),apiCC.session.channel.socket.emit("info",xt)}else pn.log("enforceMCU() but client is not in session")},this.meshPublish=function(nt,Ct,yt,xt,wt,Lt){var Et=!1,$t=null,Jt=null,en=this.getSessionMCU(nt);if(!en)return pn.error("meshPublish() - missing sessionMCU"),null;if(xt===!0||xt===!1||xt==="true"||xt==="false"?(pn.log("DEPRECATED ... please use callConfiguration JSON parameter : callConfiguration.audioOnly instead of audioOnly"),Et=xt,xt={}):xt!==null&&un(xt)==="object"||(xt={}),wt!==null&&un(wt)==="object"||(wt={}),(0,lt.Ym)(xt,"profileType","string")&&(wt.profileType=xt.profileType),(0,lt.Ym)(xt,"priority","number")&&xt.priority>=0&&(wt.priority=xt.priority),(0,lt.Ym)(xt,"downgradeProfileList","array")&&(wt.downgradeProfileList=xt.downgradeProfileList),xt.audioOnly!==void 0&&(Et=xt.audioOnly,wt.callConfiguration!==void 0||(wt.callConfiguration={}),wt.callConfiguration.audioOnly=xt.audioOnly),(0,lt.Ym)(xt,"context","object"))try{JSON.stringify(xt.context),wt.context=xt.context}catch{}return $t=new In(apiCC.session.apiCCWebRTCClient.webRTCClient),Et!==!0&&Et!=="true"||(pn.log("Setting call as audioOnly"),$t.callType="audio"),$t.roomId=nt,$t.sessionId=Ct,$t.token=yt,$t.callConfiguration=xt,$t.data=wt,$t.options=Lt,$t.sessionMCU=en,apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.push($t),xt.userMediaStreamId?((Jt=apiCC.getUserMediaStream(xt.userMediaStreamId)).addCallInfo($t.userMediaId,"userMedia"),$t.callConfiguration.userMediaStreamId=Jt.userMediaStreamId,$t.callType=Jt.callType,$t.audio=Jt.audio,$t.video=Jt.video,$t.audioMuted=Jt.audioMuted,$t.videoMuted=Jt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess($t),apiCC.checkMutingStateForUserMedia(xt,Jt)):apiCC.createUserMediaStream({callId:$t.userMediaId,callFlavor:"userMedia",type:$t.callType,audioSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.audioSourceId,videoSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.videoSourceId,success:function(qt){pn.debug("[meshPublish] success; userMediaStreamId: "+qt.userMediaStreamId),$t.callConfiguration.userMediaStreamId=qt.userMediaStreamId,$t.callType=qt.callType,$t.audio=qt.audio,$t.video=qt.video,$t.audioMuted=qt.audioMuted,$t.videoMuted=qt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess($t),apiCC.checkMutingStateForUserMedia(xt,qt)}}),$t.userMediaId},this.meshOnUserMediaSuccess=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0&&arguments[1],yt=null,xt=null;Ct===!0?((yt={}).type="streamStatusChanged",yt.callerId=Kt.clientId,yt.roomId=nt.roomId,yt.streams={},yt.streams[nt.userMediaId]={eventType:"modify",callId:nt.userMediaId,callType:nt.callType,audio:nt.audio,video:nt.video,audioMuted:nt.audioMuted,videoMuted:nt.videoMuted},yt.data={},yt.data.meshPublish=!0,yt.data.pubSub=this.pubConnector,xt=JSON.stringify(yt),pn.log("C->S: "+xt),apiCC.session.channel.socket.emit("streamStatusChanged",xt)):(this.publishCallId=nt.userMediaId,nt.addAck=!0,nt.addTimeoutId=setTimeout(function(){Kt.onRemoteHangup(nt.userMediaId,Kt.clientId,nt.roomId,"Unable_to_establish",null,null)},nt.disconnectionTimer),(yt={}).type="streamStatusChanged",yt.callerId=Kt.clientId,yt.roomId=nt.roomId,yt.streams={},yt.streams[nt.userMediaId]={eventType:"add",callId:nt.userMediaId,callType:nt.callType,audio:nt.audio,video:nt.video,audioMuted:nt.audioMuted,videoMuted:nt.videoMuted},yt.data=nt.data,yt.data.meshPublish=!0,yt.data.pubSub=this.pubConnector,xt=JSON.stringify(yt),pn.log("C->S: "+xt),apiCC.session.channel.socket.emit("streamStatusChanged",xt))},this.meshPublishScreen=function(nt,Ct,yt,xt,wt){var Lt=null,Et=null,$t=this.getSessionMCU(nt);return $t?(yt!==null&&un(yt)==="object"||(yt={}),(Lt=new In(apiCC.session.apiCCWebRTCClient.webRTCClient)).roomId=nt,Lt.data=Ct,Lt.callConfiguration=yt,Lt.captureSourceType=xt,Lt.sessionMCU=$t,apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.push(Lt),yt.userMediaStreamId?((Et=apiCC.getUserMediaStream(yt.userMediaStreamId)).addCallInfo(Lt.userMediaId,"userMedia"),Lt.callConfiguration.userMediaStreamId=Et.userMediaStreamId,Lt.callType=Et.callType,Lt.audio=Et.audio,Lt.video=Et.video,Lt.audioMuted=Et.audioMuted,Lt.videoMuted=Et.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Lt)):apiCC.createUserMediaStream({callId:Lt.userMediaId,callFlavor:"userMedia",type:"screenSharing",captureSourceType:xt,success:function(Jt){pn.debug("[meshPublishScreen] success; userMediaStreamId: "+Jt.userMediaStreamId),Lt.callConfiguration.userMediaStreamId=Jt.userMediaStreamId,Lt.callType=Jt.callType,Lt.audio=Jt.audio,Lt.video=Jt.video,Lt.audioMuted=Jt.audioMuted,Lt.videoMuted=Jt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnScreenMediaSuccess(Lt)}}),Lt.userMediaId):(pn.error("meshPublishScreen() - missing sessionMCU"),null)},this.meshOnScreenMediaSuccess=function(nt){var Ct,yt=null;nt.addAck=!0,nt.addTimeoutId=setTimeout(function(){Kt.onRemoteHangup(nt.userMediaId,Kt.clientId,nt.roomId,"Unable_to_establish",null,null)},nt.disconnectionTimer),(yt={}).type="streamStatusChanged",yt.callerId=Kt.clientId,yt.roomId=nt.roomId,yt.streams={},yt.streams[nt.userMediaId]={eventType:"add",callId:nt.userMediaId,callType:nt.callType,audio:nt.audio,video:nt.video,audioMuted:nt.audioMuted,videoMuted:nt.videoMuted},yt.data={},yt.data.pubSub=this.pubConnector,Ct=JSON.stringify(yt),pn.log("C->S: "+Ct),apiCC.session.channel.socket.emit("streamStatusChanged",Ct)},this.meshOnHangup=function(nt,Ct){var yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},xt=0,wt=null,Lt=null,Et=null;if(Ct!==null&&un(Ct)==="object"||(Ct={}),nt){if((wt=Kt.findUserMediaById(nt))!==null){for(wt.close(),wt.streamStolen!==!0&&(Kt.myWebRTC_Event.createHangupEvent("local",Kt.clientId,0,!0,null,wt.userMediaId,wt.callType),wt.releaseUserMediaStream()),(Lt={}).type="streamStatusChanged",Lt.callerId=Kt.clientId,Lt.roomId=wt.roomId,Lt.streams={},Lt.streams[wt.userMediaId]={eventType:"remove",callId:wt.userMediaId,callType:wt.callType},yt.restart&&(Lt.streams[wt.userMediaId].restart=!0),Lt.data={},Lt.data.pubSub=this.pubConnector,Et=JSON.stringify(Lt),pn.log("C->S: "+Et),apiCC.session.channel.socket.emit("streamStatusChanged",Et),xt=Kt.userMediaTable.length;--xt>=0;)if(Kt.userMediaTable[xt]===wt){Kt.userMediaTable.splice(xt,1);break}}}else for(xt=Kt.userMediaTable.length;--xt>=0;)wt=Kt.userMediaTable[xt],yt.hasOwnProperty("roomId")&&wt.sessionMCU.roomName!==yt.roomId||(Kt.myWebRTC_Event.createHangupEvent("local",Kt.clientId,0,!0,null,wt.userMediaId,wt.callType),wt.close(),wt.releaseUserMediaStream(),(Lt={}).type="streamStatusChanged",Lt.callerId=Kt.clientId,Lt.roomId=wt.roomId,Lt.streams={},Lt.streams[wt.userMediaId]={eventType:"remove",callId:wt.userMediaId,callType:wt.callType},Lt.data={},Lt.data.pubSub=this.pubConnector,Et=JSON.stringify(Lt),pn.log("C->S: "+Et),apiCC.session.channel.socket.emit("streamStatusChanged",Et),Kt.userMediaTable.splice(xt,1))},this.participantEjected=function(nt){(0,lt.Ym)(nt.data,"clientId","string")&&Kt.myWebRTC_Event.createMCUParticipantEjectedEvent(nt.roomId,nt.data.clientId,nt.data.info)},this.ejectParticipant=function(nt,Ct,yt){var xt;if(xt=yt?this.getSessionMCU(yt):this.getSessionMCU(null,{first:!0})){var wt={type:"ejectParticipant",roomId:xt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector,clientId:nt}};Ct&&(wt.data.info=Ct);var Lt=JSON.stringify(wt);pn.log("C->S: "+Lt),apiCC.session.channel.socket.emit("ejectParticipant",Lt)}else pn.debug("ejectParticipant() - missing sessionMCU")},this.getJoinSessionReq=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=null;if(!nt){if(Ct.hasOwnProperty("transactionId")){for(var xt=this.joinSessionReqs.length;--xt>=0;)if(this.joinSessionReqs[xt].transactionId===Ct.transactionId){yt=this.joinSessionReqs[xt];break}return yt}return null}for(var wt=this.joinSessionReqs.length;--wt>=0;)if(this.joinSessionReqs[wt].roomId===nt){yt=this.joinSessionReqs[wt];break}return yt},this.removeJoinSessionReq=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!nt){if(Ct.all===!0)return this.joinSessionReqs.splice(0,this.joinSessionReqs.length),!0;Ct.hasOwnProperty("roomId")&&(nt=this.getJoinSessionReq(Ct.roomId))}if(!nt)return!1;for(var yt=this.joinSessionReqs.length;--yt>=0&&this.joinSessionReqs[yt]!==nt;);return yt>=0&&(this.joinSessionReqs.splice(yt,1),!0)},this.getSessionMCU=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=null;if(!nt){if(Ct.first===!0)return this.sessionMCUs[0];if((0,lt.Ym)(Ct.callback,"function")){pn.debug("getSessionMCU callback");for(var xt=this.sessionMCUs.length;--xt>=0;)if(Ct.callback(this.sessionMCUs[xt])){yt=this.sessionMCUs[xt];break}}return yt}for(var wt=this.sessionMCUs.length;--wt>=0;)if(this.sessionMCUs[wt].roomName===nt){yt=this.sessionMCUs[wt];break}return yt},this.removeSessionMCU=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!nt&&Ct.all===!0)return this.sessionMCUs.splice(0,this.sessionMCUs.length),!0;if(!nt)return!1;for(var yt=this.sessionMCUs.length;--yt>=0&&this.sessionMCUs[yt]!==nt;);return yt>=0&&(this.sessionMCUs.splice(yt,1),!0)},this.callback=function(nt,Ct){return this.closureHandler=function(yt){return nt[Ct](yt)},this.closureHandler}};function Mn(Kt){pn.debug("disputableEntryTimeout",Kt);for(var Rt=apiCC.session.apiCCWebRTCClient.webRTCClient,nt=this.disputableStreamList.length;--nt>=0;)if(this.disputableStreamList[nt].streamInfo.id===Kt){this.disputableStreamList.splice(nt,1);break}for(var Ct=null,yt=this.streamList.length;--yt>=0;)if(this.streamList[yt].streamInfo.id===Kt){Ct=Rt.destroyCallControl({type:"subscribe",stream:this.streamList[yt].streamInfo}),this.streamList.splice(yt,1);break}Ct&&Ct.callId&&Tn.createHangupEvent("remote",Rt.clientId,Ct.roomName,!1,"Hangup_From_Callee",Ct.callId,Ct.callType),Tn.createMCURemovedStreamEvent(Kt)}function Dn(Kt){pn.debug("clearDisputableEntry",Kt);for(var Rt=this.disputableStreamList.length;--Rt>=0;)if(this.disputableStreamList[Rt].streamInfo.id===Kt){this.disputableStreamList.splice(Rt,1);break}for(var nt=this.streamList.length;--nt>=0;)if(this.streamList[nt].streamInfo.id===Kt){this.streamList[nt].disputableTimeoutId&&(clearTimeout(this.streamList[nt].disputableTimeoutId),delete this.streamList[nt].disputableTimeoutId),delete this.streamList[nt].clearDisputableEntry;break}}function An(Kt){var Rt={};return(0,lt.ki)(Kt,"maxBitrate","number")&&(Rt.maxBitrate=Kt.maxBitrate),(0,lt.ki)(Kt,"scaleResolutionDownBy","number")&&(Rt.scaleResolutionDownBy=Kt.scaleResolutionDownBy),Rt}function Nn(Kt){return(0,lt.Ym)(Kt.encodings,"object")?(0,lt.ki)(Kt.encodings.high,"maxBitrate","number")&&(0,lt.ki)(Kt.encodings.medium,"maxBitrate","number")&&(0,lt.ki)(Kt.encodings.low,"maxBitrate","number")?(Kt.encodings.high=Object.assign({active:!0},An(Kt.encodings.high)),Kt.encodings.medium=Object.assign({active:!0},An(Kt.encodings.medium)),Kt.encodings.low=Object.assign({active:!0},An(Kt.encodings.low)),Kt.sendEncodings=[{rid:"h",active:!0},{rid:"m",active:!0},{rid:"l",active:!0}],Kt.sendEncodings[0].maxBitrate=1e3*Kt.encodings.high.maxBitrate,Kt.sendEncodings[1].maxBitrate=1e3*Kt.encodings.medium.maxBitrate,Kt.sendEncodings[2].maxBitrate=1e3*Kt.encodings.low.maxBitrate,(0,lt.ki)(Kt.encodings.medium,"scaleResolutionDownBy","number")&&(Kt.sendEncodings[1].scaleResolutionDownBy=Kt.encodings.medium.scaleResolutionDownBy),(0,lt.ki)(Kt.encodings.low,"scaleResolutionDownBy","number")&&(Kt.sendEncodings[2].scaleResolutionDownBy=Kt.encodings.low.scaleResolutionDownBy),!0):(pn.warn("no such maxBitrate"),!1):(pn.warn("no such encodings"),!1)}function Un(Kt,Rt){if(Rt<650)return!1;var nt=Math.floor(9*Rt/13),Ct=Math.floor(3*Rt/13),yt=Rt-nt-Ct;return Kt.encodings={high:{maxBitrate:nt},medium:{maxBitrate:Ct,scaleResolutionDownBy:2},low:{maxBitrate:yt,scaleResolutionDownBy:4}},Nn(Kt)}et.Y.get("CallControl");var Qn=function(Kt){this.type=Kt.type,Kt.callId&&(this.callId=Kt.callId),Kt.callType?this.callType=Kt.callType:this.callType="media",Object.prototype.hasOwnProperty.call(Kt,"audioOnly")&&(this.audioOnly=!!Kt.audioOnly),Kt.roomName&&(this.roomName=Kt.roomName),Kt.mediaType&&(this.mediaType=Kt.mediaType),Kt.callConfiguration&&(this.callConfiguration=Kt.callConfiguration),Kt.data&&(this.data=Kt.data),Kt.stream&&(this.stream=Kt.stream),this.autoRestart={}},er=function(){var Kt=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];this.a=1,this.b=0,this.c=7,this.d=0,this.update=function(Rt,nt,Ct){var yt=0;for(nt==null&&(nt=0),Ct==null&&(Ct=Rt.length);yt<Ct;yt+=1)this.a=(this.a+Rt[nt+yt])%65521,this.b=(this.b+this.a)%65521,this.c=(this.c+3)*(Rt[nt+yt]+5)%65521,this.d=(this.d+this.c)%65521},this.digest=function(Rt){return Kt[this.d>>12&15]+Kt[this.d>>8&15]+Kt[this.d>>4&15]+Kt[15&this.d]+Kt[this.c>>12&15]+Kt[this.c>>8&15]+Kt[this.c>>4&15]+Kt[15&this.c]+Kt[this.b>>12&15]+Kt[this.b>>8&15]+Kt[this.b>>4&15]+Kt[15&this.b]+Kt[this.a>>12&15]+Kt[this.a>>8&15]+Kt[this.a>>4&15]+Kt[15&this.a]}};function zn(Kt,Rt){return Kt==="checksum64"?new er:null}function lr(Kt){return lr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Rt){return typeof Rt}:function(Rt){return Rt&&typeof Symbol=="function"&&Rt.constructor===Symbol&&Rt!==Symbol.prototype?"symbol":typeof Rt},lr(Kt)}var cn=et.Y.get("WebRTC_Client"),Gn=apiCC.myWebRTC_Event,Yn=4e4,or=function(Kt){function Rt(nt,Ct,yt){var xt,wt=nt.width,Lt=wt<<2,Et=nt.height,$t=null,Jt=0,en=0,qt=0,on=0,hn=0,nn=0,dn=0,Sn=0,wn=0,En=0,Pn=0,Wn=0,ir=0,fr=0,gr=0,yr=0;if(Ct){for($t=Ct.data,yt<0&&(yt=0),Sn=1-((hn=(2.44413*(Jt=yt>=2.5?.98711*yt-.9633:yt>=.5?3.97156-4.14554*Math.sqrt(1-.26891*yt):2*yt*(3.97156-4.14554*Math.sqrt(.865545)))+2.85619*(en=Jt*Jt)+1.26661*(qt=en*Jt))/(on=1.57825+2.44413*Jt+1.4281*en+.422205*qt))+(nn=-(1.4281*en+1.26661*qt)/on)+(dn=.422205*qt/on)),xt=0;xt<3;xt++)for(wn=0;wn<Et;wn++){for(Pn=wn*Lt+(wt-1<<2)+xt,gr=fr=ir=Wn=$t[En=wn*Lt+xt],En=wn*Lt+xt;En<=Pn;En+=4)Wn=Sn*$t[En]+hn*ir+nn*fr+dn*gr,$t[En]=Wn,gr=fr,fr=ir,ir=Wn;for(Pn=wn*Lt+xt,gr=fr=ir=Wn=$t[En=wn*Lt+(wt-1<<2)+xt],En=wn*Lt+(wt-1<<2)+xt;En>=Pn;En-=4)Wn=Sn*$t[En]+hn*ir+nn*fr+dn*gr,$t[En]=Wn,gr=fr,fr=ir,ir=Wn}for(xt=0;xt<3;xt++)for(yr=0;yr<wt;yr++){for(Pn=(Et-1)*Lt+(yr<<2)+xt,gr=fr=ir=Wn=$t[En=(yr<<2)+xt],En=(yr<<2)+xt;En<=Pn;En+=Lt)Wn=Sn*$t[En]+hn*ir+nn*fr+dn*gr,$t[En]=Wn,gr=fr,fr=ir,ir=Wn;for(Pn=(yr<<2)+xt,gr=fr=ir=Wn=$t[En=(Et-1)*Lt+(yr<<2)+xt],En=(Et-1)*Lt+(yr<<2)+xt;En>=Pn;En-=Lt)Wn=Sn*$t[En]+hn*ir+nn*fr+dn*gr,$t[En]=Wn,gr=fr,fr=ir,ir=Wn}return Ct}}this.localStream=null,this.remoteStream=null,this.channelReady=!1,this.socket=Kt.channel.socket,this.clientId=Kt.apiCCId,this.compositeClientId=Kt.apiCCId+"@"+Kt.apiCCSessionId,this.apiKey=Kt.apiKey,this.isVideoMuted=!1,this.isAudioMuted=!1,this.receiptHooks={},this.callControlTable=[],this.userMediaTable=[],this.callsTable=[],this.callsRetriesTable={},this.restartCallDelay=1e3,this.maxCallsRetriesDuration=15e4,this.accessToLocalMedia=!1,this.unidirectionelCallOnly=!1,this.NtoNConf=!1,this.autoAnswer=!1,this.RTPMedia=!1,this.logoAdded=!1,this.preferOpusCodec=!1,this.preferVP9Codec=!1,typeof apiRTC_React<"u"&&ot.BF==="iOS"?(cn.log("React and iOS : Setting H264 as preferred codec"),this.preferH264Codec=!0):this.preferH264Codec=!1,this.preferSendingH264Codec=!1,this.setStereo=!1,this.allowedAudioCodecs="",this.allowedVideoCodecs="",this.mediaRoutingModeEnum={hostOnly:1,stun:2,stunOnly:3,turn:4,turnOnly:5},this.mediaRoutingMode=this.mediaRoutingModeEnum.turn,this.myWebRTC_Event=apiCC.myWebRTC_Event,this.getUserMediaOnGoing=!1,this.userAcceptOnIncomingCall=!1,this.userAcceptOnIncomingCallBeforeGetUserMedia=!1,this.userAcceptOnIncomingDataCall=!1,this.userAcceptOnIncomingScreenSharingCall=!1,this.maxWidthRemoteVideo=0,this.maxHeightRemoteVideo=0,this.nickname=Kt.nickname,this.allowMultipleCalls=!1,this.mySDPManager=new ft,this.MCUClient=new xn(this,this.clientId),this.audioSourceId=null,this.audioOutputId=null,this.videoSourceId=null,this.facingMode=null,this.apiRTCExtensionInstalled=!1,this.trickleIce=!0,this.waitingShareScreenCallId=0,this.waitingShareScreenDestNumber=0,this.waitingCaptureSourceType=null,this.qosEnable=!1,this.qosInterval=5e3,this.csmEnable=!1,this.qualityScoreEnable=!1,this.qualityScoreIntervalMs=5e3,this.csmIntervalMs=5e3,this.recordedCall=!1,this.audioBandwidth=null,this.videoBandwidth=null,this.videoRemoteBandwidth=null,this.videoBandwidthSettings={},this.dataBandwidth=null,this.pc_config="",this.clientIncomingCandidatesQueue=[],this.cleanStoredCallCandidateTimer=6e4,this.initializeGumConfig=function(){ot.Xh==="Edge"&&ot.PR>=15&&apiRTC.browserDetails.type!=="chrome"?this.gum_config={audio:!0,video:!0}:ot.Xh==="Chrome"&&ot.PR<49||ot.Xh==="Firefox"&&ot.PR<50?this.gum_config={audio:{mandatory:{},optional:[]},video:{mandatory:{},optional:[]}}:this.gum_config={audio:{},video:{}}},this.initializeGumConfig(),this.setGumConfigWithDevicePresent=function(){apiCC.mediaDeviceMgr.audioDevicePresent===!1&&(this.gum_config.audio=!1),apiCC.mediaDeviceMgr.videoDevicePresent===!1&&(this.gum_config.video=!1),apiCC.mediaDeviceMgr.audioDevicePresent===!1&&apiCC.mediaDeviceMgr.videoDevicePresent===!1&&(this.unidirectionelCallOnly=!0),cn.log("this.gum_config:",this.gum_config)},this.userMediaErrorDetected=!1,this.lastUsedUserMediaConstraint=null,this.mediaTypeForIncomingCall="VIDEO",this.mediaTypeForOutgoingCall="VIDEO",this.allowAsymetricMediaCalls=!1,this.receiveMediaDeactivated=!1,this.configTurnServer=null,apiCC.myWebRTC_Adapter.adaptForIoSCordova(),this.pc_config={iceServers:[{urls:["turns:mp1.apizee.com:443?transport=udp","turns:mp1.apizee.com:443?transport=tcp","turn:mp1.apizee.com:443?transport=udp","turn:mp1.apizee.com:443?transport=tcp","turns:mp2.apizee.com:443?transport=udp","turns:mp2.apizee.com:443?transport=tcp","turn:mp2.apizee.com:443?transport=udp","turn:mp2.apizee.com:443?transport=tcp"],credential:"password",username:"anonymous"}]},ot.Xh==="Firefox"&&ot.PR<53?(cn.log("createPeerConnection FIREFOX"),cn.log("webrtcDetectedVersion : "+apiCC.myWebRTC_Adapter.webrtcDetectedVersion),ot.PR<38?this.pc_config={iceServers:[{url:"stun:mp1.apizee.com:443",credential:"password",username:"anonymous"},{url:"turn:mp1.apizee.com:443",credential:"password",username:"anonymous"}]}:ot.PR>=42?this.pc_config={iceServers:[{urls:["turn:mp1.apizee.com:443?transport=udp","turn:mp1.apizee.com:443?transport=tcp"],credential:"password",username:"anonymous"}]}:this.pc_config={iceServers:[{urls:"turn:mp1.apizee.com:443?transport=tcp",credential:"password",username:"anonymous"},{url:"turn:mp1.apizee.com:443?transport=tcp",credential:"password",username:"anonymous"}]}):ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11?(cn.log("Browser is :"+ot.Xh+" - using Plugin"),this.pc_config={iceServers:[{url:"stun:mp1.apizee.com:443",credential:"password",username:"anonymous"},{url:"turn:mp1.apizee.com:443",credential:"password",username:"anonymous"}]}):ot.Xh==="Edge"&&ot.PR<45&&apiRTC.browserDetails.type!=="chrome"?(cn.log("Browser is Edge < 45 - removing Turns config"),this.pc_config={iceServers:[{urls:["turn:mp1.apizee.com:443?transport=udp","turn:mp1.apizee.com:443?transport=tcp","turn:mp2.apizee.com:443?transport=udp","turn:mp2.apizee.com:443?transport=tcp"],credential:"password",username:"anonymous"}]}):cn.log("default this.pc_config configuration"),this.pc_constraints={optional:[]},lt.wL.type==="edge"?cn.debug("not data channel capable"):lt.wL.type==="safari"?lt.wL.version>=11?this.dataChannelCapable=!0:cn.debug("not data channel capable"):this.dataChannelCapable=!0,lt.wL.type==="chrome"&&lt.wL.version>=68||lt.wL.type==="firefox"&&lt.wL.version>=64||lt.wL.type==="safari"&&lt.wL.version>=12?(cn.debug("RTCRtpSender#setParameters is available"),this.rtpSenderSetParamatersCapable=!0):(cn.debug("RTCRtpSender#setParameters is NOT available"),this.rtpSenderSetParamatersCapable=!1),this.setClientTurnServer=function(nt){cn.info("setClientTurnServer :",nt);var Ct=JSON.stringify(this.pc_config);Ct=Ct.replace(/mp1.apizee.com/g,nt),this.pc_config=JSON.parse(Ct)},this.activateScreenSharing=function(nt){apiCC.activateScreenSharing(nt)},this.setGetUserMediaConfig=function(nt){if(cn.log("setGetUserMediaConfig :",nt),navigator.mediaDevices!==null&&navigator.mediaDevices!==void 0&&navigator.mediaDevices.getSupportedConstraints!==null&&navigator.mediaDevices.getSupportedConstraints!==void 0){var Ct=navigator.mediaDevices.getSupportedConstraints();cn.log("Supported Constraints :",Ct)}nt.video!==void 0&&(nt.video.height===void 0&&nt.video.width===void 0||nt.optional!==void 0&&(cn.warn("contraints with both optional/mandatory and specific or advanced constraints usage : this may failed depending of browsers"),cn.log("setGetUserMediaConfig : contraints modification to avoid both optional/mandatory and specific or advanced constraints usage"),nt.optional.sourceId!==void 0&&(cn.log("sourceId contraints modification to deviceId"),nt.video.deviceId===void 0&&(nt.video.deviceId={}),nt.video.deviceId.ideal=nt.optional.sourceId),delete nt.optional)),cn.log("this.gum_config :",this.gum_config),this.gum_config=nt},this.getUserMedia=function(){try{this.gum_config=apiCC.setAudioSourceIdInConstraint(this.audioSourceId,this.gum_config),this.gum_config=apiCC.setVideoSourceIdInConstraint(this.videoSourceId,this.gum_config),this.lastUsedUserMediaConstraint=this.gum_config,ot.Xh==="IE"&&ot.dc>8?apiCC.getUserMediaWithCB(this.gum_config,this.callback(this,"onUserMediaSuccess"),this.callback(this,"onUserMediaError")):apiCC.getUserMedia(this.gum_config).then(this.callback(this,"onUserMediaSuccess")).catch(this.callback(this,"onUserMediaError"))}catch(nt){cn.error("getUserMedia() failed. Is this a WebRTC capable browser?"),cn.log("getUserMedia failed with exception: "+nt.message)}},this.onUserMediaSuccess=function(nt){cn.info("onUserMediaSuccess : User has granted access to local media."),this.accessToLocalMedia=!0;var Ct=!1,yt="Unknown",xt=!1,wt="Unknown";this.localStream=nt,nt.getAudioTracks().length>0&&(Ct=!0,nt.getAudioTracks()[0].label&&(yt=nt.getAudioTracks()[0].label),cn.log("Using audio device: "+yt)),nt.getVideoTracks().length>0&&(xt=!0,nt.getVideoTracks()[0].label&&(wt=nt.getVideoTracks()[0].label),cn.log("Using video device: "+wt)),this.myWebRTC_Event.createUserMediaSuccessEvent(!1,Ct,yt,xt,wt,"media",null,nt,null,!1)},this.onUserMediaError=function(nt){cn.info("onUserMediaError : Failed to get access to local media. Error : ",nt),cn.error(nt),this.accessToLocalMedia=!1,ot.$6!=="electron"&&ot.Xh==="Chrome"&&ot.PR>47&&(cn.log("browser_version > 47"),window.location.protocol!=="https:"&&cn.error("HTTPS is now mandatory to use getUserMedia()")),this.myWebRTC_Event.createUserMediaErrorEvent(!1,"media",nt,null,null,null,this.gum_config),nt=null,apiCC.session.tryAudioCallAfterUserMediaError===!0?(cn.log("this.lastUsedUserMediaConstraint :",this.lastUsedUserMediaConstraint),cn.log("this.lastUsedUserMediaConstraint.video :",this.lastUsedUserMediaConstraint.video),this.lastUsedUserMediaConstraint.video!==!1?(cn.log("this.lastUsedUserMediaConstraint.audio :",this.lastUsedUserMediaConstraint.audio),cn.log("UserMediaError, Trying to getUserMedia with audioOnly"),this.videoSourceId=null,this.gum_config.video=!1,this.getUserMedia()):cn.log("onUserMediaError without video")):cn.log("try AudioCall after UserMediaError is not activated")},this.evalCallProfileWithSdp=function(nt,Ct,yt){return this.evalCallProfileWithSdpGuideline(this.mySDPManager.createGuideline(nt),nt,Ct,yt)},this.evalCallProfileWithSdpGuideline=function(nt,Ct,yt,xt){var wt={};return nt.hasOwnProperty("audio")?(wt.audio=!0,wt.audioActive=yt==="local"&&xt==="send"?nt.audio.direction==="sendrecv"||nt.audio.direction==="sendonly":yt==="local"&&xt==="receive"||yt==="remote"&&xt==="send"?nt.audio.direction==="sendrecv"||nt.audio.direction==="recvonly":yt==="remote"&&xt==="receive"&&(nt.audio.direction==="sendrecv"||nt.audio.direction==="sendonly")):(wt.audio=!1,wt.audioActive=!1),nt.hasOwnProperty("video")?(wt.video=!0,wt.videoActive=yt==="local"&&xt==="send"?nt.video.direction==="sendrecv"||nt.video.direction==="sendonly":yt==="local"&&xt==="receive"||yt==="remote"&&xt==="send"?nt.video.direction==="sendrecv"||nt.video.direction==="recvonly":yt==="remote"&&xt==="receive"&&(nt.video.direction==="sendrecv"||nt.video.direction==="sendonly")):(wt.video=!1,wt.videoActive=!1),wt},this.checkDestCallTypeWithSDP=function(nt,Ct){cn.debug("checkDestCallTypeWithSDP");var yt=this.mySDPManager.createGuideline(nt),xt=!1,wt=!1;!yt.audio||yt.audio.direction!=="sendrecv"&&yt.audio.direction!=="sendonly"||(xt=!0),!yt.video||yt.video.direction!=="sendrecv"&&yt.video.direction!=="sendonly"||(wt=!0),Ct.destCallType=xt===!0?wt===!0?"media":"audio":wt===!0?"videoOnly":"inactive",cn.debug("call.destCallType: "+Ct.destCallType),Ct.callee!==!0||yt.audio&&yt.audio.direction!=="sendonly"||yt.video&&yt.video.direction!=="sendonly"||(Ct.userMediaAccessRequired=!1,Ct.mediaTypeForOutgoingCall="NONE",cn.debug("access to user media not required"))},this.evaluateVideoCap=function(nt){delete nt.videoCap,nt.belongsToRoom()?nt.settingUpType!=="publish"&&nt.settingUpType!=="shareScreen"||nt.localCallProfile&&nt.localCallProfile.video&&nt.localCallProfile.videoActive&&this.evalOutgoingVideoBandwithCap(nt):(this.rtpSenderSetParamatersCapable||!nt.callee)&&nt.localCallProfile&&nt.localCallProfile.video&&nt.localCallProfile.videoActive&&this.evalOutgoingVideoBandwithCap(nt)},this.processInvite=function(nt){cn.info("processInvite() - invite received from :"+nt.callerId);var Ct,yt=0,xt=null,wt=null,Lt=null,Et=null,$t=!1,Jt=null,en=null,qt=null,on={};if(nt.data!==void 0&&nt.data.type==="publish"&&nt.data.mesh!==void 0){if(cn.info("received invite publish mesh; mesh: "+JSON.stringify(nt.data.mesh)),(xt=this.findCallWithCallIdAndInstanceId(nt.data.mesh.callerCallId,nt.data.instanceId))==null)return void cn.error("cannot find call; callId: "+nt.data.mesh.callerCallId);xt.userMediaAccessRequired=!1,xt.data.mesh=nt.data.mesh,xt.setupTimeoutId&&(clearTimeout(xt.setupTimeoutId),delete xt.setupTimeoutId),$t=!0}else{if(nt.data!==void 0&&nt.data.type==="subscribe"&&nt.data.mesh!==void 0){if(cn.debug("received invite subscribe mesh; mesh: ",nt.data.mesh),(wt=this.findUserMediaById(nt.data.mesh.calleeCallId))!==null)if(this.MCUClient.distantCalls.push({early:!0,roomId:nt.roomId,clientId:nt.data.mesh.callerId,callId:nt.data.mesh.callerCallId,callMode:"mesh",callDirection:"recvonly",callFeed:{clientId:nt.data.mesh.calleeId,callId:nt.data.mesh.calleeCallId}}),setTimeout((function(dn,Sn,wn){cn.debug("early distant call descriptor timeout");for(var En=this.MCUClient.distantCalls.length;--En>=0;)if(this.MCUClient.distantCalls[En].early&&this.MCUClient.distantCalls[En].roomId===dn&&this.MCUClient.distantCalls[En].clientId===Sn&&this.MCUClient.distantCalls[En].callId===wn){cn.debug("remove early distant call descriptor: timeout"),this.MCUClient.distantCalls.splice(En,1);break}}).bind(this,nt.roomId,nt.data.callerId,nt.data.callerCallId),3e4),wt.callType==="screenSharing"||wt.callType==="screenSharingWithAudio")on.type="publish",on.mesh=nt.data.mesh,on.instanceId=nt.data.instanceId,this.MCUClient.publishScreen(nt.roomId,on,null,wt.captureSourceType);else{var hn=(0,lt.ws)({},wt.callConfiguration);nt.data.mediaType==="AUDIOONLY"?hn.audioOnly=!0:nt.data.mediaType==="VIDEOONLY"&&(hn.videoOnly=!0),(Lt=apiCC.getUserMediaStream(hn.userMediaStreamId))&&(Lt.audioMuted&&Lt.videoMuted?hn.muted="VIDEO":Lt.audioMuted?hn.muted="AUDIOONLY":Lt.videoMuted?hn.muted="VIDEOONLY":delete hn.muted),delete hn.distributedBroadcastEnabled,delete hn.simulcast,on.type="publish",on.mesh=nt.data.mesh,on.instanceId=nt.data.instanceId,this.MCUClient.publish(nt.roomId,null,null,hn,on,null)}else cn.debug("media not found: sending bye : Call_not_found"),new St.S(apiCC.session.channel.socket).sendBye(nt.callId,nt.calleeId,nt.roomId,nt.callerId,"Call_not_found",nt.data);return}if(nt.data!==void 0&&nt.data.type==="publish"&&nt.data.mode==="passive"){if((xt=this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,nt.data.instanceId))==null)return void cn.debug("cannot find call; callId: "+nt.callId+", callerId: "+nt.callerId+", instanceId: "+nt.data.instanceId);xt.userMediaAccessRequired=!1,xt.setupTimeoutId&&(clearTimeout(xt.setupTimeoutId),delete xt.setupTimeoutId),$t=!0}else(xt=new bn(this)).callId=nt.callId,xt.instanceId=nt.data.instanceId,xt.callerId=nt.callerId,xt.calleeId=this.clientId,xt.callee=!0,xt.remoteId=nt.callerId}if(xt.dest_roomId=nt.roomId,xt.data!==void 0&&$t===!0)for(qt in nt.data)nt.data.hasOwnProperty(qt)&&(xt.data[qt]=nt.data[qt]);else xt.data=nt.data;if(xt.data.instanceId=xt.instanceId,nt.data!==void 0&&nt.data.pubSub==="sipConnector"&&(xt.trickleIce=!1,xt.remoteType="sip"),xt.checkDTLSCompliancy(),ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"&&(Jt=apiCC.session.getConnectedUserInfo(nt.callerId,"userData"),cn.log("destUserInfo :",Jt),Jt!=="User_Not_Found"&&Jt!==void 0&&(en=JSON.parse(Jt)).browser==="Chrome"&&en.osName==="Android"&&(cn.log("Browser is Edge and caller is Chrome on Android, setting VP8 as prefered codec for the call"),xt.preferVP8Codec=!0)),nt.data!==void 0&&nt.data.type==="publish"&&nt.data.mode==="passive"&&nt.stream!==void 0&&nt.stream.id!==void 0&&(xt.streamId=nt.stream.id,cn.log("call.streamId: "+xt.streamId)),yt=this.callsTable.length,cn.log("processInvite() - Actual call Number is :"+yt),nt.callType==="screenSharing"||nt.callType==="screenSharingWithAudio")xt.screenSharing=!0,xt.callType=nt.callType;else if(nt.callType!=="data"){if(this.allowMultipleCalls===!1){for(cn.log("processInvite() - Refusing double call checking ..."),Ct=0;Ct<yt;Ct+=1)if(this.callsTable[Ct].callType!=="screenSharing"&&this.callsTable[Ct].callType!=="screenSharingWithAudio"&&this.callsTable[Ct].callType!=="data")return cn.log("processInvite() - Refusing double call"),$t===!1?this.callsTable.push(xt):cn.log("callAlreadyExist in table"),this.myWebRTC_Event.createCallAttemptEvent(this.clientId,nt.callerId,nt.callerNickname,xt.callId),void this.refuseCall(xt.callId,"User_Busy");cn.log("NOT Refusing double call")}}$t===!1?(yt=this.callsTable.push(xt),cn.log("processInvite() - New call Number is :"+yt)):(cn.log("callAlreadyExist in table"),cn.log("processInvite() - call Number is :"+yt)),this.checkDestCallTypeWithSDP(nt.sdpoffer.sdp,xt);var nn=this.mySDPManager.createGuideline(nt.sdpoffer.sdp);if(xt.setLocalCallProfile(this.evalCallProfileWithSdpGuideline(nn,nt.sdpoffer.sdp,"remote","send")),xt.setRemoteCallProfile(this.evalCallProfileWithSdpGuideline(nn,nt.sdpoffer.sdp,"remote","receive")),this.rtpSenderSetParamatersCapable||(this.evaluateVideoCap(xt),xt.videoCap&&(nn.video.bandwidth=xt.videoCap,nt.sdpoffer.sdp=nn.generate())),xt.receivedSdpOfferMessage=nt.sdpoffer,(0,lt.ki)(nt,"stream","object")&&(nt.stream.audioMuted===!0&&(xt.isRemoteAudioMuted=!0),nt.stream.videoMuted===!0&&(xt.isRemoteVideoMuted=!0)),nt.callType==="data"){if(cn.log("Receiving DATA call"),xt.callType="data",xt.dataCall=!0,ot.Xh==="Edge"&&ot.PR<79&&apiRTC.browserDetails.type!=="chrome")return cn.warn("Cannot create DataChannel as it is not supported on Edge"),void this.refuseCall(xt.callId,"DataChannel_Not_Supported");this.userAcceptOnIncomingDataCall||xt.onUserMediaSuccessTestUni(),this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,xt.callId,!1,yt,!1,nt.callType,!1,xt.remoteType,xt.destCallType)}else xt.userMediaAccessRequired===!1||this.unidirectionelCallOnly||xt.screenSharing===!0?(cn.log("call.userMediaAccessRequired :",xt.userMediaAccessRequired),cn.log("this.unidirectionelCallOnly :",this.unidirectionelCallOnly),cn.log("call.screenSharing :",xt.screenSharing),xt.screenSharing===!0?this.userAcceptOnIncomingScreenSharingCall===!1?xt.onUserMediaSuccessTestUni():cn.debug("userAcceptOnIncomingScreenSharingCall is activated : need user accept"):$t===!0?(cn.log("processInvite() - callAlreadyExist"),xt.onUserMediaSuccessTestUni()):this.userAcceptOnIncomingCall===!0||this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("processInvite() - Waiting for call accept or refuse from user - 1"):(cn.log("processInvite() - userAcceptOnIncomingCall is not activated"),xt.onUserMediaSuccessTestUni()),nt.data!==void 0&&nt.data.subscribeOrder===!0||$t!==!1||this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,xt.callId,!1,yt,!1,nt.callType,!1,xt.remoteType,xt.destCallType)):(apiCC.userMediaStreamTable.length>0&&(Et=apiCC.userMediaStreamTable[0].userMediaStreamId),this.accessToLocalMedia!==!0&&!Et||this.autoAnswer!==!0?(xt.audioOnly===!0&&apiCC.mediaDeviceMgr.audioDevicePresent===!1?(cn.log("processInvite() - audio and video media are not transmitted"),xt.onUserMediaSuccessTestUni()):this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("Stand-by :: wait for getUserMediaOnCall && establishCall"):(cn.debug("processInvite() - call.getUserMediaOnCall()"),cn.log("processInvite() - this.autoAnswer :"+this.autoAnswer),xt.getUserMediaOnCall()),$t===!1&&this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,xt.callId,!1,yt,xt.audioOnly,nt.callType,!1,xt.remoteType,xt.destCallType)):(cn.log("processInvite() :: User has already granted access to local media and AutoAnswer activated : establishing call"),this.userAcceptOnIncomingCall===!0||this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("processInvite() - Waiting for call accept or refuse from user - 2"):Et?(cn.log("using First available stream on apiRTC"),(Lt=apiCC.getUserMediaStream(Et)).addCallInfo(xt.callId),xt.callConfiguration!==void 0&&xt.callConfiguration!==null||(xt.callConfiguration={}),xt.callConfiguration.userMediaStreamId=Lt.userMediaStreamId,xt.onUserMediaSuccessOnCall(Lt.stream)):xt.establishCall(),$t===!1&&this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,xt.callId,!0,yt,xt.audioOnly,nt.callType,!1,xt.remoteType,xt.destCallType)))},this.setRemoteDescriptionProcess=function(nt,Ct){this.preferSendingH264Codec&&(cn.log("Modification of SDP to set H264 as prefered sending codec"),Ct.sdp=this.mySDPManager.maybePreferCodec(Ct.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?nt.pc!==null?nt.pc.setRemoteDescription(Ct,nt.callback(nt,"onSetRemoteDescriptionSuccess"),nt.callback(nt,"onSetRemoteDescriptionFailure")):cn.debug("setRemoteDescriptionProcess - pc is null"):(cn.log("before setRemoteDescription - Promise version"),nt.pc!==null?nt.pc.setRemoteDescription(Ct).then(nt.callback(nt,"onSetRemoteDescriptionSuccess")).catch(nt.callback(nt,"onSetRemoteDescriptionFailure")):cn.debug("setRemoteDescriptionProcess - pc is null"))},this.process200OK=function(nt){var Ct,yt=null,xt=null;if(nt.data!==void 0&&nt.data.instanceId!==void 0?(cn.info("200OK received from callId :"+nt.calleeId+", intanceId is :"+nt.data.instanceId),yt=this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,nt.data.instanceId)):(cn.info("200OK received from callId :"+nt.calleeId),yt=this.findCallWithCallIdAndRemoteId(nt.callId,nt.calleeId)),yt===null)return cn.warn("200OK received but callId and instanceId are not matching, no process"),void this.myWebRTC_Event.createErrorEvent("200OK received but callId is not matching, no process","NOT_MATCHING_CALLID_ON_200OK");yt.calleeId=nt.calleeId,nt.sdpanswer&&nt.sdpanswer.type!=="no-answer"?yt.message200OKReceived===!1?(cn.debug("first 200OK for the call"),yt.message200OKReceived=!0,yt.data.type!=="subscribe"&&this.checkDestCallTypeWithSDP(nt.sdpanswer.sdp,yt),Ct=this.mySDPManager.createGuideline(nt.sdpanswer.sdp),yt.setLocalCallProfile(this.evalCallProfileWithSdpGuideline(Ct,nt.sdpanswer.sdp,"remote","send")),yt.setRemoteCallProfile(this.evalCallProfileWithSdpGuideline(Ct,nt.sdpanswer.sdp,"remote","receive")),this.evaluateVideoCap(yt),!this.rtpSenderSetParamatersCapable&&yt.videoCap&&(Ct.video.bandwidth=yt.videoCap,nt.sdpanswer.sdp=Ct.generate()),yt.receivedSdpOfferMessage=nt.sdpanswer,cn.log("process200OK : before setRemoteDescription"),xt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(nt.sdpanswer),this.videoRemoteBandwidth&&(cn.log("Modification of SDP to set remote video bandwidth"),xt.sdp=this.mySDPManager.setVideoBandwidth(xt.sdp,this.videoRemoteBandwidth)),this.setRemoteDescriptionProcess(yt,xt),nt.data!==null&&nt.data!==void 0&&(yt.data!==null&&yt.data!==void 0?yt.data=(0,lt.S6)(yt.data,nt.data):yt.data=nt.data)):cn.debug("200OK has already been received for this call, leaving process200OK"):Gn.createCallEstablishedEvent(yt.calleeId,yt.callType,yt.callId,yt.destCallType)},this.cleanStoredCallCandidate=function(nt,Ct){cn.debug("cleanStoredCallCandidate from callId :"+nt+", instanceId is :"+Ct),this.clientIncomingCandidatesQueue[nt+"-"+Ct]!==void 0&&this.clientIncomingCandidatesQueue[nt+"-"+Ct].length!==0&&(this.clientIncomingCandidatesQueue[nt+"-"+Ct].splice(0,this.clientIncomingCandidatesQueue[nt+"-"+Ct].length),delete this.clientIncomingCandidatesQueue[nt+"-"+Ct])},this.processCandidate=function(nt){var Ct=null,yt=nt.data&&nt.data.instanceId?nt.data.instanceId:null;cn.debug("Candidate received from callId :"+nt.callId+", instanceId is :"+yt),Ct=nt.callerId===this.clientId?yt?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,yt):this.findCallWithCallIdAndRemoteId(nt.callId,nt.calleeId):yt?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,yt):this.findCallWithCallIdAndRemoteId(nt.callId,nt.callerId),cn.trace("msg.label :"+nt.label),cn.log("msg.candidate :"+nt.candidate),Ct!==null?Ct.started&&Ct.remoteDescriptionSetted?Ct.processCandidateMsg(nt):(cn.log("Call not started or remoteDescription is not yet setted"),Ct.incomingcandidatesQueue.push(nt)):yt&&(cn.debug("Call not found, Candidate message is not handled, storing candidate message in client"),this.clientIncomingCandidatesQueue[nt.callId+"-"+yt]!==null&&this.clientIncomingCandidatesQueue[nt.callId+"-"+yt]!==void 0||(this.clientIncomingCandidatesQueue[nt.callId+"-"+yt]=[],cn.debug("First candidate for this call, starting a timeout before candidate storage cleaning"),setTimeout(this.cleanStoredCallCandidate.bind(this),this.cleanStoredCallCandidateTimer,nt.callId,yt)),this.clientIncomingCandidatesQueue[nt.callId+"-"+yt].push(nt))},this.processUpdate=function(nt){cn.info("Update message on:"+nt.roomId);var Ct,yt=null;if((yt=nt.callerId===this.clientId?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,nt.data.instanceId):this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,nt.data.instanceId))!==null)if(nt.hasOwnProperty("sdpoffer")&&nt.sdpoffer.hasOwnProperty("sdp"))yt.setRemoteCallProfile(this.evalCallProfileWithSdp(nt.sdpoffer.sdp,"remote","receive"),!0),yt.updateOngoingTimeoutId=setTimeout(function(){delete yt.updateOngoingTimeoutId},Yn),this.checkDestCallTypeWithSDP(nt.sdpoffer.sdp,yt),cn.log("processUpdate : before setRemoteDescription"),Ct=new apiCC.myWebRTC_Adapter.RTCSessionDescription(nt.sdpoffer),this.setRemoteDescriptionProcess(yt,Ct),yt.doUpdateAnswer();else if((0,lt.ki)(nt.data,"mesh","object")&&(nt.data.mesh.calleeCompositeUserId?nt.data.mesh.calleeCompositeUserId===this.compositeClientId:nt.data.mesh.calleeId===this.clientId)){cn.debug("mesh update from subscriber");var xt={};nt.data.mediaType==="AUDIOONLY"?xt.audioOnly=!0:nt.data.mediaType==="VIDEOONLY"&&(xt.videoOnly=!0),this.updateCallConfigurationOnCall(nt.callId,xt).then(function(){cn.debug("updateCallConfigurationOnCall OK")}).catch(function(wt){cn.error("updateCallConfigurationOnCall failed",wt)})}else cn.error("update without SDP offer");else this.myWebRTC_Event.createErrorEvent("Cannot find call to process Update","CALL_NOT_FOUND_ON_UPDATE")},this.process200Update=function(nt){cn.info("200 Update received from :"+nt.calleeId);var Ct,yt=null,xt=null;if((yt=nt.callerId===this.clientId?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,nt.data.instanceId):this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,nt.data.instanceId))===null)return cn.info("Call not found on 200 Update"),void this.myWebRTC_Event.createErrorEvent("Cannot find call to process 200 Update","CALL_NOT_FOUND_ON_200UPDATE");yt.calleeId=nt.calleeId,Ct=this.mySDPManager.createGuideline(nt.sdpanswer.sdp),yt.setLocalCallProfile(this.evalCallProfileWithSdpGuideline(Ct,nt.sdpanswer.sdp,"remote","send"),!0),yt.setRemoteCallProfile(this.evalCallProfileWithSdpGuideline(Ct,nt.sdpanswer.sdp,"remote","receive"),!0),this.evaluateVideoCap(yt),!this.rtpSenderSetParamatersCapable&&yt.videoCap&&(Ct.video.bandwidth=yt.videoCap,nt.sdpanswer.sdp=Ct.generate()),cn.log("process200Update : before setRemoteDescription"),xt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(nt.sdpanswer),this.videoBandwidth&&(cn.log("Modification of SDP to set remote video bandwidth"),xt.sdp=this.mySDPManager.setVideoBandwidth(xt.sdp,this.videoBandwidth)),this.setRemoteDescriptionProcess(yt,xt),cn.log("msg.sdpanswer.sdp :",nt.sdpanswer.sdp),yt.addingUserMedia===!0&&(yt.addingUserMedia=!1),yt.updateUserMedia===!0&&(yt.updateUserMedia=!1),yt.updateCause&&(yt.updateCause=null)},this.processSlowLink=function(nt,Ct){for(var yt=this.callsTable.length,xt=null;--yt>=0;)if(this.callsTable[yt].callId===nt){xt=this.callsTable[yt];break}if(xt!==null){var wt=null;Ct&&Ct.advice&&(wt=Ct.advice),this.myWebRTC_Event.createSlowLinkEvent(xt.callId,wt)}},this.processAudioAmplitude=function(nt,Ct){Gn.createAudioAmplitudeEvent(nt.descriptor.audioAmplitude,Ct,nt.callId,nt.descriptor.streamID)},this.processDistantIceError=function(nt){nt.descriptor.iceState==="disconnected"?this.myWebRTC_Event.createErrorEvent("distant iceDisconnection detected","DISTANT_ICE_CONNECTION_STATE_DISCONNECTED",null,nt.roomId,null,nt.descriptor):nt.descriptor.iceState==="failed"&&Gn.createErrorEvent("distant iceConnection failed detected","DISTANT_ICE_CONNECTION_STATE_FAILED",null,nt.roomId,null,nt.descriptor)},this.processStreamTrackMuteChanged=function(nt,Ct,yt){for(var xt=this.callsTable.length,wt=null,Lt=[],Et={},$t={};--xt>=0;)if(this.callsTable[xt].callId===nt){wt=this.callsTable[xt];break}wt!==null&&(Ct==="audio"?(wt.isRemoteAudioMuted=yt,Lt.push("audioIsMuted"),Et.available=wt.remoteCallProfile.audio,Et.active=wt.remoteCallProfile.audioActive,Et.muted=wt.isRemoteAudioMuted,Et.silent=wt.isRemoteAudioSilent,$t.available=wt.remoteCallProfile.video,$t.active=wt.remoteCallProfile.videoActive,$t.muted=wt.isRemoteVideoMuted,$t.silent=wt.isRemoteVideoSilent):Ct==="video"&&(wt.isRemoteVideoMuted=yt,Lt.push("videoIsMuted"),Et.available=wt.remoteCallProfile.audio,Et.active=wt.remoteCallProfile.audioActive,Et.muted=wt.isRemoteAudioMuted,Et.silent=wt.isRemoteAudioSilent,$t.available=wt.remoteCallProfile.video,$t.active=wt.remoteCallProfile.videoActive,$t.muted=wt.isRemoteVideoMuted,$t.silent=wt.isRemoteVideoSilent),Lt.length>0&&this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Lt,Et,$t,wt.destCallType,wt.callId,"userAction"))},this.processStreamTrackStatusChanged=function(nt,Ct,yt){for(var xt=this.callsTable.length,wt=null,Lt=[],Et={},$t={};--xt>=0;)if(this.callsTable[xt].callId===nt){wt=this.callsTable[xt];break}wt!==null&&(Ct==="audio"?(wt.isRemoteAudioSilent=yt,Lt.push("audioIsSilent"),Et.available=wt.remoteCallProfile.audio,Et.active=wt.remoteCallProfile.audioActive,Et.muted=wt.isRemoteAudioMuted,Et.silent=wt.isRemoteAudioSilent,$t.available=wt.remoteCallProfile.video,$t.active=wt.remoteCallProfile.videoActive,$t.muted=wt.isRemoteVideoMuted,$t.silent=wt.isRemoteVideoSilent):Ct==="video"&&(wt.isRemoteVideoSilent=yt,Lt.push("videoIsSilent"),Et.available=wt.remoteCallProfile.audio,Et.active=wt.remoteCallProfile.audioActive,Et.muted=wt.isRemoteAudioMuted,Et.silent=wt.isRemoteAudioSilent,$t.available=wt.remoteCallProfile.video,$t.active=wt.remoteCallProfile.videoActive,$t.muted=wt.isRemoteVideoMuted,$t.silent=wt.isRemoteVideoSilent),Lt.length>0&&this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Lt,Et,$t,wt.destCallType,wt.callId,"userAction"))},this.processUpdateStream=function(nt,Ct,yt){for(var xt=this.callsTable.length,wt=null;--xt>=0;)if((0,lt.ki)(this.callsTable[xt].data,"mesh","object")&&this.callsTable[xt].data.mesh.calleeCallId===nt||this.callsTable[xt].callId===nt){wt=this.callsTable[xt];break}if(!wt)return!1;var Lt=!1;return Ct==="audio"?yt==="inactive"?wt.callType==="media"&&(wt.callType="videoOnly",wt.updateUserMedia=!0,wt.updateCause="adaptation",wt.audioSdpDirection="inactive",wt.establishCall(),Lt=!0):wt.callType==="videoOnly"&&(wt.callType="media",wt.updateUserMedia=!0,wt.updateCause="adaptation",wt.audioSdpDirection=null,wt.establishCall(),Lt=!0):Ct==="video"&&(yt==="inactive"?wt.callType==="media"&&(this.evalOutgoingVideoBandwithCap(wt),wt.callType="audio",wt.updateUserMedia=!0,wt.updateCause="adaptation",wt.videoSdpDirection="inactive",wt.establishCall(),Lt=!0):wt.callType==="audio"&&(this.evalOutgoingVideoBandwithCap(wt),wt.callType="media",wt.updateUserMedia=!0,wt.updateCause="adaptation",wt.videoSdpDirection=null,wt.establishCall(),Lt=!0)),Lt},this.processUpdateVideoQuality=function(nt,Ct){cn.debug("processUpdateVideoQuality",nt,Ct);var yt=this.findCallWithCallId(nt);if(yt)if(yt.sessionMCU&&yt.sessionMCU.roomMode!=="mesh"){var xt=apiCC.getUserMediaStream(yt.callConfiguration.userMediaStreamId);if(xt){var wt=xt.getVideoTrack();if(wt){var Lt={};Ct.width&&Ct.height&&(Lt.width=Ct.width,Lt.height=Ct.height),Ct.frameRate&&(Lt.frameRate=Ct.frameRate),wt.applyConstraints(Lt).then(function(Et){cn.debug("processUpdateVideoQuality - applyConstraints; OK")}).catch(function(Et){cn.error("processUpdateVideoQuality - applyConstraints",Et)})}else cn.warn("processUpdateVideoQuality - no such video track; callId:",nt)}else cn.warn("processUpdateVideoQuality - no such userMediaStream; callId:",nt)}else cn.warn("processUpdateVideoQuality - wrong roomMode; callId:",nt);else cn.warn("processUpdateVideoQuality - no such call; callId:",nt)},this.removeAllCallsFromRoom=function(nt,Ct){cn.info("removeAllCallsFromRoom :"+nt+" with reason :"+Ct);var yt,xt,wt=this.callsTable.length,Lt=[],Et={};for(yt=0;yt<wt;yt+=1)this.callsTable[yt].dest_roomId==nt&&(cn.log("Call is attached to the room, removing ..."),Et={callId:this.callsTable[yt].callId},Lt.push(Et));for(xt=0;xt<Lt.length;xt+=1)this.removeCallFromTableWithCallIdAndSendBye(Lt[xt].callId,Ct);Lt.splice(0,Lt.length)},this.onHangup=function(nt,Ct){var yt=null,xt=null,wt=null,Lt=null,Et=[],$t=!1,Jt=!1,en=null,qt=null;if(nt?typeof nt!="string"&&(nt=String(nt)):nt=null,Ct?typeof Ct!="string"&&(Ct=null):Ct=null,cn.info("Hanging up."),nt===null)cn.log("Leaving all calls that are established"),this.MCUClient&&this.MCUClient.meshOnHangup(),this.removeAllCalls(),this.callControlTable.splice(0,this.callControlTable.length);else if((xt=this.findUserMediaById(nt))!==null){for(this.MCUClient.pubConnector!=="janusConnector"||Ct!=="RTC_Setup_Timeout"&&Ct!=="disconnected"||(wt=xt.getUserMediaStream())&&wt.stream&&($t=!0,en=wt.stream,xt.streamStolen=!0,xt.sessionMCU.roomMode==="mesh"?Jt=!0:(qt=wt.getCallInfo(xt.userMediaId))&&(qt.flavor="call")),Lt=this.callsTable.length;--Lt>=0;)(0,lt.Ym)(this.callsTable[Lt].data,"object")&&(0,lt.Ym)(this.callsTable[Lt].data.mesh,"object")&&this.callsTable[Lt].data.mesh.calleeCallId===nt&&Et.push(this.callsTable[Lt].callId);for(Lt=Et.length;--Lt>=0;)this.removeCallFromTableWithCallIdAndSendBye(Et[Lt],Ct);this.MCUClient.meshOnHangup(nt,null,{restart:$t})}else(yt=this.findCallWithCallId(nt))!==null&&(this.MCUClient.pubConnector!=="janusConnector"||Ct!=="RTC_Setup_Timeout"&&Ct!=="disconnected"||(yt.settingUpType==="publish"||yt.settingUpType==="shareScreen"?yt.data&&yt.data.mesh||($t=!0,yt.streamStolen=!0):yt.settingUpType==="subscribe"&&($t=!0)),cn.log("Leaving call with callId :"+nt),this.removeCallFromTableWithCallIdAndSendBye(nt,Ct));$t===!0?yt!==null?this.restartCall(yt):xt&&(Jt===!0?this.restartCall(xt,{userMedia:!0,mesh:!0}):this.restartCall(xt,{userMedia:!0,stream:en})):(yt&&yt.callControl&&this.destroyCallControl(yt.callControl),this.stopMaxCallRetriesTimer(nt),this.stopRestartCallTimer(nt),delete this.callsRetriesTable[nt])},this.stopStream=function(nt){cn.info("stopStream in client");var Ct,yt=null;if(ot.Xh==="Chrome"&&ot.PR<45||ot.Xh==="Firefox"&&ot.PR<44||ot.Xh==="Opera"&&ot.PR<34||ot.Xh==="Chromium"&&ot.PR<44||ot.Xh==="Chrome WebView"&&ot.PR<45)nt.onended=null,nt.stop();else{for(nt.onended=null,cn.log("MediaStream.stop is now deprecated, using MediaStreamTrack.stop"),yt=nt.getTracks(),Ct=0;Ct<yt.length;Ct+=1)yt[Ct].onended=null,yt[Ct].stop();cn.log("... tracks stopped")}nt=null},this.clearCallTimeouts=function(nt){var Ct;for(cn.debug("clearCallTimeouts"),nt.send200OKTrickleIceFalseTimeOutId!==0&&(cn.debug("clearing send200OKTrickleIceFalseTimeOutId"),clearTimeout(nt.send200OKTrickleIceFalseTimeOutId),nt.send200OKTrickleIceFalseTimeOutId=0),nt.sendInviteTrickleIceFalseTimeOutId!==0&&(cn.debug("clearing sendInviteTrickleIceFalseTimeOutId"),clearTimeout(nt.sendInviteTrickleIceFalseTimeOutId),nt.sendInviteTrickleIceFalseTimeOutId=0),nt.disconnectionTimeoutId!==0&&(cn.debug("clearing disconnectionTimeout"),clearTimeout(nt.disconnectionTimeoutId),nt.disconnectionTimeoutId=0),nt.disconnectionWarningInterval!==0&&(cn.debug("clearing disconnectionWarningInterval"),clearInterval(nt.disconnectionWarningInterval),nt.disconnectionWarningInterval=0),Ct=0;Ct<nt.checkCandidateTypesTimeoutTable.length;Ct+=1)cn.debug("clearing checkCandidateTypesTimeout :",nt.checkCandidateTypesTimeoutTable[Ct]),clearTimeout(nt.checkCandidateTypesTimeoutTable[Ct]);nt.checkCandidateTypesTimeoutTable.splice(0,nt.checkCandidateTypesTimeoutTable.length)},this.removeAllCalls=function(){cn.info("removeAllCalls");var nt,Ct=this.callsTable.length,yt=0,xt=null,wt=0,Lt=null;for(cn.log("callsNumber = "+Ct),nt=0;nt<Ct;nt+=1){if(yt=this.callsTable[nt-wt].callee?this.callsTable[nt-wt].callerId:this.callsTable[nt-wt].calleeId,this.callsTable[nt-wt].callee===!0)xt="Hangup_From_Callee",this.callsTable[nt-wt].myWebRTC_Stack.sendBye(this.callsTable[nt-wt].callId,this.clientId,this.callsTable[nt-wt].dest_roomId,yt,xt,this.callsTable[nt-wt].data);else{if(xt="Hangup_From_Caller",this.callsTable[nt-wt].inviteSended!==!0){this.callsTable[nt-wt].callCancelled=!0,cn.warn("Leaving call iteration on removeAllCalls");continue}this.callsTable[nt-wt].myWebRTC_Stack.sendBye(this.callsTable[nt-wt].callId,this.clientId,this.callsTable[nt-wt].dest_roomId,yt,xt,this.callsTable[nt-wt].data)}(0,lt.ki)(this.callsTable[nt-wt].sessionMCU,"roomName","string")&&(0,lt.ki)(this.callsTable[nt-wt].data,"MCUType","string")&&(this.callsTable[nt-wt].data.MCUType==="MCU-Caller"||this.callsTable[nt-wt].data.MCUType==="MCU-Callee")&&this.MCUClient.leaveSession(this.callsTable[nt-wt].sessionMCU.roomName,{noHangup:!0}),this.callsTable[nt-wt].callConfiguration&&this.callsTable[nt-wt].callConfiguration.userMediaStreamId&&(Lt=apiCC.getUserMediaStream(this.callsTable[nt-wt].callConfiguration.userMediaStreamId))&&apiCC.releaseUserMediaStream(Lt.userMediaStreamId,this.callsTable[nt-wt].callId),this.callsTable[nt-wt].screenStream!==null&&(cn.log("stopping screenStream"),this.stopStream(this.callsTable[nt-wt].screenStream),Gn.createUserMediaStopEvent(this.callsTable[nt-wt].callId,"screen")),this.callsTable[nt-wt].pc!==null&&(cn.log("Closing PC"),this.qosEnable&&this.callsTable[nt-wt].qm!==void 0&&this.callsTable[nt-wt].qm!==null&&typeof this.callsTable[nt-wt].qm.saveStatsToDb=="function"&&(this.callsTable[nt-wt].qm.saveStatsToDb(!0),clearInterval(this.callsTable[nt-wt].statisticId)),this.callsTable[nt-wt].csmIntervalId&&clearInterval(this.callsTable[nt-wt].csmIntervalId),this.callsTable[nt-wt].pc.close(),this.callsTable[nt-wt].pc=null),this.myWebRTC_Event.createHangupEvent("local",this.clientId,this.callsTable[nt-wt].remoteId,!0,xt,this.callsTable[nt-wt].callId,this.callsTable[nt-wt].callType),this.callsTable[nt-wt].data!==void 0&&this.callsTable[nt-wt].data!==null&&(this.callsTable[nt-wt].data.pubSub==="janusConnector"||this.callsTable[nt-wt].data.MCUType!=="MCU-Caller"&&this.callsTable[nt-wt].data.MCUType!=="MCU-Callee"||this.myWebRTC_Event.createRecordedStreamsAvailableEvent(this.callsTable[nt-wt].data.confId,this.callsTable[nt-wt].callerId,this.callsTable[nt-wt].calleeId,this.callsTable[nt-wt].callId)),this.clearCallTimeouts(this.callsTable[nt-wt]),this.callsTable[nt-wt].incomingcandidatesQueue.length!==0&&this.callsTable[nt-wt].incomingcandidatesQueue.splice(0,this.callsTable[nt-wt].incomingcandidatesQueue.length),this.clientIncomingCandidatesQueue[this.callsTable[nt-wt].callId+"-"+this.callsTable[nt-wt].instanceId]!==void 0&&this.clientIncomingCandidatesQueue[this.callsTable[nt-wt].callId+"-"+this.callsTable[nt-wt].instanceId].length!==0&&this.clientIncomingCandidatesQueue[this.callsTable[nt-wt].callId+"-"+this.callsTable[nt-wt].instanceId].splice(0,this.clientIncomingCandidatesQueue[this.callsTable[nt-wt].callId+"-"+this.callsTable[nt-wt].instanceId].length),cn.log("Removing call from table"),this.callsTable.splice(nt-wt,1),wt+=1}},this.onRemoteHangup=function(nt,Ct,yt,xt,wt,Lt){var Et=this;cn.debug("onRemoteHangup");var $t=null,Jt=null,en=null,qt=null,on=!1,hn=!1,nn=!1,dn=null,Sn=null;if(cn.log("callId :"+nt),cn.log("confId :"+wt),this.MCUClient.pubConnector==="janusConnector")if(xt==="RTC_Setup_Timeout"||xt==="Broken_by_MCU"||xt==="disconnected")if((Jt=Lt==null?this.findCallWithCallId(nt):this.findCallWithCallIdAndInstanceId(nt,Lt.instanceId))!=null){if(Jt.setupTimeoutId&&(clearTimeout(Jt.setupTimeoutId),delete Jt.setupTimeoutId),Jt.restarting===!0)return void cn.debug("call restarting");if(Jt.settingUpType==="publish"||Jt.settingUpType==="shareScreen"?Jt.data&&Jt.data.mesh||(on=!0,Jt.streamStolen=!0):Jt.settingUpType==="subscribe"&&(on=!0),Jt.sessionMCU!==null&&Jt.sessionMCU.modeChangeKind==="old")return void cn.debug("onRemoteHangup ignore")}else(en=this.findUserMediaById(nt))!==null?(en.close(),(qt=en.getUserMediaStream())&&qt.stream&&(en.sessionMCU!==null&&en.sessionMCU.modeChangeKind==="old"?(on=!0,dn=qt.stream,en.streamStolen=!0,en.distantCalls.length>0&&(nn=!0),(Sn=qt.getCallInfo(en.userMediaId))&&(Sn.flavor="call")):en.sessionMCU!==null&&en.sessionMCU.roomMode==="mesh"?(on=!0,hn=!0,dn=qt.stream,en.streamStolen=!0):(on=!0,dn=qt.stream,en.streamStolen=!0,(Sn=qt.getCallInfo(en.userMediaId))&&(Sn.flavor="call")))):cn.debug("No call and no userMedia found");else(Jt=Lt==null?this.findCallWithCallId(nt):this.findCallWithCallIdAndInstanceId(nt,Lt.instanceId))?(Jt.setupTimeoutId&&(clearTimeout(Jt.setupTimeoutId),delete Jt.setupTimeoutId),Jt.settingUpType==="subscribe"&&xt!=="Ejected"&&(on=!0)):(en=this.findUserMediaById(nt))&&en.close();if(!nn)if(en!==null){var wn=null,En=[];for(wn=this.callsTable.length;--wn>=0;)(0,lt.ki)(this.callsTable[wn].data,"mesh","object")&&this.callsTable[wn].data.mesh.calleeCallId===nt&&this.callsTable[wn].settingUpType!=="subscribe"&&En.push(this.callsTable[wn].callId);for(wn=En.length;--wn>=0;)this.removeCallFromTableWithCallIdAndSendBye(En[wn],xt);if(this.MCUClient.meshOnHangup(nt),en.sessionMCU.modeChangeKind==="old"){var Pn=this.MCUClient.getSessionMCU(null,{callback:function(Wn){return Wn.roomName===en.sessionMCU.roomName&&Wn.modeChangeKind==="new"}});Pn&&this.finalizeMeshToJanusTransition(en.sessionMCU,Pn)}}else nt!==void 0?$t=Lt==null?this.removeCallFromTableWithCallIdandRemoteId(nt,Ct,xt):this.removeCallFromTableWithCallIdandInstanceId(nt,Lt.instanceId,xt):wt!==void 0&&($t=this.removeCallFromTableWithConfIdandRemoteId(wt,Ct,xt));cn.log("Reason : "+xt),Jt&&on!==!0?this.callsTable.length===0&&this.userMediaTable.length===0?(cn.log("No more established calls for client"),this.myWebRTC_Event.createRemoteHangupEvent(this.clientId,Ct,!0,xt),this.myWebRTC_Event.createHangupEvent("remote",this.clientId,Ct,!0,xt,nt,$t),this.getUserMediaOnGoing===!0&&Kt.deactivateReloadOnCancel!==!0&&(cn.log("Cancel from Remote"),typeof apiRTC_React>"u"&&location.reload(),this.getUserMediaOnGoing=!1)):(cn.log("Other calls are still established"),this.myWebRTC_Event.createRemoteHangupEvent(this.clientId,Ct,!1,xt),this.myWebRTC_Event.createHangupEvent("remote",this.clientId,Ct,!1,xt,nt,$t)):Jt&&Jt.settingUpType==="subscribe"&&(this.myWebRTC_Event.createRemoteHangupEvent(this.clientId,Ct,!1,"restarted"),this.myWebRTC_Event.createHangupEvent("remote",this.clientId,Ct,!1,"restarted",nt,$t)),Lt!=null&&(this.MCUClient.pubConnector==="janusConnector"||Lt.MCUType!=="MCU-Caller"&&Lt.MCUType!=="MCU-Callee"||this.myWebRTC_Event.createRecordedStreamsAvailableEvent(wt,this.clientId,Ct,nt)),on===!0?Jt!==null?this.restartCall(Jt):en&&(hn===!0?this.restartCall(en,{userMedia:!0,mesh:!0}):this.randomDelayOnRestart?(cn.debug("onRemoteHangup - randomDelayOnRestart"),setTimeout(function(){Et.restartCall(en,{userMedia:!0,stream:dn})},5e3*Math.random())):this.restartCall(en,{userMedia:!0,stream:dn})):(Jt&&Jt.callControl&&this.destroyCallControl(Jt.callControl),(Jt||en)&&(this.stopMaxCallRetriesTimer(nt),this.stopRestartCallTimer(nt),delete this.callsRetriesTable[nt]))},this.startMaxCallRetriesTimer=function(nt){var Ct=this;cn.debug("startMaxCallRetriesTimer for callIdWhenStartingTimer :",nt);var yt=setTimeout(function(){cn.debug("[restartCall] MaxCallRetriesTimer reached for callIdWhenStartingTimer :",nt),Ct.callsRetriesTable[nt].allowedStatus=!1,delete Ct.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId},this.maxCallsRetriesDuration);this.callsRetriesTable[nt]={},this.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId=yt},this.stopMaxCallRetriesTimer=function(nt){cn.debug("stopMaxCallRetriesTimer for callId :",nt),this.callsRetriesTable[nt]!==void 0&&this.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId!==void 0&&(clearTimeout(this.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId),cn.debug("[restartCall] MaxCallRetriesTimer cleared for callId :",nt),delete this.callsRetriesTable[nt])},this.stopRestartCallTimer=function(nt){cn.debug("stopRestartCallTimer for callId :",nt),this.callsRetriesTable[nt]!==void 0&&this.callsRetriesTable[nt].restartCallTimeOutId!==void 0&&(clearTimeout(this.callsRetriesTable[nt].restartCallTimeOutId),cn.error("[restartCall] RestartCallTimer cleared for callId :",nt),delete this.callsRetriesTable[nt].restartCallTimeOutId)},this.restartCall=function(nt){var Ct=this,yt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cn.debug("[restartCall] restartCall for callId :",nt.callId);var xt=-1;if(yt.userMedia!==!0)if(nt.callControl&&nt.callControl.autoRestart)if((xt=nt.callControl.autoRestart.counter)===0&&(nt.callControl.autoRestart.callIdWhenStartingTimer=nt.callId,this.startMaxCallRetriesTimer(nt.callId)),this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer]!==void 0&&this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].allowedStatus===void 0){cn.debug("[restartCall] ... for callIdWhenStartingTimer :",nt.callControl.autoRestart.callIdWhenStartingTimer),cn.debug("AutoRestartCounter :",xt),cn.debug("Calling restartCallProcess in :",this.restartCallDelay*Math.pow(2,xt));var wt=setTimeout(function(){cn.debug("Timer reached for restartCall"),delete nt.callControl.autoRestart.pending,Ct.restartCallProcess(nt,yt),Ct.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer]!==void 0&&Ct.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].restartCallTimeOutId!==void 0&&delete Ct.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].restartCallTimeOutId},this.restartCallDelay*Math.pow(2,xt));nt.callControl.autoRestart.pending=!0,this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].restartCallTimeOutId=wt}else cn.warn("CALL_ABORTED, retries not allowed (maxCallsRetriesDuration reached) for callIdWhenStartingTimer :",nt.callControl.autoRestart.callIdWhenStartingTimer),this.destroyCallControl(nt.callControl),Gn.createErrorEvent("call aborted after calls retries (maxCallsRetriesDuration reached)","CALL_ABORTED",nt.callId,nt.callControl.roomName),this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer]!==void 0&&delete this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer];else cn.debug("[restartCall] autoRestart options not defined");else this.restartCallProcess(nt,yt)},this.restartCallProcess=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cn.debug("restartCallProcess ");var yt=!1,xt=!1,wt=null;if(nt.restarting!==!0){if(nt.restarting=!0,Ct.userMedia===!0&&(yt=!0),Ct.mesh===!0&&(xt=!0),yt===!0)if(xt===!0)nt.callType==="screenSharing"||nt.callType==="screenSharingWithAudio"?(nt.restarting=!1,this.userMediaTable.push(nt),this.MCUClient.meshOnScreenMediaSuccess(nt)):(nt.restarting=!1,this.userMediaTable.push(nt),this.MCUClient.meshOnUserMediaSuccess(nt));else if(nt.callType==="screenSharing"||nt.callType==="screenSharingWithAudio"){delete nt.data.meshPublish,nt.data.type="publish";var Lt=this.createCallControl({type:"shareScreen",callId:nt.userMediaId,roomName:nt.roomId,callConfiguration:nt.callConfiguration,data:nt.data});Lt.captureSourceType=nt.captureSourceType,Lt.autoRestart.counter=0,Lt.autoRestart.stream=Ct.stream,this.shareScreen(nt.roomId,nt.data,nt.captureSourceType,nt.callConfiguration,{callControl:Lt}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,nt.userMediaId,nt.userMediaId,"publish",this.clientId,nt.roomId,nt.roomId,null)}else{delete nt.data.meshPublish;var Et=this.createCallControl({type:"publish",callId:nt.userMediaId,callType:nt.callType,roomName:nt.roomId,callConfiguration:nt.callConfiguration,data:nt.data});Et.audioOnly=nt.callType==="audio",Et.sessionId=nt.sessionId,Et.token=nt.token,Et.autoRestart.counter=0,Et.autoRestart.stream=Ct.stream,this.MCUClient.publish(nt.roomId,nt.sessionId,nt.token,nt.callConfiguration,nt.data,{callControl:Et}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.callType==="audio",nt.userMediaId,nt.userMediaId,"publish",this.clientId,nt.roomId,nt.roomId,null)}else if(nt.settingUpType==="publish")(0,lt.Ym)(nt.callControl,"object")?(cn.debug("[restartCall] restarting call publish"),this.MCUClient.publish(nt.callControl.roomName,nt.callControl.sessionId,nt.callControl.token,nt.callControl.callConfiguration,nt.callControl.data,{callControl:nt.callControl}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,nt.callId,nt.callId,"publish",this.clientId,nt.callControl.roomName,nt.callControl.roomName,null)):cn.warn("[restartCall] cannot auto restart; missing info");else if(nt.settingUpType==="shareScreen")(0,lt.Ym)(nt.callControl,"object")?(cn.debug("[restartCall] restarting call shareScreen"),this.shareScreen(nt.callControl.roomName,nt.callControl.data,nt.callControl.captureSourceType,nt.callControl.callConfiguration,{callControl:nt.callControl}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,nt.callId,nt.callId,"publish",this.clientId,nt.callControl.roomName,nt.callControl.roomName,null)):cn.warn("[restartCall] cannot auto restart; missing info");else if(nt.settingUpType==="subscribe"&&(cn.debug("[restartCall] restarting call subscribe"),wt=nt.mcuRemoteStream.replay===!0?this.MCUClient.getStreamOfUserCall(nt.mcuRemoteStream.attributes.callerId,nt.mcuRemoteStream.attributes.callId,{replay:!0}):this.MCUClient.getStreamOfUserCall(nt.mcuRemoteStream.attributes.callerId,nt.mcuRemoteStream.attributes.callId),(0,lt.Ym)(nt.callControl,"object")&&wt)){cn.debug("[restartCall] stream exists, subscribing to it");var $t=!!nt.callControl.autoRestart.force;delete nt.callControl.autoRestart.force;var Jt=nt.callControl.callId,en=this.MCUClient.subscribeToStreams([wt],nt.callControl.mediaType,nt.callControl.data,nt.callControl.callConfiguration,{noStreamCheck:!0,autoSub:!0,force:$t});Jt&&en[0]&&this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,Jt,en[0],"subscribe",this.clientId,nt.callControl.roomName,nt.callControl.roomName,wt.id)}}else cn.debug("[restartCall] call already restarting")},this.closingCallProcess=function(nt,Ct){cn.log("Session terminated.");var yt=null;(0,lt.ki)(this.callsTable[nt].sessionMCU,"roomName","string")&&(0,lt.ki)(this.callsTable[nt].data,"MCUType","string")&&(this.callsTable[nt].data.MCUType==="MCU-Caller"||this.callsTable[nt].data.MCUType==="MCU-Callee")&&this.MCUClient.leaveSession(this.callsTable[nt].sessionMCU.roomName),this.callsTable[nt].callConfiguration&&this.callsTable[nt].callConfiguration.userMediaStreamId&&this.callsTable[nt].streamStolen!==!0&&(yt=apiCC.getUserMediaStream(this.callsTable[nt].callConfiguration.userMediaStreamId))&&apiCC.releaseUserMediaStream(yt.userMediaStreamId,this.callsTable[nt].callId),this.callsTable[nt].screenStream!==null&&(cn.log("stopping screenStream"),this.stopStream(this.callsTable[nt].screenStream),Gn.createUserMediaStopEvent(this.callsTable[nt].callId,"screen")),this.callsTable[nt].pc!==null&&(cn.log("Closing PC"),this.qosEnable&&this.callsTable[nt].qm!==void 0&&this.callsTable[nt].qm!==null&&typeof this.callsTable[nt].qm.saveStatsToDb=="function"&&(this.callsTable[nt].qm.saveStatsToDb(!0),clearInterval(this.callsTable[nt].statisticId)),this.callsTable[nt].csmIntervalId&&clearInterval(this.callsTable[nt].csmIntervalId),this.callsTable[nt].beginTimeoutId&&(clearTimeout(this.callsTable[nt].beginTimeoutId),delete this.callsTable[nt].beginTimeoutId),this.callsTable[nt].dcfs?Ct==="Ice_failed"?this.callsTable[nt].dcfs.failure="iceFailed":this.callsTable[nt].dcfs.canceled=!0:this.callsTable[nt].callType==="data"&&this.callsTable[nt].calleeId==="dataChannelConnector"&&(this.callsTable[nt].failure||this.callsTable[nt].success||setTimeout(function(xt,wt){Gn.createEvent({eventType:"onFileSended",callId:xt.callId,remoteId:xt.remoteId,name:xt.data.filename,error:wt}),xt.callbacks&&xt.callbacks.failure&&xt.callbacks.failure(wt)},0,this.callsTable[nt],Ct==="Ice_failed"?"iceFailed":"canceled")),this.callsTable[nt].pc.close(),this.callsTable[nt].pc=null)},this.removeCallProcess=function(nt){var Ct=this,yt=this.callsTable[nt];this.clearCallTimeouts(yt),yt.incomingcandidatesQueue.length!==0&&yt.incomingcandidatesQueue.splice(0,yt.incomingcandidatesQueue.length),this.clientIncomingCandidatesQueue[yt.callId+"-"+yt.instanceId]!==void 0&&this.clientIncomingCandidatesQueue[yt.callId+"-"+yt.instanceId].length!==0&&this.clientIncomingCandidatesQueue[yt.callId+"-"+yt.instanceId].splice(0,this.clientIncomingCandidatesQueue[yt.callId+"-"+yt.instanceId].length),cn.log("Removing call from table"),this.callsTable.splice(nt,1),cn.log("this.callsTable.length :",this.callsTable.length),cn.log("Call is terminated"),setTimeout(function(){Ct.startNextPushData()}),this.evalOutgoingVideoBandwithCap()},this.removeCallFromTableWithCallIdAndSendBye=function(nt,Ct){cn.debug("removeCallFromTableWithCallIdAndSendBye()",nt);var yt,xt=null;if((yt=this.findCallIndexWithCallId(nt))!==-1){if(this.closingCallProcess(yt,Ct),this.callsTable[yt].callId,this.callsTable[yt].calleeId,this.callsTable[yt].callee?(xt=this.callsTable[yt].callerId,Ct===null&&(Ct="Hangup_From_Callee")):(xt=this.callsTable[yt].calleeId,Ct===null&&(Ct="Hangup_From_Caller")),cn.log("reason is :"+Ct),this.callsTable[yt].calleeId!=="LOCAL"&&apiCC.session!==null){var wt=apiCC.session.getConnectedUserInfo(this.callsTable[yt].calleeId,"userData"),Lt=null;if(wt!=="User_Not_Found")try{Lt=JSON.parse(wt)}catch{cn.error("userInfo parse fail",wt)}Lt!=null&&Lt.isSimulated==="true"?apiCC.session.channel.socket.emit("simulatedAgentCancelCallRequest",{number:this.callsTable[yt].calleeId,callId:nt}):this.callsTable[yt].myWebRTC_Stack.sendBye(this.callsTable[yt].callId,this.clientId,this.callsTable[yt].dest_roomId,xt,Ct,this.callsTable[yt].data)}Ct!=="Broken_by_MCU"&&this.myWebRTC_Event.createHangupEvent("local",this.clientId,this.callsTable[yt].remoteId,!0,Ct,this.callsTable[yt].callId,this.callsTable[yt].callType),this.callsTable[yt].data!==void 0&&this.callsTable[yt].data!==null&&(this.callsTable[yt].data.pubSub==="janusConnector"||this.callsTable[yt].data.MCUType!=="MCU-Caller"&&this.callsTable[yt].data.MCUType!=="MCU-Callee"||this.myWebRTC_Event.createRecordedStreamsAvailableEvent(this.callsTable[yt].data.confId,this.callsTable[yt].callerId,this.callsTable[yt].calleeId,this.callsTable[yt].callId)),this.removeCallProcess(yt)}else cn.log("No call removed");this.MCUClient.publishCallId===nt&&(this.publishCallId=null)},this.removeCall=function(nt){cn.info("removeCall");var Ct=null;return nt!==-1?(this.closingCallProcess(nt,null),this.callsTable[nt].disconnectionWarningTimeout!==0&&(cn.debug("clearing disconnectionWarningTimeout"),clearTimeout(this.callsTable[nt].disconnectionWarningTimeout),this.callsTable[nt].disconnectionWarningTimeout=0),Ct=this.callsTable[nt].callType,this.removeCallProcess(nt)):cn.debug("No call removed"),Ct},this.removeCallFromTableWithConfIdandRemoteId=function(nt,Ct,yt){var xt;return cn.debug("removeCallFromTableWithConfIdandRemoteId() with reason :"+yt),yt=null,xt=this.findCallIndexWithConfIdAndRemoteId(nt,Ct),this.removeCall(xt)},this.removeCallFromTableWithCallIdandRemoteId=function(nt,Ct,yt){var xt;return cn.debug("removeCallFromTableWithCallIdandRemoteId() with reason :"+yt),cn.log("callId :"+nt),cn.log("remoteId :"+Ct),yt=null,xt=this.findCallIndexWithCallIdAndRemoteId(nt,Ct),this.removeCall(xt)},this.removeCallFromTableWithCallIdandInstanceId=function(nt,Ct,yt){var xt;return cn.debug("removeCallFromTableWithCallIdandInstanceId() with reason :"+yt),cn.log("callId :"+nt),cn.log("instanceId :"+Ct),yt=null,xt=this.findCallIndexWithCallIdAndInstanceId(nt,Ct),this.removeCall(xt)},this.toggleVideoMute=function(nt){cn.debug("toggleVideoMute");var Ct,yt,xt=this.callsTable.length,wt=null,Lt=null;if(nt==null){for(cn.debug("no callId defined, toggleVideoMute all local video"),this.isVideoMuted?this.localStream!==null&&(cn.debug("localStream unMuteTracks"),this.unMuteTracks(this.localStream.getVideoTracks())):this.localStream!==null&&(cn.debug("localStream muteTracks"),this.muteTracks(this.localStream.getVideoTracks())),this.isVideoMuted=!this.isVideoMuted,Ct=0;Ct<xt;Ct+=1)this.callsTable[Ct].data&&this.callsTable[Ct].data.mesh||(Lt=null,this.callsTable[Ct].callConfiguration&&(Lt=apiCC.getUserMediaStream(this.callsTable[Ct].callConfiguration.userMediaStreamId)),Lt?Lt.videoMuted?Lt.unMuteVideoOnStreams("enabled"):Lt.muteVideoOnStreams("enabled"):this.callsTable[Ct].callLocalStream!==null&&(this.callsTable[Ct].isLocalVideoMuted?(cn.debug("unmuting call :",this.callsTable[Ct].callId),this.unMuteTracks(this.callsTable[Ct].callLocalStream.getVideoTracks())):(cn.debug("muting call :",this.callsTable[Ct].callId),this.muteTracks(this.callsTable[Ct].callLocalStream.getVideoTracks())),this.callsTable[Ct].isLocalVideoMuted=!this.callsTable[Ct].isLocalVideoMuted));for(xt=this.userMediaTable.length,Ct=0;Ct<xt;Ct+=1)Lt=null,this.userMediaTable[Ct].callConfiguration&&(Lt=apiCC.getUserMediaStream(this.userMediaTable[Ct].callConfiguration.userMediaStreamId)),Lt&&(Lt.videoMuted?Lt.unMuteVideoOnStreams("enabled"):Lt.muteVideoOnStreams("enabled"));return{muteState:this.isVideoMuted,callId:"ALL"}}return cn.debug("callId is defined :",nt),(yt=this.findCallIndexWithCallId(nt))>=0?(this.callsTable[yt].callConfiguration&&(Lt=apiCC.getUserMediaStream(this.callsTable[yt].callConfiguration.userMediaStreamId)),Lt?(Lt.videoMuted?Lt.unMuteVideoOnStreams("enabled"):Lt.muteVideoOnStreams("enabled"),{muteState:Lt.videoMuted,callId:nt}):this.callsTable[yt].callLocalStream!==null?(this.callsTable[yt].isLocalVideoMuted?(cn.debug("unmuting call :",this.callsTable[yt].callId),this.unMuteTracks(this.callsTable[yt].callLocalStream.getVideoTracks())):(cn.debug("muting call :",this.callsTable[yt].callId),this.muteTracks(this.callsTable[yt].callLocalStream.getVideoTracks())),this.callsTable[yt].isLocalVideoMuted=!this.callsTable[yt].isLocalVideoMuted,{muteState:this.callsTable[yt].isLocalVideoMuted,callId:nt}):{muteState:"STREAM_NOT_FOUND",callId:nt}):(wt=this.findUserMediaById(nt))&&(wt.callConfiguration&&(Lt=apiCC.getUserMediaStream(wt.callConfiguration.userMediaStreamId)),Lt)?(Lt.videoMuted?Lt.unMuteVideoOnStreams("enabled"):Lt.muteVideoOnStreams("enabled"),{muteState:Lt.videoMuted,callId:nt}):{muteState:"CALL_NOT_FOUND",callId:nt}},this.unMuteTracks=function(nt){var Ct;if(nt.length!==0){for(Ct=0;Ct<nt.length;Ct+=1)nt[Ct].enabled=!0;cn.log("tracks unMuted.")}else cn.log("No tracks available.")},this.muteTracks=function(nt){var Ct;if(nt.length!==0){for(Ct=0;Ct<nt.length;Ct+=1)nt[Ct].enabled=!1;cn.log("tracks muted.")}else cn.log("No tracks available.")},this.toggleAudioMute=function(nt){cn.debug("toggleAudioMute");var Ct,yt,xt=this.callsTable.length,wt=null,Lt=null;if(nt==null){for(cn.debug("no callId defined, toggleAudioMute all local audio"),this.isAudioMuted?this.localStream!==null&&(cn.debug("localStream unMuteTracks"),this.unMuteTracks(this.localStream.getAudioTracks())):this.localStream!==null&&(cn.debug("localStream muteTracks"),this.muteTracks(this.localStream.getAudioTracks())),this.isAudioMuted=!this.isAudioMuted,Ct=0;Ct<xt;Ct+=1)this.callsTable[Ct].data&&this.callsTable[Ct].data.mesh||(Lt=null,this.callsTable[Ct].callConfiguration&&(Lt=apiCC.getUserMediaStream(this.callsTable[Ct].callConfiguration.userMediaStreamId)),Lt?Lt.audioMuted?Lt.unMuteAudioOnStreams("enabled"):Lt.muteAudioOnStreams("enabled"):this.callsTable[Ct].callLocalStream!==null&&(this.callsTable[Ct].isLocalAudioMuted?(cn.debug("unmuting call :",this.callsTable[Ct].callId),this.unMuteTracks(this.callsTable[Ct].callLocalStream.getAudioTracks())):(cn.debug("muting call :",this.callsTable[Ct].callId),this.muteTracks(this.callsTable[Ct].callLocalStream.getAudioTracks())),this.callsTable[Ct].isLocalAudioMuted=!this.callsTable[Ct].isLocalAudioMuted));for(xt=this.userMediaTable.length,Ct=0;Ct<xt;Ct+=1)Lt=null,this.userMediaTable[Ct].callConfiguration&&(Lt=apiCC.getUserMediaStream(this.userMediaTable[Ct].callConfiguration.userMediaStreamId)),Lt&&(Lt.audioMuted?Lt.unMuteAudioOnStreams("enabled"):Lt.muteAudioOnStreams("enabled"));return{muteState:this.isAudioMuted,callId:"ALL"}}return cn.debug("callId is defined :",nt),(yt=this.findCallIndexWithCallId(nt))>=0?(this.callsTable[yt].callConfiguration&&(Lt=apiCC.getUserMediaStream(this.callsTable[yt].callConfiguration.userMediaStreamId)),Lt?(Lt.audioMuted?Lt.unMuteAudioOnStreams("enabled"):Lt.muteAudioOnStreams("enabled"),{muteState:Lt.audioMuted,callId:nt}):this.callsTable[yt].callLocalStream!==null?(this.callsTable[yt].isLocalAudioMuted?(cn.debug("unmuting call :",this.callsTable[yt].callId),this.unMuteTracks(this.callsTable[yt].callLocalStream.getAudioTracks())):(cn.debug("muting call :",this.callsTable[yt].callId),this.muteTracks(this.callsTable[yt].callLocalStream.getAudioTracks())),this.callsTable[yt].isLocalAudioMuted=!this.callsTable[yt].isLocalAudioMuted,{muteState:this.callsTable[yt].isLocalAudioMuted,callId:nt}):{muteState:"STREAM_NOT_FOUND",callId:nt}):(wt=this.findUserMediaById(nt))&&(wt.callConfiguration&&(Lt=apiCC.getUserMediaStream(wt.callConfiguration.userMediaStreamId)),Lt)?(Lt.audioMuted?Lt.unMuteAudioOnStreams("enabled"):Lt.muteAudioOnStreams("enabled"),{muteState:Lt.audioMuted,callId:nt}):{muteState:"CALL_NOT_FOUND",callId:nt}},this.sendDTMF=function(nt,Ct,yt,xt){cn.debug("sendDTMF");var wt=0;nt!=null?(cn.debug("callId is defined :",nt),wt=this.findCallIndexWithCallId(nt),cn.debug("index :",wt),wt>=0&&(cn.debug("index :",wt),this.callsTable[wt].sendTones(Ct,yt,xt))):cn.debug("no callId defined, leaving sendDTMF")},this.xhr=function(nt,Ct,yt,xt){var wt=new XMLHttpRequest;wt.onreadystatechange=function(){wt.readyState===4&&wt.status===200&&yt(wt.responseText)},xt!==void 0&&(wt.upload.onprogress=xt),wt.open("POST",nt),wt.send(Ct)},this.takeSnapshot=function(nt,Ct,yt,xt,wt,Lt,Et){var $t=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{};cn.info("takeSnapshot");var Jt,en=null,qt=null,on=document.createElement("canvas"),hn=null,nn=null,dn=new Date,Sn=dn.toJSON(),wn=Sn.replace(new RegExp(":","g"),"-"),En=null;switch(xt){case"Desactivated":Jt=0;break;case"Low":Jt=2;break;case"Medium":Jt=4;break;case"High":Jt=6;break;default:cn.log("blurLevel not defined switch case : "+xt),Jt=0}return Et===void 0?(cn.warn("ApiRTC DEPRECATED : Please add videoId for TakeSnapshot"),cn.log("Leaving takeSnapshot"),void this.myWebRTC_Event.createErrorEvent("Deprecated - localVideo Div Name is not correct for takeSnapshot","INCORRECT_VIDEOID_FOR_SNAPSHOT")):(cn.log("takeSnapshot of defined video Id :"+Et),(En=document.getElementById(Et))===null?(cn.log("Cannot find video with Id :"+Et),cn.log("Leaving takeSnapshot"),void this.myWebRTC_Event.createErrorEvent("localVideo Div Name is not correct for takeSnapshot","INCORRECT_VIDEOID_FOR_SNAPSHOT")):(on.width=En.videoWidth,on.height=En.videoHeight,$t.hasOwnProperty("width")&&(cn.debug("options.width is set :"+$t.width),on.width=$t.width),$t.hasOwnProperty("height")&&(cn.debug("options.height is set :"+$t.height),on.height=$t.height),cn.log("snapshot.width : "+on.width),cn.log("snapshot.height :"+on.height),(en=on.getContext("2d")).drawImage(En,0,0,on.width,on.height),(qt=document.createElement("img")).src=on.toDataURL("image/png"),qt.style.padding=5,qt.width=on.width,qt.height=on.height,Jt!==0?(cn.log("Adding Blur on Photo"),hn=en.getImageData(0,0,on.width,on.height),cn.log("av pixels data : "+hn.data),hn=Rt(qt,hn,Jt),cn.log("ap pixels data : "+hn.data),en.putImageData(hn,0,0),qt.src=on.toDataURL("image/png")):cn.log("blur on photo is desactivated"),lr(Ct)==="object"?Ct!==null?Ct.src=qt.src:cn.log("localPhotoIdOrDiv is null"):document.getElementById(Ct)!==null?document.getElementById(Ct).src=qt.src:cn.log("localPhotoId is not defined"),nn=new FormData,wt!==void 0?(cn.log("sessionId !== undefined :"+wt),nn.append("destFileName",this.clientId+"-"+wn+".png"),nn.append("data",on.toDataURL("image/png")),nn.append("sessionId",wt)):(cn.log("Upload on data1"),nn.append("photo",on.toDataURL("image/png")),nn.append("clientId",this.clientId),nn.append("apiKey",apiCC.session.apiKey)),void this.xhr(nt,nn,function(Pn){if(cn.log("fileName :",Pn),Pn!==null)try{var Wn=JSON.parse(Pn);Wn.resultCode==="OK"&&(cn.log("files loaded, filename :"+Wn.fileUrl),Gn.createSnapShotPhotoUploaded(Wn.fileUrl))}catch(ir){cn.log("Parsing error:",ir)}Pn!=="Photo received"&&Pn!=="An error occurred."&&Pn.substring(0,6)!=="Photo-"||Gn.createSnapShotPhotoUploaded(Pn)},Lt)))},this.takeSnapshotAndSendOnDataChannel=function(nt,Ct,yt,xt){cn.info("takeSnapshotAndSendOnDataChannel");var wt,Lt=null,Et=document.createElement("canvas"),$t=null;if(Ct!==void 0){if(cn.log("takeSnapshot of defined video Id :"+Ct),($t=document.getElementById(Ct))===null)return cn.log("Cannot find video with Id :"+Ct),cn.log("Leaving takeSnapshot"),void this.myWebRTC_Event.createErrorEvent("localVideo Div Name is not correct for takeSnapshot","INCORRECT_VIDEOID_FOR_SNAPSHOT")}else cn.warn("ApiRTC DEPRECATED : Please add videoId for TakeSnapshot");$t!=null&&(Et.width=$t.clientWidth,Et.height=$t.clientHeight),cn.log("snapshot.width : "+Et.width),cn.log("snapshot.height :"+Et.height),Et.getContext("2d").drawImage($t,0,0,Et.width,Et.height),(Lt=document.createElement("img")).src=Et.toDataURL("image/png"),Lt.style.padding=5,Lt.width=Et.width,Lt.height=Et.height,lr(nt)==="object"?nt!==null?nt.src=Lt.src:cn.log("localPhotoIdOrDiv is null"):document.getElementById(nt)!==null?document.getElementById(nt).src=Lt.src:cn.log("localPhotoId is not defined"),wt=Et.toDataURL("image/png"),this.sendDataWithCallId(yt,{file:wt,name:"nomFichier",type:"image/png-dataUrl"},xt)},this.callWithNumber=function(nt,Ct,yt,xt){cn.info("Click on Call Button, video activated : "+Ct),cn.log("callConfiguration : ",xt);var wt=null,Lt=0,Et=null,$t=null,Jt=null,en=null,qt=null;if(typeof nt=="number"&&(cn.log("called number type is number, converting to string"),nt=nt.toString()),nt!==""&&nt!==this.clientId){if((wt=new bn(this)).instanceId=apiCC.generateInstanceId(),cn.log("Calling destination number :"+nt),xt==null||xt.apzcallId===void 0||xt.apzcallId===null?wt.generateCallId():wt.callId=xt.apzcallId,apiCC.isSIPNumber(nt)===!0?(cn.log("Prefix 0 , + , or 'sip:' detected, calling a SIP device"),nt.toString().startsWith("sip:")===!0&&(nt=nt.toString().replace("sip:",""),cn.log("called SIP number is :",nt)),yt!=null?yt.pubSub="sipConnector":(yt={}).pubSub="sipConnector",wt.trickleIce=!1):cn.log("Establishing Web call"),wt.callerId=this.clientId,wt.calleeId=nt,wt.dest_roomId=nt,wt.audioOnly=!Ct,wt.remoteId=nt,wt.callConfiguration=xt,xt!=null?(xt.mediaTypeForOutgoingCall==="VIDEO"||xt.mediaTypeForOutgoingCall==="AUDIO"||xt.mediaTypeForOutgoingCall==="VIDEOONLY"||xt.mediaTypeForOutgoingCall==="NONE"?(cn.log("Setting mediaTypeForOutgoingCall :"+xt.mediaTypeForOutgoingCall),wt.mediaTypeForOutgoingCall=xt.mediaTypeForOutgoingCall):(cn.log("mediaTypeForOutgoingCall is not set"),Ct===!1&&(cn.log("videoActivated is false, setting mediaTypeForOutgoingCall to AUDIO"),wt.mediaTypeForOutgoingCall="AUDIO")),xt.mediaRoutingMode!==void 0&&xt.mediaRoutingMode!==null&&wt.setCallMediaRoutingMode(xt.mediaRoutingMode),xt.turnServerAddress!==void 0&&xt.turnServerAddress!==null&&wt.setCallTurnServer(xt.turnServerAddress),xt.preferVP9Codec!==!0&&xt.preferVP9Codec!==!1||(wt.preferVP9Codec=xt.preferVP9Codec),xt.hasOwnProperty("forceCallType")&&(wt.callType=xt.forceCallType,wt.callType!=="screenSharing"&&wt.callType!=="screenSharingWithAudio"||(wt.screenSharing=!0))):cn.log("callConfiguration is not set"),yt!==void 0&&yt.MCUType!==void 0&&(yt.MCUType!=="MCU-Caller"&&yt.MCUType!=="MCU-Callee"||(this.MCUClient.pubConnector==="janusConnector"&&ot.Xh==="Firefox"&&(ot.PR>43?wt.mediaConstraints={offerToReceiveAudio:!1,offerToReceiveVideo:!1}:wt.mediaConstraints={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}),yt.pubSub=this.MCUClient.pubConnector,yt.videoBandwidthSettings=this.videoBandwidthSettings,yt.pubSub==="groupKurentoConnector"&&(yt.pubSub="kurentoConnector"))),wt.checkDTLSCompliancy(),Et=wt.callId,$t=apiCC.session.getConnectedUserInfo(nt,"userData"),cn.log("userInfo :",$t),$t!=="User_Not_Found"&&$t!==void 0&&(Jt=JSON.parse($t))!==void 0&&Jt.react==="true"&&(cn.log("userInfoJson.react :",JSON.stringify(Jt.react)),cn.log("userInfoJson.osName :",JSON.stringify(Jt.osName)),Jt.osName==="iOS"&&(cn.log("Callee : React and iOS detected, setting H264 as preferred codec for the call"),wt.preferH264Codec=!0)),wt.audioOnly===!0&&(wt.callType="audio"),yt!==void 0?wt.data=yt:yt={},yt.convId&&(yt.cloudConvId||(yt.cloudConvId=yt.convId),delete yt.convId),yt.dataCall===!0&&(wt.dataCall=!0),wt.data.instanceId=wt.instanceId,Lt=this.callsTable.push(wt),cn.log("Call Number is :"+Lt),wt.data&&wt.data.MCUType==="MCU-Caller"&&wt.mediaTypeForOutgoingCall==="NONE")return wt.inviteSended=!0,wt.myWebRTC_Stack.sendInvite(wt.callId,wt.callerId,this.nickname,wt.dest_roomId,wt.dest_roomId,"none",{offer:{type:"no-offer"},data:wt.data}),wt.callId;wt.data&&wt.data.MCUType==="MCU-Caller"&&(wt.settingUpType="publish",wt.callControl=this.createCallControl({type:"publish",callId:wt.callId,roomName:wt.data.confId,callConfiguration:wt.callConfiguration,data:wt.data}),wt.callControl.sessionId=wt.data.confId,wt.callControl.token=wt.data.confId,wt.callControl.autoRestart.counter=0,wt.setMediaConstraintsToSendOnlyOffer()),(0,lt.ki)(xt,"userMediaStreamId","string")&&(qt=xt.userMediaStreamId),Jt!=null&&Jt.isSimulated==="true"?apiCC.session.channel.socket.emit("simulatedAgentCallRequest",{number:nt,call:wt,videoActivated:Ct,data:yt,callConfiguration:{apzcallId:wt.callId}}):this.accessToLocalMedia===!0&&this.autoAnswer===!0||wt.dataCall||qt?wt.dataCall?(cn.log("Datachannel call"),wt.establishCall()):(cn.log("callWithNumber :: User has already granted access to local media and AutoAnswer activated : establishing call"),qt?((en=apiCC.getUserMediaStream(qt)).addCallInfo(wt.callId),wt.callConfiguration!==void 0&&wt.callConfiguration!==null||(wt.callConfiguration={}),wt.callConfiguration.userMediaStreamId=en.userMediaStreamId,wt.onUserMediaSuccessOnCall(en.stream)):wt.establishCall()):yt.MCUType==="MCU-Callee"&&this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("Stand-by :: wait for AcceptCall on recorded 1to1 call"):wt.getUserMediaOnCall()}else cn.log("Call Number is incorrect");return Et},this.startTestCall=function(nt,Ct){cn.info("startTestCall : video activated : "+nt);var yt,xt,wt=null,Lt=null,Et={};return(wt=new bn(this)).generateCallId(),wt.instanceId=apiCC.generateInstanceId(),wt.callerId=this.clientId,wt.calleeId=12345,wt.dest_roomId=12345,wt.audioOnly=!nt,wt.remoteId=12345,wt.callConfiguration=Ct,Ct!=null?(Ct.mediaTypeForOutgoingCall==="VIDEO"||Ct.mediaTypeForOutgoingCall==="AUDIO"||Ct.mediaTypeForOutgoingCall==="VIDEOONLY"||Ct.mediaTypeForOutgoingCall==="NONE"?(cn.log("Setting mediaTypeForOutgoingCall :"+Ct.mediaTypeForOutgoingCall),wt.mediaTypeForOutgoingCall=Ct.mediaTypeForOutgoingCall):cn.log("mediaTypeForOutgoingCall is not set"),Ct.mediaRoutingMode!==void 0&&Ct.mediaRoutingMode!==null&&wt.setCallMediaRoutingMode(Ct.mediaRoutingMode),Ct.turnServerAddress!==void 0&&Ct.turnServerAddress!==null&&wt.setCallTurnServer(Ct.turnServerAddress),Ct.preferVP9Codec!==!0&&Ct.preferVP9Codec!==!1||(wt.preferVP9Codec=Ct.preferVP9Codec)):(cn.log("callConfiguration is not set"),Ct={}),wt.checkDTLSCompliancy(),xt=wt.callId,Et.pubSub="testCallKurentoConnector",wt.data=Et,wt.data.instanceId=wt.instanceId,wt.audioOnly===!0&&(wt.callType="audio"),yt=this.callsTable.push(wt),cn.log("Call Number is :"+yt),this.accessToLocalMedia===!0&&this.autoAnswer===!0||wt.dataCall||Ct.userMediaStreamId||apiCC.userMediaStreamTable.length>0?wt.dataCall?(cn.log("Datachannel call"),wt.establishCall()):(cn.log("startTestCall :: User has already granted access to local media and AutoAnswer activated : establishing call"),Ct.userMediaStreamId?((Lt=apiCC.getUserMediaStream(Ct.userMediaStreamId)).addCallInfo(wt.callId),wt.callConfiguration!==void 0&&wt.callConfiguration!==null||(wt.callConfiguration={}),wt.callConfiguration.userMediaStreamId=Lt.userMediaStreamId,wt.callLocalStream=Lt.stream,wt.establishCall()):(apiCC.userMediaStreamTable.length>0&&((Lt=apiCC.userMediaStreamTable[0]).addCallInfo(wt.callId),wt.callConfiguration!==void 0&&wt.callConfiguration!==null||(wt.callConfiguration={}),wt.callConfiguration.userMediaStreamId=Lt.userMediaStreamId,wt.callLocalStream=Lt.stream),wt.establishCall())):wt.getUserMediaOnCall(),xt},this.extensionInstallationSuccessCallback=function(){cn.debug("extensionInstallationSuccessCallback"),apiCC.session.apiCCWebRTCClient.webRTCClient.apiRTCExtensionInstalled=!0},this.extensionInstallationFailureCallback=function(nt,Ct){cn.debug("extensionInstallationFailureCallback : Error :"+nt+", "+Ct),nt=null,Ct=null,Gn.createDesktopCaptureEvent("Extension_installation_Error",this.waitingShareScreenCallId,this.waitingShareScreenDestNumber,this.waitingCaptureSourceType)},this.manageNotInstalledExtension=function(nt,Ct,yt){cn.debug("manageNotInstalledExtension"),cn.warn("apiRTC extension not installed"),Gn.createDesktopCaptureEvent("Extension_not_installed",nt,Ct),cn.warn("Starting apiRTC extension installation"),this.waitingShareScreenDestNumber=Ct,this.waitingShareScreenCallId=nt,this.waitingCaptureSourceType=yt,chrome.webstore.install("https://chrome.google.com/webstore/detail/mjjnofoemoepfididplbfimokpnpcoeg",this.callback(this,"extensionInstallationSuccessCallback"),this.callback(this,"extensionInstallationFailureCallback"))},this.shareScreen=function(nt,Ct,yt,xt,wt){cn.info("shareScreen");var Lt=null,Et=null,$t=null,Jt=null;if(apiCC.isScreenSharingCompliant()===!0)if(nt!==""&&nt!==this.clientId){if(Ct!==null&&lr(Ct)==="object"||(Ct={}),this.MCUClient.pubConnector==="janusConnector"&&!Ct.mesh&&wt&&wt.callControl&&wt.callControl.callId&&this.findCallWithCallId(wt.callControl.callId))return cn.debug("call already exists",wt.callControl.callId),wt.callControl.callId;if(xt!==null&&lr(xt)==="object"||(xt={}),xt.qos!==null&&lr(xt.qos)==="object"?(Ct.qos={},xt.qos.videoMinQuality==="excellent"?Ct.qos.videoMinQuality="excellent":xt.qos.videoMinQuality==="good"?Ct.qos.videoMinQuality="good":xt.qos.videoMinQuality==="medium"?Ct.qos.videoMinQuality="medium":(xt.qos.videoMinQuality,Ct.qos.videoMinQuality="bad"),xt.qos.videoForbidInactive===!0&&(Ct.qos.videoForbidInactive=!0)):Ct.qos={videoMinQuality:"bad"},["audioLabels","videoLabels"].forEach(function(qt){(0,lt.Ym)(xt[qt],"array")&&(Ct[qt]=[],xt[qt].forEach(function(on){(0,lt.Ym)(on,"string")&&Ct[qt].push(on)}))}),(0,lt.Ym)(xt,"context","object"))try{JSON.stringify(xt.context),Ct.context=xt.context}catch{}cn.log("shareScreen; callConfiguration: "+JSON.stringify(xt)),Et=new bn(apiCC.session.apiCCWebRTCClient.webRTCClient),Ct.mesh!==void 0&&Ct.instanceId!==void 0?(cn.debug("keeping instanceId "),Et.instanceId=Ct.instanceId):Et.instanceId=apiCC.generateInstanceId(),cn.log("Calling destination number :"+nt);var en=this.MCUClient.getSessionMCU(nt);if(en&&(Et.sessionMCU=en),Et.sessionMCU&&this.MCUClient.pubConnector==="janusConnector"&&!Ct.mesh?(Et.settingUpType="shareScreen",wt&&wt.callControl?(Et.callControl=wt.callControl,Et.callControl.autoRestart.counter+=1,Et.callId=Et.callControl.callId,Et.restarted=!0):(Et.callControl=this.createCallControl({type:"shareScreen",roomName:nt,callConfiguration:xt,data:Ct}),Et.callControl.captureSourceType=yt,Et.callControl.autoRestart.counter=0,Et.generateCallId(),Et.callControl.callId=Et.callId)):(Et.settingUpType="shareScreen",Et.generateCallId()),Lt=Et.callId,Et.callerId=this.clientId,Et.calleeId=nt,Et.dest_roomId=nt,Et.audioOnly=!1,Et.screenSharing=!0,Et.remoteId=nt,Et.callType="screenSharing",Et.captureSourceType=yt,Et.callConfiguration=xt,Et.data=Ct,Et.data.instanceId=Et.instanceId,en&&en.convId&&(Et.data.cloudConvId=en.convId),xt!=null&&xt.turnServerAddress!==void 0&&xt.turnServerAddress!==null&&Et.setCallTurnServer(xt.turnServerAddress),Et.checkDTLSCompliancy(),apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Et),Et.sessionMCU&&this.MCUClient.pubConnector==="janusConnector"&&Et.callControl&&Et.callControl.autoRestart.stream)return cn.debug("shareScreen; autoRestart"),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Et.callLocalStream=Et.callControl.autoRestart.stream,Et.establishCall(),Et.callId;if(Ct!==void 0&&Ct.mesh!==void 0&&($t=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Ct.mesh.calleeCallId))!==null&&$t.callConfiguration&&$t.callConfiguration.userMediaStreamId)return(Jt=apiCC.getUserMediaStream($t.callConfiguration.userMediaStreamId)).addCallInfo(Et.callId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Et.sessionMCU&&apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=Jt.stream),Et.callConfiguration.userMediaStreamId=Jt.userMediaStreamId,Et.callLocalStream=Jt.stream,Et.establishCall(),Et.callId;apiCC.createUserMediaStream({callId:Et.callId,type:Et.callType,captureSourceType:yt,success:function(qt){cn.debug("[shareScreen] success; userMediaStreamId: "+qt.userMediaStreamId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Et.sessionMCU&&apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=qt.stream),Et.callConfiguration.userMediaStreamId=qt.userMediaStreamId,Et.callLocalStream=qt.stream,Et.establishCall()}})}else cn.log("Call Number is incorrect");else cn.log("shareScreen is not supported on this browser"),Gn.createDesktopCaptureEvent("Browser_Not_Compatible",Lt,nt);return cn.info("shareScreen, callId :",Lt),Lt},this.startScreenSharingOnCall=function(nt,Ct){cn.info("getScreenMedia for callId :"+nt);var yt=null;if(ot.Xh==="Chrome")if((yt=this.findCallWithCallId(nt))!==null){if(this.apiRTCExtensionInstalled===!1)return void this.manageNotInstalledExtension(yt.callId,yt.remoteId,Ct);Ct==null&&(Ct=["screen","window","tab"]),window.postMessage({command:"getDesktopId",callNumber:yt.callId,remoteId:yt.remoteId,captureSourceType:Ct,browser_major_version:ot.PR},"*")}else cn.log("call not found");else cn.log("shareScreen is only available for chrome Browser"),Gn.createDesktopCaptureEvent("Browser_Not_Compatible",nt,null)},this.toggleVideoScreen=function(nt){cn.info("toggleVideoScreen for callId :"+nt);var Ct=this.findCallWithCallId(nt);Ct!==null?Ct.toggleVideoScreen():cn.log("call not found")},this.addVideoMedia=function(nt){cn.info("webRTCClient::addVideoMedia for callId :"+nt);var Ct=this.findCallWithCallId(nt);Ct!==null?Ct.addVideoMedia():cn.log("call not found")},this.callbymail=function(nt){var Ct;cn.info("Click on Call per mail Button"),Ct=nt,new RegExp("^[0-9a-z._-]+@{1}[0-9a-z.-]{2,}[.]{1}[a-z]{2,5}$","i").test(Ct)?(cn.log("Calling Destination mail :"+nt),this.socket.emit("webrtc_invite_permail",nt),Kt.channel.socket.emit("webrtc_invite_permail",nt)):cn.log("Mail address is not correct :"+nt)},this.callperURL=function(nt){cn.info("Call per URL");var Ct,yt=null;(yt=new bn(this)).instanceId=apiCC.generateInstanceId(),cn.log("Calling Destination number :"+nt),yt.generateCallId(),yt.callerId=this.clientId,yt.calleeId=nt,yt.dest_roomId=nt,yt.audioOnly=!1,yt.getUserMediaOnCall(),yt.remoteId=nt,yt.checkDTLSCompliancy(),Ct=this.callsTable.push(yt),cn.log("Call Number is :"+Ct)},this.acceptCall=function(nt,Ct){cn.info("acceptCall for callId :"+nt),cn.log("acceptCall() - callConfiguration : ",Ct);var yt=null,xt=null;if((yt=this.findCallWithCallId(nt))!==null){if(cn.log("acceptCall() - Call found"),yt.isAccepted=!0,Ct!=null?(Ct.mediaTypeForIncomingCall==="VIDEO"||Ct.mediaTypeForIncomingCall==="AUDIO"||Ct.mediaTypeForIncomingCall==="VIDEOONLY"||Ct.mediaTypeForIncomingCall==="NONE"||Ct.mediaTypeForIncomingCall==="DATA"?(cn.log("acceptCall() - Setting mediaTypeForIncomingCall :"+Ct.mediaTypeForIncomingCall),yt.mediaTypeForIncomingCall=Ct.mediaTypeForIncomingCall):cn.log("acceptCall() - mediaTypeForIncomingCall is not set"),Ct.mediaRoutingMode!==void 0&&Ct.mediaRoutingMode!==null&&yt.setCallMediaRoutingMode(Ct.mediaRoutingMode),Ct.turnServerAddress!==void 0&&Ct.turnServerAddress!==null&&yt.setCallTurnServer(Ct.turnServerAddress),Ct.preferVP9Codec!==!0&&Ct.preferVP9Codec!==!1||(yt.preferVP9Codec=Ct.preferVP9Codec)):(cn.log("acceptCall() - callConfiguration is not set"),Ct={}),yt.screenSharing===!0&&(cn.log("acceptCall() for screenSharing : forcing mediaTypeForIncomingCall to NONE"),Ct.mediaTypeForIncomingCall="NONE",yt.mediaTypeForIncomingCall="NONE"),yt.callConfiguration=(0,lt.S6)(yt.callConfiguration,Ct),yt.mediaTypeForIncomingCall==="VIDEO"?yt.setLocalCallProfile({audio:!0,audioActive:!0,video:!0,videoActive:!0}):yt.mediaTypeForIncomingCall==="AUDIO"?yt.setLocalCallProfile({audio:!0,audioActive:!0,video:!1,videoActive:!1}):yt.mediaTypeForIncomingCall==="VIDEOONLY"?yt.setLocalCallProfile({audio:!1,audioActive:!1,video:!0,videoActive:!0}):yt.mediaTypeForIncomingCall==="NONE"&&yt.setLocalCallProfile({audio:!1,audioActive:!1,video:!1,videoActive:!1}),yt.data&&yt.data.MCUType==="MCU-Callee"&&yt.mediaTypeForIncomingCall==="NONE")return void yt.myWebRTC_Stack.sendInvite(yt.callId,yt.callerId,this.nickname,yt.dest_roomId,yt.dest_roomId,"none",{offer:{type:"no-offer"},data:yt.data});yt.data&&yt.data.MCUType==="MCU-Callee"&&(yt.mediaTypeForOutgoingCall=yt.mediaTypeForIncomingCall,yt.settingUpType="publish",yt.callControl=this.createCallControl({type:"publish",callId:yt.callId,roomName:yt.data.confId,callConfiguration:yt.callConfiguration,data:yt.data}),yt.callControl.sessionId=yt.data.confId,yt.callControl.token=yt.data.confId,yt.callControl.autoRestart.counter=0,yt.setMediaConstraintsToSendOnlyOffer()),this.unidirectionelCallOnly?(cn.log("acceptCall() - unidirectional call"),yt.onUserMediaSuccessTestUni()):this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?(cn.log("acceptCall with userAcceptOnIncomingCallBeforeGetUserMedia"),Ct.userMediaStreamId?((xt=apiCC.getUserMediaStream(Ct.userMediaStreamId)).addCallInfo(yt.callId),yt.callConfiguration!==void 0&&yt.callConfiguration!==null||(yt.callConfiguration={}),yt.callConfiguration.userMediaStreamId=xt.userMediaStreamId,yt.onUserMediaSuccessOnCall(xt.stream)):yt.getUserMediaOnCall()):yt.accessToMedia===!0||Ct.userMediaStreamId||yt.dataCall?(cn.log("acceptCall() :: User has already granted access to local media and AutoAnswer activated : establishing call"),yt.dataCall||Ct.userMediaStreamId&&((xt=apiCC.getUserMediaStream(Ct.userMediaStreamId)).addCallInfo(yt.callId),yt.callConfiguration!==void 0&&yt.callConfiguration!==null||(yt.callConfiguration={}),yt.callConfiguration.userMediaStreamId=xt.userMediaStreamId,yt.callLocalStream=xt.stream),yt.establishCall()):cn.log("acceptCall() - call will be established when user accept his media")}else cn.log("Call not found")},this.refuseCall=function(nt,Ct){cn.info("refuseCall for callId :"+nt);var yt,xt=null;yt=Ct!==void 0?Ct:"User_Refused_Call",(xt=this.findCallWithCallId(nt))!==null?(cn.log("Call found"),xt.data.MCUType==="MCU-Callee"?(xt.myWebRTC_Stack.sendBye(xt.callId,xt.callerId,xt.dest_roomId,xt.calleeId,"User_Media_Error",xt.data),this.removeCallFromTableWithCallIdandRemoteId(xt.callId,xt.calleeId,yt)):(xt.myWebRTC_Stack.sendBye(xt.callId,xt.calleeId,xt.dest_roomId,xt.callerId,yt,xt.data),this.removeCallFromTableWithCallIdandRemoteId(xt.callId,xt.callerId,yt)),this.callsTable.length===0&&cn.log("No more established calls for client")):cn.log("Call not found")},this.stopMedia=function(nt){var Ct=this,yt=null,xt=null;return new Promise(function(wt,Lt){var Et=null,$t=null;return(Et=Ct.findCallWithCallId(nt))?Et.callLocalStream?void Et.removeStream(Et.callLocalStream).then(function(){return xt=Et.callLocalStream.id,Et.callLocalStream=null,(0,lt.ki)(Et.callConfiguration,"userMediaStreamId","string")&&(yt=Et.callConfiguration.userMediaStreamId,apiCC.releaseUserMediaStream(Et.callConfiguration.userMediaStreamId,Et.callId),delete Et.callConfiguration.userMediaStreamId),wt({oldUserMediaStreamId:yt,oldMediaStreamId:xt})}).catch(Lt):wt({oldUserMediaStreamId:yt,oldMediaStreamId:xt}):(($t=Ct.findUserMediaById(nt))&&(yt=nt,$t.releaseUserMediaStream()),wt({oldUserMediaStreamId:yt,oldMediaStreamId:xt}))})},this.addMedia=function(nt,Ct,yt,xt){var wt=this;cn.info("addMedia for callId :"+nt);var Lt=null,Et=null,$t=null,Jt=function(){return Promise.resolve()},en=function(){return Promise.resolve()};Ct===!0&&(Jt=function(){return wt.stopMedia(nt)}),(0,lt.Ym)(yt,"string")&&($t=apiCC.getUserMediaStream(yt),yt=null);var qt=function(){cn.error("[addMedia] success; userMediaStreamId: "+$t.userMediaStreamId),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=$t.userMediaStreamId,Et.callType=$t.callType,Et.audio=$t.audio,Et.video=$t.video,Et.audioMuted=$t.audioMuted,Et.videoMuted=$t.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Et,!0)},on=function(dn){dn.callConfiguration!==void 0&&dn.callConfiguration!==null||(dn.callConfiguration={}),dn.isLocalAudioMuted&&dn.isLocalVideoMuted?dn.callConfiguration.muted="VIDEO":dn.isLocalAudioMuted?dn.callConfiguration.muted="AUDIOONLY":dn.isLocalVideoMuted&&(dn.callConfiguration.muted="VIDEOONLY")},hn=function(dn,Sn,wn){Sn==="audio"?wn?dn.audioSdpDirection=null:(0,lt.ki)(dn.remoteCallProfile,"audio","boolean")&&dn.remoteCallProfile.audio===!0&&dn.remoteCallProfile.audioActive===!0?dn.audioSdpDirection="recvonly":dn.audioSdpDirection="inactive":Sn==="video"&&(wn?dn.videoSdpDirection=null:(0,lt.ki)(dn.remoteCallProfile,"video","boolean")&&dn.remoteCallProfile.video===!0&&dn.remoteCallProfile.videoActive===!0?dn.videoSdpDirection="recvonly":dn.videoSdpDirection="inactive")},nn=function(dn,Sn,wn,En){dn.callConfiguration!==void 0&&dn.callConfiguration!==null||(dn.callConfiguration={}),dn.callConfiguration.userMediaStreamId=Sn.userMediaStreamId,hn(dn,"audio",Sn.audio),hn(dn,"video",Sn.video),on(dn),function(Pn,Wn,ir){Wn&&ir?(Pn.audioOnly=!1,Pn.mediaTypeForIncomingCall="VIDEO",Pn.mediaTypeForOutgoingCall="VIDEO"):Wn?(Pn.audioOnly=!1,Pn.mediaTypeForIncomingCall="AUDIO",Pn.mediaTypeForOutgoingCall="AUDIO"):ir?(Pn.audioOnly=!1,Pn.mediaTypeForIncomingCall="VIDEOONLY",Pn.mediaTypeForOutgoingCall="VIDEOONLY"):(Pn.audioOnly=!1,Pn.mediaTypeForIncomingCall="NONE",Pn.mediaTypeForOutgoingCall="NONE")}(dn,Sn.audio,Sn.video),dn.callLocalStream=Sn.stream,dn.started?dn.addingUserMedia=!0:wt.accessToLocalMedia=!0,dn.asyncCallbacks={},dn.asyncCallbacks.type="addingUserMedia",dn.asyncCallbacks.resolve=wn,dn.asyncCallbacks.reject=En,dn.asyncCallbacks.timeoutId=setTimeout(function(){dn.asyncCallbacks&&typeof dn.asyncCallbacks.reject=="function"&&(dn.asyncCallbacks.reject("addMedia timeout"),delete dn.asyncCallbacks)},Yn),dn.establishCall()};if((Lt=this.findCallWithCallId(nt))!==null){if(Lt.asyncCallbacks)return Promise.reject("job already ongoing");en=function(){return new Promise(function(dn,Sn){$t?($t.addCallInfo(Lt.callId),nn(Lt,$t,dn,Sn)):yt?apiCC.createUserMediaStream({type:"media",callId:Lt.callId,stream:yt,sync:!0,success:function(wn){cn.debug("[addMedia] success; userMediaStreamId: "+wn.userMediaStreamId),nn(Lt,wn,dn,Sn)},failure:function(wn,En){return Sn(En)}}):(0,lt.ki)(xt,"getUserMediaStreamId","function")?xt.getUserMediaStreamId().then(function(wn){if(!($t=apiCC.getUserMediaStream(wn)))return Sn("wrong userMediaStreamId");$t.addCallInfo(Lt.callId),nn(Lt,$t,dn,Sn)}).catch(Sn):apiCC.userMediaStreamTable.length>0?(($t=apiCC.userMediaStreamTable[0]).addCallInfo(Lt.callId),nn(Lt,$t,dn,Sn)):(on(Lt),Lt.addingUserMedia=!0,Lt.asyncCallbacks={},Lt.asyncCallbacks.type="addingUserMedia",Lt.asyncCallbacks.resolve=dn,Lt.asyncCallbacks.reject=Sn,Lt.asyncCallbacks.timeoutId=setTimeout(function(){Lt.asyncCallbacks&&typeof Lt.asyncCallbacks.reject=="function"&&(Lt.asyncCallbacks.reject("addMedia timeout"),delete Lt.asyncCallbacks)},Yn),Lt.getUserMediaOnCall())})}}else if(Et=this.findUserMediaById(nt)){if(Et.addingUserMedia===!0)return Promise.reject("addMedia already ongoing");en=function(){return new Promise(function(dn,Sn){Et.addingUserMedia=!0,new Promise(function(wn,En){if($t)return $t.addCallInfo(Et.userMediaId,"userMedia"),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=$t.userMediaStreamId,Et.callType=$t.callType,Et.audio=$t.audio,Et.video=$t.video,Et.audioMuted=$t.audioMuted,Et.videoMuted=$t.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Et,!0),wn($t.userMediaStreamId);if(yt)apiCC.createUserMediaStream({callId:Et.userMediaId,callFlavor:"userMedia",type:Et.callType,stream:yt,sync:!0,success:function(){return qt(),wn($t.userMediaStreamId)},failure:function(Pn,Wn){return En(Wn)}});else if((0,lt.ki)(xt,"getUserMediaStreamId","function"))xt.getUserMediaStreamId().then(function(Pn){return($t=apiCC.getUserMediaStream(Pn))?($t.addCallInfo(Et.userMediaId,"userMedia"),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=$t.userMediaStreamId,Et.callType=$t.callType,Et.audio=$t.audio,Et.video=$t.video,Et.audioMuted=$t.audioMuted,Et.videoMuted=$t.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Et,!0),wn($t.userMediaStreamId)):En("wrong userMediaStreamId")}).catch(En);else{if(apiCC.userMediaStreamTable.length>0)return($t=apiCC.userMediaStreamTable[0]).addCallInfo(Et.userMediaId,"userMedia"),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=$t.userMediaStreamId,Et.callType=$t.callType,Et.audio=$t.audio,Et.video=$t.video,Et.audioMuted=$t.audioMuted,Et.videoMuted=$t.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Et,!0),wn($t.userMediaStreamId);apiCC.createUserMediaStream({callId:Et.userMediaId,callFlavor:"userMedia",type:Et.callType,audioSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.audioSourceId,videoSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.videoSourceId,success:function(){return qt(),wn($t.userMediaStreamId)},failure:function(Pn,Wn){return En(Wn)}})}}).then(function(wn){return function(En){return new Promise(function(Pn,Wn){for(var ir=[],fr=0;fr<apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length;fr+=1){var gr=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[fr];if(gr.data!==void 0&&gr.data.mesh!==void 0&&gr.data.mesh.calleeCallId===nt){var yr=apiCC.session.apiCCWebRTCClient.webRTCClient.addMedia(gr.callId,!0,En);ir.push(yr.userMediaStreamId)}}Promise.all(ir).then(function(){return Pn(En)}).catch(Wn)})}(wn)}).then(function(wn){return delete Et.addingUserMedia,dn(wn)}).catch(function(wn){return delete Et.addingUserMedia,Sn(wn)})})}}else en=function(){return Promise.reject("no suitable replacement")};return new Promise(function(dn,Sn){var wn=null,En=null;Jt().then(function(Pn){return wn=Pn.oldUserMediaStreamId,En=Pn.oldMediaStreamId,en()}).then(function(Pn){return cn.info("addMedia success; userMediaStreamId: "+Pn),dn({userMediaStreamId:Pn,oldUserMediaStreamId:wn,oldMediaStreamId:En})}).catch(function(Pn){cn.error("addMedia failure: "+Pn);var Wn=null,ir=null;return Lt?(Lt.callControl&&(Wn=Lt.callControl.roomName,ir=Lt.callControl.type),Gn.createErrorEvent("Failed to addMedia","MEDIA_UPDATE_ERROR",Lt.callId,Wn,ir)):Et&&Gn.createErrorEvent("Failed to addMedia","MEDIA_UPDATE_ERROR",Et.userMediaId,null,"publish"),Sn(Pn)})})},this.updateMediaDeviceOnCall=function(nt,Ct){return cn.info("updateMediaDeviceOnCall for callId :"+nt),this.addMedia(nt,!0,Ct),nt},this.updateMediaTypeOnCall=function(nt,Ct){var yt=function(Lt,Et,$t){return new Promise(function(Jt,en){var qt,on={};Lt.callControl.mediaType=$t,Lt.mediaType=$t,Lt.data.mediaType=$t,Lt.updateCause="userAction",on.type="update",on.mode="passive",on.callId=Lt.callId,on.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,on.callerNickname=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,on.calleeId=Lt.sessionMCU.roomName,on.roomId=Lt.sessionMCU.roomName,on.callType=Et.attributes.callType,on.data=(0,lt.S6)(Lt.data),on.data.type="subscribe",on.stream=Et,qt=JSON.stringify(on),cn.log("C->S: "+qt),apiCC.session.apiCCWebRTCClient.webRTCClient.socket.emit("update",qt),Lt.asyncCallbacks={},Lt.asyncCallbacks.type="updateMediaType",Lt.asyncCallbacks.resolve=Jt,Lt.asyncCallbacks.reject=en,Lt.asyncCallbacks.timeoutId=setTimeout(function(){Lt.asyncCallbacks&&typeof Lt.asyncCallbacks.reject=="function"&&(Lt.asyncCallbacks.reject("timeout"),delete Lt.asyncCallbacks)},2e4)})},xt=this.findCallWithCallId(nt);if(!xt)return Promise.reject("call not found");if(xt.settingUpType!=="subscribe")return Promise.reject("wrong call type");if(xt.asyncCallbacks)return Promise.reject("job already ongoing");var wt=this.MCUClient.getStreamFromList(xt.streamId);if(!wt)return Promise.reject("wrong streamId");if(xt.callControl.mediaType==="VIDEO"){if(Ct==="AUDIOONLY"&&wt.audio||Ct==="VIDEOONLY"&&wt.video)return yt(xt,wt,Ct)}else if(xt.callControl.mediaType==="AUDIOONLY"){if(Ct==="VIDEO"&&wt.video||Ct==="VIDEOONLY"&&wt.video)return yt(xt,wt,Ct)}else if(xt.callControl.mediaType==="VIDEOONLY"&&(Ct==="VIDEO"&&wt.video||Ct==="AUDIOONLY"&&wt.audio))return yt(xt,wt,Ct);return Promise.reject("wrong mediaType")},this.updateSimulcastFeedOnCall=function(nt,Ct){var yt=this.findCallWithCallId(nt);if(!yt)return Promise.reject("call not found");if(yt.settingUpType!=="subscribe")return Promise.reject("wrong call type");if(yt.asyncCallbacks)return Promise.reject("job already ongoing");var xt=this.MCUClient.getStreamFromList(yt.streamId);if(!xt)return Promise.reject("wrong streamId");if(!Ct)return Promise.reject("wrong simulcast");yt.callControl.callConfiguration.simulcast||(yt.callControl.callConfiguration.simulcast={}),yt.data.simulcast||(yt.data.simulcast={}),Ct.streamQuality&&(Ct.streamQuality==="high"?(yt.callControl.callConfiguration.simulcast.substream=2,yt.data.simulcast.substream=2):Ct.streamQuality==="medium"?(yt.callControl.callConfiguration.simulcast.substream=1,yt.data.simulcast.substream=1):Ct.streamQuality==="low"?(yt.callControl.callConfiguration.simulcast.substream=0,yt.data.simulcast.substream=0):(yt.callControl.callConfiguration.simulcast.substream=-1,yt.data.simulcast.substream=-1)),Ct.streamFrameRate&&(Ct.streamFrameRate==="high"?(yt.callControl.callConfiguration.simulcast.temporal=2,yt.data.simulcast.temporal=2):Ct.streamFrameRate==="medium"?(yt.callControl.callConfiguration.simulcast.temporal=1,yt.data.simulcast.temporal=1):Ct.streamFrameRate==="low"?(yt.callControl.callConfiguration.simulcast.temporal=0,yt.data.simulcast.temporal=0):(yt.callControl.callConfiguration.simulcast.temporal=-1,yt.data.simulcast.temporal=-1));var wt={type:"updateSimulcastFeed"};wt.callId=yt.callId,wt.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,wt.callerNickname=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,wt.calleeId=yt.sessionMCU.roomName,wt.roomId=yt.sessionMCU.roomName,wt.callType=xt.attributes.callType,wt.data=(0,lt.S6)(yt.data),wt.stream=xt;var Lt=JSON.stringify(wt);return cn.log("C->S: "+Lt),apiCC.session.apiCCWebRTCClient.webRTCClient.socket.emit("updateSimulcastFeed",Lt),Promise.resolve()},this.updateCallConfigurationOnCall=function(nt,Ct){var yt=function(wt,Lt,Et){Lt==="audio"?wt.audioSdpDirection=Et?null:"inactive":Lt==="video"&&(wt.videoSdpDirection=Et?null:"inactive")},xt=this.findCallWithCallId(nt);return xt?xt.settingUpType!=="publish"?Promise.reject("wrong call type"):xt.asyncCallbacks?Promise.reject("job already ongoing"):((0,lt.Ym)(Ct,"object")||(Ct={}),(0,lt.ki)(Ct,"audioOnly","boolean")||(Ct.audioOnly=!1),(0,lt.ki)(Ct,"videoOnly","boolean")||(Ct.videoOnly=!1),function(wt,Lt){return new Promise(function(Et,$t){wt.mediaTypeForIncomingCall="NONE",Lt.audioOnly===!0?(cn.log("Setting call as audioOnly"),wt.audioOnly=!0,wt.callType="audio",wt.mediaTypeForOutgoingCall="AUDIO",yt(wt,"audio",!0),yt(wt,"video",!1)):Lt.videoOnly===!0?(cn.log("Setting call as videoOnly"),wt.audioOnly=!1,wt.callType="videoOnly",wt.mediaTypeForOutgoingCall="VIDEOONLY",yt(wt,"audio",!1),yt(wt,"video",!0)):(cn.log("Setting call as media"),wt.audioOnly=!1,wt.callType="media",wt.mediaTypeForOutgoingCall="VIDEO",yt(wt,"audio",!0),yt(wt,"video",!0)),wt.updateUserMedia=!0,wt.updateCause="userAction",wt.establishCall(),wt.asyncCallbacks={},wt.asyncCallbacks.type="updateCallConfiguration",wt.asyncCallbacks.resolve=Et,wt.asyncCallbacks.reject=$t,wt.asyncCallbacks.timeoutId=setTimeout(function(){wt.asyncCallbacks&&typeof wt.asyncCallbacks.reject=="function"&&(wt.asyncCallbacks.reject("timeout"),delete wt.asyncCallbacks)},2e4)})}(xt,Ct)):Promise.reject("call not found")},this.findUserMediaById=function(nt){for(var Ct=this.userMediaTable.length;--Ct>=0;)if(this.userMediaTable[Ct].userMediaId===nt)return this.userMediaTable[Ct];return null},this.findCallIndexWithCallIdAndRemoteId=function(nt,Ct){cn.debug("findCallIndexWithCallIdAndRemoteId");var yt,xt=this.callsTable.length;for(cn.trace("callsNumber : "+xt),yt=0;yt<xt;yt+=1)if(this.callsTable[yt].callId===nt&&(cn.log("callId found"),cn.log("this.callsTable[i].callee :"+this.callsTable[yt].callee),cn.log("this.callsTable[i].calleeId :"+this.callsTable[yt].calleeId),this.callsTable[yt].callee===!0&&this.callsTable[yt].callerId===Ct||this.callsTable[yt].callee===!1&&this.callsTable[yt].calleeId===Ct))return yt;return cn.log("Call not found"),-1},this.findCallIndexWithConfIdAndRemoteId=function(nt,Ct){cn.debug("findCallIndexWithConfIdAndRemoteId"),cn.log("confId :"+nt),cn.log("remoteId :"+Ct);var yt,xt=this.callsTable.length;for(yt=0;yt<xt;yt+=1)if(cn.log("this.callsTable[i].data.confId :"+this.callsTable[yt].data.confId),this.callsTable[yt].data.confId===nt){if(this.callsTable[yt].callee===!0&&this.callsTable[yt].callerId===Ct||this.callsTable[yt].callee===!1&&this.callsTable[yt].calleeId===Ct)return yt}else cn.debug("ConfId is different");return cn.debug("Call not found - findCallIndexWithConfIdAndRemoteId"),-1},this.findCallIndexWithCallId=function(nt){cn.debug("findCallIndexWithCallId");var Ct,yt=this.callsTable.length;for(Ct=0;Ct<yt;Ct+=1)if(this.callsTable[Ct].callId===nt)return cn.log("Call found with callId"),Ct;return cn.debug("Call not found - findCallIndexWithCallId"),-1},this.findCallWithCallIdAndInstanceId=function(nt,Ct){cn.debug("findCallWithCallIdAndInstanceId :"+nt+" ,instanceId : "+Ct),Ct===void 0&&cn.debug("instanceId is undefined : must be a mesh publish call, id must be a streamId");var yt,xt=this.callsTable.length;for(cn.trace("callsNumber :"+xt),yt=0;yt<xt;yt+=1)if(this.callsTable[yt].callId===nt&&this.callsTable[yt].instanceId===Ct)return this.callsTable[yt];return cn.debug("Call not found, findCallWithCallIdAndInstanceId"),null},this.findCallIndexWithCallIdAndInstanceId=function(nt,Ct){cn.debug("findCallIndexWithCallIdAndInstanceId :"+nt+" ,instanceId : "+Ct),Ct===void 0&&cn.debug("instanceId is undefined : must be a mesh publish call, id must be a streamId");var yt,xt=this.callsTable.length;for(cn.trace("callsNumber :"+xt),yt=0;yt<xt;yt+=1)if(this.callsTable[yt].callId===nt&&this.callsTable[yt].instanceId===Ct)return yt;return cn.debug("Call not found, findCallIndexWithCallIdAndInstanceId"),-1},this.findCallWithCallId=function(nt){cn.trace("findCallWithCallId :"+nt);var Ct,yt=this.callsTable.length;for(cn.trace("callsNumber :"+yt),Ct=0;Ct<yt;Ct+=1)if(cn.trace("this.callsTable[i].callId :"+this.callsTable[Ct].callId),this.callsTable[Ct].callId===nt)return this.callsTable[Ct];return cn.debug("Call not found"),null},this.findCallWithStreamId=function(nt,Ct){cn.debug("findCallWithStreamId :"+nt);var yt,xt=!(!Ct||!Ct.ignoreModeChangeKindOld),wt=this.callsTable.length;for(cn.trace("callsNumber :"+wt),yt=0;yt<wt;yt+=1)if(cn.log("this.callsTable[i].streamId :"+this.callsTable[yt].streamId),!(this.callsTable[yt].streamId!=nt||xt&&this.callsTable[yt].sessionMCU&&this.callsTable[yt].sessionMCU.modeChangeKind==="old"))return cn.log("Call found"),this.callsTable[yt];return cn.log("Call not found"),null},this.findCallWithCallIdAndRemoteIdAndInstanceId=function(nt,Ct,yt){cn.debug("findCallWithCallIdAndRemoteIdAndInstanceId callId : "+nt+" ,instanceId : "+yt);var xt,wt=this.callsTable.length;for(cn.trace("callsNumber :"+wt),xt=0;xt<wt;xt+=1)if(this.callsTable[xt].callId===nt&&this.callsTable[xt].instanceId===yt&&(this.callsTable[xt].callee===!0&&this.callsTable[xt].callerId===Ct||this.callsTable[xt].callee===!1&&this.callsTable[xt].calleeId===Ct))return this.callsTable[xt];return cn.debug("Call not found"),null},this.findCallWithCallIdAndRemoteId=function(nt,Ct){cn.log("findCallWithCallIdAndRemoteId");var yt,xt=this.callsTable.length;for(cn.trace("callsNumber :"+xt),yt=0;yt<xt;yt+=1)if(this.callsTable[yt].callId===nt&&(this.callsTable[yt].callee===!0&&this.callsTable[yt].callerId===Ct||this.callsTable[yt].callee===!1&&this.callsTable[yt].calleeId===Ct))return this.callsTable[yt];return cn.log("Call not found"),null},this.releaseUserMedia=function(){cn.info("releaseUserMedia"),this.localStream!==null&&(cn.log("stopping localStream"),this.stopStream(this.localStream),Gn.createUserMediaStopEvent(null,"media"),this.accessToLocalMedia=!1,this.autoAnswer=!1,cn.log("this.autoAnswer :"+this.autoAnswer)),this.screenStream!==null&&this.screenStream!==void 0&&(cn.log("stopping screenStream"),this.stopStream(this.screenStream),Gn.createUserMediaStopEvent(null,"screen"))},this.startDataChannelOnCall=function(nt){cn.info("startDataChannelOnCall with callId :"+nt);var Ct=this.findCallWithCallId(nt);Ct?(cn.log("Call found",Ct),Ct.addingDataChannelOnCallOngoing=!0,Ct.createDataChannel()):cn.log("Call not found")},this.sendDataWithCallId=function(nt,Ct,yt){cn.info("sendDataWithCallId :"+nt);var xt=this.findCallWithCallId(nt);xt?(cn.log("Call found",xt),xt.sendData(Ct,yt)):cn.log("Call not found")},this.processDataAck=function(nt){cn.debug("processDataAck",nt);var Ct=this.findCallWithCallId(nt.callId);if(Ct)if(nt.result==="ok")if((0,lt.ki)(nt,"capabilities","object")&&(0,lt.ki)(nt.capabilities,"dataEndAckEnabled","boolean")&&(Ct.dataEndAckEnabled=nt.capabilities.dataEndAckEnabled,cn.debug("dataEndAckEnabled",Ct.dataEndAckEnabled)),nt.state==="complete")Ct.beginTimeoutId&&(clearTimeout(Ct.beginTimeoutId),delete Ct.beginTimeoutId),Ct.callbacks.success({state:"complete",filename:Ct.data.filename,size:Ct.data.size,mediaURL:nt.mediaURL,mediaId:nt.mediaId}),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Ct.callId);else if(nt.state==="incomplete"){var yt,xt,wt=131072,Lt=[],Et=Math.floor(Ct.data.size/wt),$t=Ct.data.size%wt;for(yt=0;yt<Et;yt+=1)(xt=zn("checksum64")).update(Ct.fileContent,yt*wt,wt),Lt.push(xt.digest("hex"));if($t>0&&((xt=zn("checksum64")).update(Ct.fileContent,Et*wt,$t),Lt.push(xt.digest("hex"))),cn.debug(JSON.stringify(Lt)),nt.checksums.length===Lt.length){for(yt=0;yt<Lt.length&&nt.checksums[yt]===Lt[yt];yt+=1);Ct.data.offset=wt*yt}Ct.mediaURL=nt.mediaURL,Ct.mediaId=nt.mediaId,Ct.establishCall()}else nt.state==="missing"?(Ct.mediaURL=nt.mediaURL,Ct.mediaId=nt.mediaId,Ct.establishCall()):nt.state==="ready"?Ct.establishCall():(cn.debug("wrong state "+nt.state),Ct.beginTimeoutId&&(clearTimeout(Ct.beginTimeoutId),delete Ct.beginTimeoutId),Ct.callbacks.failure("serverError"),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Ct.callId));else cn.debug("wrong result "+nt.result),Ct.beginTimeoutId&&(clearTimeout(Ct.beginTimeoutId),delete Ct.beginTimeoutId),Ct.callbacks.failure("serverError"),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Ct.callId);else cn.debug("no such call",nt.callId)},this.processDataEndAck=function(nt){cn.debug("processDataEndAck",nt);var Ct=this.findCallWithCallId(nt.callId);if(Ct){var yt=null;if(!Ct.dcfs){if(!Ct.data||Ct.data.transferType!=="pipeline")return void cn.debug("not pipeline");cn.debug("pipeline"),yt=Ct,Ct.clientCall?(cn.debug("resolve client call"),Ct=Ct.clientCall):(cn.debug("no client call"),Ct=null)}Ct&&(Ct.success&&nt.data&&(Ct.success.data=nt.data),nt.result==="ok"?(nt.complete===!0||(delete Ct.success,Ct.failure="transferIncomplete"),Ct.dcfs.terminateTransfer()):nt.result==="error"&&(delete Ct.success,Ct.failure=nt.errorInfo,Ct.dcfs.terminateTransfer())),yt&&nt.result==="error"&&(cn.debug("error on pipeline"),yt.failure=nt.errorInfo,Gn.createEvent({eventType:"onFileSended",callId:yt.callId,remoteId:yt.remoteId,name:yt.filename,error:yt.failure}),yt.callbacks.failure(yt.failure),this.onHangup(yt.callId))}else cn.debug("no such call",nt.callId)},this.pushData=function(nt,Ct,yt,xt){var wt=this;if(!(0,lt.Ym)(Ct,"object")||((Ct=Object.assign({},Ct)).transferType||(Ct.transferType="file"),Ct.transferType==="file"&&!nt)||Ct.transferType!=="file"&&Ct.transferType!=="pipeline"&&Ct.transferType!=="plugin"||!(Ct.transferType!=="plugin"||Ct.pluginName&&Ct.pluginData))return null;(0,lt.Ym)(xt,"object")||(xt={}),typeof xt.pending!="function"&&(xt.pending=function(){}),typeof xt.progress!="function"&&(xt.progress=function(){}),typeof xt.success!="function"&&(xt.success=function(){}),typeof xt.failure!="function"&&(xt.failure=function(){});var Lt=new bn(apiCC.session.apiCCWebRTCClient.webRTCClient);if(Lt.generateCallId(),Lt.instanceId=apiCC.generateInstanceId(),Lt.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Lt.calleeId="dataChannelConnector",Lt.dest_roomId="dataChannelConnector",Lt.callType="data",Lt.dataCall=!0,Lt.remoteId="dataChannelConnector",Ct.pipelineCallId&&(Lt.pipelineCallId=Ct.pipelineCallId),Lt.data={},Lt.data.pubSub="dataChannelConnector",Lt.data.transferType=Ct.transferType,Ct.transferType==="pipeline"?(Ct.checksumEnabled=!1,Lt.transferCount=0):Ct.transferType==="plugin"&&(Ct.checksumEnabled=!1,Lt.data.pluginName=Ct.pluginName,Lt.data.pluginData=Object.assign({},Ct.pluginData),Lt.data.pluginData.headers&&(Lt.data.pluginData.headers=Object.assign({},Lt.data.pluginData.headers)),Lt.data.pluginData.data&&(Lt.data.pluginData.data=Object.assign({},Lt.data.pluginData.data)),Lt.data.pluginData.formData&&(Lt.data.pluginData.formData=Object.assign({},Lt.data.pluginData.formData))),(0,lt.ki)(Ct,"context","object"))try{JSON.stringify(Ct.context),Lt.data.context=Object.assign({},Ct.context)}catch{}if(Ct.overwrite===!0&&(Lt.data.overwrite=!0),(0,lt.Ym)(Ct,"ttl","number")&&Ct.ttl>0&&(Lt.data.ttl=Ct.ttl),Lt.data.instanceId=Lt.instanceId,nt&&(Lt.data.cloudConvId=nt),Lt.callbacks=xt,yt!=null&&yt.turnServerAddress!==void 0&&yt.turnServerAddress!==null&&Lt.setCallTurnServer(yt.turnServerAddress),Lt.data.transferType==="pipeline")Lt.data.size=0,Lt.pushDataStatus={type:"pipeline",state:"pending",data:Ct},this.callsTable.push(Lt),setTimeout(function(){wt.startNextPushData()});else if((0,lt.Ym)(Ct,"file","object")&&(Ct.file instanceof File||Ct.file.constructor===File||Ct.asFile===!0))(0,lt.Ym)(Ct,"filename","string")?Lt.data.filename=Ct.filename:Lt.data.filename=Ct.file.name,(0,lt.Ym)(Ct,"filetype","string")?Lt.data.contentType=Ct.filetype:Lt.data.contentType=Ct.file.type,(0,lt.Ym)(Ct,"sourceType","string")&&Ct.sourceType.length>0&&(Lt.data.sourceType=Ct.sourceType),Lt.data.size=Ct.file.size,Lt.data.metadata=Ct.metadata,Lt.pushDataStatus={type:"file",state:"pending",convId:String(nt),data:Ct},this.callsTable.push(Lt),setTimeout(function(){wt.startNextPushData()});else{if(!(0,lt.Ym)(Ct,"buffer","object")||!(Ct.buffer instanceof ArrayBuffer||Ct.buffer.constructor===ArrayBuffer||Ct.asBuffer===!0)||!(0,lt.Ym)(Ct,"filename","string")||!(0,lt.Ym)(Ct,"filetype","string"))return null;Lt.data.filename=Ct.filename,Lt.data.contentType=Ct.filetype,(0,lt.Ym)(Ct,"sourceType","string")&&Ct.sourceType.length>0&&(Lt.data.sourceType=Ct.sourceType),Lt.data.size=Ct.buffer.byteLength,Lt.data.metadata=Ct.metadata,Lt.pushDataStatus={type:"buffer",state:"pending",convId:String(nt),data:Ct},this.callsTable.push(Lt),setTimeout(function(){wt.startNextPushData()})}return Lt.callId},this.startNextPushData=function(){for(var nt=this,Ct=[],yt=0;yt<this.callsTable.length;yt+=1){var xt=this.callsTable[yt];if(xt.callType==="data"&&xt.dataCall&&xt.remoteId==="dataChannelConnector"&&xt.pushDataStatus){if(xt.pushDataStatus.state==="ready")continue;Ct.push(xt)}}if(Ct.length===0)return!1;var wt=null;Ct[0].pushDataStatus.state==="active"?Ct.splice(0,1):Ct[0].pushDataStatus.state==="pending"&&(wt=Ct[0],Ct.splice(0,1));for(var Lt=0;Lt<Ct.length;Lt+=1){var Et=Ct[Lt];Et.pushDataStatus.rank!==Lt&&(Et.pushDataStatus.rank=Lt,Gn.createEvent({eventType:"onFilePending",callId:Et.callId,remoteId:Et.remoteId,name:Et.data.filename,rank:Lt}),Et.callbacks.pending({state:"pending",callId:Et.callId,rank:Lt}))}if(!wt)return!1;cn.debug("startNextPushData",wt.callId);var $t=wt.pushDataStatus.data;if(delete wt.pushDataStatus.data,wt.pushDataStatus.type==="pipeline"){wt.pushDataStatus.state="active";var Jt={type:"pushData",callerId:apiCC.session.apiCCId,callId:wt.callId,data:wt.data},en=JSON.stringify(Jt);return cn.debug("C->S: "+en),apiCC.session.channel.socket.emit("pushData",en),!0}if(wt.pushDataStatus.type==="file"){wt.pushDataStatus.state="active";var qt=new FileReader;qt.onload=function(on){apiCC.session.apiCCWebRTCClient.webRTCClient.startPushData(wt,$t,on.target.result)},qt.readAsArrayBuffer($t.file)}else{if(wt.pushDataStatus.type!=="buffer")return cn.error("startNextPushData - wrong type"),wt.callbacks.failure("start",wt.callId),this.onHangup(wt.callId),!1;wt.pushDataStatus.state="active",this.startPushData(wt,$t,$t.buffer)}return wt.beginTimeoutId=setTimeout(function(){delete wt.beginTimeoutId,wt.callbacks.failure("timeout",wt.callId),nt.onHangup(wt.callId)},2e4),!0},this.startPushData=function(nt,Ct,yt){if(nt.fileContent=new Uint8Array(yt),nt.pipelineCallId){var xt=this.findCallWithCallId(nt.pipelineCallId);if(!xt)return cn.error("no such pipeline call"),void this.onHangup(nt.callId);nt.pipelineCall=xt,xt.clientCall=nt,nt.sendDataChannel=xt.sendDataChannel;var wt=xt.transferCount===0?100:0;nt.startTransfer({delay:wt}),xt.transferCount+=1}else{if(!Object.prototype.hasOwnProperty.call(Ct,"checksumEnabled")||Ct.checksumEnabled){var Lt=zn("checksum64");Lt.update(nt.fileContent),nt.data.checksum=Lt.digest("hex")}else nt.data.checksumEnabled=!1;var Et={type:"pushData",callerId:apiCC.session.apiCCId,convId:nt.pushDataStatus.convId,callId:nt.callId,data:nt.data},$t=JSON.stringify(Et);cn.debug("C->S: "+$t),apiCC.session.channel.socket.emit("pushData",$t)}},this.cancelPushData=function(nt){for(var Ct=null,yt=this.callsTable.length;--yt>=0;){var xt=this.callsTable[yt];if(xt.callId===nt&&xt.callType==="data"&&xt.dataCall&&xt.remoteId==="dataChannelConnector"&&xt.pushDataStatus){Ct=xt;break}}if(!Ct)return cn.error("cancelPushData - no such call",nt),"no such call";if(Ct.pushDataStatus.state==="pending")Gn.createEvent({eventType:"onFileSended",callId:Ct.callId,remoteId:Ct.remoteId,name:Ct.data.filename,error:"canceled"}),Ct.callbacks.failure("canceled"),this.onHangup(Ct.callId);else if(Ct.pushDataStatus.state==="active")this.onHangup(Ct.callId);else{if(Ct.pushDataStatus.state!=="ready")return cn.error("cancelPushData - wrong state"),"wrong state";Ct.clientCall&&this.cancelPushData(Ct.clientCall.callId),Ct.success={state:"complete"},Gn.createEvent({eventType:"onFileSended",callId:Ct.callId,remoteId:Ct.remoteId}),Ct.callbacks.success(Ct.success),this.onHangup(Ct.callId)}return null},this.setVideoBandwidth=function(nt,Ct,yt){if(typeof nt=="number"){var xt=!1,wt=!1;if(Ct==="overall"?yt==="incoming"?nt>0?(this.videoBandwidthSettings.overallIncoming=nt,xt=!0):(delete this.videoBandwidthSettings.overallIncoming,xt=!0):yt==="outgoing"&&(nt>0?(this.videoBandwidthSettings.overallOutgoing=nt,xt=!0,wt=!0):(delete this.videoBandwidthSettings.overallOutgoing,xt=!0,wt=!0)):Ct==="perCall"?yt==="incoming"?nt>0?(this.videoBandwidthSettings.perCallIncoming=nt,xt=!0):(delete this.videoBandwidthSettings.perCallIncoming,xt=!0):yt==="outgoing"&&(nt>0?(this.videoBandwidthSettings.perCallOutgoing=nt,xt=!0,wt=!0):(delete this.videoBandwidthSettings.perCallOutgoing,xt=!0,wt=!0)):Ct==="remote"&&(this.videoRemoteBandwidth=nt),xt)for(var Lt=this.MCUClient.sessionMCUs.length;--Lt>=0;){var Et={type:"info",infoType:"setVideoBandwidthSettings",data:{clientId:this.clientId,roomId:this.MCUClient.sessionMCUs[Lt].roomName,pubSub:this.MCUClient.pubConnector,videoBandwidthSettings:this.videoBandwidthSettings}},$t=JSON.stringify(Et);cn.log("C->S: "+$t),apiCC.session.channel.socket.emit("info",$t)}wt&&this.evalOutgoingVideoBandwithCap()}else cn.error("Unvalid target bandwidth usage value needs to be a number :",nt)},this.setAudioBandwidth=function(nt){this.audioBandwidth=nt},this.setDataBandwidth=function(nt){this.dataBandwidth=nt},this.processCheckCallStatus=function(nt){this.MCUClient.processCheckCallStatus(nt);var Ct={type:"updateCallStatus",clientId:this.clientId,data:{}};nt.data.pubSub&&(Ct.data.pubSub=nt.data.pubSub),Ct.sessions=[];for(var yt=0;yt<this.MCUClient.sessionMCUs.length;yt+=1)Ct.sessions.push(this.MCUClient.createSessionDescriptor(this.MCUClient.sessionMCUs[yt]));Ct.calls=[];for(var xt=0;xt<this.userMediaTable.length;xt+=1){var wt=this.userMediaTable[xt];Ct.calls.push({callId:wt.userMediaId,callType:wt.callType,remoteId:wt.remoteId,roomId:wt.roomId,data:wt.data,meshPublish:!0})}for(var Lt=0;Lt<this.callsTable.length;Lt+=1){var Et=this.callsTable[Lt];Ct.calls.push({callId:Et.callId,callType:Et.callType,remoteId:Et.remoteId,roomId:Et.roomId,data:Et.data,remoteStream:Et.mcuRemoteStream})}var $t=JSON.stringify(Ct);apiCC.session.channel.socket.emit("updateCallStatus",$t)},this.processRemoteStreamAdded=function(nt,Ct){if(nt.sessionMCU&&nt.sessionMCU.modeChangeKind==="new"){cn.debug("processRemoteStreamAdded",nt);var yt=this.MCUClient.getSessionMCU(null,{callback:function(wt){return wt.roomName===nt.sessionMCU.roomName&&wt.modeChangeKind==="old"}});if(!yt)return void cn.error("wrong roomId: no such old session");cn.debug("oldSessionMCU",yt);for(var xt=this.callsTable.length;--xt>=0;)if(this.callsTable[xt].sessionMCU===yt&&(0,lt.ki)(this.callsTable[xt],["mcuRemoteStream","attributes","callId"],"string")&&this.callsTable[xt].mcuRemoteStream.attributes.callId===nt.mcuRemoteStream.attributes.callId){cn.debug("processRemoteStreamAdded: bye",this.callsTable[xt]),this.removeCallFromTableWithCallIdAndSendBye(this.callsTable[xt].callId);break}}},this.processDistantCallEstablished=function(nt){if(cn.debug("processDistantCallEstablished",nt),(0,lt.ki)(nt,["descriptor","callFeed","callId"],"string"))if(nt.descriptor.callFeed.clientId===this.clientId){var Ct=null;if(nt.descriptor.callMode==="mesh"?Ct=this.MCUClient.getSessionMCU(null,{callback:function(En){return En.roomName===nt.descriptor.roomId&&En.roomMode==="mesh"}}):nt.descriptor.callMode==="sfu"&&(Ct=this.MCUClient.getSessionMCU(null,{callback:function(En){return En.roomName===nt.descriptor.roomId&&!En.hasOwnProperty("roomMode")}})),Ct){cn.debug("sessionMCU",Ct);var yt=null,xt=null;if(nt.descriptor.callMode==="mesh"?(yt=this.findUserMediaById(nt.descriptor.callFeed.callId),cn.debug("userMedia",yt)):(xt=this.findCallWithCallId(nt.descriptor.callFeed.callId),cn.debug("call",xt)),nt.active){if(!yt&&!xt)return void cn.debug("wrong callId: no such call");for(var wt=this.MCUClient.distantCalls.length;--wt>=0&&(this.MCUClient.distantCalls[wt].roomId!==nt.descriptor.roomId||this.MCUClient.distantCalls[wt].clientId!==nt.descriptor.clientId||this.MCUClient.distantCalls[wt].callId!==nt.descriptor.callId););if(wt>=0){if(!this.MCUClient.distantCalls[wt].early)return void cn.debug("processDistantCallEstablished: descriptor already exists");cn.debug("processDistantCallEstablished: replace early descriptor",this.MCUClient.distantCalls[wt],nt.descriptor),this.MCUClient.distantCalls[wt]=nt.descriptor}else cn.debug("processDistantCallEstablished: add descriptor",nt.descriptor),this.MCUClient.distantCalls.push(nt.descriptor)}else if(Ct.modeChangeKind==="old"){for(var Lt=this.MCUClient.distantCalls.length;--Lt>=0;)if(this.MCUClient.distantCalls[Lt].roomId===nt.descriptor.roomId&&this.MCUClient.distantCalls[Lt].clientId===nt.descriptor.clientId&&this.MCUClient.distantCalls[Lt].callId===nt.descriptor.callId){cn.debug("processDistantCallEstablished: set descriptor to removed",this.MCUClient.distantCalls[Lt]),this.MCUClient.distantCalls[Lt].removed=!0;break}}else for(var Et=this.MCUClient.distantCalls.length;--Et>=0;)if(this.MCUClient.distantCalls[Et].roomId===nt.descriptor.roomId&&this.MCUClient.distantCalls[Et].clientId===nt.descriptor.clientId&&this.MCUClient.distantCalls[Et].callId===nt.descriptor.callId){cn.debug("processDistantCallEstablished: remove descriptor",this.MCUClient.distantCalls[Et]),this.MCUClient.distantCalls.splice(Et,1);break}if(Ct.modeChangeKind==="new"){var $t=this.MCUClient.getSessionMCU(null,{callback:function(En){return En.roomName===nt.descriptor.roomId&&En.modeChangeKind==="old"}});if(!$t)return void cn.error("wrong roomId: no such old session");cn.debug("oldSessionMCU",$t),cn.debug("processDistantCallEstablished: replacement");for(var Jt=!1,en=this.userMediaTable.length;--en>=0;){var qt=this.userMediaTable[en];if(qt.sessionMCU===$t){var on=!1,hn=0;cn.debug("processDistantCallEstablished: userMedia",qt);for(var nn=qt.distantCalls.length;--nn>=0;)qt.distantCalls[nn].replaced?hn+=1:qt.distantCalls[nn].callFeed.callId===nt.descriptor.callFeed.callId&&(cn.debug("processDistantCallEstablished: distantCall",qt.distantCalls[nn]),on=!0,qt.distantCalls[nn].replaced=!0,hn+=1);if(on){if(hn===qt.distantCalls.length){cn.debug("processDistantCallEstablished: remove replaced distant call descriptors");for(var dn=this.MCUClient.distantCalls.length;--dn>=0;)this.MCUClient.distantCalls[dn].callMode==="mesh"&&this.MCUClient.distantCalls[dn].callFeed.callId===qt.userMediaId&&this.MCUClient.distantCalls[dn].replaced&&(cn.debug("processDistantCallEstablished: remove distantCall",this.MCUClient.distantCalls[dn]),this.MCUClient.distantCalls.splice(dn,1));cn.debug("processDistantCallEstablished: close old calls");for(var Sn=this.callsTable.slice(),wn=Sn.length;--wn>=0;)(0,lt.ki)(Sn[wn].data,"mesh","object")&&Sn[wn].data.mesh.calleeCallId===qt.userMediaId&&Sn[wn].settingUpType!=="subscribe"&&this.removeCallFromTableWithCallIdAndSendBye(Sn[wn].callId);this.MCUClient.meshOnHangup(qt.userMediaId),Jt=!0}break}}}Jt&&this.finalizeMeshToJanusTransition($t,Ct)}}else cn.debug("wrong roomId: no such session")}else cn.debug("wrong clientId: message not intended for self");else cn.debug("wrong format: missing callFeed")},this.finalizeMeshToJanusTransition=function(nt,Ct){var yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};cn.debug("finalizeMeshToJanusTransition");var xt=0,wt=0;if(yt.force===!0){for(var Lt=this.callsTable.slice(),Et=Lt.length;--Et>=0;){var $t=Lt[Et];$t.sessionMCU===nt&&(($t.settingUpType==="publish"||$t.settingUpType==="shareScreen")&&$t.data&&$t.data.mesh?this.onHangup($t.callId):this.onHangup($t.callId,"disconnected"))}for(var Jt=this.userMediaTable.slice(),en=Jt.length;--en>=0;){var qt=Jt[en];qt.sessionMCU===nt&&this.onHangup(qt.userMediaId,"disconnected")}}else for(var on=this.userMediaTable.length;--on>=0;){var hn=this.userMediaTable[on];if(hn.sessionMCU===nt){xt+=1;for(var nn=0,dn=hn.distantCalls.length;--dn>=0;)cn.debug("finalizeMeshToJanusTransition: distantCall",hn.distantCalls[dn]),hn.distantCalls[dn].replaced&&(nn+=1);nn===hn.distantCalls.length&&(wt+=1)}}xt===wt&&(cn.debug("finalizeMeshToJanusTransition: finalize transition"),Ct.transitionTimeoutId&&(clearTimeout(Ct.transitionTimeoutId),delete Ct.transitionTimeoutId),this.MCUClient.removeSessionMCU(nt),delete Ct.modeChangeKind,this.MCUClient.transitionCount-=1,this.MCUClient.transitionCount<=0&&this.evalOutgoingVideoBandwithCap(),Gn.createMCURoomModeChangedEvent(Ct.roomName,"mesh","sfu","complete"))},this.processConfigureEncodings=function(nt){var Ct=this.findCallWithCallId(nt.callId);if(Ct&&Object.prototype.hasOwnProperty.call(nt,"command")&&Ct.simulcast==="RID"){var yt={};Object.prototype.hasOwnProperty.call(nt,"maxBitrate")&&(yt.maxBitrate=nt.maxBitrate),Ct.configureSimulcastEncodings(nt.command,yt)}},this.processSimulcastFeedChanged=function(nt){var Ct=this.findCallWithCallId(nt.callId);if(Ct){var yt={};nt.substream===2?yt.streamQuality="high":nt.substream===1?yt.streamQuality="medium":nt.substream===0&&(yt.streamQuality="low"),nt.temporal===2?yt.streamFrameRate="high":nt.temporal===1?yt.streamFrameRate="medium":nt.temporal===0&&(yt.streamFrameRate="low"),Object.keys(yt).length>0&&Gn.createSimulcastFeedChanged(Ct.callId,yt)}},this.hasReceiptHook=function(nt){if(!nt||typeof nt!="string")throw new Error("wrong receiptId");return Object.prototype.hasOwnProperty.call(this.receiptHooks,nt)},this.createReceiptHook=function(nt,Ct){var yt=this;if(this.hasReceiptHook(nt))throw new Error("receiptHook already exists");if(!Ct||Ct.fulfilled!==!1)throw new Error("wrong future");Ct.onFulfillment(function(){delete yt.receiptHooks[nt]}),this.receiptHooks[nt]=Ct},this.finalizeReceiptHookFailure=function(nt,Ct){if(cn.debug("finalizeReceiptHookFailure",nt,Ct),!nt||typeof nt!="string")throw new Error("wrong receiptId");if(!Object.prototype.hasOwnProperty.call(this.receiptHooks,nt))throw new Error("receiptHook does not exist");this.receiptHooks[nt].fulfill(Ct)},this.finalizeReceiptHookSuccess=function(nt,Ct){if(cn.debug("finalizeReceiptHookSuccess",nt,Ct),!nt||typeof nt!="string")throw new Error("wrong receiptId");if(!Object.prototype.hasOwnProperty.call(this.receiptHooks,nt))throw new Error("receiptHook does not exist");this.receiptHooks[nt].fulfill(null,Ct)},this.processReceipt=function(nt){if(nt&&lr(nt)==="object"){var Ct=nt.receiptId,yt=nt.result;if(Ct&&typeof Ct=="string")try{this.finalizeReceiptHookSuccess(Ct,yt)}catch(xt){cn.debug("processReceipt: finalizeReceiptHookSuccess",xt)}else cn.warn("processReceipt: wrong receiptId")}else cn.warn("processReceipt: wrong msg")},this.processError=function(nt){var Ct=nt.receiptId,yt=nt.errorInfo,xt=nt.errorCode,wt=nt.callId,Lt=nt.roomId,Et=nt.convId;if(Ct&&typeof Ct=="string")try{this.finalizeReceiptHookFailure(Ct,new Error(yt))}catch($t){cn.debug("processError: finalizeReceiptHookFailure",$t)}Gn.createErrorEvent(yt,xt,wt,Lt,null,null,Et)},this.createCallControl=function(nt){var Ct=new Qn(nt);return this.callControlTable.push(Ct),Ct},this.destroyCallControl=function(nt){if(nt.multi){if(!nt.roomName)return cn.warn("findCallControl: cannot destroy without roomName"),null;for(var Ct=[],yt=this.callControlTable.length;--yt>=0;)this.callControlTable[yt].roomName===nt.roomName&&(Ct.push(this.callControlTable[yt]),this.callControlTable.splice(yt,1));return Ct}var xt=this.findCallControl(nt,{accept:"index"});if(xt!==null&&xt>=0){var wt=this.callControlTable[xt];return this.callControlTable.splice(xt,1),wt}return null},this.findCallControl=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=Ct.accept==="index";if(nt.type==="publish"||nt.type==="shareScreen"){if(!nt.callId)return cn.warn("findCallControl: cannot search without callId"),null;for(var xt=null,wt=null,Lt=this.callControlTable.length;--Lt>=0;)if((this.callControlTable[Lt].type==="publish"||this.callControlTable[Lt].type==="shareScreen")&&this.callControlTable[Lt].callId===nt.callId){xt=this.callControlTable[Lt],wt=Lt;break}return xt?yt?wt:xt:null}if(nt.type==="subscribe"){if(!(0,lt.ki)(nt,"stream","object")||!Object.prototype.hasOwnProperty.call(nt.stream,"id")||!(0,lt.ki)(nt.stream,"attributes","object"))return cn.warn("findCallControl: cannot search without stream"),null;for(var Et=null,$t=null,Jt=this.callControlTable.length;--Jt>=0;)if(this.callControlTable[Jt].type==="subscribe"&&(this.callControlTable[Jt].stream.id===nt.stream.id||this.callControlTable[Jt].stream.attributes.callerId===nt.stream.attributes.callerId&&this.callControlTable[Jt].stream.attributes.callId===nt.stream.attributes.callId)){Et=this.callControlTable[Jt],$t=Jt;break}return Et?yt?$t:Et:null}return cn.warn("findCallControl: wrong type",nt.type),null},this.getCallControls=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt={};if(Ct.addUserMedia)for(var xt=this.userMediaTable.length;--xt>=0;){var wt=this.userMediaTable[xt];yt[wt.userMediaId]=wt}if(nt){for(var Lt=this.callControlTable.length;--Lt>=0;){var Et=this.callControlTable[Lt];nt.indexOf(Et.type)>=0&&(yt[Et.callId]=Et)}return yt}for(var $t=this.callControlTable.length;--$t>=0;){var Jt=this.callControlTable[$t];yt[Jt.callId]=Jt}return yt},this.getCallIds=function(nt){for(var Ct=[],yt=this.callControlTable.length;--yt>=0;){var xt=this.callControlTable[yt];nt.indexOf(xt.type)>=0&&Ct.push(xt.callId)}return Ct},this.evalOutgoingVideoBandwithCap=function(nt){if(cn.debug("evalOutgoingVideoBandwithCap"),!(this.MCUClient.transitionCount>0)){var Ct=null;this.videoBandwidthSettings.perCallOutgoing&&(Ct=this.videoBandwidthSettings.perCallOutgoing);for(var yt=[],xt=this.callsTable.length;--xt>=0;)this.callsTable[xt].belongsToRoom()&&this.callsTable[xt].settingUpType!=="publish"&&this.callsTable[xt].settingUpType!=="shareScreen"||this.callsTable[xt].localCallProfile&&this.callsTable[xt].localCallProfile.video&&this.callsTable[xt].localCallProfile.videoActive&&yt.push(this.callsTable[xt]);if(yt.length===0)return Ct;if(this.videoBandwidthSettings.overallOutgoing){var wt=Math.floor(this.videoBandwidthSettings.overallOutgoing/yt.length);Ct=Ct?Math.min(Ct,wt):wt}for(var Lt=yt.length;--Lt>=0;)nt&&yt[Lt]===nt?Ct&&yt[Lt].videoCap!==Ct?(yt[Lt].videoCap=Ct,this.rtpSenderSetParamatersCapable&&yt[Lt].applyOutgoingBitrate(yt[Lt].videoCap)):!Ct&&yt[Lt].videoCap&&(delete yt[Lt].videoCap,this.rtpSenderSetParamatersCapable&&yt[Lt].applyOutgoingBitrate(null)):Ct&&yt[Lt].videoCap!==Ct?(yt[Lt].videoCap=Ct,this.rtpSenderSetParamatersCapable?yt[Lt].applyOutgoingBitrate(yt[Lt].videoCap):setTimeout(function(Et){Et.belongsToRoom()||!Et.callee?(Et.updateUserMedia=!0,Et.establishCall()):cn.debug("Call is not to be updated")},0,yt[Lt])):!Ct&&yt[Lt].videoCap&&(delete yt[Lt].videoCap,this.rtpSenderSetParamatersCapable?yt[Lt].applyOutgoingBitrate(null):setTimeout(function(Et){Et.belongsToRoom()||!Et.callee?(Et.updateUserMedia=!0,Et.establishCall()):cn.debug("Call is not to be updated")},0,yt[Lt]));return Ct}cn.debug("evalOutgoingVideoBandwithCap - transition ongoing")},this.callback=function(nt,Ct){return this.closureHandler=function(yt){return nt[Ct](yt)},this.closureHandler},this.callbackWithParams=function(nt,Ct){return this.closureHandler=function(yt,xt,wt){return nt[Ct](yt,xt,wt)},this.closureHandler},this.simulatedAgentLaunchWaitingCall=function(){this.socket.emit("simulatedAgentLaunchWaitingCall",{type:"simulatedAgentLaunchWaitingCall"})}},Bn=(s(2707),et.Y.get("PreCallTest")),rr=125e3,Zn=2e4,_n=apiCC.myWebRTC_Event,Ln=function(Kt,Rt,nt,Ct,yt){var xt=this;this.webRTCClient=Kt.webRTCClient,this.notifyTerminated=Kt.notifyTerminated,this.audioSourceId=Ct,this.videoSourceId=yt,this.testId="initial",this.stepId="initial",this.report={tests:[],resolutions:[],failurCause:""},this.maxHeight=240,this.maxWidth=320,this.resolutions=[[320,240,"QVGA"],[640,480,"VGA"],[1024,576,"SD"],[1280,720,"HD 720p"],[1920,1080,"HD 1080p"]],this.currentResolution=0,this.userMediastreamId=null,nt==="simpleVideoRecordTest"&&(Bn.warn("Simple video record test is activated"),this.simpleVideoRecordTest=!0),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshModeEnabled===!0&&(Bn.debug("Forcing meshModeEnabled to false for precall test"),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshModeEnabled=!1,this.modifyMeshModeEnabledValueBeforePreCall=!0),this.generateId=function(wt){for(var Lt="",Et="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",$t=0;$t<wt;$t+=1)Lt+=Et.charAt(Math.floor(Math.random()*Et.length));return Lt},this.generateRoomId=function(){return"PC-"+this.generateId(4)+"-"+this.generateId(4)+"-"+this.generateId(4)},this.pushStats=function(wt,Lt){return wt.data.push(Lt),!0},this.evalQuartiles=function(wt,Lt,Et){var $t=[];if(Et===void 0?wt.forEach(function(Qr){typeof Qr[Lt]=="number"&&$t.push(Qr[Lt])}):wt.forEach(function(Qr){$t.push(Et(Qr[Lt]))}),$t.sort(function(Qr,Yr){return Qr<Yr?-1:Qr===Yr?0:1}),$t.length%2==0){var Jt=$t.length/2,en=Math.floor(($t[Jt-1]+$t[Jt])/2);if(Jt%2==0){var qt=Jt/2,on=Math.floor(($t[qt-1]+$t[qt])/2),hn=Jt+qt,nn=Math.floor(($t[hn-1]+$t[hn])/2);return{min:$t[0],firstQuartile:on,median:en,thirdQuartile:nn,max:$t[$t.length-1]}}var dn=Math.floor(Jt/2),Sn=$t[dn],wn=$t[Jt+dn];return{min:$t[0],firstQuartile:Sn,median:en,thirdQuartile:wn,max:$t[$t.length-1]}}var En=Math.floor($t.length/2),Pn=$t[En];if((En+1)%2==0){var Wn=(En+1)/2,ir=Math.floor(($t[Wn-1]+$t[Wn])/2),fr=En+Wn,gr=Math.floor(($t[fr-1]+$t[fr])/2);return{min:$t[0],firstQuartile:ir,median:Pn,thirdQuartile:gr,max:$t[$t.length-1]}}var yr=Math.floor(En/2),Rr=$t[yr],kr=$t[En+yr];return{min:$t[0],firstQuartile:Rr,median:Pn,thirdQuartile:kr,max:$t[$t.length-1]}},this.runBitRateTest=function(){apiCC.webRTCCompliant?(Bn.debug("Run bitrate test"),this.testId==="initial"&&(this.handlers=[{type:"joinMCUSessionAnswer",callback:this.handleJoinMCUSessionAnswer.bind(this)},{type:"MCUAvailableStream",callback:this.handleMCUAvailableStream.bind(this)},{type:"onCallStatsUpdate",callback:this.handleOnCallStatsUpdate.bind(this)},{type:"remoteStreamAdded",callback:this.handleRemoteStreamAdded.bind(this)},{type:"userMediaSuccess",callback:this.handleuserMediaSuccess.bind(this)},{type:"MCURecordedStreamsAvailable",callback:this.handleRecordingStreamAvailable.bind(this)}],this.handlers.forEach(function(wt){apiRTC.addEventListener(wt.type,wt.callback)}),this.webRTCClient.setMCUConnector("mcu4.apizee.com"),this.webRTCClient.setAllowMultipleCalls(!0),this.webRTCClient.enableCallStatsMonitoring(!0,1e3),this.webRTCClient.enableQualityEvaluating(!0,1e3),this.startNextTest())):(this.report.failurCause="Your device is not WebRTC Compliant",this.terminate())},this.startNextTest=function(){if(this.simpleVideoRecordTest===!0)this.testId==="initial"?(Bn.debug("initial simple test"),Rt?this.runResolutionTest():this.startTestAudioNlVideo(2e3)):this.testId==="resolution-test"?(Bn.debug("resolution-test simple"),this.startTestAudioNlVideo(2e3)):this.testId==="audio-and-video-2000"&&(Bn.debug("Before recordThenTerminate simple"),this.recordThenTerminate());else if(this.testId==="initial")Rt?this.runResolutionTest():this.startTestAudioNlVideo(nt);else if(this.testId==="resolution-test")this.startTestAudioNlVideo(nt);else if(this.testId==="audio-and-video-"+nt)if(this.report[this.testId].status==="success"){var wt=this.report[this.testId].subscribeCallIds[0],Lt=this.stats[wt].videoReceived;Lt.bitsReceivedPerSecond.max!==void 0&&Lt.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():Lt.bitsReceivedPerSecond.max>=15e5?this.startTestAudioNlVideo(1500):Lt.bitsReceivedPerSecond.max>=1e6?this.startTestAudioNlVideo(1e3):Lt.bitsReceivedPerSecond.max>=6e5?this.startTestAudioNlVideo(600):Lt.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-1500")if(this.report[this.testId].status==="success"){var Et=this.report[this.testId].subscribeCallIds[0],$t=this.stats[Et].videoReceived;$t.bitsReceivedPerSecond.max!==void 0&&$t.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():$t.bitsReceivedPerSecond.max>=1e6?this.startTestAudioNlVideo(1e3):$t.bitsReceivedPerSecond.max>=6e5?this.startTestAudioNlVideo(600):$t.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-1000")if(this.report[this.testId].status==="success"){var Jt=this.report[this.testId].subscribeCallIds[0],en=this.stats[Jt].videoReceived;en.bitsReceivedPerSecond.max!==void 0&&en.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():en.bitsReceivedPerSecond.max>=6e5?this.startTestAudioNlVideo(600):en.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-600")if(this.report[this.testId].status==="success"){var qt=this.report[this.testId].subscribeCallIds[0],on=this.stats[qt].videoReceived;on.bitsReceivedPerSecond.max!==void 0&&on.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():on.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-250")if(this.report[this.testId].status==="success"){var hn=this.report[this.testId].subscribeCallIds[0],nn=this.stats[hn].videoReceived;nn.bitsReceivedPerSecond.max!==void 0&&nn.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else this.recordThenTerminate()},this.startTestAudioNlVideo=function(wt){this.prepareEnvForNewTest(),Bn.debug("%ctestAudioNlVideo"+wt),this.testId="audio-and-video-"+wt,this.report.tests.push(this.testId),this.audioEnabled=!0,this.videoEnabled=!0,this.videoBandwidth=wt,this.webRTCClient.setRemoteVideoBandwidth(this.videoBandwidth),this.stats={},this.report[this.testId]={audioEnabled:!0,audioLimited:!1,videoEnabled:!0,videoLimited:!0,videoBandwidth:this.videoBandwidth,stats:this.stats},this.mcuSession={},this.mcuSession.roomId=this.generateRoomId(),this.report[this.testId].roomId=this.mcuSession.roomId,this.webRTCClient.joinMCUSession(this.mcuSession.roomId),this.stepId="joining-mcu-session",this.timeoutId=setTimeout(this.abortJoinMCUSession.bind(this),Zn)},this.startTestAudioNlOnly=function(){this.prepareEnvForNewTest(),Bn.debug("%cstartTestAudioNlOnly"),this.testId="audio-only",this.report.tests.push(this.testId),this.audioEnabled=!0,this.videoEnabled=!1,this.webRTCClient.setRemoteVideoBandwidth(null),this.stats={},this.report[this.testId]={audioEnabled:!0,audioLimited:!1,videoEnabled:!1,stats:this.stats},this.mcuSession={},this.mcuSession.roomId=this.generateRoomId(),this.report[this.testId].roomId=this.mcuSession.roomId,this.webRTCClient.joinMCUSession(this.mcuSession.roomId),this.stepId="joining-mcu-session",this.timeoutId=setTimeout(this.abortJoinMCUSession.bind(this),Zn)},this.startTestVideoNlOnly=function(){this.prepareEnvForNewTest(),Bn.debug("%cstartTestVideoNlOnly"),this.testId="video-only",this.report.tests.push(this.testId),this.audioEnabled=!1,this.videoEnabled=!0,this.videoBandwidth=600,this.webRTCClient.setRemoteVideoBandwidth(this.videoBandwidth),this.stats={},this.report[this.testId]={audioEnabled:!1,audioLimited:!1,videoEnabled:!0,stats:this.stats},this.mcuSession={},this.mcuSession.roomId=this.generateRoomId(),this.report[this.testId].roomId=this.mcuSession.roomId,this.webRTCClient.joinMCUSession(this.mcuSession.roomId),this.stepId="joining-mcu-session",this.timeoutId=setTimeout(this.abortJoinMCUSession.bind(this),Zn)},this.recordThenTerminate=function(){xt.modifyMeshModeEnabledValueBeforePreCall===!0&&(Bn.debug("Restoring meshModeEnabled to true, as it was modified for precall test"),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshModeEnabled=!0);var wt=null;if(xt.videoEnabled&&xt.audioEnabled?wt="AUDIO-VIDEO":xt.audioEnabled?wt="AUDIO-ONLY":xt.videoEnabled&&(wt="VIDEO-ONLY"),!wt)return Bn.error("Can't define record type"),void xt.terminate();Bn.debug("Start recording with type:",wt),xt.webRTCClient.startRecording(wt,"recordPreCall",null,null,{ttl:900}),setTimeout(function(){Bn.debug("Stop recording"),xt.webRTCClient.stopRecording()},1e4)},this.terminate=function(){Bn.debug("Terminate"),this.testId="terminated",this.handlers&&this.handlers.forEach(function(wt){apiRTC.removeEventListener(wt.type,wt.callback)}),this.notifyTerminated(this.report),this.leaveSession()},this.succeed=function(){_n.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"success",stepId:this.stepId}),this.report[this.testId].status="success",this.startNextTest()},this.fail=function(){Bn.debug("fail"),_n.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"failure",stepId:this.stepId}),this.report[this.testId].status="failure",this.report[this.testId].stepId=this.stepId,this.leaveSession(),this.startNextTest()},this.prepareEnvForNewTest=function(){xt.mcuSession!==void 0&&xt.leaveSession()},this.abortJoinMCUSession=function(){Bn.debug("abortJoinMCUSession"),this.fail()},this.abortStreamPublishing=function(){Bn.debug("abortStreamPublishing"),this.fail()},this.abortStreamSubscribing=function(){Bn.debug("abortStreamSubscribing"),this.fail()},this.observeStreamPublished=function(){if(Bn.debug("observeStreamPublished"),apiRTC.browser==="Safari"||apiRTC.browser==="Mobile Safari")return Bn.info("Safari"),Bn.error("observeStreamPublished not supported on Safari"),clearInterval(this.intervalId),void this.fail();if(this.intervalCounter+=1,this.intervalCounter>30)return clearInterval(this.intervalId),void this.fail();if(this.audioEnabled&&this.videoEnabled){var wt=0;if(this.stats[this.publishCallId]!==void 0&&(this.stats[this.publishCallId].audioSent!==void 0&&this.stats[this.publishCallId].audioSent.bitsSentPerSecond!==void 0&&this.stats[this.publishCallId].audioSent.bitsSentPerSecond.thirdQuartile>=2e4&&(wt+=1),this.stats[this.publishCallId].videoSent!==void 0&&this.stats[this.publishCallId].videoSent.bitsSentPerSecond!==void 0&&this.stats[this.publishCallId].videoSent.bitsSentPerSecond.thirdQuartile>=rr&&(wt+=1)),wt===2){clearInterval(this.intervalId);var Lt=this.streams[0];this.subscribeToUserStream(Lt.attributes.callerId,Lt.id,"VIDEO"),this.stepId="stream-subscribing",this.timeoutId=setTimeout(this.abortStreamSubscribing.bind(this),Zn)}else Bn.debug("okCnt !== 2")}else if(this.audioEnabled)if(this.stats[this.publishCallId]!==void 0)if(this.stats[this.publishCallId].audioSent!==void 0&&this.stats[this.publishCallId].audioSent.bitsSentPerSecond!==void 0)if(this.stats[this.publishCallId].audioSent.bitsSentPerSecond.thirdQuartile>=2e4){clearInterval(this.intervalId);var Et=this.streams[0];this.subscribeToUserStream(Et.attributes.callerId,Et.id,"AUDIOONLY"),this.stepId="stream-subscribing",this.timeoutId=setTimeout(this.abortStreamSubscribing.bind(this),Zn)}else Bn.debug("no stats audio 1 ");else Bn.debug("no stats audio 2");else Bn.debug("no stats audio 3");else if(this.videoEnabled)if(this.stats[this.publishCallId]!==void 0)if(this.stats[this.publishCallId].videoSent!==void 0&&this.stats[this.publishCallId].videoSent.bitsSentPerSecond!==void 0)if(this.stats[this.publishCallId].videoSent.bitsSentPerSecond.thirdQuartile>=rr){clearInterval(this.intervalId);var $t=this.streams[0];this.subscribeToUserStream($t.attributes.callerId,$t.id,"VIDEOONLY"),this.stepId="stream-subscribing",this.timeoutId=setTimeout(this.abortStreamSubscribing.bind(this),Zn)}else Bn.debug("no stats video 1 ");else Bn.debug("no stats video 2");else Bn.debug("no stats video 3");else Bn.debug("no audio or video"),clearInterval(this.intervalId),this.fail()},this.observeStreamSubscribed=function(){if(this.intervalCounter+=1,this.intervalCounter>30)return clearInterval(this.intervalId),void this.succeed();var wt=null,Lt=null,Et=0,$t=0;this.audioEnabled&&(wt=this.stats[this.publishCallId].audioSent),this.videoEnabled&&(Lt=this.stats[this.publishCallId].videoSent);for(var Jt=0;Jt<this.subscribeCallIds.length;Jt+=1){var en=this.subscribeCallIds[Jt];if(this.audioEnabled&&this.videoEnabled){var qt=0;this.stats[en]!==void 0&&(this.stats[en].audioReceived!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond!==void 0&&wt!=null&&wt.bitsSentPerSecond!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond.thirdQuartile>=wt.bitsSentPerSecond.firstQuartile-2e3&&(qt+=1),this.stats[en].videoReceived!==void 0&&this.stats[en].videoReceived.bitsReceivedPerSecond!==void 0&&Lt!=null&&Lt.bitsSentPerSecond!==void 0&&this.stats[en].videoReceived.bitsReceivedPerSecond.thirdQuartile>=Lt.bitsSentPerSecond.firstQuartile&&(qt+=1)),qt===2&&(Et+=1)}else this.audioEnabled?this.stats[en]!==void 0&&this.stats[en].audioReceived!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond!==void 0&&wt!=null&&wt.bitsSentPerSecond!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond.thirdQuartile>=wt.bitsSentPerSecond.firstQuartile&&(Et+=1):$t+=1}$t>0?(clearInterval(this.intervalId),this.fail()):Et===this.subscribeCallIds.length&&(clearInterval(this.intervalId),this.succeed())},this.handleJoinMCUSessionAnswer=function(wt){if(this.stepId==="joining-mcu-session"){if(_n.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"start",stepId:this.stepId}),clearTimeout(this.timeoutId),this.mcuSession.sessionId=wt.detail.sessionId,this.mcuSession.token=wt.detail.token,this.audioEnabled&&this.videoEnabled){var Lt=this,Et={audio:{},video:{}};Et=apiCC.setResolutionInConstraint(this.maxWidth,this.maxHeight,Et),Bn.debug("constraints :",Et),apiRTC.createUserMediaStream({type:"media",audioSourceId:this.audioSourceId,videoSourceId:this.videoSourceId,gum_config:Et,release:function($t){Bn.debug("createUserMediaStream release",$t.userMediaStreamId)},success:function($t){Bn.debug("createUserMediaStream success",$t.userMediaStreamId),Bn.debug("audioSourceId",Ct),Bn.debug("videoSourceId",yt)},failure:function($t,Jt){Bn.error("createUserMediaStream failure",$t.userMediaStreamId),Bn.error("failure; userMediaStreamId: "+$t.userMediaStreamId),Bn.error("failure; error: "+Jt),_n.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"failure",stepId:this.stepId,createUserMediaStreamError:Jt}),Lt.terminate()}})}else if(this.audioEnabled)this.publishCallId=this.webRTCClient.publish(this.mcuSession.roomId,this.mcuSession.sessionId,this.mcuSession.token,{audioOnly:!0});else{if(!this.videoEnabled)return void this.fail();this.publishCallId=this.webRTCClient.publish(this.mcuSession.roomId,this.mcuSession.sessionId,this.mcuSession.token,{videoOnly:!0,qos:{videoStartQuality:"upper"}})}this.subscribeCallIds=[],this.report[this.testId].publishCallId=this.publishCallId,this.report[this.testId].subscribeCallIds=[],this.streams=[],this.stepId="stream-publishing",this.timeoutId=setTimeout(this.abortStreamPublishing.bind(this),Zn)}},this.handleuserMediaSuccess=function(wt){var Lt={userMediaStreamId:wt.detail.userMediaStreamId,qos:{videoStartQuality:"upper"}};this.userMediastreamId=wt.detail.userMediaStreamId,this.publishCallId=this.webRTCClient.publish(this.mcuSession.roomId,this.mcuSession.sessionId,this.mcuSession.token,Lt),this.report[this.testId].publishCallId=this.publishCallId},this.handleRecordingStreamAvailable=function(wt){Bn.debug("handleRecordingStreamAvailable"),this.terminate()},this.handleMCUAvailableStream=function(wt){if(this.stepId==="stream-publishing"&&wt.detail.isRemoteStream===!1)for(var Lt=0;Lt<wt.detail.streams.length;Lt+=1){var Et=wt.detail.streams[Lt];if(Et.room===this.mcuSession.roomId&&Et.attributes.callId===this.publishCallId&&this.stepId==="stream-publishing"){if(clearTimeout(this.timeoutId),this.stepId="stream-published",this.streams.push(Et),this.simpleVideoRecordTest===!0){var $t="VIDEO";Et.audio===!1&&($t="VIDEOONLY"),Et.video===!1&&($t="AUDIOONLY"),this.subscribeToUserStream(Et.attributes.callerId,Et.id,$t),this.stepId="stream-subscribing"}else this.intervalId=setInterval(this.observeStreamPublished.bind(this),1e3);this.intervalCounter=0}}},this.handleRemoteStreamAdded=function(wt){this.stepId==="stream-subscribing"&&this.subscribeCallIds.find(function(Lt){return Lt===wt.detail.callId})!==void 0&&(clearTimeout(this.timeoutId),this.stepId="stream-subscribed",this.intervalId=setInterval(this.observeStreamSubscribed.bind(this),1e3),this.intervalCounter=0)},this.handleOnCallStatsUpdate=function(wt){var Lt=this;if(this.stepId!=="stream-published"&&this.stepId!=="stream-subscribing"&&this.stepId!=="stream-subscribed"||(this.stats[this.publishCallId]===void 0&&(this.stats[this.publishCallId]={}),wt.detail.stats.audioSent!==void 0&&(this.stats[this.publishCallId].audioSent===void 0&&(this.stats[this.publishCallId].audioSent={startTime:wt.detail.stats.audioSent.timestamp,data:[]}),this.pushStats(this.stats[this.publishCallId].audioSent,wt.detail.stats.audioSent)?this.stats[this.publishCallId].audioSent.data.length>=5&&["bitsSentPerSecond","packetsSentPerSecond"].forEach(function(en){var qt=Lt.evalQuartiles(Lt.stats[Lt.publishCallId].audioSent.data,en);qt.sampleCount=Lt.stats[Lt.publishCallId].audioSent.data.length,qt.time=wt.detail.stats.audioSent.timestamp-Lt.stats[Lt.publishCallId].audioSent.startTime,Lt.stats[Lt.publishCallId].audioSent[en]=qt}):Bn.debug("audio stats not pushed for :",this.publishCallId)),wt.detail.stats.videoSent!==void 0&&(this.stats[this.publishCallId].videoSent===void 0&&(this.stats[this.publishCallId].videoSent={startTime:wt.detail.stats.videoSent.timestamp,data:[]}),this.pushStats(this.stats[this.publishCallId].videoSent,wt.detail.stats.videoSent)?this.stats[this.publishCallId].videoSent.data.length>=5&&(["bitsSentPerSecond","packetsSentPerSecond","framesEncodedPerSecond"].forEach(function(en){var qt=Lt.evalQuartiles(Lt.stats[Lt.publishCallId].videoSent.data,en);qt.sampleCount=Lt.stats[Lt.publishCallId].videoSent.data.length,qt.time=wt.detail.stats.videoSent.timestamp-Lt.stats[Lt.publishCallId].videoSent.startTime,Lt.stats[Lt.publishCallId].videoSent[en]=qt}),this.stats[this.publishCallId].videoSent.width=wt.detail.stats.videoSent.width,this.stats[this.publishCallId].videoSent.height=wt.detail.stats.videoSent.height):Bn.debug("video stats not pushed for :",this.publishCallId))),this.stepId==="stream-subscribed")for(var Et=function(en){Jt=0;var qt=Lt.subscribeCallIds[en];Lt.stats[qt]===void 0&&(Lt.stats[qt]={}),wt.detail.stats.audioReceived!==void 0&&(Lt.stats[qt].audioReceived===void 0&&(Lt.stats[qt].audioReceived={startTime:wt.detail.stats.audioReceived.timestamp,data:[]}),Lt.pushStats(Lt.stats[qt].audioReceived,wt.detail.stats.audioReceived)?(Jt=Lt.stats[qt].audioReceived.data.length,Lt.stats[qt].audioReceived.data[Jt-1].mosS===void 0&&(Lt.stats[qt].audioReceived.data[Jt-1].mosS={}),Lt.stats[qt].audioReceived.data[Jt-1].mosS=wt.detail.stats.quality.mosS,Lt.stats[qt].audioReceived.data.length>=15&&(["bitsReceivedPerSecond","packetsReceivedPerSecond","delay"].forEach(function(on){var hn=Lt.evalQuartiles(Lt.stats[qt].audioReceived.data,on);hn.sampleCount=Lt.stats[qt].audioReceived.data.length,hn.time=wt.detail.stats.audioReceived.timestamp-Lt.stats[qt].audioReceived.startTime,Lt.stats[qt].audioReceived[on]=hn}),Lt.stats[qt].audioReceived.data[0].jitter!==void 0&&["jitter"].forEach(function(on){var hn=Lt.evalQuartiles(Lt.stats[qt].audioReceived.data,on,function(nn){return Math.floor(1e3*nn)});hn.sampleCount=Lt.stats[qt].audioReceived.data.length,hn.time=wt.detail.stats.audioReceived.timestamp-Lt.stats[qt].audioReceived.startTime,Lt.stats[qt].audioReceived[on]=hn}),Lt.stats[qt].audioReceived.packetsLost={max:wt.detail.stats.audioReceived.packetsLost,sampleCount:Lt.stats[qt].audioReceived.data.length,time:wt.detail.stats.audioReceived.timestamp-Lt.stats[qt].audioReceived.startTime},["packetsLostRatio"].forEach(function(on){var hn=Lt.evalQuartiles(Lt.stats[qt].audioReceived.data,on);hn.sampleCount=Lt.stats[qt].audioReceived.data.length,hn.time=wt.detail.stats.audioReceived.timestamp-Lt.stats[qt].audioReceived.startTime,Lt.stats[qt].audioReceived[on]=hn}),Lt.stats[qt].audioReceived.mosS===void 0&&(Lt.stats[qt].audioReceived.mosS={}),["mosS"].forEach(function(on){var hn=Lt.evalQuartiles(Lt.stats[qt].audioReceived.data,on);hn.sampleCount=Lt.stats[qt].audioReceived.data.length,Lt.stats[qt].audioReceived[on]=hn}))):Bn.error("audio stats not pushed for callId :",qt)),wt.detail.stats.videoReceived!==void 0&&(Lt.stats[qt].videoReceived===void 0&&(Lt.stats[qt].videoReceived={startTime:wt.detail.stats.videoReceived.timestamp,data:[]}),Lt.pushStats(Lt.stats[qt].videoReceived,wt.detail.stats.videoReceived)?(Jt=Lt.stats[qt].videoReceived.data.length,Lt.stats[qt].videoReceived.data[Jt-1].mosV===void 0&&(Lt.stats[qt].videoReceived.data[Jt-1].mosV={}),Lt.stats[qt].videoReceived.data[Jt-1].mosAV===void 0&&(Lt.stats[qt].videoReceived.data[Jt-1].mosAV={}),Lt.stats[qt].videoReceived.data[Jt-1].mosV=wt.detail.stats.quality.mosV,Lt.stats[qt].videoReceived.data[Jt-1].mosAV=wt.detail.stats.quality.mosAV,Lt.stats[qt].videoReceived.data.length>=15&&(["bitsReceivedPerSecond","packetsReceivedPerSecond","framesDecodedPerSecond"].forEach(function(on){var hn=Lt.evalQuartiles(Lt.stats[qt].videoReceived.data,on);hn.sampleCount=Lt.stats[qt].videoReceived.data.length,hn.time=wt.detail.stats.videoReceived.timestamp-Lt.stats[qt].videoReceived.startTime,Lt.stats[qt].videoReceived[on]=hn}),Lt.stats[qt].videoReceived.data[0].jitter!==void 0&&["jitter"].forEach(function(on){var hn=Lt.evalQuartiles(Lt.stats[qt].videoReceived.data,on,function(nn){return Math.floor(1e3*nn)});hn.sampleCount=Lt.stats[qt].videoReceived.data.length,hn.time=wt.detail.stats.videoReceived.timestamp-Lt.stats[qt].videoReceived.startTime,Lt.stats[qt].videoReceived[on]=hn}),Lt.stats[qt].videoReceived.packetsLost={max:wt.detail.stats.videoReceived.packetsLost,sampleCount:Lt.stats[qt].videoReceived.data.length,time:wt.detail.stats.videoReceived.timestamp-Lt.stats[qt].videoReceived.startTime},["packetsLostRatio"].forEach(function(on){var hn=Lt.evalQuartiles(Lt.stats[qt].videoReceived.data,on);hn.sampleCount=Lt.stats[qt].videoReceived.data.length,hn.time=wt.detail.stats.videoReceived.timestamp-Lt.stats[qt].videoReceived.startTime,Lt.stats[qt].videoReceived[on]=hn}),Lt.stats[qt].videoReceived.mosV===void 0&&(Lt.stats[qt].videoReceived.mosV={}),["mosV"].forEach(function(on){var hn=Lt.evalQuartiles(Lt.stats[qt].videoReceived.data,on);hn.sampleCount=Lt.stats[qt].videoReceived.data.length,Lt.stats[qt].videoReceived[on]=hn}),Lt.stats[qt].videoReceived.mosAV===void 0&&(Lt.stats[qt].videoReceived.mosAV={}),["mosAV"].forEach(function(on){var hn=Lt.evalQuartiles(Lt.stats[qt].videoReceived.data,on);hn.sampleCount=Lt.stats[qt].videoReceived.data.length,Lt.stats[qt].videoReceived[on]=hn}),Lt.stats[qt].videoReceived.width=wt.detail.stats.videoReceived.width,Lt.stats[qt].videoReceived.height=wt.detail.stats.videoReceived.height)):Bn.error("video stats not pushed for callId :",qt))},$t=0;$t<this.subscribeCallIds.length;$t+=1){var Jt;Et($t)}},this.subscribeToUserStream=function(wt,Lt,Et){var $t=this,Jt=this.webRTCClient.getStreamFromList(Lt);if(Jt!=null){var en=[];en.push(Jt),this.webRTCClient.subscribe(en,Et).forEach(function(qt){$t.subscribeCallIds.push(qt),$t.report[$t.testId].subscribeCallIds.push(qt)})}},this.leaveSession=function(){Bn.debug("leaveSession"),this.streams!==void 0&&typeof this.streams[0]=="number"&&this.webRTCClient!==null&&this.webRTCClient.unsubscribe(this.streams[0]),this.userMediastreamId!==null&&apiRTC.releaseUserMediaStream(this.userMediastreamId),delete this.streams,delete this.subscribeCallIds,typeof this.publishCallId=="string"&&this.webRTCClient.unpublish(this.publishCallId),delete this.publishCallId,this.mcuSession!==void 0&&this.mcuSession.sessionId!==void 0&&(this.webRTCClient.leaveMCUSession(),delete this.mcuSession.sessionId),delete this.mcuSession,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs.splice(0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs.length),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.joinSessionReqs.splice(0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.joinSessionReqs.length),Bn.debug("leaveSession done")},this.runResolutionTest=function(){this.testId="resolution-test",this.stepId="resolution-test",_n.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"start",stepId:this.stepId}),Bn.debug("Run resolution test"),this.startGetUserMedia(this.resolutions[this.currentResolution])},this.startGetUserMedia=function(wt){Bn.debug("startGetUserMedia :",wt);var Lt={audio:!1,video:{}};Lt=apiCC.setVideoSourceIdInConstraint(this.videoSourceId,Lt),Lt=apiCC.setResolutionInConstraint(wt[0],wt[1],Lt),Bn.debug("startGetUserMedia constraints:",Lt),apiCC.getUserMedia(Lt).then((function(Et){this.resolutions.length>1?(this.report.resolutions.push(wt[2]+":   "+wt[0]+"x"+wt[1]),this.maxWidth=wt[0],this.maxHeight=wt[1],Et.getTracks().forEach(function($t){$t.stop()}),this.maybeContinueGetUserMedia()):Bn.debug("No video track in returned stream.")}).bind(this)).catch((function(Et){Bn.debug("startGetUserMedia catch error:",Et),this.resolutions.length>1?Bn.debug(wt[0]+"x"+wt[1]+" not supported"):Bn.error("getUserMedia failed with error: "+Et.name),this.maybeContinueGetUserMedia()}).bind(this))},this.maybeContinueGetUserMedia=function(){this.currentResolution!==this.resolutions.length-1?(this.currentResolution++,this.startGetUserMedia(this.resolutions[this.currentResolution])):this.startNextTest()}},vn=et.Y.get("ApiCCWebRTCClient"),On=function(Kt){vn.debug("apiCC.ApiCCWebRTCClient"),this.myWebRTC_Event=apiCC.myWebRTC_Event,this.webRTCClient=new or(Kt),this.webRTCClient.channelReady=!0,this.callTest=null,this.call=function(Rt,nt,Ct){return nt==="RECORD"&&vn.warn("DEPRECATED : usage of data parameter on call() as a string with 'RECORD' value will be deprecated in a next version of apiRTC. Please consider using a JSON Data parameter instead : data = {isRecorded : true}"),this.webRTCClient.recordedCall===!0&&(vn.log("recordedCall option is activated"),nt!==void 0&&nt!=="RECORD"||(nt={}),nt.MCUType="MCU-Caller",nt.confId=Math.floor(1000001*Math.random()).toString()),nt!==void 0&&(nt!=="RECORD"&&nt.isRecorded!==!0||(vn.log("recordedCall option is activated"),nt==="RECORD"&&(nt={}),nt.MCUType="MCU-Caller",nt.confId=Math.floor(1000001*Math.random()).toString())),Ct!=null&&Ct.record===!0&&(vn.log("callConfiguration record option is activated"),nt!==void 0&&nt!=="RECORD"||(nt={}),nt.MCUType="MCU-Caller",nt.confId=Math.floor(1000001*Math.random()).toString()),vn.log("session.webRTCPluginActivated =",Kt.webRTCPluginActivated),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&Kt.webRTCPluginActivated===!0?(vn.log("managing call with WebRTC Plugin"),Ct==null&&(Ct={}),Ct.apzcallId=apiCC.generateCallId(),apiCC.manageWebRTCPlugin(function(){vn.log("manageWebRTCPlugin cb in call"),apiCC.session.apiCCWebRTCClient.webRTCClient.callWithNumber(Rt,!0,nt,Ct)},function(){vn.log("actionOnInstallationNeeded")}),Ct.apzcallId):(vn.log("managing call with browser"),this.webRTCClient.callWithNumber(Rt,!0,nt,Ct))},this.getStatsFromCall=function(Rt,nt){var Ct=this.webRTCClient.findCallWithCallId(Rt);Ct===null?nt(new Error("Call was not found"),null):Ct.pc===null?nt(new Error("Call has no peerconnection"),null):this.webRTCClient.csmEnable===!0?nt(null,this.webRTCClient.csmLastResults):nt(new Error("Call stats monitoring not activated"),null)},this.testCall=function(Rt){return vn.log("session.webRTCPluginActivated =",Kt.webRTCPluginActivated),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&Kt.webRTCPluginActivated===!0?(vn.log("managing call with WebRTC Plugin"),Rt==null&&(Rt={}),Rt.apzcallId=apiCC.generateCallId(),apiCC.manageWebRTCPlugin(function(){vn.log("manageWebRTCPlugin cb in call"),apiCC.session.apiCCWebRTCClient.webRTCClient.startTestCall(!0,Rt)},function(){vn.log("actionOnInstallationNeeded")}),Rt.apzcallId):(vn.log("managing call with browser"),this.webRTCClient.startTestCall(!0,Rt))},this.setClientTurnServer=function(Rt){this.webRTCClient.setClientTurnServer(Rt)},this.activateScreenSharing=function(Rt){this.webRTCClient.activateScreenSharing(Rt)},this.shareScreen=function(Rt,nt,Ct){return vn.info("shareScreen"),this.webRTCClient.shareScreen(Rt,nt,Ct)},this.startScreenSharingOnCall=function(Rt,nt){vn.info("startScreenSharingOnCall"),this.webRTCClient.startScreenSharingOnCall(Rt,nt)},this.startDataChannel=function(Rt,nt){if(vn.info("startDataChannel"),!(ot.Xh==="Edge"&&ot.PR<79&&apiRTC.browserDetails.type!=="chrome"))return nt!==void 0?nt.dataCall=!0:(nt={}).dataCall=!0,this.webRTCClient.callWithNumber(Rt,!0,nt,null);vn.warn("Cannot startDataChannel as it is not supported on Edge")},this.startDataChannelOnCall=function(Rt){this.webRTCClient.startDataChannelOnCall(Rt)},this.sendDataWithCallId=function(Rt,nt,Ct){this.webRTCClient.sendDataWithCallId(Rt,nt,Ct)},this.callAudio=function(Rt,nt,Ct){return vn.info("callAudio"),this.webRTCClient.callWithNumber(Rt,!1,nt,Ct)},this.callbymail=function(Rt){this.webRTCClient.callbymail(Rt)},this.addMedia=function(Rt){return this.webRTCClient.addMedia(Rt),Rt},this.hangUp=function(Rt){this.webRTCClient.onHangup(Rt)},this.getMyMedia=function(Rt,nt){vn.info("getMyMedia : ",Rt),Rt==="screen"?this.webRTCClient.shareScreen("LOCAL",{},nt):this.webRTCClient.getUserMedia()},this.releaseStream=function(Rt){vn.info("releaseStream : ",Rt),vn.info("releaseStream.callId : ",Rt.callId),Rt.callId!==void 0?this.webRTCClient.removeCallFromTableWithCallIdAndSendBye(Rt.callId,"stop_ScreenSharing"):this.webRTCClient.stopStream(Rt)},this.autoAnswerUserMediaSuccessHandler=function(Rt){vn.info("autoAnswerUserMediaSuccessHandler :"+Rt),Rt=null,this.webRTCClient.autoAnswer=!0},this.autoAnswerUserMediaErrorHandler=function(Rt){vn.info("autoAnswerUserMediaErrorHandler :"+Rt),Rt=null,this.webRTCClient.autoAnswer=!1},this.activateAutoAnswer=function(){apiCC.addEventListener("userMediaSuccess",this.callback(this,"autoAnswerUserMediaSuccessHandler")),apiCC.addEventListener("userMediaError",this.callback(this,"autoAnswerUserMediaErrorHandler")),this.webRTCClient.getUserMedia()},this.getAutoAnswer=function(){return this.webRTCClient.autoAnswer},this.setUnidirectionalCall=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.unidirectionelCallOnly=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUnidirectionalCall()","PARAMETER_ERROR_SETUNIDIRCALL")},this.setReceiveMediaDeactivated=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.receiveMediaDeactivated=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setReceiveMediaDeactivated()","PARAMETER_ERROR_SETRECVMEDIADEACTIVATED")},this.setPreferVP9Codec=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.preferVP9Codec=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setPreferVP9Codec()","PARAMETER_ERROR_SETPREFERVP9CODEC")},this.setPreferH264Codec=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.preferH264Codec=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setPreferH264Codec()","PARAMETER_ERROR_SETPREFERH264CODEC")},this.getUnidirectionalCall=function(){return this.webRTCClient.unidirectionelCallOnly},this.toggleVideoMute=function(Rt){return this.webRTCClient.toggleVideoMute(Rt)},this.isVideoMuted=function(Rt){var nt;return vn.debug("isVideoMuted :",Rt),Rt==null?this.webRTCClient.isVideoMuted:(vn.debug("callId is defined :",Rt),(nt=this.webRTCClient.findCallIndexWithCallId(Rt))!==-1?this.webRTCClient.callsTable[nt].isLocalVideoMuted:void 0)},this.toggleAudioMute=function(Rt){return this.webRTCClient.toggleAudioMute(Rt)},this.sendDTMF=function(Rt,nt,Ct,yt){return this.webRTCClient.sendDTMF(Rt,nt,Ct,yt)},this.isAudioMuted=function(Rt){var nt;return vn.debug("isAudioMuted :",Rt),Rt==null?this.webRTCClient.isAudioMuted:(vn.debug("callId is defined :",Rt),(nt=this.webRTCClient.findCallIndexWithCallId(Rt))!==-1?this.webRTCClient.callsTable[nt].isLocalAudioMuted:void 0)},this.setNtoNConf=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.NtoNConf=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setNtoNConf()","PARAMETER_ERROR_SETNTONCONF")},this.getNtoNConf=function(){return this.webRTCClient.NtoNConf},this.setRTPMedia=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.RTPMedia=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setRTPMedia()","PARAMETER_ERROR_SETRTPMEDIA")},this.getRTPMedia=function(){return this.webRTCClient.RTPMedia},this.setMediaRoutingMode=function(Rt){Rt==="hostOnly"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.hostOnly:Rt==="stun"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.stun:Rt==="stunOnly"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.stunOnly:Rt==="turn"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.turn:Rt==="turnOnly"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.turnOnly:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setMediaRoutingMode()","PARAMETER_ERROR_SETMEDIAROUTINGMODE")},this.enableQos=function(Rt,nt){apiCC.browser!=="Chrome"&&apiCC.browser!=="Firefox"&&(vn.warn("enableQos() is only supported on Chrome and Firefox, support on other browsers will be added soon"),Rt=!1),vn.info("this.enableQos="+Rt),this.webRTCClient.qosEnable=Rt,this.webRTCClient.qosInterval=nt||this.webRTCClient.qosInterval},this.enableCallStatsMonitoring=function(Rt,nt){["chrome","firefox","safari"].indexOf(lt.wL.type)<0?vn.warn("enableCallStatsMonitoring() is only supported on Chrome, Firefox and Safari, support on other browsers will be added soon"):(this.webRTCClient.csmEnable=Rt,nt&&(this.webRTCClient.csmIntervalMs=nt))},this.enableQualityEvaluating=function(Rt,nt){["chrome","firefox"].indexOf(lt.wL.type)<0?vn.warn("enableQualityEvaluating() is only supported on Chrome and Firefox, support on other browsers will be added soon"):(this.webRTCClient.qualityScoreEnable=Rt,nt&&(this.webRTCClient.qualityScoreIntervalMs=nt))},this.getMediaRoutingMode=function(){var Rt=null;return this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.hostOnly?Rt="hostOnly":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.stun?Rt="stun":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.stunOnly?Rt="stunOnly":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.turn?Rt="turn":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.turnOnly&&(Rt="turnOnly"),Rt},this.setMediaTypeForIncomingCall=function(Rt){vn.debug("setMediaTypeForIncomingCall :",Rt),Rt==="VIDEO"||Rt==="AUDIO"||Rt==="VIDEOONLY"||Rt==="NONE"?this.webRTCClient.mediaTypeForIncomingCall=Rt:vn.log("setMediaTypeForIncomingCall, value is not correct",Rt)},this.setMediaTypeForOutgoingCall=function(Rt){vn.debug("setMediaTypeForOutgoingCall :",Rt),Rt==="VIDEO"||Rt==="AUDIO"||Rt==="VIDEOONLY"||Rt==="NONE"?this.webRTCClient.mediaTypeForOutgoingCall=Rt:vn.log("setMediaTypeForOutgoingCall, value is not correct",Rt)},this.setStereo=function(Rt){vn.info("setStereo :",Rt),Rt===!0?(this.webRTCClient.setStereo=Rt,this.webRTCClient.gum_config={audio:{mandatory:{echoCancellation:!1,googEchoCancellation:!1},optional:[]},video:{mandatory:{},optional:[]}}):Rt===!1?this.webRTCClient.setStereo=Rt:vn.log("setStereo, value is not correct",Rt)},this.setMCUConnector=function(Rt){vn.info("setMCUConnector :",Rt),vn.log("setting value :",Rt),Rt==="mcu4.apizee.com"?this.webRTCClient.MCUClient.pubConnector="janusConnector":Rt==="mcu3.apizee.com"?this.webRTCClient.MCUClient.pubConnector="groupKurentoConnector":vn.log("value is incorrect :",Rt)},this.enableMeshRoomMode=function(Rt){vn.info("enableMeshRoomMode :",Rt),ot.Xh==="IE"?(vn.log("IE detected, MeshRoomMode is not supported"),this.webRTCClient.MCUClient.meshModeEnabled=!1):this.webRTCClient.MCUClient.meshModeEnabled=Rt},this.setAllowAsymetricMediaCalls=function(Rt){vn.info("setAllowAsymetricMediaCalls :",Rt),Rt===!0||Rt===!1?this.webRTCClient.allowAsymetricMediaCalls=Rt:vn.log("setAllowAsymetricMediaCalls, value is not correct",Rt)},this.takeSnapshot=function(Rt,nt,Ct,yt,xt,wt,Lt){this.webRTCClient.takeSnapshot(Rt,nt,Kt.apiKey,Ct,yt,xt,wt,Lt)},this.takeSnapshotAndSendOnDataChannel=function(Rt,nt,Ct,yt){this.webRTCClient.takeSnapshotAndSendOnDataChannel(Rt,nt,Ct,yt)},this.setUserAcceptOnIncomingCall=function(Rt){vn.info("setUserAcceptOnIncomingCall :",Rt),Rt===!0||Rt===!1?this.webRTCClient.userAcceptOnIncomingCall=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingCall()","PARAMETER_ERROR_SETUSERACCEPTONINCOCALL")},this.setUserAcceptOnIncomingCallBeforeGetUserMedia=function(Rt){vn.info("setUserAcceptOnIncomingCallBeforeGetUserMedia :",Rt),Rt===!0||Rt===!1?this.webRTCClient.userAcceptOnIncomingCallBeforeGetUserMedia=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingCallBeforeGetUserMedia()","PARAMETER_ERROR_SETUSERACCEPTONINCOCALLBEFOREGUM")},this.setUserAcceptOnIncomingDataCall=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.userAcceptOnIncomingDataCall=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingDataCall()","PARAMETER_ERROR_SETUSERACCEPTONINCOCALL")},this.setUserAcceptOnIncomingScreenSharingCall=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.userAcceptOnIncomingScreenSharingCall=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingScreenSharingCall()","PARAMETER_ERROR_SETUSERACCEPTONINCOSCREENSHARINGCALL")},this.setAllowMultipleCalls=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.allowMultipleCalls=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setAllowMultipleCalls()","PARAMETER_ERROR_SETALLOWMULTIPLECALLS")},this.setPcConfig=function(Rt){vn.info("Setting PC_config to :",Rt),this.webRTCClient.pc_config=Rt},this.setPcConstraints=function(Rt){vn.info("Setting PC_constraints to :"+Rt),this.webRTCClient.pc_constraints=Rt},this.setGetUserMediaConfig=function(Rt){this.webRTCClient.setGetUserMediaConfig(Rt)},this.setTrickleIce=function(Rt){vn.info("Setting trickleIce to :"+Rt),Rt===!0||Rt===!1?this.webRTCClient.trickleIce=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setTrickleIce()","PARAMETER_ERROR_SETTRICKLEICE")},this.setRecordedCall=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.recordedCall=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setRecordedCall()","PARAMETER_ERROR_SETRECORDEDCALL")},this.getRecordedCall=function(){return this.webRTCClient.recordedCall},this.acceptCall=function(Rt,nt){this.webRTCClient.acceptCall(Rt,nt)},this.refuseCall=function(Rt){vn.info("refuseCall"),this.webRTCClient.refuseCall(Rt)},this.addVideoMedia=function(Rt){vn.info("addVideoMedia"),this.webRTCClient.addVideoMedia(Rt)},this.updateMediaDeviceOnCall=function(Rt,nt){return vn.info("updateMediaDeviceOnCall"),this.webRTCClient.updateMediaDeviceOnCall(Rt,nt)},this.updateMediaTypeOnCall=function(Rt,nt){return!(0,lt.Ym)(Rt,"string")||nt!=="VIDEO"&&nt!=="AUDIOONLY"&&nt!=="VIDEOONLY"?Promise.reject("wrong arguments"):this.webRTCClient.updateMediaTypeOnCall(Rt,nt)},this.releaseUserMedia=function(){this.webRTCClient.releaseUserMedia()},this.setAllowedAudioCodecs=function(Rt){this.webRTCClient.allowedAudioCodecs=Rt},this.setAllowedVideoCodecs=function(Rt){this.webRTCClient.allowedVideoCodecs=Rt},this.setAudioBandwidth=function(Rt){this.webRTCClient.setAudioBandwidth(Rt)},this.setVideoBandwidth=function(Rt){},this.setRemoteVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"remote"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setOverallIncomingVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"overall","incoming"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setOverallOutgoingVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"overall","outgoing"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setPerCallIncomingVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"perCall","incoming"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setPerCallOutgoingVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"perCall","outgoing"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setDataBandwidth=function(Rt){this.webRTCClient.setDataBandwidth(Rt)},this.createMCUSession=function(Rt,nt){vn.info("createMCUSession"),this.webRTCClient.MCUClient.initDivElements(Rt,nt),this.webRTCClient.MCUClient.createSession()},this.joinMCUSession=function(Rt){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vn.debug("joinMCUSession"),Rt?this.webRTCClient.MCUClient.joinSession(Rt,nt):new Error("wrong roomId")},this.getMCUStreamList=function(){return vn.debug("getMCUStreamList"),this.webRTCClient.MCUClient.getStreamList()},this.getStreamFromList=function(Rt){return vn.debug("getStreamFromList"),this.webRTCClient.MCUClient.getStreamFromList(Rt)},this.getStreamIdOfUser=function(Rt){return vn.debug("getStreamIdOfUser"),this.webRTCClient.MCUClient.getStreamIdOfUser(Rt)},this.getCallIdFromStreamId=function(Rt){vn.debug("getCallIdFromStreamId");var nt=this.webRTCClient.findCallWithStreamId(Rt);return nt===null?(vn.log("call not found in getCallIdFromStreamId"),null):nt.callId},this.getCallIdFromRemoteMCUUser=function(Rt){var nt,Ct;return vn.debug("getCallIdFromRemoteMCUUser"),nt=this.webRTCClient.MCUClient.getStreamIdOfUser(Rt),(Ct=this.webRTCClient.findCallWithStreamId(nt))===null?(vn.log("call not found in getCallIdFromRemoteMCUUser"),null):Ct.callId},this.ejectParticipantFromMCUSession=function(Rt,nt,Ct){this.webRTCClient.MCUClient.ejectParticipant(Rt,nt,Ct)},this.publish=function(Rt,nt,Ct,yt,xt,wt){if(ot.Xh==="IE"&&(vn.log("apiCC.session.webRTCPluginActivated ="+apiCC.session.webRTCPluginActivated),vn.log("apiCC.webRTCPluginInstalled ="+apiCC.webRTCPluginInstalled)),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&apiCC.session.webRTCPluginActivated===!0&&apiCC.webRTCPluginInstalled===!1)return vn.log("managing call with WebRTC Plugin"),yt==null&&(yt={}),yt.apzcallId=apiCC.generateCallId(),apiCC.manageWebRTCPlugin(function(){apiCC.webRTCPluginInstalled=!0,vn.info("manageWebRTCPlugin cb in call");var Et=this.webRTCClient.MCUClient.getSessionMCU(Rt);return Et&&Et.roomMode==="mesh"?this.webRTCClient.MCUClient.meshPublish(Rt,nt,Ct,yt,xt,wt):(vn.debug("publish"),this.webRTCClient.MCUClient.publish(Rt,nt,Ct,yt,xt,wt))},function(){vn.log("actionOnInstallationNeeded")}),yt.apzcallId;var Lt=this.webRTCClient.MCUClient.getSessionMCU(Rt);return Lt&&Lt.roomMode==="mesh"?this.webRTCClient.MCUClient.meshPublish(Rt,nt,Ct,yt,xt,wt):(vn.debug("publish"),this.webRTCClient.MCUClient.publish(Rt,nt,Ct,yt,xt,wt))},this.unpublish=function(Rt){vn.info("unpublish"),this.webRTCClient.MCUClient.unpublish(Rt)},this.publishScreen=function(Rt,nt,Ct,yt){var xt=this.webRTCClient.MCUClient.getSessionMCU(Rt);return xt&&xt.roomMode==="mesh"?(vn.info("publishScreen"),this.webRTCClient.MCUClient.meshPublishScreen(Rt,nt,Ct,yt)):(vn.info("publishScreen"),this.webRTCClient.MCUClient.publishScreen(Rt,nt,Ct,yt))},this.subscribe=function(Rt,nt,Ct,yt,xt){return vn.info("subscribe :",Rt),ot.Xh==="IE"&&(vn.log("apiCC.session.webRTCPluginActivated ="+apiCC.session.webRTCPluginActivated),vn.log("apiCC.webRTCPluginInstalled ="+apiCC.webRTCPluginInstalled)),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&apiCC.session.webRTCPluginActivated===!0&&apiCC.webRTCPluginInstalled===!1?(vn.log("managing call with WebRTC Plugin"),apiCC.manageWebRTCPlugin(function(){return apiCC.webRTCPluginInstalled=!0,vn.log("manageWebRTCPlugin cb in subscribe"),typeof nt=="boolean"&&(vn.warn("DEPRECATED : usage of audioOnly parameter on subscribe() is now replaced by mediatype with value VIDEO, AUDIOONLY or VIDEOONLY and will be deprecated in a next version of apiRTC"),nt=nt===!0?"AUDIOONLY":"VIDEO"),apiCC.session.apiCCWebRTCClient.subscribe(Rt,nt,Ct,yt)},function(){vn.log("actionOnInstallationNeeded")}),"WebRTC_Plugin"):(typeof nt=="boolean"&&(vn.warn("DEPRECATED : usage of audioOnly parameter on subscribe() is now replaced by mediatype with value VIDEO, AUDIOONLY or VIDEOONLY and will be deprecated in a next version of apiRTC"),nt=nt===!0?"AUDIOONLY":"VIDEO"),this.webRTCClient.MCUClient.subscribeToStreams(Rt,nt,Ct,yt,xt))},this.unsubscribe=function(Rt){vn.info("unsubscribe :",Rt),this.webRTCClient!==null&&this.webRTCClient.MCUClient!==null&&this.webRTCClient.MCUClient.unsubscribe(Rt)},this.startStreaming=function(Rt,nt,Ct,yt){return vn.info("startStreaming"),this.webRTCClient.MCUClient.startStreaming(Rt,nt,Ct,yt)},this.stopStreaming=function(Rt){return vn.info("stopStreaming"),this.webRTCClient.MCUClient.stopStreaming(Rt)},this.startRecording=function(Rt,nt,Ct,yt,xt){vn.info("startRecording"),this.webRTCClient.MCUClient.startRecording(Rt,nt,Ct,yt,xt)},this.stopRecording=function(Rt){vn.info("stopRecording"),this.webRTCClient.MCUClient.stopRecording(Rt)},this.changeStreamPriority=function(Rt,nt){var Ct=this.webRTCClient.findCallWithCallId(Rt);if(!Ct&&!(Ct=this.webRTCClient.findUserMediaById(Rt)))return vn.error("changeStreamPriority - no such call",Rt),!1;if(!Ct.sessionMCU)return vn.error("changeStreamPriority - no such sessionMCU"),!1;if(!(0,lt.Ym)(nt,"number")||nt<0)return vn.error("changeStreamPriority - wrong priority",nt),!1;var yt=JSON.stringify({type:"changeStreamPriority",roomId:Ct.sessionMCU.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Rt,data:{pubSub:this.webRTCClient.MCUClient.pubConnector,priority:nt}});return vn.log("C->S: "+yt),apiCC.session.channel.socket.emit("changeStreamPriority",yt),!0},this.startComposite=function(Rt){vn.info("startComposite"),this.webRTCClient.MCUClient.startComposite(Rt)},this.stopComposite=function(Rt){vn.info("stopComposite"),this.webRTCClient.MCUClient.stopComposite(Rt)},this.startCompositeRecording=function(Rt,nt,Ct,yt,xt){vn.info("startCompositeRecording"),this.webRTCClient.MCUClient.startCompositeRecording(Rt,nt,Ct,yt,xt)},this.stopCompositeRecording=function(Rt){vn.info("stopCompositeRecording"),this.webRTCClient.MCUClient.stopCompositeRecording(Rt)},this.checkCallExist=function(Rt){for(var nt=null,Ct=this.webRTCClient.callsTable.length;--Ct>=0;){var yt=this.webRTCClient.callsTable[Ct];if(yt.callId===Rt&&yt.data&&yt.sessionMCU&&(yt.data.MCUType==="MCU-Caller"||yt.data.MCUType==="MCU-Callee")&&yt.data.confId===yt.sessionMCU.roomName){nt=yt;break}}return nt||vn.error("startCallRecording: no such call"),nt},this.startCallRecording=function(Rt){var nt;if(nt=this.checkCallExist(Rt)){var Ct=(0,lt.ws)({},nt.data);this.webRTCClient.MCUClient.startCompositeRecording("AUDIO-VIDEO",null,nt.sessionMCU.convId,Ct,nt.sessionMCU.roomName)}},this.stopCallRecording=function(Rt){var nt;(nt=this.checkCallExist(Rt))&&this.webRTCClient.MCUClient.stopCompositeRecording(nt.sessionMCU.roomName)},this.enforceMCU=function(Rt){this.webRTCClient.MCUClient.enforceMCU(Rt)},this.takeSnapshotOnMCUSession=function(Rt){return vn.info("takeSnapshotOnMCUSession"),this.webRTCClient.MCUClient.takeSnapshot(Rt)},this.sendMCUSessionInvitation=function(Rt,nt,Ct){this.webRTCClient.MCUClient.sendSessionInvitation(Rt,nt,Ct)},this.sendMCUSessionInvitationToGroupChat=function(Rt,nt){this.webRTCClient.MCUClient.sendSessionInvitationToGroupChat(Rt,nt)},this.acceptMCUSessionInvitation=function(Rt,nt,Ct,yt){this.webRTCClient.MCUClient.initDivElements(Ct,yt),this.webRTCClient.MCUClient.acceptSessionInvitation(Rt,nt)},this.leaveMCUSession=function(Rt){this.webRTCClient.MCUClient.leaveSession(Rt)},this.recordStream=function(Rt){vn.info("recordStream :",Rt),MediaRecorder!==void 0?apiCC.recordMgr.record(Rt).then(function(){vn.log("Recording started")}).catch(function(nt){vn.error("startRecord failed :",nt)}):vn.debug("MediaRecorder is not supported on this browser, leaving recordStream process")},this.stopRecordStream=function(Rt){vn.info("stopRecordStream"),MediaRecorder!==void 0?apiCC.recordMgr.stop().then(function(nt){vn.log("Recording stopped"),Rt(nt)}).catch(function(nt){vn.error("stopRecord failed :",nt)}):vn.debug("MediaRecorder is not supported on this browser, leaving recordStream process")},this.getMediaDevices=function(Rt){vn.debug("getMediaDevices 2"),apiCC.getMediaDevices().then(function(nt){Rt(nt),apiCC.mediaDeviceMgr.gotSources(nt)}).catch(function(nt){Rt(null),apiCC.mediaDeviceMgr.gotSources(null)})},this.setAudioSourceId=function(Rt){vn.info("setAudioSourceId :"+Rt),this.webRTCClient.audioSourceId=Rt},this.setAudioOutputId=function(Rt){vn.info("setaudioOutputId :"+Rt),this.webRTCClient.audioOutputId=Rt},this.setVideoSourceId=function(Rt){vn.info("setVideoSourceId :"+Rt),this.webRTCClient.videoSourceId=Rt},this.setVideoFacingMode=function(Rt){vn.info("setVideoFacingMode :"+Rt),Rt==="user"||Rt==="environment"||Rt==="left"||Rt==="right"||Rt==="deactivated"?this.webRTCClient.facingMode=Rt==="deactivated"?null:Rt:vn.log("facingMode value is not correct")},this.attachMediaStream=function(Rt,nt){vn.debug("attachMediaStream"),apiCC.attachMediaStream(Rt,nt)},this.addStreamInDiv=function(Rt,nt,Ct,yt,xt,wt){vn.debug("addStreamInDiv"),apiCC.addStreamInDiv(Rt,nt,Ct,yt,xt,wt)},this.removeElementFromDiv=function(Rt,nt){vn.debug("removeElementFromDiv"),apiCC.removeElementFromDiv(Rt,nt)},this.setSelectedStream=function(Rt){vn.warn("setSelectedStream() is now deprecated")},this.callback=function(Rt,nt){return this.closureHandler=function(Ct){return Rt[nt](Ct)},this.closureHandler},this.startPrecallTest=function(Rt,nt,Ct,yt,xt){var wt={webRTCClient:this,notifyTerminated:Rt};this.callTest=new Ln(wt,nt,Ct,yt,xt),this.callTest.runBitRateTest()}}},6527:(at,ut,s)=>{s.d(ut,{p:()=>ot}),s(3843),s(3710),s(7941),s(4916),s(2772),s(2564),s(561),s(1058),s(9653),s(3290),s(6755),s(3123),s(2222),s(4812);var et=s(1549).Y.get("ApiCCWhiteBoardClient"),ot=function(lt,St,pt,gt,ct){function ht(it){it.style.display="none"}et.debug("Loading apiCC.ApiCCWhiteBoardClient"),this.roomId=null,this.whiteBoardDisconnectionTimeoutId=0,this.sessionStarted=!1,this.prev={},this.lastEmit=Date.now(),this.clients={},this.listenedPeers={},this.touchScreenActivated=!1,this.touchControlPoint={},this.drawElements=[],this.ghostElements={},this.redoStack=[],this.undoIndex=0,this.userCursorColor=null,this.cursors={},this.cursorStyle="cross",this.CURSOR_STYLES=["circle","cross"],this.currentScale=1,this.dx=0,this.dy=0,this.instructionsFaded=!1,this.canvas=null,this.ctx=null,this.currentTool="pen",this.currentColor="rgba(0, 0, 0, 1)",this.currentBrushWidth=1,this.readOnly=!1,this.isDrawing=!1,this.focusOnDrawing=!1,this.paperSheetId=0,this.drawingId=0,this.offline=!1,this.roomJoined=!1,this.laserModeActivated=!1,this.AVAILABLE_TOOLS=["pen","ellipse","rectangle","erase","void","arrow"],this.GEOMETRY_TOOLS=["arrow","rectangle","ellipse"],this.disconnectionTimer=ct!==void 0?ct:3e4,et.log("Setting Whiteboard disconnectionTimer to : "+this.disconnectionTimer),this.setCanvas=function(it){et.debug("[Whiteboard] setCanvas() :",it),this.canvas!==null&&(et.log("Unsetting old canvas events"),this.sessionStarted&&!this.readOnly&&(this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseleave=null,this.canvas.onmousemove=null,this.touchScreenActivated&&(this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1)))),it!==null&&document.getElementById(it)!==null?(this.canvas=document.getElementById(it),this.ctx=this.canvas.getContext("2d"),this.sessionStarted&&!this.readOnly&&(this.canvas.onmousedown=this.onmousedown,this.canvas.onmouseup=this.onmouseup,this.canvas.onmouseleave=this.onmouseleave,this.canvas.onmousemove=this.onmousemove,this.touchScreenActivated&&(this.canvas.addEventListener("touchstart",this.onTouchStart,!1),this.canvas.addEventListener("touchend",this.onTouchEnd,!1),this.canvas.addEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.addEventListener("touchleave",this.onTouchEnd,!1),this.canvas.addEventListener("touchmove",this.onTouchMove,!1)))):(it!==null&&document.getElementById(it)===null&&et.warn("No such element whose id is : "+it),this.canvas=null,this.ctx=null)},this.setCanvas(St),this.sendDataToRoom=function(it){if(et.info("[Whiteboard] sendDataToRoom()"),this.offline===!1&&this.roomId!==null){if(apiCC.session===null||apiCC.session===void 0)return void et.info("apiCC.session does not exist, leaving process");et.debug("this.drawElements :",this.drawElements),et.debug("data.tool :",it.tool);var ft=[];et.debug("drawElementsToSend :",ft);var mt,Tt={x:0,y:0,drawing:!1,tool:this.currentTool,cursorColor:this.userCursorColor,color:this.currentColor,width:this.currentBrushWidth,paperSheetId:this.paperSheetId,drawElements:ft,id:apiCC.session.apiCCId},It=Object.keys(it);for(mt=0;mt<It.length;mt++)Tt[It[mt]]=it[It[mt]];apiCC.session.roomMgr.sendMessageToRoom(this.roomId,"whiteBoard",Tt)}},this.setCursorsDiv=function(){et.warn("[Whiteboard] setCursorsDiv() - method obsolete, please use setUserCursorColor to set a cursor pointer that will be seen by other users")},this.setUserCursorColor=function(it){et.debug("[Whiteboard] setUserCursorColor() : "+it),it===null||it==="invisible"?this.userCursorColor="invisible":/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(it)?this.userCursorColor=it:(et.warn("[Whiteboard] setUserCursorColor() color "+it+" is invalid, defaulting to invisible"),this.userCursorColor="invisible")},this.setUserCursorColor(pt),this.setCursorStyle=function(it){et.debug("[Whiteboard] setCursorStyle() : "+it),this.CURSOR_STYLES.indexOf(it)>-1?(this.userCursorColor="invisible",this.cursorStyle=it):et.error("[Whiteboard] setCursorStyle() style "+it+" is invalid")},this.setFocusOnDrawing=function(it){et.debug("[Whiteboard] setFocusOnDrawing()"),this.focusOnDrawing=it},this.createRoom=function(){var it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};et.debug("[Whiteboard] createRoom()"),apiCC.session.roomMgr.createRoom("whiteBoard",it)},this.requestContactListInRoom=function(it){et.log("[Whiteboard] requestContactListInRoom :"+it),apiCC.session.roomMgr.requestContactListInRoom(it)},this.setDrawingTool=function(it){et.debug("[Whiteboard] setDrawingTool()");var ft=0;apiCC.session!==null&&(ft=apiCC.session.apiCCId),this.AVAILABLE_TOOLS.indexOf(it)>-1&&(this.currentTool=it,this.ghostElements[ft]=null)},this.setReadOnly=function(it){et.debug("[Whiteboard] setReadOnly()");var ft=0;apiCC.session!==null&&(ft=apiCC.session.apiCCId),this.ghostElements[ft]=null,this.readOnly=it===!0,this.readOnly&&this.canvas!==null?(this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseleave=null,this.canvas.onmousemove=null,this.touchScreenActivated&&(this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1))):this.canvas!==null&&(this.canvas.onmousedown=this.onmousedown,this.canvas.onmouseup=this.onmouseup,this.canvas.onmouseleave=this.onmouseleave,this.canvas.onmousemove=this.onmousemove,this.touchScreenActivated&&(this.canvas.addEventListener("touchstart",this.onTouchStart,!1),this.canvas.addEventListener("touchend",this.onTouchEnd,!1),this.canvas.addEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.addEventListener("touchleave",this.onTouchEnd,!1),this.canvas.addEventListener("touchmove",this.onTouchMove,!1)))},this.laserModeProcess=function(it){var ft=this;setTimeout(function(){return ft.undo(it)},5e3)},this.undo=function(it){et.debug("[Whiteboard] undo()");var ft=this.drawElements.length-1,mt=null,Tt=[],It=[],Pt=null,At=0;if(apiCC.session!==null&&(At=apiCC.session.apiCCId),it===void 0)for(;ft>=0;)this.drawElements[ft].userId==At&&(mt===null&&(mt=this.drawElements[ft].undoIndex),mt===this.drawElements[ft].undoIndex&&(Pt=this.drawElements.splice(ft,1)[0],Tt.push(Pt),It.push(Pt.drawingId))),ft--;else for(ft=0;ft<this.drawElements.length;ft++)this.drawElements[ft].userId==At&&this.drawElements[ft].drawingId===it&&(et.debug("[Whiteboard] element found with drawingId in undo laser :",it),Pt=this.drawElements.splice(ft,1)[0],Tt.push(Pt),It.push(Pt.drawingId));Tt.length>0&&(this.redraw(),this.sendDataToRoom({tool:"void",delete:It,undoneElements:Tt}),this.redoStack.push(Tt))},this.redo=function(){et.debug("[Whiteboard] redo()");var it,ft=[];if(this.redoStack.length>0){for(ft=this.redoStack.pop(),it=0;it<ft.length;it++)this.addNewDrawing(ft[it]);this.sendDataToRoom({tool:"void",drawObjectsArray:ft}),this.redraw()}},this.setBrushSize=function(it){et.debug("[Whiteboard] setBrushSize()"),!isNaN(it)&&it>0&&(this.currentBrushWidth=it)},this.setBrushColor=function(it){et.debug("[Whiteboard] setBrushColor()"),this.currentColor=it},this.setScale=function(it){et.debug("[Whiteboard] setScale()"),it>0?(this.currentScale=it,this.redraw()):et.warn("Scale factor must be > 0!")},this.getScale=function(){return et.debug("[Whiteboard] getScale()"),this.currentScale},this.setOffset=function(it,ft){et.debug("[Whiteboard] setOffset()");var mt=parseInt(it,10),Tt=parseInt(ft,10);isNaN(mt)||isNaN(Tt)||(this.dx=Number(mt),this.dy=Number(Tt),this.redraw())},this.getOffset=function(){return et.debug("[Whiteboard] getOffset()"),{x:this.dx,y:this.dy}},this.printSharedText=function(it,ft,mt,Tt,It,Pt){et.debug("[Whiteboard] printSharedText()"),this.setBrushStyle(this.currentColor,this.currentBrushWidth),this.undoIndex++,this.redoStack=[];var At=0;apiCC.session!==null&&(At=apiCC.session.apiCCId);var Nt={type:"text",x:it,y:ft,text:mt,size:Tt,font:It,border:Pt,userId:At,drawingId:this.drawingId,color:this.currentColor,width:this.currentBrushWidth,undoIndex:this.undoIndex,time:Date.now()};this.sendDataToRoom({x:it,y:ft,tool:"void",drawObject:Nt}),this.drawingId++,this.addNewDrawing(Nt)},this.addPeerListener=function(it,ft){et.debug("[Whiteboard] addPeerListener()"),this.listenedPeers.hasOwnProperty(it)||(this.listenedPeers[it]=[]),this.listenedPeers[it].push(ft)},this.inviteInRoom=function(it,ft,mt){var Tt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};et.debug("[Whiteboard] inviteInRoom()"),it!==null?ft!==null?apiCC.session.roomMgr.inviteInRoom(it,ft,"whiteBoard",mt,Tt):et.debug("wrong destId"):et.debug("wrong roomId")},this.answerToRoomInvitation=function(it,ft){et.info("[Whiteboard] answerToRoomInvitation()");var mt=ft&&!this.isInRoom();return this.isInRoom()?et.error("[Whiteboard] cannot answer room invitation : user is already in a room"):apiCC.session.roomMgr.answerToRoomInvitation(it,ft,"whiteBoard"),mt&&(et.log("[Whiteboard] user joining room"),this.paperSheetId=0,this.drawingId=0,this.roomId=it,this.sendDataToRoom({tool:"void",needCatchUp:"*||-1"})),mt},this.joinRoom=function(it){var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};et.info("[Whiteboard] joinRoom() roomId :",it),it==null?et.error("[Whiteboard] cannot join room : room is null or undefined"):this.isInRoom()&&this.roomJoined===!0?et.error("[Whiteboard] cannot join room : user is already in a room"):apiCC.session.roomMgr.joinRoom(it,"whiteBoard",ft)},this.leaveRoom=function(){et.info("[Whiteboard] leaveRoom()"),this.isInRoom()&&(apiCC.session.roomMgr.leaveRoom(this.roomId,"whiteBoard"),this.roomId=null,this.paperSheetId=0,this.drawingId=0,this.listenedPeers={},this.roomJoined=!1)},this.isInRoom=function(){return this.roomId!==null},this.clearPaper=function(){et.debug("[Whiteboard] clearPaper()"),this.deleteHistory()},this.refreshCanvas=function(){if(this.canvas!==null&&this.ctx!==null){var it=this.canvas.width;this.canvas.width=it}},this.deleteHistory=function(){et.info("[Whiteboard] deleteHistory()");var it=0;apiCC.session!==null&&(it=apiCC.session.apiCCId),this.refreshCanvas(),this.drawElements=[],this.ghostElements[it]=null,this.paperSheetId++,this.drawingId=0,this.sendDataToRoom({tool:"void",deleteHistory:!0})},this.setBrushStyle=function(it,ft){this.ctx!==null&&(this.ctx.strokeStyle=it,this.ctx.fillStyle=it,this.ctx.lineWidth=ft)},this.redraw=function(){var it,ft,mt;for(et.debug("[Whiteboard] redraw()"),this.refreshCanvas(),it=0;it<this.drawElements.length;it++)this.drawSingleObject(this.drawElements[it]);for(ft=Object.keys(this.ghostElements),it=0;it<ft.length;it++)this.ghostElements[ft[it]]!==null&&this.drawSingleObject(this.ghostElements[ft[it]]);for(ft=Object.keys(this.cursors),it=0;it<ft.length;it++)if(this.cursors[ft[it]]!==null&&this.cursors[ft[it]].color!=="invisible"&&(this.cursors[ft[it]].x!==0||this.cursors[ft[it]].y!==0))switch(mt={fromx:(this.cursors[ft[it]].x-this.dx)*this.currentScale-13,fromy:(this.cursors[ft[it]].y-this.dy)*this.currentScale-13,tox:(this.cursors[ft[it]].x-this.dx)*this.currentScale+13,toy:(this.cursors[ft[it]].y-this.dy)*this.currentScale+13},this.setBrushStyle(this.cursors[ft[it]].color,4),this.cursorStyle){case"circle":this.ctx!==null&&(this.ctx.globalAlpha=.4,this.fillEllipse(mt.fromx,mt.fromy,mt.tox,mt.toy),this.drawEllipse(mt.fromx+2,mt.fromy+2,mt.tox-2,mt.toy-2),this.ctx.globalAlpha=1);break;case"cross":this.ctx!==null&&(this.ctx.globalAlpha=.7,this.ctx.beginPath(),this.ctx.moveTo(mt.fromx+(mt.tox-mt.fromx)/2,mt.fromy),this.ctx.lineTo(mt.fromx+(mt.tox-mt.fromx)/2,mt.toy),this.ctx.lineCap="butt",this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(mt.fromx,mt.fromy+(mt.toy-mt.fromy)/2),this.ctx.lineTo(mt.tox,mt.fromy+(mt.toy-mt.fromy)/2),this.ctx.lineCap="butt",this.ctx.stroke(),this.ctx.globalAlpha=1)}},this.addNewDrawing=function(it){var ft=0;this.drawElements.push(it),this.drawSingleObject(it),apiCC.session!==null&&(ft=apiCC.session.apiCCId),it.userId===ft&&this.laserModeActivated===!0&&this.laserModeProcess(it.drawingId)},this.drawSingleObject=function(it){if(this.ctx!==null&&this.canvas!==null){var ft={};switch(this.setBrushStyle(it.color,it.width),this.ctx.scale(this.currentScale,this.currentScale),ft.fromx=it.fromx-this.dx,ft.tox=it.tox-this.dx,ft.x=it.x-this.dx,ft.fromy=it.fromy-this.dy,ft.toy=it.toy-this.dy,ft.y=it.y-this.dy,it.type){case"arrow":this.drawArrow(ft.fromx,ft.fromy,ft.tox,ft.toy);break;case"ellipse":this.drawEllipse(ft.fromx,ft.fromy,ft.tox,ft.toy);break;case"rectangle":this.drawRectangle(ft.fromx,ft.fromy,ft.tox,ft.toy);break;case"pen":this.drawLine(ft.fromx,ft.fromy,ft.tox,ft.toy);break;case"erase":this.eraseArea(ft.fromx,ft.fromy);break;case"text":this.drawText(ft.x,ft.y,it.text,it.size,it.font,it.border)}this.ctx.scale(1/this.currentScale,1/this.currentScale)}},this.drawLine=function(it,ft,mt,Tt){this.ctx!==null&&(this.ctx.beginPath(),this.ctx.moveTo(it,ft),this.ctx.lineTo(mt,Tt),this.ctx.lineCap="round",this.ctx.stroke())},this.drawText=function(it,ft,mt,Tt,It,Pt){if(this.ctx!==null){var At,Nt,Ot="Arial";It!=null&&(Ot=It),this.ctx.font=Tt+"px "+Ot,this.ctx.fillText(mt,it,ft),Pt!=null&&(At=this.ctx.strokeStyle,Nt=this.ctx.lineWidth,this.ctx.strokeStyle=Pt,this.ctx.lineWidth=1,this.ctx.strokeText(mt,it,ft),this.ctx.strokeStyle=At,this.ctx.lineWidth=Nt)}},this.eraseArea=function(it,ft){this.ctx!==null&&this.ctx.clearRect(it-this.ctx.lineWidth-1,ft-this.ctx.lineWidth-1,2*this.ctx.lineWidth+2,2*this.ctx.lineWidth+2)},this.drawArrow=function(it,ft,mt,Tt){if(this.ctx!==null){var It=Math.atan2(Tt-ft,mt-it);this.ctx.beginPath(),this.ctx.lineCap="butt",this.ctx.moveTo(it,ft),this.ctx.lineTo(mt,Tt),this.ctx.stroke(),this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(mt,Tt),this.ctx.rotate(It+Math.PI/2),this.ctx.moveTo(0,-this.ctx.lineWidth),this.ctx.lineTo(5*this.ctx.lineWidth*.5+1,10+.25*this.ctx.lineWidth),this.ctx.lineTo(-5*this.ctx.lineWidth*.5-1,10+.25*this.ctx.lineWidth),this.ctx.closePath(),this.ctx.restore(),this.ctx.fill()}},this.drawEllipse=function(it,ft,mt,Tt){var It=null,Pt=null;this.ctx!==null&&(It={x:Math.abs(it-mt)/2,y:Math.abs(ft-Tt)/2},Pt={x:it-(it-mt)/2,y:ft-(ft-Tt)/2},this.ctx.beginPath(),apiRTC.browser!=="IE"&&this.ctx.ellipse(Pt.x,Pt.y,It.x,It.y,0,0,2*Math.PI),this.ctx.stroke())},this.fillEllipse=function(it,ft,mt,Tt){if(this.ctx!==null){var It={x:Math.abs(it-mt)/2,y:Math.abs(ft-Tt)/2},Pt={x:it-(it-mt)/2,y:ft-(ft-Tt)/2};this.ctx.beginPath(),apiRTC.browser!=="IE"&&this.ctx.ellipse(Pt.x,Pt.y,It.x,It.y,0,0,2*Math.PI),this.ctx.fill()}},this.drawRectangle=function(it,ft,mt,Tt){if(this.ctx!==null){this.ctx.beginPath();var It=it,Pt=ft;it>mt&&(It=mt),ft>Tt&&(Pt=Tt),this.ctx.rect(It,Pt,Math.abs(it-mt),Math.abs(ft-Tt)),this.ctx.stroke()}},this.getContext=function(){return this.ctx},this.loadPhotoInBackground=function(it){et.debug("[Whiteboard] loadPhotoInBackground :"+it);var ft=document.getElementsByTagName("body")[0];ft.style.backgroundImage="url("+it+")",ft.style.backgroundPosition="50% 50%",ft.style.backgroundRepeat="no-repeat"},this.messageProcessing=function(it){et.debug("[Whiteboard] messageProcessing");var ft,mt=null,Tt=null,It=!1,Pt=null,At=null,Nt=null,Ot=null,Mt=null;if(this.cursors[it.id]||(et.log("[Whiteboard] messageProcessing - creating cursor for new user : "+it.id),this.cursors[it.id]={id:it.id},this.clients[it.id]={}),this.cursors[it.id].x=it.x,this.cursors[it.id].y=it.y,this.cursors[it.id].lastUpdate=Date.now(),it.cursorColor&&it.cursorColor!==null?this.cursors[it.id].color=it.cursorColor:this.cursors[it.id].color="invisible",apiRTC.userAgentInstance===void 0||apiRTC.userAgentInstance.capabilities.whiteboardCursor==="ON"?this.cursors[it.id].color!=="invisible"&&(It=!0):(et.debug("[Whiteboard] - cursor is not supported on userAgent"),this.cursors[it.id].color="invisible"),this.ghostElements[it.id]!==null&&(this.ghostElements[it.id]=null,It=!0),this.listenedPeers.hasOwnProperty(it.id))for(Pt={id:it.id,x:it.x,y:it.y,tool:it.tool,drawing:it.drawing},ft=0;ft<this.listenedPeers[it.id].length;ft++)typeof this.listenedPeers[it.id][ft]=="function"?this.listenedPeers[it.id][ft](Pt):et.warn("[Whiteboard] Peer listenener is not a function!");if(it.drawing&&this.clients[it.id]&&(et.debug("data.drawing && this.clients[data.id]"),Tt={fromx:it.prevX!==void 0?it.prevX:this.clients[it.id].x,fromy:it.prevY!==void 0?it.prevY:this.clients[it.id].y,tox:it.x,toy:it.y,type:it.tool!==null?it.tool:"pen",color:it.color,width:it.width,userId:it.id,drawingId:it.drawingId},this.GEOMETRY_TOOLS.indexOf(Tt.type)>-1?it.prevX&&it.prevY&&(this.ghostElements[it.id]=Tt,It=!0):this.addNewDrawing(Tt),this.focusOnDrawing&&((mt=this.canvas.parentNode).scrollLeft=this.currentScale*(it.x-this.dx)-mt.clientWidth/2,mt.scrollTop=this.currentScale*(it.y-this.dy)-mt.clientHeight/2)),it.drawObject&&((Tt=it.drawObject).color=it.color,Tt.width=it.width,this.ghostElements[it.id]=null,this.addNewDrawing(Tt),this.focusOnDrawing&&((mt=this.canvas.parentNode).scrollLeft=this.currentScale*(it.x-this.dx)-mt.clientWidth/2,mt.scrollTop=this.currentScale*(it.y-this.dy)-mt.clientHeight/2)),it.hasOwnProperty("drawObjectsArray"))for(ft=0;ft<it.drawObjectsArray.length;ft++)this.addNewDrawing(it.drawObjectsArray[ft]);if(it.hasOwnProperty("delete"))for(ft=this.drawElements.length-1,It=!0;ft>=0;)it.delete.indexOf(this.drawElements[ft].drawingId)>-1&&this.drawElements[ft].userId==it.id&&this.drawElements.splice(ft,1),ft--;if(it.hasOwnProperty("paperSheetId")){if(it.paperSheetId<this.paperSheetId)et.debug("[Whiteboard] - data.paperSheetId < this.paperSheetId");else if(it.paperSheetId>this.paperSheetId){if(et.debug("[Whiteboard] - messageProcessing : peer has a more recent version : "+this.paperSheetId+" vs "+it.paperSheetId),it.hasOwnProperty("deleteHistory")&&et.debug("User : "+it.id+" ,has deleted the history"),it.hasOwnProperty("drawElements")){for(et.debug("[Whiteboard] - messageProcessing : receiving update from peer"),it.drawElements!==null?this.drawElements=it.drawElements:this.drawElements=[],ft=0;ft<this.drawElements.length;ft++)this.drawElements[ft].hasOwnProperty("userId")&&this.drawElements[ft].hasOwnProperty("drawingId")&&(this.clients[this.drawElements[ft].userId]={x:0,y:0,drawing:!1,tool:"pen",cursorColor:null,color:null,width:1,paperSheetId:this.paperSheetId,drawingId:this.drawElements[ft].drawingId,id:this.drawElements[ft].userId});this.paperSheetId=it.paperSheetId,this.drawingId=0,It=!0}}else if(it.hasOwnProperty("drawingId"))if(et.debug("[Whiteboard] - data.hasOwnProperty(drawingId): "),it.drawingId!==0&&this.clients[it.id]===void 0||this.clients[it.id]!==void 0&&this.clients[it.id].hasOwnProperty("drawingId")&&it.drawingId-this.clients[it.id].drawingId>1)et.log("[Whiteboard] - messageProcessing : catchup from peer required : "+it.drawingId),Ot=it.id+"||-1",this.clients[it.id]!==void 0&&this.clients[it.id].hasOwnProperty("drawingId")&&(Ot=it.id+"||"+this.clients[it.id].drawingId),this.sendDataToRoom({tool:"void",needCatchUp:Ot});else if(it.hasOwnProperty("needCatchUp")&&(it.needCatchUp.startsWith(apiCC.session.apiCCId+"||")||it.needCatchUp.startsWith("*||"))){for(et.debug("[Whiteboard] - messageProcessing : letting peer catchup: "+it.id),At=it.needCatchUp.split("||")[1],Nt=[],ft=0;ft<this.drawElements.length;ft++)(Mt=this.drawElements[ft]).hasOwnProperty("userId")&&Mt.hasOwnProperty("drawingId")&&Mt.userId===apiCC.session.apiCCId&&Mt.drawingId>parseInt(At,10)&&Nt.push(Mt);this.sendDataToRoom({tool:"void",catchUpData:Nt,catchupIndex:At})}else et.debug("[Whiteboard] - else - drawingId");else if(it.hasOwnProperty("needCatchUp")){for(et.debug("[Whiteboard] - messageProcessing : needCatchUp"+it.id),At=it.needCatchUp.split("||")[1],Nt=[],ft=0;ft<this.drawElements.length;ft++)Mt=this.drawElements[ft],Nt.push(Mt);et.debug("[Whiteboard] - sending catchUpData : ",Nt),this.sendDataToRoom({tool:"void",catchUpData:Nt,catchupIndex:At})}else et.debug("[Whiteboard] - else - paperSheetId");if(it.hasOwnProperty("catchUpData")){for(et.debug("[Whiteboard] - messageProcessing : catching up: "+it.id),it.catchUpStatus==="complete"&&(et.debug("catchUpData is complete, cleaning drawElements"),this.drawElements.splice(0,this.drawElements.length)),ft=0;ft<it.catchUpData.length;ft++)Mt=it.catchUpData[ft],it.userId===apiCC.session.apiCCId&&Mt.hasOwnProperty("drawingId")&&this.drawingId<Mt.drawingId&&(this.drawingId=Mt.drawingId+1);this.drawElements=it.catchUpData.concat(this.drawElements),this.paperSheetId=it.paperSheetId,It=!0}}It&&this.redraw(),this.clients[it.id]=it},this.isStarted=function(){return this.sessionStarted},this.start=function(){this.isStarted()?et.warn("[Whiteboard] WhiteBoardClient is already started"):(et.info("[Whiteboard] starting WhiteBoardClient"),this.isDrawing=!1,this.prev={},this.lastEmit=Date.now(),this.currentScale=1,this.dx=0,this.dy=0,this.drawingId=0,this.clients={},this.listenedPeers={},this.cursors={},this.drawElements=[],this.touchScreenActivated=!1,this.sessionStarted=!0,this.canvas!==null&&(this.canvas.onmousedown=this.onmousedown,this.canvas.onmouseup=this.onmouseup,this.canvas.onmouseleave=this.onmouseleave,this.canvas.onmousemove=this.onmousemove),this.redraw()),apiCC.session!==null&&apiCC.session.roomMgr!==void 0||(et.log("[Whiteboard] roomMgr is not defined, setting offline mode"),this.offline=!0)},this.stop=function(){this.isStarted()?(et.info("[Whiteboard] Stopping WhiteBoardClient"),this.isInRoom()&&this.leaveRoom(),this.sessionStarted=!1,this.canvas!==null&&(this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseleave=null,this.canvas.onmousemove=null,this.touchScreenActivated&&(this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1))),this.drawElements=[],this.ghostElements={},this.redoStack=[]):et.info("[Whiteboard] cannot stop WhiteboardClient as it is not started")},this.getTouchOffSet=function(it){et.debug("[Whiteboard] getTouchOffSet():");var ft,mt,Tt,It,Pt=null,At={offsetX:0,offsetY:0};return Pt=it.target,ft=window.getComputedStyle(Pt,null),mt=parseInt(ft.borderLeftWidth,10),Tt=parseInt(ft.borderTopWidth,10),It=Pt.getBoundingClientRect(),At.offsetX=it.clientX-mt-It.left,At.offsetY=it.clientY-Tt-It.top,et.log("offset.offsetX :"+At.offsetX),et.log("offset.offsetY :"+At.offsetY),At},this.toggleTouchScreen=function(){this.touchScreenActivated===!0?this.deactivateTouchScreen():this.activateTouchScreen()},this.activateTouchScreen=function(){this.canvas!==null?(this.touchScreenActivated=!0,this.canvas.addEventListener("touchstart",this.onTouchStart,!1),this.canvas.addEventListener("touchend",this.onTouchEnd,!1),this.canvas.addEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.addEventListener("touchleave",this.onTouchEnd,!1),this.canvas.addEventListener("touchmove",this.onTouchMove,!1)):et.warn("Trying to activateTouchScreen() while canvas is null.")},this.deactivateTouchScreen=function(){this.canvas!==null?(this.touchScreenActivated=!1,this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1)):et.warn("Trying to deactivateTouchScreen() while canvas is null.")},this.activateLaserMode=function(){this.laserModeActivated=!0},this.deactivateLaserMode=function(){this.laserModeActivated=!1},this.sendDrawingData=function(it,ft,mt){et.debug("[Whiteboard] sendDrawingData()");var Tt={x:it.offsetX,y:it.offsetY,drawing:ft,prevX:this.prev.x,prevY:this.prev.y};if(ft!==!1||this.userCursorColor!=="invisible"){var It=0;apiCC.session!==null&&(It=apiCC.session.apiCCId),mt!==null&&(Tt.drawObject=mt,Tt.drawObject.drawingId=this.drawingId,Tt.drawObject.userId=It,this.drawingId++),Tt.drawingId=this.drawingId,this.sendDataToRoom(Tt)}else et.debug("isDrawing false and userCursorColor invisible - leaving sendDrawingData")},this.onmousedown=(function(it){it.preventDefault();var ft,mt,Tt=it.target||it.srcElement,It=Tt.currentStyle||window.getComputedStyle(Tt,null),Pt=parseInt(It.borderLeftWidth,10)||0,At=parseInt(It.borderTopWidth,10)||0,Nt=Tt.getBoundingClientRect(),Ot={offsetX:this.dx+1/this.currentScale*(it.clientX-Pt-Nt.left),offsetY:this.dy+1/this.currentScale*(it.clientY-At-Nt.top)};if(this.prev.x=Ot.offsetX,this.prev.y=Ot.offsetY,this.isDrawing=!0,this.undoIndex++,this.redoStack=[],(ft=document.getElementById(gt))===null||this.instructionsFaded||(ht(ft),this.instructionsFaded=!0),this.currentTool==="erase"){this.sendDrawingData(Ot,this.isDrawing,null);var Mt=0;apiCC.session!==null&&(Mt=apiCC.session.apiCCId),this.lastEmit=Date.now(),mt={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,color:this.currentColor,width:this.currentBrushWidth,userId:Mt,drawingId:this.drawingId,undoIndex:this.undoIndex,time:Date.now()},this.drawingId++,this.addNewDrawing(mt),this.redraw()}}).bind(this),this.onmouseup=(function(it){var ft,mt=null,Tt=null,It=0,Pt=0,At=null,Nt={offsetX:0,offsetY:0},Ot=0;this.isDrawing&&this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&(Tt=(mt=it.target||it.srcElement).currentStyle||window.getComputedStyle(mt,null),It=parseInt(Tt.borderLeftWidth,10)||0,Pt=parseInt(Tt.borderTopWidth,10)||0,At=mt.getBoundingClientRect(),Nt.offsetX=this.dx+1/this.currentScale*(it.clientX-It-At.left),Nt.offsetY=this.dy+1/this.currentScale*(it.clientY-Pt-At.top),apiCC.session!==null&&(Ot=apiCC.session.apiCCId),ft={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,tox:Nt.offsetX,toy:Nt.offsetY,color:this.currentColor,width:this.currentBrushWidth,userId:Ot,undoIndex:this.undoIndex,time:Date.now()},this.sendDrawingData(Nt,this.isDrawing,ft),this.ghostElements[Ot]=null,this.redraw(),this.addNewDrawing(ft),this.prev.x=Nt.offsetX,this.prev.y=Nt.offsetY),this.isDrawing=!1,this.ghostElements[Ot]=null}).bind(this),this.onmouseleave=(function(){var it=0;apiCC.session!==null&&(it=apiCC.session.apiCCId),this.isDrawing=!1,this.sendDrawingData({offsetX:0,offsetY:0},this.isDrawing,null),this.ghostElements[it]=null}).bind(this),this.onmousemove=(function(it){var ft,mt,Tt,It,Pt,At=null,Nt={};if(ft=(At=it.target||it.srcElement).currentStyle||window.getComputedStyle(At,null),mt=parseInt(ft.borderLeftWidth,10)||0,Tt=parseInt(ft.borderTopWidth,10)||0,It=At.getBoundingClientRect(),Nt.offsetX=this.dx+1/this.currentScale*(it.clientX-mt-It.left),Nt.offsetY=this.dy+1/this.currentScale*(it.clientY-Tt-It.top),Date.now()-this.lastEmit>30)if(this.sendDrawingData(Nt,this.isDrawing,null),this.lastEmit=Date.now(),this.isDrawing){var Ot=0;apiCC.session!==null&&(Ot=apiCC.session.apiCCId),Pt={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,color:this.currentColor,width:this.currentBrushWidth,userId:Ot,undoIndex:this.undoIndex,time:Date.now()},this.currentTool==="pen"||this.currentTool==="erase"?(this.currentTool==="pen"&&(Pt.tox=Nt.offsetX,Pt.toy=Nt.offsetY),Pt.drawingId=this.drawingId,this.drawingId++,this.addNewDrawing(Pt),this.prev.x=Nt.offsetX,this.prev.y=Nt.offsetY):this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&(Pt.tox=Nt.offsetX,Pt.toy=Nt.offsetY,this.ghostElements[Ot]=Pt),this.currentTool!=="pen"&&this.redraw()}else this.currentTool==="erase"&&(this.redraw(),Pt={type:"rectangle",fromx:Nt.offsetX-this.currentBrushWidth,fromy:Nt.offsetY-this.currentBrushWidth,tox:parseInt(Nt.offsetX,10)+parseInt(this.currentBrushWidth,10),toy:parseInt(Nt.offsetY,10)+parseInt(this.currentBrushWidth,10),color:"#444444",width:1},this.drawSingleObject(Pt),Pt.color="#DDDDDD",Pt.fromx=Pt.fromx-1,Pt.fromy=Pt.fromy-1,Pt.tox=Pt.tox+1,Pt.toy=Pt.toy+1,this.drawSingleObject(Pt))}).bind(this),this.onTouchStart=(function(it){et.debug("[Whiteboard] handleStart"),it.preventDefault();var ft,mt=it.changedTouches,Tt={};this.isDrawing=!0,this.undoIndex++,this.redoStack=[],(Tt=this.getTouchOffSet(mt[0])).offsetX=this.dx+1/this.currentScale*Tt.offsetX,Tt.offsetY=this.dy+1/this.currentScale*Tt.offsetY,this.prev.x=Tt.offsetX,this.prev.y=Tt.offsetY,this.sendDrawingData(Tt,!1,null),(ft=document.getElementById(gt))!==null&&ht(ft)}).bind(this),this.onTouchEnd=(function(it){et.debug("[Whiteboard] handleEnd :"+it);var ft,mt={},Tt=it.changedTouches,It=0;this.isDrawing&&this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&((mt=this.getTouchOffSet(Tt[0])).offsetX=this.dx+1/this.currentScale*mt.offsetX,mt.offsetY=this.dy+1/this.currentScale*mt.offsetY,apiCC.session!==null&&(It=apiCC.session.apiCCId),ft={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,tox:mt.offsetX,toy:mt.offsetY,color:this.currentColor,width:this.currentBrushWidth,userId:It,undoIndex:this.undoIndex,time:Date.now()},this.sendDrawingData(mt,this.isDrawing,ft),this.addNewDrawing(ft),this.prev.x=mt.offsetX,this.prev.y=mt.offsetY),this.isDrawing=!1,this.ghostElements[It]=null,it=null}).bind(this),this.onTouchCancel=(function(it){et.debug("[Whiteboard] handleCancel :"+it);var ft=0;apiCC.session!==null&&(ft=apiCC.session.apiCCId),this.isDrawing=!1,this.ghostElements[ft]=null,it=null}).bind(this),this.onTouchMove=(function(it){et.debug("[Whiteboard] handleMove :"+it);var ft,mt=it.changedTouches,Tt={};if(Date.now()-this.lastEmit>30&&((Tt=this.getTouchOffSet(mt[0])).offsetX=this.dx+1/this.currentScale*Tt.offsetX,Tt.offsetY=this.dy+1/this.currentScale*Tt.offsetY,this.sendDrawingData(Tt,this.isDrawing,null),this.lastEmit=Date.now(),this.isDrawing)){(Tt=this.getTouchOffSet(mt[0])).offsetX=this.dx+1/this.currentScale*Tt.offsetX,Tt.offsetY=this.dy+1/this.currentScale*Tt.offsetY;var It=0;apiCC.session!==null&&(It=apiCC.session.apiCCId),ft={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,color:this.currentColor,width:this.currentBrushWidth,userId:It,undoIndex:this.undoIndex,time:Date.now()},this.currentTool==="pen"||this.currentTool==="erase"?(this.currentTool==="pen"&&(ft.tox=Tt.offsetX,ft.toy=Tt.offsetY),ft.drawingId=this.drawingId,this.drawingId++,this.addNewDrawing(ft),this.prev.x=Tt.offsetX,this.prev.y=Tt.offsetY):this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&(ft.tox=Tt.offsetX,ft.toy=Tt.offsetY,this.ghostElements[It]=ft,this.redraw())}}).bind(this)}},8560:(at,ut,s)=>{s.r(ut),s(2772),s(3710),s(9554),s(1539),s(8674),s(561),s(2564),s(8309),s(4916),s(3123),s(1058),s(6992),s(8783),s(3948),s(285),s(1637),s(4363),s(9653),s(9714),s(3843),s(7941),s(4812),s(9575),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(2222),s(9600),s(6755),s(4747),s(2526),s(1817),s(2165);var et=s(1549),ot=s(5945),lt=s(8765),St=s(1215),pt=s(3173),gt=et.Y.get("RecordManager"),ct=s(4708);function ht(Ot,Mt){for(var bt=0;bt<Mt.length;bt++){var Wt=Mt[bt];Wt.enumerable=Wt.enumerable||!1,Wt.configurable=!0,"value"in Wt&&(Wt.writable=!0),Object.defineProperty(Ot,Wt.key,Wt)}}s(2707),s(7042),s(9070);var it=et.Y.get("AudioProcessor"),ft=window.AudioContext||window.webkitAudioContext||!1,mt=function(){function Ot(){(function(Wt,zt){if(!(Wt instanceof zt))throw new TypeError("Cannot call a class as a function")})(this,Ot),this.audioContext=null}var Mt,bt;return Mt=Ot,(bt=[{key:"getOrCreateAudioContext",value:function(){return it.debug("getOrCreateAudioContext"),apiRTC.osName==="iOS"&&typeof cordova<"u"?it.debug("No audioContext for iOS cordova"):ft&&(this.audioContext=new ft),this.audioContext.state==="suspended"&&this.audioContext.resume().then(function(){it.debug("AudioContext is resumed")}),this.audioContext}},{key:"listenToAudio",value:function(Wt,zt){if(it.debug("listenToAudio()"),zt!=null&&apiCC.activeSpeakerDetect===!0&&zt.childStreamType!=="noiseReduction"){it.debug("activeSpeakerDetect()");var Bt=null,rn=!1,gn=this.getOrCreateAudioContext();gn!=null?(zt.nodeCtx={},zt.nodeCtx.sourceNode=gn.createMediaStreamSource(Wt),zt.nodeCtx.analyserNode=gn.createAnalyser(),zt.nodeCtx.analyserNode.fftSize=2048,zt.nodeCtx.sourceNode.connect(zt.nodeCtx.analyserNode),zt.nodeCtx.listenToAudioIntervalId=setInterval(function(){var tn,Ht,fn=new Uint8Array(zt.nodeCtx.analyserNode.frequencyBinCount),bn=0;for(zt.nodeCtx.analyserNode.getByteFrequencyData(fn),fn.sort(function(In,un){return un-In}),fn=fn.slice(0,50),Ht=0;Ht<fn.length;Ht++)bn+=fn[Ht];(tn=bn/fn.length)>255*apiCC.activeSpeakerThreshold&&(rn||(rn=!0,zt.notifyActiveSpeaker(tn),it.debug("notifyActiveSpeaker this.userMediaStreamId :",zt.userMediaStreamId)),Bt!==null&&clearTimeout(Bt),Bt=setTimeout(function(){zt.notifyNotActiveSpeaker(tn),it.debug("notifyNotActiveSpeaker this.userMediaStreamId :",zt.userMediaStreamId),rn=!1},1e3))},100)):it.error("listenToAudio() - Unable to create audio context")}else it.debug("activeSpeakerDetecting is not activated or stream type is noiseReduction")}},{key:"checkstopAudioNodeCtxConditions",value:function(Wt){return apiCC.userAgentInstance!==void 0&&apiCC.userAgentInstance.getCapabilities().noiseReduction==="OFF"?"Navigator not compatible with this function":Wt===void 0?"nodeCtx undefined":"OK"}},{key:"stopAudioNodeCtx",value:function(Wt){it.debug("stopAudioNodeCtx :",Wt);var zt=this.checkstopAudioNodeCtxConditions(Wt);if(zt!=="OK")return zt;Wt.sourceNode!==void 0&&Wt.sourceNode!==null&&(Wt.sourceNode.disconnect(),Wt.sourceNode=null),Wt.analyserNode!==void 0&&Wt.analyserNode!==null&&(Wt.analyserNode.disconnect(),Wt.analyserNode=null),Wt.audioDestination!==void 0&&Wt.audioDestination!==null&&(Wt.audioDestination.disconnect(),Wt.audioDestination=null),Wt.originalMediaTrack!==void 0&&Wt.originalMediaTrack!==null&&(Wt.originalMediaTrack=null),Wt.outputMediaTrack!==void 0&&Wt.outputMediaTrack!==null&&(Wt.outputMediaTrack=null),Wt.listenToAudioIntervalId!==void 0&&Wt.listenToAudioIntervalId!==null&&(clearInterval(Wt.listenToAudioIntervalId),Wt.listenToAudioIntervalId=null),Wt.noiseSuppressorNode!==void 0&&Wt.noiseSuppressorNode!==null&&(Wt.noiseSuppressorNode.port.onmessage=null,Wt.noiseSuppressorNode.port.close(),Wt.noiseSuppressorNode=null)}},{key:"checkChildTypeConditions",value:function(Wt){return apiCC.userAgentInstance!==void 0&&apiCC.userAgentInstance.getCapabilities().noiseReduction==="OFF"?"Navigator not compatible with this function":Wt.childType!==void 0&&Wt.childType==="noiseReduction"?"This stream has already a noiseReduction effect applied : "+Wt.childType:Wt.childrenTypeExists("noiseReduction")?"This stream has already has a noiseReduction sub instance running":"OK"}},{key:"startNoiseReduction",value:function(Wt){var zt=this,Bt=null,rn=!1;return new Promise(function(gn,tn){it.debug("startNoiseReduction");var Ht=zt.checkChildTypeConditions(Wt);if(Ht!=="OK")return tn(Ht);Wt.nodeCtx={},Wt.nodeCtx.originalMediaTrack=Wt.data.getAudioTracks()[0];var fn=apiCC.audioProcessor.getOrCreateAudioContext();Wt.nodeCtx.sourceNode=fn.createMediaStreamSource(Wt.data);var bn={channelCount:Wt.data.getAudioTracks()[0].getSettings().channelCount,channelCountMode:"explicit"};Wt.nodeCtx.audioDestination=new MediaStreamAudioDestinationNode(fn,bn),Wt.nodeCtx.outputMediaTrack=Wt.nodeCtx.audioDestination.stream.getAudioTracks()[0],fn.audioWorklet.addModule("https://cdn.apizee.com/apiRTC/lib/noiseReduction/ApiRTC_NR_Worklet_1.0.1.js").then(function(){Wt.nodeCtx.noiseSuppressorNode=new AudioWorkletNode(fn,"NoiseSuppressorWorklet",{parameterData:{activeSpeakerDetect:apiCC.activeSpeakerDetect}}),Wt.nodeCtx.sourceNode.connect(Wt.nodeCtx.noiseSuppressorNode).connect(Wt.nodeCtx.audioDestination);var In={audioFilterIsApplied:Wt.audioFilterIsApplied,audioAppliedFilter:Wt.audioAppliedFilter,videoFilterIsApplied:Wt.videoFilterIsApplied,videoAppliedFilter:Wt.videoAppliedFilter,childType:Wt.childType},un=Wt.nodeCtx.audioDestination.stream;Wt.data.getVideoTracks().forEach(function(mn){un.addTrack(mn.clone())}),Wt.createChildStreamFromStream(un,"noiseReduction",In).then(function(mn){Wt.addChildren(mn,"noiseReduction"),mn.applyMuteStatusFromParent();var yn=apiCC.getUserMediaStream(Wt.userMediaStreamId);apiCC.audioProcessor.stopAudioNodeCtx(yn.nodeCtx);var pn=apiCC.getUserMediaStream(mn.userMediaStreamId);return Wt.nodeCtx.noiseSuppressorNode.port.onmessage=function(Tn){Tn.data.vadScore>apiCC.activeSpeakerThreshold&&(rn||(rn=!0,pn.notifyActiveSpeaker(Tn.data.vadScore),it.debug("notifyActiveSpeaker this.userMediaStreamId :",pn.userMediaStreamId)),Bt!==null&&clearTimeout(Bt),Bt=setTimeout(function(){pn.notifyNotActiveSpeaker(Tn.data.vadScore),it.debug("notifyNotActiveSpeaker this.userMediaStreamId :",pn.userMediaStreamId),rn=!1},1e3))},gn(mn)}).catch(tn)}).catch(function(In){console.error("Error while adding audio worklet module: ",In)})})}}])&&ht(Mt.prototype,bt),Object.defineProperty(Mt,"prototype",{writable:!1}),Ot}();function Tt(Ot){return Tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Mt){return typeof Mt}:function(Mt){return Mt&&typeof Symbol=="function"&&Mt.constructor===Symbol&&Mt!==Symbol.prototype?"symbol":typeof Mt},Tt(Ot)}var It=et.Y.get("ApiCC_Methods"),Pt=s(6075).F;apiCC.myWebRTC_Adapter=new Pt,apiCC.myWebRTC_Event=new lt.K;var At=apiCC.myWebRTC_Event;apiCC.myEventTable=[],apiCC.ApiCCSession=s(3720).K,apiCC.ApiCCWebRTCClient=s(1192).D,apiCC.ApiCCUserMediaStream=s(7323).q,apiCC.ApiCCPointerSharingClient=s(9213).X,apiCC.ApiCCWhiteBoardClient=s(6527).p,apiCC.ApiCCDataClient=s(128)._,apiCC.ApiCCIMClient=s(6844).U,apiCC.recordMgr=new function(){gt.debug("RecordManager creation"),this.mediaRecorder=null,this.recordedBlobs=[],this.mimeType=null,this.record=function(Ot,Mt){var bt=this;return gt.info("record"),gt.log("stream :"+Ot),gt.log("stream :",Ot),new Promise(function(Wt,zt){var Bt=null;if(MediaRecorder===void 0)return gt.debug("MediaRecorder is not supported on this browser, leaving recordStream process"),void zt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"MediaRecorder is not supported on this browser, leaving recordStream process",gt));if(Ot===null)return gt.debug("Stream has no data, cannot record"),void zt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"Stream has no data, cannot record",gt));if(bt.mediaRecorder!==null&&(gt.log("this.mediaRecorder.state :"+bt.mediaRecorder.state),bt.mediaRecorder.state==="recording"||bt.mediaRecorder.state==="paused"))return gt.log("mediaRecorder is already ongoing, use stopRecordStream before trying another record"),void zt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is already ongoing, use stopRecordStream before trying another record",gt));if(gt.debug("checking MediaRecorderOptions mimeType support"),Mt!=null?(gt.debug("options is defined :",Mt),Mt.mimeType!==null&&Mt.mimeType!==void 0&&(gt.debug("contentType is defined :",Mt.mimeType),MediaRecorder.isTypeSupported(Mt.mimeType)&&(Bt=Mt.mimeType))):Mt={},Bt===null){var rn="video/webm;codecs=vp8,opus";MediaRecorder.isTypeSupported(rn)||(gt.debug(rn+" is not Supported"),rn="video/webm;codecs=vp9,opus",MediaRecorder.isTypeSupported(rn)||(gt.debug(rn+" is not Supported"),rn="video/webm",MediaRecorder.isTypeSupported(rn)||(gt.debug(rn+" is not Supported"),rn=""))),Mt.mimeType=rn}bt.mimeType=Mt.mimeType,gt.debug("Start record with MediaRecorderOptions :",Mt);try{bt.recordedBlobs=[],bt.mediaRecorder=new MediaRecorder(Ot,Mt)}catch(gn){return gt.error("Exception while creating MediaRecorder: "+gn+". mimeType: "+Mt.mimeType),void zt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"Exception while creating MediaRecorder: "+gn+". mimeType: "+Mt.mimeType,gt))}bt.mediaRecorder.onstart=function(gn){gt.log("onstart :"+gn),this.onerror=null,Wt()},bt.mediaRecorder.ondataavailable=function(gn){gn.data&&gn.data.size>0&&apiCC.recordMgr.recordedBlobs.push(gn.data)},bt.mediaRecorder.onerror=function(gn){gt.log("onerror :"+gn),zt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder error :"+gn,gt)),this.onerror=null},bt.mediaRecorder.start(10),gt.log("MediaRecorder started",bt.mediaRecorder)})},this.stop=function(){var Ot=this;return gt.info("stop"),new Promise(function(Mt,bt){return Ot.mediaRecorder.onstop=function(Wt){gt.log("mediaRecorder onstop :"+Wt),this.onstart=null,this.onstop=null,this.onerror=null,this.onpause=null,this.onresume=null,this.ondataavailable=null;var zt=new Blob(apiCC.recordMgr.recordedBlobs,{type:this.mimeType});Mt(zt)},MediaRecorder===void 0?(gt.debug("MediaRecorder is not supported on this browser, leaving recordStream process"),void bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"MediaRecorder is not supported on this browser, leaving recordStream process",gt))):Ot.mediaRecorder===null?(gt.log("mediaRecorder is not running, use startRecordStream before trying to stop"),void bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is not running, use startRecordStream before trying to stop",gt))):(gt.log("this.mediaRecorder.state :"+Ot.mediaRecorder.state),Ot.mediaRecorder.state==="inactive"?(gt.log("mediaRecorder is already inactive"),void bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is already inactive",gt))):void Ot.mediaRecorder.stop())})},this.pause=function(){var Ot=this;return gt.info("pause"),new Promise(function(Mt,bt){return Ot.mediaRecorder===null?(gt.log("mediaRecorder is not running, use startRecordStream before trying to pause"),void bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is not running, use startRecordStream before trying to pause",gt))):(gt.log("this.mediaRecorder.state :"+Ot.mediaRecorder.state),Ot.mediaRecorder.state==="paused"?(gt.log("mediaRecorder is already paused"),void bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is already paused",gt))):Ot.mediaRecorder.state==="inactive"?(gt.log("mediaRecorder is inactive"),void bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is inactive",gt))):(Ot.mediaRecorder.onerror=function(Wt){gt.log("onerror :"+Wt),bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder error :"+Wt,gt)),this.onerror=null},Ot.mediaRecorder.onpause=function(Wt){gt.log("onpause :"+Wt),this.onerror=null,Mt()},void Ot.mediaRecorder.pause()))})},this.resume=function(){var Ot=this;return gt.info("resume"),new Promise(function(Mt,bt){return Ot.mediaRecorder===null?(gt.log("mediaRecorder is not running, use startRecordStream before trying to resume"),void bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is not running, use startRecordStream before trying to resume",gt))):(gt.log("this.mediaRecorder.state :"+Ot.mediaRecorder.state),Ot.mediaRecorder.state==="recording"?(gt.log("mediaRecorder is already recording"),void bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is already recording",gt))):Ot.mediaRecorder.state==="inactive"?(gt.log("mediaRecorder is inactive"),void bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is inactive",gt))):(Ot.mediaRecorder.onerror=function(Wt){gt.log("onerror :"+Wt),bt(St.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder error :"+Wt,gt)),this.onerror=null},Ot.mediaRecorder.onresume=function(Wt){gt.log("onresume :"+Wt),this.onerror=null,Mt()},void Ot.mediaRecorder.resume()))})}},apiCC.audioProcessor=new mt,apiCC.pendingPromises=[],apiCC.pendingPromisesId=0,ot.$6!=="electron"?s(2746):It.debug("Electron detected, not loading onbeforeunload"),apiCC.addEventListener=function(Ot,Mt,bt){var Wt={},zt=null;["sessionReady","incomingCall","callEstablished","remoteHangup","userMediaSuccess","userMediaError","userMediaStop","error","receiveIMMessage","updatePresence","webRTCClientCreated","updateUserStatus","channelEvent","groupChatCreation","groupChatInvitation","groupChatMemberUpdate","addUserInGroupChatAnswer","receiveGroupChatMessage","userDataAnswer","fetchUserDataAnswer","receiveConversationList","receiveConversationHistory","receiveConversationDetailReport","receiveContactOccurrencesFromConversationList","receiveMCUSessionInvitation","MCUSessionCreation","MCUAvailableStream","MCUAvailableStreamUpdate","MCUAvailableReplay","MCURemoveStream","canPlayRemoteVideo","recordedFileAvailable","receiveData","roomCreation","roomJoined","roomInvitation","roomMemberUpdate","receiveRoomMessage","contactListInRoom","snapShotPhotoUploaded","stopRecord","callAttempt","joinMCUSessionAnswer","hangup","desktopCapture","remoteStreamAdded","localStreamRemoved","remoteStreamRemoved","switchStream","sendDataChannelOpen","sendDataChannelClose","sendDataChannelError","receiveDataChannelOpen","receiveDataChannelClose","receiveDataChannelError","connectedUsersListUpdate","onFileSended","onFileSending","onFileReceiving","onFileReceived","onFileProgress","onFilePending","recordedStreamsAvailable","closingWhiteBoard","webRTCPluginInstallation","onQosStatsUpdate","onQosChange","onQosAudioChange","onCallScoreUpdate","activeSpeaker","stopSpeaking","audioAmplitude","preCallTestStatus","onQosVideoChange","onCallStatsUpdate","cpuLimited","bandwidthLimited","MCURecordedStreamsAvailable","MCURecordingStarted","MCURecordingStopped","ICECandidateTypeUpdate","disconnectionWarning","MCUAvailableComposite","callRestarting","selectedICECandidate","MCUParticipantEjected","MCURoomModeChanged","MCUStreamingStarted","MCUStreamingStopped","mediaDeviceChanged","externalJsLoadingStatus","slowLink","localStreamUpdated","remoteStreamUpdated","simulcastFeedChanged","videoQualityChanged","bandwidthResourceManagement","backgroundSubstractionStopVisibilityChange","backgroundSubstractionStopComputeTime","AIESnapshot","AIELog","cloudEventOccurred"].indexOf(Ot)>-1?(Ot==="remoteHangup"&&It.warn("DEPRECATED : ApiRTC : remoteHangup event is now deprecated, please use hangup event instead"),It.log("Adding listener on type :"+Ot),typeof apiRTC_React<"u"?eventManager.addEventListener(Ot,Mt):document.addEventListener?document.addEventListener(Ot,Mt,!1):typeof $jqApz<"u"?(It.log("using $jqApz"),$jqApz(document).on(Ot,Mt)):typeof jQuery<"u"?(It.log("using jQuery"),jQuery(document).on(Ot,Mt)):It.warn("Custom Events not supported on this browser : addEventListener()"),Wt={type:Ot,listener:Mt,setBy:bt},zt=apiCC.myEventTable.push(Wt),It.trace("number of myEventTable:"+zt)):(At.createErrorEvent("ERROR: Trying to add a listener on an unknow event","UNKNOWN_EVENT_ON_ADDLISTENER"),It.log("ERROR: Trying to add a listener on an unknow event :"+Ot))},apiCC.removeEventListener=function(Ot,Mt){It.debug("Removing listener on type :"+Ot),document.removeEventListener?document.removeEventListener(Ot,Mt,!1):typeof jQuery<"u"?jQuery(document).off(Ot,Mt):It.log("Custom Events not supported on this browser")},apiCC.setSessionStorage=function(Ot,Mt,bt){It.debug("setSessionStorage"),bt=bt||36e5;var Wt=new Date,zt=new Date;zt.setTime(Wt.getTime()+bt);try{var Bt=JSON.stringify({value:Mt,expiresAt:zt});sessionStorage.setItem(Ot,Bt)}catch{It.error("Sotheming went wrong during json strigify to set session storage values")}},apiCC.isWebRTCCompliant=function(){It.debug("isWebRTCCompliant");var Ot=!1,Mt=!1;return["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(bt){Ot||bt in window&&(Ot=!0)}),Ot===!1?(It.debug("isWebRTCCompliant::isWebRTCSupported false"),!1):(["getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia"].forEach(function(bt){Mt||bt in navigator&&(Mt=!0)}),Mt===!1?(It.debug("isWebRTCCompliant::isWebRTCGUMSupported false or you are connected with HTTP"),!1):ot.Xh==="MIUI Browser"?(It.debug("isWebRTCCompliant::MIUI Browser detected false"),!1):ot.Xh==="UCBrowser"?(It.debug("isWebRTCCompliant::UCBrowser detected false"),!1):ot.Xh==="QQ"||ot.Xh==="QQBrowser"||ot.Xh==="QQBrowserLite"?(It.debug("isWebRTCCompliant::QQ or QQBrowser or QQBrowserLite detected false"),!1):ot.Xh==="Baidu"||ot.Xh==="baidu"?(It.debug("isWebRTCCompliant::Baidu or baidu detected false"),!1):(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&this.webRTCPluginActivated!==!0?(It.debug("isWebRTCCompliant FALSE : IE or Safari"),!1):(It.debug("isWebRTCCompliant:: WebRTC is supported"),!0))},apiCC.isQoSStatCompliant=function(){var Ot=!1;return["chrome","firefox"].indexOf(apiCC.browserDetails.type)<0?(It.debug("QoS Statistics is only supported on Chrome and Firefox"),Ot):Ot=!0},apiCC.isScreenSharingCompliant=function(){var Ot=!1;return typeof apiRTC_React<"u"?Ot=!0:(ot.Xh==="IE"||ot.BF==="Android"||apiRTC.osName==="iOS"&&typeof cordova<"u"||(ot.Xh==="Chrome"||ot.Xh==="Firefox"&&ot.PR>=52||navigator.getDisplayMedia||navigator.mediaDevices.getDisplayMedia?Ot=!0:It.debug("ScreenSharing is not supported")),Ot)},apiCC.getMediaDevices=function(){return It.debug("getMediaDevices"),new Promise(function(Ot,Mt){if(typeof apiRTC_React<"u")It.log("enumerateDevices() is supported - React Native"),mediaDevices.enumerateDevices().then(function(bt){It.log("enumerateDevices(), sources :",bt),apiCC.mediaDeviceMgr.mediaSourceInfos=bt,Ot(bt)}).catch(function(bt){It.log("enumerateDevices(), error :",bt),Mt(bt)});else if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)It.log("enumerateDevices() is supported."),navigator.mediaDevices.enumerateDevices().then(function(bt){It.log("enumerateDevices(), sources :",bt),apiCC.mediaDeviceMgr.mediaSourceInfos=bt,Ot(bt)}).catch(function(bt){It.log("enumerateDevices(), error :",bt),Mt(bt)});else if(It.log("enumerateDevices() not supported."),typeof MediaStreamTrack>"u")It.warn("This browser does not support MediaStreamTrack"),Mt(new Error("getMediaDevices() - MediaStreamTrack undefined"));else try{MediaStreamTrack.getSources(Ot)}catch(bt){It.debug("catch MediaStreamTrack.getSources :"+bt),Mt(new Error("getMediaDevices() - Error on MediaStreamTrack.getSources :"+bt))}})},apiCC.getMediaDevicesWithCB=function(Ot){if(It.debug("getMediaDevicesWithCB"),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)It.log("enumerateDevices() is supported."),navigator.mediaDevices.enumerateDevices().then(Ot).catch(function(Mt){It.log("navigator.mediaDevices.enumerateDevices error: ",Mt),Mt=null});else if(It.log("enumerateDevices() not supported."),typeof MediaStreamTrack>"u")Ot(null),It.warn("This browser does not support MediaStreamTrack");else try{MediaStreamTrack.getSources(Ot)}catch(Mt){It.debug("catch MediaStreamTrack.getSources :"+Mt),Ot(null)}},apiCC.getUserMedia=function(Ot){return It.info("getUserMedia"),It.debug("with constraints :",Ot),new Promise(function(Mt,bt){navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0?(It.debug("webRTC getUserMedia with promises"),navigator.mediaDevices.getUserMedia(Ot).then(Mt).catch(bt)):typeof apiRTC_React<"u"?(It.debug("webRTC getUserMedia with promises on React Native"),mediaDevices.getUserMedia(Ot).then(Mt).catch(bt)):(It.debug("webRTC getUserMedia without promises"),apiCC.myWebRTC_Adapter.getUserMedia(Ot,Mt,bt))})},apiCC.getUserMediaWithCB=function(Ot,Mt,bt){It.info("getUserMediaWithCB"),It.debug("with constraints :"+JSON.stringify(Ot)),navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0?(It.log("getUserMedia with promises"),navigator.mediaDevices.getUserMedia(Ot).then(Mt).catch(bt)):(It.log("getUserMedia without promises"),apiCC.myWebRTC_Adapter.getUserMedia(Ot,Mt,bt))},apiCC.userMediaStreamTable=[],apiCC.getUserMediaStreamIds=function(){for(var Ot=[],Mt=apiCC.userMediaStreamTable.length;--Mt>=0;)Ot.push(apiCC.userMediaStreamTable[Mt].userMediaStreamId);return Ot},apiCC.getUserMediaStream=function(Ot,Mt){var bt=null,Wt=apiCC.userMediaStreamTable.length;if(Ot==null){if(Mt&&typeof Mt.accept=="function"){for(;--Wt>=0;)if(Mt.accept(apiCC.userMediaStreamTable[Wt])===!0){bt=apiCC.userMediaStreamTable[Wt];break}}}else for(;--Wt>=0;)if(apiCC.userMediaStreamTable[Wt].userMediaStreamId===Ot){bt=apiCC.userMediaStreamTable[Wt];break}return bt},apiCC.getFirstUserMediaStream=function(){return apiCC.userMediaStreamTable.length>0?apiCC.userMediaStreamTable[0]:null},apiCC.createUserMediaStream=function(Ot){var Mt=function(zt){for(var Bt=apiCC.userMediaStreamTable.length;--Bt>=0;)if(apiCC.userMediaStreamTable[Bt].userMediaStreamId===zt){apiCC.userMediaStreamTable.splice(Bt,1);break}},bt=new apiCC.ApiCCUserMediaStream,Wt="call";return It.debug("[createUserMediaStream] userMediaStreamId: "+bt.userMediaStreamId),Ot==null&&(Ot={}),Ot.type&&(bt.callType=Ot.type),Ot.stream?(bt.stream=Ot.stream,bt.streamStolen=!0,bt.notifyUserMediaStop=!1,bt.listenForMuteEvents()):Ot.gum_config&&(bt.gum_config=(0,ct.S6)(Ot.gum_config)),Ot.audioSourceId&&(bt.inputs.audioSourceId=Ot.audioSourceId),Ot.videoSourceId&&(bt.inputs.videoSourceId=Ot.videoSourceId),Ot.facingMode&&(bt.inputs.facingMode=Ot.facingMode),Ot.captureSourceType&&(bt.captureSourceType=Ot.captureSourceType),Ot.notifyUserMediaSuccess&&(bt.notifyUserMediaSuccess=Ot.notifyUserMediaSuccess),Ot.notifyUserMediaError&&(bt.notifyUserMediaError=Ot.notifyUserMediaError),Ot.tryAudioCallAfterUserMediaError&&(bt.tryAudioCallAfterUserMediaError=Ot.tryAudioCallAfterUserMediaError),Ot.displayMediaStreamConstraints&&(bt.displayMediaStreamConstraints=Ot.displayMediaStreamConstraints),Ot.forceExtensionOnChrome&&(bt.forceExtensionOnChrome=Ot.forceExtensionOnChrome),Ot.filters&&(bt.filters=Ot.filters),Ot.callId&&(Ot.callFlavor!=="call"&&Ot.callFlavor!=="userMedia"||(Wt=Ot.callFlavor),bt.stream===null?bt.addCallInfo(Ot.callId,Wt,!0):bt.addCallInfo(Ot.callId,Wt,!1)),Ot.childStreamType&&(bt.childStreamType=Ot.childStreamType),bt.callbacks.release=typeof Ot.release=="function"?Ot.release:function(){},bt.callbacks.success=typeof Ot.success=="function"?Ot.success:function(){},bt.callbacks.failure=typeof Ot.failure=="function"?Ot.failure:function(){},apiCC.userMediaStreamTable.push(bt),bt.stream===null?bt.callType==="screenSharing"||bt.callType==="screenSharingWithAudio"?bt.getScreenMedia():bt.callType!=="data"?bt.getUserMedia():Ot.sync===!0?(Mt(bt.userMediaStreamId),bt.callbacks.failure(bt,"wrong type")):setTimeout(function(){Mt(bt.userMediaStreamId),bt.callbacks.failure(bt,"wrong type")},0):(bt.updateMediaProperties(bt.stream),Ot.sync===!0?bt.callbacks.success(bt):setTimeout(function(){bt.callbacks.success(bt)},0)),bt},apiCC.releaseUserMediaStream=function(Ot,Mt,bt){var Wt=!1,zt=apiCC.userMediaStreamTable.length,Bt=null;if(Mt!==null&&typeof Mt!="string"&&(Mt=null),Ot==null){if(bt&&typeof bt.accept=="function"){for(;--zt>=0;)if(bt.accept(apiCC.userMediaStreamTable[zt])===!0){if(Mt){if((Bt=apiCC.userMediaStreamTable[zt].getOwnerCallInfo())===null||Bt.callId!==Mt){apiCC.userMediaStreamTable[zt].removeCallInfo(Mt);break}}else if((Bt=apiCC.userMediaStreamTable[zt].getOwnerCallInfo())!==null)break;It.debug("[releaseUserMediaStream] match; userMediaStreamId: "+apiCC.userMediaStreamTable[zt].userMediaStreamId),apiCC.userMediaStreamTable[zt].release(),Mt&&apiCC.userMediaStreamTable[zt].removeCallInfo(Mt),apiCC.userMediaStreamTable.splice(zt,1),Wt=!0;break}}}else for(;--zt>=0;)if(apiCC.userMediaStreamTable[zt].userMediaStreamId===Ot){if(Mt){if((Bt=apiCC.userMediaStreamTable[zt].getOwnerCallInfo())===null||Bt.callId!==Mt){apiCC.userMediaStreamTable[zt].removeCallInfo(Mt);break}}else if((Bt=apiCC.userMediaStreamTable[zt].getOwnerCallInfo())!==null)break;It.debug("[releaseUserMediaStream] id; userMediaStreamId: "+apiCC.userMediaStreamTable[zt].userMediaStreamId),apiCC.userMediaStreamTable[zt].release(),Mt&&apiCC.userMediaStreamTable[zt].removeCallInfo(Mt),apiCC.userMediaStreamTable.splice(zt,1),Wt=!0;break}return Wt},apiCC.activeSpeakerDetect=!1,apiCC.activeSpeakerThreshold=.4,apiCC.enableActiveSpeakerDetecting=function(Ot,Mt){apiCC.activeSpeakerDetect=Ot,Mt&&(apiCC.activeSpeakerThreshold=Mt)},apiCC.apiRTCExtensionInstalled=!1,apiCC.extensionInstallationSuccessCallback=function(){It.debug("extensionInstallationSuccessCallback"),apiCC.apiRTCExtensionInstalled=!0},apiCC.extensionInstallationFailureCallback=function(Ot,Mt){It.debug("extensionInstallationFailureCallback : Error :"+Ot+", "+Mt),Ot=null,Mt=null,At.createDesktopCaptureEvent("Extension_installation_Error",apiRTC.waitingShareScreenCallId,apiRTC.waitingShareScreenDestNumber,apiRTC.waitingCaptureSourceType)},apiCC.manageNotInstalledExtension=function(Ot,Mt,bt){It.debug("manageNotInstalledExtension"),It.warn("apiRTC extension not installed"),At.createDesktopCaptureEvent("Extension_not_installed",Ot,Mt),It.warn("Starting apiRTC extension installation"),apiRTC.waitingShareScreenDestNumber=Mt,apiRTC.waitingShareScreenCallId=Ot,apiRTC.waitingCaptureSourceType=bt,ot.PR>=71?(It.debug("Chrome >= 71, opening Chrome web Store"),apiRTC.extensionInstallationFailureCallback("Chrome71 : chrome.webstore.install() no more supported","Chrome71-screenShare"),window.open("https://chrome.google.com/webstore/detail/apizee-desktop-capture/mjjnofoemoepfididplbfimokpnpcoeg")):chrome.webstore.install("https://chrome.google.com/webstore/detail/mjjnofoemoepfididplbfimokpnpcoeg",apiRTC.extensionInstallationSuccessCallback,apiRTC.extensionInstallationFailureCallback)},apiCC.activateScreenSharing=function(Ot){It.debug("activateScreenSharing");var Mt=null;Ot!==void 0?It.log("extensionId is defined :"+Ot):(It.log("using apirtc extension's Id"),Ot="mjjnofoemoepfididplbfimokpnpcoeg"),ot.Xh==="Chrome"?document.getElementById(Ot)!==null?(It.log("extensionLink is present, screenSharing is already activated"),window.postMessage("apiRTC-extension","*")):(It.log("screenSharing is not yet activated"),(Mt=document.createElement("link")).href="https://chrome.google.com/webstore/detail/"+Ot,Mt.rel="chrome-webstore-item",Mt.id=Ot,document.getElementsByTagName("head")[0].appendChild(Mt),window.addEventListener("message",function(bt){var Wt=null;if(It.log("message: event: "+JSON.stringify(bt.data)),bt.origin==window.location.origin){if(bt.data!=="apiRTC-DeskstopCapture-loaded")return bt.data==="extensionInstalledAndLoaded"?(apiCC.apiRTCExtensionInstalled=!0,apiCC.waitingShareScreenUserMediaStream!==null&&apiCC.waitingShareScreenUserMediaStream!==void 0&&(apiCC.userMediaStreamTable.push(apiCC.waitingShareScreenUserMediaStream[0]),delete apiCC.waitingShareScreenUserMediaStream),void(apiCC.waitingShareScreenUserMediaStreamId&&(Wt=apiCC.getUserMediaStream(apiCC.waitingShareScreenUserMediaStreamId),delete apiCC.waitingShareScreenUserMediaStreamId,Wt&&Wt.getScreenMedia()))):void(Tt(bt.data)==="object"&&bt.data.desktopId!==void 0&&(bt.data.remoteId!=="getScreenMedia"||(Wt=apiCC.getUserMediaStream(bt.data.callNumber))===null||Wt.registerScreenMedia(bt.data.captureSourceType,bt.data.desktopId)));apiCC.apiRTCExtensionInstalled=!0}}),window.postMessage("apiRTC-extension","*")):(It.log("activateScreenSharing is only available for chrome Browser"),At.createDesktopCaptureEvent("Browser_Not_Compatible",null,null))},apiCC.checkIfAudioSourceIdExistOnDevice=function(Ot){It.log("checkIfAudioSourceIdExistOnDevice :",Ot);var Mt,bt=!1,Wt=null;if(apiCC.mediaDeviceMgr.mediaSourceInfos!==null)for(Mt=0;Mt<apiCC.mediaDeviceMgr.mediaSourceInfos.length;++Mt)(Wt=apiCC.mediaDeviceMgr.mediaSourceInfos[Mt]).kind!=="audio"&&Wt.kind!=="audioinput"||(Wt.deviceId===Ot?(It.log("Audio device present :",Ot),bt=!0):It.log("not this deviceId"));return bt},apiCC.setAudioSourceIdInConstraint=function(Ot,Mt){return It.log("setAudioSourceIdInConstraint:",Mt),Ot==null?It.log("audioSourceId not defined"):Mt.audio===!1?It.log("constraints.audio === false, no audio device present"):apiCC.checkIfAudioSourceIdExistOnDevice(Ot)===!1?(It.log("audioSourceId not found on device"),Mt.audio={}):(Mt.audio!==!0&&Mt.audio!==void 0||(Mt.audio={}),It.log("audioSourceId is defined :",Ot),ot.ag.name==="iOS"?ot.Xh==="Mobile Safari"||(Mt.audio.deviceId=Ot):ot.Xh==="Firefox"&&ot.PR>=50?Mt.audio.deviceId=Ot:ot.Xh==="Chrome"&&ot.PR<48||ot.Xh==="Safari"&&ot.PR<11?Mt.audio.optional=[{sourceId:Ot}]:Mt.audio.deviceId=Ot?{ideal:Ot}:void 0),It.debug("constraints =",Mt),Mt},apiCC.checkIfVideoSourceIdExistOnDevice=function(Ot){It.log("checkIfVideoSourceIdExistOnDevice :",Ot);var Mt,bt=!1,Wt=null;if(It.debug("apiCC.mediaDeviceMgr.mediaSourceInfos :",apiCC.mediaDeviceMgr.mediaSourceInfos),apiCC.mediaDeviceMgr.mediaSourceInfos!==null)for(Mt=0;Mt<apiCC.mediaDeviceMgr.mediaSourceInfos.length;++Mt)(Wt=apiCC.mediaDeviceMgr.mediaSourceInfos[Mt]).kind!=="video"&&Wt.kind!=="videoinput"||(Wt.deviceId===Ot?(It.log("Video device present :",Ot),bt=!0):It.log("not this deviceId"));return bt},apiCC.getMediaDeviceLabelFromDeviceid=function(Ot){It.log("getMediaDeviceLabelFromDeviceid :",Ot);var Mt,bt="Not_Found",Wt=null;if(It.debug("apiCC.mediaDeviceMgr.mediaSourceInfos :",apiCC.mediaDeviceMgr.mediaSourceInfos),apiCC.mediaDeviceMgr.mediaSourceInfos!==null)for(Mt=0;Mt<apiCC.mediaDeviceMgr.mediaSourceInfos.length;++Mt)(Wt=apiCC.mediaDeviceMgr.mediaSourceInfos[Mt]).deviceId===Ot?(It.log("Video device present :",Ot),bt=Wt.label):It.log("not this deviceId");return bt},apiCC.setVideoSourceIdInConstraint=function(Ot,Mt){if(It.log("setVideoSourceIdInConstraint : ",Mt),Ot==null)It.log("videoSourceId not defined");else if(Mt.video===!1)It.log("constraints.video === false, no video device present");else if(apiCC.checkIfVideoSourceIdExistOnDevice(Ot)===!1)It.log("videoSourceId not found on device"),Mt.video={};else if(It.log("videoSourceId is defined :",Ot),Mt.video!==!0&&Mt.video!==void 0||(Mt.video={}),ot.ag.name==="iOS")if(ot.Xh==="Mobile Safari"){if(Ot){var bt=!1,Wt=ot.ag.version.split(".");Wt.length>0&&parseInt(Wt[0])<13&&(bt=!0),Mt.video.deviceId=bt?{exact:Ot}:{ideal:Ot}}}else Mt.video.deviceId=Ot;else ot.Xh==="Firefox"&&ot.PR>=50?ot.Xh==="Firefox"&&ot.PR>=77?(It.debug("FX > 77 using exact to set deviceId"),Mt.video.deviceId={exact:Ot}):Mt.video.deviceId=Ot:ot.Xh==="Chrome"&&ot.PR<48||ot.Xh==="Safari"&&ot.PR<11?Mt.video.optional=[{sourceId:Ot}]:Mt.video.deviceId=Ot?{ideal:Ot}:void 0;return It.log("constraints =",Mt),Mt},apiCC.setVideoFacingModeInConstraint=function(Ot,Mt){It.log("setVideoFacingModeInConstraint");var bt={};return Mt.video===!1?(It.log("facingMode value is not setted, constraints.video is false"),Mt):Ot==null?(It.log("facingMode value is not setted"),Mt):Ot!=="user"&&Ot!=="environment"&&Ot!=="left"&&Ot!=="right"?(It.log("facingMode value is not correct"),Mt):(navigator.mediaDevices!==null&&navigator.mediaDevices!==void 0&&navigator.mediaDevices.getSupportedConstraints!==null&&navigator.mediaDevices.getSupportedConstraints!==void 0&&(bt=navigator.mediaDevices.getSupportedConstraints()),bt.hasOwnProperty("facingMode")?(It.log("Setting FacingMode in constraint"),Mt.video===!0&&(Mt.video={}),Mt.video.facingMode={ideal:Ot}):It.log("FacingMode not supported by device"),It.debug("constraints =",Mt),Mt)},apiCC.setResolutionInConstraint=function(Ot,Mt,bt){return It.log("setResolutionInConstraint"),Ot<=0||Mt<=0?(It.log("Resolution value must be positif non null"),bt):(bt.video===!0||bt.video!==void 0?ot.ag.name==="iOS"?ot.Xh==="Mobile Safari"?(bt.video.width=Ot?{exact:Ot}:void 0,bt.video.height=Mt?{exact:Mt}:void 0):(bt.video.width=Ot,bt.video.height=Mt):ot.Xh==="Firefox"&&ot.PR>=50?(bt.video.width=Ot,bt.video.height=Mt):ot.Xh==="Safari"&&ot.PR>=11||ot.Xh==="Mobile Safari"||ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"||ot.Xh==="Chrome"&&ot.PR>=49||ot.Xh==="Firefox"&&ot.PR>=50?(bt.video.width=Ot?{exact:Ot}:void 0,bt.video.height=Mt?{exact:Mt}:void 0):bt.video.mandatory=[{width:Ot,height:Mt}]:It.error("setResolutionInConstraint : contraint.video must be true or defined"),It.debug("constraints =",bt),bt)},apiCC.checkConstraintDependingOnDevice=function(Ot){It.debug("checkConstraintDependingOnDevice :",Ot),ot.Xh==="Mobile Safari"&&ot.PR>=13&&Ot.video!==void 0&&Ot.video.height!==void 0&&Ot.video.width!==void 0&&Ot.video.height.ideal===1080&&Ot.video.width.ideal===1920&&(It.debug("Downgrading selected height and width resolution on iOS, to avoid stream issue"),Ot.video.height.ideal=720,Ot.video.width.ideal=1280)},apiCC.attachMediaStream=function(Ot,Mt){It.debug("attachMediaStream"),Ot!==null?(Ot.srcObject!==void 0?Ot.srcObject=Mt:Ot.mozSrcObject!==void 0?Ot.mozSrcObject=Mt:Ot.src!==void 0?ot.Xh==="Chrome"&&ot.PR<46?(It.log("Attaching media stream for Chrome < 46"),Ot.src=webkitURL.createObjectURL(Mt)):Ot.src=URL.createObjectURL(Mt):It.error("Error attaching stream to element."),ot.ag.name==="iOS"&&(It.log("iOS detected"),Ot.setAttribute("playsinline",!0))):It.log("videoElt is null")},apiCC.addStreamInDiv=function(Ot,Mt,bt,Wt,zt,Bt,rn){It.debug("addStreamInDiv");var gn,tn=null,Ht=null,fn=!1,bn=null;(0,ct.Ym)(rn,"object")&&rn.type!=null&&(Mt=rn.type),(0,ct.Ym)(rn,"object")&&rn.forceAudioAndVideoMediaElementSeparation!==void 0&&(It.debug("forceAudioAndVideoMediaElementSeparation is set"),fn=!0),Mt==="audio"?tn=document.createElement("audio"):(ot.BF==="iOS"&&ot.Xh==="Mobile Safari"&&(It.debug("iOS && Mobile Safari"),fn=!0),tn=document.createElement("video")),tn.id=Wt,tn.autoplay=!0,fn===!0&&Bt===!1?(It.debug("before adding separated MediaEltAudio"),(bn=document.createElement("audio")).id=Wt+"_sepAudio",bn.muted=Bt,bn.autoplay=!0,tn.muted=!0):tn.muted=Bt,tn.style.width=zt.width,tn.style.height=zt.height,zt.controls===!0&&(tn.controls=!0),gn=function(In){var un=null,mn=In.play();un=function(){var yn=In.play();It.log("funcFixIoS"),yn!==void 0&&yn.then(function(){It.log("Autoplay started"),document.removeEventListener("touchstart",un)}).catch(function(pn){It.error("Autoplay was prevented")})},mn!==void 0&&mn.then(function(){It.log("Autoplay started")}).catch(function(yn){ot.ag.name==="iOS"?(It.warn("iOS : Autoplay was prevented, activating touch event to start media play"),apiCC.myWebRTC_Event.createErrorEvent("ERROR: iOS : Autoplay was prevented","IOS_AUTOPLAY_PREVENTED"),document.addEventListener("touchstart",un)):It.warn("Autoplay was prevented")})},ot.Xh==="Chrome"&&ot.PR==="61"&&ot.BF==="Android"&&(tn.style.borderRadius="1px",It.log("Patch for video display on Chrome 61 Android")),apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId!==void 0&&apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId!==null?(It.log("audioOutputId set to: "+apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId),tn.setSinkId(apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId).then(function(){It.log("Success, audio output device attached")})):It.log("No audioOutputId set"),ot.BF!=="iOS"&&(Ht=document.getElementById(bt)).appendChild(tn),Ot!==void 0&&(apiCC.attachMediaStream(tn,Ot),fn===!0&&Bt===!1&&apiCC.attachMediaStream(bn,Ot)),ot.BF==="iOS"&&(Ht=document.getElementById(bt)).appendChild(tn),fn===!0&&Bt===!1&&Ht!==null&&Ht.appendChild(bn),gn(tn),fn===!0&&Bt===!1&&gn(bn)},apiCC.removeElementFromDiv=function(Ot,Mt){It.debug("removeElementFromDiv");var bt,Wt,zt=null;bt=document.getElementById(Mt),zt=document.getElementById(Ot),bt!==null&&(It.log("Removing video element with Id : "+Mt),zt!==null&&zt.removeChild(bt)),(Wt=document.getElementById(Mt+"_sepAudio"))!==null&&(It.log("iOS : Removing audio element with Id : "+Mt+"_sepAudio"),zt!==null&&zt.removeChild(Wt))},apiCC.randomString=function(Ot,Mt){for(var bt=typeof Mt=="string"&&Mt.length>0?Mt:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Wt="";--Ot>=0;)Wt+=bt.charAt(Math.floor(Math.random()*bt.length));return Wt},apiCC.generateCallId=function(){var Ot;return Ot=Number.MAX_SAFE_INTEGER!==void 0?Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():Math.floor(1000001*Math.random()).toString(),It.debug("new callId :"+Ot),Ot},apiCC.generateInstanceId=function(){var Ot;return Ot=Number.MAX_SAFE_INTEGER!==void 0?Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():Math.floor(1000001*Math.random()).toString(),It.debug("new instanceId :"+Ot),Ot},apiCC.myApiCCWhiteBoardClient=null,apiCC.createWhiteBoard=function(Ot,Mt,bt,Wt){return It.debug("createWhiteBoard"),apiCC.myApiCCWhiteBoardClient=new apiCC.ApiCCWhiteBoardClient(apiCC.session,Ot,Mt,bt,Wt),apiCC.myApiCCWhiteBoardClient},apiCC.closeWhiteBoardClient=function(Ot){It.info("closeWhiteBoardClient"),At.createClosingWhiteBoardEvent(apiCC.myApiCCWhiteBoardClient.roomId,Ot),apiCC.myApiCCWhiteBoardClient.isInRoom()&&apiCC.myApiCCWhiteBoardClient.leaveRoom(),apiCC.myApiCCWhiteBoardClient.stop()},apiCC.registerIOsDevice=function(Ot){It.debug("call registerIOsDevice 1");var Mt={type:"registerIOsDevice",senderId:apiCC.session.apiCCId,token:Ot},bt=JSON.stringify(Mt);It.debug("call registerIOsDevice "+bt),apiCC.session.channel.socket.emit("registerIOsDevice",bt),It.debug("call registerIOsDevice  done")},apiCC.registerAndroidDevice=function(Ot){It.debug("registerAndroidDevice");var Mt={type:"registerAndroidDevice",senderId:apiCC.session.apiCCId,token:Ot},bt=JSON.stringify(Mt);apiCC.session.channel.socket.emit("registerAndroidDevice",bt)},apiCC.unRegisterIOsDevice=function(Ot){It.debug("unRegisterIOsDevice");var Mt={type:"unRegisterIOsDevice",senderId:apiCC.session.apiCCId,token:Ot},bt=JSON.stringify(Mt);apiCC.session.channel.socket.emit("unRegisterIOsDevice",bt)},apiCC.unRegisterAndroidDevice=function(Ot){It.debug("unRegisterAndroidDevice");var Mt={type:"unRegisterAndroidDevice",senderId:apiCC.session.apiCCId,token:Ot},bt=JSON.stringify(Mt);apiCC.session.channel.socket.emit("unRegisterAndroidDevice",bt)},apiCC.storeSessionInfoInSessionStorage=function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(It.info("storeSessionInfoInSessionStorage",Ot),apiCC.session){var Mt=5e3;(0,ct.ki)(apiCC.session,"apiCCIdPersistenceTimeout","number")&&apiCC.session.apiCCIdPersistenceTimeout>=0&&(Mt=apiCC.session.apiCCIdPersistenceTimeout),(0,ct.Ym)(Ot.apiCCIdPersistenceTimeout,"number")&&Ot.apiCCIdPersistenceTimeout>=0&&(Mt=Ot.apiCCIdPersistenceTimeout),apiCC.setSessionStorage("apiCCId",apiCC.session.apiCCId,Mt),apiCC.setSessionStorage("apiKey",apiCC.session.apiKey,Mt),apiCC.session.sessionId!==null&&apiCC.setSessionStorage("sessionId",apiCC.session.sessionId,Mt)}},apiCC.disconnect=function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};It.info("disconnect",Ot),apiCC!==null&&apiCC.cleanAllEventListener(Ot),apiCC.session!==null&&apiCC.session!==void 0&&(typeof apiRTC_React>"u"&&Ot.invalidateApiCCId!==!0&&apiCC.storeSessionInfoInSessionStorage(Ot),apiCC.myApiCCWhiteBoardClient!==null&&(It.log("apiCC.myApiCCWhiteBoardClient.roomId :"+apiCC.myApiCCWhiteBoardClient.roomId),apiCC.myApiCCWhiteBoardClient.roomId!==null&&apiCC.closeWhiteBoardClient("USER_DISCONNECTION")),It.log("Disconnecting from Server"),apiCC.session.channel.socket!==void 0&&apiCC.session.channel.socket!==null&&apiCC.session.channel.socket.disconnect(),apiCC.session.channel.channelHasBeenDisconnected=!1,apiCC.session.connectedUsersList.splice(0,apiCC.session.connectedUsersList.length)),apiCC&&(apiCC.session=null,apiCC.jsLoaded=!1)},apiCC.reconnect=function(){It.log("Reconnect"),It.log("apiCC.session.channel.socket:",apiCC.session.channel.socket),apiCC.session.channel.socket.socket.connect()},apiCC.cleanApiRTCContext=function(){apiCC.session!==null&&apiCC.session!==void 0&&(apiCC.session.apiCCWebRTCClient!==null&&apiCC.session.apiCCWebRTCClient!==void 0&&(apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length!==0&&It.warn("Call is still established and will be disconnected"),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs.length>0&&It.log("MCU session is still established and will be disconnected"),apiCC.session.apiCCWebRTCClient.hangUp(),apiCC.session.apiCCWebRTCClient.webRTCClient.localStream!==null&&(apiCC.session.apiCCWebRTCClient.webRTCClient.stopStream(apiCC.session.apiCCWebRTCClient.webRTCClient.localStream),At.createUserMediaStopEvent(null,"media")),apiCC.session.apiCCWebRTCClient=null),apiCC.session.apiCCIMClient!==null&&apiCC.session.apiCCIMClient!==void 0&&(apiCC.session.apiCCIMClient=null),apiCC.session.apiCCDataClient!==null&&apiCC.session.apiCCDataClient!==void 0&&(apiCC.session.apiCCDataClient=null),apiCC.myApiCCWhiteBoardClient!==null&&apiCC.myApiCCWhiteBoardClient!==void 0&&(apiCC.myApiCCWhiteBoardClient=null))},apiCC.cleanAllEventListener=function(){var Ot,Mt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},bt=0;if(apiCC!==null&&apiCC.myEventTable!==null&&(bt=apiCC.myEventTable.length),bt!==0){for(It.trace("number of myEventTable:"+bt),Ot=0;Ot<bt;Ot+=1)Mt.unregister===!0&&apiCC.myEventTable[Ot].setBy==="UserAgent"?It.debug("Keeping event for UserAgent process"):apiCC.removeEventListener(apiCC.myEventTable[Ot].type,apiCC.myEventTable[Ot].listener);apiCC.myEventTable.splice(0,bt),bt=apiCC.myEventTable.length,It.trace("number of myEventTable after splice:"+bt)}},apiCC.testUserPing=function(Ot){It.debug("testUserPing()");var Mt,bt,Wt,zt,Bt=apiCC.bandwidthTestServer+"/upload-test",rn=new XMLHttpRequest,gn=new FormData,tn=Math.round(5*Math.random()),Ht=!1;"withCredentials"in rn?rn.open("POST",Bt,!0):typeof XDomainRequest<"u"?(rn=new XDomainRequest).open("POST",Bt):rn=null,Mt=new Blob([tn],{type:"text/xml"}),gn.append("file",Mt),rn?(rn.onload=function(){rn.status===200&&(zt=Date.now()-bt,Ht||(clearTimeout(Wt),Ot(null,zt)))},rn.onerror=function(fn){It.log("testUserUpload onerror status :",fn.target.status),Ot({err:"An error occured during XMLHttpRequest",msg:fn.target.status},null)},Wt=setTimeout(function(){Ht=!0,Ot("Ping timeout",-1)},5e3),rn.send(gn),bt=Date.now()):Ot({err:"XMLHttpRequest is not defined",msg:"XMLHttpRequest is not defined"},null)},apiCC.testUserDownload=function(Ot,Mt){It.debug("testUserDownload()");var bt,Wt,zt,Bt,rn,gn,tn=apiCC.bandwidthTestServer+"/files/noise_"+Ot+"ko.jpg",Ht=0,fn=new Image,bn=0;tn+="?nnn="+Date.now();var In=[[256,257529],[500,525944],[768,787234],[1e3,1055741],[1500,1541044],[2e3,1992034],[2500,2596028],[3e3,2904977],[3500,3648299],[4e3,4151187],[4500,4741712],[5e3,5264577],[5500,5776081],[6e3,6318553],[6500,6779868],[7e3,7334256],[7500,7874040],[8e3,8081460],[8500,8651795],[9e3,9081899],[9500,9503574],[1e4,10082008],[10500,10543425],[11e3,11200424],[11500,11200424],[12e3,12110671],[12500,12715962],[13e3,13222120],[13500,13605073],[14e3,13954769],[14500,14777594],[15e3,15178928],[15500,15602106],[16e3,16054618],[16500,16578623],[17e3,17048069],[17500,17456403],[18e3,17910332],[18500,18725846],[19e3,19284746],[19500,19771902],[2e4,20121527],[21e3,20975042],[22e3,22189200],[23e3,23027928],[24e3,24027870],[25e3,24878845],[26e3,26237503],[27e3,27112004],[28e3,27953446],[29e3,29313013],[3e4,30474095]];for(rn=0;rn<In.length;rn++)Ot===In[rn][0]&&(Ht=In[rn][1]);apiCC.testUserPing(function(un,mn){fn.onload=function(){for((Wt=Date.now()-bt)-mn>10&&(Wt-=mn),zt=Ht/(Wt/1e3),Bt=Math.round(zt/1e3),gn={type:"download",kBPerSec:Bt},rn=0;rn<apiCC.bandwidthRatingThresholds.length;rn++)8*gn.kBPerSec>=apiCC.bandwidthRatingThresholds[rn]&&bn++;gn.rating=bn+"/"+apiCC.bandwidthRatingThresholds.length,Mt(null,gn)},fn.onerror=function(yn,pn){Mt({label:"Error when downloading",err:yn,msg:pn},null)},bt=new Date().getTime(),fn.src=tn})},apiCC.testUserUpload=function(Ot,Mt){It.debug("testUserUpload()");var bt,Wt,zt,Bt,rn,gn,tn,Ht=apiCC.bandwidthTestServer+"/upload-test",fn=new XMLHttpRequest,bn=new FormData,In="",un=0;for(("withCredentials"in fn)?fn.open("POST",Ht,!0):typeof XDomainRequest<"u"?(fn=new XDomainRequest).open("POST",Ht):fn=null,Wt=0;Wt<Ot;Wt++)In+=Math.round(5*Math.random());bt=new Blob([In],{type:"text/xml"}),bn.append("file",bt),fn?(fn.onload=function(){if(fn.status===200){for(rn=Date.now()-Bt,gn=Ot/(rn/1e3),tn=Math.round(gn/1e3),zt={type:"upload",kBPerSec:tn},Wt=0;Wt<apiCC.bandwidthRatingThresholds.length;Wt++)8*zt.kBPerSec>=apiCC.bandwidthRatingThresholds[Wt]&&un++;zt.rating=un+"/"+apiCC.bandwidthRatingThresholds.length,Mt(null,zt)}else Mt({err:"An error occured during XMLHttpRequest",msg:fn.status},null)},fn.onerror=function(mn){It.log("testUserUpload onerror status :",mn.target.status),Mt({err:"An error occured during XMLHttpRequest",msg:mn.target.status},null)},fn.send(bn),Bt=Date.now()):Mt({err:"XMLHttpRequest is not defined",msg:"XMLHttpRequest is not defined"},null)},apiCC.testUserUploadLoop=function(Ot,Mt,bt){var Wt={type:"upload",kBPerSec:Mt.kbps/8,kbps:Mt.kbps,rating:Mt.rating},zt=0;Mt.kbps>1e3?apiCC.testUserUpload(Ot,function(Bt,rn){Bt!==null?bt({err:"An error occured during XMLHttpRequest"},null):(Wt.kBPerSec=rn.kBPerSec,Wt.kbps=8*rn.kBPerSec,Wt.rating=rn.rating,zt=Wt.kbps-Mt.kbps,It.debug("upload "+Ot+" "+JSON.stringify(Wt)+"; diff "+zt),zt>=2e4&&Ot<12e6?apiCC.testUserUploadLoop(Ot+8e6,Wt,bt):zt>=1e4&&Ot<14e6?apiCC.testUserUploadLoop(Ot+6e6,Wt,bt):zt>=5e3&&Ot<16e6?apiCC.testUserUploadLoop(Ot+4e6,Wt,bt):zt>=1e3&&Ot<18e6?apiCC.testUserUploadLoop(Ot+2e6,Wt,bt):zt>=200&&Ot<19e6?apiCC.testUserUploadLoop(Ot+1e6,Wt,bt):bt(null,Wt))}):bt(null,Wt)},apiCC.testUserDownloadLoop=function(Ot,Mt,bt){var Wt={type:"download",kBPerSec:Mt.kbps/8,kbps:Mt.kbps,rating:Mt.rating},zt=0;Mt.kbps>=3500?apiCC.testUserDownload(Ot,function(Bt,rn){Bt!==null?bt({err:"Error when downloading"},null):(Wt.kBPerSec=rn.kBPerSec,Wt.kbps=8*rn.kBPerSec,Wt.rating=rn.rating,zt=Wt.kbps-Mt.kbps,It.debug("download "+Ot+" "+JSON.stringify(Wt)+"; diff "+zt),zt>=2e4?apiCC.testUserDownloadLoop(3e4,Wt,bt):zt>=1e4&&Ot<=2e4?apiCC.testUserDownloadLoop(Ot+1e4,Wt,bt):zt>=5e3&&Ot<=25e3?apiCC.testUserDownloadLoop(Ot+5e3,Wt,bt):zt>=1e3&&Ot<=27e3?apiCC.testUserDownloadLoop(Ot+3e3,Wt,bt):zt>=200&&Ot<=29e3?apiCC.testUserDownloadLoop(Ot+1e3,Wt,bt):bt(null,Wt))}):bt(null,Wt)},apiCC.listenedAudioSources={};var Nt=window.AudioContext||window.webkitAudioContext||!1;apiCC.audioContext=null,apiCC.getAudioContext=function(){return apiRTC.osName==="iOS"&&typeof cordova<"u"?It.debug("No audioContext for iOS cordova"):Nt&&apiCC.audioContext===null&&(apiCC.audioContext=new Nt),apiCC.audioContext},apiCC.listenToAudioSources=function(Ot){It.debug("listenToAudioSources()");var Mt,bt=apiCC.getAudioContext();bt!=null?(Object.keys(apiCC.listenedAudioSources).length>0&&apiCC.stopAudioSourceListening(),apiCC.getMediaDevices().then(function(Wt){for(It.log(Wt),Mt=0;Mt<Wt.length;Mt++)Wt[Mt].kind==="audioinput"&&(apiCC.listenedAudioSources[Wt[Mt].deviceId]={deviceId:Wt[Mt].deviceId,callback:Ot,label:Wt[Mt].label},navigator.getUserMedia({audio:{optional:[{sourceId:Wt[Mt].deviceId}]},video:!1},(function(zt){It.log("new stream processing function for : "+this.device.deviceId),this.device.audioListener=this;var Bt=this,rn=bt.createScriptProcessor(2048,1,1),gn=bt.createMediaStreamSource(zt);rn.connect(bt.destination),rn.onaudioprocess=function(){var tn,Ht,fn,bn=new Uint8Array(this.analyser.frequencyBinCount),In=0;for(this.analyser.getByteFrequencyData(bn),Ht=0;Ht<bn.length;Ht++)In+=bn[Ht];tn=In/bn.length,fn={deviceId:Bt.device.deviceId,label:Bt.device.label,amplitude:tn,active:zt.active},Bt.device.callback(fn)},rn.analyser=bt.createAnalyser(),rn.analyser.smoothingTimeConstant=.3,rn.analyser.fftSize=1024,gn.connect(rn.analyser),rn.analyser.connect(rn),this.destroy=function(){It.log("destroy()");var tn,Ht=zt.getTracks();for(tn=0;tn<Ht.length;tn+=1)Ht[tn].stop();gn.disconnect(),rn.analyser.disconnect(),rn.disconnect()}}).bind({device:apiCC.listenedAudioSources[Wt[Mt].deviceId]}),function(zt){It.error("Error getting microphone",zt)}))},function(Wt){It.debug("listenToAudioSources() - getMediaDevices error :",Wt)})):It.debug("listenToAudioSources() - Unable to create audio context")},apiCC.stopAudioSourceListening=function(){var Ot;for(It.debug("stopAudioSourceListening()"),Ot=0;Ot<Object.keys(apiCC.listenedAudioSources).length;Ot++)apiCC.listenedAudioSources[Object.keys(apiCC.listenedAudioSources)[Ot]]!==void 0?apiCC.listenedAudioSources[Object.keys(apiCC.listenedAudioSources)[Ot]].audioListener!==void 0?apiCC.listenedAudioSources[Object.keys(apiCC.listenedAudioSources)[Ot]].audioListener.destroy():It.warn("error on stopAudioSourceListening, audioListener"):It.warn("error on stopAudioSourceListening, listenedAudioSources element");apiCC.listenedAudioSources={}},apiCC.webRTCPluginInstalled=!1,apiCC.iePluginInstallationPreventUnload=!1,apiCC.setlogStorageActivated=function(Ot,Mt){It.debug("setlogStorageActivated :",Ot),this.logStorageActivated=(Ot===!0||Ot===!1)&&Ot,Mt!==void 0&&(this.logStorageLevel=Mt)},apiCC.sendLogToCloud=function(Ot,Mt,bt,Wt){It.info("sendLogToCloud");var zt,Bt,rn=[],gn=null,tn=[],Ht=null,fn=null;for(rn.push(JSON.stringify({title:"ApiRTC logs",description:"Logs of apiRTC client"})),rn.push(JSON.stringify({ts:Date.now(),name:"system-info",args:{browserName:apiCC.browser,browserVersion:apiCC.browser_version,platform:apiCC.osName}})),zt=0;zt<Ot.length;zt++)gn=Ot[zt][0]==="error"?{name:"test-run",args:{error:Ot[zt][1]}}:{name:"test-run",args:{info:Ot[zt][1]}},rn.push(JSON.stringify(gn));tn=rn.concat(apiCC.logStorage),Ht=new FormData,Bt="["+tn.join(`,
`)+"]",It.debug("fileContent :",Bt),Wt!==!0&&(Ht.append("data",Bt),Ht.append("apiKey",apiCC.initApiKey),Mt!==void 0&&Ht.append("id",Mt),(fn=new XMLHttpRequest).open("POST",bt+"/test/api/",!0),fn.onreadystatechange=function(){fn.readyState===4&&fn.status===200&&console.info("[apiRTC_Logs] POST'd successfully"),console.trace(fn.responseText)},fn.send(Ht))},apiCC.manageWebRTCPlugin=function(Ot,Mt){It.debug("manageWebRTCPlugin");var bt;bt=window.location.protocol!=="https:"?"http":"https",_e([bt+"://cdn.temasys.io/adapterjs/0.15.x/adapter.debug.js"],"temAdapter",{async:!0,numRetries:apiCC.extJsLoadingRetryNb||100,reqdelay:apiCC.extJsLoadingRetryDelay||200,success:function(){It.log("End of .js loading for plugin"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("temAdapter","loaded"),AdapterJS.WebRTCPlugin.isPluginInstalled(AdapterJS.WebRTCPlugin.pluginInfo.prefix,AdapterJS.WebRTCPlugin.pluginInfo.plugName,AdapterJS.WebRTCPlugin.pluginInfo.type,function(){apiCC.myWebRTC_Adapter.RTCSessionDescription=RTCSessionDescription,apiCC.myWebRTC_Adapter.RTCIceCandidate=RTCIceCandidate,apiCC.myWebRTC_Adapter.RTCPeerConnection=RTCPeerConnection,apiCC.myWebRTC_Adapter.getUserMedia=navigator.getUserMedia,apiCC.attachMediaStream=attachMediaStream,AdapterJS.webRTCReady(function(Wt){return It.log("webRTCReady, plugin already installed"),Ot()})},function(){return apiCC.iePluginInstallationPreventUnload=!0,Mt(),AdapterJS.webRTCReady(function(Wt){return It.log("webRTCReady after plugin install"),apiCC.iePluginInstallationPreventUnload=!1,apiCC.myWebRTC_Adapter.RTCSessionDescription=RTCSessionDescription,apiCC.myWebRTC_Adapter.RTCIceCandidate=RTCIceCandidate,apiCC.myWebRTC_Adapter.RTCPeerConnection=RTCPeerConnection,apiCC.myWebRTC_Adapter.getUserMedia=navigator.getUserMedia,apiCC.attachMediaStream=attachMediaStream,Ot()}),apiCC.session.apiCCWebRTCClient.myWebRTC_Event.createEvent({eventType:"webRTCPluginInstallation"}),null})},error:function(Wt){It.error("temAdapter loading error"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("temAdapter","error")},retrycb:function(Wt,zt){It.warn("temAdapter loading retry :"+Wt+" ,delay before retry :"+zt),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("temAdapter","retry")}})},apiCC.checkMutingStateForUserMedia=function(Ot,Mt){It.debug("checkMutingStateForUserMedia"),(0,ct.ki)(Ot,"muted","string")&&(It.log("callConfiguration muted is set :",Ot.muted),Ot.muted==="VIDEO"&&(Mt.muteVideoOnStreams("enabled"),Mt.muteAudioOnStreams("enabled")),Ot.muted==="AUDIOONLY"&&Mt.muteAudioOnStreams("enabled"),Ot.muted==="VIDEOONLY"&&Mt.muteVideoOnStreams("enabled"))},apiCC.isSIPNumber=function(Ot){var Mt,bt=null,Wt=!1;return Mt=Ot.toString().startsWith("sip:"),Ot.toString().length<=20&&(bt=!0),(Ot.toString().indexOf("0")!==0&&Ot.toString().indexOf("+")!==0||bt!==!0)&&Mt!==!0||(Wt=!0),Wt},apiCC.loadSentry=function(Ot,Mt){It.debug("Remote logging activation"),_e([Mt+"://browser.sentry-cdn.com/5.24.2/bundle.tracing.min.js"],"Sentry",{async:!0,numRetries:10,reqdelay:500,success:function(){Sentry.init({dsn:"https://c24c226714f841dbbc3d1518b6cc7fe8@o333237.ingest.sentry.io/5448622",release:apiCC.version,tracesSampleRate:1}),Sentry.configureScope(function(bt){bt.setTag("apiKey",Ot)})},error:function(bt){console.error("Remote logging - loading error")},retrycb:function(bt,Wt){console.warn("Remote logging - loading retry :"+bt+" ,delay before retry :"+Wt)}})},apiCC.sendSentryEvent=function(Ot){if(It.debug("sendSentryEvent",Ot),typeof Sentry<"u"){var Mt="",bt={};Ot.eventType==="muteUnmuteEvent"?(Mt="Mute event on callId:"+Ot.callId,bt.muteType=Ot.muteType,bt.source=Ot.source,bt.mLine=Ot.mLine,bt.state=Ot.state,bt.callId=Ot.callId,bt.username=Ot.username):It.error("sendSentryEvent error : type ",Ot.eventType," is not supported");var Wt=Object.keys(bt);Mt!==""&&Wt.length>0&&Sentry.withScope(function(zt){Wt.forEach(function(Bt){zt.setTag(Bt,bt[Bt])}),Sentry.captureMessage(Mt)})}else It.debug("Sentry not activated")},apiCC.addPendingPromise=function(Ot,Mt,bt){var Wt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5e3;It.debug("addPendingPromise"),apiCC.pendingPromisesId++;var zt=function(rn){apiCC.cleanPendingPromiseTable(rn),bt("Timeout problem during ".concat(Ot," process on a remote stream"))},Bt=setTimeout(function(){zt(apiCC.pendingPromisesId)},Wt);return apiCC.pendingPromises.push({timeout:Bt,resolve:Mt,reject:bt,pendingPromisesId:apiCC.pendingPromisesId}),Bt},apiCC.resolvePendingPromise=function(Ot,Mt){It.debug("resolvePendingPromise"),apiCC.pendingPromises.forEach(function(bt){Ot===bt.timeout&&(clearTimeout(Ot),bt.resolve(Mt),apiCC.cleanPendingPromiseTable(bt.pendingPromisesId))})},apiCC.rejectPendingPromise=function(Ot,Mt){It.debug("rejectPendingPromise"),apiCC.pendingPromises.forEach(function(bt){Ot===bt.timeout&&(clearTimeout(Ot),bt.reject(Mt),apiCC.cleanPendingPromiseTable(bt.pendingPromisesId))})},apiCC.cleanPendingPromiseTable=function(Ot){apiCC.pendingPromises.forEach(function(Mt,bt){Ot===Mt.pendingPromisesId&&apiCC.pendingPromises.splice(bt,1)})}},5945:(at,ut,s)=>{s.d(ut,{$6:()=>Tt,AA:()=>At,Ak:()=>mt,BF:()=>ct,Cm:()=>ft,E2:()=>ot,MM:()=>ht,Ne:()=>Pt,PR:()=>pt,TI:()=>Nt,Xh:()=>lt,ag:()=>gt,cf:()=>It,dc:()=>St,vO:()=>it}),s(8309),s(2772),s(9064);var et,ot=null,lt=null,St=null,pt=null,gt=null,ct=null,ht=null,it=null,ft=null,mt=null,Tt=null,It=null,Pt=null,At=null,Nt=null;et=(ot=new UAParser).getBrowser(),gt=ot.getOS(),It=ot.getBrowser(),typeof apiRTC_React<"u"?(St=DeviceInfo.getSystemVersion(),ct=DeviceInfo.getSystemName(),lt=DeviceInfo.getUserAgent(),it=DeviceInfo.getModel()):(St=et.version||"Unknown",ct=ot.getOS().name||"Unknown",ht=ot.getOS().version||"Unknown",lt=et.name||"Unknown",Pt=ot.getCPU().architecture||"Unknown",it=ot.getDevice().type||"Unknown",ft=ot.getDevice().vendor||"Unknown",mt=ot.getDevice().model||"Unknown",At=ot.getEngine().name||"Unknown",Nt=ot.getEngine().version||"Unknown"),pt=St!==void 0?et.major:99,window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase().indexOf(" electron/")>=0&&(Tt="electron")},4708:(at,ut,s)=>{function et(Nt){return et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ot){return typeof Ot}:function(Ot){return Ot&&typeof Symbol=="function"&&Ot.constructor===Symbol&&Ot!==Symbol.prototype?"symbol":typeof Ot},et(Nt)}s.d(ut,{Pj:()=>St,S6:()=>ht,Wc:()=>ct,Ym:()=>It,_C:()=>lt,cw:()=>Tt,dD:()=>gt,fS:()=>At,ki:()=>Pt,wL:()=>ft,ws:()=>it,yJ:()=>pt}),s(4603),s(4916),s(9714),s(3123),s(9600),s(1249),s(7941),s(4723),s(1058),s(6992),s(9575),s(1539),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(9753),s(7042),s(2526),s(1817),s(2165),s(8783),s(3948);var ot=s(1549).Y.get("Utils");function lt(Nt){return new RegExp("^[0-9-.]*$","g").test(Nt)}function St(){return typeof apiRTC_React<"u"||window.location.protocol==="https:"}function pt(){return typeof apiRTC_React>"u"&&window.location.protocol==="http:"}function gt(Nt){var Ot,Mt,bt,Wt,zt={};for(bt=0,Wt=(Ot=Nt.split("&")).length;bt<Wt;bt++)zt[(Mt=Ot[bt].split("="))[0]]=Mt[1];return zt}function ct(Nt){return Object.keys(Nt).map(function(Ot){return Ot+"="+Nt[Ot]}).join("&")}function ht(Nt,Ot){ot.debug("mergeJSON");var Mt={},bt=null;if(Nt)for(bt in Nt)Nt.hasOwnProperty(bt)&&(Mt[bt]=Nt[bt]);if(Ot)for(bt in Ot)Ot.hasOwnProperty(bt)&&(Mt[bt]=Ot[bt]);return ot.log(Mt),Mt}var it=function(Nt,Ot){var Mt,bt,Wt;for(Nt==null&&(Nt={}),Mt=1;Mt<arguments.length;Mt+=1)for(bt in Wt=arguments[Mt])Wt.hasOwnProperty(bt)&&(Nt[bt]=Wt[bt]);return Nt},ft=function(){var Nt=function(Mt,bt,Wt){var zt=Mt.match(bt);return zt&&zt.length>=Wt&&parseInt(zt[Wt],10)},Ot={};if(typeof apiRTC_React<"u")return Ot.type="react-native",Ot;if(window!==void 0&&window.navigator!==void 0)if(window.navigator.mozGetUserMedia)Ot.type="firefox",Ot.version=Nt(window.navigator.userAgent,/Firefox\/(\d+)\./,1);else if(window.navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)Ot.type="chrome",Ot.version=Nt(window.navigator.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!window.navigator.userAgent.match(/Version\/(\d+).(\d+)/))return Ot;Ot.type="safari",Ot.version=Nt(window.navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(window.navigator.mediaDevices&&window.navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))Ot.type="edge",Ot.version=Nt(window.navigator.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!window.navigator.mediaDevices||!window.navigator.userAgent.match(/AppleWebKit\/(\d+)\./))return Ot;Ot.type="safari",Ot.version=Nt(window.navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}return Ot}(),mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-/=",Tt={decode:function(Nt){var Ot,Mt=mt.indexOf(Nt.charAt(Nt.length-1)),bt=mt.indexOf(Nt.charAt(Nt.length-2)),Wt=Nt.length/4*3,zt=null,Bt=null,rn=null,gn=null,tn=null,Ht=null,fn=0,bn=null;for(Mt===64&&Wt--,bt===64&&Wt--,bn=new Uint8Array(Wt),Ot=0;Ot<Wt;Ot+=3)zt=mt.indexOf(Nt.charAt(fn++))<<2|(gn=mt.indexOf(Nt.charAt(fn++)))>>4,Bt=(15&gn)<<4|(tn=mt.indexOf(Nt.charAt(fn++)))>>2,rn=(3&tn)<<6|(Ht=mt.indexOf(Nt.charAt(fn++))),bn[Ot]=zt,tn!==64&&(bn[Ot+1]=Bt),Ht!==64&&(bn[Ot+2]=rn);return bn},encode:function(Nt){var Ot,Mt="",bt=new Uint8Array(Nt),Wt=bt.byteLength,zt=Wt%3,Bt=Wt-zt,rn=null;for(Ot=0;Ot<Bt;Ot+=3)rn=bt[Ot]<<16|bt[Ot+1]<<8|bt[Ot+2],Mt+=mt[(16515072&rn)>>18]+mt[(258048&rn)>>12]+mt[(4032&rn)>>6]+mt[63&rn];return zt===1?(rn=bt[Bt],Mt+=mt[(252&rn)>>2]+mt[(3&rn)<<4]+"=="):zt===2&&(rn=bt[Bt]<<8|bt[Bt+1],Mt+=mt[(64512&rn)>>10]+mt[(1008&rn)>>4]+mt[(15&rn)<<2]+"="),Mt}};function It(Nt,Ot){return arguments.length===3?Pt(arguments[0],arguments[1],arguments[2]):Ot==="null"?Nt===null:Ot==="array"?Nt!==null&&et(Nt)==="object"&&Array.isArray(Nt):Nt!==null&&et(Nt)===Ot}function Pt(Nt,Ot,Mt){if(Ot!==null&&et(Ot)==="object"&&Array.isArray(Ot)&&Ot.length>=1){var bt=Ot[0];if(Ot.length>1)return It(Nt,"object")&&It(bt,"string")&&Nt.hasOwnProperty(bt)&&It(Nt[bt],"object")&&Pt(Nt[bt],Ot.slice(1),Mt);Ot=bt}return Mt==="undefined"?It(Nt,"object")&&It(Ot,"string")&&!Nt.hasOwnProperty(Ot)&&It(Nt[Ot],Mt):It(Nt,"object")&&It(Ot,"string")&&Nt.hasOwnProperty(Ot)&&It(Nt[Ot],Mt)}function At(Nt,Ot){if(Nt===Ot)return!0;if(!(Nt instanceof Object&&Ot instanceof Object)||Nt.constructor!==Ot.constructor)return!1;for(var Mt in Nt)if(Nt.hasOwnProperty(Mt)){if(!Ot.hasOwnProperty(Mt))return!1;if(Nt[Mt]===Ot[Mt])continue;if(et(Nt[Mt])!=="object"||!At(Nt[Mt],Ot[Mt]))return!1}for(Mt in Ot)if(Ot.hasOwnProperty(Mt)&&!Nt.hasOwnProperty(Mt))return!1;return!0}},6075:(at,ut,s)=>{s.d(ut,{F:()=>ot});var et=s(1549).Y.get("WebRTC_Stack"),ot=function(){this.adaptForIoSCordova=function(){if(apiRTC.osName==="iOS"&&typeof cordova<"u"){if(et.log("Modification for iOS cordova"),cordova.plugins===void 0)return void et.log("cordova.plugins not defined");if(cordova.plugins.iosrtc===void 0)return void et.log("cordova.plugins.iosrtc not defined");this.RTCPeerConnection=cordova.plugins.iosrtc.RTCPeerConnection,this.RTCSessionDescription=cordova.plugins.iosrtc.RTCSessionDescription,this.RTCIceCandidate=cordova.plugins.iosrtc.RTCIceCandidate}},typeof RTCSessionDescription<"u"?this.RTCSessionDescription=RTCSessionDescription:et.log("RTCSessionDescription is undefined"),typeof RTCIceCandidate<"u"?this.RTCIceCandidate=RTCIceCandidate:et.log("RTCIceCandidate is undefined"),typeof RTCPeerConnection<"u"?this.RTCPeerConnection=RTCPeerConnection:et.log("RTCPeerConnection is undefined"),navigator.getUserMedia!==void 0?this.getUserMedia=navigator.getUserMedia:typeof getUserMedia<"u"?this.getUserMedia=getUserMedia:et.log("getUserMedia is undefined")}},8765:(at,ut,s)=>{s.d(ut,{K:()=>gt}),s(6755),s(2772),s(3710),s(8309),s(9601),s(2526),s(1817),s(1539),s(2165),s(6992),s(8783),s(3948);var et=s(1549),ot=s(5945),lt=s(4708);function St(ct){return St=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ht){return typeof ht}:function(ht){return ht&&typeof Symbol=="function"&&ht.constructor===Symbol&&ht!==Symbol.prototype?"symbol":typeof ht},St(ct)}var pt=et.Y.get("WebRTC_Event"),gt=function(){if(pt.debug("WebRTC_Event"),this.customEventIsDefined="notTested",this.customEventIsDefined==="notTested")try{new CustomEvent("test",{detail:"test",bubbles:!0,cancelable:!0}),this.customEventIsDefined=!0}catch(ct){this.customEventIsDefined=!1,pt.log("customEvent error :"+ct)}(ot.Xh==="IE"&&ot.dc>8||ot.Xh==="Netscape")&&(pt.log("polyfill the CustomEvent()"),function(){function ct(ht,it){it=it||{bubbles:!1,cancelable:!1,detail:void 0};var ft=document.createEvent("CustomEvent");return ft.initCustomEvent(ht,it.bubbles,it.cancelable,it.detail),ft}ct.prototype=window.CustomEvent.prototype,window.CustomEvent=ct}(),this.customEventIsDefined=!0),ot.Xh==="IE"&&ot.dc>8&&(pt.log("polyfill startsWith()"),String.prototype.startsWith||(String.prototype.startsWith=function(ct,ht){return ht=ht||0,this.indexOf(ct,ht)===ht})),this.eventDispatchMgr=function(ct,ht){if(typeof apiRTC_React<"u"){var it={type:ct,detail:ht};eventManager.dispatchEvent(it)}else if(this.customEventIsDefined===!1)typeof $jqApz<"u"?(pt.log("CustomEvent not supported by Browser, using $jqApz "),$jqApz.event.trigger({type:ct,detail:ht})):typeof jQuery<"u"?(pt.log("CustomEvent not supported by Browser, using jQuery "),jQuery.event.trigger({type:ct,detail:ht})):pt.warn("Custom Events not supported on this browser : eventDispatchMgr()");else{var ft=new CustomEvent(ct,{detail:ht,bubbles:!0,cancelable:!0});document.dispatchEvent(ft)}},this.createIncomingCallEvent=function(ct,ht,it,ft,mt,Tt,It,Pt,At,Nt,Ot){var Mt={eventType:"incomingCall",time:new Date,clientId:ct,callerId:ht,callId:ft,autoAnswerActivated:mt,callNumber:Tt,callerNickname:it,audioOnly:It,callType:Pt,destCallType:Ot,recordedCall:At,remoteType:Nt};this.eventDispatchMgr("incomingCall",Mt)},this.createCallAttemptEvent=function(ct,ht,it,ft){var mt={eventType:"callAttempt",time:new Date,clientId:ct,callerId:ht,callId:ft,callerNickname:it};this.eventDispatchMgr("callAttempt",mt)},this.createCallEstablishedEvent=function(ct,ht,it,ft){pt.debug("createCallEstablishedEvent with callType : "+ht),pt.debug("destCallType : "+ft);var mt={eventType:"callEstablished",time:new Date,calleeId:ct,callType:ht,callId:it,destCallType:ft};this.eventDispatchMgr("callEstablished",mt)},this.createHangupEvent=function(ct,ht,it,ft,mt,Tt,It){var Pt={eventType:"hangup",time:new Date,hangupType:ct,clientId:ht,remoteId:it,lastEstablishedCall:ft,reason:mt,callId:Tt,callType:It};this.eventDispatchMgr("hangup",Pt)},this.createRemoteHangupEvent=function(ct,ht,it,ft){var mt={eventType:"remoteHangup",time:new Date,clientId:ct,remoteId:ht,lastEstablishedCall:it,reason:ft};this.eventDispatchMgr("remoteHangup",mt)},this.createCallRestartingEvent=function(ct,ht,it,ft,mt,Tt,It,Pt,At){var Nt={eventType:"callRestarting",time:new Date,callType:ct,audioOnly:ht,oldCallId:it,newCallId:ft,dataType:mt,clientId:Tt,remoteId:It,destRoom:Pt,streamId:At};this.eventDispatchMgr("callRestarting",Nt)},this.createUserMediaSuccessEvent=function(ct,ht,it,ft,mt,Tt,It,Pt,At,Nt,Ot){var Mt={eventType:"userMediaSuccess",time:new Date,onCallEstablishment:ct,audioIsAvailable:ht,audioDeviceLabel:it,videoIsAvailable:ft,videoDeviceLabel:mt,callType:Tt,callId:It,stream:Pt,remoteId:At,restarted:Nt,userMediaStreamId:Ot};this.eventDispatchMgr("userMediaSuccess",Mt)},this.createUserMediaErrorEvent=function(ct,ht,it,ft,mt,Tt,It){var Pt={eventType:"userMediaError",time:new Date,onCallEstablishment:ct,callType:ht,userMediaStreamId:ft,callId:mt,tryAudioCallActivated:Tt,gumConfig:It};St(it)==="object"?(Pt.error={},Pt.error.message=it.message,Pt.error.code=it.code,Pt.error.name=it.name):Pt.error=it,this.eventDispatchMgr("userMediaError",Pt)},this.createUserMediaStopEvent=function(ct,ht,it){var ft={eventType:"userMediaStop",time:new Date,callId:ct,mediaType:ht,userMediaStreamId:it};this.eventDispatchMgr("userMediaStop",ft)},this.createICECandidateTypeUpdateEvent=function(ct,ht,it){var ft={eventType:"ICECandidateTypeUpdate",time:new Date,callId:ct,localCandidate:ht,remoteCandidate:it};this.eventDispatchMgr("ICECandidateTypeUpdate",ft)},this.createSelectedICECandidateEvent=function(ct,ht,it,ft,mt,Tt,It){var Pt={eventType:"selectedICECandidate",time:new Date,callId:ct,localCandidateType:ht,remoteCandidateType:it,localAddress:ft,remoteAdress:mt,transportType:Tt,localTransportType:It};this.eventDispatchMgr("selectedICECandidate",Pt)},this.createErrorEvent=function(ct,ht,it,ft,mt,Tt,It){var Pt={eventType:"error",time:new Date,errorInfo:ct,errorCode:ht,callId:it,roomName:ft,roomCallType:mt};(0,lt.Ym)(Tt,"object")&&(Pt.data=Tt),(0,lt.Ym)(It,"string")&&(Pt.convId=It),this.eventDispatchMgr("error",Pt)},this.createReceiveIMMessageEvent=function(ct,ht,it,ft,mt,Tt){var It={eventType:"receiveIMMessage",time:new Date,senderId:ct,senderNickname:ht,senderPhotoURL:it,message:ft,UUCSeq:mt,convId:Tt};this.eventDispatchMgr("receiveIMMessage",It)},this.createChannelEvent=function(ct,ht){var it={eventType:"channelEvent",time:new Date,channelEvent:ct,event:ht};this.eventDispatchMgr("channelEvent",it)},this.createSessionReadyEvent=function(ct){pt.debug("createSessionReadyEvent");var ht={eventType:"sessionReady",time:new Date,apiCCId:ct};this.eventDispatchMgr("sessionReady",ht)},this.createWebRTCClientCreatedEvent=function(){var ct={eventType:"webRTCClientCreated",time:new Date};this.eventDispatchMgr("webRTCClientCreated",ct)},this.createUpdatePresenceEvent=function(ct,ht,it){var ft={eventType:"updatePresence",time:new Date,connectedUsersList:ct,connectedUsersListWithStatus:it,state:ht};this.eventDispatchMgr("updatePresence",ft)},this.createCloudEventOccurredEvent=function(ct,ht){var it={eventType:"cloudEventOccurred",time:new Date,topic:ct,target:ht};this.eventDispatchMgr("cloudEventOccurred",it)},this.createUpdateUserStatusEvent=function(ct){var ht={eventType:"updateUserStatus",time:new Date,message:ct};this.eventDispatchMgr("updateUserStatus",ht)},this.createGroupChatCreationEvent=function(ct,ht,it,ft,mt,Tt){var It={eventType:"groupChatCreation",time:new Date,status:ct,groupChatId:ht,initialDestId:it,invitationSendedToInitialDestId:ft,newContactId:mt,invitationSendedToNewContactId:Tt};this.eventDispatchMgr("groupChatCreation",It)},this.createGroupChatInvitationEvent=function(ct,ht,it,ft,mt){var Tt={eventType:"groupChatInvitation",time:new Date,groupChatId:ct,contactList:mt,senderId:ht,senderNickname:it,senderPhotoURL:ft};this.eventDispatchMgr("groupChatInvitation",Tt)},this.createGroupChatMemberUpdateEvent=function(ct,ht,it){var ft={eventType:"groupChatMemberUpdate",time:new Date,groupChatId:ct,contactList:ht,status:it};this.eventDispatchMgr("groupChatMemberUpdate",ft)},this.createAddUserInGroupChatEvent=function(ct,ht,it){var ft={eventType:"addUserInGroupChatAnswer",time:new Date,invitationSended:ct,groupChatId:ht,contactId:it};this.eventDispatchMgr("addUserInGroupChatAnswer",ft)},this.createReceiveGroupChatMessageEvent=function(ct,ht,it,ft,mt){var Tt={eventType:"receiveGroupChatMessage",time:new Date,groupChatId:ct,senderId:ht,senderNickname:it,message:ft};(0,lt.Ym)(mt,"object")&&(Tt.metadata=mt),this.eventDispatchMgr("receiveGroupChatMessage",Tt)},this.createReceiveConversationListAnswerEvent=function(ct){var ht={eventType:"receiveConversationList",time:new Date,convList:ct};this.eventDispatchMgr("receiveConversationList",ht)},this.createReceiveContactOccurrencesFromConversationListAnswerEvent=function(ct){var ht={eventType:"receiveContactOccurrencesFromConversationList",time:new Date,occurrencesList:ct};this.eventDispatchMgr("receiveContactOccurrencesFromConversationList",ht)},this.createReceiveConversationDetailReportAnswerEvent=function(ct){var ht={eventType:"receiveConversationDetailReport",time:new Date,CDR:ct};this.eventDispatchMgr("receiveConversationDetailReport",ht)},this.createReceiveConversationHistoryEvent=function(ct,ht,it){var ft={eventType:"receiveConversationHistory",time:new Date,convId:ct,convHistory:ht,status:it};this.eventDispatchMgr("receiveConversationHistory",ft)},this.createUserDataAnswerEvent=function(ct,ht,it,ft){var mt={eventType:"userDataAnswer",time:new Date,userFound:ct,contactId:ht,nickname:it,photoURL:ft};this.eventDispatchMgr("userDataAnswer",mt)},this.createFetchUserDataAnswerEvent=function(ct){var ht="fetchUserDataAnswer",it={eventType:ht,timeout:ct.timeout,userData:ct.userData,id:ct.id};this.eventDispatchMgr(ht,it)},this.createReceiveDataEvent=function(ct,ht,it){var ft={eventType:"receiveData",time:new Date,senderId:ct,dstRoomId:ht,data:it};this.eventDispatchMgr("receiveData",ft)},this.createMCUSessionCreationEvent=function(ct,ht){var it={eventType:"MCUSessionCreation",time:new Date,sessionId:ct,token:ht};this.eventDispatchMgr("MCUSessionCreation",it)},this.createJoinMCUSessionAnswerEvent=function(ct,ht,it,ft,mt){var Tt={eventType:"joinMCUSessionAnswer",time:new Date,sessionId:ct,token:ht,groupChatId:it,initiator:ft,roomId:mt.roomName};mt.roomMode&&(Tt.mode=mt.roomMode),mt.meshOnly===!0&&(Tt.meshOnly=!0),mt.joinSessionAnswer&&(Tt.result=Object.assign({},mt.joinSessionAnswer)),this.eventDispatchMgr("joinMCUSessionAnswer",Tt)},this.createMCUAvailableStreamEvent=function(ct,ht){var it={eventType:"MCUAvailableStream",time:new Date,streams:ct,isRemoteStream:ht};this.eventDispatchMgr("MCUAvailableStream",it)},this.createMCUAvailableReplayEvent=function(ct,ht){var it={eventType:"MCUAvailableReplay",time:new Date,streams:ct,isRemoteStream:ht};this.eventDispatchMgr("MCUAvailableReplay",it)},this.createMCUAvailableCompositeEvent=function(ct,ht){var it={eventType:"MCUAvailableComposite",time:new Date,streams:ct,isRemoteStream:ht};this.eventDispatchMgr("MCUAvailableComposite",it)},this.createMCURemovedStreamEvent=function(ct){var ht={eventType:"MCURemoveStream",time:new Date,streamId:ct};this.eventDispatchMgr("MCURemoveStream",ht)},this.createMCUAvailableStreamUpdateEvent=function(ct,ht){var it={eventType:"MCUAvailableStreamUpdate",time:new Date,streams:ct,isRemoteStream:ht};this.eventDispatchMgr("MCUAvailableStreamUpdate",it)},this.createMCUParticipantEjectedEvent=function(ct,ht,it){var ft={eventType:"MCUParticipantEjected",time:new Date,roomId:ct,clientId:ht};it&&(ft.data=it),this.eventDispatchMgr("MCUParticipantEjected",ft)},this.createReceiveMCUSessionInvitationEvent=function(ct,ht,it,ft){it===void 0&&(it=0);var mt={eventType:"receiveMCUSessionInvitation",time:new Date,sessionId:ct,token:ht,groupChatId:it,initiatorId:ft};this.eventDispatchMgr("receiveMCUSessionInvitation",mt)},this.createRemoteStreamAddedEvent=function(ct,ht,it,ft,mt,Tt,It){var Pt={eventType:"remoteStreamAdded",time:new Date,callId:ht,callType:ct,stream:it,remoteId:ft,destCallType:mt,audioIsAvailable:Tt.available,audioIsActive:Tt.active,audioIsMuted:Tt.muted,videoIsAvailable:It.available,videoIsActive:It.active,videoIsMuted:It.muted};this.eventDispatchMgr("remoteStreamAdded",Pt)},this.createRemoteStreamRemovedEvent=function(ct,ht,it,ft,mt){var Tt={eventType:"remoteStreamRemoved",time:new Date,callId:ht,callType:ct,stream:it,remoteId:ft,destCallType:mt};this.eventDispatchMgr("remoteStreamRemoved",Tt)},this.createSimulcastFeedChanged=function(ct,ht){var it={eventType:"simulcastFeedChanged",time:new Date,callId:ct,simulcast:ht};this.eventDispatchMgr("simulcastFeedChanged",it)},this.createLocalStreamRemovedEvent=function(ct,ht,it,ft,mt){var Tt={eventType:"localStreamRemoved",time:new Date,callId:ht,callType:ct,stream:it,remoteId:ft,destCallType:mt};this.eventDispatchMgr("localStreamRemoved",Tt)},this.createSlowLinkEvent=function(ct,ht){var it={eventType:"slowLink",time:new Date,callId:ct};ht&&(it.advice=ht),this.eventDispatchMgr("slowLink",it)},this.createVideoQualityChangedEvent=function(ct,ht,it,ft){var mt={eventType:"videoQualityChanged",time:new Date,roomname:ht,callId:ct,hint:it,profileType:ft.name};ft.bitrate&&(mt.bitrate=ft.bitrate),ft.width&&ft.height&&(mt.width=ft.width,mt.height=ft.height),ft.frameRate&&(mt.frameRate=ft.frameRate),this.eventDispatchMgr("videoQualityChanged",mt)},this.createAudioAmplitudeEvent=function(ct,ht,it,ft){var mt={eventType:"audioAmplitude",time:new Date,callId:it,userMediaStreamId:ft,descriptor:{amplitude:ct,isSpeaking:ht}};this.eventDispatchMgr("audioAmplitude",mt)},this.createLocalStreamUpdatedEvent=function(ct,ht,it,ft,mt,Tt,It,Pt,At){var Nt={eventType:"localStreamUpdated",time:new Date,changeList:ct,audioIsAvailable:ht.available,audioDeviceLabel:ht.deviceLabel,audioIsActive:ht.active,audioIsMuted:ht.muted,audioIsSilent:ht.silent,videoIsAvailable:it.available,videoDeviceLabel:it.deviceLabel,videoIsActive:it.active,videoIsMuted:it.muted,videoIsSilent:it.silent,onCall:ft,callType:mt,callId:Tt,stream:It,userMediaStreamId:Pt,cause:At};this.eventDispatchMgr("localStreamUpdated",Nt)},this.createRemoteStreamUpdatedEvent=function(ct,ht,it,ft,mt,Tt){var It={eventType:"remoteStreamUpdated",time:new Date,changeList:ct,audioIsAvailable:ht.available,audioIsActive:ht.active,audioIsMuted:ht.muted,audioIsSilent:ht.silent,videoIsAvailable:it.available,videoIsActive:it.active,videoIsMuted:it.muted,videoIsSilent:it.silent,callType:ft,callId:mt,cause:Tt};this.eventDispatchMgr("remoteStreamUpdated",It)},this.createCanPlayRemoteVideoEvent=function(ct,ht,it){var ft={eventType:"canPlayRemoteVideo",time:new Date,videoDivId:ct,callType:ht,remoteId:it};this.eventDispatchMgr("canPlayRemoteVideo",ft)},this.createRecordedFileAvailableEvent=function(ct){var ht={eventType:"recordedFileAvailable",time:new Date,fileName:ct};this.eventDispatchMgr("recordedFileAvailable",ht)},this.createRecordedStreamsAvailableEvent=function(ct,ht,it,ft,mt,Tt,It){var Pt={eventType:"recordedStreamsAvailable",time:new Date,confId:ct,userId1:ht,userId2:it,callId:ft,apiKey:apiCC.session.apiKey};mt&&(Pt.convId=mt),Tt&&(Pt.mediaId=Tt),It&&(Pt.mediaURL=It),this.eventDispatchMgr("recordedStreamsAvailable",Pt)},this.createMCURecordedStreamsAvailableEvent=function(ct,ht,it,ft,mt,Tt,It,Pt,At,Nt,Ot){var Mt={eventType:"MCURecordedStreamsAvailable",time:new Date,roomName:ct,callId:ht,clientId:it,convId:mt,mediaId:Tt,mediaURL:It,recordType:Pt};At&&(Mt.remoteId=At),ft&&(Mt.recordedFileName=ft),Nt&&(Mt.mediaType=Nt),(0,lt.Ym)(Ot,"object")?(Mt.descriptor={},(0,lt.Ym)(Ot,"mode","string")&&(Mt.descriptor.mode=Ot.mode),(0,lt.Ym)(Ot,"labelEnabled","boolean")&&(Mt.descriptor.labelEnabled=Ot.labelEnabled),Mt.descriptor.labelEnabled===!0&&(0,lt.Ym)(Ot,"labels","array")&&(Mt.descriptor.labels=Ot.labels)):Mt.descriptor={mode:"complete",labelEnabled:!1},this.eventDispatchMgr("MCURecordedStreamsAvailable",Mt)},this.createMCURecordingStartedEvent=function(ct,ht,it,ft,mt,Tt,It,Pt,At,Nt,Ot,Mt){var bt={eventType:"MCURecordingStarted",time:new Date,roomName:ct,callId:ht,clientId:it,recordType:ft,recordStartTime:mt};Tt&&(bt.convId=Tt),It&&(bt.mediaId=It),Pt&&(bt.mediaURL=Pt),At&&(bt.remoteId=At),Nt&&(bt.recordedFileName=Nt),Ot&&(bt.mediaType=Ot),(0,lt.Ym)(Mt,"object")&&(bt.descriptor={},(0,lt.Ym)(Mt,"mode","string")&&(bt.descriptor.mode=Mt.mode),(0,lt.Ym)(Mt,"labelEnabled","boolean")&&(bt.descriptor.labelEnabled=Mt.labelEnabled),bt.descriptor.labelEnabled===!0&&(0,lt.Ym)(Mt,"labels","array")&&(bt.descriptor.labels=Mt.labels)),this.eventDispatchMgr("MCURecordingStarted",bt)},this.createMCURecordingStoppedEvent=function(ct,ht,it,ft,mt,Tt,It,Pt,At,Nt,Ot,Mt){var bt={eventType:"MCURecordingStopped",time:new Date,roomName:ct,callId:ht,clientId:it,recordType:ft,recordStartTime:mt};Tt&&(bt.convId=Tt),It&&(bt.mediaId=It),Pt&&(bt.mediaURL=Pt),At&&(bt.remoteId=At),Nt&&(bt.recordedFileName=Nt),Ot&&(bt.mediaType=Ot),(0,lt.Ym)(Mt,"object")&&(bt.descriptor={},(0,lt.Ym)(Mt,"mode","string")&&(bt.descriptor.mode=Mt.mode),(0,lt.Ym)(Mt,"labelEnabled","boolean")&&(bt.descriptor.labelEnabled=Mt.labelEnabled),bt.descriptor.labelEnabled===!0&&(0,lt.Ym)(Mt,"labels","array")&&(bt.descriptor.labels=Mt.labels)),this.eventDispatchMgr("MCURecordingStopped",bt)},this.createStopRecordEvent=function(){var ct={eventType:"stopRecord",time:new Date};this.eventDispatchMgr("stopRecord",ct)},this.createMCUStreamingStartedEvent=function(ct,ht,it,ft){var mt={eventType:"MCUStreamingStarted",time:new Date,roomName:ct,callId:ht,clientId:it,streamingStartTime:ft};this.eventDispatchMgr("MCUStreamingStarted",mt)},this.createMCUStreamingStoppedEvent=function(ct,ht,it,ft){var mt={eventType:"MCUStreamingStopped",time:new Date,roomName:ct,callId:ht,clientId:it,streamingEndTime:ft};this.eventDispatchMgr("MCUStreamingStopped",mt)},this.createMCURoomModeChangedEvent=function(ct,ht,it,ft){var mt={eventType:"MCURoomModeChanged",time:new Date,roomId:ct,oldMode:ht,newMode:it,state:ft};this.eventDispatchMgr("MCURoomModeChanged",mt)},this.createSnapShotPhotoUploaded=function(ct){var ht={eventType:"snapShotPhotoUploaded",time:new Date,fileName:ct};this.eventDispatchMgr("snapShotPhotoUploaded",ht)},this.createRoomCreationEvent=function(ct,ht,it){var ft={eventType:"roomCreation",time:new Date,status:ct,roomId:ht,roomType:it};this.eventDispatchMgr("roomCreation",ft)},this.createRoomJoinedEvent=function(ct,ht,it){var ft={eventType:"roomJoined",time:new Date,status:ct,roomId:ht,roomType:it};this.eventDispatchMgr("roomJoined",ft)},this.createRoomInvitationEvent=function(ct,ht,it,ft,mt,Tt){var It=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},Pt="roomInvitation",At={eventType:"roomInvitation",time:new Date,roomId:ct,contactList:mt,senderId:ht,senderNickname:it,senderPhotoURL:ft,roomType:Tt};It.cloudConvId&&(At.cloudConvId=It.cloudConvId),It.webconf===!0&&(At.webconf=!0),this.eventDispatchMgr(Pt,At)},this.createRoomMemberUpdateEvent=function(ct,ht,it,ft){var mt={eventType:"roomMemberUpdate",time:new Date,roomId:ct,contactList:ht,status:it,roomType:ft};this.eventDispatchMgr("roomMemberUpdate",mt)},this.createContactListInRoomEvent=function(ct,ht,it){var ft={eventType:"contactListInRoom",time:new Date,roomId:ct,contactList:ht,roomType:it};this.eventDispatchMgr("contactListInRoom",ft)},this.createReceiveRoomMessageEvent=function(ct,ht,it,ft,mt){var Tt={eventType:"receiveRoomMessage",time:new Date,roomId:ct,senderId:ht,senderNickname:it,message:ft,roomType:mt};this.eventDispatchMgr("receiveRoomMessage",Tt)},this.createDesktopCaptureEvent=function(ct,ht,it){var ft={eventType:"desktopCapture",time:new Date,event:ct,callId:ht,remoteId:it};this.eventDispatchMgr("desktopCapture",ft)},this.createMediaDeviceChangedEvent=function(ct,ht,it){var ft="NotDefined";ht!=null&&(ft=ht);var mt={eventType:"mediaDeviceChanged",time:new Date,diff:ct,updateReason:ft,firstMediaDeviceListInitialization:it};this.eventDispatchMgr("mediaDeviceChanged",mt)},this.createSwitchStreamEvent=function(ct,ht){var it={eventType:"switchStream",time:new Date,callId:ct,stream:ht};this.eventDispatchMgr("switchStream",it)},this.createConnectedUsersListUpdateEvent=function(ct,ht,it,ft){var mt={eventType:"ConnectedUsersListUpdate",time:new Date,group:ct,usersList:ht,status:it,updateReason:ft};this.eventDispatchMgr("connectedUsersListUpdate",mt)},this.createClosingWhiteBoardEvent=function(ct,ht){var it={eventType:"closingWhiteBoard",time:new Date,roomId:ct,reason:ht};this.eventDispatchMgr("closingWhiteBoard",it)},this.createExternalJsLoadingStatusEvent=function(ct,ht){var it={eventType:"externalJsLoadingStatus",extjs:ct,status:ht,time:new Date};this.eventDispatchMgr("externalJsLoadingStatus",it)},this.createBackgroundSubstractionStopVisibilityChangeEvent=function(ct){var ht={userMediaStreamId:ct};this.eventDispatchMgr("backgroundSubstractionStopVisibilityChange",ht)},this.createBackgroundSubstractionStopComputeTimeEvent=function(ct){var ht={userMediaStreamId:ct};this.eventDispatchMgr("backgroundSubstractionStopComputeTime",ht)},this.createAIESnapshotEvent=function(ct,ht){var it={userMediaStreamId:ct,image:ht};this.eventDispatchMgr("AIESnapshot",it)},this.createAIELogEvent=function(ct,ht){var it={userMediaStreamId:ct,log:ht};this.eventDispatchMgr("AIELog",it)},this.createEvent=function(ct){if(!ct.eventType)throw new Error("The event json must have an eventType"+ct);ct.time=new Date,this.eventDispatchMgr(ct.eventType,ct)}}},940:(at,ut,s)=>{s.d(ut,{S:()=>St}),s(2772);var et=s(1549),ot=s(5945),lt=et.Y.get("WebRTC_Stack"),St=function(pt){this.sendInvite=function(gt,ct,ht,it,ft,mt){var Tt=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{};lt.debug("WebRTC_Stack::sendInvite()"),mt||(mt="media");var It={type:"invite",callId:gt,callerId:ct,callerNickname:ht,calleeId:it,roomId:ft,callType:mt};Tt.mode&&(It.mode=Tt.mode);var Pt=Tt.offer;if(Pt){if(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11){var At=Pt.type,Nt=Pt.sdp;lt.log("JSON.stringify(type):",JSON.stringify(At)),lt.log("JSON.stringify(sdp):",JSON.stringify(Nt)),Pt={type:At,sdp:Nt}}It.sdpoffer=Pt}Tt.data&&(It.data=Tt.data),Tt.stream&&(It.stream=Tt.stream);var Ot=JSON.stringify(It);lt.info("C->S:",Ot),pt.emit("invite",Ot)},this.sendInviteBroadcast=function(gt,ct,ht,it,ft,mt){var Tt,It;lt.debug("WebRTC_Stack::sendInviteBroadcast()"),Tt={type:"invite",callId:gt,callerId:ct,callerNickname:ht,calleeId:it,roomId:ft,sdpoffer:mt},It=JSON.stringify(Tt),lt.debug("C->S: "+It),pt.emit("invite_broadcast",It)},this.send200OK=function(gt,ct,ht,it,ft,mt,Tt){lt.debug("WebRTC_Stack::send200OK()");var It,Pt,At=null;(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&(lt.log("JSON.stringify(offer.sdp) :"+JSON.stringify(mt.sdp)),lt.log("JSON.stringify(offer.type) :"+JSON.stringify(mt.type)),(At={}).sdp=mt.sdp,At.type=mt.type,mt=At),It={type:"200OK",callId:gt,callerId:ct,calleeId:ht,calleeNickname:it,roomId:ft,sdpanswer:mt,data:Tt},Pt=JSON.stringify(It),lt.info("C->S: "+Pt),pt.emit("200OK",Pt)},this.sendCandidate=function(gt,ct,ht,it,ft,mt,Tt,It,Pt,At){lt.debug("WebRTC_Stack::sendCandidate()");var Nt=null,Ot={};lt.debug("completeCandidate :",At),ot.Xh==="IE"?(lt.log("Browser is IE, adapting completeCandidate"),Ot.sdpMLineIndex=At.sdpMLineIndex,Ot.candidate=At.candidate,Ot.sdpMid=At.sdpMid):Ot=At,Pt!==null?(lt.log("call data is defined :",Pt),Nt={type:"candidate",callId:gt,callerId:ct,calleeId:ht,roomId:it,dst:ft,label:mt,id:Tt,candidate:It,data:Pt,completeCandidate:Ot}):(lt.log("call data is undefined"),Nt={type:"candidate",callId:gt,callerId:ct,calleeId:ht,roomId:it,dst:ft,label:mt,id:Tt,candidate:It,completeCandidate:Ot});var Mt=JSON.stringify(Nt);lt.info("C->S:",Mt),pt.emit("candidate",Mt)},this.sendBye=function(gt,ct,ht,it,ft,mt){lt.debug("WebRTC_Stack::sendBye()");var Tt,It=null;mt!==null?(lt.log("call data is defined :"+mt),It={type:"bye",callId:gt,clientId:ct,roomId:ht,dst:it,reason:ft,data:mt}):(lt.log("call data is undefined"),It={type:"bye",callId:gt,clientId:ct,roomId:ht,dst:it,reason:ft}),Tt=JSON.stringify(It),lt.info("C->S: "+Tt),pt.emit("bye",Tt)},this.sendUpdate=function(gt,ct,ht,it,ft,mt,Tt,It){lt.debug("WebRTC_Stack::sendUpdate()");var Pt,At=null;At={type:"update",callId:gt,callerId:ct,calleeId:ht,roomId:it,dst:ft,sdpoffer:mt,callType:Tt},It!=null&&(lt.log("call data is defined: "+It),At.data=It),Pt=JSON.stringify(At),lt.info("C->S: "+Pt),pt.emit("update",Pt)},this.send200Update=function(gt,ct,ht,it,ft,mt,Tt){lt.debug("WebRTC_Stack::send200Update()");var It,Pt=null;Tt!==null?(lt.log("call data is defined :"+Tt),Pt={type:"200update",callId:gt,callerId:ct,calleeId:ht,roomId:it,dst:ft,sdpanswer:mt,data:Tt}):(lt.log("call data is undefined"),Pt={type:"200update",callId:gt,callerId:ct,calleeId:ht,roomId:it,dst:ft,sdpanswer:mt}),It=JSON.stringify(Pt),lt.info("C->S: "+It),pt.emit("200update",It)},this.sendDebugCommand=function(gt,ct,ht){var it,ft;lt.debug("WebRTC_Stack::sendDebugCommand :"+gt),it={type:"debugCommand",command:gt,apiKey:ct,clientId:ht},ft=JSON.stringify(it),lt.info("C->S: "+ft),pt.emit("debugCommand",ft)},this.sendAck=function(gt,ct,ht){var it,ft;lt.debug("WebRTC_Stack::sendAck()"),it={type:"Ack",AckMessageType:gt,cSeq:ct,dst:ht},ft=JSON.stringify(it),lt.info("C->S: "+ft),pt.emit("Ack",ft)},this.sendInfo=function(gt,ct){var ht,it,ft=["activeSpeaker","callStats","stopSpeaking"];ft.indexOf(gt)<0&&lt.debug("WebRTC_Stack::sendInfo()"),ht={type:"info",infoType:gt,data:ct},it=JSON.stringify(ht),ft.indexOf(gt)<0&&lt.info("C->S: "+it),pt.emit("info",it)},this.sendDataMessage=function(gt,ct){lt.debug("WebRTC_Stack::sendDataMessage()");var ht={type:"apiRTCDataMessage",senderId:gt,data:ct},it=JSON.stringify(ht);lt.info("C->S: "+it),pt.emit("apiRTCDataMessage",it)}}},4170:(at,ut,s)=>{s.r(ut),s(4916),s(4723),s(3710),s(1539),s(9714),s(561),function(et){var ot,lt,St=null,pt=null,gt=[];function ct(){return Math.random().toString(36).substr(2)}ot=function(){if(typeof apiRTC_React<"u")return"react-native";var ht,it=navigator.appName,ft=navigator.userAgent,mt=ft.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return mt&&(ht=ft.match(/version\/([\.\d]+)/i))!==null&&(mt[2]=ht[1]),(mt=mt?[mt[1],mt[2]]:[it,navigator.appVersion,"-?"])[0]}(),lt=function(){if(typeof apiRTC_React<"u")return 1;var ht,it=navigator.appName,ft=navigator.userAgent,mt=ft.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return mt&&(ht=ft.match(/version\/([\.\d]+)/i))!==null&&(mt[2]=ht[1]),(mt=mt?[mt[1],mt[2]]:[it,navigator.appVersion,"-?"])[1]}(),pt=new function(){(ot==="MSIE"&&lt>8||ot==="Netscape")&&function(){function ht(it,ft){ft=ft||{bubbles:!1,cancelable:!1,detail:void 0};var mt=document.createEvent("CustomEvent");return mt.initCustomEvent(it,ft.bubbles,ft.cancelable,ft.detail),mt}ht.prototype=et.CustomEvent.prototype,et.CustomEvent=ht}(),this.eventDispatchMgr=function(ht,it){if(typeof apiRTC_React<"u"){var ft={type:ht,detail:it};eventManager.dispatchEvent(ft)}else if(ot==="MSIE"&&lt<=8)typeof $jqApz<"u"?$jqApz.event.trigger({type:ht,detail:it}):typeof jQuery<"u"&&jQuery.event.trigger({type:ht,detail:it});else{var mt=new CustomEvent(ht,{detail:it,bubbles:!0,cancelable:!0});document.dispatchEvent(mt)}},this.createGetUserFromIdAnswerEvent=function(ht){var it={eventType:"getUserFromIdAnswer",time:new Date,message:ht};this.eventDispatchMgr("getUserFromIdAnswer",it)},this.createGetAllUsersAnswerEvent=function(ht){var it={eventType:"getAllUsersAnswer",time:new Date,message:ht};this.eventDispatchMgr("getAllUsersAnswer",it)},this.createErrorEvent=function(ht){var it={eventType:"error :",time:new Date,errorInfo:ht};this.eventDispatchMgr("error",it)},this.createSearchUserAnswerEvent=function(ht,it,ft){var mt={eventType:"searchUserAnswer :",time:new Date,searchStr:ht,searchAnswerList:it,group:ft};this.eventDispatchMgr("searchUserAnswer",mt)}},(St={version:"1.0.4",description:"ApiRTC DataBase Library"}).init=function(ht){this.socket=ht,this.socket.on("getUserFromIdAnswer",this.callback(this,"onGetUserFromIdAnswer")).on("getAllUsersAnswer",this.callback(this,"onGetAllUsersAnswer")).on("searchUserAnswer",this.callback(this,"onSearchUserAnswer"))},St.createUser=function(ht){if(ht!==null&&ht.mail!==null&&ht.id!==null){var it=JSON.stringify(ht);this.socket.emit("createUser",it)}},St.searchUserInGroup=function(ht,it,ft,mt){var Tt=null,It=null,Pt=ct();(it===void 0||it!=="all"&&it!=="connected"&&it!=="disconnected")&&(it="all"),ht!==null&&(Tt={searchStr:ht,presenceState:it,group:ft},mt!==void 0&&(Tt.callbackId=Pt,gt[Pt]=mt),It=JSON.stringify(Tt),this.socket.emit("searchUser",It))},St.searchUser=function(ht,it,ft,mt){var Tt=null;typeof ft=="function"?(Tt=ft,St.searchUserInGroup(ht,it,void 0,Tt)):St.searchUserInGroup(ht,it,ft,mt)},St.onSearchUserAnswer=function(ht){var it=JSON.parse(ht);it.callbackId!==void 0&&it.callbackId in gt?(gt[it.callbackId](it.searchStr,it.searchAnswerList),gt.splice(it.callbackId,1)):pt.createSearchUserAnswerEvent(it.searchStr,it.searchAnswerList,it.group)},St.getUserFromId=function(ht,it){var ft=null,mt=null,Tt=ct();ht!==null&&(ft={id:ht},it!==void 0&&(ft.callbackId=Tt,gt[Tt]=it),mt=JSON.stringify(ft),this.socket.emit("getUserFromId",mt))},St.onGetUserFromIdAnswer=function(ht){ht!==null&&ht.callbackId!==void 0&&ht.callbackId in gt?(gt[ht.callbackId](ht),gt.splice(ht.callbackId,1)):pt.createGetUserFromIdAnswerEvent(ht)},St.getAllUsers=function(){var ht,it;ht={},it=JSON.stringify(ht),this.socket.emit("getAllUsers",it)},St.onGetAllUsersAnswer=function(ht){pt.createGetAllUsersAnswerEvent(ht)},St.setPresenceStatus=function(ht,it,ft){var mt,Tt;mt={id:ht,presenceStatus:it,commentStatus:ft},Tt=JSON.stringify(mt),this.socket.emit("setPresenceStatus",Tt)},St.setUserStatus=function(ht,it){var ft;it.id=ht,ft=JSON.stringify(it),this.socket.emit("setUserStatus",ft)},St.setUserInfos=function(ht){var it,ft;it=ht,ft=JSON.stringify(it),this.socket.emit("setUserInfos",ft)},St.addEventListener=function(ht,it){typeof apiRTC_React<"u"?eventManager.addEventListener(ht,it):ht!=="getUserFromIdAnswer"||ht!=="error"||ht!=="getAllUsersAnswer"||ht!=="searchUserAnswer"?document.addEventListener(ht,it,!1):pt.createErrorEvent("ERROR: Trying to add a listener on an unknow event")},St.callback=function(ht,it){return this.closureHandler=function(ft){return ht[it](ft)},this.closureHandler},et.apiDB=St}(window)},2746:(at,ut,s)=>{s.r(ut);var et=s(1549).Y.get("onbeforeunload");apiCC.beforeUnloadFct=function(ot){et.debug("User has refreshed or left the page, eventType :",ot);try{if(typeof mailClicked<"u"&&mailClicked!==null&&(et.log("mailClicked variable is defined"),mailClicked===!0))return et.log("mailClicked is true : leaving onbeforeunload"),void(mailClicked=!1)}catch(St){et.log("Catch error on PATCH/WORKAROUND to avoid reload of page in chrome when mailto :"+St)}try{if(apiCC.iePluginInstallationPreventUnload!==void 0&&apiCC.iePluginInstallationPreventUnload!==null&&apiCC.iePluginInstallationPreventUnload===!0)return void et.log("iePluginInstallationPreventUnload is true : leaving onbeforeunload")}catch(St){et.log("Catch error on PATCH/WORKAROUND to avoid reload of page in IE when installing webRTC plugin :"+St)}if(apiCC!=null){if(apiRTC.session!==null&&apiRTC.session.remoteAccessInvitation!==null){var lt;lt=apiRTC.session.remoteAccessInvitation.invitationType==="sent"?{code:"AGENT_LEFT"}:{code:"USER_LEFT"},et.debug("Stopping remote access on refresh"),apiRTC.session.remoteAccessInvitation.stop(!0,lt)}apiCC.storeSessionInfoInSessionStorage(),apiCC.cleanApiRTCContext(),apiCC.disconnect({invalidateApiCCId:!0}),apiCC.cleanAllEventListener(),apiCC.myEventTable=[]}apiCC!=null&&(apiCC.session=null,apiCC.jsLoaded=!1)},apiRTC.browser==="Mobile Safari"?window.addEventListener("pagehide",function(){apiCC.beforeUnloadFct("unload_MobileSafari")}):window.onbeforeunload=function(){apiCC.beforeUnloadFct("unload")}},9064:(at,ut,s)=>{function et(ot){return et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(lt){return typeof lt}:function(lt){return lt&&typeof Symbol=="function"&&lt.constructor===Symbol&&lt!==Symbol.prototype?"symbol":typeof lt},et(ot)}s(2222),s(2772),s(4916),s(3123),s(5306),s(2526),s(1817),s(1539),s(2165),s(6992),s(8783),s(3948),at=s.hmd(at),function(ot){var lt="function",St="undefined",pt="object",gt="string",ct="model",ht="name",it="type",ft="vendor",mt="version",Tt="architecture",It="console",Pt="mobile",At="tablet",Nt="smarttv",Ot="wearable",Mt="embedded",bt="Amazon",Wt="Apple",zt="ASUS",Bt="BlackBerry",rn="Google",gn="Huawei",tn="LG",Ht="Microsoft",fn="Motorola",bn="Samsung",In="Sharp",un="Sony",mn="Xiaomi",yn="Zebra",pn="Facebook",Tn="Chromium OS",kn="Mac OS",xn=function(Gn){for(var Yn={},or=0;or<Gn.length;or++)Yn[Gn[or].toUpperCase()]=Gn[or];return Yn},Mn=function(Gn,Yn){return et(Gn)===gt&&Dn(Yn).indexOf(Dn(Gn))!==-1},Dn=function(Gn){return Gn.toLowerCase()},An=function(Gn,Yn){if(et(Gn)===gt)return Gn=Gn.replace(/^\s\s*/,""),et(Yn)===St?Gn:Gn.substring(0,350)},Nn=function(Gn,Yn){for(var or,Bn,rr,Zn,_n,Ln,vn=0;vn<Yn.length&&!_n;){var On=Yn[vn],Kt=Yn[vn+1];for(or=Bn=0;or<On.length&&!_n&&On[or];)if(_n=On[or++].exec(Gn))for(rr=0;rr<Kt.length;rr++)Ln=_n[++Bn],et(Zn=Kt[rr])===pt&&Zn.length>0?Zn.length===2?et(Zn[1])==lt?this[Zn[0]]=Zn[1].call(this,Ln):this[Zn[0]]=Zn[1]:Zn.length===3?et(Zn[1])!==lt||Zn[1].exec&&Zn[1].test?this[Zn[0]]=Ln?Ln.replace(Zn[1],Zn[2]):void 0:this[Zn[0]]=Ln?Zn[1].call(this,Ln,Zn[2]):void 0:Zn.length===4&&(this[Zn[0]]=Ln?Zn[3].call(this,Ln.replace(Zn[1],Zn[2])):void 0):this[Zn]=Ln||void 0;vn+=2}},Un=function(Gn,Yn){for(var or in Yn)if(et(Yn[or])===pt&&Yn[or].length>0){for(var Bn=0;Bn<Yn[or].length;Bn++)if(Mn(Yn[or][Bn],Gn))return or==="?"?void 0:or}else if(Mn(Yn[or],Gn))return or==="?"?void 0:or;return Gn},Qn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},er={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[mt,[ht,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[mt,[ht,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[ht,mt],[/opios[\/ ]+([\w\.]+)/i],[mt,[ht,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[mt,[ht,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[ht,mt],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[mt,[ht,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[mt,[ht,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[mt,[ht,"WeChat"]],[/konqueror\/([\w\.]+)/i],[mt,[ht,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[mt,[ht,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[mt,[ht,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[ht,/(.+)/,"$1 Secure Browser"],mt],[/\bfocus\/([\w\.]+)/i],[mt,[ht,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[mt,[ht,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[mt,[ht,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[mt,[ht,"Dolphin"]],[/coast\/([\w\.]+)/i],[mt,[ht,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[mt,[ht,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[mt,[ht,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[ht,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[ht,/(.+)/,"$1 Browser"],mt],[/(comodo_dragon)\/([\w\.]+)/i],[[ht,/_/g," "],mt],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[ht,mt],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[ht],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[ht,pn],mt],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[ht,mt],[/\bgsa\/([\w\.]+) .*safari\//i],[mt,[ht,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[mt,[ht,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[mt,[ht,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[ht,"Chrome WebView"],mt],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[mt,[ht,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[ht,mt],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[mt,[ht,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[mt,ht],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[ht,[mt,Un,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[ht,mt],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[ht,"Netscape"],mt],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[mt,[ht,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[ht,mt],[/(cobalt)\/([\w\.]+)/i],[ht,[mt,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[Tt,"amd64"]],[/(ia32(?=;))/i],[[Tt,Dn]],[/((?:i[346]|x)86)[;\)]/i],[[Tt,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[Tt,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[Tt,"armhf"]],[/windows (ce|mobile); ppc;/i],[[Tt,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[Tt,/ower/,"",Dn]],[/(sun4\w)[;\)]/i],[[Tt,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[Tt,Dn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[ct,[ft,bn],[it,At]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[ct,[ft,bn],[it,Pt]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[ct,[ft,Wt],[it,Pt]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[ct,[ft,Wt],[it,At]],[/(macintosh);/i],[ct,[ft,Wt]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[ct,[ft,In],[it,Pt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[ct,[ft,gn],[it,At]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[ct,[ft,gn],[it,Pt]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[ct,/_/g," "],[ft,mn],[it,Pt]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[ct,/_/g," "],[ft,mn],[it,At]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[ct,[ft,"OPPO"],[it,Pt]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[ct,[ft,"Vivo"],[it,Pt]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[ct,[ft,"Realme"],[it,Pt]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[ct,[ft,fn],[it,Pt]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[ct,[ft,fn],[it,At]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[ct,[ft,tn],[it,At]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[ct,[ft,tn],[it,Pt]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[ct,[ft,"Lenovo"],[it,At]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[ct,/_/g," "],[ft,"Nokia"],[it,Pt]],[/(pixel c)\b/i],[ct,[ft,rn],[it,At]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[ct,[ft,rn],[it,Pt]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[ct,[ft,un],[it,Pt]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[ct,"Xperia Tablet"],[ft,un],[it,At]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[ct,[ft,"OnePlus"],[it,Pt]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[ct,[ft,bt],[it,At]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[ct,/(.+)/g,"Fire Phone $1"],[ft,bt],[it,Pt]],[/(playbook);[-\w\),; ]+(rim)/i],[ct,ft,[it,At]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[ct,[ft,Bt],[it,Pt]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[ct,[ft,zt],[it,At]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[ct,[ft,zt],[it,Pt]],[/(nexus 9)/i],[ct,[ft,"HTC"],[it,At]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[ft,[ct,/_/g," "],[it,Pt]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[ct,[ft,"Acer"],[it,At]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[ct,[ft,"Meizu"],[it,Pt]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[ft,ct,[it,Pt]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[ft,ct,[it,At]],[/(surface duo)/i],[ct,[ft,Ht],[it,At]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[ct,[ft,"Fairphone"],[it,Pt]],[/(u304aa)/i],[ct,[ft,"AT&T"],[it,Pt]],[/\bsie-(\w*)/i],[ct,[ft,"Siemens"],[it,Pt]],[/\b(rct\w+) b/i],[ct,[ft,"RCA"],[it,At]],[/\b(venue[\d ]{2,7}) b/i],[ct,[ft,"Dell"],[it,At]],[/\b(q(?:mv|ta)\w+) b/i],[ct,[ft,"Verizon"],[it,At]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[ct,[ft,"Barnes & Noble"],[it,At]],[/\b(tm\d{3}\w+) b/i],[ct,[ft,"NuVision"],[it,At]],[/\b(k88) b/i],[ct,[ft,"ZTE"],[it,At]],[/\b(nx\d{3}j) b/i],[ct,[ft,"ZTE"],[it,Pt]],[/\b(gen\d{3}) b.+49h/i],[ct,[ft,"Swiss"],[it,Pt]],[/\b(zur\d{3}) b/i],[ct,[ft,"Swiss"],[it,At]],[/\b((zeki)?tb.*\b) b/i],[ct,[ft,"Zeki"],[it,At]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[ft,"Dragon Touch"],ct,[it,At]],[/\b(ns-?\w{0,9}) b/i],[ct,[ft,"Insignia"],[it,At]],[/\b((nxa|next)-?\w{0,9}) b/i],[ct,[ft,"NextBook"],[it,At]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[ft,"Voice"],ct,[it,Pt]],[/\b(lvtel\-)?(v1[12]) b/i],[[ft,"LvTel"],ct,[it,Pt]],[/\b(ph-1) /i],[ct,[ft,"Essential"],[it,Pt]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[ct,[ft,"Envizen"],[it,At]],[/\b(trio[-\w\. ]+) b/i],[ct,[ft,"MachSpeed"],[it,At]],[/\btu_(1491) b/i],[ct,[ft,"Rotor"],[it,At]],[/(shield[\w ]+) b/i],[ct,[ft,"Nvidia"],[it,At]],[/(sprint) (\w+)/i],[ft,ct,[it,Pt]],[/(kin\.[onetw]{3})/i],[[ct,/\./g," "],[ft,Ht],[it,Pt]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[ct,[ft,yn],[it,At]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[ct,[ft,yn],[it,Pt]],[/smart-tv.+(samsung)/i],[ft,[it,Nt]],[/hbbtv.+maple;(\d+)/i],[[ct,/^/,"SmartTV"],[ft,bn],[it,Nt]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[ft,tn],[it,Nt]],[/(apple) ?tv/i],[ft,[ct,"Apple TV"],[it,Nt]],[/crkey/i],[[ct,"Chromecast"],[ft,rn],[it,Nt]],[/droid.+aft(\w)( bui|\))/i],[ct,[ft,bt],[it,Nt]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[ct,[ft,In],[it,Nt]],[/(bravia[\w ]+)( bui|\))/i],[ct,[ft,un],[it,Nt]],[/(mitv-\w{5}) bui/i],[ct,[ft,mn],[it,Nt]],[/Hbbtv.*(technisat) (.*);/i],[ft,ct,[it,Nt]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[ft,An],[ct,An],[it,Nt]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[it,Nt]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[ft,ct,[it,It]],[/droid.+; (shield) bui/i],[ct,[ft,"Nvidia"],[it,It]],[/(playstation [345portablevi]+)/i],[ct,[ft,un],[it,It]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[ct,[ft,Ht],[it,It]],[/((pebble))app/i],[ft,ct,[it,Ot]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[ct,[ft,Wt],[it,Ot]],[/droid.+; (glass) \d/i],[ct,[ft,rn],[it,Ot]],[/droid.+; (wt63?0{2,3})\)/i],[ct,[ft,yn],[it,Ot]],[/(quest( 2| pro)?)/i],[ct,[ft,pn],[it,Ot]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[ft,[it,Mt]],[/(aeobc)\b/i],[ct,[ft,bt],[it,Mt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[ct,[it,Pt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[ct,[it,At]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[it,At]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[it,Pt]],[/(android[-\w\. ]{0,9});.+buil/i],[ct,[ft,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[mt,[ht,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[mt,[ht,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[ht,mt],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[mt,ht]],os:[[/microsoft (windows) (vista|xp)/i],[ht,mt],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[ht,[mt,Un,Qn]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[ht,"Windows"],[mt,Un,Qn]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[mt,/_/g,"."],[ht,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[ht,kn],[mt,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[mt,ht],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[ht,mt],[/\(bb(10);/i],[mt,[ht,Bt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[mt,[ht,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[mt,[ht,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[mt,[ht,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[mt,[ht,"watchOS"]],[/crkey\/([\d\.]+)/i],[mt,[ht,"Chromecast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[ht,Tn],mt],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[ht,mt],[/(sunos) ?([\w\.\d]*)/i],[[ht,"Solaris"],mt],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[ht,mt]]},zn=function Gn(Yn,or){if(et(Yn)===pt&&(or=Yn,Yn=void 0),!(this instanceof Gn))return new Gn(Yn,or).getResult();var Bn=et(ot)!==St&&ot.navigator?ot.navigator:void 0,rr=Yn||(Bn&&Bn.userAgent?Bn.userAgent:""),Zn=Bn&&Bn.userAgentData?Bn.userAgentData:void 0,_n=or?function(vn,On){var Kt={};for(var Rt in vn)On[Rt]&&On[Rt].length%2==0?Kt[Rt]=On[Rt].concat(vn[Rt]):Kt[Rt]=vn[Rt];return Kt}(er,or):er,Ln=Bn&&Bn.userAgent==rr;return this.getBrowser=function(){var vn,On={name:void 0,version:void 0};return Nn.call(On,rr,_n.browser),On.major=et(vn=On.version)===gt?vn.replace(/[^\d\.]/g,"").split(".")[0]:void 0,Ln&&Bn&&Bn.brave&&et(Bn.brave.isBrave)==lt&&(On.name="Brave"),On},this.getCPU=function(){var vn={architecture:void 0};return Nn.call(vn,rr,_n.cpu),vn},this.getDevice=function(){var vn={vendor:void 0,model:void 0,type:void 0};return Nn.call(vn,rr,_n.device),Ln&&!vn.type&&Zn&&Zn.mobile&&(vn.type=Pt),Ln&&vn.model=="Macintosh"&&Bn&&et(Bn.standalone)!==St&&Bn.maxTouchPoints&&Bn.maxTouchPoints>2&&(vn.model="iPad",vn.type=At),vn},this.getEngine=function(){var vn={name:void 0,version:void 0};return Nn.call(vn,rr,_n.engine),vn},this.getOS=function(){var vn={name:void 0,version:void 0};return Nn.call(vn,rr,_n.os),Ln&&!vn.name&&Zn&&Zn.platform!="Unknown"&&(vn.name=Zn.platform.replace(/chrome os/i,Tn).replace(/macos/i,kn)),vn},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return rr},this.setUA=function(vn){return rr=et(vn)===gt&&vn.length>350?An(vn,350):vn,this},this.setUA(rr),this};zn.VERSION="1.0.35",zn.BROWSER=xn([ht,mt,"major"]),zn.CPU=xn([Tt]),zn.DEVICE=xn([ct,ft,it,It,Pt,Nt,At,Ot,Mt]),zn.ENGINE=zn.OS=xn([ht,mt]),et(o)!==St?(et(at)!==St&&at.exports&&(o=at.exports=zn),o.UAParser=zn,ot.UAParser=zn):et(ot)!==St&&(ot.UAParser=zn);var lr=et(ot)!==St&&(ot.jQuery||ot.Zepto);if(lr&&!lr.ua){var cn=new zn;lr.ua=cn.getResult(),lr.ua.get=function(){return cn.getUA()},lr.ua.set=function(Gn){cn.setUA(Gn);var Yn=cn.getResult();for(var or in Yn)lr.ua[or]=Yn[or]}}}((typeof window>"u"?"undefined":et(window))==="object"?window:void 0)},1256:(at,ut,s)=>{s.r(ut),s.d(ut,{Call:()=>Qr,CloudApi:()=>cp,Conference:()=>Fs,Contact:()=>No,Conversation:()=>jo,ConversationCall:()=>Gl,DataChannel:()=>ys,Enterprise:()=>Xs,EventCenter:()=>Mt,EventEmitter:()=>pt,MediaDevice:()=>zt,Observable:()=>fn,PointerSharingRoom:()=>ru,ReceivedCallInvitation:()=>Er,ReceivedConversationInvitation:()=>$t,ReceivedConversationJoinRequest:()=>Ho,ReceivedDataChannelInvitation:()=>zo,ReceivedFileTransferInvitation:()=>eo,ReceivedInvitation:()=>On,ReceivedPointerSharingInvitation:()=>xl,ReceivedWhiteboardInvitation:()=>vs,SentInvitation:()=>Do,Session:()=>Br,Stream:()=>so,UserAgent:()=>sp,UserData:()=>Io,default:()=>wm}),s(7941),s(2526),s(1817),s(1539),s(2165),s(6992),s(8783),s(3948);var et=s(3173);function ot(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function lt(jt){return lt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},lt(jt)}function St(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}s(4603),s(4916),s(9714),s(7042),s(561),s(9070),s(8309),s(1038),s(9753);var pt=function(){function jt(){(function(kt,Ft){if(!(kt instanceof Ft))throw new TypeError("Cannot call a class as a function")})(this,jt)}var Ut,Xt;return Ut=jt,Xt=[{key:"getListeners",value:function(kt){var Ft,sn,ln=this._getEvents();if(kt instanceof RegExp)for(sn in Ft={},ln)ln.hasOwnProperty(sn)&&kt.test(sn)&&(Ft[sn]=ln[sn]);else Ft=ln[kt]||(ln[kt]=[]);return Ft}},{key:"flattenListeners",value:function(kt){var Ft,sn=[];for(Ft=0;Ft<kt.length;Ft+=1)sn.push(kt[Ft].listener);return sn}},{key:"getListenersAsObject",value:function(kt){var Ft,sn=this.getListeners(kt);return sn instanceof Array&&((Ft={})[kt]=sn),Ft||sn}},{key:"emit",value:function(kt){var Ft=Array.prototype.slice.call(arguments,1);return this.emitEvent(kt,Ft)}},{key:"addListener",value:function(kt,Ft){if(!it(Ft))throw new TypeError("listener must be a function");var sn,ln=this.getListenersAsObject(kt),Yt=lt(Ft)==="object";for(sn in ln)ln.hasOwnProperty(sn)&&ct(ln[sn],Ft)===-1&&ln[sn].push(Yt?Ft:{listener:Ft,once:!1});if(kt==="contactListUpdate"){apiRTC.userAgentInstance.currentSession.contactListUpdateListenerSetted=!0;var dt,vt=function(Gt,Qt){var Zt=typeof Symbol<"u"&&Gt[Symbol.iterator]||Gt["@@iterator"];if(!Zt){if(Array.isArray(Gt)||(Zt=function(dr,hr){if(dr){if(typeof dr=="string")return ot(dr,hr);var Mr=Object.prototype.toString.call(dr).slice(8,-1);return Mr==="Object"&&dr.constructor&&(Mr=dr.constructor.name),Mr==="Map"||Mr==="Set"?Array.from(dr):Mr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Mr)?ot(dr,hr):void 0}}(Gt))||Qt&&Gt&&typeof Gt.length=="number"){Zt&&(Gt=Zt);var an=0,Cn=function(){};return{s:Cn,n:function(){return an>=Gt.length?{done:!0}:{done:!1,value:Gt[an++]}},e:function(dr){throw dr},f:Cn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Rn,Kn=!0,Xn=!1;return{s:function(){Zt=Zt.call(Gt)},n:function(){var dr=Zt.next();return Kn=dr.done,dr},e:function(dr){Xn=!0,Rn=dr},f:function(){try{Kn||Zt.return==null||Zt.return()}finally{if(Xn)throw Rn}}}}(apiRTC.userAgentInstance.currentSession.waitingContactListUpdateEvent);try{for(vt.s();!(dt=vt.n()).done;){var Dt=dt.value;this.emit("contactListUpdate",Dt)}}catch(Gt){vt.e(Gt)}finally{vt.f()}apiRTC.userAgentInstance.currentSession.waitingContactListUpdateEvent=[]}else if(kt==="mediaDeviceChanged"&&apiRTC.mediaDeviceMgr.mediaDeviceChangedDetected===!0){var Vt=apiRTC.mediaDeviceMgr.getMediaDeviceListsDiff(apiRTC.mediaDeviceMgr.mediaDeviceSourceInfosArray,apiRTC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources);apiRTC.myWebRTC_Event.createMediaDeviceChangedEvent(Vt,"updatedOnDeviceChange",apiRTC.mediaDeviceMgr.realMediaDevicesListInitializationWasAlreadyDone)}return this}},{key:"addOnceListener",value:function(kt,Ft){return this.addListener(kt,{listener:Ft,once:!0})}},{key:"defineEvent",value:function(kt){return this.getListeners(kt),this}},{key:"defineEvents",value:function(kt){for(var Ft=0;Ft<kt.length;Ft+=1)this.defineEvent(kt[Ft]);return this}},{key:"removeListener",value:function(kt,Ft){var sn,ln,Yt=this.getListenersAsObject(kt);for(ln in Yt)Yt.hasOwnProperty(ln)&&(sn=ct(Yt[ln],Ft))!==-1&&Yt[ln].splice(sn,1);return this}},{key:"addListeners",value:function(kt,Ft){return this.manipulateListeners(!1,kt,Ft)}},{key:"removeListeners",value:function(kt,Ft){return this.manipulateListeners(!0,kt,Ft)}},{key:"manipulateListeners",value:function(kt,Ft,sn){var ln,Yt,dt=kt?this.removeListener:this.addListener,vt=kt?this.removeListeners:this.addListeners;if(lt(Ft)!=="object"||Ft instanceof RegExp)for(ln=sn.length;ln--;)dt.call(this,Ft,sn[ln]);else for(ln in Ft)Ft.hasOwnProperty(ln)&&(Yt=Ft[ln])&&(typeof Yt=="function"?dt.call(this,ln,Yt):vt.call(this,ln,Yt));return this}},{key:"removeEvent",value:function(kt){var Ft,sn=lt(kt),ln=this._getEvents();if(sn==="string")delete ln[kt];else if(kt instanceof RegExp)for(Ft in ln)ln.hasOwnProperty(Ft)&&kt.test(Ft)&&delete ln[Ft];else delete this._events;return this}},{key:"emitEvent",value:function(kt,Ft){var sn,ln,Yt,dt,vt=this.getListenersAsObject(kt);for(dt in vt)if(vt.hasOwnProperty(dt))for(sn=vt[dt].slice(0),Yt=0;Yt<sn.length;Yt++)(ln=sn[Yt]).once===!0&&this.removeListener(kt,ln.listener),ln.listener.apply(this,Ft||[])===this._getOnceReturnValue()&&this.removeListener(kt,ln.listener);return this}},{key:"setOnceReturnValue",value:function(kt){return this._onceReturnValue=kt,this}},{key:"_getOnceReturnValue",value:function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue}},{key:"_getEvents",value:function(){return this._events||(this._events={})}}],Xt&&St(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}(),gt=pt.prototype,ct=function(jt,Ut){for(var Xt=jt.length;Xt--;)if(jt[Xt].listener===Ut)return Xt;return-1},ht=function(jt){return function(){return this[jt].apply(this,arguments)}},it=function jt(Ut){return typeof Ut=="function"||Ut instanceof RegExp||!(!Ut||lt(Ut)!=="object")&&jt(Ut.listener)};gt.on=ht("addListener"),gt.once=ht("addOnceListener"),gt.off=ht("removeListener"),gt.removeAllListeners=ht("removeEvent"),gt.trigger=ht("emitEvent"),s(1249);var ft=s(5945),mt=s(1549),Tt=s(4708);mt.Y.get("ApiCC");var It={description:"ApiRTC Cloud Communication Library",session:null,jsLoaded:!1,initApiKey:null,initApiCCId:null,extJsLoadingRetryNb:null,extJsLoadingRetryDelay:null,bandwidthTestServer:"https://cloud.apizee.com",bandwidthRatingThresholds:[300,500,1e3,1500,2e3],LOG_LEVEL_OFF:0,LOG_LEVEL_ERROR:1,LOG_LEVEL_WARN:2,LOG_LEVEL_INFO:3,LOG_LEVEL_DEBUG:4,LOG_LEVEL_TRACE:5,browser:ft.Xh,browser_major_version:ft.PR,browser_version:ft.dc,osName:ft.BF,osVersion:ft.MM,osUAParser:ft.ag,browserInfo:ft.cf,browserDetails:Tt.wL,parser:ft.E2,logStorageActivated:!1,logStorageLevel:3,logStorage:[],eventCenter:null,sioEmbedded:!1,apizee_version:"5.0"};function Pt(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}var At=mt.Y.get("EventCenter"),Nt="eventCenterData",Ot="[REMOTE-EVENTCENTER]",Mt=function(){function jt(){var kt=this;(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")})(this,jt),this.consoleOutputEnabled=!1,this.storageDisabled=!1,typeof apiRTC_React>"u"&&(document.addEventListener("error",function(Ft){kt.handleErrorEvent(Ft)}),document.addEventListener("userMediaError",function(Ft){kt.handleErrorEvent(Ft)}))}var Ut,Xt;return Ut=jt,Xt=[{key:"handleErrorEvent",value:function(kt){var Ft=kt.detail;if(this.storageDisabled!==!0)if(Ft!==void 0){var sn={},ln={},Yt="UNKNOWN";sn.type=kt.type;for(var dt=0,vt=Object.keys(Ft);dt<vt.length;dt++){var Dt=vt[dt];Dt!=="eventType"&&(sn[Dt]=Ft[Dt])}sn.systemInfo={apiRTC:It.version,app:ft.$6,device:ft.vO,osName:ft.BF,osVersion:ft.MM,browser:ft.Xh,browser_version:ft.dc},It.session!==null&&It.session!==void 0?Yt=It.session.apiCCId:It.initApiCCId!==null&&It.initApiCCId!==void 0&&(Yt=It.initApiCCId),sn.userInfo={apiCCId:Yt,apiKey:apiRTC.initApiKey};var Vt=localStorage.getItem(Nt);(Vt=Vt?JSON.parse(Vt):[]).unshift(sn),Vt.length>100&&Vt.splice(100,Vt.length-100),localStorage.setItem(Nt,JSON.stringify(Vt)),this.consoleOutputEnabled&&At.error("[EVENTCENTER]",sn),typeof Sentry<"u"&&(kt.detail.errorCode!=="USER_MEDIA_ERROR"?(ln.type=kt.type,kt.detail.error&&(ln.error=kt.detail.error),kt.detail.errorInfo&&(ln.errorInfo=kt.detail.errorInfo),kt.detail.errorCode&&(ln.errorCode=kt.detail.errorCode),kt.detail.callId&&(ln.callId=kt.detail.callId),kt.detail.convId&&(ln.convId=kt.detail.convId),kt.detail.gumConfig&&(kt.detail.gumConfig.video===!1?ln.gumConfigVideo=!1:ln.gumConfigVideo=!0),Sentry.withScope(function(Gt){Gt.setTag("event-center",!0),Gt.setTag("userId",It.session.apiCCId),Sentry.captureException(new Error(JSON.stringify(ln)))})):At.debug("Filtering error event for USER_MEDIA_ERROR for Sentry"))}else At.error("Can't handle error event: data is undefined");else At.debug("Event Center is disabled")}},{key:"handleDataAnswer",value:function(kt){kt?kt.map(function(Ft){At.debug(Ot+": ",Ft)}):At.debug(Ot+": "+this.getUsername()+" has no event records")}},{key:"getStoredData",value:function(){var kt=localStorage.getItem(Nt);return kt===void 0?(At.warn("No data was stored by event center"),null):JSON.parse(kt)}},{key:"clearStoredData",value:function(){localStorage.removeItem(Nt)}},{key:"enableConsoleOutput",value:function(kt){this.consoleOutputEnabled=kt}},{key:"disableStorage",value:function(kt){this.storageDisabled=kt}}],Xt&&Pt(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}();function bt(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}s(3710);var Wt=mt.Y.get("MediaDevice"),zt=function(){function jt(kt,Ft,sn,ln){(function(Yt,dt){if(!(Yt instanceof dt))throw new TypeError("Cannot call a class as a function")})(this,jt),Wt.trace("Create "+Ft+" MediaDevice"),this.id=kt,this.type=Ft,this.label=sn,this.capabilities=ln}var Ut,Xt;return Ut=jt,(Xt=[{key:"getId",value:function(){return this.id.toString()}},{key:"getType",value:function(){return this.type}},{key:"getLabel",value:function(){return this.label}},{key:"isCamera",value:function(){return this.type==="videoinput"}},{key:"isMicrophone",value:function(){return this.type==="audioinput"}},{key:"isAudioOutput",value:function(){return this.type==="audiooutput"}},{key:"getCapabilities",value:function(){return this.capabilities}}])&&bt(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}(),Bt=(s(1532),s(4129),s(9653),s(4363),s(2772),s(9554),s(4747),s(8674),s(9575),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(2707),s(2564),s(7327),s(9600),s(285),s(1637),s(2479),s(4812),s(2222),s(1058),s(6755),s(4986),s(8304),s(489),s(2419),s(8011),s(2443),s(3680),s(3706),s(2703),s(4819),s(5003),s(1215));function rn(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function gn(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}var tn=new WeakMap,Ht=new WeakMap,fn=function(){function jt(Ft){(function(sn,ln){if(!(sn instanceof ln))throw new TypeError("Cannot call a class as a function")})(this,jt),Ht.set(this,Ft),tn.set(this,new pt)}var Ut,Xt,kt;return Ut=jt,kt=[{key:"getAvailableEvents",value:function(){return[]}}],(Xt=[{key:"on",value:function(Ft,sn){return this.constructor.getAvailableEvents().indexOf(Ft)>-1?tn.get(this).on(Ft,sn):Ht.get(this).error("No such event "+Ft),this}},{key:"removeListener",value:function(Ft,sn){if(this.constructor.getAvailableEvents().indexOf(Ft)>-1){var ln,Yt=!1,dt=function(vt,Dt){var Vt=typeof Symbol<"u"&&vt[Symbol.iterator]||vt["@@iterator"];if(!Vt){if(Array.isArray(vt)||(Vt=function(Rn,Kn){if(Rn){if(typeof Rn=="string")return rn(Rn,Kn);var Xn=Object.prototype.toString.call(Rn).slice(8,-1);return Xn==="Object"&&Rn.constructor&&(Xn=Rn.constructor.name),Xn==="Map"||Xn==="Set"?Array.from(Rn):Xn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Xn)?rn(Rn,Kn):void 0}}(vt))||Dt&&vt&&typeof vt.length=="number"){Vt&&(vt=Vt);var Gt=0,Qt=function(){};return{s:Qt,n:function(){return Gt>=vt.length?{done:!0}:{done:!1,value:vt[Gt++]}},e:function(Rn){throw Rn},f:Qt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Zt,an=!0,Cn=!1;return{s:function(){Vt=Vt.call(vt)},n:function(){var Rn=Vt.next();return an=Rn.done,Rn},e:function(Rn){Cn=!0,Zt=Rn},f:function(){try{an||Vt.return==null||Vt.return()}finally{if(Cn)throw Zt}}}}(tn.get(this).getListeners(Ft));try{for(dt.s();!(ln=dt.n()).done;)if(ln.value.listener===sn){Yt=!0;break}}catch(vt){dt.e(vt)}finally{dt.f()}Yt?tn.get(this).off(Ft,sn):Ht.get(this).trace("removeListener() - No such listener for event "+Ft)}else Ht.get(this).error("No such event "+Ft);return this}}])&&gn(Ut.prototype,Xt),kt&&gn(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}();function bn(jt,Ut){var Xt=typeof Symbol<"u"&&jt[Symbol.iterator]||jt["@@iterator"];if(!Xt){if(Array.isArray(jt)||(Xt=function(dt,vt){if(dt){if(typeof dt=="string")return In(dt,vt);var Dt=Object.prototype.toString.call(dt).slice(8,-1);return Dt==="Object"&&dt.constructor&&(Dt=dt.constructor.name),Dt==="Map"||Dt==="Set"?Array.from(dt):Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt)?In(dt,vt):void 0}}(jt))||Ut&&jt&&typeof jt.length=="number"){Xt&&(jt=Xt);var kt=0,Ft=function(){};return{s:Ft,n:function(){return kt>=jt.length?{done:!0}:{done:!1,value:jt[kt++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Yt=!1;return{s:function(){Xt=Xt.call(jt)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Yt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Yt)throw sn}}}}function In(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function un(jt){return un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},un(jt)}function mn(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}s(6699),s(2023),s(3843);var yn=mt.Y.get("ApiRTCManager"),pn=["sessionReady","incomingCall","callEstablished","userMediaSuccess","userMediaStop","userMediaError","callRestarting","error","receiveIMMessage","updatePresence","webRTCClientCreated","updateUserStatus","channelEvent","groupChatCreation","groupChatInvitation","groupChatMemberUpdate","addUserInGroupChatAnswer","receiveGroupChatMessage","userDataAnswer","fetchUserDataAnswer","receiveConversationList","receiveConversationHistory","receiveConversationDetailReport","receiveContactOccurrencesFromConversationList","receiveMCUSessionInvitation","MCUSessionCreation","MCUAvailableStream","MCUAvailableStreamUpdate","MCURemoveStream","canPlayRemoteVideo","recordedFileAvailable","receiveData","roomCreation","roomJoined","roomInvitation","roomMemberUpdate","receiveRoomMessage","contactListInRoom","snapShotPhotoUploaded","stopRecord","callAttempt","joinMCUSessionAnswer","hangup","desktopCapture","remoteStreamAdded","remoteStreamRemoved","switchStream","sendDataChannelOpen","sendDataChannelClose","sendDataChannelError","receiveDataChannelOpen","receiveDataChannelClose","receiveDataChannelError","connectedUsersListUpdate","onFileSended","onFileSending","onFileReceiving","onFileReceived","onFileProgress","onFilePending","recordedStreamsAvailable","closingWhiteBoard","webRTCPluginInstallation","onQosStatsUpdate","onQosChange","onQosAudioChange","onQosVideoChange","MCURecordedStreamsAvailable","MCURecordingStarted","MCURecordingStopped","ICECandidateTypeUpdate","disconnectionWarning","MCUAvailableComposite","MCUParticipantEjected","MCUStreamingStarted","MCUStreamingStopped","MCUAvailableReplay","MCURoomModeChanged","onCallStatsUpdate","slowLink","localStreamUpdated","remoteStreamUpdated","audioAmplitude","videoQualityChanged","cpuLimited","bandwidthLimited","simulcastFeedChanged","cloudEventOccurred","groupUnsubscribed","transferBegun","transferProgress","transferEnded"],Tn=null,kn=!1,xn=!1,Mn=function(jt){if(Tn!==null&&Tn.isInitialized()){if(jt==="groupUnsubscribed"||jt==="transferBegun"||jt==="transferProgress"||jt==="transferEnded")return;apiRTC.addEventListener(jt,function(Ut){yn.trace("Emiting "+jt,Ut),Tn.eventEmitter.emit(jt,Ut)})}},Dn=function(jt){Tn!==null&&Tn.isInitialized()&&apiRTC.removeEventListener(jt,function(Ut){yn.trace("Emiting "+jt,Ut),Tn.eventEmitter.emit(jt,Ut)})},An=function(){function jt(){if(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")}(this,jt),Tn!==null)throw"Cannot construct singleton ApiRTCManager";this.eventEmitter=new pt,this.apiRTCSession=null,this.whiteBoardClient=null,this.pointerSharingClient=null,this.webRTCClient=null,this.dataClient=null,this.IMClient=null,this.contactDisconnectionDelay=et.g.CONTACT_DISCONNECTION_DELAY,Tn=this}var Ut,Xt,kt;return Ut=jt,Xt=[{key:"onEvent",value:function(Ft,sn){return pn.indexOf(Ft)>-1?this.eventEmitter.on(Ft,sn):yn.error("No such apiRTC event "+Ft),this}},{key:"onceEvent",value:function(Ft,sn){pn.indexOf(Ft)>-1?this.eventEmitter.once(Ft,sn):yn.error("No such apiRTC event "+Ft)}},{key:"sendData",value:function(Ft,sn){var ln=this;return new Promise(function(Yt,dt){ln.dataClient===null?dt(et.g.ERROR_APIRTC_INITIALISATION_FAILED):ln.dataClient.sendData(Ft,sn,function(vt){var Dt=et.g.ERROR_OTHER;vt!=null?vt.reason!=="timeoutReached"&&vt.reason!=="destNotFound"?Yt():(vt.reason==="timerReached"?Dt=et.g.ERROR_TIMED_OUT:vt.reason==="destNotFound"&&(Dt=et.g.ERROR_NOT_FOUND),dt(Dt)):dt(Dt)})})}},{key:"sendMessage",value:function(Ft,sn){var ln=this,Yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(dt,vt){ln.IMClient===null?vt(et.g.ERROR_APIRTC_INITIALISATION_FAILED):ln.IMClient.sendMessage(Ft,sn,function(Dt){var Vt=et.g.ERROR_OTHER;Dt!=null?Dt.reason!=="timeoutReached"&&Dt.reason!=="destNotFound"?dt(Dt.UUCSeq):(Dt.reason==="timerReached"?Vt=et.g.ERROR_TIMED_OUT:Dt.reason==="destNotFound"&&(Vt=et.g.ERROR_NOT_FOUND),vt(Vt)):vt(Vt)},Yt)})}},{key:"joinGroupChat",value:function(Ft){var sn=this;return new Promise(function(ln,Yt){if(sn.IMClient===null)return Yt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"joinGroupChat() - cannot join group chat"));sn.IMClient.joinGroupChat(Ft),ln()})}},{key:"leaveGroupChat",value:function(Ft){var sn=this;return new Promise(function(ln,Yt){if(sn.IMClient===null)return Yt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"leaveGroupChat() - cannot leave group chat"));sn.IMClient.leaveGroupChat(Ft),ln()})}},{key:"sendMessageToGroupChat",value:function(Ft,sn){var ln=this,Yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(dt,vt){if(ln.IMClient===null)vt(et.g.ERROR_APIRTC_INITIALISATION_FAILED);else{var Dt={};Bt.g.isTypeof(Yt,"metadata","object")&&(Dt.metadata=Yt.metadata),ln.IMClient.sendMessageToGroupChat(Ft,sn,function(Vt){return Vt!==null&&un(Vt)==="object"?Vt.reason==="ack"?dt(Vt.UUCSeq):Vt.reason==="timeoutReached"?vt(et.g.ERROR_TIMED_OUT):Vt.reason==="destNotFound"?vt(et.g.ERROR_NOT_FOUND):vt(et.g.ERROR_OTHER):vt(et.g.ERROR_OTHER)},Dt)}})}},{key:"removeEventListener",value:function(Ft,sn){sn!=null&&(pn.indexOf(Ft)>-1?this.eventEmitter.off(Ft,sn):yn.error("No such apiRTC event "+Ft))}},{key:"isInitialized",value:function(){return kn}},{key:"unsubscribeToPresenceGroup",value:function(Ft){this.apiRTCSession!==null?(this.apiRTCSession.unsubscribePresenceGroup([Ft]),Tn.eventEmitter.emit("groupUnsubscribed",Ft)):yn.error("apiRTC session is not initialized")}},{key:"joinAndSubscribeToPresenceGroup",value:function(Ft){this.apiRTCSession!==null?(this.apiRTCSession.joinPresenceGroup([Ft]),this.apiRTCSession.subscribePresenceGroup([Ft])):yn.error("apiRTC session is not initialized")}},{key:"leaveAndUnsubscribeToPresenceGroup",value:function(Ft){this.apiRTCSession!==null?(this.apiRTCSession.leavePresenceGroup([Ft]),this.unsubscribeToPresenceGroup(Ft)):yn.error("apiRTC session is not initialized")}},{key:"subscribeToCloudEvent",value:function(Ft,sn){this.apiRTCSession?this.apiRTCSession.subscribeToCloudEvent(Ft,sn):yn.error("apiRTC session is not initialized")}},{key:"unsubscribeToCloudEvent",value:function(Ft,sn){this.apiRTCSession?this.apiRTCSession.unsubscribeToCloudEvent(Ft,sn):yn.error("apiRTC session is not initialized")}},{key:"disconnect",value:function(){var Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(apiRTC.disconnect(Ft),kn=!1,this.apiRTCSession=null,this.webRTCClient=null,this.dataClient=null,this.IMClient=null,xn){var sn,ln=bn(pn);try{for(ln.s();!(sn=ln.n()).done;){var Yt=sn.value;Dn(Yt)}}catch(dt){ln.e(dt)}finally{ln.f()}xn=!1}}},{key:"initializeApiRTC",value:function(Ft){return yn.info("initializeApiRTC()"),new Promise(function(sn,ln){if(Ft===void 0||Ft.apiKey===void 0)ln("Invalid apiRTC initialization params");else{var Yt=function(dt){switch(yn.debug("onChannelEventDuringInit()",dt.detail),dt.detail.channelEvent){case"onChannelError":ln("Channel Error : "+dt.detail.event);break;case"onChannelConnectError":ln("Channel Connect Error : "+dt.detail.event);break;case"onChannelOpened":yn.debug("onChannelOpened");break;default:yn.debug("Unhandle case in onChannelEventDuringInit :",dt.detail.channelEvent)}};apiRTC.addEventListener("channelEvent",Yt),Ft.onReady=function(){if(kn=!0,Tn.webRTCClient=apiRTC.session.createWebRTCClient({}),Tn.webRTCClient.setMCUConnector(Ft.hasOwnProperty("mcu")?Ft.mcu:et.g.DEFAULT_MCU),Bt.g.isPropertyTypeof(Ft,"turnServerAddress","string")&&Tn.webRTCClient.setClientTurnServer(Ft.turnServerAddress),Tn.webRTCClient.setUserAcceptOnIncomingCallBeforeGetUserMedia(!0),Bt.g.isPropertyTypeof(Ft,"userAcceptOnIncomingDataCall","boolean")?Tn.webRTCClient.setUserAcceptOnIncomingDataCall(Ft.userAcceptOnIncomingDataCall):Tn.webRTCClient.setUserAcceptOnIncomingDataCall(!0),Bt.g.isPropertyTypeof(Ft,"userAcceptOnIncomingScreenSharingCall","boolean")?Tn.webRTCClient.setUserAcceptOnIncomingScreenSharingCall(Ft.userAcceptOnIncomingScreenSharingCall):Tn.webRTCClient.setUserAcceptOnIncomingScreenSharingCall(!1),Tn.dataClient=apiRTC.session.createDataClient(),Tn.IMClient=apiRTC.session.createIMClient(),Tn.pointerSharingClient=apiRTC.session.createPointerSharingClient(),Tn.webRTCClient.setAllowMultipleCalls(!0),Tn.apiRTCSession=apiRTC.session,!xn){var dt,vt=bn(pn);try{for(vt.s();!(dt=vt.n()).done;){var Dt=dt.value;Mn(Dt)}}catch(Vt){vt.e(Vt)}finally{vt.f()}xn=!0}apiRTC.removeEventListener("channelEvent",Yt),sn(apiRTC.session.apiCCId)},kn=!1,Tn.apiRTCSession=null,Tn.webRTCClient=null,Tn.dataClient=null,Tn.IMClient=null,apiRTC.init(Ft)}})}},{key:"createWhiteBoard",value:function(){yn.debug("createWhiteBoard()"),Tn.whiteBoardClient=apiRTC.createWhiteBoard(null,"invisible",null,6e4)}},{key:"getMediaDevices",value:function(){return yn.debug("ApiRTCManager::getMediaDevices()"),new Promise(function(Ft,sn){apiRTC.getMediaDevices().then(function(ln){yn.debug("ApiRTCManager::getMediaDevices(), sources :",ln),Ft(ln)}).catch(function(ln){var Yt="getMediaDevices() - error";yn.error(Yt,ln),sn(new Error(Yt))})})}},{key:"getUserMedia",value:function(Ft){return new Promise(function(sn,ln){apiRTC.getUserMedia(Ft).then(function(Yt){yn.debug("ApiRTCManager::getUserMedia() success"),sn(Yt)}).catch(function(Yt){yn.error("ApiRTCManager::getUserMedia() - Could not get user media :",Yt),ln(new Error("ApiRTCManager::getUserMedia() - Could not get user media :"+Yt))})})}},{key:"setAudioSourceIdInConstraint",value:function(Ft,sn){return apiRTC.setAudioSourceIdInConstraint(Ft,sn)}},{key:"setVideoSourceIdInConstraint",value:function(Ft,sn){return apiRTC.setVideoSourceIdInConstraint(Ft,sn)}},{key:"attachMediaStream",value:function(Ft,sn){apiRTC.attachMediaStream(Ft,sn)}},{key:"addStreamInDiv",value:function(Ft,sn,ln,Yt,dt,vt,Dt){apiRTC.addStreamInDiv(Ft,sn,ln,Yt,dt,vt,Dt)}},{key:"removeElementFromDiv",value:function(Ft,sn){yn.debug("removeElementFromDiv"),apiRTC.removeElementFromDiv(Ft,sn)}},{key:"getClientId",value:function(){return this.apiRTCSession!==null&&this.apiRTCSession.apiCCWebRTCClient!==null?this.apiRTCSession.apiCCWebRTCClient.webRTCClient.clientId:null}},{key:"getActiveApiKey",value:function(){return apiRTC.session!==void 0&&apiRTC.session!==null?apiRTC.session.apiKey:null}}],kt=[{key:"get",value:function(){return Tn===null&&(Tn=new jt),Tn}}],Xt&&mn(Ut.prototype,Xt),kt&&mn(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}();function Nn(jt){return Nn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Nn(jt)}function Un(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Qn(jt,Ut){return Qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Qn(jt,Ut)}function er(jt,Ut){if(Ut&&(Nn(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zn(jt)}function zn(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function lr(jt){return lr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},lr(jt)}var cn=mt.Y.get("Invitation"),Gn=new WeakMap,Yn=["statusChange"],or=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Qn(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=lr(Ft);if(sn){var Dt=lr(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return er(this,dt)});function Yt(){var dt;return function(vt,Dt){if(!(vt instanceof Dt))throw new TypeError("Cannot call a class as a function")}(this,Yt),(dt=ln.call(this,cn)).id=null,Gn.set(zn(dt),et.g.INVITATION_STATUS_STANDBY),dt.apiRTCManager=An.get(),dt.type="not_defined",dt}return Ut=Yt,kt=[{key:"getAvailableEvents",value:function(){return Yn}}],(Xt=[{key:"setStatus",value:function(dt){Gn.set(this,dt),tn.get(this).emit("statusChange",{status:dt,id:this.id})}},{key:"getStatus",value:function(){return Gn.get(this)}}])&&Un(Ut.prototype,Xt),kt&&Un(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(fn);function Bn(jt){return Bn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Bn(jt)}function rr(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Zn(jt,Ut){return Zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Zn(jt,Ut)}function _n(jt,Ut){if(Ut&&(Bn(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}(jt)}function Ln(jt){return Ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Ln(jt)}mt.Y.get("ReceivedInvitation");var vn=["statusChange","messageDelivered","messageNotDelivered"],On=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Zn(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Ln(Ft);if(sn){var Dt=Ln(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return _n(this,dt)});function Yt(dt,vt){var Dt;return function(Vt,Gt){if(!(Vt instanceof Gt))throw new TypeError("Cannot call a class as a function")}(this,Yt),(Dt=ln.call(this)).invitationType="received",Dt.id=vt,Dt.sender=dt,Dt.receiveTime=Date.now(),Dt}return Ut=Yt,kt=[{key:"getAvailableEvents",value:function(){return vn}}],(Xt=[{key:"accept",value:function(){return new Promise}},{key:"decline",value:function(dt){}},{key:"getSender",value:function(){return this.sender}},{key:"getReceiveTime",value:function(){return this.receiveTime}},{key:"getId",value:function(){return this.id}}])&&rr(Ut.prototype,Xt),kt&&rr(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(or);function Kt(jt){return Kt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Kt(jt)}function Rt(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function nt(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Ct(jt,Ut){return Ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Ct(jt,Ut)}function yt(jt,Ut){if(Ut&&(Kt(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xt(jt)}function xt(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function wt(jt){return wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},wt(jt)}var Lt=mt.Y.get("ReceivedInvitation"),Et=new WeakMap,$t=function(jt){(function(Yt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Yt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Yt,writable:!0,configurable:!0}}),Object.defineProperty(Yt,"prototype",{writable:!1}),dt&&Ct(Yt,dt)})(ln,jt);var Ut,Xt,kt,Ft,sn=(kt=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Yt,dt=wt(kt);if(Ft){var vt=wt(this).constructor;Yt=Reflect.construct(dt,arguments,vt)}else Yt=dt.apply(this,arguments);return yt(this,Yt)});function ln(Yt,dt,vt){var Dt,Vt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Rt(this,ln),Dt=sn.call(this,Yt,dt.invitationId),Lt.info("Create ReceivedConversationInvitation"),Dt.conversation=vt,Dt.type="conversation",Dt.invitationData=dt,Et.set(xt(Dt),Vt),Dt}return Ut=ln,Xt=[{key:"accept",value:function(Yt){var dt=this,vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Dt=function(){return new Promise(function(Gt,Qt){var Zt=Et.get(dt);vt.hasOwnProperty("password")&&(Zt.password=vt.password),vt.hasOwnProperty("session")&&(Zt.session=vt.session),dt.conversation.join(Zt).then(function(){Yt!=null&&dt.conversation.publish(Yt),Gt(dt.conversation)}).catch(function(an){Qt(Bt.g.createError(et.g.ERROR_OTHER,"accept() - cannot join webconf",Lt,{fromError:an}))})})},Vt=function(){return new Promise(function(Gt,Qt){dt.conversation.joinGroupChat().then(function(){Gt(dt.conversation)}).catch(function(Zt){Qt(Bt.g.createError(et.g.ERROR_OTHER,"accept() - cannot join groupChat",Lt,{fromError:Zt}))})})};return new Promise(function(Gt,Qt){return dt.getStatus()!==et.g.INVITATION_STATUS_STANDBY?Qt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"accept() - cannot accept invitation",Lt)):(dt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),dt.apiRTCManager.sendData(dt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,answer:"accept"}),dt.invitationData&&dt.invitationData.conversationTypes?dt.invitationData.conversationTypes.indexOf("WEBCONF")>=0?Dt().then(Gt).catch(Qt):dt.invitationData.conversationTypes.indexOf("GROUP_CHAT")>=0?Vt().then(Gt).catch(Qt):void 0:Dt().then(Gt).catch(Qt))})}},{key:"decline",value:function(Yt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:Yt,answer:"decline"}))}},{key:"getConversation",value:function(){return this.conversation}}],Xt&&nt(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),ln}(On);function Jt(jt){return Jt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Jt(jt)}function en(jt,Ut){var Xt=typeof Symbol<"u"&&jt[Symbol.iterator]||jt["@@iterator"];if(!Xt){if(Array.isArray(jt)||(Xt=function(dt,vt){if(dt){if(typeof dt=="string")return qt(dt,vt);var Dt=Object.prototype.toString.call(dt).slice(8,-1);return Dt==="Object"&&dt.constructor&&(Dt=dt.constructor.name),Dt==="Map"||Dt==="Set"?Array.from(dt):Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt)?qt(dt,vt):void 0}}(jt))||Ut&&jt&&typeof jt.length=="number"){Xt&&(jt=Xt);var kt=0,Ft=function(){};return{s:Ft,n:function(){return kt>=jt.length?{done:!0}:{done:!1,value:jt[kt++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Yt=!1;return{s:function(){Xt=Xt.call(jt)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Yt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Yt)throw sn}}}}function qt(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function on(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function hn(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function nn(jt,Ut){return nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},nn(jt,Ut)}function dn(jt,Ut){if(Ut&&(Jt(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sn(jt)}function Sn(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function wn(jt){return wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},wn(jt)}s(189);var En=mt.Y.get("Call"),Pn=An.get(),Wn=["streamAdded","streamRemoved","response","accepted","declined","hangup","localStreamAvailable","recordAvailable","statsUpdate","error","disconnectionWarning","userMediaError","desktopCapture","remoteStreamUpdated","recordingStarted","recordingStopped","recordingAvailable","remoteStreamIdUpdated"],ir=new Set(["audioSent","videoSent","audioReceived","videoReceived","quality"]),fr=new WeakMap,gr=new WeakMap,yr=new WeakMap,Rr=new WeakMap,kr=new WeakMap,Qr=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&nn(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=wn(Ft);if(sn){var Dt=wn(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return dn(this,dt)});function Yt(dt,vt){var Dt,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(on(this,Yt),Dt=ln.call(this,En),En.debug("Create Call with id "+dt),fr.set(Sn(Dt),dt),gr.set(Sn(Dt),vt),Dt.publishedStreams=new Map,Dt.receivedStreams=new Map,Dt.stats={},yr.set(Sn(Dt),Vt.hasOwnProperty("started")&&Vt.started?et.g.CALL_STATUS_ONGOING:et.g.CALL_STATUS_WAITING_FOR_CALLEE),Rr.set(Sn(Dt),!!Vt.hasOwnProperty("isRecorded")&&Vt.isRecorded),Vt.isRecorded){Dt.confId=null,Dt.recordingStatus=null;for(var Gt=Pn.webRTCClient.webRTCClient.callsTable.length;--Gt>=0;){var Qt=Pn.webRTCClient.webRTCClient.callsTable[Gt];if(Qt.callId===dt&&Qt.data){Dt.confId=Qt.data.confId;break}}Rr.set(Sn(Dt),!0)}else Rr.set(Sn(Dt),!1);var Zt={hangup:function(Cn){Dt.getId()===Cn.detail.callId&&Dt.destroy()},receiveData:function(Cn){if(Cn.detail.data.info!==void 0)Cn.detail.data.info===et.g.INVITATION_ANSWER_IDENTIFIER&&Cn.detail.data.invitationId.toString()===Dt.getId()&&Dt.getStatus()===et.g.CALL_STATUS_WAITING_FOR_CALLEE&&(En.info("Call answer from "+Dt.getContact().getUsername()+" for "+Dt.getId()),Cn.detail.data.answer==="accept"?(yr.set(Sn(Dt),et.g.CALL_STATUS_ONGOING),tn.get(Sn(Dt)).emit("accepted"),tn.get(Sn(Dt)).emit("response","accepted")):(yr.set(Sn(Dt),et.g.CALL_STATUS_ENDED),tn.get(Sn(Dt)).emit("declined",{reason:"User_Refused_Call"}),tn.get(Sn(Dt)).emit("response","declined")));else if(Dt.getId()===Cn.detail.data.callId&&Cn.detail.data.event===et.g.CONTACT_STREAM_UPDATED_INFO){var Rn={callId:Cn.detail.data.callId,newStreamId:Cn.detail.data.newStreamId,oldStreamId:Cn.detail.data.oldStreamId};tn.get(Sn(Dt)).emit("remoteStreamIdUpdated",Rn)}},remoteStreamUpdated:function(Cn){if(Dt.getId()===Cn.detail.callId){var Rn={callId:Cn.detail.callId,audio:Cn.detail.audioIsAvailable&&Cn.detail.audioIsActive,audioMuted:Cn.detail.audioIsMuted,audioSilent:Cn.detail.audioIsSilent,video:Cn.detail.videoIsAvailable&&Cn.detail.videoIsActive,videoMuted:Cn.detail.videoIsMuted,videoSilent:Cn.detail.videoIsSilent};tn.get(Sn(Dt)).emit("remoteStreamUpdated",Rn)}},MCURecordingStarted:function(Cn){if(Rr.get(Sn(Dt))&&Cn.detail.roomName===Dt.confId){var Rn=Bt.g.parseRecordingEvent("MCURecordingStarted",Cn.detail);Rn.callId==="COMPOSITE"&&(Dt.recordingStatus=Rn,tn.get(Sn(Dt)).emit("recordingStarted",Rn))}},MCURecordingStopped:function(Cn){if(Rr.get(Sn(Dt))&&Cn.detail.roomName===Dt.confId){var Rn=Bt.g.parseRecordingEvent("MCURecordingStopped",Cn.detail);Rn.callId==="COMPOSITE"&&(delete Dt.recordingStatus,tn.get(Sn(Dt)).emit("recordingStopped",Rn))}},MCURecordedStreamsAvailable:function(Cn){if(Rr.get(Sn(Dt))&&Cn.detail.roomName===Dt.confId){var Rn=Bt.g.parseRecordingEvent("MCURecordedStreamsAvailable",Cn.detail);tn.get(Sn(Dt)).emit("recordingAvailable",Rn)}}};for(var an in Zt)Pn.onEvent(an,Zt[an]);return kr.set(Sn(Dt),Zt),Dt}return Ut=Yt,Xt=[{key:"destroy",value:function(){var dt=kr.get(this);if(dt){for(var vt in dt)Pn.removeEventListener(vt,dt[vt]);kr.delete(this)}}},{key:"getId",value:function(){return fr.get(this).toString()}},{key:"isRecorded",value:function(){return Rr.get(this)}},{key:"getContact",value:function(){return gr.get(this)}},{key:"getStatus",value:function(){return yr.get(this)}},{key:"setStatus",value:function(dt){yr.set(this,dt)}},{key:"getPublishedStreams",value:function(){var dt,vt=[],Dt=en(this.publishedStreams.values());try{for(Dt.s();!(dt=Dt.n()).done;){var Vt=dt.value;vt.push(Vt)}}catch(Gt){Dt.e(Gt)}finally{Dt.f()}return vt}},{key:"getReceivedStreams",value:function(){var dt,vt=[],Dt=en(this.receivedStreams.values());try{for(Dt.s();!(dt=Dt.n()).done;){var Vt=dt.value;vt.push(Vt)}}catch(Gt){Dt.e(Gt)}finally{Dt.f()}return vt}},{key:"hangUp",value:function(){this.getStatus()===et.g.CALL_STATUS_ENDED?En.error("hangUp() - Call has already ended"):Pn.webRTCClient.hangUp(this.getId())}},{key:"getStats",value:function(){return Bt.g.assignObject({},this.stats)}},{key:"stopPublishedStreams",value:function(){return Pn.webRTCClient.webRTCClient.stopMedia(this.getId())}},{key:"replacePublishedStreams",value:function(dt,vt){var Dt=this,Vt=function(Gt){if(yo.has(Gt))return yo.get(Gt);var Qt=apiCC.getUserMediaStream(Gt);if(Qt){var Zt="audio";return Qt.video===!0&&(Zt="video"),new so(Qt.stream,{type:Zt,constructor:!0,userMediaStreamId:Qt.userMediaStreamId})}return null};return new Promise(function(Gt,Qt){if(Dt.getStatus()!==et.g.CALL_STATUS_ONGOING)return Qt(new Error("replacePublishedStreams() - Cannot replace stream as call is not ongoing"));if(dt===null)if(Bt.g.isPropertyTypeof(vt,"getStream","function")){var Zt={getUserMediaStreamId:function(){return vt.getStream().then(function(an){return an.userMediaStreamId}).catch(Qt)}};Pn.webRTCClient.webRTCClient.addMedia(Dt.getId(),!0,null,Zt).then(function(an){var Cn=Vt(an.userMediaStreamId);return Cn!==null&&Dt.getContact().sendCustomEvent(et.g.CONTACT_STREAM_UPDATED_INFO,{callId:Dt.getId(),newStreamId:Cn.data.id,oldStreamId:an.oldMediaStreamId}),Gt(Cn)}).catch(function(an){return Qt(new Error("replacePublishedStreams() - "+an))})}else Pn.webRTCClient.webRTCClient.addMedia(Dt.getId(),!0,null,null).then(function(an){var Cn=Vt(an.userMediaStreamId);return Cn!==null&&Dt.getContact().sendCustomEvent(et.g.CONTACT_STREAM_UPDATED_INFO,{callId:Dt.getId(),newStreamId:Cn.data.id,oldStreamId:an.oldMediaStreamId}),Gt(Cn)}).catch(function(an){return Qt(new Error("replacePublishedStreams() - "+an))});else Pn.webRTCClient.webRTCClient.addMedia(Dt.getId(),!0,dt.userMediaStreamId).then(function(an){return Dt.getContact().sendCustomEvent(et.g.CONTACT_STREAM_UPDATED_INFO,{callId:Dt.getId(),newStreamId:dt.data.id,oldStreamId:an.oldMediaStreamId}),Gt(dt)}).catch(function(an){return Qt(new Error("replacePublishedStreams() - "+an))})})}},{key:"getRecordingInfo",value:function(){return Rr.get(this)?this.recordingStatus:null}},{key:"startRecording",value:function(){var dt=this;return new Promise(function(vt,Dt){if(dt.asyncCallbacks)return Dt(Bt.g.createError(et.g.ERROR_OTHER,"startRecording() - busy",En));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(Pn.removeEventListener("error",dt.asyncCallbacks.error),Pn.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),delete dt.asyncCallbacks),Dt(Bt.g.createError(et.g.ERROR_OTHER,"startRecording() - timeout",En))},et.g.CONVERSATION_RECORDING_STARTED_DELAY),dt.asyncCallbacks.error=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"&&Vt.detail.errorCode.indexOf("START_RECORD")>=0)return dt.asyncCallbacks&&(Pn.removeEventListener("error",dt.asyncCallbacks.error),Pn.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Dt(Bt.g.createError(et.g.ERROR_OTHER,"startRecording() - "+Vt.detail.errorInfo,En))},dt.asyncCallbacks.recordingStarted=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"){dt.asyncCallbacks&&(Pn.removeEventListener("error",dt.asyncCallbacks.error),Pn.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var Gt=Bt.g.parseRecordingEvent("MCURecordingStarted",Vt.detail);return vt(Gt)}},Pn.onEvent("error",dt.asyncCallbacks.error),Pn.onEvent("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),Pn.webRTCClient.startCallRecording(fr.get(dt))})}},{key:"stopRecording",value:function(){var dt=this;return new Promise(function(vt,Dt){if(dt.asyncCallbacks)return Dt(Bt.g.createError(et.g.ERROR_OTHER,"stopRecording() - busy",En));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(Pn.removeEventListener("error",dt.asyncCallbacks.error),Pn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),delete dt.asyncCallbacks),Dt(Bt.g.createError(et.g.ERROR_OTHER,"stopRecording() - timeout",En))},et.g.CONVERSATION_RECORDING_STOPPED_DELAY),dt.asyncCallbacks.error=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"&&Vt.detail.errorCode.indexOf("STOP_RECORD")>=0)return dt.asyncCallbacks&&(Pn.removeEventListener("error",dt.asyncCallbacks.error),Pn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Dt(Bt.g.createError(et.g.ERROR_OTHER,"stopRecording() - "+Vt.detail.errorInfo,En))},dt.asyncCallbacks.recordingStopped=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"){dt.asyncCallbacks&&(Pn.removeEventListener("error",dt.asyncCallbacks.error),Pn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var Gt=Bt.g.parseRecordingEvent("MCURecordingStopped",Vt.detail);return vt(Gt)}},Pn.onEvent("error",dt.asyncCallbacks.error),Pn.onEvent("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),Pn.webRTCClient.stopCallRecording(fr.get(dt))})}},{key:"manageCallEstablishedEvent",value:function(dt){En.debug("callEstablished",dt.detail,this.getId());var vt=dt.detail.callId.toString();this.getId()===vt&&(En.info("callEstablished from "+this.getContact().getUsername(),dt),this.getStatus()!==et.g.CALL_STATUS_ONGOING&&this.getStatus()!==et.g.CALL_STATUS_ENDED&&(tn.get(this).emit("accepted"),tn.get(this).emit("response","accepted"),yr.set(this,et.g.CALL_STATUS_ONGOING)))}},{key:"manageRemoteStreamAddedEvent",value:function(dt){En.debug("remoteStreamAdded",dt.detail,this.getId());var vt=dt.detail.callId.toString();if(this.getId()===vt){var Dt=dt.detail.destCallType==="audio"?"audio":"video",Vt=dt.detail.callType==="screenSharing",Gt=new so(dt.detail.stream,{screensharing:Vt,type:Dt,contact:this.getContact(),streamId:dt.detail.stream.id,callId:dt.detail.callId,callAudioAvailable:dt.detail.audioIsAvailable,callAudioActive:dt.detail.audioIsActive,callAudioMuted:dt.detail.audioIsMuted,callVideoAvailable:dt.detail.videoIsAvailable,callVideoActive:dt.detail.videoIsActive,callVideoMuted:dt.detail.videoIsMuted,constructor:!0});this.receivedStreams.set(dt.detail.stream.id,Gt),tn.get(this).emit("streamAdded",Gt)}}},{key:"manageRemoteStreamRemovedEvent",value:function(dt){En.debug("remoteStreamRemoved",dt.detail,this.getId());var vt=dt.detail.callId.toString();if(this.getId()===vt){var Dt=this.receivedStreams.get(dt.detail.stream.id);this.receivedStreams.delete(dt.detail.stream.id),tn.get(this).emit("streamRemoved",Dt)}}},{key:"manageUserMediaSuccessEvent",value:function(dt){En.debug("UserMediaSuccess",dt.detail,this.getId());var vt,Dt=null;if(vt=dt.detail.videoIsAvailable===!0?"video":"audio",dt.detail.callId!==null&&(Dt=dt.detail.callId.toString()),this.getId()===Dt){En.info("localStreamAvailable",dt.detail);var Vt=yo.get(dt.detail.userMediaStreamId);Vt||(Vt=new so(dt.detail.stream,{type:vt,constructor:!0,userMediaStreamId:dt.detail.userMediaStreamId,callId:this.getId()})),this.publishedStreams.set(Bt.g.guid(),Vt),tn.get(this).emit("localStreamAvailable",Vt)}}},{key:"manageCallStatsUpdateEvent",value:function(dt){if(this.getId()===dt.detail.callId){for(var vt=0,Dt=Object.keys(dt.detail.stats);vt<Dt.length;vt++){var Vt=Dt[vt];ir.has(Vt)&&(this.stats[Vt]=dt.detail.stats[Vt])}tn.get(this).emit("statsUpdate",Bt.g.assignObject({},{stats:this.stats}))}}},{key:"manageErrorEvent",value:function(dt){if(En.debug("Error",dt.detail,this.getId()),this.getId()===dt.detail.callId){var vt={errorCode:dt.detail.errorCode,errorInfo:dt.detail.errorInfo};dt.detail.data&&(vt.descriptor=dt.detail.data),tn.get(this).emit("error",vt)}}},{key:"manageDisconnectionWarningEvent",value:function(dt){En.debug("DisconnectionWarning",dt.detail,this.getId()),this.getId()===dt.detail.callId&&tn.get(this).emit("disconnectionWarning",{tries:dt.detail.tries})}},{key:"manageHangupEvent",value:function(dt){En.debug("hangup",dt.detail,this.getId());var vt=dt.detail.callId.toString(),Dt=this.getStatus()===et.g.CALL_STATUS_WAITING_FOR_CALLEE&&dt.detail.hangupType==="remote";if(this.getId()===vt&&this.getStatus()!==et.g.CALL_STATUS_ENDED){yr.set(this,et.g.CALL_STATUS_ENDED),En.info("Hangup from "+this.getContact().getUsername(),dt);var Vt,Gt=en(this.receivedStreams.keys());try{for(Gt.s();!(Vt=Gt.n()).done;){var Qt=Vt.value,Zt=this.receivedStreams.get(Qt);this.receivedStreams.delete(Qt),tn.get(this).emit("streamRemoved",Zt)}}catch(an){Gt.e(an)}finally{Gt.f()}tn.get(this).emit("hangup",{from:dt.detail.hangupType,reason:dt.detail.reason}),Dt&&(tn.get(this).emit("declined",{reason:dt.detail.reason}),tn.get(this).emit("response","declined"))}}},{key:"manageRecordAvailableEvent",value:function(dt){En.warn("recordedStreamsAvailable",dt.detail,this.getId()),tn.get(this).emit("recordAvailable",{mediaURL:dt.detail.mediaURL})}},{key:"manageUserMediaErrorEvent",value:function(dt){En.warn("userMediaError",dt.detail,this.getId()),tn.get(this).emit("userMediaError",{callType:dt.detail.callType,error:dt.detail.error,onCallEstablishment:dt.detail.onCallEstablishment,userMediaStreamId:dt.detail.userMediaStreamId,tryAudioCallActivated:dt.detail.tryAudioCallActivated})}},{key:"manageDesktopCaptureEvent",value:function(dt){En.warn("desktopCapture",dt.detail,this.getId()),tn.get(this).emit("desktopCapture",{event:dt.detail.event})}}],kt=[{key:"getAvailableEvents",value:function(){return Wn}}],Xt&&hn(Ut.prototype,Xt),kt&&hn(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(fn);function Yr(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function Sr(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}var Nr=mt.Y.get("ConversationCatalog"),wr=null,Ar=function(){function jt(){if(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")}(this,jt),wr!==null)throw"Cannot construct singleton CallCatalog";this.callList=new Map,wr=this}var Ut,Xt,kt;return Ut=jt,kt=[{key:"get",value:function(){return wr===null&&(wr=new jt),wr}}],(Xt=[{key:"getOrCreateCall",value:function(Ft,sn,ln){var Yt=null;return Ft!=null&&(this.callList.has(Ft.toString())?Yt=this.callList.get(Ft.toString()):(Yt=new Qr(Ft.toString(),sn,ln),this.callList.set(Ft.toString(),Yt))),Yt}},{key:"getCall",value:function(Ft,sn){var ln=null;if(Ft!=null){if(!this.callList.has(Ft.toString()))return null;ln=this.callList.get(Ft.toString())}else if(sn){var Yt,dt=function(Vt,Gt){var Qt=typeof Symbol<"u"&&Vt[Symbol.iterator]||Vt["@@iterator"];if(!Qt){if(Array.isArray(Vt)||(Qt=function(Xn,dr){if(Xn){if(typeof Xn=="string")return Yr(Xn,dr);var hr=Object.prototype.toString.call(Xn).slice(8,-1);return hr==="Object"&&Xn.constructor&&(hr=Xn.constructor.name),hr==="Map"||hr==="Set"?Array.from(Xn):hr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(hr)?Yr(Xn,dr):void 0}}(Vt))||Gt&&Vt&&typeof Vt.length=="number"){Qt&&(Vt=Qt);var Zt=0,an=function(){};return{s:an,n:function(){return Zt>=Vt.length?{done:!0}:{done:!1,value:Vt[Zt++]}},e:function(Xn){throw Xn},f:an}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Cn,Rn=!0,Kn=!1;return{s:function(){Qt=Qt.call(Vt)},n:function(){var Xn=Qt.next();return Rn=Xn.done,Xn},e:function(Xn){Kn=!0,Cn=Xn},f:function(){try{Rn||Qt.return==null||Qt.return()}finally{if(Kn)throw Cn}}}}(this.callList.values());try{for(dt.s();!(Yt=dt.n()).done;){var vt=Yt.value,Dt=vt.getContact();if(Dt&&Dt.getId()===sn.getId()){ln=vt;break}}}catch(Vt){dt.e(Vt)}finally{dt.f()}}return ln}},{key:"removeCallFromList",value:function(Ft){Nr.log("removeCallFromList : av instance.callList :",wr.callList),wr.callList.has(Ft)&&wr.callList.delete(Ft),Nr.log("removeCallFromList : ap instance.callList :",wr.callList)}},{key:"getCalls",value:function(){return this.callList}}])&&Sr(Ut.prototype,Xt),kt&&Sr(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}();function Lr(jt){return Lr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Lr(jt)}function Hr(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function na(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Vn(jt,Ut){return Vn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Vn(jt,Ut)}function ar(jt,Ut){if(Ut&&(Lr(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hn(jt)}function Hn(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function vr(jt){return vr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},vr(jt)}var qn=mt.Y.get("ReceivedInvitation"),jr=Ar.get(),_r=["expired","statusChange"],Er=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Vn(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=vr(Ft);if(sn){var Dt=vr(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return ar(this,dt)});function Yt(dt,vt,Dt){var Vt,Gt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Hr(this,Yt),Vt=ln.call(this,dt,vt),qn.info("Create ReceivedCallInvitation with call type "+Dt),Vt.type="call",Vt.callType=Dt,Vt.isRecordedCall=!!Gt.hasOwnProperty("isRecorded")&&Gt.isRecorded,Vt.call=jr.getOrCreateCall(Vt.id,Vt.sender,{isRecorded:Vt.isRecorded()}),Vt.apiRTCManager.onEvent("hangup",function(Qt){var Zt=Qt.detail.callId.toString();Vt.id.toString()===Zt&&Vt.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(Vt.setStatus(et.g.INVITATION_STATUS_EXPIRED),tn.get(Hn(Vt)).emit("expired"))}),Vt}return Ut=Yt,Xt=[{key:"getCallType",value:function(){return this.callType}},{key:"isRecorded",value:function(){return this.isRecordedCall}},{key:"accept",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,Gt){var Qt=vt.getCallType()==="audio",Zt=!0,an=Dt;Dt.hasOwnProperty("audioOnly")&&(Qt=Dt.audioOnly,delete Dt.audioOnly,an.mediaTypeForIncomingCall!==void 0&&an.mediaTypeForIncomingCall!==null||Dt.audioOnly===!0&&(an.mediaTypeForIncomingCall="AUDIO")),Dt.hasOwnProperty("noStream")&&(an.mediaTypeForIncomingCall="NONE",Zt=!1),an.mediaTypeForIncomingCall==="NONE"&&(Zt=!1),vt.getStatus()===et.g.INVITATION_STATUS_STANDBY?(vt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),vt.apiRTCManager.sendData(vt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:vt.id,answer:"accept"}),vt.call.setStatus(et.g.CALL_STATUS_ONGOING),Zt&&dt!==null&&dt instanceof so&&(qn.debug("accept() - A stream was preselected; audio only : ",Qt),an.userMediaStreamId=dt.userMediaStreamId),vt.apiRTCManager.webRTCClient.acceptCall(vt.id,an),Vt(vt.call)):Gt(Bt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this call, invitation state invalid",qn))})}},{key:"decline",value:function(dt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:dt,answer:"decline"}),this.apiRTCManager.webRTCClient.refuseCall(this.id))}},{key:"getCall",value:function(){return this.call}}],kt=[{key:"getAvailableEvents",value:function(){return _r}}],Xt&&na(Ut.prototype,Xt),kt&&na(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(On);function Fn(jt){return Fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Fn(jt)}function pr(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Pr(jt,Ut){return Pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Pr(jt,Ut)}function Tr(jt,Ut){if(Ut&&(Fn(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}(jt)}function qr(jt){return qr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},qr(jt)}var $r=mt.Y.get("ReceivedInvitation"),Co=["error","progress","statusChange"],eo=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Pr(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=qr(Ft);if(sn){var Dt=qr(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return Tr(this,dt)});function Yt(dt,vt,Dt){var Vt;return function(Gt,Qt){if(!(Gt instanceof Qt))throw new TypeError("Cannot call a class as a function")}(this,Yt),Vt=ln.call(this,dt,vt),$r.debug("Create ReceivedFileTransferInvitation"),Vt.type="sendFile",Vt.fileInfo=Dt,Vt.apiRTCManager.onEvent("hangup",function(Gt){$r.debug("hangup");var Qt=Gt.detail.callId.toString();Vt.getId()===Qt&&($r.debug("hangup for ReceivedFileTransferInvitation"),Vt.getStatus()===et.g.INVITATION_STATUS_ENDED?$r.debug("invitation ended"):($r.debug("invitation is cancelled"),Vt.setStatus(et.g.INVITATION_STATUS_CANCELLED)),apiRTC.userAgentInstance.currentSession.invitationsMap.has(Gt.detail.remoteId+"-sendfile-"+Qt)&&apiRTC.userAgentInstance.currentSession.invitationsMap.delete(Gt.detail.remoteId+"-sendfile-"+Qt))}),Vt}return Ut=Yt,kt=[{key:"getAvailableEvents",value:function(){return Co}}],(Xt=[{key:"accept",value:function(){var dt=this;return new Promise(function(vt,Dt){if(dt.getStatus()!==et.g.INVITATION_STATUS_STANDBY)Dt(Bt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this file transfer session, invitation state invalid",$r));else{dt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),dt.apiRTCManager.sendData(dt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,answer:"accept"});var Vt=dt;dt.apiRTCManager.onEvent("onFileReceived",function Gt(Qt){if(Qt.detail.callId.toString()===Vt.id.toString()){if($r.debug("typeof(e.detail.data.file) :",Fn(Qt.detail.data.file)),typeof Qt.detail.data.file=="string")vt({file:Qt.detail.data.file,name:Qt.detail.data.name,type:Qt.detail.data.type});else{var Zt=new FileReader;Zt.addEventListener("loadend",function(){dt.setStatus(et.g.INVITATION_STATUS_ENDED),dt.apiRTCManager.webRTCClient.hangUp(Vt.id.toString());try{$r.info("accept() - file received from "+Vt.sender.getUsername()+" !"),vt({file:Qt.detail.data.file,name:Qt.detail.data.name,type:Qt.detail.data.type})}catch(an){$r.error("File Error",an),Dt(Bt.g.createError(et.g.ERROR_OTHER,"accept() - Could not read file received",$r))}}),Zt.readAsArrayBuffer(Qt.detail.data.file)}dt.apiRTCManager.removeEventListener("onFileReceived",Gt)}}),dt.apiRTCManager.onEvent("onFileProgress",function(Gt){Gt.detail.callId.toString()===Vt.id.toString()&&($r.trace("file transfering",Gt.detail),tn.get(Vt).emit("progress",{uuid:Gt.detail.uuid,fileSize:Gt.detail.fileSize,remainingSize:Gt.detail.remainingSize,percentage:Gt.detail.percentage,sendChunkNb:Gt.detail.sendChunkNb,transferDuration:Gt.detail.transferDuration,lastPacket:Gt.detail.lastPacket}))}),dt.apiRTCManager.onEvent("receiveDataChannelError",function(Gt){Gt.detail.callId.toString()===Vt.id.toString()&&($r.warn("receiveDataChannelError",Gt.detail),tn.get(Vt).emit("error","receiveDataChannelError"))}),dt.apiRTCManager.webRTCClient.acceptCall(dt.id,{mediaTypeForIncomingCall:"DATA"})}})}},{key:"getFileInfo",value:function(){return this.fileInfo}},{key:"decline",value:function(dt){$r.log("decline"),this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:dt,answer:"decline"}),this.apiRTCManager.webRTCClient.refuseCall(this.id))}}])&&pr(Ut.prototype,Xt),kt&&pr(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(On);function ga(jt){return ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},ga(jt)}function ms(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function Qo(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Zs(jt,Ut){return Zs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Zs(jt,Ut)}function hp(jt,Ut){if(Ut&&(ga(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}(jt)}function gs(jt){return gs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},gs(jt)}var gu=mt.Y.get("ReceivedInvitation"),vs=function(jt){(function(Yt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Yt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Yt,writable:!0,configurable:!0}}),Object.defineProperty(Yt,"prototype",{writable:!1}),dt&&Zs(Yt,dt)})(ln,jt);var Ut,Xt,kt,Ft,sn=(kt=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Yt,dt=gs(kt);if(Ft){var vt=gs(this).constructor;Yt=Reflect.construct(dt,arguments,vt)}else Yt=dt.apply(this,arguments);return hp(this,Yt)});function ln(Yt,dt){var vt,Dt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ms(this,ln),vt=sn.call(this,Yt,dt),gu.info("Create ReceivedWhiteboardInvitation"),vt.type="whiteboard",Dt.cloudConvId&&(vt.cloudConvId=Dt.cloudConvId),Dt.webconf===!0&&(vt.webconf=!0),vt}return Ut=ln,(Xt=[{key:"accept",value:function(){var Yt=this;return new Promise(function(dt,vt){if(Yt.getStatus()===et.g.INVITATION_STATUS_STANDBY){Yt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),Yt.apiRTCManager.sendData(Yt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:"wb-"+Yt.id,answer:"accept"}),Yt.apiRTCManager.whiteBoardClient.leaveRoom(),Yt.apiRTCManager.whiteBoardClient.start();var Dt={};Yt.cloudConvId&&(Dt.convId=Yt.cloudConvId),Yt.webconf===!0&&(Dt.webconf=!0),Yt.apiRTCManager.whiteBoardClient.joinRoom(Yt.id,Dt),dt(Yt.id)}else vt(Bt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this whiteboard session, invitation state invalid",gu))})}},{key:"decline",value:function(Yt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:"wb-"+this.id,reason:Yt,answer:"decline"}))}}])&&Qo(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),ln}(On);function Cl(jt){return Cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Cl(jt)}function fp(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function vu(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function yl(jt,Ut){return yl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},yl(jt,Ut)}function mp(jt,Ut){if(Ut&&(Cl(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jr(jt)}function Jr(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function Cs(jt){return Cs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Cs(jt)}var To=mt.Y.get("DataChannel"),Sl=An.get(),gp=["response","accepted","declined","error","opened","closed","error","transferProgress","transferComplete","dataReceived","ended"],Cu=new WeakMap,bu=new WeakMap,Zo=new WeakMap,bs=new WeakMap,ys=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&yl(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Cs(Ft);if(sn){var Dt=Cs(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return mp(this,dt)});function Yt(dt,vt){var Dt,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return fp(this,Yt),Dt=ln.call(this,To),To.debug("Create DataChannel with id "+dt),Cu.set(Jr(Dt),dt),bu.set(Jr(Dt),vt),bs.set(Jr(Dt),et.g.DATACHANNEL_TYPE_RECEIVE),Vt.hasOwnProperty("type")&&(Vt.type===et.g.DATACHANNEL_TYPE_RECEIVE?bs.set(Jr(Dt),et.g.DATACHANNEL_TYPE_RECEIVE):Vt.type===et.g.DATACHANNEL_TYPE_SEND&&bs.set(Jr(Dt),et.g.DATACHANNEL_TYPE_SEND)),Zo.set(Jr(Dt),et.g.DATACHANNEL_STATUS_WAITING),Sl.onEvent("receiveData",function(Gt){Gt.detail.data.info!==void 0&&Gt.detail.data.info===et.g.INVITATION_ANSWER_IDENTIFIER&&Gt.detail.data.invitationId.toString()===Dt.getId()&&Dt.getStatus()===et.g.DATACHANNEL_STATUS_WAITING&&(To.info("DataChannel answer from "+Dt.getContact().getUsername()+" for "+Dt.getId()),Gt.detail.data.answer==="accept"?tn.get(Jr(Dt)).emit("accepted"):(Zo.set(Jr(Dt),et.g.DATACHANNEL_STATUS_ENDED),tn.get(Jr(Dt)).emit("declined")),tn.get(Jr(Dt)).emit("response"))}).onEvent("callEstablished",function(Gt){var Qt=Gt.detail.callId.toString();Dt.getId()===Qt&&(To.info("callEstablished from "+Dt.getContact().getUsername(),Gt),Dt.getStatus()!==et.g.DATACHANNEL_STATUS_ONGOING&&Dt.getStatus()!==et.g.DATACHANNEL_STATUS_ENDED&&tn.get(Jr(Dt)).emit("accepted"))}).onEvent("hangup",function(Gt){var Qt=Gt.detail.callId.toString(),Zt=Dt.getStatus()===et.g.DATACHANNEL_STATUS_WAITING&&Gt.detail.hangupType==="remote";Dt.getId()===Qt&&Dt.getStatus()!==et.g.DATACHANNEL_STATUS_ENDED&&(Zo.set(Jr(Dt),et.g.DATACHANNEL_STATUS_ENDED),To.info("Hangup from "+Dt.getContact().getUsername(),Gt),tn.get(Jr(Dt)).emit("ended",{from:Gt.detail.hangupType}),Zt&&tn.get(Jr(Dt)).emit("declined"))}).onEvent("onFileReceived",function(Gt){if(Gt.detail.callId.toString()===Dt.getId()){var Qt=Gt.detail.data,Zt=new FileReader;Zt.addEventListener("loadend",function(){try{var an=Bt.g.arrayBuffertoString(Zt.result);To.info("dataReceived !"),tn.get(Jr(Dt)).emit("dataReceived",{uuid:Qt.uuid,data:an})}catch(Cn){To.error("dataReceived Error",Cn)}}),Zt.readAsArrayBuffer(Qt.file)}}).onEvent("onFileProgress",function(Gt){if(Gt.detail.callId.toString()===Dt.getId()){var Qt=Gt.detail;To.trace("file transfering",Qt);var Zt={uuid:Qt.uuid,fileSize:Qt.fileSize,remainingSize:Qt.remainingSize,percentage:Qt.percentage,sendChunkNb:Qt.sendChunkNb,transferDuration:Qt.transferDuration,lastPacket:Qt.lastPacket};tn.get(Jr(Dt)).emit("transferProgress",Zt),Qt.transferEnded&&tn.get(Jr(Dt)).emit("transferComplete",Zt)}}).onEvent("receiveDataChannelError",function(Gt){var Qt=Gt.detail.callId.toString();Dt.getId()===Qt&&tn.get(Jr(Dt)).emit("error","receiveDataChannelError")}).onEvent("sendDataChannelError",function(Gt){var Qt=Gt.detail.callId.toString();Dt.getId()===Qt&&tn.get(Jr(Dt)).emit("error","sendDataChannelError")}).onEvent("receiveDataChannelClose",function(Gt){var Qt=Gt.detail.callId.toString();Dt.getId()===Qt&&tn.get(Jr(Dt)).emit("closed")}).onEvent("sendDataChannelClose",function(Gt){var Qt=Gt.detail.callId.toString();Dt.getId()===Qt&&tn.get(Jr(Dt)).emit("closed")}).onEvent("receiveDataChannelOpen",function(Gt){var Qt=Gt.detail.callId.toString();Dt.getId()===Qt&&(Zo.set(Jr(Dt),et.g.DATACHANNEL_STATUS_ONGOING),tn.get(Jr(Dt)).emit("opened"))}).onEvent("sendDataChannelOpen",function(Gt){var Qt=Gt.detail.callId.toString();Dt.getId()===Qt&&tn.get(Jr(Dt)).emit("opened")}),Dt}return Ut=Yt,Xt=[{key:"getId",value:function(){return Cu.get(this).toString()}},{key:"getContact",value:function(){return bu.get(this)}},{key:"getType",value:function(){return bs.get(this)}},{key:"getStatus",value:function(){return Zo.get(this)}},{key:"sendData",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,Gt){var Qt=!1;vt.getStatus()!==et.g.DATACHANNEL_STATUS_ONGOING?Gt(Bt.g.createError(et.g.ERROR_OTHER,"Cannot send data as datachannel session is not ongoing",To)):vt.getType()!==et.g.DATACHANNEL_TYPE_SEND?Gt(Bt.g.createError(et.g.ERROR_OTHER,"Cannot send data as datachannel session is receiving only",To)):Sl.webRTCClient.sendDataWithCallId(vt.getId(),{file:dt,name:Dt.name,type:Dt.type},function(Zt){Qt||(Qt=!0,Vt(Zt.uuid)),To.trace("sendData() - progress : ",Zt);var an={uuid:Zt.uuid,fileSize:Zt.fileSize,remainingSize:Zt.remainingSize,percentage:Zt.percentage,sendChunkNb:Zt.sendChunkNb,transferDuration:Zt.transferDuration,lastPacket:Zt.lastPacket};tn.get(vt).emit("transferProgress",an),Zt.transferEnded&&tn.get(vt).emit("transferComplete",an)})})}},{key:"close",value:function(){this.getStatus()===et.g.DATACHANNEL_STATUS_ENDED?To.error("close() - DataChannel session has already ended"):Sl.webRTCClient.hangUp(this.getId())}}],kt=[{key:"getAvailableEvents",value:function(){return gp}}],Xt&&vu(Ut.prototype,Xt),kt&&vu(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(fn);function Tl(jt){return Tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Tl(jt)}function yu(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Il(jt,Ut){return Il=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Il(jt,Ut)}function vp(jt,Ut){if(Ut&&(Tl(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Su(jt)}function Su(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function Ss(jt){return Ss=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Ss(jt)}var Tu=mt.Y.get("ReceivedInvitation"),Cp=["expired","statusChange"],zo=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Il(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Ss(Ft);if(sn){var Dt=Ss(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return vp(this,dt)});function Yt(dt,vt){var Dt;return function(Vt,Gt){if(!(Vt instanceof Gt))throw new TypeError("Cannot call a class as a function")}(this,Yt),Dt=ln.call(this,dt,vt),Tu.info("Create ReceivedDataChannelInvitation "),Dt.type="dataChannel",Dt.apiRTCManager.onEvent("hangup",function(Vt){var Gt=Vt.detail.callId.toString();Dt.id.toString()===Gt&&Dt.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(Dt.setStatus(et.g.INVITATION_STATUS_EXPIRED),tn.get(Su(Dt)).emit("expired"))}),Dt}return Ut=Yt,kt=[{key:"getAvailableEvents",value:function(){return Cp}}],(Xt=[{key:"accept",value:function(){var dt=this;return new Promise(function(vt,Dt){if(dt.getStatus()===et.g.INVITATION_STATUS_STANDBY){dt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),dt.apiRTCManager.sendData(dt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,answer:"accept"});var Vt=new ys(dt.id,dt.sender,{started:!0,type:et.g.DATACHANNEL_TYPE_SEND});dt.apiRTCManager.webRTCClient.acceptCall(dt.id,{mediaTypeForIncomingCall:"DATA"}),vt(Vt)}else Dt(Bt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this datachannel session, invitation state invalid",Tu))})}},{key:"decline",value:function(dt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:dt,answer:"decline"}),this.apiRTCManager.webRTCClient.refuseCall(this.id))}}])&&yu(Ut.prototype,Xt),kt&&yu(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(On);function Rl(jt){return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Rl(jt)}function bp(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function El(jt,Ut){return El=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},El(jt,Ut)}function yp(jt,Ut){if(Ut&&(Rl(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}(jt)}function Ts(jt){return Ts=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Ts(jt)}var Ol=mt.Y.get("ReceivedInvitation"),Ho=function(jt){(function(Yt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Yt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Yt,writable:!0,configurable:!0}}),Object.defineProperty(Yt,"prototype",{writable:!1}),dt&&El(Yt,dt)})(ln,jt);var Ut,Xt,kt,Ft,sn=(kt=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Yt,dt=Ts(kt);if(Ft){var vt=Ts(this).constructor;Yt=Reflect.construct(dt,arguments,vt)}else Yt=dt.apply(this,arguments);return yp(this,Yt)});function ln(Yt,dt,vt){var Dt;return function(Vt,Gt){if(!(Vt instanceof Gt))throw new TypeError("Cannot call a class as a function")}(this,ln),Dt=sn.call(this,Yt,vt),Ol.info("Create ReceivedConversationJoinRequest"),Dt.type="conversationJoinRequest",Dt.conversation=dt||null,Dt}return Ut=ln,(Xt=[{key:"getConversation",value:function(){return this.conversation}},{key:"accept",value:function(){var Yt=this;return new Promise(function(dt,vt){Yt.getStatus()===et.g.INVITATION_STATUS_STANDBY?(Yt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),Yt.conversation?Yt.conversation.allowEntry(Yt.sender,{invitationId:Yt.id,answer:"accept",ackEnabled:!0}).then(dt).catch(vt):(Yt.apiRTCManager.sendData(Yt.sender.getId(),{roomname:Yt.id,event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:Yt.id,answer:"accept",command:"access",value:{access:!0}}),dt())):vt(Bt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot accept request, invitation state invalid",Ol))})}},{key:"decline",value:function(Yt){var dt=this;return new Promise(function(vt,Dt){dt.getStatus()===et.g.INVITATION_STATUS_STANDBY?(dt.setStatus(et.g.INVITATION_STATUS_DECLINED),dt.conversation?dt.conversation.denyEntry(dt.sender,{invitationId:dt.id,answer:"decline",reason:Yt}).then(vt).catch(Dt):(dt.apiRTCManager.sendData(dt.sender.getId(),{roomname:dt.id,event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,reason:Yt,answer:"decline",command:"access",value:{access:!1}}),vt())):Dt(Bt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"decline() - Cannot decline request, invitation state invalid",Ol))})}}])&&bp(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),ln}(On);function Al(jt){return Al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Al(jt)}function Sp(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Ml(jt,Ut){return Ml=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Ml(jt,Ut)}function Tp(jt,Ut){if(Ut&&(Al(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}(jt)}function Is(jt){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Is(jt)}var Iu=mt.Y.get("ReceivedInvitation"),xl=function(jt){(function(Yt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Yt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Yt,writable:!0,configurable:!0}}),Object.defineProperty(Yt,"prototype",{writable:!1}),dt&&Ml(Yt,dt)})(ln,jt);var Ut,Xt,kt,Ft,sn=(kt=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Yt,dt=Is(kt);if(Ft){var vt=Is(this).constructor;Yt=Reflect.construct(dt,arguments,vt)}else Yt=dt.apply(this,arguments);return Tp(this,Yt)});function ln(Yt,dt,vt){var Dt;return function(Vt,Gt){if(!(Vt instanceof Gt))throw new TypeError("Cannot call a class as a function")}(this,ln),(Dt=sn.call(this,Yt,dt)).session=vt,Dt.type="pointerSharing",Dt}return Ut=ln,(Xt=[{key:"accept",value:function(){var Yt=this;return new Promise(function(dt,vt){Yt.getStatus()===et.g.INVITATION_STATUS_STANDBY?(Yt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),Yt.session.joinPointerSharingRoom(Yt.id).then(dt).catch(function(Dt){vt(Bt.g.createError(et.g.ERROR_OTHER,"accept() - cannot accept invitation",Iu))})):vt(Bt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - cannot accept invitation",Iu))})}},{key:"decline",value:function(Yt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&this.setStatus(et.g.INVITATION_STATUS_DECLINED)}}])&&Sp(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),ln}(On);function Ip(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}s(4723);var Ur=mt.Y.get("AicConsoleManager"),Ru=function(){function jt(){var kt=this;(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")})(this,jt),Ur.info("Create AicConsoleManager"),this.ws=null,this.connectedToapplication=!1,this.domStream=null,this.keyboard_mode=0,this.ports=[4545,5858,37371,41793,42803],this.port_index=0,this.aic_agent_running=0,this.ip="127.0.0.1",this.aic_agent_handshake_done=0,this.controlActivated=!1,this.handshakeTimeoutId=0,this.kd=function(Ft){kt.key_down(Ft)},this.ku=function(Ft){kt.key_up(Ft)},this.wfl=function(Ft){kt.window_focus_lost(Ft)},this.mm=function(Ft){kt.mouse_move(Ft)},this.dc=function(Ft){kt.mouse_doubleclick(Ft)},this.md=function(Ft){kt.mouse_down(Ft)},this.mu=function(Ft){kt.mouse_up(Ft)},this.mw=function(Ft){kt.mouse_wheel(Ft)}}var Ut,Xt;return Ut=jt,Xt=[{key:"aic_control_onmessage",value:function(kt){if(Ur.debug("Message to send to remote app :",kt),apiRTC.session.remoteAccessInvitation!==null){var Ft={event:et.g.CONTACT_REMOTEACCESS_APP_MESSAGE,invitationId:apiRTC.session.remoteAccessInvitation.id,roomname:apiRTC.session.remoteAccessInvitation.conversation._getTechnicalName(),message:kt};apiRTC.session.remoteAccessInvitation.send(Ft).then(function(){}).catch(function(sn){Ur.warn("Contact#send CONTACT_REMOTEACCESS_APP_MESSAGE message error:",sn)})}else Ur.error("Error on aic_control_onmessage, remoteAccessInvitation is not initialized")}},{key:"aic_keyboard_keydown",value:function(kt,Ft){this.aic_control_onmessage('aic_keyboard_keypress("'+kt+'","KEY_DOWN,'+Ft+'")')}},{key:"aic_keyboard_keyup",value:function(kt,Ft){this.aic_control_onmessage('aic_keyboard_keypress("'+kt+'","KEY_UP,'+Ft+'")')}},{key:"key_down",value:function(kt){if(Ur.debug("key_down"),kt.target===document.body)if(kt.preventDefault(),kt.isComposing||kt.keyCode===229)Ur.debug("Ignoring event "+kt);else if(this.keyboard_mode===0){var Ft=(kt.altKey?"MOD_ALT,":"")+(kt.ctrlKey?"MOD_CONTROL,":"")+(kt.metaKey?"MOD_META,":"")+(kt.shiftKey?"MOD_SHIFT,":"");this.aic_keyboard_keydown(kt.key,Ft)}else this.keyboard_mode===1&&this.aic_control_onmessage("aic_keyboard_keydown("+kt.keyCode+")");else Ur.debug("this is not document body, ignoring this event")}},{key:"key_up",value:function(kt){if(Ur.debug("key_up"),kt.target===document.body)if(kt.preventDefault(),kt.isComposing||kt.keyCode===229)console.log("Ignoring event "+kt);else if(this.keyboard_mode===0){var Ft=(kt.altKey?"MOD_ALT,":"")+(kt.ctrlKey?"MOD_CONTROL,":"")+(kt.metaKey?"MOD_META,":"")+(kt.shiftKey?"MOD_SHIFT,":"");this.aic_keyboard_keyup(kt.key,Ft)}else this.keyboard_mode===1&&this.aic_control_onmessage("aic_keyboard_keyup("+kt.keyCode+")");else Ur.debug("this is not document body, ignoring this event")}},{key:"window_focus_lost",value:function(kt){Ur.debug("window_focus_lost"),this.aic_keyboard_keyup("Shift","MOD_ALT,MOD_CONTROL,MOD_META,MOD_SHIFT")}},{key:"mouse_doubleclick",value:function(kt){this.mouse_move(kt),this.aic_control_onmessage("aic_mouse_doubleclick("+kt.which+")")}},{key:"mouse_down",value:function(kt){this.mouse_move(kt),this.aic_control_onmessage("aic_mouse_down("+kt.which+")")}},{key:"mouse_up",value:function(kt){this.mouse_move(kt),this.aic_control_onmessage("aic_mouse_up("+kt.which+")")}},{key:"mouse_wheel",value:function(kt){kt.preventDefault(),this.aic_control_onmessage("aic_mouse_scroll("+kt.deltaX+","+-1*kt.deltaY+")")}},{key:"mouse_move",value:function(kt){var Ft=window.screen.width,sn=window.screen.height;apiRTC.session.remoteAccessInvitation!==null&&(Ft=apiRTC.session.remoteAccessInvitation.screenWidth,sn=apiRTC.session.remoteAccessInvitation.screenHeight);var ln=getComputedStyle(kt.target),Yt=parseInt(ln.getPropertyValue("width"),10),dt=parseInt(ln.getPropertyValue("height"),10),vt=0,Dt=0,Vt=!1;Yt/parseInt(kt.target.videoWidth,10)<=dt/parseInt(kt.target.videoHeight,10)&&(Vt=!0),Vt===!0?(Ur.debug("Keeping width"),Dt=Yt*kt.target.videoHeight/kt.target.videoWidth,vt=Yt):(Ur.debug("Keeping height"),vt=dt*kt.target.videoWidth/kt.target.videoHeight,Dt=dt);var Gt=kt.target.getBoundingClientRect(),Qt=kt.clientX-Gt.left-(Yt-vt)/2,Zt=kt.clientY-Gt.top-(dt-Dt)/2,an=Math.floor(Qt/vt*Ft),Cn=Math.floor(Zt/Dt*sn);this.aic_control_onmessage("aic_mouse_move("+an+","+Cn+")")}},{key:"searchDOMElement",value:function(kt){var Ft=this;return new Promise(function(sn,ln){if(Ft.domStream=document.getElementById(kt),Ft.domStream)sn();else{var Yt="Dom element not found in searchDOMElement";Ur.debug(Yt),ln(new Error(Yt))}})}},{key:"aic_control_start",value:function(){var kt=this;return new Promise(function(Ft,sn){Ur.debug("aic_control_start"),window.oncontextmenu=function(){return!1};var ln=apiRTC.session.remoteAccessInvitation.screenSharingStreamDOMElementId;Ur.debug("domSearchFilter :",ln),kt.searchDOMElement(ln).then(function(){if(kt.domStream)Ur.debug("Adding mouse and keyboard events listeners"),document.addEventListener("keydown",kt.kd,{passive:!1}),document.addEventListener("keyup",kt.ku,{passive:!1}),document.addEventListener("blur",kt.wfl,{passive:!1}),kt.domStream.addEventListener("mousemove",kt.mm,!0),kt.domStream.addEventListener("mousedown",kt.md,!0),kt.domStream.addEventListener("mouseup",kt.mu,!0),kt.domStream.addEventListener("wheel",kt.mw,{passive:!1}),kt.controlActivated=!0,Ft();else{var Yt="Dom element not found";Ur.debug(Yt),sn(new Error(Yt))}}).catch(function(Yt){sn(Yt)})})}},{key:"aic_control_stop",value:function(){var kt=this;return Ur.debug("aic_control_stop"),new Promise(function(Ft,sn){if(window.oncontextmenu=function(){return!0},kt.domStream)Ur.debug("Removing mouse and keyboard events listeners"),document.removeEventListener("keydown",kt.kd,{passive:!1}),document.removeEventListener("keyup",kt.ku,{passive:!1}),document.removeEventListener("blur",kt.wfl,{passive:!1}),kt.domStream.removeEventListener("mousemove",kt.mm,!0),kt.domStream.removeEventListener("dblclick",kt.dc,!0),kt.domStream.removeEventListener("mousedown",kt.md,!0),kt.domStream.removeEventListener("mouseup",kt.mu,!0),kt.domStream.removeEventListener("wheel",kt.mw,{passive:!1}),kt.controlActivated=!1,Ft();else{var ln="Dom element not found";Ur.debug(ln),sn(new Error(ln))}})}},{key:"aic_agent_send_message",value:function(kt){this.ws!==void 0?this.ws.readyState===1?this.ws.send(kt):Ur.info("aic_agent_send_message : ws in not in readyState"):Ur.info("aic_agent_send_message : ws in not defined")}},{key:"ws_onopen",value:function(){var kt=this;Ur.debug("ws_onopen : Connected"),this.aic_agent_handshake_done=0,this.aic_agent_send_message("aic_agent_start()"),this.handshakeTimeoutId=setTimeout(function(){Ur.error("Timeout reached on handshake"),kt.ws.close(1e3,"HANDSHAKE_NOK")},1e3)}},{key:"ws_onmessage",value:function(kt){var Ft=kt.data;Ur.debug("received_msg :",Ft);var sn=Ft.match(/^aic_notify\(\"([^\"]*)\",\"([^\"]*)\"\)$/);sn&&sn[1]==="aic_agent_version"&&(Ur.debug("aic_agent_version is :",sn[2]),clearTimeout(this.handshakeTimeoutId),this.aic_agent_handshake_done=1,this.connectedToapplication=!0,this.send_application_status("APP_CONNECTION_OK"),apiRTC.session.remoteAccessInvitation!=null&&apiRTC.session.remoteAccessInvitation.fireEvent("application_connection_ok"))}},{key:"ws_onclose",value:function(kt){var Ft=this;Ur.debug("ws_onclose : Closed - event :",kt),this.connectedToapplication===!0?(apiRTC.session.remoteAccessInvitation!==null&&apiRTC.session.remoteAccessInvitation.stop(!0),this.connectedToapplication=!1):this.ws_reconnect()===2&&setTimeout(function(){Ft.ws_reconnect()},3e3)}},{key:"ws_onerror",value:function(kt){Ur.debug("ws_onerror : "+kt)}},{key:"ws_connect",value:function(kt){var Ft=this;Ur.debug("ws_connect : Connecting ");var sn="ws://"+this.ip+":"+kt+"/ws";Ur.debug("... on url :",sn),this.ws=new WebSocket(sn,"ws-server-aic"),this.ws.addEventListener("open",function(ln){Ft.ws_onopen(ln)}),this.ws.addEventListener("message",function(ln){Ft.ws_onmessage(ln)}),this.ws.addEventListener("close",function(ln){Ft.ws_onclose(ln)}),this.ws.addEventListener("error",function(ln){Ft.ws_onerror(ln)})}},{key:"ws_reconnect",value:function(){return this.aic_agent_running===0?0:this.port_index>=this.ports.length?(this.port_index=0,2):(this.ws_connect(this.ports[this.port_index]),this.port_index++,0)}},{key:"send_application_status",value:function(kt){if(Ur.debug("send_application_status"),apiRTC.session.remoteAccessInvitation!==null){var Ft={event:et.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE,invitationId:apiRTC.session.remoteAccessInvitation.id,roomname:apiRTC.session.remoteAccessInvitation.conversation._getTechnicalName(),status:kt};apiRTC.session.remoteAccessInvitation.sendMessageToSender(et.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE,Ft).then(function(){}).catch(function(sn){Ur.warn("Contact#send send_application_status message error:",sn)})}else Ur.warn("send_application_status but not linked to a remoteAccessInvitation")}},{key:"aic_agent_start",value:function(){Ur.debug("aic_agent_start"),"WebSocket"in window?(this.aic_agent_running=1,this.send_application_status("APP_CONNECTION_ONGOING"),apiRTC.session.remoteAccessInvitation!=null&&apiRTC.session.remoteAccessInvitation.fireEvent("application_connection_ongoing"),this.ws_reconnect(this.ip)):Ur.error("WebSocket NOT supported by your Browser!")}},{key:"aic_agent_stop",value:function(){Ur.debug("aic_agent_stop"),this.aic_agent_running=0,this.ws.close()}},{key:"aic_agent_exit",value:function(){this.aic_agent_send_message("aic_agent_exit()")}}],Xt&&Ip(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}();function _l(jt){return _l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},_l(jt)}function Rp(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function Eu(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Pl(jt,Ut){return Pl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Pl(jt,Ut)}function Ep(jt,Ut){if(Ut&&(_l(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}(jt)}function Rs(jt){return Rs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Rs(jt)}var xa=mt.Y.get("ReceivedInvitation"),wp=["stop","messageDelivered","messageNotDelivered","application_connection_ongoing","application_connection_ok"],Op=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Pl(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Rs(Ft);if(sn){var Dt=Rs(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return Ep(this,dt)});function Yt(dt,vt,Dt){var Vt,Gt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Rp(this,Yt),xa.debug("Create ReceivedRemoteAccessInvitation"),(Vt=ln.call(this,dt,vt.invitationId)).type="remoteAccess",Vt.conversation=Dt,Gt.cloudConvId&&(Vt.cloudConvId=Gt.cloudConvId),Gt.webconf===!0&&(Vt.webconf=!0),Vt.aicConsoleManager=null,Vt.screenSharingStreamId=null,Vt.screenSharingStream=null,Vt.apiRTCManager.onEvent("receiveData",function(Qt){xa.debug("ReceivedRemoteAccessInvitation receiveData "),Qt.detail.data.event!==void 0&&Qt.detail.data.event===et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER&&Qt.detail.data.invitationId.toString()===Vt.id.toString()?(xa.debug("Received stop for "+Vt.id,Qt.detail.data),Vt.stop(!1,Qt.detail.data.reason)):Qt.detail.data.event===et.g.CONTACT_REMOTEACCESS_APP_MESSAGE&&Qt.detail.data.invitationId.toString()===Vt.id.toString()&&(xa.debug("Received CONTACT_REMOTEACCESS_APP_MESSAGE for "+Vt.id,Qt.detail.data),Vt.aicConsoleManager!==null?Vt.aicConsoleManager.aic_agent_send_message(Qt.detail.data.message):xa.debug("aicConsoleManager is not initialized"))}),Vt.conversation.on("contactLeft",function(Qt){Qt.id===Vt.sender.id&&(xa.debug("Remote user has left, stopping remoteAccess"),Vt.stop(!1,{code:"AGENT_LEFT"}))}),Vt}return Ut=Yt,Xt=[{key:"accept",value:function(){var dt=this;return new Promise(function(vt,Dt){if(xa.debug("ReceivedRemoteAccessInvitation accept"),dt.getStatus()===et.g.INVITATION_STATUS_STANDBY){dt.setStatus(et.g.INVITATION_STATUS_ACCEPTED);var Vt={event:et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,invitationId:dt.id,roomname:dt.conversation._getTechnicalName(),answer:"accept"};dt.sendMessageToSender(et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,Vt).then(function(){vt(dt.id)}).catch(function(Gt){Dt(Gt)})}else Dt(Bt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot accept remote access, invitation state invalid",xa))})}},{key:"decline",value:function(){var dt=this;return new Promise(function(vt,Dt){if(xa.debug("ReceivedRemoteAccessInvitation decline"),dt.getStatus()===et.g.INVITATION_STATUS_STANDBY){dt.setStatus(et.g.INVITATION_STATUS_DECLINED);var Vt={event:et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,invitationId:dt.id,roomname:dt.conversation._getTechnicalName(),answer:"decline"};dt.sendMessageToSender(et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,Vt).then(function(){vt(dt.id)}).catch(function(Gt){Dt(Gt)}),dt.stop(!0,{code:"USER_DECLINE"})}else Dt(Bt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot decline remote access, invitation state invalid",xa))})}},{key:"sendMessageToSender",value:function(dt,vt){var Dt=this;return xa.debug("sendMessageToSender :",vt),new Promise(function(Vt,Gt){Dt.apiRTCManager.sendData(Dt.sender.getId(),vt).then(function(){tn.get(Dt).emit("messageDelivered",{event:dt,contact:Dt.sender,messageData:vt}),Vt()}).catch(function(Qt){var Zt=Bt.g.createError(Qt,"Invitation not delivered",xa);tn.get(Dt).emit("messageNotDelivered",{error:Zt,contact:Dt.sender,event:dt,messageData:vt}),Gt(Zt)})})}},{key:"fireEvent",value:function(dt,vt){tn.get(this).emit(dt,vt)}},{key:"startScreenSharingAndPublish",value:function(){var dt=this;return xa.debug("startScreenSharingAndPublish"),new Promise(function(vt,Dt){apiRTC.Stream.createDisplayMediaStream({video:{cursor:"always",displaySurface:"monitor"},surfaceSwitching:"exclude",selfBrowserSurface:"exclude",systemAudio:"exclude"}).then(function(Vt){Vt.screensharingRemoteAccessStream=!0;var Gt={},Qt={};Qt.invitationId=dt.id,Qt.screenWidth=window.screen.width,Qt.screenHeight=window.screen.height,Gt.context={remoteAccessCtx:Qt},dt.screenSharingStreamId=Vt.getId(),dt.screenSharingStream=Vt,xa.debug("setting screenSharingStreamId :",dt.screenSharingStreamId),dt.conversation.publish(Vt,Gt).then(function(Zt){dt.aicConsoleManager=new Ru,dt.aicConsoleManager.aic_agent_start(),vt(Zt)}).catch(function(Zt){var an={code:"DISPLAY_MEDIA_PUBLISH_ERROR",error:Zt};dt.stop(!0,an),Dt(Zt)})}).catch(function(Vt){xa.error("error on createDisplayMediaStream :",Vt);var Gt={code:"CREATE_DISPLAY_MEDIA_ERROR",error:Vt};dt.stop(!0,Gt),Dt(Vt)})})}},{key:"downloadApplication",value:function(){return xa.debug("downloadApplication"),new Promise(function(dt,vt){fetch("https://dev.cdn.apizee.com/apiRTC/app/remoteAccess.exe").then(function(Dt){return Dt.blob()}).then(function(Dt){var Vt=window.URL.createObjectURL(Dt),Gt=document.createElement("a");Gt.href=Vt,Gt.download="remoteAccess.exe",document.body.appendChild(Gt),Gt.click(),Gt.remove(),dt()}).catch(function(Dt){xa.error("Something went wrong during remote access application loading.. toString :",Dt.toString()),vt(new Error("error on application fetch :"+Dt.toString()))})})}},{key:"stop",value:function(){var dt=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;xa.debug("stop with sendMessage :",dt),vt==null&&(vt={code:"USER_STOP"});var Dt=this.conversation.conversationPublishedStreams.get(this.screenSharingStreamId);if(Dt!=null&&(xa.debug("streamInfo :",Dt),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Dt.callId)),this.screenSharingStream!==null&&(this.screenSharingStream.release(),this.screenSharingStream=null),this.aicConsoleManager!==null&&(this.aicConsoleManager.aic_agent_exit(),this.aicConsoleManager.aic_agent_stop(),this.aicConsoleManager=null),apiRTC.session.remoteAccessInvitation=null,dt){var Vt={event:et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER,invitationId:this.id,roomname:this.conversation._getTechnicalName(),reason:vt};this.sendMessageToSender(et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER,Vt).then(function(){}).catch(function(Gt){xa.warn("Contact#send stop message error:",Gt)})}tn.get(this).emit("stop",vt)}}],kt=[{key:"getAvailableEvents",value:function(){return wp}}],Xt&&Eu(Ut.prototype,Xt),kt&&Eu(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(On),kp=s(8364),Go=s.n(kp);function Es(jt){return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Es(jt)}function Ap(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function wu(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}s(9601),s(5306);var Mp=mt.Y.get("UserData"),xp=An.get(),Io=function(){function jt(){var Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(var sn in Ap(this,jt),Ft)Ft.hasOwnProperty(sn)&&(this[sn]=Ft[sn])}var Ut,Xt,kt;return Ut=jt,kt=[{key:"equals",value:function(Ft,sn){if(!(Ft instanceof Object&&sn instanceof Object))return!1;for(var ln in Ft)if(sn[ln]===void 0||Es(sn[ln])==="object"&&!this.equals(sn[ln],Ft[ln])||sn[ln]!==Ft[ln])return!1;for(var Yt in sn)if(Ft[Yt]===void 0||Es(Ft[Yt])==="object"&&!this.equals(Ft[Yt],sn[Yt])||Ft[Yt]!==sn[Yt])return!1;return!0}}],(Xt=[{key:"get",value:function(Ft){return this.hasOwnProperty(Ft)&&this[Ft]!==void 0&&this[Ft]!=="null"&&this[Ft]!==null?this[Ft]:null}},{key:"setToSession",value:function(){try{var Ft={};for(var sn in this)this.hasOwnProperty(sn)&&typeof this[sn]!="function"&&(Ft[sn]=this[sn]);xp.apiRTCSession.setUserData(Ft)}catch{Mp.error("setUserData() - could not set userData")}}},{key:"setProp",value:function(Ft,sn){return this[Ft]=sn,this}},{key:"setProps",value:function(Ft){for(var sn in Ft)Ft.hasOwnProperty(sn)&&(this[sn]=Ft[sn]);return this}}])&&wu(Ut.prototype,Xt),kt&&wu(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}();function Dl(jt){return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Dl(jt)}function _p(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function Ou(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Nl(jt,Ut){return Nl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Nl(jt,Ut)}function Pp(jt,Ut){if(Ut&&(Dl(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ws(jt)}function ws(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function Os(jt){return Os=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Os(jt)}var Ao=mt.Y.get("SentInvitation"),Dp=["response","receive","statusChange"],Do=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Nl(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Os(Ft);if(sn){var Dt=Os(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return Pp(this,dt)});function Yt(dt,vt){var Dt,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return _p(this,Yt),(Dt=ln.call(this)).conversation=vt,Ao.info("Create SentInvitation"),Dt.invitationType="sent",Dt.contact=dt,Dt.id=Bt.g.guid(),Dt.sendTime=Date.now(),Dt.expirationTime=null,Dt.expirationTimeout=null,Vt.hasOwnProperty("expirationTime")&&(Dt.expirationTime=Vt.expirationTime,Dt.expirationTimeout=setTimeout(function(){Dt.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(Ao.info("Conversation invitation expired"),Dt.setStatus(et.g.INVITATION_STATUS_EXPIRED),tn.get(ws(Dt)).emit("response",Dt.getStatus()))},Vt.expirationTime)),Vt.hasOwnProperty("receiveNotifier")&&Vt.receiveNotifier.on("receive",function(){tn.get(ws(Dt)).emit("receive")}),Dt.apiRTCManager.onEvent("receiveData",function(Gt){Ao.debug("SentInvitation receiveData "),Gt.detail.data.event!==void 0&&(Gt.detail.data.event!==et.g.INVITATION_ANSWER_IDENTIFIER&&Gt.detail.data.event!==et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER||Gt.detail.data.invitationId.toString()!==Dt.id.toString()||Dt.getStatus()!==et.g.INVITATION_STATUS_STANDBY||(Ao.debug("Received invitation answer for "+Dt.id,Gt.detail.data),Dt.expirationTimeout!==null&&clearTimeout(Dt.expirationTimeout),Gt.detail.data.answer==="accept"?Dt.setStatus(et.g.INVITATION_STATUS_ACCEPTED):Dt.setStatus(et.g.INVITATION_STATUS_DECLINED),tn.get(ws(Dt)).emit("response",Dt.getStatus())))}),Dt.apiRTCManager.onEvent("hangup",function(Gt){Ao.debug("hangup");var Qt=Gt.detail.callId.toString();Dt.getId()===Qt&&(Ao.debug("hangup for sentInvitation"),Dt.setStatus(et.g.INVITATION_STATUS_ENDED))}),Dt}return Ut=Yt,kt=[{key:"getAvailableEvents",value:function(){return Dp}}],(Xt=[{key:"getId",value:function(){return this.id}},{key:"onResponse",value:function(dt){this.on("response",dt)}},{key:"cancel",value:function(){Ao.info("cancel"),this.type==="sendFile"?(Ao.info("cancel sendfile"),this.apiRTCManager.webRTCClient.hangUp(this.id)):Ao.warn("cancel is not managed for invitation with type :",this.type)}},{key:"send",value:function(dt){var vt=this;return Ao.debug("SentInvitation#send"),new Promise(function(Dt,Vt){vt.apiRTCManager.sendData(vt.contact.getId(),dt).then(function(){return Dt()}).catch(function(Gt){var Qt=Bt.g.createError(Gt,"Invitation not delivered",Ao);return Vt(Qt)})})}}])&&Ou(Ut.prototype,Xt),kt&&Ou(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(or);function Ul(jt){return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Ul(jt)}function Np(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function ku(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Ll(jt,Ut){return Ll=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Ll(jt,Ut)}function Up(jt,Ut){if(Ut&&(Ul(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ks(jt)}function ks(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function As(jt){return As=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},As(jt)}var mo=mt.Y.get("SentRemoteAccessInvitation"),Lp=["response","receive","remoteAccessStreamAdded","stop","application_connection_ongoing","application_connection_ok"],$p=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Ll(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=As(Ft);if(sn){var Dt=As(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return Up(this,dt)});function Yt(dt,vt){var Dt,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Np(this,Yt),Dt=ln.call(this,dt,vt,Vt),mo.debug("Create sentRemoteAccessInvitation"),Dt.type="remoteAccess",Dt.screenSharingStreamId=null,Dt.screenSharingStream=null,Dt.aicConsoleManager=null,Dt.screenSharingStreamDOMElementId=null,Dt.apiRTCManager.onEvent("receiveData",function(Gt){mo.debug("SentRemoteAccessInvitation receiveData "),Gt.detail.data.event!==void 0&&(Gt.detail.data.event===et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER&&Gt.detail.data.invitationId.toString()===Dt.id.toString()?(mo.debug("SentRemoteAccessInvitation Received stop for "+Dt.id,Gt.detail.data),Dt.stop(!1,Gt.detail.data.reason)):Gt.detail.data.event===et.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE&&Gt.detail.data.invitationId.toString()===Dt.id.toString()&&(mo.debug("CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE : "+Dt.id,Gt.detail.data.status),Gt.detail.data.status==="APP_CONNECTION_ONGOING"?(tn.get(ks(Dt)).emit("application_connection_ongoing"),Dt.aicConsoleManager=new Ru,Dt.aicConsoleManager.controlActivated===!0&&Dt.aicConsoleManager.aic_control_stop().then(function(){tn.get(ks(Dt)).emit("controlStop")}).catch(function(Qt){mo.debug("aic_control_stop error:",Qt)})):Gt.detail.data.status==="APP_CONNECTION_OK"&&tn.get(ks(Dt)).emit("application_connection_ok")))}),Dt.conversation.on("contactLeft",function(Gt){Gt.id===Dt.contact.id&&(mo.debug("Remote user has left, stopping remoteAccess"),Dt.stop(!1,{code:"USER_LEFT"}))}),Dt}return Ut=Yt,Xt=[{key:"setRemoteAccessStream",value:function(dt){mo.debug("setRemoteAccessStream"),this.screenSharingStream=dt,tn.get(this).emit("remoteAccessStreamAdded",this.screenSharingStream)}},{key:"setScreenSharingStreamDOMElementId",value:function(dt){var vt=this;this.screenSharingStreamDOMElementId=dt,this.aicConsoleManager!==null?this.aicConsoleManager.aic_control_start().then(function(){tn.get(vt).emit("controlStart")}).catch(function(Dt){mo.warn("aic_control_start error:",Dt)}):mo.debug("aicConsoleManager is not activated")}},{key:"toggleMouseAndKeyboardAccess",value:function(){var dt=this;return mo.debug("toggleMouseAndKeyboardAccess"),new Promise(function(vt,Dt){if(dt.aicConsoleManager!==null)dt.aicConsoleManager.controlActivated===!0?dt.aicConsoleManager.aic_control_stop().then(function(){tn.get(dt).emit("controlStop"),vt()}).catch(function(Gt){Dt(Gt)}):dt.aicConsoleManager.aic_control_start().then(function(){tn.get(dt).emit("controlStart"),vt()}).catch(function(Gt){Dt(Gt)});else{var Vt="aicConsoleManager is not activated";mo.debug(Vt),Dt(new Error(Vt))}})}},{key:"getMouseAndKeyboardAccessStatus",value:function(){return this.aicConsoleManager.controlActivated}},{key:"stop",value:function(){var dt=this,vt=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(mo.debug("stop"),Dt==null&&(Dt={code:"AGENT_STOP"}),this.aicConsoleManager!==null&&(this.aicConsoleManager.controlActivated===!0&&this.aicConsoleManager.aic_control_stop().then(function(){tn.get(dt).emit("controlStop")}).catch(function(Gt){mo.warn("aic_control_stop error:",Gt)}),this.aicConsoleManager=null),vt){var Vt={event:et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER,invitationId:this.id,roomname:this.conversation._getTechnicalName(),reason:Dt};this.send(Vt).then(function(){}).catch(function(Gt){mo.warn("Contact#send stop message error:",Gt)})}apiRTC.session.remoteAccessInvitation!==null&&(tn.get(this).emit("stop",Dt),apiRTC.session.remoteAccessInvitation=null)}}],kt=[{key:"getAvailableEvents",value:function(){return Lp}}],Xt&&ku(Ut.prototype,Xt),kt&&ku(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(Do);function $l(jt){return $l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},$l(jt)}function Au(jt,Ut){var Xt=typeof Symbol<"u"&&jt[Symbol.iterator]||jt["@@iterator"];if(!Xt){if(Array.isArray(jt)||(Xt=function(dt,vt){if(dt){if(typeof dt=="string")return Mu(dt,vt);var Dt=Object.prototype.toString.call(dt).slice(8,-1);return Dt==="Object"&&dt.constructor&&(Dt=dt.constructor.name),Dt==="Map"||Dt==="Set"?Array.from(dt):Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt)?Mu(dt,vt):void 0}}(jt))||Ut&&jt&&typeof jt.length=="number"){Xt&&(jt=Xt);var kt=0,Ft=function(){};return{s:Ft,n:function(){return kt>=jt.length?{done:!0}:{done:!1,value:jt[kt++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Yt=!1;return{s:function(){Xt=Xt.call(jt)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Yt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Yt)throw sn}}}}function Mu(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function jp(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function xu(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Fl(jt,Ut){return Fl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Fl(jt,Ut)}function Fp(jt,Ut){if(Ut&&($l(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kr(jt)}function Kr(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function Ms(jt){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Ms(jt)}var nr=mt.Y.get("Contact"),Vr=An.get(),es=new(Go()),Wl=Ar.get(),Wp=["message","conversationInvitation","data","joinGroup","leaveGroup","whiteboardInvitation","fileSentSuccessfully","fileTransferInvitation","fileTransferProgress","dataChannelInvitation","incomingCall","newMediaAvailable","customEvent","fileTransferError","incomingScreenSharingCall","incomingScreenSharingCallInvitation"],Bl=new WeakMap,_u=new WeakMap,Vl=new Map,No=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Fl(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Ms(Ft);if(sn){var Dt=Ms(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return Fp(this,dt)});function Yt(dt){var vt,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return jp(this,Yt),vt=ln.call(this,nr),nr.debug("Create Contact with id "+dt),nr.debug("Create Contact with userData :",Dt),_u.set(Kr(vt),dt.toString()),vt.groups=[],vt.previousMessages=[],vt.userData=new Io(Dt),vt.enterprise=null,vt.streams=new Map,vt.profile=null,vt.fileTransfers=[],vt.promises=[],Bl.set(Kr(vt),[]),Vr.onEvent("roomInvitation",function(Vt){if(Vt.detail.senderId!==null&&Vt.detail.senderId!==void 0&&Vt.detail.roomType==="whiteBoard"&&Vt.detail.senderId.toString()===vt.getId()){nr.info("Received whiteboard invitation from "+vt.getUsername());var Gt={};Vt.detail.cloudConvId&&(Gt.cloudConvId=Vt.detail.cloudConvId),Vt.detail.webconf===!0&&(Gt.webconf=!0),tn.get(Kr(vt)).emit("whiteboardInvitation",new vs(Kr(vt),Vt.detail.roomId,Gt))}}).onEvent("receiveIMMessage",function(Vt){Vt.detail.senderId.toString()===vt.getId()&&(tn.get(Kr(vt)).emit("message",{content:Vt.detail.message,uuid:Vt.detail.UUCSeq,time:Vt.detail.time}),vt.addMessageToHistory(Vt.detail.message,Math.round(Vt.detail.time.getTime()/1e3),Vt.detail.UUCSeq,!0))}).onEvent("receiveData",function(Vt){if(Vt.detail.senderId.toString()===vt.getId()){nr.debug("Received data e.detail.data : ",Vt.detail.data);var Gt=Vt.detail.data,Qt=null,Zt=po.get();if(Gt.roomname!==void 0&&(Qt=Zt.isConference(Gt.roomname)?Zt.getOrCreateConference(Zt.getNameFromTechnicalName(Gt.roomname)):Zt.getOrCreateConversation(Zt.getNameFromTechnicalName(Gt.roomname))),Gt.apiRTCRequest===!0&&vt.manageApiRTCRequest(Vt.detail,Qt),Gt.event!==void 0)switch(Gt.event){case et.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER:case et.g.INVITATION_ANSWER_IDENTIFIER:break;case et.g.CONTACT_SEND_DATA_IDENTIFIER:nr.trace("Received data from "+vt.getUsername(),Gt.content),tn.get(Kr(vt)).emit("data",Gt.content);break;case et.g.CONVERSATION_INVITATION_IDENTIFIER:if(Qt!==null){nr.debug("Received conversation invitation from "+vt.getId());var an={};Gt.hasOwnProperty("password")&&(an.password=Gt.password),tn.get(Kr(vt)).emit("conversationInvitation",new $t(Kr(vt),Gt,Qt,an))}break;case et.g.CONTACT_SEND_FILEINFO_IDENTIFIER:nr.debug("Received file info from "+vt.getUsername(),Gt.fileInfo);var Cn=Gt.callId.toString();if(Bt.g._private.dataCallsFileInfo.set(Cn,Gt.fileInfo),Bt.g._private.dataCallsOnHold.has(Cn)){var Rn=null;apiRTC.userAgentInstance.currentSession.invitationsMap.has(vt.getId()+"-sendfile-"+Cn)?(Rn=apiRTC.userAgentInstance.currentSession.invitationsMap.get(vt.getId()+"-sendfile-"+Cn),nr.debug("invitation already exist :",Rn)):(Rn=new eo(Kr(vt),Cn,Gt.fileInfo),apiRTC.userAgentInstance.currentSession.invitationsMap.set(vt.getId()+"-sendfile-"+Cn,Rn)),tn.get(Kr(vt)).emit("fileTransferInvitation",Rn)}break;case et.g.CONTACT_DATACHANNEL_INVITATION:nr.debug("Received datachannel invitation from "+vt.getUsername()),Bt.g._private.dataChannelInvitations.set(Gt.callId.toString(),!0),Bt.g._private.dataCallsOnHold.has(Gt.callId.toString())&&tn.get(Kr(vt)).emit("dataChannelInvitation",new zo(Kr(vt),Gt.callId.toString()));break;case et.g.CONTACT_NEW_MEDIA_IDENTIFIER:nr.debug("New media available from "+vt.getUsername(),Gt.fileinfo),tn.get(Kr(vt)).emit("newMediaAvailable",{media:Gt.media});break;case et.g.CONTACT_EVENTCENTER_DATA_REQUEST:nr.debug("New request for event center data from "+vt.getUsername());var Kn=apiRTC.eventCenter.getStoredData();if(Kn===void 0)return void nr.error("Can't send event center stored data, it's undefined");nr.debug("Sending requested event center data"),vt.sendCustomEvent(et.g.CONTACT_EVENTCENTER_DATA_ANSWER,{data:Kn});break;case et.g.CONTACT_EVENTCENTER_DATA_ANSWER:if(nr.debug("New event center data from "+vt.getUsername()),Gt.data===void 0)return void nr.error("Can't handle remote event center data, it's undefined");apiRTC.eventCenter.handleDataAnswer(Gt.data);break;case et.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_IDENTIFIER:nr.debug("New getAudioFlowStatus from "+Gt.requesterId+" on stream "+Gt.streamId);var Xn=vt.getContact(Gt.requesterId),dr=vt.getLocalStreamPublished();if(dr===null)return vt.sendToContactRemoteStreamError("No stream found on remote",Xn,Gt);Xn.sendCustomEvent(et.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_RESULT_IDENTIFIER,{callId:Gt.callId,streamId:Gt.streamId,timeout:Gt.timeout,audioFlowStatus:dr.getAudioFlowStatus()});break;case et.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_IDENTIFIER:nr.debug("New getVideoFlowStatus from "+Gt.requesterId+" on stream "+Gt.streamId);var hr=vt.getContact(Gt.requesterId),Mr=vt.getLocalStreamPublished();if(Mr===null)return vt.sendToContactRemoteStreamError("No stream found on remote",hr,Gt);hr.sendCustomEvent(et.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_RESULT_IDENTIFIER,{callId:Gt.callId,streamId:Gt.streamId,timeout:Gt.timeout,videoFlowStatus:Mr.getVideoFlowStatus()});break;case et.g.CONTACT_GET_SETTINGS_IDENTIFIER:nr.debug("CONTACT_GET_SETTINGS_IDENTIFIER");var Xr,_i=vt.getContact(Gt.requesterId);if((Xr=Gt.mediaStreamId!==void 0?vt.getLocalStreamWithMediaStreamId(Gt.mediaStreamId):vt.getLocalStreamWithCallId(Gt.streamId))===null)return vt.sendToContactRemoteStreamError("No stream found on remote",_i,Gt);Xr.getSettings().then(function(lo){_i.sendCustomEvent(et.g.CONTACT_GET_SETTINGS_RESULT_IDENTIFIER,{callId:Gt.callId,streamId:Gt.streamId,timeout:Gt.timeout,settings:lo})}).catch(function(lo){vt.sendToContactRemoteStreamError(lo.message,_i,Gt)});break;case et.g.CONTACT_GET_CAPABILITIES_IDENTIFIER:nr.debug("CONTACT_GET_CAPABILITIES_IDENTIFIER");var Vo,sr=vt.getContact(Gt.requesterId);if((Vo=Gt.mediaStreamId!==void 0?vt.getLocalStreamWithMediaStreamId(Gt.mediaStreamId):vt.getLocalStreamWithCallId(Gt.streamId))===null)return vt.sendToContactRemoteStreamError("No stream found on remote",sr,Gt);Vo.getCapabilities().then(function(lo){sr.sendCustomEvent(et.g.CONTACT_GET_CAPABILITIES_RESULT_IDENTIFIER,{callId:Gt.callId,streamId:Gt.streamId,timeout:Gt.timeout,capabilities:lo})}).catch(function(lo){vt.sendToContactRemoteStreamError(lo.message,sr,Gt)});break;case et.g.CONTACT_GET_CONSTRAINTS_IDENTIFIER:nr.debug("New getConstraints from "+Gt.requesterId);var tr=vt.getContact(Gt.requesterId),Ir=vt.getLocalStreamPublished();if(Ir===null)return vt.sendToContactRemoteStreamError("No stream found on remote",tr,Gt);Ir.getConstraints().then(function(lo){tr.sendCustomEvent(et.g.CONTACT_GET_CONSTRAINTS_RESULT_IDENTIFIER,{callId:Gt.callId,streamId:Gt.streamId,timeout:Gt.timeout,constraints:lo})}).catch(function(lo){vt.sendToContactRemoteStreamError(lo.message,tr,Gt)});break;case et.g.CONTACT_APPLY_CONSTRAINTS_IDENTIFIER:var Or;nr.debug("CONTACT_APPLY_CONSTRAINTS_IDENTIFIER"),Or=Gt.mediaStreamId!==void 0?vt.getLocalStreamWithMediaStreamId(Gt.mediaStreamId):vt.getLocalStreamWithCallId(Gt.streamId);var br=vt.getContact(Gt.requesterId);if(Or===null)return vt.sendToContactRemoteStreamError("No stream found on remote",br,Gt);Or.applyConstraints(Gt.constraints).then(function(){br.sendCustomEvent(et.g.CONTACT_APPLY_CONSTRAINTS_RESULT_IDENTIFIER,{callId:Gt.callId,streamId:Gt.streamId,timeout:Gt.timeout}),Or.emitConstraintsChanged(Gt.constraints)}).catch(function(lo){vt.sendToContactRemoteStreamError(lo.message,br,Gt)});break;case et.g.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER:var $a;nr.debug("CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER from :"+Gt.requesterId),($a=apiRTC.userAgentInstance.getStreamWithMediaStreamId(Gt.mediaStreamId))!=="NOT_FOUND"&&$a.emitConstraintsChanged(Gt.constraints);break;case et.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_RESULT_IDENTIFIER:nr.debug("getRemoteAudioFlowStatus result :",Gt);var to=vt.getRemoteStreamSubscribed(Gt.callId,Gt.streamId);to===null?nr.error("Can't find the local stream to resolve the request.."):to.resolvePendingPromise(Gt.timeout,Gt.audioFlowStatus);break;case et.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_RESULT_IDENTIFIER:nr.debug("getRemoteVideoFlowStatus result :",Gt);var vo=vt.getRemoteStreamSubscribed(Gt.callId,Gt.streamId);vo===null?nr.error("Can't find the local stream to resolve the request.."):vo.resolvePendingPromise(Gt.timeout,Gt.videoFlowStatus);break;case et.g.CONTACT_GET_SETTINGS_RESULT_IDENTIFIER:nr.debug("remote getSettings result :",Gt);var ko=vt.getRemoteStreamSubscribed(Gt.callId,Gt.streamId);ko===null?nr.error("Can't find the local stream to resolve the request.."):ko.resolvePendingPromise(Gt.timeout,Gt.settings);break;case et.g.CONTACT_GET_CAPABILITIES_RESULT_IDENTIFIER:nr.debug("remote getCapabilities result :",Gt);var Wr=vt.getRemoteStreamSubscribed(Gt.callId,Gt.streamId);Wr===null?nr.error("Can't find the local stream to resolve the request.."):Wr.resolvePendingPromise(Gt.timeout,Gt.capabilities);break;case et.g.CONTACT_GET_CONSTRAINTS_RESULT_IDENTIFIER:nr.debug("remote getConstraints result :",Gt);var ho=vt.getRemoteStreamSubscribed(Gt.callId,Gt.streamId);ho===null?nr.error("Can't find the local stream to resolve the request.."):ho.resolvePendingPromise(Gt.timeout,Gt.constraints);break;case et.g.CONTACT_GET_REMOTE_ERROR:nr.debug("remote stream request error:",Gt);var So=vt.getRemoteStreamSubscribed(Gt.callId,Gt.streamId);So===null?nr.error("Can't find the local stream to reject the request.."):So.rejectPendingPromise(Gt.timeout,Gt.message);break;case et.g.CONTACT_APPLY_CONSTRAINTS_RESULT_IDENTIFIER:nr.debug("remote applyConstraints result :",Gt);var ps=vt.getRemoteStreamSubscribed(Gt.callId,Gt.streamId);ps===null?nr.error("Can't find the local stream to resolve the request.."):ps.resolvePendingPromise(Gt.timeout,Gt.constraints);break;default:var hs={event:Gt.event,content:Gt};Qt!==null&&(hs.conversation=Qt),tn.get(Kr(vt)).emit("customEvent",hs)}}}).onEvent("incomingCall",function(Vt){if(Vt.detail.callerId.toString()===vt.getId()){var Gt=Vt.detail.callId.toString();if(Vt.detail.callType==="data")if(nr.debug("Received file transfer invitation from "+vt.getUsername()),Bt.g._private.dataCallsFileInfo.has(Gt)){var Qt=Bt.g._private.dataCallsFileInfo.get(Gt),Zt=null;apiRTC.userAgentInstance.currentSession.invitationsMap.has(vt.getId()+"-sendfile-"+Gt)?(Zt=apiRTC.userAgentInstance.currentSession.invitationsMap.get(vt.getId()+"-sendfile-"+Gt),nr.debug("invitation already exist :",Zt)):(Zt=new eo(Kr(vt),Gt,Qt),apiRTC.userAgentInstance.currentSession.invitationsMap.set(vt.getId()+"-sendfile-"+Gt,Zt)),tn.get(Kr(vt)).emit("fileTransferInvitation",Zt)}else Bt.g._private.dataChannelInvitations.has(Gt)?tn.get(Kr(vt)).emit("dataChannelInvitation",new zo(Kr(vt),Gt)):(nr.info("File information has not been received yet, putting invitation on hold"),Bt.g._private.dataCallsOnHold.set(Gt));else if(Vt.detail.callType==="screenSharing"||Vt.detail.callType==="screenSharingWithAudio")if(apiRTC.session.apiCCWebRTCClient.webRTCClient.userAcceptOnIncomingScreenSharingCall===!0){nr.debug("Received screenSharingCallInvitation from "+vt.getUsername());var an=new Er(Kr(vt),Gt,Vt.detail.callType,{isRecorded:!!Vt.detail.hasOwnProperty("recordedCall")&&Vt.detail.recordedCall});tn.get(Kr(vt)).emit("incomingScreenSharingCallInvitation",an)}else{nr.debug("Received screenSharingCall from "+vt.getUsername());var Cn=Wl.getOrCreateCall(Gt,Kr(vt),{started:!0,isRecorded:!!Vt.detail.hasOwnProperty("recordedCall")&&Vt.detail.recordedCall});tn.get(Kr(vt)).emit("incomingScreenSharingCall",Cn)}else nr.info("Received call invitation from "+vt.getUsername()),tn.get(Kr(vt)).emit("incomingCall",new Er(Kr(vt),Gt,Vt.detail.callType,{isRecorded:!!Vt.detail.hasOwnProperty("recordedCall")&&Vt.detail.recordedCall}))}}).onEvent("hangup",function(Vt){var Gt=Vt.detail.callId.toString();vt.getId()===Vt.detail.remoteId.toString()&&(nr.debug("hangup event :",Vt.detail),vt.fileTransfers.includes(Gt)&&(nr.info("File transfer finished from "+vt.getUsername()),vt.fileTransfers.splice(vt.fileTransfers.indexOf(Gt),1)))}).onEvent("sendDataChannelError",function(Vt){var Gt=Vt.detail.callId.toString();vt.getId()===Vt.detail.remoteId.toString()&&vt.fileTransfers.includes(Gt)&&(nr.info("File transfer error from "+vt.getUsername()),tn.get(Kr(vt)).emit("fileTransferError",{error:"sendDataChannelError",invitationId:Gt}))}).onEvent("fetchUserDataAnswer",function(Vt){vt.getId()===Vt.detail.id.toString()&&(vt.userData=new Io(Vt.detail.userData),vt.promises.forEach(function(Gt){Vt.detail.timeout===Gt.timeout&&(clearTimeout(Gt.timeout),Gt.resolve(Vt.detail.userData))}))}),vt}return Ut=Yt,Xt=[{key:"getId",value:function(){return _u.get(this)}},{key:"id",get:function(){return nr.warn("contact.id is deprecated, please use contact.getId() instead"),this.getId()}},{key:"fetchProfileInformation",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Promise(function(Vt,Gt){vt.profile===null||Dt?es.getUserProfile(Vr.getActiveApiKey(),vt.getId(),dt).then(function(Qt){vt.profile=Qt,Vt(Qt)}).catch(Gt):Vt(vt.profile)})}},{key:"getActiveStreams",value:function(){return this.streams.values()}},{key:"getLocalStreamWithCallId",value:function(dt){for(var vt=null,Dt=so.getLocalStreams(),Vt=Dt.next();!Vt.done;){for(var Gt=Vt.value,Qt=Gt.publishedInConversations.values(),Zt=Qt.next();!Zt.done;)Zt.value===dt&&(nr.debug("Finding Stream in a conversation"),vt=Gt),Zt=Qt.next();Gt.callId===dt&&(nr.debug("Finding Stream in a call"),vt=Gt),Vt=Dt.next()}return vt}},{key:"getLocalStreamPublished",value:function(){var dt=so.getLocalStreams().next();return dt.value===void 0?null:dt.value}},{key:"getLocalStreamWithMediaStreamId",value:function(dt){for(var vt=null,Dt=so.getLocalStreams(),Vt=Dt.next();!Vt.done;){var Gt=Vt.value;if(Gt.data.id===dt)return Gt;Vt=Dt.next()}return vt}},{key:"getRemoteStreamSubscribed",value:function(dt,vt){var Dt=Br.getActiveSession().getCall(dt);if(Dt){nr.debug("remote stream is associated to a call");var Vt,Gt=Au(Dt.getReceivedStreams());try{for(Gt.s();!(Vt=Gt.n()).done;){var Qt=Vt.value;if(Qt.getId()===vt)return Qt}}catch(dr){Gt.e(dr)}finally{Gt.f()}}else{var Zt=Br.getActiveSession().getActiveConversations(),an=Br.getActiveSession().getActiveConferences();for(var Cn in Zt){var Rn=Zt[Cn].getSubscribedStream(vt);if(Rn!==void 0)return nr.debug("remote stream is associated to a conversation"),Rn}for(var Kn in an){var Xn=an[Kn].getSubscribedStream(vt);if(Xn!==void 0)return nr.debug("remote stream is associated to a conference"),Xn}}return null}},{key:"addMessageToHistory",value:function(dt,vt,Dt,Vt){Bl.get(this).indexOf(Dt.toString())===-1&&(this.previousMessages.push({content:dt,timestamp:vt,uuid:Dt,fromContact:Vt}),Bl.get(this).push(Dt.toString()))}},{key:"getPreviousMessages",value:function(){return this.previousMessages.sort(function(dt,vt){return new Date(vt.timestamp)-new Date(dt.timestamp)}),this.previousMessages}},{key:"getUserData",value:function(){return this.userData}},{key:"getRemoteAccessSupport",value:function(){var dt=!1;return this.userData.remoteAccessUserSupport==="ON"&&(dt=!0),dt}},{key:"fetchUserData",value:function(){var dt=this;return new Promise(function(vt,Dt){var Vt=setTimeout(function(){Dt("Timeout error during fetchUserData() process")},5e3);dt.promises.push({timeout:Vt,resolve:vt}),apiRTC.session.fetchUserData({apiKey:Vr.getActiveApiKey(),id:dt.getId(),timeout:Vt})})}},{key:"getUsername",value:function(){return this.userData.get("username")!==null?this.userData.get("username"):this.userData.get("nickname")!==null?this.userData.get("nickname"):this.getId()}},{key:"getPhotoUrl",value:function(){return this.userData.get("photo_url")!==null?this.userData.get("photo_url"):this.userData.get("photoUrl")!==null?this.userData.get("photoUrl"):null}},{key:"fetchWebSessionInformation",value:function(dt){var vt=this;return new Promise(function(Dt,Vt){dt instanceof Br?Vl.has(vt.getId()+":"+dt.getId())?Dt(Vl.get(vt.getId()+":"+dt.getId())):es.getWebSession(dt,vt,Vr.getActiveApiKey()).then(function(Gt){Vl.set(vt.getId()+":"+dt.getId(),Gt),Dt(Gt)}).catch(function(Gt){Vt(Bt.g.createError(et.g.ERROR_OTHER,"fetchWebSessionInformation() - could not fetch web session information",nr))}):Vt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"fetchWebSessionInformation() - parameter is not an instance of apiRTC.Session",nr))})}},{key:"loadMessageHistory",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,Gt){vt.fetchWebSessionInformation(dt).then(function(Qt){return es.getSessionHistory(Qt.webSessionId,dt.getToken(),Dt)}).then(function(Qt){nr.debug("loadMessageHistory() - got messages",Qt.messages);var Zt,an=Au(Qt.messages);try{for(an.s();!(Zt=an.n()).done;){var Cn=Zt.value;vt.addMessageToHistory(Cn.value,Cn.timestamp,Cn.uuid,Cn.destId.toString()!==vt.getId())}}catch(Rn){an.e(Rn)}finally{an.f()}Vt()}).catch(function(Qt){Gt(Bt.g.createError(et.g.ERROR_OTHER,"loadMessageHistory() - could not load session history",nr))})})}},{key:"addToGroup",value:function(dt){this.inGroup(dt)||(this.groups.push(dt),tn.get(this).emit("joinGroup",dt))}},{key:"removeFromGroup",value:function(dt){this.inGroup(dt)&&(this.groups.splice(this.groups.indexOf(dt),1),tn.get(this).emit("leaveGroup",dt))}},{key:"inGroup",value:function(dt){return this.groups.includes(dt)}},{key:"isOnline",value:function(){return this.groups.length!==0}},{key:"sendData",value:function(dt){var vt=this;return this.isOnline()||nr.warn("sendData() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Dt,Vt){Vr.sendData(vt.getId(),{event:et.g.CONTACT_SEND_DATA_IDENTIFIER,content:dt}).then(Dt).catch(function(Gt){switch(Gt){case et.g.ERROR_TIMED_OUT:Vt(Bt.g.createError(et.g.ERROR_TIMED_OUT,"sendData() - Data transmission timed out ",nr));break;case et.g.ERROR_NOT_FOUND:Vt(Bt.g.createError(et.g.ERROR_NOT_FOUND,"sendData() - Contact was not found ",nr));break;default:Vt(Bt.g.createError(et.g.ERROR_OTHER,"sendData() - Data default error ",nr))}})})}},{key:"sendCustomEvent",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isOnline()||nr.warn("sendCustomEvent() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Vt,Gt){var Qt=Dt;Qt.event=dt,Vr.sendData(vt.getId(),Qt).then(Vt).catch(function(Zt){switch(Zt){case et.g.ERROR_TIMED_OUT:Gt(Bt.g.createError(et.g.ERROR_TIMED_OUT,"sendCustomEvent() - Data transmission timed out ",nr));break;case et.g.ERROR_NOT_FOUND:Gt(Bt.g.createError(et.g.ERROR_NOT_FOUND,"sendCustomEvent() - Contact was not found ",nr));break;default:Gt(Bt.g.createError(et.g.ERROR_OTHER,"sendCustomEvent() - Data transmission timed out ",nr))}})})}},{key:"sendRequest",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isOnline()||nr.warn("sendRequest() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Vt,Gt){var Qt=(Math.random()*new Date().getTime()).toString(36).replace(/\./g,"-");Vr.onceEvent("receiveData",function(an){nr.debug("Received data e.detail.data : ",an.detail.data),an.detail.data.apiRTCAnswer===!0&&(an.detail.data.requestUUID===Qt?Vt():nr.error("uuid is not correct"))});var Zt=Dt;Zt.apiRTCRequest=!0,Zt.requestType=dt,Zt.uuid=Qt,Vr.sendData(vt.getId(),Zt).then(function(){nr.debug("sendData ok")}).catch(function(an){nr.error("Error on sendData",an),Gt()})})}},{key:"sendAnswer",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isOnline()||nr.warn("sendRequest() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Vt,Gt){var Qt=Dt;Qt.apiRTCAnswer=!0,Qt.answerType=dt,Vr.sendData(vt.getId(),Qt).then(function(){Vt()}).catch(function(Zt){nr.error("Error on sendData",Zt),Gt()})})}},{key:"sendDataAnswer",value:function(dt,vt,Dt){this.getContact(dt.senderId).sendAnswer(vt,Dt).then(function(){nr.debug("sendAnswer OK")}).catch(function(Vt){nr.error("Error on sendAnswer",Vt)})}},{key:"manageApiRTCStreamRequest",value:function(dt,vt){var Dt=this;nr.debug("manageApiRTCStreamRequest : ",dt);var Vt=dt.data.requestType,Gt={};Gt.requestUUID=dt.data.uuid,Gt.result="NOK";var Qt=null;if((Qt=apiRTC.userAgentInstance.getStreamWithRoomNameAndCallId(vt.getName(),dt.data.streamId))==="NOT_FOUND")Gt.reason="STREAM_NOT_FOUND",this.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,Gt);else if(Vt!==void 0)switch(Vt){case et.g.CONTACT_DISABLE_AUDIO_REQUEST:Qt.disableAudio().then(function(){Gt.result="OK",Dt.sendDataAnswer(dt,et.g.CONTACT_DISABLE_AUDIO_ANSWER,Gt)}).catch(function(){Gt.reason="ERROR_ON_DISABLE_AUDIO",Dt.sendDataAnswer(dt,et.g.CONTACT_DISABLE_AUDIO_ANSWER,Gt)});break;case et.g.CONTACT_ENABLE_AUDIO_REQUEST:Qt.enableAudio().then(function(){Gt.result="OK",Dt.sendDataAnswer(dt,et.g.CONTACT_ENABLE_AUDIO_ANSWER,Gt)}).catch(function(){Gt.reason="ERROR_ON_ENABLE_AUDIO",Dt.sendDataAnswer(dt,et.g.CONTACT_ENABLE_AUDIO_ANSWER,Gt)});break;case et.g.CONTACT_DISABLE_VIDEO_REQUEST:Qt.disableVideo().then(function(){Gt.result="OK",Dt.sendDataAnswer(dt,et.g.CONTACT_DISABLE_VIDEO_ANSWER,Gt)}).catch(function(){Gt.reason="ERROR_ON_DISABLE_VIDEO",Dt.sendDataAnswer(dt,et.g.CONTACT_DISABLE_VIDEO_ANSWER,Gt)});break;case et.g.CONTACT_ENABLE_VIDEO_REQUEST:Qt.enableVideo().then(function(){Gt.result="OK",Dt.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,Gt)}).catch(function(){Gt.reason="ERROR_ON_ENABLE_VIDEO",Dt.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,Gt)});break;default:nr.error("not a defined apiRTC request :",Vt),Gt.reason="ERROR_ON_REQUESTTYPE",this.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,Gt)}else nr.error("requestType is undefined :",Vt),Gt.reason="ERROR_ON_REQUESTTYPE",this.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,Gt)}},{key:"manageApiRTCRequest",value:function(dt,vt){nr.debug("manageApiRTCRequest : ",dt);var Dt=dt.data.requestType,Vt={};if(Vt.requestUUID=dt.data.uuid,Vt.result="NOK",Dt!==void 0)switch(Dt){case et.g.CONTACT_DISABLE_AUDIO_REQUEST:case et.g.CONTACT_ENABLE_AUDIO_REQUEST:case et.g.CONTACT_DISABLE_VIDEO_REQUEST:case et.g.CONTACT_ENABLE_VIDEO_REQUEST:this.manageApiRTCStreamRequest(dt,vt);break;default:nr.error("not a defined apiRTC request :",Dt),Vt.reason="ERROR_ON_REQUESTTYPE",this.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,Vt)}}},{key:"sendMessage",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.isOnline()||nr.warn("sendMessage() - contact "+this.getUsername()+" does not seem to be connected.");var Vt=null,Gt=function(){return new Promise(function(Qt,Zt){Dt.hasOwnProperty("session")?vt.fetchWebSessionInformation(Dt.session).then(function(an){Qt({save:!0,cloudSessionId:an.webSessionId,apiRTCId:Dt.session.getId()})}).catch(Zt):Qt({})})};return new Promise(function(Qt,Zt){return typeof dt!="string"?Zt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"sendMessage() - message parameter is not instance of string",nr)):dt===""?Zt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"sendMessage() - message parameter is empty",nr)):void Gt().then(function(an){Vt=an,nr.info("sendMessage() - with options :",Vt),Vr.sendMessage(vt.getId(),dt,Vt).then(function(Cn){vt.addMessageToHistory(dt,Math.floor(Date.now()/1e3),Cn,!1),Qt(Cn)}).catch(function(Cn){switch(Cn){case et.g.ERROR_TIMED_OUT:Zt(Bt.g.createError(et.g.ERROR_TIMED_OUT,"sendMessage() - Data transmission timed out ",nr));break;case et.g.ERROR_NOT_FOUND:Zt(Bt.g.createError(et.g.ERROR_NOT_FOUND,"sendMessage() - Contact was not found ",nr));break;default:Zt(Bt.g.createError(et.g.ERROR_OTHER,"sendMessage() - Data transmission timed out ",nr))}})},function(an){Zt(Bt.g.createError(et.g.ERROR_OTHER,"sendMessage() - Error occured when fetching options for sending message",nr))})})}},{key:"inviteTo",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.sendConversationInvitation(dt,vt)}},{key:"sendConversationInvitation",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return dt instanceof jo?dt.sendInvitation(this,vt):(nr.error("sendConversationInvitation() - Parameter is not a conversation"),null)}},{key:"sendWhiteboardInvitation",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Vr.whiteBoardClient.roomId!==dt&&(Vr.whiteBoardClient.leaveRoom(),Vr.whiteBoardClient.start(),Vr.whiteBoardClient.joinRoom(dt));var Dt=vt.context?vt.context:null,Vt={};vt.cloudConversationId&&(Vt.convId=vt.cloudConversationId),Vr.whiteBoardClient.inviteInRoom(dt,this.getId(),Dt,Vt);var Gt=new Do(this,null);return Gt.id="wb-"+dt,Gt.type="whiteboard",Gt}},{key:"call",value:function(dt){var vt,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{mediaTypeForOutgoingCall:"VIDEO",record:!1};this.isOnline()||nr.warn("call() - contact "+this.getUsername()+" does not seem to be connected.");var Vt={},Gt=Bt.g.assignObject({},Dt),Qt=!!Dt.hasOwnProperty("audioOnly")&&Dt.audioOnly;Dt.hasOwnProperty("record")&&(Gt.record!==void 0&&Gt.record!==null||(Gt.record=Dt.record)),dt!==null&&dt instanceof so&&(Gt.userMediaStreamId=dt.userMediaStreamId,dt.isScreensharing()&&(Gt.forceCallType="screenSharing")),Gt.cloudConversationId&&(Vt.cloudConvId=Gt.cloudConversationId,delete Gt.cloudConversationId),vt=Qt?Vr.webRTCClient.callAudio(this.getId(),Vt,Gt):Vr.webRTCClient.call(this.getId(),Vt,Gt);var Zt=Wl.getOrCreateCall(vt,this,{isRecorded:Gt.record});return Zt}},{key:"shareScreen",value:function(){var dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.isOnline()||nr.warn("call() - contact "+this.getUsername()+" does not seem to be connected.");var vt={},Dt=null,Vt=dt,Gt=dt.captureSourceType;nr.warn("call() - contact "+this.getUsername()+" does not seem to be connected."),Dt=Vr.webRTCClient.shareScreen(this.getId(),vt,Gt);var Qt=Wl.getOrCreateCall(Dt,this,{isRecorded:Vt.record});return Qt}},{key:"startDataChannel",value:function(){if(this.isOnline()||nr.warn("startDataChannel() - contact "+this.getUsername()+" does not seem to be connected."),!(ft.Xh==="Edge"&&ft.PR<79&&apiRTC.browserDetails.type!=="chrome")){var dt=Vr.webRTCClient.startDataChannel(this.getId());return Vr.sendData(this.getId(),{callId:dt,event:et.g.CONTACT_DATACHANNEL_INVITATION}),new ys(dt,this,{type:et.g.DATACHANNEL_TYPE_SEND})}nr.warn("Cannot startDataChannel as it is not supported on Edge")}},{key:"sendFile",value:function(dt,vt){if(this.isOnline()||nr.warn("sendFile() - contact "+this.getUsername()+" does not seem to be connected."),ft.Xh==="Edge"&&ft.PR<79&&apiRTC.browserDetails.type!=="chrome")return nr.warn("Cannot sendFile as Datachannel is not supported on Edge"),null;var Dt=Vr.webRTCClient.startDataChannel(this.getId()),Vt=this;if(Dt===void 0)return nr.warn("Error on startDataChannel"),null;Vr.sendData(this.getId(),{fileInfo:dt,callId:Dt,event:et.g.CONTACT_SEND_FILEINFO_IDENTIFIER}),Vr.onEvent("sendDataChannelOpen",function Qt(Zt){nr.debug("sendFile() - DataChannel open",Zt.detail),Zt.detail.callId.toString()===Dt.toString()&&(Vr.webRTCClient.sendDataWithCallId(Dt,{file:vt,name:dt.name,type:dt.type},function(an){nr.trace("sendFile() - progress : ",an);var Cn={uuid:an.uuid,fileSize:an.fileSize,remainingSize:an.remainingSize,percentage:an.percentage,sendChunkNb:an.sendChunkNb,transferDuration:an.transferDuration,lastPacket:an.lastPacket};tn.get(Vt).emit("fileTransferProgress",{fileInfo:dt,transferInformation:Cn}),an.transferEnded&&tn.get(Vt).emit("fileSentSuccessfully",{fileInfo:dt,transferInformation:Cn})}),Vr.removeEventListener("sendDataChannelOpen",Qt))}),this.fileTransfers.push(Dt.toString());var Gt=new Do(this,null);return Gt.id=Dt.toString(),Gt.type="sendFile",Gt.on("response",function(){Gt.getStatus()!==et.g.INVITATION_STATUS_ACCEPTED&&nr.log("sendFile() - invitation has not been accepted, cleaning listeners")}),Gt}},{key:"pushMedia",value:function(dt,vt){var Dt=this,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(Gt,Qt){Dt.fetchWebSessionInformation(vt).then(function(Zt){return Vt.token=vt.token,es.pushConversationMedia(Zt.conversationId,dt,Vr.getActiveApiKey(),Vt)}).then(function(Zt){Vr.sendData(Dt.getId(),{event:et.g.CONTACT_NEW_MEDIA_IDENTIFIER,media:{url:Zt.url,id:Zt.id}}),Gt({url:Zt.url,id:Zt.id})}).catch(function(Zt){Qt(Bt.g.createError(et.g.ERROR_OTHER,"pushMedia() - failed to push media",nr))})})}},{key:"fetchMediaList",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return nr.debug("fetchMediaList()"),new Promise(function(Vt,Gt){vt.fetchWebSessionInformation(dt).then(function(Qt){return Dt.token=dt.getToken(),es.getConversationMediaList(Qt.conversationId,Vr.getActiveApiKey(),Dt)}).then(Vt).catch(function(Qt){Gt(Bt.g.createError(et.g.ERROR_OTHER,"getMediaList() - failed to get media list",nr))})})}},{key:"sendEventCenterDataRequest",value:function(){return this.sendCustomEvent(et.g.CONTACT_EVENTCENTER_DATA_REQUEST)}},{key:"getContact",value:function(dt){return Br.getActiveSession().getOrCreateContact(dt)}},{key:"sendToContactRemoteStreamError",value:function(dt,vt,Dt){nr.debug("sendToContactRemoteStreamError",dt,vt,Dt),vt.sendCustomEvent(et.g.CONTACT_GET_REMOTE_ERROR,{callId:Dt.callId,streamId:Dt.streamId,timeout:Dt.timeout,message:dt})}},{key:"sendRemoteAccessInvitation",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,Gt){if(vt.isOnline()||nr.warn("sendRemoteAccessInvitation() - contact "+vt.getUsername()+" does not seem to be connected."),apiRTC.session.remoteAccessInvitation!==null)return nr.warn("sendRemoteAccessInvitation() already ongoing"),Gt(new Error("sendRemoteAccessInvitation() already ongoing"));var Qt=new $p(vt,dt,Dt);apiRTC.session.remoteAccessInvitation=Qt,Qt.type=et.g.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER;var Zt={event:et.g.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER,invitationId:Qt.id,roomname:Qt.conversation._getTechnicalName(),sendTime:Qt.sendTime};Qt.send(Zt).then(function(){Vt(Qt)}).catch(function(an){return nr.error("Contact#sendRemoteAccessInvitation send error:",an),Gt(new Error(an))})})}}],kt=[{key:"getAvailableEvents",value:function(){return Wp}}],Xt&&xu(Ut.prototype,Xt),kt&&xu(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(fn);function zl(jt){return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},zl(jt)}function Bp(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Hl(jt,Ut){return Hl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Hl(jt,Ut)}function Vp(jt,Ut){if(Ut&&(zl(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}(jt)}function xs(jt){return xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},xs(jt)}var co=mt.Y.get("ConversationCall"),Fr=An.get(),Gl=function(jt){(function(Yt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Yt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Yt,writable:!0,configurable:!0}}),Object.defineProperty(Yt,"prototype",{writable:!1}),dt&&Hl(Yt,dt)})(ln,jt);var Ut,Xt,kt,Ft,sn=(kt=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Yt,dt=xs(kt);if(Ft){var vt=xs(this).constructor;Yt=Reflect.construct(dt,arguments,vt)}else Yt=dt.apply(this,arguments);return Vp(this,Yt)});function ln(Yt,dt,vt){var Dt;return function(Vt,Gt){if(!(Vt instanceof Gt))throw new TypeError("Cannot call a class as a function")}(this,ln),(Dt=sn.call(this,co)).conversation=Yt,Dt.callId=dt,Dt.stream=vt,Dt}return Ut=ln,Xt=[{key:"getConversation",value:function(){return this.conversation}},{key:"getCallId",value:function(){return this.callId}},{key:"getStream",value:function(){return this.stream}},{key:"isRecorded",value:function(){return!!this.recordingStatus}},{key:"getRecordingInfo",value:function(){return this.isRecorded()?this.recordingStatus:null}},{key:"isStreamed",value:function(){return!!this.streamingStatus}},{key:"getStreamingInfo",value:function(){return this.isStreamed()?this.streamingStatus:null}},{key:"startRecordingPublishedStream",value:function(Yt){var dt=this;return Yt||(Yt={}),new Promise(function(vt,Dt){if(dt.asyncCallbacks)return Dt(Bt.g.createError(et.g.ERROR_OTHER,"startRecordingPublishedStream() - busy",co));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(Fr.removeEventListener("error",dt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),delete dt.asyncCallbacks),Dt(Bt.g.createError(et.g.ERROR_OTHER,"startRecordingPublishedStream() - timeout",co))},et.g.CONVERSATION_RECORDING_STARTED_DELAY),dt.asyncCallbacks.error=function(Zt){if(String(Zt.detail.convId)===dt.conversation.getCloudConversationId()&&Zt.detail.callId===dt.callId&&Zt.detail.errorCode.indexOf("START_RECORD")>=0)return dt.asyncCallbacks&&(Fr.removeEventListener("error",dt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Dt(Bt.g.createError(et.g.ERROR_OTHER,"startRecordingPublishedStream() - "+Zt.detail.errorInfo,co))},dt.asyncCallbacks.recordingStarted=function(Zt){if(String(Zt.detail.convId)===dt.conversation.getCloudConversationId()&&Zt.detail.callId===dt.callId){dt.asyncCallbacks&&(Fr.removeEventListener("error",dt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var an=Bt.g.parseRecordingEvent("MCURecordingStarted",Zt.detail);return vt(an)}},Fr.onEvent("error",dt.asyncCallbacks.error),Fr.onEvent("MCURecordingStarted",dt.asyncCallbacks.recordingStarted);var Vt="AUDIO-VIDEO";Yt.audioOnly===!0?Vt="AUDIO-ONLY":Yt.videoOnly===!0&&(Vt="VIDEO-ONLY");var Gt="userStream";Bt.g.isPropertyTypeof(Yt,"customIdInFilename","string")&&(Gt=Yt.customIdInFilename);var Qt={};Bt.g.isPropertyTypeof(Yt,"data","object")&&(Qt=Object.assign({},Yt.data)),Bt.g.isPropertyTypeof(Yt,"ttl","number")&&Yt.ttl>0&&(Qt.ttl=Yt.ttl),Fr.webRTCClient.startRecording(Vt,Gt,dt.conversation.getCloudConversationId(),dt.callId,Qt)})}},{key:"stopRecordingPublishedStream",value:function(){var Yt=this;return new Promise(function(dt,vt){if(Yt.asyncCallbacks)return vt(Bt.g.createError(et.g.ERROR_OTHER,"stopRecordingPublishedStream() - busy",co));Yt.asyncCallbacks={},Yt.asyncCallbacks.timeoutId=setTimeout(function(){return Yt.asyncCallbacks&&(Fr.removeEventListener("error",Yt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStopped",Yt.asyncCallbacks.recordingStopped),delete Yt.asyncCallbacks),dt(Yt.recordingStatus)},et.g.CONVERSATION_RECORDING_STOPPED_DELAY),Yt.asyncCallbacks.error=function(Dt){if(String(Dt.detail.convId)===Yt.conversation.getCloudConversationId()&&Dt.detail.callId===Yt.callId&&Dt.detail.errorCode.indexOf("STOP_RECORD")>=0)return Yt.asyncCallbacks&&(Fr.removeEventListener("error",Yt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStopped",Yt.asyncCallbacks.recordingStopped),clearTimeout(Yt.asyncCallbacks.timeoutId),delete Yt.asyncCallbacks),vt(Bt.g.createError(et.g.ERROR_OTHER,"stopRecordingPublishedStream() - "+Dt.detail.errorInfo,co))},Yt.asyncCallbacks.recordingStopped=function(Dt){if(String(Dt.detail.convId)===Yt.conversation.getCloudConversationId()&&Dt.detail.callId===Yt.callId){Yt.asyncCallbacks&&(Fr.removeEventListener("error",Yt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStopped",Yt.asyncCallbacks.recordingStopped),clearTimeout(Yt.asyncCallbacks.timeoutId),delete Yt.asyncCallbacks);var Vt=Bt.g.parseRecordingEvent("MCURecordingStopped",Dt.detail);return dt(Vt)}},Fr.onEvent("error",Yt.asyncCallbacks.error),Fr.onEvent("MCURecordingStopped",Yt.asyncCallbacks.recordingStopped),Fr.webRTCClient.stopRecording(Yt.callId)})}},{key:"replacePublishedStream",value:function(Yt,dt){var vt=this;return co.debug("replacePublishedStream"),new Promise(function(Dt,Vt){if(Yt===null){if(!Bt.g.isPropertyTypeof(dt,"getStream","function"))return Vt(new Error("replacePublishedStream() - Cannot replace stream, wrong arguments"));vt.stream.publishedInConversations.delete(vt.conversation.getName()),vt.conversation.conversationPublishedStreams.delete(vt.stream.userMediaStreamId);var Gt={getUserMediaStreamId:function(){return dt.getStream().then(function(Zt){vt.stream=Zt,Zt.publishedInConversations.set(vt.conversation.getName(),vt.callId),vt.conversation.callIdToStreamId.set(vt.callId,Zt.userMediaStreamId);var an={contact:null,isRemote:!1,hasAudio:Zt.hasAudio(),hasVideo:Zt.hasVideo(),isScreensharing:Zt.isScreensharing(),streamId:Zt.userMediaStreamId,callId:vt.callId};return vt.conversation.conversationPublishedStreams.set(Zt.userMediaStreamId,an),Zt.userMediaStreamId}).catch(Vt)}};Fr.webRTCClient.webRTCClient.addMedia(vt.callId,!0,null,Gt).then(function(Zt){var an=function(Cn){if(yo.has(Cn))return yo.get(Cn);var Rn=apiCC.getUserMediaStream(Cn);if(Rn){var Kn="audio";return Rn.video===!0&&(Kn="video"),new so(Rn.stream,{type:Kn,constructor:!0,userMediaStreamId:Rn.userMediaStreamId})}return null}(Zt.userMediaStreamId);return an!==null&&vt.conversation.sendCustomEvent(et.g.CONTACT_STREAM_UPDATED_INFO,{callId:vt.getCallId(),newStreamId:an.data.id,oldStreamId:Zt.oldMediaStreamId}),Dt(an)}).catch(function(Zt){return Vt(new Error("replacePublishedStream() - "+Zt))})}else{vt.stream.publishedInConversations.delete(vt.conversation.getName()),vt.conversation.conversationPublishedStreams.delete(vt.stream.userMediaStreamId),Fr.webRTCClient.webRTCClient.addMedia(vt.callId,!0,Yt.userMediaStreamId).then(function(Zt){return vt.conversation.sendCustomEvent(et.g.CONTACT_STREAM_UPDATED_INFO,{callId:vt.getCallId(),newStreamId:Yt.data.id,oldStreamId:Zt.oldMediaStreamId}),Dt(Yt)}).catch(function(Zt){return Vt(new Error("replacePublishedStream() - "+Zt))}),vt.stream=Yt,Yt.publishedInConversations.set(vt.conversation.getName(),vt.callId),vt.conversation.callIdToStreamId.set(vt.callId,Yt.userMediaStreamId);var Qt={contact:null,isRemote:!1,hasAudio:Yt.hasAudio(),hasVideo:Yt.hasVideo(),isScreensharing:Yt.isScreensharing(),streamId:Yt.userMediaStreamId,callId:vt.callId};vt.conversation.conversationPublishedStreams.set(Yt.userMediaStreamId,Qt)}})}},{key:"startStreaming",value:function(){var Yt=this,dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(vt,Dt){return Yt.asyncCallbacks?Dt(Bt.g.createError(et.g.ERROR_OTHER,"startStreaming() - busy",co)):Fr.webRTCClient.startStreaming(dt.service,dt.server,dt.streamKey,Yt.callId)?(Yt.asyncCallbacks={},Yt.asyncCallbacks.timeoutId=setTimeout(function(){return Yt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStarted",Yt.asyncCallbacks.streamingStarted),delete Yt.asyncCallbacks),Dt(Bt.g.createError(et.g.ERROR_OTHER,"startStreaming() - timeout",co))},et.g.CONVERSATION_STREAMING_STARTED_DELAY),Yt.asyncCallbacks.streamingStarted=function(Vt){if(Vt.detail.roomName===Yt.conversation._getTechnicalName()&&Vt.detail.callId===Yt.callId){Yt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStarted",Yt.asyncCallbacks.streamingStarted),clearTimeout(Yt.asyncCallbacks.timeoutId),delete Yt.asyncCallbacks);var Gt=js("MCUStreamingStarted",Vt.detail);return vt(Gt)}},void Fr.onEvent("MCUStreamingStarted",Yt.asyncCallbacks.streamingStarted)):Dt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"startStreaming() - cannot start streaming",co))})}},{key:"stopStreaming",value:function(){var Yt=this;return new Promise(function(dt,vt){return Yt.asyncCallbacks?vt(Bt.g.createError(et.g.ERROR_OTHER,"stopStreaming() - busy",co)):Fr.webRTCClient.stopStreaming(Yt.callId)?(Yt.asyncCallbacks={},Yt.asyncCallbacks.timeoutId=setTimeout(function(){return Yt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStopped",Yt.asyncCallbacks.streamingStopped),delete Yt.asyncCallbacks),vt(Bt.g.createError(et.g.ERROR_OTHER,"stopStreaming() - timeout",co))},et.g.CONVERSATION_STREAMING_STOPPED_DELAY),Yt.asyncCallbacks.streamingStopped=function(Dt){if(Dt.detail.roomName===Yt.conversation._getTechnicalName()&&Dt.detail.callId===Yt.callId){Yt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStopped",Yt.asyncCallbacks.streamingStopped),clearTimeout(Yt.asyncCallbacks.timeoutId),delete Yt.asyncCallbacks);var Vt=js("MCUStreamingStopped",Dt.detail);return dt(Vt)}},void Fr.onEvent("MCUStreamingStopped",Yt.asyncCallbacks.streamingStopped)):vt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"stopStreaming() - cannot stop streaming",co))})}},{key:"changeStreamPriority",value:function(Yt){var dt=this;return new Promise(function(vt,Dt){return Fr.webRTCClient.changeStreamPriority(dt.callId,Yt)?(dt.conversation.changeStreamPriority(dt.stream.userMediaStreamId,!1,Yt),vt()):Dt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"changeStreamPriority() - cannot change stream priority",co))})}},{key:"updatePublishedStream",value:function(Yt,dt){var vt=this;return new Promise(function(Dt,Vt){if(Yt!=="audio"&&Yt!=="video")return Vt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"updatePublishedStream() - wrong type",co));var Gt=dt?"sendonly":"inactive";return Fr.webRTCClient.webRTCClient.processUpdateStream(vt.callId,Yt,Gt)?Dt():Vt(Bt.g.createError(et.g.ERROR_OTHER,"updatePublishedStream() - cannot update",co))})}}],Xt&&Bp(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),ln}(fn);function Uo(jt,Ut){var Xt=typeof Symbol<"u"&&jt[Symbol.iterator]||jt["@@iterator"];if(!Xt){if(Array.isArray(jt)||(Xt=function(dt,vt){if(dt){if(typeof dt=="string")return Pu(dt,vt);var Dt=Object.prototype.toString.call(dt).slice(8,-1);return Dt==="Object"&&dt.constructor&&(Dt=dt.constructor.name),Dt==="Map"||Dt==="Set"?Array.from(dt):Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt)?Pu(dt,vt):void 0}}(jt))||Ut&&jt&&typeof jt.length=="number"){Xt&&(jt=Xt);var kt=0,Ft=function(){};return{s:Ft,n:function(){return kt>=jt.length?{done:!0}:{done:!1,value:jt[kt++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Yt=!1;return{s:function(){Xt=Xt.call(jt)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Yt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Yt)throw sn}}}}function Pu(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function Du(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}var no=mt.Y.get("ContactCatalog"),go=null,xo={},bo={leftGroup:{},joinedGroup:{},userDataChanged:[]},Ro=function(){function jt(){if(function(sn,ln){if(!(sn instanceof ln))throw new TypeError("Cannot call a class as a function")}(this,jt),go!==null)throw"Cannot construct singleton ContactCatalog";this.contactList=new Map,this.eventEmitter=new pt,go=this;var Ft=An.get();Ft.onEvent("connectedUsersListUpdate",function(sn){var ln=apiRTC.session.apiCCId.toString(),Yt={};switch(sn.detail.updateReason){case"newConnectionState":if(sn.detail.status==="online"){no.debug("new connection");var dt,vt=Uo(sn.detail.usersList);try{for(vt.s();!(dt=vt.n()).done;)(Yt={userId:dt.value,group:sn.detail.group}).userId.toString()!==ln&&Hp(Yt)}catch(Cn){vt.e(Cn)}finally{vt.f()}}else{no.debug("new disconnection");var Dt,Vt=Uo(sn.detail.usersList);try{for(Vt.s();!(Dt=Vt.n()).done;)Yt={userId:Dt.value,group:sn.detail.group},xo[Yt.group]===void 0&&(xo[Yt.group]={}),Yt.userId.toString()!==ln&&(xo[Yt.group][Yt.userId.toString()]=setTimeout(zp(Yt),Ft.contactDisconnectionDelay))}catch(Cn){Vt.e(Cn)}finally{Vt.f()}}break;case"userDataUpdate":no.debug("userDataUpdate");var Gt,Qt=Uo(sn.detail.usersList);try{for(Qt.s();!(Gt=Qt.n()).done;)(Yt={userId:Gt.value,group:sn.detail.group}).userId.toString()!==ln&&Nu(Yt)}catch(Cn){Qt.e(Cn)}finally{Qt.f()}break;case"callState":no.debug("callState change for user");var Zt,an=Uo(sn.detail.usersList);try{for(an.s();!(Zt=an.n()).done;)(Yt={userId:Zt.value,group:sn.detail.group}).userId.toString()!==ln&&Nu(Yt)}catch(Cn){an.e(Cn)}finally{an.f()}break;default:no.warn("default case for updateReason value")}}).onEvent("groupUnsubscribed",function(sn){var ln,Yt=go.getContacts(sn),dt=Uo(Yt.keys());try{for(dt.s();!(ln=dt.n()).done;){var vt=ln.value;Yt.get(vt).removeFromGroup(sn)}}catch(Dt){dt.e(Dt)}finally{dt.f()}})}var Ut,Xt,kt;return Ut=jt,Xt=[{key:"onUpdate",value:function(Ft){this.eventEmitter.on("update",Ft)}},{key:"removeUpdateListener",value:function(Ft){this.eventEmitter.off("update",Ft)}},{key:"getContact",value:function(Ft){return Ft!=null&&this.contactList.has(Ft.toString())?this.contactList.get(Ft.toString()):null}},{key:"getOrCreateContact",value:function(Ft){var sn=null;if(Ft!=null)if(this.contactList.has(Ft.toString()))sn=this.contactList.get(Ft.toString());else try{sn=new No(Ft.toString(),{}),this.contactList.set(Ft.toString(),sn)}catch(ln){no.debug("Contact not added : "+ln)}return sn}},{key:"getContacts",value:function(Ft){if(Ft==null)return this.contactList;var sn,ln=new Map,Yt=Uo(this.contactList.keys());try{for(Yt.s();!(sn=Yt.n()).done;){var dt=sn.value;this.contactList.get(dt).inGroup(Ft)&&ln.set(dt,this.contactList.get(dt))}}catch(vt){Yt.e(vt)}finally{Yt.f()}return ln}},{key:"getOnlineContacts",value:function(Ft){var sn=new Map;if(Ft==null){var ln,Yt=Uo(this.contactList.keys());try{for(Yt.s();!(ln=Yt.n()).done;){var dt=ln.value;this.contactList.get(dt).isOnline()&&sn.set(dt,this.contactList.get(dt))}}catch(Gt){Yt.e(Gt)}finally{Yt.f()}}else{var vt,Dt=Uo(this.contactList.keys());try{for(Dt.s();!(vt=Dt.n()).done;){var Vt=vt.value;this.contactList.get(Vt).inGroup(Ft)&&this.contactList.get(Vt).isOnline()&&sn.set(Vt,this.contactList.get(Vt))}}catch(Gt){Dt.e(Gt)}finally{Dt.f()}}return sn}}],kt=[{key:"get",value:function(){return go===null&&(go=new jt),go}}],Xt&&Du(Ut.prototype,Xt),kt&&Du(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}();function zp(jt){return function(){var Ut=jt.userId.toString();if(no.info("Contact disconnected "+Ut+" from "+jt.group),go.contactList.has(Ut)){var Xt=go.contactList.get(Ut);if(Xt===void 0)return void no.debug("Contact not exist with userId :",Ut);Xt.removeFromGroup(jt.group),function(kt,Ft){no.debug("updateContactListOnUserDisconnect()"),bo.leftGroup[kt]===void 0&&(bo.leftGroup[kt]=[]),bo.leftGroup[kt].push(Ft),Kl()}(jt.group,Xt),xo[jt.group]!==void 0&&xo[jt.group][Ut]!==void 0&&delete xo[jt.group][Ut]}}}function Kl(){Object.keys(bo.leftGroup).length===0&&Object.keys(bo.joinedGroup).length===0&&bo.userDataChanged.length===0||(go.eventEmitter.emit("update",bo),bo={leftGroup:{},joinedGroup:{},userDataChanged:[]})}function Hp(jt){no.debug("updateContactListOnUserConnection()");var Ut=jt.userId.toString(),Xt=null,kt=apiRTC.session.getConnectedUserInfo(Ut,"userData");no.debug("userData :",kt);try{jt.userData=JSON.parse(kt)}catch(Ft){no.warn("userData parse error : "+Ft)}if(go.contactList.has(Ut))Xt=go.contactList.get(jt.userId),Io.equals(Xt.userData,jt.userData)||(Xt.userData=new Io(jt.userData),bo.userDataChanged.push(Xt));else{try{Xt=new No(Ut,jt.userData),go.contactList.set(Ut,Xt)}catch(Ft){no.debug("Contact not added : "+Ft)}Xt=go.contactList.get(Ut)}Xt!==void 0?(xo[jt.group]!==void 0&&xo[jt.group][Ut]!==void 0&&(clearTimeout(xo[jt.group][Ut]),delete xo[jt.group][Ut]),Xt.inGroup(jt.group)||(Xt.addToGroup(jt.group),bo.joinedGroup[jt.group]===void 0&&(bo.joinedGroup[jt.group]=[]),bo.joinedGroup[jt.group].push(Xt)),Kl()):no.debug("Contact not exist with userId :",Ut)}function Nu(jt){no.debug("updateContactListOnUserDataUpdate()");var Ut=jt.userId.toString(),Xt=go.contactList.get(jt.userId);if(Xt!==void 0){var kt=apiRTC.session.getConnectedUserInfo(Ut,"userData");no.debug("userData :",kt);try{jt.userData=JSON.parse(kt)}catch(Ft){no.warn("userData parse error : "+Ft)}Io.equals(Xt.userData,jt.userData)||(Xt.userData=new Io(jt.userData),bo.userDataChanged.push(Xt)),Kl()}else no.debug("Contact not exist with userId :",Ut)}function _s(jt){return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},_s(jt)}function uo(jt,Ut){var Xt=typeof Symbol<"u"&&jt[Symbol.iterator]||jt["@@iterator"];if(!Xt){if(Array.isArray(jt)||(Xt=function(dt,vt){if(dt){if(typeof dt=="string")return Uu(dt,vt);var Dt=Object.prototype.toString.call(dt).slice(8,-1);return Dt==="Object"&&dt.constructor&&(Dt=dt.constructor.name),Dt==="Map"||Dt==="Set"?Array.from(dt):Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt)?Uu(dt,vt):void 0}}(jt))||Ut&&jt&&typeof jt.length=="number"){Xt&&(jt=Xt);var kt=0,Ft=function(){};return{s:Ft,n:function(){return kt>=jt.length?{done:!0}:{done:!1,value:jt[kt++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Yt=!1;return{s:function(){Xt=Xt.call(jt)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Yt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Yt)throw sn}}}}function Uu(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function Gp(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function Lu(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Jl(jt,Ut){return Jl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},Jl(jt,Ut)}function qp(jt,Ut){if(Ut&&(_s(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ur(jt)}function ur(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function Ps(jt){return Ps=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Ps(jt)}var $n=mt.Y.get("Conversation"),Jn=An.get(),Eo=new(Go()),ro=Ro.get(),Kp=["adaptationTriggered","audioAmplitude","availableStreamsUpdated","bandwidthLimited","callStatsUpdate","compositeListChanged","contactJoined","contactJoinedWaitingRoom","contactLeft","contactLeftWaitingRoom","cpuLimited","customEvent","data","disconnectionWarning","entryAllowed","entryDenied","error","hangup","joined","left","localStreamUpdated","message","messageNotDelivered","moderatorConnected","newMediaAvailable","newWhiteboardSession","participantEjected","persistentDataUpdated","pointerLocationChanged","pointerSharingEnabled","recordingAvailable","recordingStarted","recordingStopped","remoteStreamUpdated","replayListChanged","roomModeChanged","simulcastFeedChanged","slowLink","streamAdded","streamListChanged","streamRemoved","streamingStarted","streamingStopped","transferPending","transferBegun","transferEnded","transferProgress","whiteboardRoomMemberUpdate","videoQualityChanged","waitingForModeratorAcceptance","remoteStreamIdUpdated"],$u=new Set(["CHAT","CALL","GROUP_CHAT","WEBCONF","REPORT","REPORT_PART","TICKET","EVENT","OTHER","BOT"]),Jp=new Set(["audioSent","videoSent","audioReceived","videoReceived","quality"]),Yp=new Set(["CALL_ABORTED","SET_LOCAL_DESCRIPTION_FAILURE","SET_REMOTE_DESCRIPTION_FAILURE"]),ts=new WeakMap,ns=new WeakMap,qo=new WeakMap,Po=new WeakMap,Ds=new WeakMap,Ns=new WeakMap,Mo=new WeakMap,wo=new WeakMap,Yl=new WeakMap,Xl=new WeakMap,Us=new WeakMap,Ls=new WeakMap,$s=new WeakMap,jo=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&Jl(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Ps(Ft);if(sn){var Dt=Ps(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return qp(this,dt)});function Yt(dt){var vt,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Gp(this,Yt),vt=ln.call(this,$n),$n.debug("Create Conversation"),dt==null?ts.set(ur(vt),Bt.g.guid().toString()):ts.set(ur(vt),dt.toString()),ns.set(ur(vt),"OTHER"),vt.active=!Object.prototype.hasOwnProperty.call(Dt,"active")||typeof Dt.active!="boolean"||Dt.active,vt.meshModeEnabled=Dt.meshModeEnabled===!0,vt.meshOnlyEnabled=Dt.meshOnlyEnabled===!0,vt.moderationEnabled=Dt.moderationEnabled===!0,vt.moderator=Dt.moderator===!0,vt.conversationCalls=new Map,vt.callIdToStreamId=new Map,vt.token=null,vt.sessionId=null,vt.webconfId=null,vt.conversationStreams=new Map,vt.conversationPublishedStreams=new Map,vt.groupChatStatus=et.g.CONVERSATION_STATUS_NOT_JOINED,vt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,vt.whiteboardStarted=et.g.CONVERSATION_WHITEBOARD_NOT_STARTED,vt.pointerSharingState=et.g.STATE_IDLE,vt.pointerSharingAutoInvite=!1,vt.pgroupWaitingRoomSubscribedTo=!1,Ds.set(ur(vt),null),Ns.set(ur(vt),null),Mo.set(ur(vt),new Map),Po.set(ur(vt),null),wo.set(ur(vt),null),qo.set(ur(vt),{}),Us.set(ur(vt),new Map),$s.set(ur(vt),null),Ls.set(ur(vt),null),vt.transferCallIds=[],vt.uploadCap=null,vt.downloadCap=null,vt.reservedStreams=[];var Vt={contactCatalog:{}};for(var Gt in Vt.contactCatalog.onUpdate=function(Zt){$n.debug("onUpdate: contactList",Zt);var an=vt._getTechnicalName();if(Zt.joinedGroup[an]!==void 0){var Cn,Rn=uo(Zt.joinedGroup[an]);try{for(Rn.s();!(Cn=Rn.n()).done;){var Kn=Cn.value;$n.debug(Kn.getUsername()+" joined conversation "+vt.getName()),tn.get(ur(vt)).emit("contactJoined",Kn),vt.pointerSharingState===et.g.STATE_ACTIVE&&vt.pointerSharingAutoInvite===!0&&Jn.pointerSharingClient.inviteInRoom(an,Kn.getId())}}catch(tr){Rn.e(tr)}finally{Rn.f()}}else $n.debug("not an event joinedGroup for conversation");if(Zt.leftGroup[an]!==void 0){var Xn,dr=uo(Zt.leftGroup[an]);try{for(dr.s();!(Xn=dr.n()).done;){var hr=Xn.value;$n.debug(hr.getUsername()+" left conversation "+vt.getName()),tn.get(ur(vt)).emit("contactLeft",hr)}}catch(tr){dr.e(tr)}finally{dr.f()}}else $n.debug("not an event leftGroup for conversation");if(vt.getRole()===et.g.CONVERSATION_ROLE_MODERATOR){var Mr,Xr=ro.getContacts(et.g.CONVERSATION_WAITING_ROOM_PREFIX+an),_i=uo(Us.get(ur(vt)).keys());try{for(_i.s();!(Mr=_i.n()).done;){var Vo=Mr.value;if(!Xr.has(Vo)){var sr=ro.getContact(Vo);sr!==null&&($n.debug(sr.getUsername()+" left waiting room "+vt.getName()),tn.get(ur(vt)).emit("contactLeftWaitingRoom",sr))}}}catch(tr){_i.e(tr)}finally{_i.f()}Xr.forEach(function(tr,Ir){Us.get(ur(vt)).has(Ir)||tr===null||($n.debug(tr.getUsername()+" joined waiting room "+vt.getName()),tn.get(ur(vt)).emit("contactJoinedWaitingRoom",tr),Jn.sendData(Ir,{event:et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected",roomname:an}).catch(function(Or){var br=Bt.g.createError(Or,"Notification not delivered",$n);tn.get(ur(vt)).emit("messageNotDelivered",{error:br,contact:tr,event:et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected"})}))}),Us.set(ur(vt),Xr)}},ro.onUpdate(Vt.contactCatalog.onUpdate),tn.get(ur(vt)).on("contactJoined",function(Zt){vt.getRole()===et.g.CONVERSATION_ROLE_MODERATOR&&Jn.sendData(Zt.getId(),{event:et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected",roomname:vt._getTechnicalName()}).catch(function(an){var Cn=Bt.g.createError(an,"Notification not delivered",$n);tn.get(ur(vt)).emit("messageNotDelivered",{error:Cn,contact:Zt,event:et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected"})})}),Vt.apiRTCManager={},Vt.apiRTCManager.receiveData=function(Zt){var an=Zt.detail.data;if(an!==void 0){if(an.roomname===vt._getTechnicalName()){var Cn=ro.getOrCreateContact(Zt.detail.senderId);if(an.event)switch(an.event){case et.g.CONVERSATION_SEND_DATA_IDENTIFIER:if(vt.status!==et.g.CONVERSATION_STATUS_JOINED)break;tn.get(ur(vt)).emit("data",{sender:Cn,content:an.content});break;case et.g.CONVERSATION_NEW_MEDIA_IDENTIFIER:if(vt.status!==et.g.CONVERSATION_STATUS_JOINED)break;$n.info("New media available in conversation",an.media),tn.get(ur(vt)).emit("newMediaAvailable",{sender:Cn,media:an.media});break;case et.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER:if(vt.status!==et.g.CONVERSATION_STATUS_JOINED)break;vt.updateData();break;case et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER:tn.get(ur(vt)).emit("moderatorConnected",Cn);break;case et.g.CONVERSATION_CLOSED_IDENTIFIER:an.instanceId===vt.getInstanceId()&&($n.info("Conference "+vt.getName()+" has been closed..."),tn.get(ur(vt)).emit("closed"),vt.leave());break;case et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER:if(an.access===void 0||an.access===null){$n.error("Conversation join answer has no access data");break}tn.get(ur(vt)).emit(an.access?"entryAllowed":"entryDenied");break;case et.g.CONTACT_STREAM_UPDATED_INFO:$n.debug("CONTACT_STREAM_UPDATED_INFO :",Zt.detail.data);var Rn={callId:Zt.detail.data.callId,newStreamId:Zt.detail.data.newStreamId,oldStreamId:Zt.detail.data.oldStreamId};tn.get(ur(vt)).emit("remoteStreamIdUpdated",Rn);break;default:tn.get(ur(vt)).emit("customEvent",{event:an.event,content:an,sender:Cn})}else if(an.command==="new_snapshot"){if(vt.status!==et.g.CONVERSATION_STATUS_JOINED)return;$n.info("New media available in conversation",an.value.snapshot),tn.get(ur(vt)).emit("newMediaAvailable",{sender:Cn,media:an.value.snapshot})}else $n.debug("Unprocessed conversation message",an)}}else $n.debug("Received data undefined, leaving process")},Vt.apiRTCManager.receiveGroupChatMessage=function(Zt){if((vt.status===et.g.CONVERSATION_STATUS_JOINED||vt.groupChatStatus===et.g.CONVERSATION_STATUS_JOINED)&&Zt.detail.groupChatId.toString()===vt._getTechnicalName()){var an={sender:ro.getOrCreateContact(Zt.detail.senderId),sender_id:Zt.detail.senderId,content:Zt.detail.message,time:new Date};Bt.g.isTypeof(Zt.detail,"metadata","object")&&(an.metadata=Zt.detail.metadata),tn.get(ur(vt)).emit("message",an)}},Vt.apiRTCManager.receiveRoomMessage=function(Zt){if(Zt.detail.roomType==="pointerSharing"&&vt.pointerSharingState===et.g.STATE_ACTIVE&&Zt.detail.message.type==="pointerLocation"&&Zt.detail.roomId===vt._getTechnicalName()){var an={sender:ro.getOrCreateContact(Zt.detail.senderId),source:Zt.detail.message.source,x:Zt.detail.message.x,y:Zt.detail.message.y};Bt.g.isPropertyTypeof(Zt.detail.message,"data","object")&&(an.data=Zt.detail.message.data),tn.get(ur(vt)).emit("pointerLocationChanged",an)}},Vt.apiRTCManager.roomInvitation=function(Zt){if($n.info("roomInvitation event handler ",Zt),Zt.detail.roomId.toString()===vt._getTechnicalName())if($n.info("roomInvitation for actual conversation",Zt),Zt.detail.roomType==="whiteBoard"){if(vt.status===et.g.CONVERSATION_STATUS_JOINED){var an=ro.getOrCreateContact(Zt.detail.senderId);tn.get(ur(vt)).emit("newWhiteboardSession",{sender:an})}}else Zt.detail.roomType==="pointerSharing"&&Ql(ur(vt),!1,!0).then(function(){}).catch(function(Cn){})},Vt.apiRTCManager.onFilePending=function(Zt){if(vt.transferCallIds.includes(Zt.detail.callId)){var an={id:Zt.detail.callId,name:Zt.detail.name,rank:Zt.detail.rank};tn.get(ur(vt)).emit("transferPending",an)}},Vt.apiRTCManager.onFileSending=function(Zt){if(vt.transferCallIds.includes(Zt.detail.callId)){var an={id:Zt.detail.callId,name:Zt.detail.name};tn.get(ur(vt)).emit("transferBegun",an)}},Vt.apiRTCManager.onFileProgress=function(Zt){if(vt.transferCallIds.includes(Zt.detail.callId)){var an={id:Zt.detail.callId,name:Zt.detail.name,size:Zt.detail.fileSize,remBytes:Zt.detail.remainingSize,percentage:Zt.detail.percentage};tn.get(ur(vt)).emit("transferProgress",an)}},Vt.apiRTCManager.onFileSended=function(Zt){var an=vt.transferCallIds.indexOf(Zt.detail.callId);if(an>=0){var Cn={id:Zt.detail.callId,name:Zt.detail.name};Zt.detail.error&&(Cn.error=Zt.detail.error),tn.get(ur(vt)).emit("transferEnded",Cn),vt.transferCallIds.splice(an,1)}},Vt.apiRTCManager)Jn.onEvent(Gt,Vt.apiRTCManager[Gt]);Yl.set(ur(vt),Vt);var Qt={MCUAvailableStream:function(Zt){var an,Cn=uo(Zt.detail.streams);try{for(Cn.s();!(an=Cn.n()).done;){var Rn=an.value;if(Rn.room===vt._getTechnicalName()){var Kn={contact:ro.getOrCreateContact(Rn.attributes.callerId),isRemote:Zt.detail.isRemoteStream,hasAudio:Rn.audio,hasVideo:Rn.video,isAudioMuted:Rn.audioMuted,isVideoMuted:Rn.videoMuted,isScreensharing:Rn.attributes.callType==="screenSharing"||Rn.attributes.callType==="screenSharingWithAudio",isSIP:Rn.sip===!0,isSimulcast:Rn.simulcast===!0,streamId:Rn.id,type:"regular",callId:Rn.attributes.callId,descriptor:Rn.attributes.descriptor,context:Rn.context};vt.conversationStreams.set(Kn.streamId,Kn);var Xn={listEventType:"added"};Bt.g.assignObject(Xn,Kn),tn.get(ur(vt)).emit("streamListChanged",Xn)}}}catch(_i){Cn.e(_i)}finally{Cn.f()}$n.debug("Nb stream into conversation :"+vt.conversationStreams.size);var dr,hr={},Mr=uo(vt.conversationStreams.keys());try{for(Mr.s();!(dr=Mr.n()).done;){var Xr=dr.value;hr[Xr]=vt.conversationStreams.get(Xr)}}catch(_i){Mr.e(_i)}finally{Mr.f()}tn.get(ur(vt)).emit("availableStreamsUpdated",hr)},MCUAvailableStreamUpdate:function(Zt){var an,Cn=uo(Zt.detail.streams);try{for(Cn.s();!(an=Cn.n()).done;){var Rn=an.value;if(Rn.room===vt._getTechnicalName()){var Kn=vt.conversationStreams.get(Rn.id);if(Kn&&Kn.type==="regular"){Kn.hasAudio=Rn.audio,Kn.hasVideo=Rn.video,Kn.isAudioMuted=Rn.audioMuted,Kn.isVideoMuted=Rn.videoMuted,Kn.descriptor=Rn.attributes.descriptor;var Xn={listEventType:"updated"};Bt.g.assignObject(Xn,Kn),tn.get(ur(vt)).emit("streamListChanged",Xn),Kn.descriptor&&Object.prototype.hasOwnProperty.call(Kn.descriptor,"priority")&&vt.changeStreamPriority(Kn.streamId,!0,Kn.descriptor.priority)}}}}catch(_i){Cn.e(_i)}finally{Cn.f()}$n.debug("Nb stream into conversation :"+vt.conversationStreams.size);var dr,hr={},Mr=uo(vt.conversationStreams.keys());try{for(Mr.s();!(dr=Mr.n()).done;){var Xr=dr.value;hr[Xr]=vt.conversationStreams.get(Xr)}}catch(_i){Mr.e(_i)}finally{Mr.f()}tn.get(ur(vt)).emit("availableStreamsUpdated",hr)},MCUAvailableComposite:function(Zt){var an,Cn=uo(Zt.detail.streams);try{for(Cn.s();!(an=Cn.n()).done;){var Rn=an.value;if(Rn.room===vt._getTechnicalName()){var Kn={isRemote:Zt.detail.isRemoteStream,hasAudio:Rn.audio,hasVideo:Rn.video,isAudioMuted:Rn.audioMuted,isVideoMuted:Rn.videoMuted,isScreensharing:Rn.attributes.callType==="screenSharing"||Rn.attributes.callType==="screenSharingWithAudio",isSIP:Rn.sip===!0,streamId:Rn.id,type:"composite",callId:Rn.attributes.callId,descriptor:Rn.attributes.descriptor,context:Rn.context};vt.conversationStreams.set(Kn.streamId,Kn);var Xn={listEventType:"added"};Bt.g.assignObject(Xn,Kn),tn.get(ur(vt)).emit("compositeListChanged",Xn)}}}catch(dr){Cn.e(dr)}finally{Cn.f()}},MCUAvailableReplay:function(Zt){var an,Cn=uo(Zt.detail.streams);try{for(Cn.s();!(an=Cn.n()).done;){var Rn=an.value;if(Rn.room===vt._getTechnicalName()){var Kn={contact:ro.getOrCreateContact(Rn.attributes.callerId),isRemote:Zt.detail.isRemoteStream,hasAudio:Rn.audio,hasVideo:Rn.video,isAudioMuted:Rn.audioMuted,isVideoMuted:Rn.videoMuted,isScreensharing:Rn.attributes.callType==="screenSharing"||Rn.attributes.callType==="screenSharingWithAudio",isSIP:Rn.sip===!0,streamId:Rn.id,type:"replay",callId:Rn.attributes.callId,descriptor:Rn.attributes.descriptor,context:Rn.context};vt.conversationStreams.set(Kn.streamId,Kn);var Xn={listEventType:"added"};Bt.g.assignObject(Xn,Kn),tn.get(ur(vt)).emit("replayListChanged",Xn)}}}catch(dr){Cn.e(dr)}finally{Cn.f()}},MCURemoveStream:function(Zt){if(vt.conversationStreams.has(Zt.detail.streamId)){var an={listEventType:"removed"};Bt.g.assignObject(an,vt.conversationStreams.get(Zt.detail.streamId)),an.type==="regular"?tn.get(ur(vt)).emit("streamListChanged",an):an.type==="composite"&&tn.get(ur(vt)).emit("compositeListChanged",an),vt.conversationStreams.delete(Zt.detail.streamId),$n.debug("Nb stream into conversation :"+vt.conversationStreams.size);var Cn,Rn={},Kn=uo(vt.conversationStreams.keys());try{for(Kn.s();!(Cn=Kn.n()).done;){var Xn=Cn.value;Rn[Xn]=vt.conversationStreams.get(Xn)}}catch(dr){Kn.e(dr)}finally{Kn.f()}tn.get(ur(vt)).emit("availableStreamsUpdated",Rn)}else $n.debug("Not a conversation's stream")},remoteStreamAdded:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){$n.info("remoteStreamAdded",Zt.detail);var an=ro.getOrCreateContact(Zt.detail.remoteId),Cn=vt.callIdToStreamId.get(Zt.detail.callId),Rn=Mo.get(ur(vt));Rn.has(Cn)&&tn.get(ur(vt)).emit("streamRemoved",Rn.get(Cn));var Kn=Zt.detail.callType==="audio"?"audio":"video",Xn=Zt.detail.callType==="screenSharing",dr=new so(Zt.detail.stream,{type:Kn,contact:an,streamId:Cn,callId:Zt.detail.callId,callAudioAvailable:Zt.detail.audioIsAvailable,callAudioActive:Zt.detail.audioIsActive,callAudioMuted:Zt.detail.audioIsMuted,callVideoAvailable:Zt.detail.videoIsAvailable,callVideoActive:Zt.detail.videoIsActive,callVideoMuted:Zt.detail.videoIsMuted,screensharing:Xn,constructor:!0});dr.publishedInConversations.set(vt.getName(),Zt.detail.callId),Mo.get(ur(vt)).set(Cn,dr),apiRTC.session.remoteAccessInvitation!==null&&apiRTC.session.remoteAccessInvitation.screenSharingStreamId===Cn?($n.debug("This is screensharing stream for remoteAccess"),dr.screensharingRemoteAccessStream=!0,apiRTC.session.remoteAccessInvitation.setRemoteAccessStream(dr)):tn.get(ur(vt)).emit("streamAdded",dr)}},remoteStreamRemoved:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){var an=vt.callIdToStreamId.get(Zt.detail.callId),Cn=Mo.get(ur(vt));Cn.has(an)&&(tn.get(ur(vt)).emit("streamRemoved",Cn.get(an)),Cn.delete(an))}},roomMemberUpdate:function(Zt){$n.info("roomMemberUpdate event handler ",Zt);var an,Cn=[],Rn=uo(Zt.detail.contactList);try{for(Rn.s();!(an=Rn.n()).done;){var Kn=an.value;Cn.push(ro.getOrCreateContact(Kn.contactId))}}catch(Xn){Rn.e(Xn)}finally{Rn.f()}Zt.detail.roomType==="whiteBoard"&&($n.info("Received whiteboard room member update"),tn.get(ur(vt)).emit("whiteboardRoomMemberUpdate",{contacts:Cn,roomId:Zt.detail.roomId,status:Zt.detail.status}))},slowLink:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){var an=vt.callIdToStreamId.get(Zt.detail.callId),Cn={callId:Zt.detail.callId,streamId:an};Zt.detail.advice&&(Cn.advice=Zt.detail.advice),tn.get(ur(vt)).emit("slowLink",Cn)}},videoQualityChanged:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){var an=vt.callIdToStreamId.get(Zt.detail.callId),Cn={callId:Zt.detail.callId,streamId:an,hint:Zt.detail.hint,profileType:Zt.detail.profileType};Zt.detail.bitrate&&(Cn.bitrate=Zt.detail.bitrate),Zt.detail.width&&Zt.detail.height&&(Cn.width=Zt.detail.width,Cn.height=Zt.detail.height),Zt.detail.frameRate&&(Cn.frameRate=Zt.detail.frameRate),tn.get(ur(vt)).emit("videoQualityChanged",Cn)}},simulcastFeedChanged:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){var an=vt.callIdToStreamId.get(Zt.detail.callId),Cn={callId:Zt.detail.callId,streamId:an,simulcast:Zt.detail.simulcast};tn.get(ur(vt)).emit("simulcastFeedChanged",Cn)}},localStreamUpdated:function(Zt){if(Zt.detail.onCall&&vt.callIdToStreamId.has(Zt.detail.callId)){var an={callId:Zt.detail.callId,streamId:Zt.detail.userMediaStreamId,audio:Zt.detail.audioIsAvailable&&Zt.detail.audioIsActive,audioMuted:Zt.detail.audioIsMuted,audioSilent:Zt.detail.audioIsSilent,video:Zt.detail.videoIsAvailable&&Zt.detail.videoIsActive,videoMuted:Zt.detail.videoIsMuted,videoSilent:Zt.detail.videoIsSilent,cause:Zt.detail.cause};tn.get(ur(vt)).emit("localStreamUpdated",an)}},remoteStreamUpdated:function(Zt){var an=Zt.detail,Cn=an.callId,Rn=an.cause;if(vt.callIdToStreamId.has(Cn)&&(Rn==="adaptation"||Rn==="userAction")){var Kn={callId:Cn,streamId:vt.callIdToStreamId.get(Cn),audio:Zt.detail.audioIsAvailable&&Zt.detail.audioIsActive,audioMuted:Zt.detail.audioIsMuted,audioSilent:Zt.detail.audioIsSilent,video:Zt.detail.videoIsAvailable&&Zt.detail.videoIsActive,videoMuted:Zt.detail.videoIsMuted,videoSilent:Zt.detail.videoIsSilent,cause:Rn};setTimeout(function(){tn.get(ur(vt)).emit("remoteStreamUpdated",Kn)})}},MCURecordingStarted:function(Zt){if(Zt.detail.roomName===vt._getTechnicalName()){var an=Bt.g.parseRecordingEvent("MCURecordingStarted",Zt.detail);if(an.callId==="COMPOSITE")vt.recordingStatus=an;else{var Cn=vt.conversationCalls.get(an.callId);Cn&&(Cn.recordingStatus=an)}tn.get(ur(vt)).emit("recordingStarted",an)}},MCURecordingStopped:function(Zt){if(Zt.detail.roomName===vt._getTechnicalName()){var an=Bt.g.parseRecordingEvent("MCURecordingStopped",Zt.detail);if(an.callId==="COMPOSITE")delete vt.recordingStatus;else{var Cn=vt.conversationCalls.get(an.callId);Cn&&delete Cn.recordingStatus}tn.get(ur(vt)).emit("recordingStopped",an)}},MCURecordedStreamsAvailable:function(Zt){if(Zt.detail.roomName===vt._getTechnicalName()){var an=Bt.g.parseRecordingEvent("MCURecordedStreamsAvailable",Zt.detail);tn.get(ur(vt)).emit("recordingAvailable",an)}},MCUStreamingStarted:function(Zt){if(Zt.detail.roomName===vt._getTechnicalName()){var an=js("MCUStreamingStarted",Zt.detail),Cn=vt.conversationCalls.get(an.callId);Cn&&(Cn.streamingStatus=an),tn.get(ur(vt)).emit("streamingStarted",an)}},MCUStreamingStopped:function(Zt){if(Zt.detail.roomName===vt._getTechnicalName()){var an=js("MCUStreamingStopped",Zt.detail),Cn=vt.conversationCalls.get(an.callId);Cn&&delete Cn.streamingStatus,tn.get(ur(vt)).emit("streamingStopped",an)}},onCallStatsUpdate:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){var an=vt.callIdToStreamId.get(Zt.detail.callId),Cn={callId:Zt.detail.callId,streamId:an,stats:{}};Zt.detail.userId&&(Cn.mesh=!0,Cn.userId=Zt.detail.userId,Cn.contact=ro.getOrCreateContact(Zt.detail.userId));for(var Rn=0,Kn=Object.keys(Zt.detail.stats);Rn<Kn.length;Rn++){var Xn=Kn[Rn];Jp.has(Xn)&&(Cn.stats[Xn]=Zt.detail.stats[Xn])}tn.get(ur(vt)).emit("callStatsUpdate",Cn)}},cpuLimited:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){var an=vt.callIdToStreamId.get(Zt.detail.callId),Cn={callId:Zt.detail.callId,streamId:an,encodeUsagePercent:Zt.detail.encodeUsagePercent};tn.get(ur(vt)).emit("cpuLimited",Cn)}},bandwidthLimited:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){var an=vt.callIdToStreamId.get(Zt.detail.callId),Cn={callId:Zt.detail.callId,streamId:an,resolutionChanged:!0};tn.get(ur(vt)).emit("bandwidthLimited",Cn)}},audioAmplitude:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){var an=vt.callIdToStreamId.get(Zt.detail.callId),Cn={callId:Zt.detail.callId,streamId:an,amplitude:Zt.detail.descriptor.amplitude,isSpeaking:Zt.detail.descriptor.isSpeaking,descriptor:{amplitude:Zt.detail.descriptor.amplitude,isSpeaking:Zt.detail.descriptor.isSpeaking}};tn.get(ur(vt)).emit("audioAmplitude",Cn)}},hangup:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.callId)){var an=vt.callIdToStreamId.get(Zt.detail.callId),Cn=Mo.get(ur(vt));Cn.has(an)&&(tn.get(ur(vt)).emit("streamRemoved",Cn.get(an)),Cn.delete(an)),Zt.detail.reason!=="restarted"&&Zt.detail.reason!=="disconnected"&&Zt.detail.reason!=="Broken_by_MCU"&&Zt.detail.reason!=="RTC_Setup_Timeout"&&(vt.conversationCalls.has(Zt.detail.callId)?Bu(ur(vt),Zt.detail.callId):(vt.callIdToStreamId.delete(Zt.detail.callId),vt.releaseResources(an,{isRemote:!0,triggerAdaptation:!0})),tn.get(ur(vt)).emit("hangup",{from:Zt.detail.hangupType,reason:Zt.detail.reason,streamId:an}))}},callRestarting:function(Zt){if(vt.callIdToStreamId.has(Zt.detail.oldCallId)){var an=vt.callIdToStreamId.get(Zt.detail.oldCallId);vt.callIdToStreamId.delete(Zt.detail.oldCallId),vt.callIdToStreamId.set(Zt.detail.newCallId,an)}},MCUParticipantEjected:function(Zt){if(vt._getTechnicalName()===Zt.detail.roomId){var an=wo.get(ur(vt));if(Zt.detail.clientId===an.getId())vt.leave().catch(function(Rn){$n.error("leave",Rn)}).then(function(){tn.get(ur(vt)).emit("participantEjected",{self:!0})});else{var Cn=ro.getOrCreateContact(Zt.detail.clientId);tn.get(ur(vt)).emit("participantEjected",{self:!1,contact:Cn})}}},MCURoomModeChanged:function(Zt){vt._getTechnicalName()===Zt.detail.roomId&&tn.get(ur(vt)).emit("roomModeChanged",{oldMode:Zt.detail.oldMode,newMode:Zt.detail.newMode,state:Zt.detail.state})}};return Xl.set(ur(vt),Qt),tn.get(ur(vt)).on("left",function(){vt.pgroupWaitingRoomSubscribedTo&&(Jn.apiRTCSession.unsubscribePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+vt._getTechnicalName()]),vt.pgroupWaitingRoomSubscribedTo=!1),Ds.set(ur(vt),null),Ns.set(ur(vt),null),wo.set(ur(vt),null),$s.set(ur(vt),null)}),vt}return Ut=Yt,Xt=[{key:"destroy",value:function(){po.get().deleteConversation(this.getName());var dt=Yl.get(this);if(dt){if(dt.apiRTCManager)for(var vt in dt.apiRTCManager)Jn.removeEventListener(vt,dt.apiRTCManager[vt]);dt.contactCatalog&&ro.removeUpdateListener(dt.contactCatalog.onUpdate),Yl.delete(this)}}},{key:"getStatus",value:function(){return this.status}},{key:"getName",value:function(){return ts.get(this).toString()}},{key:"_getTechnicalName",value:function(){return ts.get(this).toString()}},{key:"getRole",value:function(){return Ds.get(this)}},{key:"getInstanceId",value:function(){return $s.get(this)}},{key:"getFriendlyName",value:function(){return null}},{key:"getModerator",value:function(){return Ns.get(this)}},{key:"getType",value:function(){return ns.get(this)}},{key:"setType",value:function(dt){return!this.isBound()&&!!$u.has(dt)&&(ns.set(this,dt),!0)}},{key:"getCloudConversationId",value:function(){var dt=Po.get(this);return dt?dt.toString():null}},{key:"getMedia",value:function(dt){return new Promise(function(vt,Dt){apiRTC.CloudApi.cloudFetchMedia(dt).then(function(Vt){vt(Vt)}).catch(function(Vt){Dt(Vt)})})}},{key:"bind",value:function(dt){var vt=this;dt||(dt={});var Dt=Po.get(this);return Dt!==null?Promise.resolve(String(Dt)):new Promise(function(Vt,Gt){Fu(vt,dt).then(function(Qt){Vt(String(Qt.id))}).catch(function(Qt){Gt(Bt.g.createError(et.g.ERROR_HTTP,"bind() - cannot bind conversation",$n,{fromError:Qt}))})})}},{key:"isBound",value:function(){return Po.get(this)!==null}},{key:"isGroupChatJoined",value:function(){return this.groupChatStatus===et.g.CONVERSATION_STATUS_JOINED}},{key:"joinGroupChat",value:function(){var dt=this;return new Promise(function(vt,Dt){if(dt.groupChatStatus!==et.g.CONVERSATION_STATUS_NOT_JOINED)return Dt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"joinGroupChat() - cannot join group chat",$n));dt.bind().then(function(){return new Promise(function(Vt,Gt){if(dt.asyncCallbacks)return Gt(Bt.g.createError(et.g.ERROR_OTHER,"joinGroupChat() - busy",$n));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return Jn.removeEventListener("groupChatMemberUpdate",dt.asyncCallbacks.groupChatMemberUpdate),delete dt.asyncCallbacks,Gt(Bt.g.createError(et.g.ERROR_OTHER,"joinGroupChat() - timeout",$n))},et.g.CONVERSATION_GROUP_CHAT_MEMBER_UPDATE_DELAY),dt.asyncCallbacks.groupChatMemberUpdate=function(Qt){if(Qt.detail.groupChatId===dt._getTechnicalName()&&Qt.detail.status==="online"&&function(Zt,an){for(var Cn=Zt.length;--Cn>=0;)if(Zt[Cn].contactId===an)return!0;return!1}(Qt.detail.contactList,Jn.getClientId()))return dt.asyncCallbacks&&(Jn.removeEventListener("groupChatMemberUpdate",dt.asyncCallbacks.groupChatMemberUpdate),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Vt()},Jn.onEvent("groupChatMemberUpdate",dt.asyncCallbacks.groupChatMemberUpdate),Jn.joinGroupChat(dt._getTechnicalName())})}).then(function(){dt.groupChatStatus=et.g.CONVERSATION_STATUS_JOINED,Jn.joinAndSubscribeToPresenceGroup(dt._getTechnicalName()),vt()}).catch(function(Vt){Dt(Bt.g.createError(et.g.ERROR_OTHER,"joinGroupChat() - cannot join group chat",$n,{fromError:Vt}))})})}},{key:"leaveGroupChat",value:function(){var dt=this;return new Promise(function(vt,Dt){return dt.groupChatStatus!==et.g.CONVERSATION_STATUS_JOINED?Dt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"leaveGroupChat() - group chat not joined",$n)):dt.status!==et.g.CONVERSATION_STATUS_NOT_JOINED?Dt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"leaveGroupChat() - webconf active",$n)):void Jn.leaveGroupChat(dt._getTechnicalName()).then(function(){dt.groupChatStatus=et.g.CONVERSATION_STATUS_NOT_JOINED,Jn.leaveAndUnsubscribeToPresenceGroup(dt._getTechnicalName()),vt()}).catch(function(Vt){Dt(Bt.g.createError(et.g.ERROR_OTHER,"leaveGroupChat() - cannot leave group chat",$n,{fromError:Vt}))})})}},{key:"isJoined",value:function(){return this.status===et.g.CONVERSATION_STATUS_JOINED}},{key:"isPublishedStream",value:function(dt){return dt.publishedInConversations.has(this.getName())}},{key:"publish",value:function(dt,vt){var Dt=this;return vt||(vt={}),new Promise(function(Vt,Gt){if(Dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Gt(Bt.g.createError(et.g.ERROR_OTHER,"publish() - conversation not joined",$n));if(!(dt instanceof so))return Gt(Bt.g.createError(et.g.ERROR_OTHER,"publish() - No stream specified",$n));if(Dt.isPublishedStream(dt))return Gt(Bt.g.createError(et.g.ERROR_OTHER,"publish() - Stream is already published in this conversation!",$n));var Qt={};Qt.userMediaStreamId=dt.userMediaStreamId,vt!==null&&_s(vt)==="object"&&(Qt.audioOnly=vt.audioOnly,Qt.videoOnly=vt.videoOnly,Qt.private=vt.private,Qt.record=vt.record,Qt.turnServerAddress=vt.turnServerAddress,Qt.profileType=vt.profileType,Qt.priority=vt.priority,Qt.downgradeProfileList=vt.downgradeProfileList,Qt.distributedBroadcastEnabled=vt.distributedBroadcastEnabled),Bt.g.isPropertyTypeof(vt,"mediaType","string")&&(Qt.mediaType=vt.mediaType,Qt.audioOnly&&(Qt.mediaType="AUDIOONLY"),Qt.videoOnly&&(Qt.mediaType="VIDEOONLY")),Bt.g.isPropertyTypeof(vt,"qos","object")&&(Qt.qos={},Bt.g.isPropertyTypeof(vt.qos,"videoMinBitrate","number")&&(Qt.qos.videoMinBitrate=vt.qos.videoMinBitrate),Bt.g.isPropertyTypeof(vt.qos,"videoMinQuality","string")&&(Qt.qos.videoMinQuality=vt.qos.videoMinQuality),Bt.g.isPropertyTypeof(vt.qos,"videoStartBitrate","number")&&(Qt.qos.videoStartBitrate=vt.qos.videoStartBitrate),Bt.g.isPropertyTypeof(vt.qos,"videoStartQuality","string")&&(Qt.qos.videoStartQuality=vt.qos.videoStartQuality),Bt.g.isPropertyTypeof(vt.qos,"videoForbidInactive","boolean")&&(Qt.qos.videoForbidInactive=vt.qos.videoForbidInactive)),Bt.g.isPropertyTypeof(vt,"simulcast","object")&&!Qt.audioOnly&&(Qt.simulcast={},Bt.g.isPropertyTypeof(vt.simulcast,"mode","string")&&["RID","SDP"].indexOf(vt.simulcast.mode)>=0&&(Qt.simulcast.mode=vt.simulcast.mode),Bt.g.isPropertyTypeof(vt.simulcast,"maxBitrate","number")?Qt.simulcast.maxBitrate=vt.simulcast.maxBitrate:Bt.g.isPropertyTypeof(vt.simulcast,"encodings","object")&&(Qt.simulcast.encodings=Object.assign({},vt.simulcast.encodings))),["audioLabels","videoLabels"].forEach(function(dr){Bt.g.isTypeof(vt,dr,"array")&&(Qt[dr]=[],vt[dr].forEach(function(hr){Bt.g.isTypeof(hr,"string")&&Qt[dr].push(hr)}))}),Bt.g.isPropertyTypeof(vt,"context","object")&&(Qt.context=vt.context);var Zt=null;if(dt.hasVideo()&&Dt.getNetworkCap({capacity:!0})&&vt.profileType&&vt.downgradeProfileList){for(var an=vt.downgradeProfileList.length;--an>=0;)if(vt.downgradeProfileList[an].name===vt.profileType){vt.downgradeProfileList[an].bitrate&&(Zt=vt.downgradeProfileList[an].bitrate);break}}if(Zt){if(!Dt.reserveResources(vt.profileType,Zt,dt.userMediaStreamId,!1,vt.priority,{isVideoOnly:!dt.hasAudio(),isVideoMuted:Qt.audioOnly,control:!0})&&!Dt.disableLowerPriorityVideo(!1,Zt,vt.priority)){if(!dt.hasAudio())return Gt(Bt.g.createError(et.g.ERROR_OTHER,"publish() - not enough bandwidth",$n));Qt.audioOnly=!0}Dt.reserveResources(vt.profileType,Zt,dt.userMediaStreamId,!1,vt.priority,{isVideoOnly:!dt.hasAudio(),isVideoMuted:Qt.audioOnly})}$n.info("callConfiguration:",Qt);var Cn=dt.isScreensharing(),Rn=Jn.webRTCClient.publish(Dt.sessionId,Dt.sessionId,Dt.token,Qt,{},{forceScreenSharingCallType:Cn});if(!Rn)return Dt.releaseResources(dt.userMediaStreamId),Gt(Bt.g.createError(et.g.ERROR_OTHER,"publish() - failed to establish call",$n));Dt.conversationCalls.set(Rn,new Gl(Dt,Rn,dt)),dt.publishedInConversations.set(Dt.getName(),Rn),Dt.callIdToStreamId.set(Rn,dt.userMediaStreamId);var Kn={contact:null,isRemote:!1,hasAudio:dt.hasAudio(),hasVideo:dt.hasVideo(),isScreensharing:dt.isScreensharing(),streamId:dt.userMediaStreamId,callId:Rn};Dt.conversationPublishedStreams.set(dt.userMediaStreamId,Kn);var Xn={callEstablishedHandler:function(dr){dr.detail.callId.toString()===Rn.toString()&&(Jn.removeEventListener("callEstablished",Xn.callEstablishedHandler),Dt.removeListener("error",Xn.errorHandler),Vt(dt))}};Jn.onEvent("callEstablished",Xn.callEstablishedHandler),Xn.errorHandler=function(dr){dr.callId===Rn&&(Jn.removeEventListener("callEstablished",Xn.callEstablishedHandler),Dt.removeListener("error",Xn.errorHandler),Dt.releaseResources(dt.userMediaStreamId),Gt(Bt.g.createError(et.g.ERROR_OTHER,"publish() - "+dr.errorInfo,$n)))},Dt.on("error",Xn.errorHandler)})}},{key:"unpublish",value:function(dt,vt){if(vt||(vt={}),dt instanceof so)if(this.isPublishedStream(dt)){var Dt=dt.publishedInConversations.get(this.getName()),Vt=!vt.noTriggerAdaptation;Bu(this,Dt,{stream:dt,triggerAdaptation:Vt}),Jn.webRTCClient&&Jn.webRTCClient.unpublish(Dt)}else $n.error("unpublish() - Stream is not published to conversation");else $n.error("unpublish() - No stream specified",dt)}},{key:"getConversationCall",value:function(dt){if(!dt)return null;var vt=dt.publishedInConversations.get(this.getName());return vt?this.conversationCalls.get(vt):null}},{key:"replacePublishedStream",value:function(dt,vt,Dt){var Vt=this;return $n.info("replacePublishedStream"),new Promise(function(Gt,Qt){var Zt=Vt.getConversationCall(dt);if(Zt===null)return Qt(new Error("CALL_NOT_FOUND"));Zt.replacePublishedStream(vt,Dt).then(function(an){console.error("replacePublishedStream OK"),Gt(an)}).catch(function(an){console.error("replacePublishedStream NOK"),Qt(an)})})}},{key:"getCallId",value:function(dt){return dt.publishedInConversations.get(this.getName())}},{key:"checkAccess",value:function(dt){var vt=this;return dt||(dt={}),new Promise(function(Dt,Vt){if(dt.force!==!0&&vt.accessStatus)return Dt(vt.accessStatus);dt.hasOwnProperty("session")||Br.getActiveSession()===null||(dt.session=Br.getActiveSession()),vt.bind(dt).then(function(Gt){return dt.convId=Gt,Eo.checkConferenceAccess(vt._getTechnicalName(),Jn.getActiveApiKey(),dt)}).then(function(Gt){return Gt.access!==et.g.CONVERSATION_ACCESS_GRANTED&&Gt.access!==et.g.CONVERSATION_NEED_MODERATOR_ACCEPTATION&&$n.warn("checkAccess() - unknown access response:",Gt.access),Gt.role!==et.g.CONVERSATION_ROLE_MODERATOR&&Gt.role!==et.g.CONVERSATION_ROLE_CONTRIBUTOR&&Gt.role!==et.g.CONVERSATION_ROLE_GUEST&&$n.warn("checkAccess() - unknown role response:",Gt.role),Gt.hasOwnProperty("webconfId")&&(vt.webconfId=Gt.webconfId,delete Gt.webconfId),vt.accessStatus=Bt.g.assignObject({},Gt),Dt(vt.accessStatus)}).catch(function(Gt){Vt(Bt.g.createError(et.g.ERROR_APIRTC_INITIALISATION_FAILED,"checkAccess() - cannot check access",$n,{fromError:Gt}))})})}},{key:"join",value:function(){var dt=this,vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return $n.debug("Joining "+this.getName()),new Promise(function(Dt,Vt){if(dt.status!==et.g.CONVERSATION_STATUS_NOT_JOINED)return Vt(Bt.g.createError(et.g.ERROR_OTHER,"join() - cannot join conversation",$n));vt=Object.assign({},vt);var Gt=!1;vt.qualityAdaptationEnabled&&(Gt=!0,delete vt.qualityAdaptationEnabled);var Qt=null;vt.supportedVideoCodecs&&(Qt=vt.supportedVideoCodecs,delete vt.supportedVideoCodecs),dt.checkAccess(vt).then(function(Zt){if(!dt.conference){if(Zt.type!=="public")return Promise.reject(Bt.g.createError(et.g.ERROR_UNAUTHORIZED,"join() - wrong conference type",$n));if(Zt.access!==et.g.CONVERSATION_ACCESS_GRANTED)return Promise.reject(Bt.g.createError(et.g.ERROR_UNAUTHORIZED,"join() - access to conference not granted",$n))}return Qp(dt,Zt)}).then(function(Zt){if(Ds.set(dt,Zt.role),dt.status=et.g.CONVERSATION_STATUS_JOINING,dt.conference)return vt.hasOwnProperty("password")&&Ls.set(dt,vt.password),dt.friendlyName=Zt.hasOwnProperty("friendlyName")?Zt.friendlyName:dt.friendlyName,$s.set(dt,Zt.instanceId),Zp(dt,wo.get(dt),Jn.getActiveApiKey())}).then(function(){var Zt=dt,an=function Kn(Xn){if($n.debug("joinMCUSessionAnswer",Zt._getTechnicalName(),Xn.detail),Xn.detail.roomId.toString()===Zt._getTechnicalName()){if(Xn.detail.result&&Xn.detail.result.failed){$n.error("Conversation "+Zt.getName()+" join failed",Xn.detail),this.status=et.g.CONVERSATION_STATUS_NOT_JOINED;var dr=Xn.detail.result.reason?Xn.detail.result.reason:"join failed";return Vt(Bt.g.createError(et.g.ERROR_UNAUTHORIZED,"join() - "+dr,$n))}$n.info("Conversation "+Zt.getName()+" joined",Xn.detail),Jn.removeEventListener("joinMCUSessionAnswer",Kn),Zt.status=et.g.CONVERSATION_STATUS_JOINED,Zt.token=Xn.detail.token,Zt.sessionId=Xn.detail.sessionId,Zt.mode=Xn.detail.mode,Zt.conversationStreams=new Map;var hr=Xl.get(Zt);Jn.onEvent("MCUAvailableStream",hr.MCUAvailableStream).onEvent("MCUAvailableStreamUpdate",hr.MCUAvailableStreamUpdate).onEvent("MCURemoveStream",hr.MCURemoveStream).onEvent("MCUAvailableComposite",hr.MCUAvailableComposite).onEvent("MCUAvailableReplay",hr.MCUAvailableReplay).onEvent("MCUParticipantEjected",hr.MCUParticipantEjected).onEvent("remoteStreamAdded",hr.remoteStreamAdded).onEvent("remoteStreamRemoved",hr.remoteStreamRemoved).onEvent("roomMemberUpdate",hr.roomMemberUpdate).onEvent("slowLink",hr.slowLink).onEvent("localStreamUpdated",hr.localStreamUpdated).onEvent("remoteStreamUpdated",hr.remoteStreamUpdated).onEvent("simulcastFeedChanged",hr.simulcastFeedChanged).onEvent("MCURecordingStarted",hr.MCURecordingStarted).onEvent("MCURecordingStopped",hr.MCURecordingStopped).onEvent("MCURecordedStreamsAvailable",hr.MCURecordedStreamsAvailable).onEvent("MCUStreamingStarted",hr.MCUStreamingStarted).onEvent("MCUStreamingStopped",hr.MCUStreamingStopped).onEvent("MCURoomModeChanged",hr.MCURoomModeChanged).onEvent("onCallStatsUpdate",hr.onCallStatsUpdate).onEvent("hangup",hr.hangup).onEvent("callRestarting",hr.callRestarting).onEvent("audioAmplitude",hr.audioAmplitude).onEvent("videoQualityChanged",hr.videoQualityChanged).onEvent("cpuLimited",hr.cpuLimited).onEvent("bandwidthLimited",hr.bandwidthLimited),Zt.conference&&Zt.updateData(),Zt.getRole()===et.g.CONVERSATION_ROLE_MODERATOR&&(Jn.apiRTCSession.subscribePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+Zt._getTechnicalName()]),Zt.pgroupWaitingRoomSubscribedTo=!0),Zt.groupChatStatus!==et.g.CONVERSATION_STATUS_NOT_JOINED&&(Zt.groupChatStatus=et.g.CONVERSATION_STATUS_NOT_JOINED),tn.get(Zt).emit("joined");var Mr={};Xn.detail.mode==="mesh"&&(Mr.mode="mesh",Xn.detail.meshOnly===!0&&(Mr.meshOnly=!0)),Dt(Mr)}};Jn.onEvent("joinMCUSessionAnswer",an);var Cn={};Cn.convId=dt.getCloudConversationId(),dt.meshModeEnabled&&(Cn.meshModeEnabled=dt.meshModeEnabled),dt.meshOnlyEnabled&&(Cn.meshOnlyEnabled=dt.meshOnlyEnabled),dt.conference||(dt.moderationEnabled&&(Cn.moderationEnabled=!0),dt.getRole()===et.g.CONVERSATION_ROLE_MODERATOR&&(Cn.moderator=!0)),Gt&&(Cn.qualityAdaptationEnabled=!0),Qt&&(Cn.supportedVideoCodecs=Qt);var Rn=Jn.webRTCClient.joinMCUSession(dt._getTechnicalName(),Cn);if(Rn instanceof Error)return Jn.removeEventListener("joinMCUSessionAnswer",an),Zt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Vt(Bt.g.createError(et.g.ERROR_OTHER,"join() - cannot join conversation :"+Rn.message,$n))}).catch(function(Zt){return dt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Vt(Bt.g.createError(et.g.ERROR_OTHER,"join() - cannot join conversation",$n,{fromError:Zt}))})})}},{key:"cancelJoin",value:function(){return this.cancelJoin0!==null&&typeof this.cancelJoin0=="function"&&this.cancelJoin0()}},{key:"eject",value:function(dt,vt){var Dt=this;return new Promise(function(Vt,Gt){if(Dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Gt(Bt.g.createError(et.g.ERROR_OTHER,"eject() - conference not joined",$n));if(Dt.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR)return Gt(Bt.g.createError(et.g.ERROR_UNAUTHORIZED,"eject() - only moderator can eject a contact",$n));var Qt={};Qt.timeoutId=setTimeout(function(){return Qt&&(Jn.removeEventListener("MCUParticipantEjected",Qt.ejected),Qt=!1),Gt(Bt.g.createError(et.g.ERROR_OTHER,"eject() - timeout",$n))},et.g.CONVERSATION_PARTICIPANT_EJECTION_DELAY),Qt.ejected=function(Zt){if(Zt.detail.roomId===Dt._getTechnicalName()&&Zt.detail.clientId===dt.getId())return Qt&&(clearTimeout(Qt.timeoutId),Jn.removeEventListener("MCUParticipantEjected",Qt.ejected),Qt=!1),Vt()},Jn.onEvent("MCUParticipantEjected",Qt.ejected),Jn.webRTCClient.ejectParticipantFromMCUSession(dt.getId(),vt)})}},{key:"allowEntry",value:function(dt,vt){var Dt=this;return vt||(vt={}),new Promise(function(Vt,Gt){if(Dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Gt(Bt.g.createError(et.g.ERROR_OTHER,"allowEntry() - conference not joined",$n));if(!(dt instanceof No))return Gt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"allowEntry() - parameter is not an instance of apiRTC.Contact",$n));if(Dt.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR)return Gt(Bt.g.createError(et.g.ERROR_UNAUTHORIZED,"allowEntry() - only moderator can allow entry to a contact",$n));var Qt={roomname:Dt._getTechnicalName(),event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,access:!0,command:"access",value:{access:!0}};if(vt.hasOwnProperty("invitationId")&&(Qt.invitationId=vt.invitationId),vt.hasOwnProperty("answer")&&(Qt.answer=vt.answer),Jn.sendData(dt.getId(),Qt).catch(function(an){var Cn=Bt.g.createError(an,"Notification not delivered",$n);tn.get(Dt).emit("messageNotDelivered",{error:Cn,contact:dt,event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,command:"access"})}),vt.ackEnabled===!0){var Zt=setInterval(function(){Qt.command="access-new",Jn.sendData(dt.getId(),Qt).catch(function(an){var Cn=Bt.g.createError(an,"Notification not delivered",$n);tn.get(Dt).emit("messageNotDelivered",{error:Cn,contact:dt,event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,command:"access"})})},et.g.CONVERSATION_JOIN_REQUEST_INTERVAL);Jn.onEvent("receiveData",function an(Cn){var Rn=ro.getOrCreateContact(Cn.detail.senderId);Cn.detail.hasOwnProperty("data")&&Cn.detail.data.command==="access-ack"&&Cn.detail.data.roomname===Dt._getTechnicalName()&&Rn.getId()===dt.getId()&&(clearInterval(Zt),Jn.removeEventListener("receiveData",an))})}return Vt()})}},{key:"denyEntry",value:function(dt,vt){var Dt=this;return vt||(vt={}),new Promise(function(Vt,Gt){if(Dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Gt(Bt.g.createError(et.g.ERROR_OTHER,"denyEntry() - conference not joined",$n));if(!(dt instanceof No))return Gt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"denyEntry() - parameter is not an instance of apiRTC.Contact",$n));if(Dt.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR)return Gt(Bt.g.createError(et.g.ERROR_UNAUTHORIZED,"denyEntry() - only moderator can deny entry to a contact",$n));var Qt={roomname:Dt._getTechnicalName(),event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,access:!1,command:"access",value:{access:!1}};return vt.hasOwnProperty("invitationId")&&(Qt.invitationId=vt.invitationId),vt.hasOwnProperty("answer")&&(Qt.answer=vt.answer),vt.hasOwnProperty("reason")&&(Qt.reason=vt.reason),Jn.sendData(dt.getId(),Qt).catch(function(Zt){var an=Bt.g.createError(Zt,"Notification not delivered",$n);tn.get(Dt).emit("messageNotDelivered",{error:an,contact:dt,event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,command:"access"})}),Vt()})}},{key:"sendJoinRequest",value:function(){var dt=this;if(this.status===et.g.CONVERSATION_STATUS_WAITING){if(!this.joinRequestIntervalId){var vt=Xp(this);vt&&(Jn.sendData(vt,{roomname:this._getTechnicalName(),event:et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,invitationId:this._getTechnicalName(),sendTime:Date.now(),command:"userWaiting",value:{username:ju()}}).catch(function(Dt){var Vt=Bt.g.createError(Dt,"Notification not delivered",$n);tn.get(dt).emit("messageNotDelivered",{error:Vt,contact:dt.getModerator(),event:et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,command:"userWaiting"})}),this.joinRequestIntervalId=setInterval(function(){Jn.sendData(vt,{roomname:dt._getTechnicalName(),event:et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,invitationId:dt._getTechnicalName(),sendTime:Date.now(),command:"userWaiting-new",value:{username:ju()}}).catch(function(Dt){var Vt=Bt.g.createError(Dt,"Notification not delivered",$n);tn.get(dt).emit("messageNotDelivered",{error:Vt,contact:dt.getModerator(),event:et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,command:"userWaiting-new"})})},et.g.CONVERSATION_JOIN_REQUEST_INTERVAL))}}else $n.error("sendJoinRequest() - Not in conversation's waiting room, cannot send join request")}},{key:"leave",value:function(){var dt=this;return new Promise(function(vt,Dt){if(dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Dt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"leave() - webconf not joined",$n));for(var Vt=Xl.get(dt),Gt=0,Qt=Object.keys(Vt);Gt<Qt.length;Gt++){var Zt=Qt[Gt];$n.info("Session, removing apiRTCManager event :",Zt);var an=Vt[Zt];Jn.removeEventListener(Zt,an)}var Cn,Rn=uo(dt.conversationStreams.keys());try{for(Rn.s();!(Cn=Rn.n()).done;){var Kn=Cn.value;$n.trace("Leave() - unsubscribe to "+Kn),Jn.webRTCClient!==null&&Jn.webRTCClient.unsubscribe(Kn)}}catch(Xn){Rn.e(Xn)}finally{Rn.f()}Ql(dt,!1,!1).then(function(){}).catch(function(Xn){}),Jn.webRTCClient!==null&&Jn.IMClient.leaveGroupChat(dt._getTechnicalName()),dt.whiteboardStarted===et.g.CONVERSATION_WHITEBOARD_STARTED&&Jn.whiteBoardClient.roomId===dt._getTechnicalName()&&(Jn.whiteBoardClient.leaveRoom(),Jn.whiteBoardClient.stop(),dt.whiteboardStarted=et.g.CONVERSATION_WHITEBOARD_NOT_STARTED),Jn.webRTCClient!==null&&Jn.webRTCClient.leaveMCUSession(),dt.conversationStreams=new Map,dt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,tn.get(dt).emit("left"),vt()})}},{key:"subscribeToStream",value:function(dt,vt){var Dt=this;if(vt||(vt={}),$n.debug("subscribeToMedia",dt),!this.isJoined())return Promise.reject(Bt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - conversation not joined",$n));var Vt={};vt.turnServerAddress!==null&&vt.turnServerAddress!==void 0&&(Vt.turnServerAddress=vt.turnServerAddress),Bt.g.isPropertyTypeof(vt,"qos","object")&&(Vt.qos={},Bt.g.isPropertyTypeof(vt.qos,"videoForbidInactive","boolean")&&(Vt.qos.videoForbidInactive=vt.qos.videoForbidInactive));var Gt=Number(dt),Qt=Jn.webRTCClient.getStreamFromList(Gt),Zt=this.conversationStreams.get(Gt);if(!Qt||!Zt)return Promise.reject(Bt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - no such stream",$n));if(Bt.g.isPropertyTypeof(vt,"simulcast","object")){var an=["high","medium","low"];Vt.simulcast={},vt.simulcast.streamQuality&&(an.indexOf(vt.simulcast.streamQuality)>=0?Vt.simulcast.streamQuality=vt.simulcast.streamQuality:Vt.simulcast.streamQuality="default"),vt.simulcast.streamFrameRate&&(an.indexOf(vt.simulcast.streamFrameRate)>=0?Vt.simulcast.streamFrameRate=vt.simulcast.streamFrameRate:Vt.simulcast.streamFrameRate="default")}return new Promise(function(Cn,Rn){var Kn="VIDEO";if(Zt.hasVideo&&Dt.getNetworkCap({capacity:!0})&&Bt.g.isPropertyTypeof(Zt,"descriptor","object")){var Xn=Zt.descriptor;if(!Dt.reserveResources(Xn.profileType,Xn.bitrate,Gt,!0,Xn.priority,{isVideoOnly:!Zt.hasAudio,isVideoMuted:vt.audioOnly,control:!0})&&!Dt.disableLowerPriorityVideo(!0,Xn.bitrate,Xn.priority)){if(!Zt.hasAudio)return Rn(Bt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - not enough bandwidth",$n));vt.audioOnly=!0}Dt.reserveResources(Xn.profileType,Xn.bitrate,Gt,!0,Xn.priority,{isVideoOnly:!Zt.hasAudio,isVideoMuted:vt.audioOnly})}vt.audioOnly===!0?Kn="AUDIOONLY":vt.videoOnly===!0&&(Kn="VIDEOONLY");var dr=Jn.webRTCClient.subscribe([Qt],Kn,{},Vt,vt)[0];if(!dr)return Dt.releaseResources(Gt),Rn(Bt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - stream not available",$n));Dt.callIdToStreamId.set(dr,Gt),$n.debug("Subscribed to stream "+dt+" through call "+dr);var hr={streamAddedHandler:function(Mr){Mr.streamId===Gt&&(Dt.removeListener("streamAdded",hr.streamAddedHandler),Dt.removeListener("error",hr.errorHandler),Cn(Mr))}};Dt.on("streamAdded",hr.streamAddedHandler),hr.errorHandler=function(Mr){Mr.callId===dr&&(Dt.removeListener("streamAdded",hr.streamAddedHandler),Dt.removeListener("error",hr.errorHandler),Dt.releaseResources(Gt),Rn(Bt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - "+Mr.errorInfo,$n)))},Dt.on("error",hr.errorHandler)})}},{key:"updateSubscribedStream",value:function(dt,vt){vt||(vt={});var Dt=Number(dt);if(!Mo.get(this).has(Dt))return $n.error("updateSubscribedStream() - Conversation stream "+dt+" does not exist or was not subscribed to"),Promise.reject("wrong streamId");var Vt=Mo.get(this).get(Dt);if(Bt.g.isTypeof(vt.simulcast,"object"))return Jn.webRTCClient.webRTCClient.updateSimulcastFeedOnCall(Vt.callId,vt.simulcast);var Gt="VIDEO";return vt.audioOnly===!0?Gt="AUDIOONLY":vt.videoOnly===!0&&(Gt="VIDEOONLY"),Jn.webRTCClient.webRTCClient.updateMediaTypeOnCall(Vt.callId,Gt)}},{key:"unsubscribeToStream",value:function(dt,vt){vt||(vt={});var Dt=Number(dt);Jn.webRTCClient!==null&&Jn.webRTCClient.unsubscribe(Dt);var Vt=!vt.noTriggerAdaptation;this.releaseResources(dt,{isRemote:!0,triggerAdaptation:Vt})}},{key:"subscribeToMedia",value:function(dt,vt){return this.subscribeToStream(dt,vt)}},{key:"unsubscribeToMedia",value:function(dt){this.unsubscribeToStream(dt)}},{key:"startRecording",value:function(dt){var vt=this;return dt||(dt={}),new Promise(function(Dt,Vt){if(vt.status!==et.g.CONVERSATION_STATUS_JOINED)return Vt(Bt.g.createError(et.g.ERROR_OTHER,"startRecording() - conversation not joined",$n));if(vt.asyncCallbacks)return Vt(Bt.g.createError(et.g.ERROR_OTHER,"startRecording() - busy",$n));vt.asyncCallbacks={},vt.asyncCallbacks.timeoutId=setTimeout(function(){return vt.asyncCallbacks&&(Jn.removeEventListener("error",vt.asyncCallbacks.error),Jn.removeEventListener("MCURecordingStarted",vt.asyncCallbacks.recordingStarted),delete vt.asyncCallbacks),Vt(Bt.g.createError(et.g.ERROR_OTHER,"startRecording() - timeout",$n))},et.g.CONVERSATION_RECORDING_STARTED_DELAY),vt.asyncCallbacks.error=function(an){if(String(an.detail.convId)===vt.getCloudConversationId()&&an.detail.callId==="COMPOSITE"&&an.detail.errorCode.indexOf("START_RECORD")>=0)return vt.asyncCallbacks&&(Jn.removeEventListener("error",vt.asyncCallbacks.error),Jn.removeEventListener("MCURecordingStarted",vt.asyncCallbacks.recordingStarted),clearTimeout(vt.asyncCallbacks.timeoutId),delete vt.asyncCallbacks),Vt(Bt.g.createError(et.g.ERROR_OTHER,"startRecording() - "+an.detail.errorInfo,$n))},vt.asyncCallbacks.recordingStarted=function(an){if(String(an.detail.convId)===vt.getCloudConversationId()&&an.detail.callId==="COMPOSITE"){vt.asyncCallbacks&&(Jn.removeEventListener("error",vt.asyncCallbacks.error),Jn.removeEventListener("MCURecordingStarted",vt.asyncCallbacks.recordingStarted),clearTimeout(vt.asyncCallbacks.timeoutId),delete vt.asyncCallbacks);var Cn=Bt.g.parseRecordingEvent("MCURecordingStarted",an.detail);return Dt(Cn)}},Jn.onEvent("error",vt.asyncCallbacks.error),Jn.onEvent("MCURecordingStarted",vt.asyncCallbacks.recordingStarted);var Gt="AUDIO-VIDEO";dt.audioOnly===!0?Gt="AUDIO-ONLY":dt.videoOnly===!0&&(Gt="VIDEO-ONLY");var Qt="composite";Bt.g.isPropertyTypeof(dt,"customIdInFilename","string")&&(Qt=dt.customIdInFilename);var Zt={};Bt.g.isPropertyTypeof(dt,"data","object")&&(Zt=Bt.g.assignObject({},dt.data)),["complete","efficient","audioOnly"].indexOf(dt.mode)>=0?Zt.mode=dt.mode:Zt.mode="complete",Zt.labelEnabled=dt.labelEnabled===!0,Zt.labelEnabled===!0&&(Zt.labels=[],Bt.g.isTypeof(dt.labels,"array")&&dt.labels.forEach(function(an){Bt.g.isTypeof(an,"string")&&Zt.labels.push(an)})),Bt.g.isTypeof(dt,"ttl","number")&&dt.ttl>0&&(Zt.ttl=dt.ttl),Jn.webRTCClient.startCompositeRecording(Gt,Qt,vt.getCloudConversationId(),Zt)})}},{key:"stopRecording",value:function(){var dt=this;return new Promise(function(vt,Dt){if(dt.asyncCallbacks)return Dt(Bt.g.createError(et.g.ERROR_OTHER,"stopRecording() - busy",$n));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(Jn.removeEventListener("error",dt.asyncCallbacks.error),Jn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),delete dt.asyncCallbacks),vt(dt.recordingStatus)},et.g.CONVERSATION_RECORDING_STOPPED_DELAY),dt.asyncCallbacks.error=function(Vt){if(String(Vt.detail.convId)===dt.getCloudConversationId()&&Vt.detail.callId==="COMPOSITE"&&Vt.detail.errorCode.indexOf("STOP_RECORD")>=0)return dt.asyncCallbacks&&(Jn.removeEventListener("error",dt.asyncCallbacks.error),Jn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Dt(Bt.g.createError(et.g.ERROR_OTHER,"stopRecording() - "+Vt.detail.errorInfo,$n))},dt.asyncCallbacks.recordingStopped=function(Vt){if(String(Vt.detail.convId)===dt.getCloudConversationId()&&Vt.detail.callId==="COMPOSITE"){dt.asyncCallbacks&&(Jn.removeEventListener("error",dt.asyncCallbacks.error),Jn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var Gt=Bt.g.parseRecordingEvent("MCURecordingStopped",Vt.detail);return vt(Gt)}},Jn.onEvent("error",dt.asyncCallbacks.error),Jn.onEvent("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),Jn.webRTCClient.stopCompositeRecording()})}},{key:"getContacts",value:function(){$n.debug("getContacts()");var dt={};if(this.isBound()){var vt,Dt=Ro.get().getContacts(this._getTechnicalName()),Vt=uo(Dt.keys());try{for(Vt.s();!(vt=Vt.n()).done;){var Gt=vt.value;dt[Gt]=Dt.get(Gt)}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}}else $n.warn("getContacts() - Cannot get contacts as conversation is not joined");return dt}},{key:"getContactsArray",value:function(){$n.debug("getContactsArray()");var dt=[];if(this.isBound()){var vt,Dt=Ro.get().getContacts(this._getTechnicalName()),Vt=uo(Dt.keys());try{for(Vt.s();!(vt=Vt.n()).done;){var Gt=vt.value;dt.push(Dt.get(Gt))}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}}else $n.warn("getContacts() - Cannot get contacts as conversation is not joined");return dt}},{key:"getContactsNumber",value:function(){$n.debug("getContactsNumber()");var dt=0;return this.isBound()?dt=Ro.get().getContacts(this._getTechnicalName()).size:$n.warn("getContactsNumber() - Cannot get contacts as conversation is not joined"),dt}},{key:"getData",value:function(){return $n.debug("getData()"),this.isBound()||$n.warn("getData() - Cannot get most recent data as conversation is not joined, you may want to call Conversation.updateData() instead"),qo.get(this)}},{key:"setData",value:function(dt){var vt=this;return new Promise(function(Dt,Vt){vt.bind().then(function(){return Eo.setConversationData(Po.get(vt),JSON.stringify(dt),Jn.getActiveApiKey(),{token:wo.get(vt).token})}).then(function(){qo.set(vt,dt),Jn.dataClient.sendDataToGroup(vt._getTechnicalName(),{event:et.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER,roomname:vt._getTechnicalName()}),Dt()}).catch(function(){Vt(Bt.g.createError(et.g.ERROR_OTHER,"setData() - cannot set conversation data",$n))})})}},{key:"updateData",value:function(){var dt=this;return new Promise(function(vt,Dt){(dt.isBound()?Fu(dt):dt.bind()).then(function(){vt(),tn.get(dt).emit("persistentDataUpdated",qo.get(dt))}).catch(function(Vt){Dt(Bt.g.createError(et.g.ERROR_OTHER,"updateData() - cannot update conversation data",$n,{fromError:Vt}))})})}},{key:"getAvailableMediaList",value:function(){return $n.warn("Function deprecated, please use Conversation.getAvailableStreamList() instead"),this.getAvailableStreamList()}},{key:"getAvailableStreamList",value:function(){var dt,vt=[],Dt=uo(this.conversationStreams.keys());try{for(Dt.s();!(dt=Dt.n()).done;){var Vt=dt.value;vt.push(this.conversationStreams.get(Vt))}}catch(Gt){Dt.e(Gt)}finally{Dt.f()}return vt}},{key:"getStreamInfo",value:function(dt){return this.conversationStreams.get(dt)}},{key:"getSubscribedStream",value:function(dt){return Mo.get(this).get(Number(dt))}},{key:"linkWhiteboardClientToConversation",value:function(){$n.warn("DEPRECATED : linkWhiteboardClientToConversation : no more needed")}},{key:"startNewWhiteboardSession",value:function(dt,vt){var Dt=this;return $n.debug("startNewWhiteboardSession()"),new Promise(function(Vt,Gt){Dt.bind().then(function(){if(Dt.asyncCallbacks)return Gt(Bt.g.createError(et.g.ERROR_OTHER,"startNewWhiteboardSession() - busy",$n));if(Dt.whiteboardStarted!==et.g.CONVERSATION_WHITEBOARD_NOT_STARTED)return Vt();Jn.whiteBoardClient.start(),Dt.asyncCallbacks={},Dt.asyncCallbacks.ackHandler=function(Zt){var an=Zt.detail;an.roomId===Dt._getTechnicalName()&&an.roomType==="whiteBoard"&&(an.eventType==="roomCreation"&&an.status==="roomCreated"||an.eventType==="roomJoined"&&an.status==="roomJoined")&&(Dt.asyncCallbacks&&(Jn.removeEventListener("roomCreation",Dt.asyncCallbacks.ackHandler),Jn.removeEventListener("roomJoined",Dt.asyncCallbacks.ackHandler),clearTimeout(Dt.asyncCallbacks.timeoutId),delete Dt.asyncCallbacks),Jn.whiteBoardClient.setCanvas(dt),vt!=null&&Jn.whiteBoardClient.setUserCursorColor(vt),Jn.whiteBoardClient.deleteHistory(),Dt.whiteboardStarted=et.g.CONVERSATION_WHITEBOARD_STARTED,Vt())},Jn.onEvent("roomCreation",Dt.asyncCallbacks.ackHandler),Jn.onEvent("roomJoined",Dt.asyncCallbacks.ackHandler),Dt.asyncCallbacks.timeoutId=setTimeout(function(){return Dt.asyncCallbacks&&(Jn.removeEventListener("roomCreation",Dt.asyncCallbacks.ackHandler),Jn.removeEventListener("roomJoined",Dt.asyncCallbacks.ackHandler),delete Dt.asyncCallbacks),Gt(Bt.g.createError(et.g.ERROR_OTHER,"startNewWhiteboardSession() - timeout",$n))},et.g.CONVERSATION_WHITEBOARD_START_DELAY);var Qt=Dt.getCloudConversationId();Jn.whiteBoardClient.joinRoom(Dt._getTechnicalName(),{convId:Qt,webconf:!0})}).catch(function(Qt){Gt(Bt.g.createError(et.g.ERROR_OTHER,"startNewWhiteboardSession() - cannot start whiteboard session",$n,{fromError:Qt}))})})}},{key:"stopNewWhiteboardSession",value:function(){var dt=this;return $n.debug("stopNewWhiteboardSession()"),new Promise(function(vt,Dt){dt.bind().then(function(){return dt.whiteboardStarted!==et.g.CONVERSATION_WHITEBOARD_STARTED?($n.error("Conversation is not joined!"),Dt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"stopWhiteBoard() - Conversation not joined",$n))):Jn.whiteBoardClient.roomId!==dt._getTechnicalName()?($n.error("Whiteboard session is not joined for this conversation!"),Dt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"stopWhiteBoard() - whiteboard not joined",$n))):(Jn.whiteBoardClient.leaveRoom(),Jn.whiteBoardClient.stop(),dt.whiteboardStarted=et.g.CONVERSATION_WHITEBOARD_NOT_STARTED,void vt())}).catch(function(Vt){Dt(Bt.g.createError(et.g.ERROR_OTHER,"stopNewWhiteboardSession() - cannot stop whiteboard session",$n,{fromError:Vt}))})})}},{key:"enablePointerSharing",value:function(dt){return Ql(this,!0,dt)}},{key:"sendPointerLocation",value:function(dt,vt,Dt,Vt){Jn.pointerSharingClient.sendPointerLocation(this._getTechnicalName(),dt,vt,Dt,Vt)}},{key:"sendData",value:function(dt){var vt=this;return new Promise(function(Dt,Vt){vt.bind().then(function(){Jn.dataClient.sendDataToGroup(vt._getTechnicalName(),{event:et.g.CONVERSATION_SEND_DATA_IDENTIFIER,content:dt,roomname:vt._getTechnicalName()}),Dt()}).catch(function(Gt){Vt(Bt.g.createError(et.g.ERROR_OTHER,"sendData() - cannot send data",$n))})})}},{key:"sendRawData",value:function(dt){var vt=this;return new Promise(function(Dt,Vt){vt.bind().then(function(){Jn.dataClient.sendDataToGroup(vt._getTechnicalName(),dt),Dt()}).catch(function(Gt){Vt(Bt.g.createError(et.g.ERROR_OTHER,"sendRawData() - cannot send data",$n))})})}},{key:"sendCustomEvent",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,Gt){vt.bind().then(function(){var Qt=Dt;Qt.event=dt,Qt.roomname=vt._getTechnicalName(),Jn.dataClient.sendDataToGroup(vt._getTechnicalName(),Qt),Vt()}).catch(function(Qt){Gt(Bt.g.createError(et.g.ERROR_OTHER,"sendCustomEvent() - cannot send data",$n))})})}},{key:"sendMessage",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=function(Gt){return new Promise(function(Qt,Zt){var an=wo.get(vt);an!==null?Eo.saveGroupChatMessage(vt,an,Jn.getActiveApiKey(),dt,Gt,Dt).then(function(){Qt(Gt)}).catch(Zt):Qt(Gt)})};return new Promise(function(Gt,Qt){if(vt.groupChatStatus!==et.g.CONVERSATION_STATUS_JOINED&&vt.status!==et.g.CONVERSATION_STATUS_JOINED)return Qt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"sendMessage() - group chat not joined",$n));if(dt===null||typeof dt!="string")return Qt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"sendMessage() - wrong type of message",$n));if(dt==="")return Qt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"sendMessage() - message parameter is empty",$n));var Zt={};Bt.g.isTypeof(Dt,"metadata","object")&&(Zt.metadata=Dt.metadata),Jn.sendMessageToGroupChat(vt._getTechnicalName(),dt,Zt).then(function(an){Vt(an).then(function(){Gt(an)}).catch(function(Cn){Qt(Bt.g.createError(et.g.ERROR_OTHER,"sendMessage() - error on save",$n,{fromError:Cn}))})}).catch(function(an){Qt(Bt.g.createError(et.g.ERROR_OTHER,"sendMessage() - cannot send message",$n,{fromError:an}))})})}},{key:"pushMedia",value:function(dt,vt){var Dt=this;return vt||(vt={}),new Promise(function(Vt,Gt){Dt.bind().then(function(){return vt.hasOwnProperty("token")||(vt.token=wo.get(Dt).token),Eo.pushConversationMedia(Po.get(Dt),dt,Jn.getActiveApiKey(),vt)}).then(function(Qt){Jn.dataClient.sendDataToGroup(Dt._getTechnicalName(),{event:et.g.CONVERSATION_NEW_MEDIA_IDENTIFIER,roomname:Dt._getTechnicalName(),media:{url:Qt.url,id:Qt.id},command:"new_snapshot",value:{snapshot:Qt.url}}),Vt({url:Qt.url,id:Qt.id})}).catch(function(Qt){Gt(Bt.g.createError(et.g.ERROR_OTHER,"pushMedia() - cannot push media",$n,{fromError:Qt}))})})}},{key:"pushData",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Dt=Bt.g.assignObject({},Dt),new Promise(function(Vt,Gt){if(Jn.webRTCClient.webRTCClient.dataChannelCapable!==!0||Dt.forceHTTP===!0){if(!dt.file)return Gt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"pushData() - missing file",$n));var Qt={};if(Bt.g.isTypeof(dt,"metadata","object"))try{Qt.metadata=JSON.stringify(dt.metadata)}catch(Zt){$n.error("JSON.stringify",Zt)}Qt.asFile=!0,Bt.g.isTypeof(dt,"filename","string")?Qt.filename=dt.filename:Qt.filename=dt.file.name,dt.overwrite===!0&&(Qt.overwrite=!0),Bt.g.isTypeof(dt,"ttl","number")&&dt.ttl>0&&(Qt.ttl=dt.ttl),vt.pushMedia(dt.file,Qt).then(Vt).catch(Gt)}else vt.bind().then(function(){var Zt=vt._getTechnicalName(),an={};Dt.hasOwnProperty("turnServerAddress")&&(an.turnServerAddress=Dt.turnServerAddress,delete Dt.turnServerAddress);var Cn=Jn.webRTCClient.webRTCClient.pushData(vt.getCloudConversationId(),dt,an,{success:function(Rn){if(Rn.state!=="complete")return Gt(Bt.g.createError(et.g.ERROR_OTHER,"pushData() - cannot push data",$n));Jn.dataClient.sendDataToGroup(Zt,{event:et.g.CONVERSATION_NEW_MEDIA_IDENTIFIER,roomname:Zt,media:{url:Rn.mediaURL,id:Rn.mediaId},command:"new_snapshot",value:{snapshot:Rn.mediaURL}}),Vt({url:Rn.mediaURL,id:Rn.mediaId})},failure:function(Rn,Kn){if(Rn==="iceFailed"){var Xn=Bt.g.assignObject({},Dt);return Xn.forceHTTP=!0,void vt.pushData(dt,Xn).then(Vt).catch(Gt)}if(Rn==="timeout"){if(Kn){var dr=vt.transferCallIds.indexOf(Kn);dr>=0&&vt.transferCallIds.splice(dr,1)}return Gt(Bt.g.createError(et.g.ERROR_TIMED_OUT,"pushData() - push data timed out",$n))}return Gt(Rn==="canceled"?Bt.g.createError(et.g.ERROR_OPERATION_CANCELED,"pushData() - push data canceled",$n):Bt.g.createError(et.g.ERROR_OTHER,"pushData() - cannot push data",$n,{fromError:Rn}))}});if(!Cn)return Gt(Bt.g.createError(et.g.ERROR_OTHER,"pushData() - cannot push data",$n));vt.transferCallIds.push(Cn)}).catch(function(Zt){return Gt(Bt.g.createError(et.g.ERROR_OTHER,"pushData() - cannot push data",$n,{fromError:Zt}))})})}},{key:"cancelPushData",value:function(dt){var vt=this;return new Promise(function(Dt,Vt){if(!vt.transferCallIds.includes(dt))return Vt(Bt.g.createError(et.g.ERROR_OTHER,"cancelPushData() - no such push data",$n));var Gt=Jn.webRTCClient.webRTCClient.cancelPushData(dt);if(Gt)return Vt(Bt.g.createError(et.g.ERROR_OTHER,"cancelPushData() - "+Gt,$n));Dt()})}},{key:"fetchMediaList",value:function(dt,vt){var Dt=this;return vt||(vt={}),new Promise(function(Vt,Gt){Dt.bind().then(function(){return Object.prototype.hasOwnProperty.call(vt,"token")||(Bt.g.isTypeof(dt,"object")&&dt instanceof Br?vt.token=dt.getToken():vt.token=wo.get(Dt).token),Eo.getConversationMediaList(Po.get(Dt),Jn.getActiveApiKey(),vt)}).then(Vt).catch(function(Qt){Gt(Bt.g.createError(et.g.ERROR_OTHER,"fetchMediaList() - cannot fetch media list",$n,{fromError:Qt}))})})}},{key:"getWaitingRoomContacts",value:function(){$n.debug("getWaitingRoomContacts()");var dt={};if(this.status!==et.g.CONVERSATION_STATUS_JOINED)$n.error("getWaitingRoomContacts() - Conversation is not joined, cannot get waiting room contacts");else if(this.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR)$n.error("getWaitingRoomContacts() - Role is not moderator, cannot get waiting room contacts");else{var vt,Dt=Ro.get().getContacts(et.g.CONVERSATION_WAITING_ROOM_PREFIX+this._getTechnicalName()),Vt=uo(Dt.keys());try{for(Vt.s();!(vt=Vt.n()).done;){var Gt=vt.value;dt[Gt]=Dt.get(Gt)}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}}return dt}},{key:"fetchMessageHistory",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,Gt){vt.bind().then(function(){return Object.prototype.hasOwnProperty.call(Dt,"token")?Eo.loadGroupChatMessages(vt,null,Dt.token):(Bt.g.isTypeof(dt,"object")&&dt instanceof Br||(dt=wo.get(vt)),Eo.loadGroupChatMessages(vt,dt))}).then(function(Qt){var Zt=Qt.map(function(an){var Cn={content:an.content,timestamp:1e3*an.created_at,date:new Date(1e3*an.created_at),sender_id:an.user_id,display_name:an.display_name};return an.user_id.toString()!==dt.getId()&&(Cn.sender=dt.getOrCreateContact(an.user_id)),Cn});Vt(Zt)}).catch(function(Qt){Gt(Bt.g.createError(et.g.ERROR_OTHER,"fetchMessageHistory() - cannot fetch message history",$n))})})}},{key:"sendInvitation",value:function(dt,vt){var Dt=this;if(vt||(vt={}),dt instanceof No){$n.info("Invite "+dt.getId()+" to "+this._getTechnicalName()),dt.isOnline()||$n.warn("sendInvitation() - contact "+dt.getUsername()+" does not seem to be connected.");var Vt={receiveNotifier:new pt};vt.hasOwnProperty("expirationTime")&&(Vt.expirationTime=vt.expirationTime);var Gt=new Do(dt,this,Vt);Gt.type="conversation";var Qt={event:et.g.CONVERSATION_INVITATION_IDENTIFIER,invitationId:Gt.id,roomname:this._getTechnicalName(),sendTime:Gt.sendTime,conversationTypes:[]};return this.status===et.g.CONVERSATION_STATUS_JOINED?Qt.conversationTypes.push("WEBCONF"):this.groupChatStatus===et.g.CONVERSATION_STATUS_JOINED&&Qt.conversationTypes.push("GROUP_CHAT"),Jn.sendData(dt.getId(),Qt).then(function(){Vt.receiveNotifier.emit("receive")}).catch(function(Zt){var an=Bt.g.createError(Zt,"Invitation not delivered",$n);tn.get(Dt).emit("messageNotDelivered",{error:an,contact:dt,event:et.g.CONVERSATION_INVITATION_IDENTIFIER})}),Gt}return $n.error("Parameter is not a contact"),null}},{key:"isRecorded",value:function(){return!!this.recordingStatus}},{key:"getRecordingInfo",value:function(){return this.isRecorded()?this.recordingStatus:null}},{key:"setNetworkCap",value:function(dt,vt){return typeof dt!="number"||typeof vt!="number"?($n.error("setNetworkCap - wrong cap",dt,vt),!1):dt<=0||vt<=0?(this.uploadCap=null,this.downloadCap=null,!0):(this.uploadCap=dt,this.downloadCap=vt,!0)}},{key:"getNetworkCap",value:function(){var dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.uploadCap||!this.downloadCap)return null;if(dt.capacity)return[this.uploadCap,this.downloadCap];for(var vt=this.uploadCap,Dt=this.downloadCap,Vt=this.reservedStreams.length;--Vt>=0;)this.reservedStreams[Vt].isVideoMuted||(this.reservedStreams[Vt].isRemote?Dt-=this.reservedStreams[Vt].resource:vt-=this.reservedStreams[Vt].resource);return[vt,Dt]}},{key:"getStreamResourceReservation",value:function(dt){for(var vt=this.reservedStreams.length;--vt>=0;)if(this.reservedStreams[vt].streamId===dt)return this.reservedStreams[vt];return null}},{key:"reserveResources",value:function(dt,vt,Dt,Vt,Gt){var Qt=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if($n.debug("reserveResources",Dt),this.getStreamResourceReservation(Dt))throw new Error("reserveResources - already reserved stream");var Zt=!1,an={streamId:Dt,profileType:dt,priority:Gt,resource:vt,isRemote:Vt};if(an.isVideoOnly=!!Qt.isVideoOnly,Qt.isVideoMuted)an.isVideoMuted=!0,Zt=!0;else{an.isVideoMuted=!1;var Cn=this.getNetworkCap();Zt=Vt?Cn[1]>=an.resource:Cn[0]>=an.resource}if(Qt.control)return Zt;if(!Zt)throw new Error("reserveResources - no such bandwidth availability");return this.reservedStreams.push(an),this.reservedStreams.sort(function(Rn,Kn){return Rn.priority>Kn.priority?-1:Rn.priority===Kn.priority?0:1}),$n.debug("reservedStreams",this.reservedStreams),!0}},{key:"releaseResources",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.getNetworkCap({capacity:!0}))return!1;$n.debug("releaseResources",dt);for(var Dt=!1,Vt=this.reservedStreams.length;--Vt>=0;)if(this.reservedStreams[Vt].streamId===dt){this.reservedStreams.splice(Vt,1),Dt=!0;break}return $n.debug("reservedStreams",this.reservedStreams),Dt&&vt.triggerAdaptation&&this.enableHigherPriorityVideo(!!vt.isRemote),Dt}},{key:"changeStreamPriority",value:function(dt,vt,Dt){$n.debug("changeStreamPriority",dt,vt,Dt);for(var Vt=null,Gt=this.reservedStreams.length;--Gt>=0;)if(this.reservedStreams[Gt].isRemote===vt&&this.reservedStreams[Gt].streamId===dt){Vt=this.reservedStreams[Gt];break}return!(!Vt||Vt.priority===Dt||(Vt.priority=Dt,this.reservedStreams.sort(function(Qt,Zt){return Qt.priority>Zt.priority?-1:Qt.priority===Zt.priority?0:1}),$n.debug("reservedStreams",this.reservedStreams),Vt.isVideoMuted?this.disableLowerPriorityVideo(Vt.isRemote,Vt.resource,Vt.priority)&&zu(this,Vt):this.enableHigherPriorityVideo(Vt.isRemote,{resource:Vt.resource,priority:Vt.priority,control:!0})&&(Vu(this,Vt),this.enableHigherPriorityVideo(Vt.isRemote)),0))}},{key:"disableLowerPriorityVideo",value:function(dt,vt,Dt){$n.debug("disableLowerPriorityVideo",dt,vt,Dt);for(var Vt=[],Gt=0,Qt=this.reservedStreams.length;--Qt>=0&&(this.reservedStreams[Qt].isRemote!==dt||this.reservedStreams[Qt].isVideoMuted||this.reservedStreams[Qt].priority>=Dt||(Vt.push(this.reservedStreams[Qt]),!((Gt+=this.reservedStreams[Qt].resource)>=vt))););if(Vt.length===0||Gt<vt)return!1;for(var Zt=Vt.length;--Zt>=0;)Vu(this,Vt[Zt]);return!0}},{key:"enableHigherPriorityVideo",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};$n.debug("enableHigherPriorityVideo",dt);var Dt=this.getNetworkCap(),Vt=dt?Dt[1]:Dt[0];vt.resource&&vt.resource>0&&(Vt+=vt.resource);for(var Gt=[],Qt=0;Qt<this.reservedStreams.length;Qt+=1)this.reservedStreams[Qt].isRemote===dt&&this.reservedStreams[Qt].isVideoMuted&&(Object.prototype.hasOwnProperty.call(vt,"priority")&&this.reservedStreams[Qt].priority<=vt.priority||this.reservedStreams[Qt].resource<=Vt&&(Vt-=this.reservedStreams[Qt].resource,Gt.push(this.reservedStreams[Qt])));if(Gt.length===0)return!1;if(vt.control)return!0;for(var Zt=Gt.length;--Zt>=0;)zu(this,Gt[Zt]);return!0}},{key:"startComposite",value:function(){var dt=this;return new Promise(function(vt,Dt){if(dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Dt(Bt.g.createError(et.g.ERROR_OTHER,"startComposite() - conversation not joined",$n));Jn.webRTCClient.startComposite(dt._getTechnicalName()),vt()})}},{key:"stopComposite",value:function(){var dt=this;return new Promise(function(vt,Dt){if(dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Dt(Bt.g.createError(et.g.ERROR_OTHER,"stopComposite() - conversation not joined",$n));Jn.webRTCClient.stopComposite(dt._getTechnicalName()),vt()})}},{key:"callVoIP",value:function(dt){var vt=this;return new Promise(function(Dt,Vt){return dt&&typeof dt=="string"?vt.status!==et.g.CONVERSATION_STATUS_JOINED?Vt(Bt.g.createError(et.g.ERROR_OTHER,"callVoIP() - conversation not joined",$n)):void Jn.webRTCClient.webRTCClient.MCUClient.inviteVoIP(vt._getTechnicalName(),vt.getCloudConversationId(),dt).then(Dt).catch(function(Gt){Vt(Bt.g.createError(et.g.ERROR_OTHER,"callVoIP() - "+Gt.message,$n))}):Vt(Bt.g.createError(et.g.ERROR_OTHER,"callVoIP() - wrong phoneNumber",$n))})}},{key:"manageDisconnectionWarningEvent",value:function(dt){$n.debug("manageDisconnectionWarningEvent",dt.detail);var vt={};if(this.callIdToStreamId.has(dt.detail.callId)){$n.debug("call is linked with conversation");var Dt=this.callIdToStreamId.get(dt.detail.callId);vt=dt.detail.settingUpType==="publish"||dt.detail.settingUpType==="shareScreen"?this.conversationPublishedStreams.get(Dt):this.conversationStreams.get(Dt),tn.get(this).emit("disconnectionWarning",{streamInfo:vt})}else $n.debug("call is not linked with conversation")}},{key:"manageErrorEvent",value:function(dt){if($n.debug("manageErrorEvent",dt.detail),dt.detail.errorCode==="DISTANT_ICE_CONNECTION_STATE_DISCONNECTED"||dt.detail.errorCode==="DISTANT_ICE_CONNECTION_STATE_FAILED")tn.get(this).emit("error",{errorCode:dt.detail.errorCode,errorInfo:dt.detail.errorInfo,descriptor:dt.detail.data});else if(this.callIdToStreamId.has(dt.detail.callId)){$n.debug("call is linked with conversation");var vt=this.callIdToStreamId.get(dt.detail.callId),Dt={streamInfo:dt.detail.settingUpType==="publish"?this.conversationPublishedStreams.get(vt):this.conversationStreams.get(vt),errorCode:dt.detail.errorCode,errorInfo:dt.detail.errorInfo,callId:dt.detail.callId,streamId:vt};if(dt.detail.data&&(Dt.descriptor=dt.detail.data),tn.get(this).emit("error",Dt),Yp.has(dt.detail.errorCode)){var Vt=this.conversationCalls.get(dt.detail.callId);Vt?this.unpublish(Vt.stream):(this.unsubscribeToStream(vt),dt.detail.errorCode==="CALL_ABORTED"&&this.callIdToStreamId.delete(dt.detail.callId))}}else $n.debug("call is not linked with conversation")}}],kt=[{key:"getAvailableEvents",value:function(){return Kp}}],Xt&&Lu(Ut.prototype,Xt),kt&&Lu(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(fn),ju=function(){var jt="guest";if(apiRTC.userAgentInstance){var Ut=apiRTC.userAgentInstance.getUsername();Ut&&(jt=Ut)}return jt},Fu=function(jt){var Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Xt,kt){var Ft=null;if(Bt.g.isPropertyTypeof(Ut,"session","object")&&Ut.session instanceof Br)Ft=Ut.session;else{if(Br.getActiveSession()===null)return kt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"getOrCreateConversation() - missing session",$n));Ft=Br.getActiveSession()}var sn={};sn.token=Ft.getToken(),sn.active=jt.active,Eo.getOrCreateConversation(jt,Jn.getActiveApiKey(),sn).then(function(ln){Bt.g.isTypeof(ln,"public_id","string")&&(ln.id=ln.public_id,delete ln.public_id),Po.set(jt,ln.id),qo.set(jt,ln.data),Bt.g.isTypeof(ln.typeString,"string")&&$u.has(ln.typeString)&&ns.set(jt,ln.typeString),wo.set(jt,Ft),Xt(ln)}).catch(function(ln){Po.set(jt,null),qo.set(jt,null),ns.set(jt,null),kt(Bt.g.createError(et.g.ERROR_HTTP,"getOrCreateConversation() - cannot get/create conversation",$n,{fromError:ln}))})})},Xp=function(jt){var Ut=jt.getModerator();return Ut?Ut.getId():!jt.conference&&jt.moderationEnabled?"#":null},Qp=function(jt,Ut){return new Promise(function(Xt,kt){if(jt.conference){if(Ut.access===et.g.CONVERSATION_ACCESS_GRANTED)return Xt(Ut);if(Ut.access!==et.g.CONVERSATION_NEED_MODERATOR_ACCEPTATION)return kt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"You were not allowed to join the conference"));var Ft=ro.getOrCreateContact(Ut.moderator);Ns.set(jt,Ft),Wu(jt).then(function(){Xt(Ut)}).catch(kt)}else{if(!jt.moderationEnabled)return Xt(Object.assign(Ut,{access:et.g.CONVERSATION_ACCESS_GRANTED,role:et.g.CONVERSATION_ROLE_GUEST}));if(jt.moderator)return Xt(Object.assign(Ut,{access:et.g.CONVERSATION_ACCESS_GRANTED,role:et.g.CONVERSATION_ROLE_MODERATOR}));Wu(jt).then(function(){Xt(Object.assign(Ut,{access:et.g.CONVERSATION_NEED_MODERATOR_ACCEPTATION,role:et.g.CONVERSATION_ROLE_GUEST}))}).catch(kt)}})},Wu=function(jt){return new Promise(function(Ut,Xt){var kt=jt.getModerator();jt.status=et.g.CONVERSATION_STATUS_WAITING;var Ft=!1,sn=setTimeout(function(){Jn.apiRTCSession.joinPresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+jt._getTechnicalName()],{doneByApiRTC:!0}),Ft=!0},et.g.JOIN_WAITING_ROOM_PRESENCE_GROUP_TIMEOUT);kt&&tn.get(jt).emit("waitingForModeratorAcceptance",kt);var ln=new Do(kt,jt);ln.id=jt._getTechnicalName(),ln.type=jt.conference?"conference":"conversation",jt.sendJoinRequest();var Yt=function dt(vt){$n.debug("dataMessage (waitingRoom)",vt.detail);var Dt=vt.detail.data;if(Dt.roomname===jt._getTechnicalName()){var Vt=vt.detail.senderId.toString();Dt.command==="access"||Dt.command==="access-new"||Dt.event===et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER?(delete jt.cancelJoin0,jt.joinRequestIntervalId&&(clearInterval(jt.joinRequestIntervalId),delete jt.joinRequestIntervalId),Jn.removeEventListener("receiveData",dt),Ft===!0?Jn.apiRTCSession.leavePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+jt._getTechnicalName()],{doneByApiRTC:!0}):sn&&clearTimeout(sn),Dt.value.hasOwnProperty("access")&&Dt.value.access||Dt.access?(Jn.sendData(Vt,{roomname:jt._getTechnicalName(),command:"access-ack"}).catch(function(Gt){var Qt=Bt.g.createError(Gt,"Notification not delivered",$n);tn.get(jt).emit("messageNotDelivered",{error:Qt,contact:kt,command:"access-ack"})}),Ut()):(jt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Xt(Bt.g.createError(et.g.ERROR_NOT_ALLOWED,"You were not allowed to join the conversation",$n)))):Dt.event===et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER&&Dt.roomname===jt._getTechnicalName()&&tn.get(jt).emit("moderatorConnected",ro.getOrCreateContact(Vt))}};Jn.onEvent("receiveData",Yt),ln.onResponse(function(dt){Jn.removeEventListener("receiveData",Yt),Ft===!0?Jn.apiRTCSession.leavePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+jt._getTechnicalName()]):sn&&clearTimeout(sn),dt===et.g.INVITATION_STATUS_ACCEPTED?Ut():(jt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Xt(Bt.g.createError(et.g.ERROR_NOT_ALLOWED,"You were not allowed to join the conversation",$n)))}),jt.cancelJoin0=function(){return delete jt.cancelJoin0,jt.joinRequestIntervalId&&(clearInterval(jt.joinRequestIntervalId),delete jt.joinRequestIntervalId),Jn.removeEventListener("receiveData",Yt),Ft===!0?Jn.apiRTCSession.leavePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+jt._getTechnicalName()],{doneByApiRTC:!0}):sn&&clearTimeout(sn),jt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Xt(Bt.g.createError(et.g.ERROR_OPERATION_CANCELED,"Operation canceled",$n)),!0}})},Zp=function(jt,Ut,Xt){return new Promise(function(kt){Eo.updateConferencePresence(jt,Ut,Xt).then(kt,function(Ft){$n.warn("updateConferencePresence",Ft),kt()})})},Bu=function(jt,Ut){var Xt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},kt=Xt.stream;if(!kt){var Ft=jt.conversationCalls.get(Ut);if(!Ft)return!1;kt=Ft.stream}return Xt.noTriggerAdaptation?jt.releaseResources(kt.userMediaStreamId):jt.releaseResources(kt.userMediaStreamId,{triggerAdaptation:!0}),kt.publishedInConversations.delete(jt.getName()),jt.conversationPublishedStreams.delete(kt.userMediaStreamId),jt.callIdToStreamId.delete(Ut),jt.conversationCalls.delete(Ut),!0},Vu=function(jt,Ut){var Xt={streamId:Ut.streamId,isRemote:Ut.isRemote};if(Ut.isRemote)if(Ut.isVideoOnly){Xt.action="hangup";var kt=Mo.get(jt).get(Ut.streamId);kt&&(Xt.callId=kt.callId),$n.debug("disableVideoTrack - hangup",Ut.streamId),jt.unsubscribeToStream(Ut.streamId,{noTriggerAdaptation:!0})}else{Xt.action="disableTrack",Xt.trackType="video";var Ft=Mo.get(jt).get(Ut.streamId);Ft&&(Xt.callId=Ft.callId),$n.debug("disableVideoTrack - disable video track",Ut.streamId),jt.updateSubscribedStream(Ut.streamId,{audioOnly:!0}).catch(function(dt){$n.error("disableVideoTrack - updateSubscribedStream",dt)}),Ut.isVideoMuted=!0}else if(Ut.isVideoOnly){Xt.action="hangup";var sn=yo.get(Ut.streamId),ln=jt.getConversationCall(sn);ln&&(Xt.callId=ln.callId),$n.debug("disableVideoTrack - hangup",Ut.streamId),jt.unpublish(sn,{noTriggerAdaptation:!0})}else{var Yt=jt.getConversationCall(yo.get(Ut.streamId));Yt?(Xt.action="disableTrack",Xt.trackType="video",Xt.callId=Yt.callId,$n.debug("disableVideoTrack - disable video track",Ut.streamId),Yt.updatePublishedStream("video",!1).catch(function(dt){$n.error("disableVideoTrack - updatePublishedStream",dt)}),Ut.isVideoMuted=!0):Xt=null}Xt&&tn.get(jt).emit("adaptationTriggered",Xt)},zu=function(jt,Ut){var Xt={streamId:Ut.streamId,isRemote:Ut.isRemote,action:"enableTrack",trackType:"video"};if(Ut.isRemote){var kt=Mo.get(jt).get(Ut.streamId);kt&&(Xt.callId=kt.callId),$n.debug("enableVideoTrack - enable video track",Ut.streamId),jt.updateSubscribedStream(Ut.streamId,{audioOnly:!1}).catch(function(sn){$n.error("enableVideoTrack - updateSubscribedStream",sn)}),Ut.isVideoMuted=!1}else{var Ft=jt.getConversationCall(yo.get(Ut.streamId));Ft?(Xt.callId=Ft.callId,$n.debug("enableVideoTrack - enable video track",Ut.streamId),Ft.updatePublishedStream("video",!0).catch(function(sn){$n.error("enableVideoTrack - updatePublishedStream",sn)}),Ut.isVideoMuted=!1):Xt=null}Xt&&tn.get(jt).emit("adaptationTriggered",Xt)},Ql=function(jt,Ut,Xt){return Xt===!0?jt.pointerSharingState===et.g.STATE_IDLE?(jt.pointerSharingState=et.g.STATE_JOINING,new Promise(function(kt,Ft){Jn.pointerSharingClient.joinRoom(jt._getTechnicalName(),{success:function(sn){jt.pointerSharingState=et.g.STATE_ACTIVE,Ut===!0&&(jt.pointerSharingAutoInvite=!0);var ln={enabled:!0,roomId:sn};tn.get(jt).emit("pointerSharingEnabled",ln),kt(),jt.pointerSharingAutoInvite===!0&&ro.getContacts(jt._getTechnicalName()).forEach(function(Yt){Jn.pointerSharingClient.inviteInRoom(jt._getTechnicalName(),Yt.getId())})},failure:function(sn,ln){jt.pointerSharingState=et.g.STATE_IDLE,jt.pointerSharingAutoInvite=!1,Ft(sn)}})})):Promise.reject(Bt.g.createError(et.g.ERROR_WRONG_STATE,"enablePointerSharing() - cannot enable pointer sharing")):Xt===!1?jt.pointerSharingState===et.g.STATE_ACTIVE?(jt.pointerSharingState=et.g.STATE_LEAVING,new Promise(function(kt,Ft){Jn.pointerSharingClient.leaveRoom(jt._getTechnicalName()),jt.pointerSharingState=et.g.STATE_IDLE,jt.pointerSharingAutoInvite=!1;var sn={enabled:!1,roomId:jt._getTechnicalName()};tn.get(jt).emit("pointerSharingEnabled",sn),kt()})):Promise.reject(Bt.g.createError(et.g.ERROR_WRONG_STATE,"enablePointerSharing() - cannot disable pointer sharing")):Promise.reject(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"enablePointerSharing() - cannot enable/disable pointer sharing"))},js=function(jt,Ut){var Xt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return["roomName","callId","clientId"].forEach(function(kt){Ut.hasOwnProperty(kt)&&(Xt[kt]=String(Ut[kt]))}),Xt};function Zl(jt){return Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},Zl(jt)}function _h(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function Hu(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function _c(){return _c=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(jt,Ut,Xt){var kt=_f(jt,Ut);if(kt){var Ft=Object.getOwnPropertyDescriptor(kt,Ut);return Ft.get?Ft.get.call(arguments.length<3?jt:Xt):Ft.value}},_c.apply(this,arguments)}function _f(jt,Ut){for(;!Object.prototype.hasOwnProperty.call(jt,Ut)&&(jt=Ko(jt))!==null;);return jt}function _d(jt,Ut){return _d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},_d(jt,Ut)}function em(jt,Ut){if(Ut&&(Zl(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}(jt)}function Ko(jt){return Ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Ko(jt)}var ba=mt.Y.get("Conference"),tm=jo.getAvailableEvents().concat(["closed"]),Fs=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&_d(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Ko(Ft);if(sn){var Dt=Ko(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return em(this,dt)});function Yt(dt){var vt,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _h(this,Yt),vt=ln.call(this,dt,Dt),ba.info("Create conference"),vt.conference=!0,vt.friendlyName=Dt.hasOwnProperty("friendlyName")?Dt.friendlyName:dt,vt}return Ut=Yt,kt=[{key:"getAvailableEvents",value:function(){return tm}}],(Xt=[{key:"destroy",value:function(){po.get().deleteConference(this.getName()),_c(Ko(Yt.prototype),"destroy",this).call(this)}},{key:"_getTechnicalName",value:function(){return nm()+ts.get(this)}},{key:"getFriendlyName",value:function(){return this.friendlyName}},{key:"getInfo",value:function(){var dt=this;return new Promise(function(vt,Dt){var Vt={},Gt=wo.get(dt);Gt&&(Vt.token=Gt.getToken()),Eo.getWebconf(dt._getTechnicalName(),Vt).then(function(Qt){return vt({dtmfCode:Qt.dtmfCode,endTime:Qt.end,hasPassword:Qt.hasPassword,sipNumber:Qt.sipNumber,startTime:Qt.start,state:Qt.state,type:Qt.type})}).catch(function(Qt){return Dt(Bt.g.createError(et.g.ERROR_OTHER,"getInfo() - Cannot get conference info",ba))})})}},{key:"close",value:function(){var dt=this;return ba.debug("Closing "+this.getName()),new Promise(function(vt,Dt){dt.status!==et.g.CONVERSATION_STATUS_JOINED?Dt(Bt.g.createError(et.g.ERROR_OTHER,"close() - Conversation has to be joined to be closed",ba)):dt.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR?Dt(Bt.g.createError(et.g.ERROR_UNAUTHORIZED,"close() - Role has to be moderator to close the conversation",ba)):Eo.closeConferenceInstance(dt,wo.get(dt)).then(function(){ba.debug("Conversation closed successfully"),Jn.dataClient.sendDataToGroup(dt._getTechnicalName(),{event:et.g.CONVERSATION_CLOSED_IDENTIFIER,instanceId:dt.getInstanceId(),roomname:dt._getTechnicalName()}),tn.get(dt).emit("closed"),dt.leave(),vt()}).catch(function(Vt){var Gt="close() - An error occured when closing conversation",Qt={error:new Error(Gt),code:et.g.ERROR_OTHER};ba.error(Gt,Vt),Vt.hasOwnProperty("code")?Qt.code=Vt.code:Vt.hasOwnProperty("http_code")&&(Qt.code=Vt.http_code.toString().startsWith("4")?et.g.ERROR_UNAUTHORIZED:et.g.ERROR_SERVER_UNAVAILABLE),Dt(Qt)})})}},{key:"sendInvitation",value:function(dt,vt){var Dt=this;if(vt||(vt={}),dt instanceof No){ba.info("Invite "+dt.getId()+" to "+this._getTechnicalName()),dt.isOnline()||ba.warn("sendInvitation() - contact "+dt.getUsername()+" does not seem to be connected.");var Vt={receiveNotifier:new pt};vt.hasOwnProperty("expirationTime")&&(Vt.expirationTime=vt.expirationTime);var Gt=new Do(dt,this,Vt),Qt={event:et.g.CONVERSATION_INVITATION_IDENTIFIER,invitationId:Gt.id,roomname:this._getTechnicalName(),friendlyName:this.getFriendlyName(),sendTime:Gt.sendTime};return Gt.type="conference",Ls.get(this)!==null&&(Qt.password=Ls.get(this)),Jn.sendData(dt.getId(),Qt).then(function(){Vt.receiveNotifier.emit("receive")}).catch(function(Zt){var an=Bt.g.createError(Zt,"Invitation not delivered",ba);tn.get(Dt).emit("messageNotDelivered",{error:an,contact:dt,event:et.g.CONVERSATION_INVITATION_IDENTIFIER})}),Gt}return ba.error("Parameter is not a contact"),null}},{key:"getTags",value:function(){var dt=this;return new Promise(function(vt,Dt){var Vt=Br.getActiveSession();if(!Vt)return Dt(Bt.g.createError(et.g.ERROR_NOT_ALLOWED,"getTags() - no session found",ba));var Gt=Vt.getUserAgent().getEnterprise();if(!Gt)return Dt(Bt.g.createError(et.g.ERROR_NOT_ALLOWED,"getTags() - no enterprise found",ba));Gt.getTags(dt).then(function(Qt){for(var Zt=[],an=0;an<Qt.length;an+=1)Qt[an].selected===!0&&Zt.push(Qt[an]);return vt(Zt)}).catch(function(Qt){return Dt(Bt.g.createError(et.g.ERROR_NOT_ALLOWED,"getTags() - cannot get tags",ba,{fromError:Qt}))})})}},{key:"setTags",value:function(dt){var vt=this;return new Promise(function(Dt,Vt){if(!Array.isArray(dt))return Vt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"setTags() - wrong tags",ba));if(!vt.webconfId)return Vt(Bt.g.createError(et.g.ERROR_NOT_ALLOWED,"setTags() - no webconf found",ba));var Gt=Br.getActiveSession();if(!Gt)return Vt(Bt.g.createError(et.g.ERROR_NOT_ALLOWED,"setTags() - no session found",ba));var Qt=Gt.getUserAgent().getEnterprise();if(!Qt)return Vt(Bt.g.createError(et.g.ERROR_NOT_ALLOWED,"setTags() - no enterprise found",ba));var Zt=Gt.getToken();if(!Zt)return Vt(Bt.g.createError(et.g.ERROR_NOT_ALLOWED,"setTags() - no token found",ba));for(var an=[],Cn=0;Cn<dt.length;Cn+=1){if(!dt[Cn].hasOwnProperty("id"))return Vt(Bt.g.createError(et.g.ERROR_BAD_PARAMETER,"setTags() - wrong tags",ba));an.push(dt[Cn].id)}Eo.updateWebconfTags(Qt.getId(),vt.webconfId,an,Zt).then(function(){return Dt()}).catch(function(Rn){return Vt(Bt.g.createError(et.g.ERROR_OTHER,"setTags() - cannot set tags",ba,{fromError:Rn}))})})}}])&&Hu(Ut.prototype,Xt),kt&&Hu(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(jo),nm=function(){return Jn.getActiveApiKey()+":"};function Gu(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}mt.Y.get("ConversationCatalog");var rs=null,po=function(){function jt(){if(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")}(this,jt),rs!==null)throw"Cannot construct singleton ConversationCatalog";this.conversationList=new Map,this.conferenceList=new Map,rs=this}var Ut,Xt,kt;return Ut=jt,Xt=[{key:"deleteConversation",value:function(Ft){return!!(Bt.g.isTypeof(Ft,"string")&&Ft.length>0)&&this.conversationList.delete(Ft)}},{key:"deleteConference",value:function(Ft){return!!(Bt.g.isTypeof(Ft,"string")&&Ft.length>0)&&this.conferenceList.delete(Ft)}},{key:"getOrCreateConversation",value:function(Ft){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ln=null;return Ft!=null&&Ft!==""?this.conversationList.has(Ft.toString())?ln=this.conversationList.get(Ft.toString()):(ln=new jo(Ft.toString(),sn),this.conversationList.set(Ft.toString(),ln)):(ln=new jo(null,sn),this.conversationList.set(ln.getName(),ln)),ln}},{key:"getOrCreateConference",value:function(Ft){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ln=null;return Ft!=null&&Ft!==""?this.conferenceList.has(Ft.toString())?ln=this.conferenceList.get(Ft.toString()):(ln=new Fs(Ft.toString(),sn),this.conferenceList.set(Ft.toString(),ln)):(ln=new Fs(null,sn),this.conferenceList.set(ln.getName(),ln)),ln}},{key:"getConversations",value:function(){return this.conversationList}},{key:"getConferences",value:function(){return this.conferenceList}},{key:"isConference",value:function(Ft){return qu(Ft).hasOwnProperty("apiKey")}},{key:"getNameFromTechnicalName",value:function(Ft){return qu(Ft).name}}],kt=[{key:"get",value:function(){return rs===null&&(rs=new jt),rs}}],Xt&&Gu(Ut.prototype,Xt),kt&&Gu(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}();function qu(jt){var Ut=jt.match(/^([^:]+)[:]([^:]+)$/);return Ut===null||Ut.length<3?{name:jt}:{apiKey:Ut[1],name:Ut[2]}}function eu(jt){return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},eu(jt)}function Jo(jt,Ut){var Xt=typeof Symbol<"u"&&jt[Symbol.iterator]||jt["@@iterator"];if(!Xt){if(Array.isArray(jt)||(Xt=function(dt,vt){if(dt){if(typeof dt=="string")return Ku(dt,vt);var Dt=Object.prototype.toString.call(dt).slice(8,-1);return Dt==="Object"&&dt.constructor&&(Dt=dt.constructor.name),Dt==="Map"||Dt==="Set"?Array.from(dt):Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt)?Ku(dt,vt):void 0}}(jt))||Ut&&jt&&typeof jt.length=="number"){Xt&&(jt=Xt);var kt=0,Ft=function(){};return{s:Ft,n:function(){return kt>=jt.length?{done:!0}:{done:!1,value:jt[kt++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Yt=!1;return{s:function(){Xt=Xt.call(jt)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Yt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Yt)throw sn}}}}function Ku(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function Ju(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function tu(jt,Ut){return tu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},tu(jt,Ut)}function rm(jt,Ut){if(Ut&&(eu(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dr(jt)}function Dr(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function Ws(jt){return Ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Ws(jt)}var cr=mt.Y.get("Session"),zr=An.get(),Bs=new(Go()),ao=Ar.get(),im=["rawData","whiteboardInvitation","fileTransferInvitation","conversationMessage","conversationData","dataChannelInvitation","contactMessage","contactData","customEvent","conversationInvitation","incomingCall","disconnect","error","contactListUpdate","reconnecting","reconnection","conversationJoinRequest","newMediaAvailableFromContact","whiteboardRoomMemberUpdate","incomingScreenSharingCall","pointerSharingInvitation","pointerLocationChanged","incomingScreenSharingCallInvitation","cloudEventOccurred","remoteAccessInvitation"],Yu=new WeakMap,is=new WeakMap,Vs=null,nu=new WeakMap,as=new WeakMap,Br=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&tu(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Ws(Ft);if(sn){var Dt=Ws(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return rm(this,dt)});function Yt(dt){var vt;(function(Qt,Zt){if(!(Qt instanceof Zt))throw new TypeError("Cannot call a class as a function")})(this,Yt),vt=ln.call(this,cr),cr.debug("Create Session"),vt.id=null,vt.token=null,vt.ccsToken=null,Yu.set(Dr(vt),dt),is.set(Dr(vt),null),as.set(Dr(vt),{}),vt.isRecording=!1,vt.userData=new Io,vt.contactListUpdateListenerSetted=!1,vt.waitingContactListUpdateEvent=[];var Dt=Ro.get(),Vt=po.get(),Gt={};return vt.invitationsMap=new Map,Gt.channelEvent=function(Qt){switch(Qt.detail.channelEvent){case"onChannelReconnecting":tn.get(Dr(vt)).emit("reconnecting",Qt);break;case"onChannelReconnect":tn.get(Dr(vt)).emit("reconnection",Qt);break;case"onChannelError":tn.get(Dr(vt)).emit("error",Qt);break;case"onChannelDisconnect":cr.error("Session :: onChannelDisconnect"),tn.get(Dr(vt)).emit("disconnect",Qt)}},Gt.incomingCall=function(Qt){var Zt=Dt.getOrCreateContact(Qt.detail.callerId),an=Qt.detail.callId.toString();if(Qt.detail.callType==="data")if(cr.info("Received file transfer invitation from "+Zt.getUsername()),Bt.g._private.dataCallsFileInfo.has(an)){var Cn=Bt.g._private.dataCallsFileInfo.get(an),Rn=null;vt.invitationsMap.has(Qt.detail.callerId+"-sendfile-"+an)?(Rn=vt.invitationsMap.get(Qt.detail.callerId+"-sendfile-"+an),cr.debug("invitation already exist :",Rn)):(Rn=new eo(Zt,an,Cn),vt.invitationsMap.set(Qt.detail.callerId+"-sendfile-"+an,Rn)),tn.get(Dr(vt)).emit("fileTransferInvitation",Rn)}else Bt.g._private.dataChannelInvitations.has(an)?tn.get(Dr(vt)).emit("dataChannelInvitation",new zo(Zt,an)):(cr.debug("File information has not been received yet, putting invitation on hold"),Bt.g._private.dataCallsOnHold.set(an));else if(Qt.detail.callType==="screenSharing"||Qt.detail.callType==="screenSharingWithAudio")if(apiRTC.session.apiCCWebRTCClient.webRTCClient.userAcceptOnIncomingScreenSharingCall===!0){cr.debug("Received screenSharingCallInvitation from "+Zt.getUsername());var Kn=new Er(Zt,an,Qt.detail.callType,{isRecorded:!!Qt.detail.hasOwnProperty("recordedCall")&&Qt.detail.recordedCall});tn.get(Dr(vt)).emit("incomingScreenSharingCallInvitation",Kn)}else{cr.debug("Received screenSharingCall from "+Zt.getUsername());var Xn=ao.getOrCreateCall(an,Zt,{started:!0,isRecorded:!!Qt.detail.hasOwnProperty("recordedCall")&&Qt.detail.recordedCall});tn.get(Dr(vt)).emit("incomingScreenSharingCall",Xn)}else{cr.info("Received call invitation from "+Zt.getUsername());var dr=new Er(Zt,an,Qt.detail.callType,{isRecorded:!!Qt.detail.hasOwnProperty("recordedCall")&&Qt.detail.recordedCall});tn.get(Dr(vt)).emit("incomingCall",dr)}},Gt.roomInvitation=function(Qt){var Zt=Dt.getOrCreateContact(Qt.detail.senderId);if(Qt.detail.roomType==="whiteBoard"){if(Zt!==null){cr.info("Received whiteboard invitation from "+Zt.getUsername());var an={};Qt.detail.cloudConvId&&(an.cloudConvId=Qt.detail.cloudConvId),Qt.detail.webconf===!0&&(an.webconf=!0),tn.get(Dr(vt)).emit("whiteboardInvitation",new vs(Zt,Qt.detail.roomId,an))}}else Qt.detail.roomType==="pointerSharing"&&(Zt===null||Vt.getConversations().has(Qt.detail.roomId)||Vt.getConferences().has(Qt.detail.roomId)||(cr.info("Received pointer sharing invitation from "+Zt.getUsername()),tn.get(Dr(vt)).emit("pointerSharingInvitation",new xl(Zt,Qt.detail.roomId,Dr(vt)))))},Gt.roomMemberUpdate=function(Qt){var Zt,an=[],Cn=Jo(Qt.detail.contactList);try{for(Cn.s();!(Zt=Cn.n()).done;){var Rn=Zt.value;an.push(Dt.getOrCreateContact(Rn.contactId))}}catch(Kn){Cn.e(Kn)}finally{Cn.f()}Qt.detail.roomType==="whiteBoard"&&(cr.info("Received whiteboard room member update"),tn.get(Dr(vt)).emit("whiteboardRoomMemberUpdate",{contacts:an,roomId:Qt.detail.roomId,status:Qt.detail.status}))},Gt.receiveRoomMessage=function(Qt){if(cr.debug("receiveRoomMessage",Qt),Qt.detail.roomType==="pointerSharing"&&Qt.detail.message.type==="pointerLocation"&&as.get(Dr(vt)).hasOwnProperty(Qt.detail.roomId)){var Zt={sender:Dt.getOrCreateContact(Qt.detail.senderId),source:Qt.detail.message.source,x:Qt.detail.message.x,y:Qt.detail.message.y};Bt.g.isPropertyTypeof(Qt.detail.message,"data","object")&&(Zt.data=Qt.detail.message.data),tn.get(Dr(vt)).emit("pointerLocationChanged",Zt)}},Gt.receiveIMMessage=function(Qt){var Zt=Dt.getOrCreateContact(Qt.detail.senderId);cr.debug("Received IM from "+Zt.getUsername()+" : ",Qt.detail.message),tn.get(Dr(vt)).emit("contactMessage",{sender:Zt,content:Qt.detail.message,uuid:Qt.detail.UUCSeq,time:Qt.detail.time})},Gt.receiveData=function(Qt){var Zt=Dt.getOrCreateContact(Qt.detail.senderId),an=Qt.detail.data;if(an!==void 0){var Cn=null;if(an.roomname!==void 0&&(Cn=Vt.isConference(an.roomname)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(an.roomname)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(an.roomname))),cr.trace("Received data from "+Zt.getId(),Qt.detail),tn.get(Dr(vt)).emit("rawData",{sender:Zt,content:an}),an.event!==void 0)switch(an.event){case et.g.INVITATION_ANSWER_IDENTIFIER:case et.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER:break;case et.g.CONTACT_SEND_DATA_IDENTIFIER:cr.debug("Received contact data from "+Zt.getUsername(),an.content),tn.get(Dr(vt)).emit("contactData",{sender:Zt,content:an.content});break;case et.g.CONVERSATION_SEND_DATA_IDENTIFIER:an.roomname!==void 0&&(cr.debug("Received conversation data from "+Zt.getUsername(),an.content),tn.get(Dr(vt)).emit("conversationData",{sender:Zt,conversation:Cn,content:an.content}));break;case et.g.CONTACT_NEW_MEDIA_IDENTIFIER:tn.get(Dr(vt)).emit("newMediaAvailableFromContact",{sender:Zt,media:an.media});break;case et.g.CONTACT_DATACHANNEL_INVITATION:cr.debug("Received datachannel invitation from "+Zt.getUsername()),Bt.g._private.dataChannelInvitations.set(an.callId.toString(),!0),Bt.g._private.dataCallsOnHold.has(an.callId.toString())&&tn.get(Dr(vt)).emit("dataChannelInvitation",new zo(Zt,an.callId.toString()));break;case et.g.CONTACT_SEND_FILEINFO_IDENTIFIER:cr.debug("Received file info from "+Zt.getUsername(),an.fileInfo);var Rn=an.callId.toString();if(Bt.g._private.dataCallsFileInfo.set(Rn,an.fileInfo),Bt.g._private.dataCallsOnHold.has(Rn)){var Kn=null;vt.invitationsMap.has(Zt.getId()+"-sendfile-"+Rn)?(Kn=vt.invitationsMap.get(Zt.getId()+"-sendfile-"+Rn),cr.debug("invitation already exist :",Kn)):(Kn=new eo(Zt,Rn,an.fileInfo),vt.invitationsMap.set(Qt.detail.callerId+"-sendfile-"+Rn,Kn)),tn.get(Dr(vt)).emit("fileTransferInvitation",Kn)}else cr.debug("no dataCallsOnHold");break;case et.g.CONVERSATION_INVITATION_IDENTIFIER:if(an.roomname!==void 0){cr.info("Received conversation invitation from "+Zt.getUsername());var Xn={session:Dr(vt)};an.hasOwnProperty("password")&&(Xn.password=an.password),Cn?(an.hasOwnProperty("friendlyName")&&Cn.name===Cn.friendlyName&&(Cn.friendlyName=an.friendlyName),tn.get(Dr(vt)).emit("conversationInvitation",new $t(Zt,an,Cn,Xn))):tn.get(Dr(vt)).emit("conversationInvitation",new $t(Zt,an,null,Xn))}break;case et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER:cr.info("Received conversation join request from "+Zt.getUsername()),Cn?tn.get(Dr(vt)).emit("conversationJoinRequest",new Ho(Zt,Cn,an.invitationId)):tn.get(Dr(vt)).emit("conversationJoinRequest",new Ho(Zt,null,null));break;case et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER:case et.g.CONVERSATION_CLOSED_IDENTIFIER:break;case et.g.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER:if(cr.debug("Received remote access invitation"),apiRTC.session.remoteAccessInvitation===null){var dr=new Op(Zt,an,Cn,{});apiRTC.session.remoteAccessInvitation=dr,tn.get(Dr(vt)).emit("remoteAccessInvitation",dr)}else cr.error("remoteAccess session is already ongoing");break;case et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER:case et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER:case et.g.CONTACT_REMOTEACCESS_APP_MESSAGE:case et.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE:break;default:var hr={event:an.event,content:an,sender:Zt};Cn!==null&&(hr.conversation=Cn),tn.get(Dr(vt)).emit("customEvent",hr)}else if(an.command!==void 0)switch(an.command){case"userWaiting":case"userWaiting-new":cr.info("Received conversation join request from "+Zt.getUsername()),Cn?tn.get(Dr(vt)).emit("conversationJoinRequest",new Ho(Zt,Cn,null)):tn.get(Dr(vt)).emit("conversationJoinRequest",new Ho(Zt,null,null))}}else cr.debug("Received data undefined, leaving process")},Gt.receiveGroupChatMessage=function(Qt){var Zt=Dt.getOrCreateContact(Qt.detail.senderId),an=null,Cn=Qt.detail.groupChatId.toString();if(Cn!==void 0&&(an=Vt.isConference(Cn)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(Cn)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(Cn))),an!==null){cr.debug("Received conversation message from "+Zt.getUsername(),Qt.detail.message);var Rn={sender:Zt,conversation:an,content:Qt.detail.message};Bt.g.isTypeof(Qt.detail,"metadata","object")&&(Rn.metadata=Qt.detail.metadata),tn.get(Dr(vt)).emit("conversationMessage",Rn)}},Gt.cloudEventOccurred=function(Qt){var Zt={topic:Qt.detail.topic,target:Qt.detail.target};tn.get(Dr(vt)).emit("cloudEventOccurred",Zt)},Gt.callEstablished=function(Qt){if(Qt.detail.callId!==void 0){var Zt=Qt.detail.callId.toString();cr.debug("callEstablished",Qt.detail,Zt);var an=ao.getCall(Zt,null,{});an!==null&&an.manageCallEstablishedEvent(Qt)}else cr.debug("callEstablished",Qt.detail)},Gt.remoteStreamAdded=function(Qt){if(Qt.detail.callId!==void 0){var Zt=Qt.detail.callId.toString();cr.debug("remoteStreamAdded",Qt.detail,Zt);var an=ao.getCall(Zt,null,{});an!==null&&an.manageRemoteStreamAddedEvent(Qt)}else cr.debug("remoteStreamAdded",Qt.detail)},Gt.remoteStreamRemoved=function(Qt){if(Qt.detail.callId!==void 0){var Zt=Qt.detail.callId.toString();cr.debug("remoteStreamRemoved",Qt.detail,Zt);var an=ao.getCall(Zt,null,{});an!==null&&an.manageRemoteStreamRemovedEvent(Qt)}else cr.debug("remoteStreamRemoved",Qt.detail)},Gt.userMediaSuccess=function(Qt){var Zt=null;if(Qt.detail.callId!==void 0&&Qt.detail.callId!==null){Zt=Qt.detail.callId.toString(),cr.debug("userMediaSuccess",Qt.detail,Zt);var an=ao.getCall(Zt,null,{});an!==null&&an.manageUserMediaSuccessEvent(Qt)}else cr.debug("userMediaSuccess",Qt.detail)},Gt.onCallStatsUpdate=function(Qt){if(Qt.detail.callId!==void 0){var Zt=Qt.detail.callId.toString(),an=ao.getCall(Zt,null,{});an!==null&&an.manageCallStatsUpdateEvent(Qt)}else cr.debug("onCallStatsUpdate",Qt.detail)},Gt.error=function(Qt){if(cr.debug("error",Qt.detail),Qt.detail.roomName!==null&&Qt.detail.roomName!==void 0){cr.debug("error on conversation :",Qt.detail,Qt.detail.roomName,Qt.detail.callId);var Zt=null;Qt.detail.roomName!==void 0&&(Zt=Vt.isConference(Qt.detail.roomName)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(Qt.detail.roomName)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(Qt.detail.roomName)))!==null&&Zt.manageErrorEvent(Qt)}else if(Qt.detail.callId!==void 0){var an=Qt.detail.callId.toString();cr.debug("error",Qt.detail,an);var Cn=ao.getCall(an,null,{});Cn!==null&&(Cn.manageErrorEvent(Qt),Qt.detail.errorCode==="RECORDING_FAILED"&&ao.removeCallFromList(Cn.getId()))}else cr.debug("error",Qt.detail),tn.get(Dr(vt)).emit("error",Qt.detail)},Gt.disconnectionWarning=function(Qt){if(Qt.detail.roomName!==null){cr.debug("disconnectionWarning on conversation :",Qt.detail,Qt.detail.roomName,Qt.detail.callId);var Zt=null;Qt.detail.roomName!==void 0&&(Zt=Vt.isConference(Qt.detail.roomName)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(Qt.detail.roomName)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(Qt.detail.roomName)))!==null&&Zt.manageDisconnectionWarningEvent(Qt)}else if(Qt.detail.callId){var an=Qt.detail.callId.toString();cr.debug("disconnectionWarning",Qt.detail,an);var Cn=ao.getCall(an,null,{});Cn!==null&&Cn.manageDisconnectionWarningEvent(Qt)}else cr.debug("disconnectionWarning",Qt.detail)},Gt.hangup=function(Qt){if(Qt.detail.callId){var Zt=Qt.detail.callId.toString();cr.debug("hangup",Qt.detail,Zt);var an=ao.getCall(Zt,null,{});an!==null&&(an.manageHangupEvent(Qt),an.isRecorded()===!1&&ao.removeCallFromList(an.getId()))}else cr.debug("hangup",Qt.detail)},Gt.recordedStreamsAvailable=function(Qt){if(Qt.detail.userId2){var Zt=Dt.getOrCreateContact(Qt.detail.userId2),an=ao.getCall(null,Zt);an&&(an.manageRecordAvailableEvent(Qt),ao.removeCallFromList(an.getId()))}else cr.debug("recordedStreamsAvailable",Qt.detail)},Gt.desktopCapture=function(Qt){if(Qt.detail.callId){var Zt=Qt.detail.callId.toString();cr.warn("desktopCapture",Qt.detail,Zt);var an=ao.getCall(Zt,null,{});an!==null&&(an.manageDesktopCaptureEvent(Qt),ao.removeCallFromList(an.getId()))}else cr.debug("desktopCapture",Qt.detail)},Gt.userMediaError=function(Qt){if(Qt.detail.callId){var Zt=Qt.detail.callId.toString();cr.warn("userMediaError",Qt.detail,Zt);var an=ao.getCall(Zt,null,{});an!==null&&(an.manageUserMediaErrorEvent(Qt),Qt.detail.tryAudioCallActivated===!1&&ao.removeCallFromList(an.getId()))}else cr.debug("userMediaError",Qt.detail)},cr.debug("av apiRTCManager onEvent ..."),zr.onEvent("disconnectionWarning",Gt.disconnectionWarning).onEvent("incomingCall",Gt.incomingCall).onEvent("roomInvitation",Gt.roomInvitation).onEvent("roomMemberUpdate",Gt.roomMemberUpdate).onEvent("receiveRoomMessage",Gt.receiveRoomMessage).onEvent("receiveIMMessage",Gt.receiveIMMessage).onEvent("receiveData",Gt.receiveData).onEvent("receiveGroupChatMessage",Gt.receiveGroupChatMessage).onEvent("cloudEventOccurred",Gt.cloudEventOccurred).onEvent("callEstablished",Gt.callEstablished).onEvent("remoteStreamAdded",Gt.remoteStreamAdded).onEvent("remoteStreamRemoved",Gt.remoteStreamRemoved).onEvent("userMediaSuccess",Gt.userMediaSuccess).onEvent("onCallStatsUpdate",Gt.onCallStatsUpdate).onEvent("error",Gt.error).onEvent("hangup",Gt.hangup).onEvent("recordedStreamsAvailable",Gt.recordedStreamsAvailable).onEvent("desktopCapture",Gt.desktopCapture).onEvent("userMediaError",Gt.userMediaError),apiRTC.addEventListener("channelEvent",Gt.channelEvent),Dt.onUpdate(function(Qt){vt.contactListUpdateListenerSetted===!1&&(cr.debug("No listener for contactListUpdate, storing event ..."),vt.waitingContactListUpdateEvent.push(Qt)),tn.get(Dr(vt)).emit("contactListUpdate",Qt)}),nu.set(Dr(vt),Gt),vt}return Ut=Yt,Xt=[{key:"getToken",value:function(){return this.token}},{key:"getApzToken",value:function(){var dt=null;return apiRTC.session!==void 0&&apiRTC.session!==null&&(dt=apiRTC.session.JWTApzToken),dt}},{key:"getId",value:function(){return this.id}},{key:"getUserAgent",value:function(){return Yu.get(this)}},{key:"getContact",value:function(dt){return cr.warn("getContact() - Method deprecated, use Session.getOrCreateContact() instead"),Ro.get().getOrCreateContact(dt)}},{key:"getOrCreateContact",value:function(dt){return Ro.get().getOrCreateContact(dt)}},{key:"createConversation",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cr.warn("createConversation() - Method deprecated, use Session.getConversation() instead"),this.getConversation(dt,vt)}},{key:"getConversation",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cr.trace("Getting conversation "+dt,vt),po.get().getOrCreateConversation(dt)}},{key:"getConference",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cr.trace("Getting conference "+dt,vt),po.get().getOrCreateConference(dt)}},{key:"getOrCreateConversation",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Dt=po.get().getNameFromTechnicalName(dt);return po.get().isConference(dt)?po.get().getOrCreateConference(Dt,vt):po.get().getOrCreateConversation(Dt,vt)}},{key:"getOrCreateConference",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.getOrCreateConversation(dt,vt)}},{key:"getActiveConversations",value:function(){var dt,vt={},Dt=po.get().getConversations(),Vt=Jo(Dt.keys());try{for(Vt.s();!(dt=Vt.n()).done;){var Gt=dt.value,Qt=Dt.get(Gt);Qt.isJoined()&&(vt[Gt]=Qt)}}catch(Zt){Vt.e(Zt)}finally{Vt.f()}return vt}},{key:"getActiveConferences",value:function(){var dt,vt={},Dt=po.get().getConferences(),Vt=Jo(Dt.keys());try{for(Vt.s();!(dt=Vt.n()).done;){var Gt=dt.value,Qt=Dt.get(Gt);Qt.isJoined()&&(vt[Gt]=Qt)}}catch(Zt){Vt.e(Zt)}finally{Vt.f()}return vt}},{key:"getWhiteboardClient",value:function(){return cr.trace("getWhiteboardClient()"),zr.whiteBoardClient}},{key:"setUserData",value:function(dt){this.userData.setProps(dt).setToSession()}},{key:"setUsername",value:function(dt){this.userData.setProp("username",dt).setToSession()}},{key:"setPhotoUrl",value:function(dt){this.userData.setProp("photo_url",dt).setToSession()}},{key:"getUserData",value:function(){return this.userData}},{key:"getUsername",value:function(){return this.userData.get("username")!==null?this.userData.get("username"):this.userData.get("nickname")!==null?this.userData.get("nickname"):this.id.toString()}},{key:"getPhotoUrl",value:function(){return this.userData.get("photo_url")!==null?this.userData.get("photo_url"):this.userData.get("photoUrl")!==null?this.userData.get("photoUrl"):null}},{key:"subscribeToGroup",value:function(dt){if(this.getSubscribedPresenceGroup().includes(dt)){cr.debug("Already subscribed to this group");var vt=apiCC.session.subscribeToPresenceGroupAddedByApiRTC.indexOf(dt);vt!==-1&&apiCC.session.subscribeToPresenceGroupAddedByApiRTC.splice(vt,1)}else zr.apiRTCSession.subscribePresenceGroup([dt])}},{key:"unsubscribeToGroup",value:function(dt){this.getSubscribedPresenceGroup().includes(dt)?zr.unsubscribeToPresenceGroup(dt):cr.debug("Not subscribed to this group")}},{key:"joinGroup",value:function(dt){if(this.getPresenceGroup().includes(dt)){cr.debug("Already joined this group");var vt=apiCC.session.presenceGroupAddedByApiRTC.indexOf(dt);vt!==-1&&apiCC.session.presenceGroupAddedByApiRTC.splice(vt,1)}else zr.joinAndSubscribeToPresenceGroup(dt)}},{key:"leaveGroup",value:function(dt){this.getPresenceGroup().includes(dt)?zr.leaveAndUnsubscribeToPresenceGroup(dt):cr.debug("Group was not joined")}},{key:"subscribeToCloudEvent",value:function(dt,vt){zr.subscribeToCloudEvent(dt,vt)}},{key:"unsubscribeToCloudEvent",value:function(dt,vt){zr.unsubscribeToCloudEvent(dt,vt)}},{key:"joinConversationSpace",value:function(dt){zr.apiRTCSession.joinConversationSpace(dt)}},{key:"leaveConversationSpace",value:function(dt){zr.apiRTCSession.leaveConversationSpace(dt)}},{key:"getContacts",value:function(dt){cr.trace("getContacts()");var vt,Dt={},Vt=Ro.get().getContacts(dt),Gt=Jo(Vt.keys());try{for(Gt.s();!(vt=Gt.n()).done;){var Qt=vt.value;Dt[Qt]=Vt.get(Qt)}}catch(Zt){Gt.e(Zt)}finally{Gt.f()}return Dt}},{key:"getContactsArray",value:function(dt){cr.log("getContactsArray");var vt=Ro.get().getContacts(dt);return Array.from(vt.values())}},{key:"getOnlineContactsArray",value:function(dt){cr.log("getOnlineContactsArray");var vt=Ro.get().getOnlineContacts(dt);return Array.from(vt.values())}},{key:"getCall",value:function(dt){return cr.trace("getCall()"),Ar.get().getCall(dt)}},{key:"getCalls",value:function(){cr.trace("getCalls()");var dt,vt={},Dt=Ar.get().getCalls(),Vt=Jo(Dt.keys());try{for(Vt.s();!(dt=Vt.n()).done;){var Gt=dt.value;vt[Gt]=Dt.get(Gt)}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}return vt}},{key:"disconnect",value:function(){var dt=this,vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{invalidateUserToken:!0};return new Promise(function(Dt,Vt){if(cr.info("disconnect()"),dt.token===null&&dt.id===null)cr.error("disconnect() - Session is already disconnected"),Vt("disconnect() - Session is already disconnected");else{var Gt,Qt=Jo(po.get().getConversations().keys());try{for(Qt.s();!(Gt=Qt.n()).done;){var Zt=Gt.value;Zt.status===et.g.CONVERSATION_STATUS_JOINED&&Zt.leave()}}catch(dr){Qt.e(dr)}finally{Qt.f()}if(clearInterval(is.get(dt)),is.set(dt,null),dt.token!==null&&vt.hasOwnProperty("invalidateUserToken")&&vt.invalidateUserToken)Bs.invalidateUserToken(dt.token).then(function(){Vs=null,vt.invalidateApiCCId=!0,zr.disconnect(vt),dt.id=null,dt.token=null;for(var dr=nu.get(dt),hr=0,Mr=Object.keys(dr);hr<Mr.length;hr++){var Xr=Mr[hr];cr.info("Session, removing apiRTCManager event :",Xr);var _i=dr[Xr];zr.removeEventListener(Xr,_i)}Dt()}).catch(function(dr){cr.error("disconnect() - An error occured during disconnection",dr),Vt(new Error("disconnect() - An error occured during disconnection"))});else{Vs=null,zr.disconnect(vt),dt.id=null;for(var an=nu.get(dt),Cn=0,Rn=Object.keys(an);Cn<Rn.length;Cn++){var Kn=Rn[Cn];cr.info("Session, removing apiRTCManager event :",Kn);var Xn=an[Kn];zr.removeEventListener(Kn,Xn)}Dt()}}})}},{key:"cloudRequest",value:function(dt,vt,Dt){return Bs.cloudRequest(dt,vt,Dt)}},{key:"sendRawData",value:function(dt,vt){return new Promise(function(Dt,Vt){dt!=null?zr.sendData(dt.getId(),vt).then(Dt).catch(function(Gt){switch(Gt){case et.g.ERROR_TIMED_OUT:Vt(Bt.g.createError(et.g.ERROR_TIMED_OUT,"sendRawData() - Data transmission timed out ",cr));break;case et.g.ERROR_NOT_FOUND:Vt(Bt.g.createError(et.g.ERROR_NOT_FOUND,"sendRawData() - Contact was not found ",cr));break;default:Vt(Bt.g.createError(et.g.ERROR_OTHER,"sendRawData() - Data transmission timed out ",cr))}}):Vt(Bt.g.createError(et.g.ERROR_OTHER,"sendRawData() - Contact undefined",cr))})}},{key:"startRecordingOutgoingStream",value:function(dt,vt){this.isRecording?cr.error("startRecordingOutgoingStream() - already recording"):(zr.webRTCClient.startRecording(dt,vt),this.isRecording=!0)}},{key:"stopRecordingOutgoingStream",value:function(){var dt=this;return new Promise(function(vt,Dt){dt.isRecording?(dt.isRecording=!1,zr.onceEvent("MCURecordedStreamsAvailable",function(Vt){vt({filename:Vt.detail.recordedFileName,url:et.g.RECORD_PLAY_URL+Vt.detail.recordedFileName})}),zr.webRTCClient.stopRecording()):(cr.error("stopRecordingOutgoingStream() - not recording"),Dt(new Error("stopRecordingOutgoingStream() - not recording")))})}},{key:"init",value:function(dt){var vt=this;this.id=dt,Vs=this,is.get(this)===null&&is.set(this,setInterval(function(){am(vt)},3e4))}},{key:"setMCUServer",value:function(dt){zr.webRTCClient.setMCUConnector(dt)}},{key:"allowMultipleCalls",value:function(dt){zr.webRTCClient.setAllowMultipleCalls(dt)}},{key:"setCallStatsMonitoringEnabled",value:function(dt,vt){zr.webRTCClient.enableCallStatsMonitoring(dt,vt)}},{key:"setQualityEvaluatingEnabled",value:function(dt,vt){zr.webRTCClient.enableQualityEvaluating(dt,vt)}},{key:"getContactFromWebSession",value:function(dt){var vt=this;return new Promise(function(Dt,Vt){Bs.getSessionHistory(dt,vt.getToken()).then(function(Gt){Gt.exist.toString()!=="1"?Vt(Bt.g.createError(et.g.ERROR_NOT_FOUND,"No such web session",cr)):Gt.user1.toString()===vt.getId()?Dt(vt.getContact(Gt.user2)):Gt.user2.toString()===vt.getId()?Dt(vt.getContact(Gt.user1)):Vt(Bt.g.createError(et.g.ERROR_UNAUTHORIZED,"User has no access to this web session",cr))}).catch(function(Gt){Gt.hasOwnProperty("code")?Vt({code:Gt.code,error:Gt.error}):Gt.hasOwnProperty("http_code")?Gt.http_code.toString().startsWith("4")?Vt(Bt.g.createError(et.g.ERROR_OTHER,"Error while getting contact from websession",cr)):Vt(Bt.g.createError(et.g.ERROR_SERVER_UNAVAILABLE,"Error while getting contact from websession",cr)):Vt(Bt.g.createError(et.g.ERROR_OTHER,"Error while getting contact from websession",cr))})})}},{key:"joinPointerSharingRoom",value:function(dt){var vt=this;return new Promise(function(Dt,Vt){if(as.get(vt).hasOwnProperty(dt))return Vt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"joinPointerSharingRoom() - cannot join pointer sharing room again",cr));zr.pointerSharingClient.joinRoom(dt,{success:function(Gt){var Qt=new ru(vt,Gt);as.get(vt)[Gt]=Qt,Dt(Qt)},failure:function(Gt,Qt){Vt(Gt==="timeout"?Bt.g.createError(et.g.ERROR_TIMED_OUT,"joinPointerSharingRoom() - cannot join pointer sharing room",cr):Bt.g.createError(et.g.ERROR_OTHER,"joinPointerSharingRoom() - cannot join pointer sharing room",cr))}})})}},{key:"getSubscribedPresenceGroup",value:function(){return apiCC!==void 0&&apiCC.session!==null&&apiCC.session!==void 0?apiCC.session.subscribeToPresenceGroup:[]}},{key:"getPresenceGroup",value:function(){return apiCC!==void 0&&apiCC.session!==null&&apiCC.session!==void 0?apiCC.session.presenceGroup:[]}}],kt=[{key:"getAvailableEvents",value:function(){return im}},{key:"getActiveSession",value:function(){return Vs}}],Xt&&Ju(Ut.prototype,Xt),kt&&Ju(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(fn),ru=function(jt,Ut){this.session=jt,this.roomId=Ut,this.getRoomId=function(){return this.roomId},this.isActive=function(){return this.session!==null&&this.roomId!==null&&zr.pointerSharingClient.roomActive(this.roomId)},this.leaveRoom=function(){var Xt=this;return new Promise(function(kt,Ft){if(Xt.session===null||Xt.roomId===null)return Ft(Bt.g.createError(et.g.ERROR_WRONG_STATE,"leaveRoom() - cannot leave room again",cr));zr.pointerSharingClient.leaveRoom(Xt.roomId),delete as.get(Xt.session)[Xt.roomId],Xt.session=null,Xt.roomId=null,kt()})},this.invite=function(Xt,kt){var Ft=this;return new Promise(function(sn,ln){if(Ft.session===null||Ft.roomId===null)return ln(Bt.g.createError(et.g.ERROR_WRONG_STATE,"invite() - cannot invite",cr));zr.pointerSharingClient.inviteInRoom(Ft.roomId,Xt.getId(),kt),sn()})},this.sendPointerLocation=function(Xt,kt,Ft,sn){var ln=this;return new Promise(function(Yt,dt){return ln.session===null||ln.roomId===null?dt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"sendPointerLocation() - cannot send pointer location",cr)):zr.pointerSharingClient.sendPointerLocation(ln.roomId,Xt,kt,Ft,sn)?void Yt():dt(Bt.g.createError(et.g.ERROR_WRONG_STATE,"sendPointerLocation() - cannot send pointer location",cr))})}},am=function(jt){for(var Ut=jt.getActiveConferences(),Xt=0,kt=Object.keys(Ut);Xt<kt.length;Xt++){var Ft=Ut[kt[Xt]];Bs.updateConferencePresence(Ft,jt,zr.getActiveApiKey())}},iu=s(7618);function zs(jt){var Ut=typeof Map=="function"?new Map:void 0;return zs=function(Xt){if(Xt===null||(kt=Xt,Function.toString.call(kt).indexOf("[native code]")===-1))return Xt;var kt;if(typeof Xt!="function")throw new TypeError("Super expression must either be null or a function");if(Ut!==void 0){if(Ut.has(Xt))return Ut.get(Xt);Ut.set(Xt,Ft)}function Ft(){return au(Xt,arguments,Fo(this).constructor)}return Ft.prototype=Object.create(Xt.prototype,{constructor:{value:Ft,enumerable:!1,writable:!0,configurable:!0}}),ls(Ft,Xt)},zs(jt)}function au(jt,Ut,Xt){return au=ep()?Reflect.construct.bind():function(kt,Ft,sn){var ln=[null];ln.push.apply(ln,Ft);var Yt=new(Function.bind.apply(kt,ln));return sn&&ls(Yt,sn.prototype),Yt},au.apply(null,arguments)}function ou(){return ou=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(jt,Ut,Xt){var kt=om(jt,Ut);if(kt){var Ft=Object.getOwnPropertyDescriptor(kt,Ut);return Ft.get?Ft.get.call(arguments.length<3?jt:Xt):Ft.value}},ou.apply(this,arguments)}function om(jt,Ut){for(;!Object.prototype.hasOwnProperty.call(jt,Ut)&&(jt=Fo(jt))!==null;);return jt}function ss(jt){return ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},ss(jt)}function oo(){oo=function(){return jt};var jt={},Ut=Object.prototype,Xt=Ut.hasOwnProperty,kt=typeof Symbol=="function"?Symbol:{},Ft=kt.iterator||"@@iterator",sn=kt.asyncIterator||"@@asyncIterator",ln=kt.toStringTag||"@@toStringTag";function Yt(sr,tr,Ir){return Object.defineProperty(sr,tr,{value:Ir,enumerable:!0,configurable:!0,writable:!0}),sr[tr]}try{Yt({},"")}catch{Yt=function(tr,Ir,Or){return tr[Ir]=Or}}function dt(sr,tr,Ir,Or){var br=tr&&tr.prototype instanceof Vt?tr:Vt,$a=Object.create(br.prototype),to=new Xr(Or||[]);return $a._invoke=function(vo,ko,Wr){var ho="suspendedStart";return function(So,ps){if(ho==="executing")throw new Error("Generator is already running");if(ho==="completed"){if(So==="throw")throw ps;return{value:void 0,done:!0}}for(Wr.method=So,Wr.arg=ps;;){var hs=Wr.delegate;if(hs){var lo=dr(hs,Wr);if(lo){if(lo===Dt)continue;return lo}}if(Wr.method==="next")Wr.sent=Wr._sent=Wr.arg;else if(Wr.method==="throw"){if(ho==="suspendedStart")throw ho="completed",Wr.arg;Wr.dispatchException(Wr.arg)}else Wr.method==="return"&&Wr.abrupt("return",Wr.arg);ho="executing";var fs=vt(vo,ko,Wr);if(fs.type==="normal"){if(ho=Wr.done?"completed":"suspendedYield",fs.arg===Dt)continue;return{value:fs.arg,done:Wr.done}}fs.type==="throw"&&(ho="completed",Wr.method="throw",Wr.arg=fs.arg)}}}(sr,Ir,to),$a}function vt(sr,tr,Ir){try{return{type:"normal",arg:sr.call(tr,Ir)}}catch(Or){return{type:"throw",arg:Or}}}jt.wrap=dt;var Dt={};function Vt(){}function Gt(){}function Qt(){}var Zt={};Yt(Zt,Ft,function(){return this});var an=Object.getPrototypeOf,Cn=an&&an(an(_i([])));Cn&&Cn!==Ut&&Xt.call(Cn,Ft)&&(Zt=Cn);var Rn=Qt.prototype=Vt.prototype=Object.create(Zt);function Kn(sr){["next","throw","return"].forEach(function(tr){Yt(sr,tr,function(Ir){return this._invoke(tr,Ir)})})}function Xn(sr,tr){function Ir(br,$a,to,vo){var ko=vt(sr[br],sr,$a);if(ko.type!=="throw"){var Wr=ko.arg,ho=Wr.value;return ho&&ss(ho)=="object"&&Xt.call(ho,"__await")?tr.resolve(ho.__await).then(function(So){Ir("next",So,to,vo)},function(So){Ir("throw",So,to,vo)}):tr.resolve(ho).then(function(So){Wr.value=So,to(Wr)},function(So){return Ir("throw",So,to,vo)})}vo(ko.arg)}var Or;this._invoke=function(br,$a){function to(){return new tr(function(vo,ko){Ir(br,$a,vo,ko)})}return Or=Or?Or.then(to,to):to()}}function dr(sr,tr){var Ir=sr.iterator[tr.method];if(Ir===void 0){if(tr.delegate=null,tr.method==="throw"){if(sr.iterator.return&&(tr.method="return",tr.arg=void 0,dr(sr,tr),tr.method==="throw"))return Dt;tr.method="throw",tr.arg=new TypeError("The iterator does not provide a 'throw' method")}return Dt}var Or=vt(Ir,sr.iterator,tr.arg);if(Or.type==="throw")return tr.method="throw",tr.arg=Or.arg,tr.delegate=null,Dt;var br=Or.arg;return br?br.done?(tr[sr.resultName]=br.value,tr.next=sr.nextLoc,tr.method!=="return"&&(tr.method="next",tr.arg=void 0),tr.delegate=null,Dt):br:(tr.method="throw",tr.arg=new TypeError("iterator result is not an object"),tr.delegate=null,Dt)}function hr(sr){var tr={tryLoc:sr[0]};1 in sr&&(tr.catchLoc=sr[1]),2 in sr&&(tr.finallyLoc=sr[2],tr.afterLoc=sr[3]),this.tryEntries.push(tr)}function Mr(sr){var tr=sr.completion||{};tr.type="normal",delete tr.arg,sr.completion=tr}function Xr(sr){this.tryEntries=[{tryLoc:"root"}],sr.forEach(hr,this),this.reset(!0)}function _i(sr){if(sr){var tr=sr[Ft];if(tr)return tr.call(sr);if(typeof sr.next=="function")return sr;if(!isNaN(sr.length)){var Ir=-1,Or=function br(){for(;++Ir<sr.length;)if(Xt.call(sr,Ir))return br.value=sr[Ir],br.done=!1,br;return br.value=void 0,br.done=!0,br};return Or.next=Or}}return{next:Vo}}function Vo(){return{value:void 0,done:!0}}return Gt.prototype=Qt,Yt(Rn,"constructor",Qt),Yt(Qt,"constructor",Gt),Gt.displayName=Yt(Qt,ln,"GeneratorFunction"),jt.isGeneratorFunction=function(sr){var tr=typeof sr=="function"&&sr.constructor;return!!tr&&(tr===Gt||(tr.displayName||tr.name)==="GeneratorFunction")},jt.mark=function(sr){return Object.setPrototypeOf?Object.setPrototypeOf(sr,Qt):(sr.__proto__=Qt,Yt(sr,ln,"GeneratorFunction")),sr.prototype=Object.create(Rn),sr},jt.awrap=function(sr){return{__await:sr}},Kn(Xn.prototype),Yt(Xn.prototype,sn,function(){return this}),jt.AsyncIterator=Xn,jt.async=function(sr,tr,Ir,Or,br){br===void 0&&(br=Promise);var $a=new Xn(dt(sr,tr,Ir,Or),br);return jt.isGeneratorFunction(tr)?$a:$a.next().then(function(to){return to.done?to.value:$a.next()})},Kn(Rn),Yt(Rn,ln,"Generator"),Yt(Rn,Ft,function(){return this}),Yt(Rn,"toString",function(){return"[object Generator]"}),jt.keys=function(sr){var tr=[];for(var Ir in sr)tr.push(Ir);return tr.reverse(),function Or(){for(;tr.length;){var br=tr.pop();if(br in sr)return Or.value=br,Or.done=!1,Or}return Or.done=!0,Or}},jt.values=_i,Xr.prototype={constructor:Xr,reset:function(sr){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Mr),!sr)for(var tr in this)tr.charAt(0)==="t"&&Xt.call(this,tr)&&!isNaN(+tr.slice(1))&&(this[tr]=void 0)},stop:function(){this.done=!0;var sr=this.tryEntries[0].completion;if(sr.type==="throw")throw sr.arg;return this.rval},dispatchException:function(sr){if(this.done)throw sr;var tr=this;function Ir(ko,Wr){return $a.type="throw",$a.arg=sr,tr.next=ko,Wr&&(tr.method="next",tr.arg=void 0),!!Wr}for(var Or=this.tryEntries.length-1;Or>=0;--Or){var br=this.tryEntries[Or],$a=br.completion;if(br.tryLoc==="root")return Ir("end");if(br.tryLoc<=this.prev){var to=Xt.call(br,"catchLoc"),vo=Xt.call(br,"finallyLoc");if(to&&vo){if(this.prev<br.catchLoc)return Ir(br.catchLoc,!0);if(this.prev<br.finallyLoc)return Ir(br.finallyLoc)}else if(to){if(this.prev<br.catchLoc)return Ir(br.catchLoc,!0)}else{if(!vo)throw new Error("try statement without catch or finally");if(this.prev<br.finallyLoc)return Ir(br.finallyLoc)}}}},abrupt:function(sr,tr){for(var Ir=this.tryEntries.length-1;Ir>=0;--Ir){var Or=this.tryEntries[Ir];if(Or.tryLoc<=this.prev&&Xt.call(Or,"finallyLoc")&&this.prev<Or.finallyLoc){var br=Or;break}}br&&(sr==="break"||sr==="continue")&&br.tryLoc<=tr&&tr<=br.finallyLoc&&(br=null);var $a=br?br.completion:{};return $a.type=sr,$a.arg=tr,br?(this.method="next",this.next=br.finallyLoc,Dt):this.complete($a)},complete:function(sr,tr){if(sr.type==="throw")throw sr.arg;return sr.type==="break"||sr.type==="continue"?this.next=sr.arg:sr.type==="return"?(this.rval=this.arg=sr.arg,this.method="return",this.next="end"):sr.type==="normal"&&tr&&(this.next=tr),Dt},finish:function(sr){for(var tr=this.tryEntries.length-1;tr>=0;--tr){var Ir=this.tryEntries[tr];if(Ir.finallyLoc===sr)return this.complete(Ir.completion,Ir.afterLoc),Mr(Ir),Dt}},catch:function(sr){for(var tr=this.tryEntries.length-1;tr>=0;--tr){var Ir=this.tryEntries[tr];if(Ir.tryLoc===sr){var Or=Ir.completion;if(Or.type==="throw"){var br=Or.arg;Mr(Ir)}return br}}throw new Error("illegal catch attempt")},delegateYield:function(sr,tr,Ir){return this.delegate={iterator:_i(sr),resultName:tr,nextLoc:Ir},this.method==="next"&&(this.arg=void 0),Dt}},jt}function Xu(jt,Ut,Xt,kt,Ft,sn,ln){try{var Yt=jt[sn](ln),dt=Yt.value}catch(vt){return void Xt(vt)}Yt.done?Ut(dt):Promise.resolve(dt).then(kt,Ft)}function Lo(jt){return function(){var Ut=this,Xt=arguments;return new Promise(function(kt,Ft){var sn=jt.apply(Ut,Xt);function ln(dt){Xu(sn,kt,Ft,ln,Yt,"next",dt)}function Yt(dt){Xu(sn,kt,Ft,ln,Yt,"throw",dt)}ln(void 0)})}}function $o(jt,Ut){var Xt=typeof Symbol<"u"&&jt[Symbol.iterator]||jt["@@iterator"];if(!Xt){if(Array.isArray(jt)||(Xt=function(dt,vt){if(dt){if(typeof dt=="string")return Qu(dt,vt);var Dt=Object.prototype.toString.call(dt).slice(8,-1);return Dt==="Object"&&dt.constructor&&(Dt=dt.constructor.name),Dt==="Map"||Dt==="Set"?Array.from(dt):Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt)?Qu(dt,vt):void 0}}(jt))||Ut&&jt&&typeof jt.length=="number"){Xt&&(jt=Xt);var kt=0,Ft=function(){};return{s:Ft,n:function(){return kt>=jt.length?{done:!0}:{done:!1,value:jt[kt++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Yt=!1;return{s:function(){Xt=Xt.call(jt)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Yt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Yt)throw sn}}}}function Qu(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function Hs(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function Zu(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function Gs(jt,Ut,Xt){return Ut&&Zu(jt.prototype,Ut),Xt&&Zu(jt,Xt),Object.defineProperty(jt,"prototype",{writable:!1}),jt}function qs(jt,Ut){if(typeof Ut!="function"&&Ut!==null)throw new TypeError("Super expression must either be null or a function");jt.prototype=Object.create(Ut&&Ut.prototype,{constructor:{value:jt,writable:!0,configurable:!0}}),Object.defineProperty(jt,"prototype",{writable:!1}),Ut&&ls(jt,Ut)}function ls(jt,Ut){return ls=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},ls(jt,Ut)}function Ks(jt){var Ut=ep();return function(){var Xt,kt=Fo(jt);if(Ut){var Ft=Fo(this).constructor;Xt=Reflect.construct(kt,arguments,Ft)}else Xt=kt.apply(this,arguments);return sm(this,Xt)}}function sm(jt,Ut){if(Ut&&(ss(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zr(jt)}function Zr(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function ep(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fo(jt){return Fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Fo(jt)}var jn=mt.Y.get("Stream"),su=An.get(),lm=po.get(),cm=["stopped","trackStopped","audioAmplitude","audioAmplitudeInfo","muteStateChange","activeStateChange","backgroundSubstractionStopVisibilityChange","backgroundSubstractionStopComputeTime","AIESnapshot","AIELog","flowStatusChanged","audioFlowStatusChanged","videoFlowStatusChanged","remoteAudioFlowStatusChanged","remoteVideoFlowStatusChanged","release","constraintsChanged"],yo=new Map,Js=new WeakMap,cs=new WeakMap,ds=new WeakMap,lu=new WeakMap,Yo={},so=function(jt){qs(Xt,jt);var Ut=Ks(Xt);function Xt(kt){var Ft,sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Hs(this,Xt),Ft=Ut.call(this,jn),sn.constructor!==!0)throw new Error("Stream constructor should not be used directly, please use a static method of class Stream such as : createStreamFromUserMedia, createStreamFromMediaStream, createScreensharingStream");if(delete sn.constructor,!sn.hasOwnProperty("type"))throw new Error("Cannot create Stream with no type");if(jn.debug("Create Stream with options",sn),Ft.data=kt,Ft.audioInput=sn.hasOwnProperty("audioInput")?sn.audioInput:null,Ft.videoInput=sn.hasOwnProperty("videoInput")?sn.videoInput:null,Ft.audioFilterIsApplied=!1,Ft.videoFilterIsApplied=!1,Ft.audioAppliedFilter="none",Ft.videoAppliedFilter="none",Ft.originalMediaTrack=null,sn.hasOwnProperty("userMediaStreamId")?(Ft.userMediaStreamId=sn.userMediaStreamId,Ft.isRemote=!1,yo.set(Ft.userMediaStreamId,Zr(Ft))):(Ft.userMediaStreamId=null,Ft.isRemote=!0),Bt.g.isPropertyTypeof(sn,"streamId","number")?Ft.streamId=sn.streamId:Ft.userMediaStreamId!==null?Ft.streamId=Number(Ft.userMediaStreamId):Number.MAX_SAFE_INTEGER!==void 0?Ft.streamId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER):Ft.streamId=Math.floor(1024*Math.random()*1024*1024),Ft.contact=sn.hasOwnProperty("contact")?sn.contact:null,sn.hasOwnProperty("callId")?(Ft.callId=sn.callId,Ft.callAudioAvailable=sn.callAudioAvailable,Ft.callAudioActive=sn.callAudioActive,Ft.callAudioMuted=sn.callAudioMuted,Ft.callAudioSilent=sn.callAudioSilent,Ft.callVideoAvailable=sn.callVideoAvailable,Ft.callVideoActive=sn.callVideoActive,Ft.callVideoMuted=sn.callVideoMuted,Ft.callVideoSilent=sn.callVideoSilent):Ft.callId=null,Ft.publishedInConversations=new Map,Ft.mediaRecorder=null,Ft.recordedBlobs=[],Js.set(Zr(Ft),!!sn.hasOwnProperty("screensharing")&&sn.screensharing),cs.set(Zr(Ft),null),ds.set(Zr(Ft),null),Ft.screensharingRemoteAccessStream=!1,apiRTC.userAgentInstance.apiRTCStreamsList.set(Ft.streamId,Zr(Ft)),Ft.type=sn.type,Ft.visibilityChangeHandlerWhenTorchOn=function(an){if(jn.debug("visibilityChangeHandlerWhenTorchOn :",document.visibilityState),document.visibilityState==="hidden"&&(jn.debug("visibilitychange is now hidden"),apiRTC.osName==="Android")){var Cn={video:{advanced:[{torch:!1}]}};Ft.informContactsOfChangedConstraints(Cn),Ft.emitConstraintsChanged(Cn),document.removeEventListener("visibilitychange",Ft.visibilityChangeHandlerWhenTorchOn,!1)}},apiRTC.browser!=="IE"&&Ft.data!==null){var ln,Yt=function(an){an.addEventListener("ended",function(Cn){Yo.hasOwnProperty(an.id)||(tn.get(Zr(Ft)).emit("trackStopped",{type:an.kind,id:an.id,reason:"ended"}),Yo[an.id]=!0)})},dt=$o(Ft.data.getVideoTracks());try{for(dt.s();!(ln=dt.n()).done;){var vt=ln.value;Yt(vt)}}catch(an){dt.e(an)}finally{dt.f()}var Dt,Vt=$o(Ft.data.getAudioTracks());try{for(Vt.s();!(Dt=Vt.n()).done;){var Gt=Dt.value;Yt(Gt)}}catch(an){Vt.e(an)}finally{Vt.f()}}var Qt={};if(Bt.g.isTypeof(Ft.userMediaStreamId,"string")?(Qt.userMediaStop=function(an){if(an.detail.userMediaStreamId===Ft.userMediaStreamId){var Cn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId};tn.get(Zr(Ft)).emit("stopped",Cn);var Rn=lu.get(Zr(Ft));if(Rn)for(var Kn in Rn)apiRTC.removeEventListener(Kn,Rn[Kn])}},Qt.localStreamUpdated=function(an){if(an.detail.userMediaStreamId===Ft.userMediaStreamId&&an.detail.callId===null){if(an.detail.changeList.indexOf("audioIsMuted")>=0){var Cn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId,type:"audio",muted:an.detail.audioIsMuted};tn.get(Zr(Ft)).emit("muteStateChange",Cn),Ft.sendAudioFlowStatusChanged(),Ft.sendFlowStatusChanged("audio")}if(an.detail.changeList.indexOf("videoIsMuted")>=0){var Rn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId,type:"video",muted:an.detail.videoIsMuted};tn.get(Zr(Ft)).emit("muteStateChange",Rn),Ft.sendVideoFlowStatusChanged(),Ft.sendFlowStatusChanged("video")}an.detail.changeList.indexOf("audioIsSilent")>=0&&(Ft.sendAudioFlowStatusChanged(),Ft.sendFlowStatusChanged("audio")),an.detail.changeList.indexOf("videoIsSilent")>=0&&(Ft.sendVideoFlowStatusChanged(),Ft.sendFlowStatusChanged("video"))}},Qt.backgroundSubstractionStopVisibilityChange=function(an){if(an.detail.userMediaStreamId===Ft.userMediaStreamId){var Cn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId};tn.get(Zr(Ft)).emit("backgroundSubstractionStopVisibilityChange",Cn)}},Qt.backgroundSubstractionStopComputeTime=function(an){if(an.detail.userMediaStreamId===Ft.userMediaStreamId){var Cn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId};tn.get(Zr(Ft)).emit("backgroundSubstractionStopComputeTime",Cn)}},Qt.AIESnapshot=function(an){if(an.detail.userMediaStreamId===Ft.userMediaStreamId){var Cn=an.detail.image;tn.get(Zr(Ft)).emit("AIESnapshot",Cn)}},Qt.AIELog=function(an){if(an.detail.userMediaStreamId===Ft.userMediaStreamId){var Cn=an.detail.log;tn.get(Zr(Ft)).emit("AIELog",Cn)}}):Bt.g.isTypeof(Ft.callId,"string")&&(Qt.hangup=function(an){if(an.detail.hangupType==="remote"&&an.detail.callId===Ft.callId){var Cn={streamId:Ft.streamId,callId:Ft.callId};tn.get(Zr(Ft)).emit("stopped",Cn);var Rn=lu.get(Zr(Ft));for(var Kn in Rn)apiRTC.removeEventListener(Kn,Rn[Kn])}},Qt.remoteStreamUpdated=function(an){if(an.detail.callId===Ft.callId){if(an.detail.changeList.indexOf("audioIsActive")>=0){Ft.callAudioActive=an.detail.audioIsActive;var Cn={streamId:Ft.streamId,callId:Ft.callId,type:"audio",active:an.detail.audioIsActive};tn.get(Zr(Ft)).emit("activeStateChange",Cn)}if(an.detail.changeList.indexOf("audioIsMuted")>=0){Ft.callAudioMuted=an.detail.audioIsMuted;var Rn={streamId:Ft.streamId,callId:Ft.callId,type:"audio",muted:an.detail.audioIsMuted};tn.get(Zr(Ft)).emit("muteStateChange",Rn),Ft.sendRemoteAudioFlowStatusChanged({enabled:!an.detail.audioIsMuted,muted:an.detail.audioIsSilent}),Ft.sendFlowStatusChangedForRemote("audio",{enabled:!an.detail.audioIsMuted,muted:an.detail.audioIsSilent})}if(an.detail.changeList.indexOf("videoIsActive")>=0){Ft.callVideoActive=an.detail.videoIsActive;var Kn={streamId:Ft.streamId,callId:Ft.callId,type:"video",active:an.detail.videoIsActive};tn.get(Zr(Ft)).emit("activeStateChange",Kn)}if(an.detail.changeList.indexOf("videoIsMuted")>=0){Ft.callVideoMuted=an.detail.videoIsMuted;var Xn={streamId:Ft.streamId,callId:Ft.callId,type:"video",muted:an.detail.videoIsMuted};tn.get(Zr(Ft)).emit("muteStateChange",Xn),Ft.sendRemoteVideoFlowStatusChanged({enabled:!an.detail.videoIsMuted,muted:an.detail.videoIsSilent}),Ft.sendFlowStatusChangedForRemote("video",{enabled:!an.detail.videoIsMuted,muted:an.detail.videoIsSilent})}an.detail.changeList.indexOf("audioIsSilent")>=0&&(Ft.callAudioSilent=an.detail.audioIsSilent,Ft.sendRemoteAudioFlowStatusChanged({enabled:!an.detail.audioIsMuted,muted:an.detail.audioIsSilent}),Ft.sendFlowStatusChangedForRemote("audio",{enabled:!an.detail.audioIsMuted,muted:an.detail.audioIsSilent})),an.detail.changeList.indexOf("videoIsSilent")>=0&&(Ft.callVideoSilent=an.detail.videoIsSilent,Ft.sendRemoteVideoFlowStatusChanged({enabled:!an.detail.videoIsMuted,muted:an.detail.videoIsSilent}),Ft.sendFlowStatusChangedForRemote("video",{enabled:!an.detail.videoIsMuted,muted:an.detail.videoIsSilent})),an.detail.changeList.indexOf("audioIsSilentLocally")>=0&&(Ft.sendAudioFlowStatusChanged(),Ft.sendFlowStatusChanged("audio")),an.detail.changeList.indexOf("videoIsSilentLocally")>=0&&(Ft.sendVideoFlowStatusChanged(),Ft.sendFlowStatusChanged("video"))}}),Object.keys(Qt).length>0)for(var Zt in lu.set(Zr(Ft),Qt),Qt)apiRTC.addEventListener(Zt,Qt[Zt]);return Ft}return Gs(Xt,[{key:"getContact",value:function(){return this.contact}},{key:"getData",value:function(){return this.data}},{key:"getConversations",value:function(){var kt,Ft=[],sn=$o(this.publishedInConversations.keys());try{for(sn.s();!(kt=sn.n()).done;){var ln=kt.value;Ft.push(lm.getConversations(ln))}}catch(Yt){sn.e(Yt)}finally{sn.f()}return Ft}},{key:"isScreensharing",value:function(){return Js.get(this)}},{key:"isScreensharingRemoteAccess",value:function(){return this.screensharingRemoteAccessStream}},{key:"hasData",value:function(){return this.data!==null}},{key:"hasVideo",value:function(){return this.callId?this.callVideoAvailable&&this.callVideoActive:!!this.hasData()&&this.data.getVideoTracks().length>0}},{key:"hasAudio",value:function(){return this.callId?this.callAudioAvailable&&this.callAudioActive:!!this.hasData()&&this.data.getAudioTracks().length>0}},{key:"isVideoMuted",value:function(){if(this.callId)return this.callVideoSilent;if(this.hasData()){var kt=this.data.getVideoTracks();if(kt&&kt.length>0)return kt[0].muted}return!0}},{key:"isVideoEnabled",value:function(){if(this.callId)return!this.callVideoMuted;if(this.hasData()){var kt=this.data.getVideoTracks();return kt&&kt.length>0&&kt[0].enabled}return!1}},{key:"isAudioMuted",value:function(){if(this.callId)return this.callAudioSilent;if(this.hasData()){var kt=this.data.getAudioTracks();if(kt&&kt.length>0)return kt[0].muted}return!0}},{key:"isAudioEnabled",value:function(){if(this.callId)return!this.callAudioMuted;if(this.hasData()){var kt=this.data.getAudioTracks();return kt&&kt.length>0&&kt[0].enabled}return!1}},{key:"getType",value:function(){return this.type}},{key:"release",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.childType==="noiseReduction"&&this.parent!==void 0){apiCC.audioProcessor.stopAudioNodeCtx(this.parent.nodeCtx);var Ft=apiCC.getUserMediaStream(this.parent.userMediaStreamId);apiCC.audioProcessor.listenToAudio(this.parent.data,Ft)}this.hasData()&&(this.releaseAudio(),this.releaseVideo(),this.data=null,this.userMediaStreamId&&(apiCC.releaseUserMediaStream(this.userMediaStreamId),yo.delete(this.userMediaStreamId))),tn.get(this).emit("release",{streamId:this.streamId,userMediaStreamId:this.userMediaStreamId}),kt.releaseChildrenStream!==!1&&this.releaseAllChildren(),kt.releaseParentStream!==!1&&this.parent!==void 0&&(jn.debug("release parent is also requested"),this.parent.release(kt)),jn.debug("Removing in apiRTCStreamsList :",this.streamId),apiRTC.userAgentInstance.apiRTCStreamsList.delete(this.streamId)}},{key:"releaseAudio",value:function(){var kt=this;this.hasData()&&(this.disableAudioAnalysis(),this.data.getAudioTracks().forEach(function(Ft){Ft.stop(),Yo.hasOwnProperty(Ft.id)||(tn.get(kt).emit("trackStopped",{type:Ft.kind,id:Ft.id,reason:"releaseAudio"}),Yo[Ft.id]=!0)}))}},{key:"releaseVideo",value:function(){var kt=this;this.hasData()&&this.data.getVideoTracks().forEach(function(Ft){Ft.stop(),Yo.hasOwnProperty(Ft.id)||(tn.get(kt).emit("trackStopped",{type:Ft.kind,id:Ft.id,reason:"releaseVideo"}),Yo[Ft.id]=!0)})}},{key:"muteAudio",value:function(){jn.warn("This method is deprecated now, please use Stream.disableAudio() instead"),this.disableAudio()}},{key:"muteVideo",value:function(){jn.warn("This method is deprecated now, please use Stream.disableVideo() instead"),this.disableVideo()}},{key:"unmuteAudio",value:function(){jn.warn("This method is deprecated now, please use Stream.enableAudio() instead"),this.enableAudio()}},{key:"unmuteVideo",value:function(){jn.warn("This method is deprecated now, please use Stream.enableVideo() instead"),this.enableVideo()}},{key:"sendStreamRequest",value:function(kt,Ft,sn){var ln={};ln.streamId=this.streamId;var Yt=this.publishedInConversations.keys();ln.roomname=Yt.next().value,this.contact.sendRequest(kt,ln).then(function(){return Ft()}).catch(function(dt){return jn.error("Error on sendRequest :",dt),sn()})}},{key:"enableAudio",value:function(){var kt=this,Ft=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Lo(oo().mark(function ln(Yt,dt){var vt;return oo().wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:if(kt.isAudioEnabled()!==!0||kt.isRemote!==!1){Dt.next=3;break}return jn.debug("audio already enabled"),Dt.abrupt("return",Yt());case 3:if(!kt.userMediaStreamId){Dt.next=16;break}if(vt=apiCC.getUserMediaStream(kt.userMediaStreamId)){Dt.next=7;break}return Dt.abrupt("return",dt());case 7:if(vt.unMuteAudioOnStreams("enabled"),kt.parent===void 0){Dt.next=12;break}return jn.debug("this is a child stream, need to unmute parent if necessary"),Dt.next=12,kt.parent.enableAudio();case 12:return kt.childrens!==void 0&&kt.childrens.forEach(function(){var Vt=Lo(oo().mark(function Gt(Qt,Zt){return oo().wrap(function(an){for(;;)switch(an.prev=an.next){case 0:return an.next=2,Qt.enableAudio();case 2:case"end":return an.stop()}},Gt)}));return function(Gt,Qt){return Vt.apply(this,arguments)}}()),Dt.abrupt("return",Yt());case 16:if(!kt.callId){Dt.next=29;break}if(Ft!==!0){Dt.next=23;break}jn.debug("enableAudio remote with applyRemotely"),jn.debug("this.contact :",kt.contact),kt.sendStreamRequest(et.g.CONTACT_ENABLE_AUDIO_REQUEST,Yt,dt),Dt.next=28;break;case 23:if(kt.hasData()){Dt.next=25;break}return Dt.abrupt("return",dt());case 25:kt.data.getAudioTracks().forEach(function(Vt){Vt.enabled=!0}),kt.sendAudioFlowStatusChanged(),kt.sendFlowStatusChanged("audio");case 28:return Dt.abrupt("return",Yt());case 29:return Dt.abrupt("return",dt());case 30:case"end":return Dt.stop()}},ln)}));return function(ln,Yt){return sn.apply(this,arguments)}}())}},{key:"disableAudio",value:function(){var kt=this,Ft=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Lo(oo().mark(function ln(Yt,dt){var vt;return oo().wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:if(kt.isAudioEnabled()!==!1||kt.isRemote!==!1){Dt.next=3;break}return jn.debug("audio already disabled"),Dt.abrupt("return",Yt());case 3:if(!kt.userMediaStreamId){Dt.next=16;break}if(vt=apiCC.getUserMediaStream(kt.userMediaStreamId)){Dt.next=7;break}return Dt.abrupt("return",dt());case 7:if(vt.muteAudioOnStreams("enabled"),kt.parent===void 0){Dt.next=12;break}return jn.debug("this is a child stream, need to mute parent if necessary"),Dt.next=12,kt.parent.disableAudio();case 12:return kt.childrens!==void 0&&kt.childrens.forEach(function(){var Vt=Lo(oo().mark(function Gt(Qt,Zt){return oo().wrap(function(an){for(;;)switch(an.prev=an.next){case 0:return an.next=2,Qt.disableAudio();case 2:case"end":return an.stop()}},Gt)}));return function(Gt,Qt){return Vt.apply(this,arguments)}}()),Dt.abrupt("return",Yt());case 16:if(!kt.callId){Dt.next=29;break}if(Ft!==!0){Dt.next=23;break}jn.debug("disableAudio remote with applyRemotely"),jn.debug("this.contact :",kt.contact),kt.sendStreamRequest(et.g.CONTACT_DISABLE_AUDIO_REQUEST,Yt,dt),Dt.next=28;break;case 23:if(kt.hasData()){Dt.next=25;break}return Dt.abrupt("return",dt());case 25:kt.data.getAudioTracks().forEach(function(Vt){Vt.enabled=!1}),kt.sendAudioFlowStatusChanged(),kt.sendFlowStatusChanged("audio");case 28:return Dt.abrupt("return",Yt());case 29:return Dt.abrupt("return",dt());case 30:case"end":return Dt.stop()}},ln)}));return function(ln,Yt){return sn.apply(this,arguments)}}())}},{key:"enableVideo",value:function(){var kt=this,Ft=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Lo(oo().mark(function ln(Yt,dt){var vt;return oo().wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:if(kt.isVideoEnabled()!==!0||kt.isRemote!==!1){Dt.next=3;break}return jn.debug("video already enabled"),Dt.abrupt("return",Yt());case 3:if(!kt.userMediaStreamId){Dt.next=16;break}if(vt=apiCC.getUserMediaStream(kt.userMediaStreamId)){Dt.next=7;break}return Dt.abrupt("return",dt());case 7:if(vt.unMuteVideoOnStreams("enabled"),kt.parent===void 0){Dt.next=12;break}return jn.debug("this is a child stream, need to unmute parent if necessary"),Dt.next=12,kt.parent.enableVideo();case 12:return kt.childrens!==void 0&&kt.childrens.forEach(function(){var Vt=Lo(oo().mark(function Gt(Qt,Zt){return oo().wrap(function(an){for(;;)switch(an.prev=an.next){case 0:return an.next=2,Qt.enableVideo();case 2:case"end":return an.stop()}},Gt)}));return function(Gt,Qt){return Vt.apply(this,arguments)}}()),Dt.abrupt("return",Yt());case 16:if(!kt.callId){Dt.next=29;break}if(Ft!==!0){Dt.next=23;break}jn.debug("enableVideo remote with applyRemotely"),jn.debug("this.contact :",kt.contact),kt.sendStreamRequest(et.g.CONTACT_ENABLE_VIDEO_REQUEST,Yt,dt),Dt.next=28;break;case 23:if(kt.hasData()){Dt.next=25;break}return Dt.abrupt("return",dt());case 25:kt.data.getVideoTracks().forEach(function(Vt){Vt.enabled=!0}),kt.sendVideoFlowStatusChanged(),kt.sendFlowStatusChanged("video");case 28:return Dt.abrupt("return",Yt());case 29:return Dt.abrupt("return",dt());case 30:case"end":return Dt.stop()}},ln)}));return function(ln,Yt){return sn.apply(this,arguments)}}())}},{key:"disableVideo",value:function(){var kt=this,Ft=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Lo(oo().mark(function ln(Yt,dt){var vt;return oo().wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:if(kt.isVideoEnabled()!==!1||kt.isRemote!==!1){Dt.next=3;break}return jn.debug("video already disabled"),Dt.abrupt("return",Yt());case 3:if(!kt.userMediaStreamId){Dt.next=16;break}if(vt=apiCC.getUserMediaStream(kt.userMediaStreamId)){Dt.next=7;break}return Dt.abrupt("return",dt());case 7:if(vt.muteVideoOnStreams("enabled"),kt.parent===void 0){Dt.next=12;break}return jn.debug("this is a child stream, need to mute parent if necessary"),Dt.next=12,kt.parent.disableVideo();case 12:return kt.childrens!==void 0&&kt.childrens.forEach(function(){var Vt=Lo(oo().mark(function Gt(Qt,Zt){return oo().wrap(function(an){for(;;)switch(an.prev=an.next){case 0:return an.next=2,Qt.disableVideo();case 2:case"end":return an.stop()}},Gt)}));return function(Gt,Qt){return Vt.apply(this,arguments)}}()),Dt.abrupt("return",Yt());case 16:if(!kt.callId){Dt.next=29;break}if(Ft!==!0){Dt.next=23;break}jn.debug("disableVideo remote with applyRemotely"),jn.debug("this.contact :",kt.contact),kt.sendStreamRequest(et.g.CONTACT_DISABLE_VIDEO_REQUEST,Yt,dt),Dt.next=28;break;case 23:if(kt.hasData()){Dt.next=25;break}return Dt.abrupt("return",dt());case 25:kt.data.getVideoTracks().forEach(function(Vt){Vt.enabled=!1}),kt.sendVideoFlowStatusChanged(),kt.sendFlowStatusChanged("video");case 28:return Dt.abrupt("return",Yt());case 29:return Dt.abrupt("return",dt());case 30:case"end":return Dt.stop()}},ln)}));return function(ln,Yt){return sn.apply(this,arguments)}}())}},{key:"getAudioFlowStatus",value:function(){var kt={};return this.data.getAudioTracks().forEach(function(Ft){kt.enabled=Ft.enabled,kt.muted=Ft.muted}),kt}},{key:"getVideoFlowStatus",value:function(){var kt={};return this.data.getVideoTracks().forEach(function(Ft){kt.enabled=Ft.enabled,kt.muted=Ft.muted}),kt}},{key:"getRemoteAudioFlowStatus",value:function(){var kt=this;return new Promise(function(Ft,sn){if(!kt.isRemote)return sn("Please use this function on a remote Stream");if(jn.debug("getRemoteAudioFlowStatus()"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getRemoteAudioFlowStatus",Ft,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"getRemoteVideoFlowStatus",value:function(){var kt=this;return new Promise(function(Ft,sn){if(!kt.isRemote)return sn("Please use this function on a remote Stream");if(jn.debug("getRemoteVideoFlowStatus()"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getRemoteVideoFlowStatus",Ft,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"attachToElement",value:function(kt){jn.debug("attachToElement"),su.attachMediaStream(kt,this.data)}},{key:"addInDiv",value:function(kt,Ft,sn,ln,Yt){jn.debug("addInDiv"),su.addStreamInDiv(this.data,this.type,kt,Ft,sn,ln,Yt)}},{key:"removeFromDiv",value:function(kt,Ft){jn.debug("removeFromDiv"),su.removeElementFromDiv(kt,Ft)}},{key:"startRecord",value:function(kt){return jn.info("startRecord :",kt),apiCC.recordMgr.record(this.data,kt)}},{key:"stopRecord",value:function(){return jn.info("stopRecord() - Stopping record"),apiCC.recordMgr.stop()}},{key:"pauseRecord",value:function(){return jn.info("pauseRecord() - Pausing record"),apiCC.recordMgr.pause()}},{key:"resumeRecord",value:function(){return jn.info("resumeRecord() - Resuming record"),apiCC.recordMgr.resume()}},{key:"enableAudioAnalysis",value:function(){var kt=this,Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};jn.info("enableAudioAnalysis()");var sn=Bt.g.getAudioContext(),ln=null,Yt=!1,dt=ds.get(this),vt=cs.get(this);sn?this.hasData()?dt!==null||vt!==null?jn.error("enableAudioAnalysis() - Audio analysis already enabled"):(dt=sn.createMediaStreamSource(this.data),(vt=sn.createScriptProcessor(2048,1,1)).connect(sn.destination),vt.onaudioprocess=function(){var Dt,Vt=new Uint8Array(vt.analyser.frequencyBinCount),Gt=0;vt.analyser.getByteFrequencyData(Vt);var Qt,Zt=$o(Vt);try{for(Zt.s();!(Qt=Zt.n()).done;)Gt+=Qt.value}catch(Kn){Zt.e(Kn)}finally{Zt.f()}Dt=Gt/Vt.length,tn.get(kt).emit("audioAmplitude",Dt);var an=0;Vt.sort(function(Kn,Xn){return Xn-Kn}),Vt=Vt.slice(0,50);for(var Cn=0;Cn<Vt.length;Cn++)an+=Vt[Cn];Dt=an/Vt.length;var Rn=typeof Ft.threshold=="number"?Ft.threshold:et.g.STREAM_AUDIO_ANALYSIS_THRESHOLD;Dt>Rn&&(Yt||(Yt=!0,tn.get(kt).emit("audioAmplitudeInfo",{amplitude:Dt,isSpeaking:!0})),ln!==null&&clearTimeout(ln),ln=setTimeout(function(){tn.get(kt).emit("audioAmplitudeInfo",{amplitude:Dt,isSpeaking:!1}),Yt=!1},1e3))},vt.analyser=sn.createAnalyser(),vt.analyser.smoothingTimeConstant=.5,vt.analyser.fftSize=1024,dt.connect(vt.analyser),vt.analyser.connect(vt),cs.set(this,vt),ds.set(this,dt)):jn.error("enableAudioAnalysis() - Stream has no data, unable to enable audio analysis"):jn.error("enableAudioAnalysis() - AudioContext is not available, unable to enable audio analysis")}},{key:"disableAudioAnalysis",value:function(){jn.info("disableAudioAnalysis()");var kt=ds.get(this),Ft=cs.get(this);kt!==null&&kt.disconnect(),Ft!==null&&(Ft.analyser.disconnect(),Ft.disconnect()),cs.set(this,null),ds.set(this,null)}},{key:"takeSnapshot",value:function(){var kt=this,Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};jn.info("takeSnapshot()");var sn=null,ln=null;return new Promise(function(Yt,dt){if(kt.hasData()){kt.hasVideo()||jn.warn("takeSnapshot() - This stream does not have a video track"),sn=document.createElement("video"),ln=function(Gt){if(vt.width=sn.videoWidth,vt.height=sn.videoHeight,Ft.hasOwnProperty("width")&&(vt.width=Ft.width),Ft.hasOwnProperty("height")&&(vt.height=Ft.height),Ft.hasOwnProperty("filters")){for(var Qt=[],Zt=0,an=Object.keys(Ft.filters);Zt<an.length;Zt++){var Cn=an[Zt];Qt.push(Cn+"("+Ft.filters[Cn]+")")}Dt.filter=Qt.join(" ")}Dt.drawImage(sn,0,0,vt.width,vt.height),Gt===!0&&sn.remove(),Ft.hasOwnProperty("output")&&Ft.output==="blob"?Ft.outputMimeType!==void 0?(jn.debug("options.outputMimeType is defined :",Ft.outputMimeType),vt.toBlob(function(Rn){Yt(Rn)},Ft.outputMimeType,Ft.outputQualityArgument)):vt.toBlob(function(Rn){Yt(Rn)},"image/png"):Ft.outputMimeType!==void 0?(jn.debug("options.outputMimeType is defined :",Ft.outputMimeType),Yt(vt.toDataURL(Ft.outputMimeType,Ft.outputQualityArgument))):Yt(vt.toDataURL("image/png"))};var vt=document.createElement("canvas"),Dt=vt.getContext("2d");Ft.divId===void 0||Ft.divId===null?setTimeout(function(){kt.attachToElement(sn),sn.addEventListener("canplay",function(){ln(!0)}),sn.muted=!0,sn.play()},1e3):(sn=document.getElementById(Ft.divId))===null?jn.error("divId not found for snapshot"):ln(!1)}else{var Vt="takeSnapshot() - Stream has no data, cannot get snapshot";jn.error(Vt),dt(new Error(Vt))}})}},{key:"getId",value:function(){return String(this.streamId)}},{key:"getOwner",value:function(){return this.contact?this.contact:Br.getActiveSession().getUserAgent()}},{key:"getLabels",value:function(){var kt={};return this.hasData()&&this.data.getAudioTracks().length>0&&(kt.audioSourceLabel="",this.data.getAudioTracks()[0].label&&(kt.audioSourceLabel=this.data.getAudioTracks()[0].label)),this.hasData()&&this.data.getVideoTracks().length>0&&(kt.videoSourceLabel="",this.data.getVideoTracks()[0].label&&(kt.videoSourceLabel=this.data.getVideoTracks()[0].label)),jn.debug("getLabels:",kt),kt}},{key:"checkImageCaptureCompatibility",value:function(){return typeof ImageCapture>"u"}},{key:"getLocalMediaStreamTrack",value:function(){var kt=null;return this.data.getVideoTracks().length===1&&(kt=this.data.getVideoTracks()[0]),kt}},{key:"getLocalMediaStreamAudioTrack",value:function(){var kt=null;return this.data.getAudioTracks().length===1&&(kt=this.data.getAudioTracks()[0]),kt}},{key:"informContactsOfChangedConstraints",value:function(kt){var Ft,sn=po.get().getConversations(),ln=$o(sn.keys());try{for(ln.s();!(Ft=ln.n()).done;){var Yt=Ft.value,dt=sn.get(Yt).getContactsArray(),vt=void 0;for(vt=0;vt<dt.length;vt++)dt[vt].sendCustomEvent(et.g.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:this.callId,streamId:this.getId(),constraints:kt,mediaStreamId:this.data.id})}}catch(Vt){ln.e(Vt)}finally{ln.f()}if(this.callId!==null){jn.debug("This stream is used in a call, send CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER to remote");var Dt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callId);Dt!==null&&Br.getActiveSession().getOrCreateContact(Dt.remoteId).sendCustomEvent(et.g.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:this.callId,streamId:this.getId(),constraints:kt,mediaStreamId:this.data.id})}}},{key:"applyConstraints",value:function(kt){var Ft=this;return new Promise(function(sn,ln){if(Ft.isRemote){if(jn.debug("applyConstraints() on a remote stream"),Ft.contact===null)return ln("No contact associated");var Yt=Ft.addPendingPromise("applyConstraints",sn,ln);Ft.contact.sendCustomEvent(et.g.CONTACT_APPLY_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:Ft.callId,streamId:Ft.getId(),timeout:Yt,constraints:kt})}else{if(jn.debug("applyConstraints() local"),!MediaStreamTrack.prototype.hasOwnProperty("applyConstraints"))return ln("Navigator not compatible with this function");var dt=null,vt=null;if(kt===void 0)return ln("Missing argument");if(kt.audio!==void 0){var Dt=Ft.getLocalMediaStreamAudioTrack();Dt!==null&&(dt=Dt.applyConstraints(kt.audio))}if(kt.video!==void 0){var Vt=Ft.getLocalMediaStreamTrack();Vt!==null&&(vt=Vt.applyConstraints(kt.video))}Promise.all([dt,vt]).then(function(Gt){return jn.debug("Constraints applied :",kt),kt&&kt.video&&kt.video.advanced&&kt.video.advanced[0].torch===!0?(jn.debug("Torch to true:",kt),document.addEventListener("visibilitychange",Ft.visibilityChangeHandlerWhenTorchOn,!1)):kt&&kt.video&&kt.video.advanced&&kt.video.advanced[0].torch===!1&&(jn.debug("Torch to false:",kt),document.removeEventListener("visibilitychange",Ft.visibilityChangeHandlerWhenTorchOn,!1)),Ft.informContactsOfChangedConstraints(kt),sn()}).catch(function(Gt){return jn.error("reject Promise all :",Gt),ln(Gt)})}})}},{key:"applyConstraint",value:function(kt,Ft){jn.error("Due to a certain amount of problems with this function it has been desactivated, please use Stream.applyConstraints instead")}},{key:"setCapability",value:function(kt,Ft){jn.error("Due to a certain amount of problems with this function it has been desactivated, please use Stream.applyConstraints instead")}},{key:"getSettings",value:function(){var kt=this;return new Promise(function(Ft,sn){if(!kt.isRemote)return jn.debug("getSettings()"),MediaStreamTrack.prototype.hasOwnProperty("getSettings")?Ft({audio:kt.getStreamTrackSettings(kt.getLocalMediaStreamAudioTrack()),video:kt.getStreamTrackSettings(kt.getLocalMediaStreamTrack())}):sn("Navigator not compatible with this function");if(jn.debug("getSettings() on a remote stream"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getSettings",Ft,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_SETTINGS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"getStreamTrackSettings",value:function(kt){if(kt!==null)return kt.getSettings()}},{key:"getCapabilities",value:function(){var kt=this;return new Promise(function(Ft,sn){if(!kt.isRemote)return jn.debug("getCapabilities()"),MediaStreamTrack.prototype.hasOwnProperty("getCapabilities")?Ft({audio:kt.getStreamTrackCapabilities(kt.getLocalMediaStreamAudioTrack()),video:kt.getStreamTrackCapabilities(kt.getLocalMediaStreamTrack())}):sn("Navigator not compatible with this function");if(jn.debug("getCapabilities() on a remote stream"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getCapabilities",Ft,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_CAPABILITIES_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"getStreamTrackCapabilities",value:function(kt){return kt!==null?kt.getCapabilities():{}}},{key:"getConstraints",value:function(){var kt=this;return new Promise(function(Ft,sn){if(!kt.isRemote)return jn.debug("getConstraints()"),MediaStreamTrack.prototype.hasOwnProperty("getConstraints")?Ft({audio:kt.getStreamTrackConstraints(kt.getLocalMediaStreamAudioTrack()),video:kt.getStreamTrackConstraints(kt.getLocalMediaStreamTrack())}):sn("Navigator not compatible with this function");if(jn.debug("getConstraints() on a remote stream"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getConstraints",Ft,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"getStreamTrackConstraints",value:function(kt){return kt!==null?kt.getConstraints():{}}},{key:"takePhoto",value:function(){var kt=this;return new Promise(function(Ft,sn){if(jn.debug("takePhoto()"),kt.checkImageCaptureCompatibility())sn("Your navigator is not compatible with takePhoto()");else{var ln=kt.getLocalMediaStreamTrack();ln!==null?new ImageCapture(ln).takePhoto().then(function(Yt){var dt=new Image;dt.src=URL.createObjectURL(Yt),Ft(dt)}).catch(function(Yt){sn("takePhoto() error: ",Yt)}):sn("No local mediaStreamTrack found")}})}},{key:"activateAIAnnotations",value:function(){var kt=this.getStreamAIE();kt!==null&&kt.activateAnnotations()}},{key:"stopAIAnnotations",value:function(){var kt=this.getStreamAIE();kt!==null&&kt.stopAnnotations()}},{key:"activateAILogs",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(typeof kt!="number")return jn.error("minLogPeriod parameter must be an integer");var Ft=this.getStreamAIE();Ft!==null&&Ft.activateLogs(kt)}},{key:"stopAILogs",value:function(){var kt=this.getStreamAIE();kt!==null&&kt.stopLogs()}},{key:"activateAISnapshots",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(typeof kt!="number")return jn.error("minSnapshotPeriod parameter must be an integer");var Ft=this.getStreamAIE();Ft!==null&&Ft.activateSnapshots(kt)}},{key:"stopAISnapshots",value:function(){var kt=this.getStreamAIE();kt!==null&&kt.stopSnapshots()}},{key:"getStreamAIE",value:function(){var kt=null;if(apiCC!==void 0){var Ft=apiCC.getUserMediaStream(this.userMediaStreamId);if(Ft.mediaFilterManager!==null){var sn=Ft.mediaFilterManager.filters;Object.values(sn).forEach(function(ln){ln.streamAIE!==null&&(kt=ln.streamAIE)}),kt===null&&jn.error("Applied filter is not an AI filter")}else jn.error("No filter applied on stream")}return kt}},{key:"addChildren",value:function(kt,Ft){this.childrenTypeExists(Ft)?jn.error("This stream already has a sub instance running for this"):(this.childrens===void 0&&(this.childrens=[]),this.childrens.push(kt))}},{key:"releaseChildren",value:function(kt){this.childrens!==void 0&&this.childrens.forEach(function(Ft,sn){Ft.childType===kt&&Ft.release({releaseParentStream:!1})})}},{key:"releaseAllChildren",value:function(){jn.debug("releaseAllChildren"),this.childrens!==void 0&&this.childrens.forEach(function(kt,Ft){kt.release({releaseParentStream:!1})})}},{key:"removeChildren",value:function(kt){var Ft=this;this.childrens!==void 0&&this.childrens.forEach(function(sn,ln){if(sn.childType===kt)return Ft.childrens.splice(ln,1)})}},{key:"childrenTypeExists",value:function(kt){var Ft=!1;return this.childrens!==void 0&&this.childrens.forEach(function(sn){sn.childType===kt&&(Ft=!0)}),Ft}},{key:"createChildStreamFromStream",value:function(kt,Ft){var sn=this,ln=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(Yt,dt){jn.debug("createChildStreamFromStream");var vt={};vt.type=et.g.STREAM_TYPE_NO_INPUT,kt.getAudioTracks().length>0&&(vt.type=et.g.STREAM_TYPE_AUDIO),kt.getVideoTracks().length>0&&(vt.type=et.g.STREAM_TYPE_VIDEO);var Dt=sn;apiRTC.createUserMediaStream({type:"media",stream:kt,success:function(Vt){jn.debug("[createChildStreamFromStream] success; userMediaStreamId: "+Vt.userMediaStreamId),vt.constructor=!0,vt.userMediaStreamId=Vt.userMediaStreamId;var Gt=new dm(Vt.stream,vt,Dt,Ft);Gt.parentStreamCtx=ln,ln.audioFilterIsApplied===!0&&(Gt.audioFilterIsApplied=ln.audioFilterIsApplied,Gt.audioAppliedFilter=ln.audioAppliedFilter),ln.videoFilterIsApplied===!0&&(Gt.videoFilterIsApplied=ln.videoFilterIsApplied,Gt.videoAppliedFilter=ln.videoAppliedFilter),Yt(Gt)},failure:function(Vt,Gt){jn.debug("[createChildStreamFromStream] failure :",Gt),dt()},childStreamType:Ft})})}},{key:"applyMuteStatusFromParent",value:function(){var kt=this,Ft=0;this.data.getAudioTracks().forEach(function(ln){ln.enabled=kt.parent.data.getAudioTracks()[Ft].enabled,Ft++});var sn=0;this.data.getVideoTracks().forEach(function(ln){ln.enabled=kt.parent.data.getVideoTracks()[sn].enabled,sn++})}},{key:"loadTFLiteModule",value:function(){return new Promise(function(kt,Ft){var sn;if(sn=iu.feature.simd?"https://cdn.apizee.com/apiRTC/lib/tflite/tflite-simd.js":"https://cdn.apizee.com/apiRTC/lib/tflite/tflite.js",apiRTC.userAgentInstance.tFLiteModuleLoaded===!1){jn.debug("loading tflite");var ln={async:!0,numRetries:20,reqdelay:200,success:function(){jn.debug("loaded successfully",iu.feature.simd),iu.feature.simd?createTFLiteSIMDModule().then(function(Yt){apiRTC.userAgentInstance.tFLiteSIMDModule=Yt,apiRTC.userAgentInstance.tFLiteModuleLoaded=!0,kt(Yt)}):createTFLiteModule().then(function(Yt){apiRTC.userAgentInstance.tFLiteSIMDModule=Yt,apiRTC.userAgentInstance.tFLiteModuleLoaded=!0,kt(Yt)})},error:function(Yt){Ft("Resources loading failed, depsNotFound: "+Yt)},retrycb:function(Yt,dt){jn.warn("Blur API module loading retry :"+Yt+" ,delay before retry :"+dt)}};apiCC.resourcesLoader.loadjs([sn],"blur-api",ln)}else jn.debug("tflite already loaded and TFLiteSIMDModule already created"),kt(apiRTC.userAgentInstance.tFLiteSIMDModule)})}},{key:"setupTFLiteModule",value:function(kt){return new Promise(function(Ft,sn){jn.debug("setupTFLiteModule"),apiRTC.userAgentInstance.modelLoadedInModule===!1?(jn.debug("loading model landscape"),fetch("https://cdn.apizee.com/apiRTC/lib/tflite/models/selfie_segmentation_landscape.tflite").then(function(ln){if(!ln.ok)throw new Error("Failed to download tflite model!");jn.debug("loaded successfully");var Yt=kt._getModelBufferMemoryOffset();ln.arrayBuffer().then(function(dt){kt.HEAPU8.set(new Uint8Array(dt),Yt),kt._loadModel(dt.byteLength),jn.debug("module setup complete"),apiRTC.userAgentInstance.modelLoadedInModule=!0,apiRTC.userAgentInstance.tFLiteSIMDModule=kt,Ft(kt)})}).catch(function(ln){jn.error("Something went wrong during tflite model loading..",ln)})):(jn.debug("model landscape already loaded in module"),Ft(apiRTC.userAgentInstance.tFLiteSIMDModule))})}},{key:"onMaskFrameTimer",value:function(kt){kt.data.id===this.blurVariables.TIMEOUT_TICK&&this.renderMask()}},{key:"renderMask",value:function(){this.resizeSource(),this.runInference(),this.runPostProcessing(),this.blurVariables.maskFrameTimerWorker.postMessage({id:this.blurVariables.SET_TIMEOUT,timeMs:1e3/30})}},{key:"resizeSource",value:function(){this.blurVariables.segmentationMaskCtx.drawImage(this.blurVariables.inputVideoElement,0,0,this.blurVariables.inputVideoElement.width,this.blurVariables.inputVideoElement.height,0,0,this.blurVariables.width,this.blurVariables.height);for(var kt=this.blurVariables.segmentationMaskCtx.getImageData(0,0,this.blurVariables.width,this.blurVariables.height),Ft=this.blurVariables.tfliteModel._getInputMemoryOffset()/4,sn=0;sn<this.blurVariables.segmentationPixelCount;sn++)this.blurVariables.tfliteModel.HEAPF32[Ft+3*sn]=kt.data[4*sn]/255,this.blurVariables.tfliteModel.HEAPF32[Ft+3*sn+1]=kt.data[4*sn+1]/255,this.blurVariables.tfliteModel.HEAPF32[Ft+3*sn+2]=kt.data[4*sn+2]/255}},{key:"runInference",value:function(){this.blurVariables.tfliteModel._runInference();for(var kt=this.blurVariables.tfliteModel._getOutputMemoryOffset()/4,Ft=0;Ft<this.blurVariables.segmentationPixelCount;Ft++){var sn=this.blurVariables.tfliteModel.HEAPF32[kt+Ft];this.blurVariables.segmentationMask.data[4*Ft+3]=255*sn}this.blurVariables.segmentationMaskCtx.putImageData(this.blurVariables.segmentationMask,0,0)}},{key:"runPostProcessing",value:function(){var kt=this.blurVariables.firstVideoTrack.getSettings?this.blurVariables.firstVideoTrack.getSettings():this.blurVariables.firstVideoTrack.getConstraints(),Ft=kt.height,sn=kt.width;if(this.blurVariables.outputCanvasElement.height=Ft,this.blurVariables.outputCanvasElement.width=sn,this.blurVariables.outputCanvasCtx.globalCompositeOperation="copy",this.blurVariables.outputCanvasCtx.filter=this.blurVariables.virtualBackground==="image"?"blur(4px)":"blur(8px)",this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.segmentationMaskCanvas,0,0,this.blurVariables.width,this.blurVariables.height,0,0,this.blurVariables.inputVideoElement.width,this.blurVariables.inputVideoElement.height),this.blurVariables.outputCanvasCtx.globalCompositeOperation="source-in",this.blurVariables.outputCanvasCtx.filter="none",this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.inputVideoElement,0,0),this.blurVariables.outputCanvasCtx.globalCompositeOperation="destination-over",this.blurVariables.virtualBackground==="image")if(this.blurVariables.outputCanvasElement.width/this.blurVariables.outputCanvasElement.height===this.blurVariables.imageRatio)this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.virtualImage,0,0,this.blurVariables.virtualImage.width,this.blurVariables.virtualImage.height,0,0,this.blurVariables.outputCanvasElement.width,this.blurVariables.outputCanvasElement.height);else if(this.blurVariables.imageRatio>1){var ln=this.blurVariables.virtualImage.height*(this.blurVariables.outputCanvasElement.width/this.blurVariables.outputCanvasElement.height),Yt=this.blurVariables.virtualImage.height,dt=Math.abs(this.blurVariables.virtualImage.width-ln)/2;ln>this.blurVariables.virtualImage.width&&(ln=this.blurVariables.virtualImage.width,dt=0),this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.virtualImage,dt,0,ln,Yt,0,0,this.blurVariables.outputCanvasElement.width,this.blurVariables.outputCanvasElement.height)}else{var vt=this.blurVariables.virtualImage.width,Dt=this.blurVariables.virtualImage.width/(this.blurVariables.outputCanvasElement.width/this.blurVariables.outputCanvasElement.height),Vt=Math.abs(this.blurVariables.virtualImage.height-Dt)/2;Dt>this.blurVariables.virtualImage.height&&(Dt=this.blurVariables.virtualImage.height,Vt=0),this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.virtualImage,0,Vt,vt,Dt,0,0,this.blurVariables.outputCanvasElement.width,this.blurVariables.outputCanvasElement.height)}else this.blurVariables.outputCanvasCtx.filter="blur(15px)",this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.inputVideoElement,0,0)}},{key:"startSelfieSegmentation",value:function(){var kt=this;return new Promise(function(Ft,sn){jn.debug("startSelfieSegmentation"),kt.loadTFLiteModule().then(function(ln){kt.setupTFLiteModule(ln).then(function(Yt){if(kt.blurVariables.tfliteModel=Yt,kt.blurVariables.firstVideoTrack=kt.data.getVideoTracks()[0],kt.blurVariables.firstVideoTrack!==null&&kt.blurVariables.firstVideoTrack!==void 0){var dt=kt.blurVariables.firstVideoTrack.getSettings?kt.blurVariables.firstVideoTrack.getSettings():kt.blurVariables.firstVideoTrack.getConstraints(),vt=dt.height,Dt=dt.frameRate,Vt=dt.width;kt.blurVariables.height=144,kt.blurVariables.width=256,kt.blurVariables.frameRate=Dt,kt.blurVariables.segmentationPixelCount=kt.blurVariables.width*kt.blurVariables.height,kt.onMaskFrameTimer=kt.onMaskFrameTimer.bind(kt),kt.blurVariables.outputCanvasElement=document.createElement("canvas"),kt.blurVariables.outputCanvasElement.getContext("2d"),kt.blurVariables.inputVideoElement=document.createElement("video"),kt.blurVariables.SET_TIMEOUT=1,kt.blurVariables.CLEAR_TIMEOUT=2,kt.blurVariables.TIMEOUT_TICK=3,kt.blurVariables.maskFrameTimerWorker=new Worker(URL.createObjectURL(new Blob([`
                                        var timer;
                                        onmessage = function(request) {
                                            switch (request.data.id) {
                                            case `.concat(kt.blurVariables.SET_TIMEOUT,`: {
                                                timer = setTimeout(() => {
                                                    postMessage({ id: `).concat(kt.blurVariables.TIMEOUT_TICK,` });
                                                }, request.data.timeMs);
                                                break;
                                            }
                                            case `).concat(kt.blurVariables.CLEAR_TIMEOUT,`: {
                                                if (timer) {
                                                    clearTimeout(timer);
                                                }
                                                break;
                                            }
                                            }
                                        };
                                    `)],{type:"application/javascript"})),{name:"Blur effect worker"}),kt.blurVariables.maskFrameTimerWorker.onmessage=kt.onMaskFrameTimer,kt.blurVariables.segmentationMask=new ImageData(kt.blurVariables.width,kt.blurVariables.height),kt.blurVariables.segmentationMaskCanvas=document.createElement("canvas"),kt.blurVariables.segmentationMaskCanvas.width=kt.blurVariables.width,kt.blurVariables.segmentationMaskCanvas.height=kt.blurVariables.height,kt.blurVariables.segmentationMaskCtx=kt.blurVariables.segmentationMaskCanvas.getContext("2d"),kt.blurVariables.outputCanvasElement.width=parseInt(Vt,10),kt.blurVariables.outputCanvasElement.height=parseInt(vt,10),kt.blurVariables.outputCanvasCtx=kt.blurVariables.outputCanvasElement.getContext("2d"),kt.blurVariables.inputVideoElement.width=parseInt(Vt,10),kt.blurVariables.inputVideoElement.height=parseInt(vt,10),kt.blurVariables.inputVideoElement.autoplay=!0,kt.blurVariables.inputVideoElement.srcObject=kt.data,kt.blurVariables.inputVideoElement.onloadeddata=function(){kt.blurVariables.inputVideoElement.muted=!0,kt.blurVariables.maskFrameTimerWorker.postMessage({id:kt.blurVariables.SET_TIMEOUT,timeMs:1e3/30})},Ft(kt.blurVariables.outputCanvasElement.captureStream(parseInt(kt.blurVariables.frameRate,10)))}else sn("No video track on stream")}).catch(function(){return jn.error("Catch on setupTFLiteModule"),sn("Catch on setupTFLiteModule")})}).catch(function(){return jn.error("Catch on loadTFLiteModule"),sn("Catch on loadTFLiteModule")})})}},{key:"stopSelfieSegmentation",value:function(){jn.debug("stopSelfieSegmentation"),this.blurVariables.maskFrameTimerWorker.postMessage({id:this.blurVariables.CLEAR_TIMEOUT}),this.blurVariables.maskFrameTimerWorker.terminate()}},{key:"checkChildTypeConditions",value:function(){return this.childType!==void 0&&this.videoFilterIsApplied?"This stream is already a childStream : need to remove previous applied effect : "+this.childType:this.childrenTypeExists("blur")?"This stream already has a blur sub instance running : need to unblur()":this.childrenTypeExists("backgroundImage")?"This stream already has a backgroundImage sub instance running : need to unBackgroundImage()":MediaStreamTrack.prototype.hasOwnProperty("getSettings")&&MediaStreamTrack.prototype.hasOwnProperty("getConstraints")?"OK":"Navigator not compatible with this function"}},{key:"blur",value:function(){var kt=this;return new Promise(function(Ft,sn){var ln=kt.checkChildTypeConditions();if(ln!=="OK")return sn(ln);if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return sn("Navigator not compatible with this function");var Yt=kt;kt.blurVariables={},kt.blurVariables.virtualBackground="blur",kt.startSelfieSegmentation().then(function(dt){var vt,Dt=$o(Yt.data.getAudioTracks());try{for(Dt.s();!(vt=Dt.n()).done;){var Vt=vt.value;dt.addTrack(Vt.clone())}}catch(Qt){Dt.e(Qt)}finally{Dt.f()}var Gt={audioFilterIsApplied:kt.audioFilterIsApplied,audioAppliedFilter:kt.audioAppliedFilter,videoFilterIsApplied:kt.videoFilterIsApplied,videoAppliedFilter:kt.videoAppliedFilter,childType:kt.childType};Yt.createChildStreamFromStream(dt,"blur",Gt).then(function(Qt){return kt.addChildren(Qt,"blur"),Qt.applyMuteStatusFromParent(),Ft(Qt)}).catch(function(){return jn.error("Catch on createChildStreamFromStream blur"),sn("error on createChildStreamFromStream")})}).catch(function(dt){return jn.error("Catch on startSelfieSegmentation blur : ",dt),sn(dt)})})}},{key:"unblur",value:function(){var kt=this;return new Promise(function(Ft,sn){if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return sn("Navigator not compatible with this function");if(kt.childType==="blur"){jn.debug("This is the blurred stream : applying process with parent stream");var ln=kt.parent;return ln.stopSelfieSegmentation(),ln.releaseChildren("blur"),ln.removeChildren("blur"),Ft(ln)}return kt.childrenTypeExists("blur")?(jn.debug("This is the parent stream : applying process with this stream"),kt.stopSelfieSegmentation(),kt.releaseChildren("blur"),kt.removeChildren("blur"),Ft(kt)):(jn.debug("No blurred instance found for this stream"),sn("No blurred instance found for this stream"))})}},{key:"backgroundImage",value:function(kt){var Ft=this;return jn.debug("backgroundImage",kt),new Promise(function(sn,ln){var Yt=Ft.checkChildTypeConditions();if(Yt!=="OK")return ln(Yt);if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return ln("Navigator not compatible with this function");var dt=Ft;Ft.blurVariables={},Ft.blurVariables.virtualBackground="image",Ft.blurVariables.virtualImage=new Image,Ft.blurVariables.virtualImage.crossOrigin="anonymous",Ft.blurVariables.virtualImage.src=kt,Ft.blurVariables.virtualImage.onload=function(){Ft.blurVariables.imageRatio=Ft.blurVariables.virtualImage.width/Ft.blurVariables.virtualImage.height,Ft.startSelfieSegmentation().then(function(vt){var Dt,Vt=$o(dt.data.getAudioTracks());try{for(Vt.s();!(Dt=Vt.n()).done;){var Gt=Dt.value;vt.addTrack(Gt.clone())}}catch(Zt){Vt.e(Zt)}finally{Vt.f()}var Qt={audioFilterIsApplied:Ft.audioFilterIsApplied,audioAppliedFilter:Ft.audioAppliedFilter,videoFilterIsApplied:Ft.videoFilterIsApplied,videoAppliedFilter:Ft.videoAppliedFilter,childType:Ft.childType};dt.createChildStreamFromStream(vt,"backgroundImage",Qt).then(function(Zt){return Ft.addChildren(Zt,"backgroundImage"),Zt.applyMuteStatusFromParent(),sn(Zt)}).catch(function(){return jn.error("Catch on createChildStreamFromStream bck"),ln("error on createChildStreamFromStream")})}).catch(function(vt){return jn.error("Catch on startSelfieSegmentation bck : ",vt),ln(vt)})},Ft.blurVariables.virtualImage.onerror=function(){return jn.debug("Error on image loading"),ln("Error on image loading")}})}},{key:"unBackgroundImage",value:function(){var kt=this;return jn.debug("unBackgroundImage"),new Promise(function(Ft,sn){if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return sn("Navigator not compatible with this function");if(kt.childType==="backgroundImage"){jn.debug("This is the backgroundImage stream : applying process with parent stream");var ln=kt.parent;return ln.stopSelfieSegmentation(),ln.releaseChildren("backgroundImage"),ln.removeChildren("backgroundImage"),Ft(ln)}return kt.childrenTypeExists("backgroundImage")?(jn.debug("This is the parent stream : applying process with this stream"),kt.stopSelfieSegmentation(),kt.releaseChildren("backgroundImage"),kt.removeChildren("backgroundImage"),Ft(kt)):(jn.debug("No background image instance found for this stream"),sn("No background image instance found for this stream"))})}},{key:"applyVideoProcessor",value:function(kt,Ft){var sn=this;return new Promise(function(ln,Yt){if(kt!=="none"&&kt!=="blur"&&kt!=="backgroundImage")return Yt(new Gr("Requested videoProcessorType is not correct","none",sn));var dt=sn,vt="none",Dt=null,Vt=sn,Gt=!1;if(sn.childType==="noiseReduction"&&sn.videoFilterIsApplied===!0&&(jn.debug("This is a noised reduced stream ... applying filter on parent"),Vt=sn.parent,sn.release({releaseParentStream:!1}),Gt=!0),Vt.childType!==void 0&&Vt.videoFilterIsApplied===!0&&(Vt.childType==="blur"?vt="blur":Vt.childType==="backgroundImage"&&(vt="backgroundImage"),dt=Vt.parent,Dt=Vt),Vt.childrenTypeExists("blur")&&(vt="blur",Vt.childrens.forEach(function(an){Dt=an})),Vt.childrenTypeExists("backgroundImage")&&(vt="backgroundImage",Vt.childrens.forEach(function(an){Dt=an})),jn.debug("actual applied effect =",vt),kt==="none"&&vt==="none")return Yt(new Gr("Requested videoProcessorType none and no effect applied","none",dt));if(kt==="none"&&vt==="blur")jn.debug("need to unblur"),dt.unblur().then(function(an){if(Gt!==!0)return ln(an);an.startNoiseReduction().then(function(Cn){return ln(Cn)}).catch(function(Cn){return jn.error("Catch on startNoiseReduction :",Cn),Yt(new Wo(Cn,an.audioAppliedFilter,dt))})}).catch(function(an){return jn.error("Catch on unblur: ",an),Yt(new Gr(an,"none",dt))});else if(kt==="none"&&vt==="backgroundImage")jn.debug("need to unBackgroundImage"),dt.unBackgroundImage().then(function(an){if(Gt!==!0)return ln(an);an.startNoiseReduction().then(function(Cn){return ln(Cn)}).catch(function(Cn){return jn.error("Catch on startNoiseReduction :",Cn),Yt(new Wo(Cn,an.audioAppliedFilter,dt))})}).catch(function(an){return jn.error("Catch on unBackgroundImage :",an),Yt(new Gr(an,"none",dt))});else if(kt==="blur"&&vt==="none")jn.debug("need to blur"),dt.blur().then(function(an){if(Gt!==!0)return ln(an);an.startNoiseReduction().then(function(Cn){return ln(Cn)}).catch(function(Cn){return jn.error("Catch on startNoiseReduction :",Cn),Yt(new Wo(Cn,an.audioAppliedFilter,dt))})}).catch(function(an){return jn.error("Catch on blur :",an),Yt(new Gr(an,"none",dt))});else{if(kt==="blur"&&vt==="blur")return Yt(new Gr("Requested videoProcessorType blur and blur already applied","blur",Dt));if(kt==="blur"&&vt==="backgroundImage"){jn.debug("need to unBackgroundImage then blur");var Qt=dt.blurVariables.virtualImage.src;dt.unBackgroundImage().then(function(an){an.blur().then(function(Cn){if(Gt!==!0)return ln(Cn);Cn.startNoiseReduction().then(function(Rn){return ln(Rn)}).catch(function(Rn){return jn.error("Catch on startNoiseReduction :",Rn),Yt(new Wo(Rn,Cn.audioAppliedFilter,dt))})}).catch(function(Cn){jn.warn("Catch on blur - unBackgroundImage to blur :",Cn),jn.debug("Reactivating previous effect : backgroundImage"),dt.backgroundImage(Qt).then(function(Rn){if(jn.warn("Could not apply blur effect, background restored"),Gt!==!0)return Yt(new Gr("Could not apply blur effect, background restored","backgroundImage",Rn));Rn.startNoiseReduction().then(function(Kn){return Yt(new Gr("Could not apply blur effect, background restored","backgroundImage",Kn))}).catch(function(Kn){return jn.error("Catch on startNoiseReduction :",Kn),Yt(new Gr("Could not apply blur effect, background restored","backgroundImage",Rn))})}).catch(function(Rn){return jn.error("Could not apply blur effect and error in restoring background :",Rn),Yt(new Gr("Could not apply blur effect and error in restoring background","none",dt))})})}).catch(function(an){return jn.error("Catch on unBackgroundImage :",an),Yt(new Gr(an,"none",dt))})}else if(kt==="backgroundImage"&&vt==="none"){if(jn.debug("need to backgroundImage"),Ft===void 0||Ft.backgroundImageUrl===void 0)return Yt(new Gr("Error options.backgroundImageUrl is not defined","none",dt));dt.backgroundImage(Ft.backgroundImageUrl).then(function(an){if(Gt!==!0)return ln(an);an.startNoiseReduction().then(function(Cn){return ln(Cn)}).catch(function(Cn){return jn.error("Catch on startNoiseReduction :",Cn),Yt(new Gr("Could not apply blur effect, background restored","backgroundImage",an))})}).catch(function(an){return jn.error("Catch on backgroundImage :",an),Yt(new Gr(an,"none",dt))})}else if(kt==="backgroundImage"&&vt==="blur")jn.debug("need to unblur then backgroundImage"),dt.unblur().then(function(an){an.backgroundImage(Ft.backgroundImageUrl).then(function(Cn){if(Gt!==!0)return ln(Cn);Cn.startNoiseReduction().then(function(Rn){return ln(Rn)}).catch(function(Rn){return jn.error("Catch on startNoiseReduction :",Rn),Yt(new Gr("Could not apply blur effect, background restored","backgroundImage",Cn))})}).catch(function(Cn){jn.warn("Catch on backgroundImage - unBackgroundImage to blur :",Cn),jn.debug("Reactivating previous effect : blur"),dt.blur().then(function(Rn){if(Gt!==!0)return jn.warn("Could not apply background effect, blur restored"),Yt(new Gr("Could not apply background effect, blur restored","blur",Rn));Rn.startNoiseReduction().then(function(Kn){return Yt(new Gr("Could not apply background effect, blur restored","blur",Kn))}).catch(function(Kn){return jn.error("Catch on startNoiseReduction :",Kn),Yt(new Gr("Could not apply background effect, blur restored","blur",Rn))})}).catch(function(Rn){return jn.error("Could not apply background effect and error in restoring blur :",Rn),Yt(new Gr("Could not apply background effect and error in restoring blur","none",dt))})})}).catch(function(an){return jn.error("Catch on unblur :",an),Yt(new Gr(an,"none",dt))});else if(kt==="backgroundImage"&&vt==="backgroundImage"){var Zt=dt.blurVariables.virtualImage.src;if(Ft.backgroundImageUrl.startsWith("data:image")===!1&&Zt.substring(Zt.lastIndexOf("/")+1)===Ft.backgroundImageUrl.substring(Ft.backgroundImageUrl.lastIndexOf("/")+1))return jn.debug("Same background image is already applied"),Yt(new Gr("Requested videoProcessorType backgroundImage and backgroundImage with the same image already applied","backgroundImage",Dt));jn.debug("New background image is to be applied"),dt.unBackgroundImage().then(function(an){an.backgroundImage(Ft.backgroundImageUrl).then(function(Cn){if(Gt!==!0)return ln(Cn);Cn.startNoiseReduction().then(function(Rn){return ln(Rn)}).catch(function(Rn){return jn.error("Catch on startNoiseReduction :",Rn),Yt(new Gr("Could not apply background effect, blur restored","blur",Cn))})}).catch(function(Cn){jn.warn("Catch on backgroundImage - change background image :",Cn),jn.debug("Reactivating previous effect : backgroundImage"),dt.backgroundImage(Zt).then(function(Rn){if(Gt!==!0)return Yt(new Gr("Could not apply new image on background, former background restored","backgroundImage",Rn));Rn.startNoiseReduction().then(function(Kn){return jn.warn("Could not apply new image on background, former background restored"),Yt(new Gr("Could not apply new image on background, former background restored","backgroundImage",Kn))}).catch(function(Kn){return jn.error("Catch on startNoiseReduction :",Kn),Yt(new Gr("Could not apply background effect, blur restored","blur",Rn))})}).catch(function(Rn){return jn.error("Could not apply new image on background and error in restoring former background :",Rn),Yt(new Gr("Could not apply new image on background and error in restoring former background","none",dt))})})}).catch(function(an){return jn.error("Catch on unBackgroundImage :",an),Yt(new Gr(an,"none",dt))})}}})}},{key:"checkAudioProcessorType",value:function(kt){return kt!=="none"&&kt!=="noiseReduction"?"Requested audioProcessorType is not correct":kt==="none"&&this.audioAppliedFilter!=="noiseReduction"?"Not a noised reduction stream":"OK"}},{key:"applyAudioProcessor",value:function(kt){var Ft=this;return new Promise(function(sn,ln){var Yt=Ft,dt="none",vt="none",Dt=Ft.checkAudioProcessorType(kt);if(Dt!=="OK")return ln(new Wo(Dt,Ft.audioAppliedFilter,Ft));if(kt==="none"){if(Ft.childType!=="noiseReduction"&&Ft.parent.childType==="noiseReduction"?(jn.debug("applying process on parent stream as this one must be a video effect stream"),Yt=Ft.parent,dt=Ft.childType,Ft.parent.blurVariables!==void 0&&Ft.parent.blurVariables.virtualImage!==void 0&&(vt=Ft.parent.blurVariables.virtualImage.src),Ft.release({releaseParentStream:!1})):jn.debug("no noiseReduction applied"),Yt.stopNoiseReduction(),dt==="none"){jn.debug("Release noiseReduction stream");var Vt=Ft.parent;return Yt.release({releaseParentStream:!1}),sn(Vt)}var Gt={backgroundImageUrl:vt};Yt.parent.applyVideoProcessor(dt,Gt).then(function(Qt){return jn.debug("Release noiseReduction stream"),Yt.release({releaseParentStream:!1}),sn(Qt)}).catch(function(Qt){return jn.error("Catch on applyVideoProcessor() - reapply effect : ",Qt),ln(new Wo("Error on restoring applied video filter",this.audioAppliedFilter,this))})}else kt==="noiseReduction"&&Yt.startNoiseReduction().then(function(Qt){return sn(Qt)}).catch(function(Qt){return jn.error("Catch on startNoiseReduction :",Qt),ln(new Wo(Qt,Yt.audioAppliedFilter,Yt))})})}},{key:"startNoiseReduction",value:function(){return apiCC.audioProcessor.startNoiseReduction(this)}},{key:"stopNoiseReduction",value:function(){apiCC.audioProcessor.stopAudioNodeCtx(this.parent.nodeCtx)}},{key:"createMediaStreamTrackProcessor",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(jn.debug("mediaStreamTrackProcessor kind: ".concat(kt?"audio":"video"," created")),kt){var Ft=this.data.getAudioTracks();if(Ft.length)return new MediaStreamTrackProcessor({track:Ft[0]});throw new Error("No audio tracks found")}var sn=this.data.getVideoTracks();if(sn.length)return new MediaStreamTrackProcessor({track:sn[0]});throw new Error("No video tracks found")}},{key:"createMediaStreamTrackGenerator",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return jn.debug("mediaStreamTrackGenerator kind: ".concat(kt?"audio":"video"," created")),kt?new MediaStreamTrackGenerator({kind:"audio"}):new MediaStreamTrackGenerator({kind:"video"})}},{key:"loadSegmentationAPI",value:function(){return new Promise(function(kt,Ft){var sn={async:!0,numRetries:20,reqdelay:200,success:function(){jn.debug("Segmentation API loaded"),mergeReality.then(kt)},error:function(ln){Ft("Resources loading failed, depsNotFound: "+ln)},retrycb:function(ln,Yt){jn.warn("Blur API model loading retry :"+ln+" ,delay before retry :"+Yt)}};apiCC.resourcesLoader.loadjs(["https://cdn.apizee.com/apiRTC/lib/mergereality/v1.0/merge_reality.js"],"merge-reality",sn)})}},{key:"startMergeReality",value:function(kt){var Ft=this;this.mergeRealityData={},this.mergeRealityLib=kt,this.mergeRealityData.stop=!1,this.mergeRealityData.WIDTH=this.getSettings().width,this.mergeRealityData.HEIGHT=this.getSettings().height,this.mergeRealityData.WEBCAM_CANVAS=new OffscreenCanvas(this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.WEBCAM_CTX=this.mergeRealityData.WEBCAM_CANVAS.getContext("2d",{alpha:!1}),this.mergeRealityData.MASK_CANVAS=new OffscreenCanvas(this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.MASK_CTX=this.mergeRealityData.MASK_CANVAS.getContext("2d",{alpha:!0}),this.mergeRealityData.SCREEN_VIDEO=document.createElement("video"),this.mergeRealityData.BG_SUB=new this.mergeRealityLib.BackgroundSubtractor,this.mergeRealityData.background=new this.mergeRealityLib.BackgroundImage(this.mergeRealityData.WEBCAM_CTX.getImageData(0,0,this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.MSTP=this.createMediaStreamTrackProcessor().readable,this.mergeRealityData.MSTG=this.createMediaStreamTrackGenerator(),this.mergeRealityData.SINK=this.mergeRealityData.MSTG.writable,this.mergeRealityData.MASK_TRANSFORMER=new TransformStream({transform:function(sn,ln){Ft.mergeRealityData.stop||(Ft.mergeRealityData.MASK_CTX.save(),Ft.mergeRealityData.MASK_CTX.clearRect(0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.WEBCAM_CTX.clearRect(0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.WEBCAM_CTX.drawImage(sn,0,0),Ft.mergeRealityData.MASK_DATA=Ft.mergeRealityData.BG_SUB.computeMask(Ft.mergeRealityData.WEBCAM_CTX.getImageData(0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.background),Ft.mergeRealityData.RES=Ft.mergeRealityData.BG_SUB.applyTransparency(Ft.mergeRealityData.WEBCAM_CTX.getImageData(0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.MASK_DATA),Ft.mergeRealityData.MASK_CTX.putImageData(Ft.mergeRealityData.RES,0,0),Ft.mergeRealityData.MASK_CTX.globalCompositeOperation="destination-atop",Ft.mergeRealityData.MASK_CTX.drawImage(Ft.mergeRealityData.SCREEN_VIDEO,0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.MASK_CTX.restore(),ln.enqueue(new VideoFrame(Ft.mergeRealityData.MASK_CANVAS))),sn.close()}}),this.mergeRealityData.RES_MS=new MediaStream}},{key:"stopMergeReality",value:function(){this.mergeRealityData.stop=!0}},{key:"calibrateBackground",value:function(){this.childrenTypeExists("merge")?this.mergeRealityData.background=new this.mergeRealityLib.BackgroundImage(this.mergeRealityData.WEBCAM_CTX.getImageData(0,0,this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT):jn.error("No merged instance found for this stream")}},{key:"mergeReality",value:function(kt){var Ft=this;return new Promise(function(sn,ln){return window.MediaStreamTrackGenerator===void 0||window.MediaStreamTrackProcessor===void 0||window.TransformStream===void 0?ln("Your browser does not support InsertableStreams"):Ft.childrenTypeExists("merge")?ln("This stream already has a sub instance running for this"):void Ft.loadSegmentationAPI().then(function(Yt){Ft.startMergeReality(Yt),kt.attachToElement(Ft.mergeRealityData.SCREEN_VIDEO),Ft.mergeRealityData.SCREEN_VIDEO.autoplay=!0,Ft.mergeRealityData.MSTP.pipeThrough(Ft.mergeRealityData.MASK_TRANSFORMER).pipeTo(Ft.mergeRealityData.SINK),Ft.mergeRealityData.RES_MS.addTrack(Ft.mergeRealityData.MSTG);var dt,vt=$o(Ft.data.getAudioTracks());try{for(vt.s();!(dt=vt.n()).done;){var Dt=dt.value;Ft.mergeRealityData.RES_MS.addTrack(Dt)}}catch(Qt){vt.e(Qt)}finally{vt.f()}var Vt=Ft,Gt={audioFilterIsApplied:Ft.audioFilterIsApplied,audioAppliedFilter:Ft.audioAppliedFilter,videoFilterIsApplied:Ft.videoFilterIsApplied,videoAppliedFilter:Ft.videoAppliedFilter,childType:Ft.childType};Ft.createChildStreamFromStream(Ft.mergeRealityData.RES_MS,"merge",Gt).then(function(Qt){Vt.addChildren(Qt,"merge"),Qt.applyMuteStatusFromParent(),sn(Qt)}).catch(function(){jn.error("Catch on createChildStreamFromStream mergeReality")})})})}},{key:"unmergeReality",value:function(){this.childrenTypeExists("merge")?(this.stopMergeReality(),this.releaseChildren("merge"),this.removeChildren("merge")):jn.error("No merged instance found for this stream")}},{key:"addPendingPromise",value:function(kt,Ft,sn){var ln=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5e3;return apiCC.addPendingPromise(kt,Ft,sn,ln)}},{key:"resolvePendingPromise",value:function(kt,Ft){apiCC.resolvePendingPromise(kt,Ft)}},{key:"rejectPendingPromise",value:function(kt,Ft){apiCC.rejectPendingPromise(kt,Ft)}},{key:"sendAudioFlowStatusChanged",value:function(){var kt=this.getAudioFlowStatus();tn.get(this).emit("audioFlowStatusChanged",kt)}},{key:"sendVideoFlowStatusChanged",value:function(){var kt=this.getVideoFlowStatus();tn.get(this).emit("videoFlowStatusChanged",kt)}},{key:"sendFlowStatusChanged",value:function(kt){var Ft;kt==="audio"?Ft=this.getAudioFlowStatus():kt==="video"&&(Ft=this.getVideoFlowStatus()),Ft.type=kt,tn.get(this).emit("flowStatusChanged",Ft)}},{key:"sendFlowStatusChangedForRemote",value:function(kt,Ft){Ft.type=kt,tn.get(this).emit("flowStatusChanged",Ft)}},{key:"sendRemoteAudioFlowStatusChanged",value:function(kt){tn.get(this).emit("remoteAudioFlowStatusChanged",kt)}},{key:"sendRemoteVideoFlowStatusChanged",value:function(kt){tn.get(this).emit("remoteVideoFlowStatusChanged",kt)}},{key:"emitConstraintsChanged",value:function(kt){tn.get(this).emit("constraintsChanged",kt)}}],[{key:"getAvailableEvents",value:function(){return cm}},{key:"createStreamFromUserMedia",value:function(kt,Ft,sn){var ln=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return jn.debug("createStreamFromUserMedia"),jn.debug("audioInput :",kt),jn.debug("videoInput :",Ft),jn.debug("constraints :",sn),jn.debug("options :",ln),new Promise(function(Yt,dt){var vt=kt!==!1&&(kt!==null||sn===void 0||sn!==void 0&&sn.hasOwnProperty("audio")),Dt=Ft!==!1&&(Ft!==null||sn===void 0||sn!==void 0&&sn.hasOwnProperty("video")),Vt={type:et.g.STREAM_TYPE_NO_INPUT,audioInput:kt,videoInput:Ft},Gt="media";Dt?Vt.type=et.g.STREAM_TYPE_VIDEO:vt&&(Vt.type=et.g.STREAM_TYPE_AUDIO),vt&&!Dt?Gt="audio":!vt&&Dt&&(Gt="videoOnly"),vt&&ln.enhancedAudioActivated===!0&&(jn.debug("Enhanced Audio is activated"),apiRTC.browser!=="Chrome"?jn.debug("enhancedAudioActivated option is only available for Chrome"):(sn===void 0&&(sn={}),sn.audio&&ss(sn.audio)==="object"||(sn.audio={}),sn.video===void 0&&(sn.video={}),sn.audio.echoCancellation=!1,sn.audio.autoGainControl=!1,sn.audio.noiseSuppression=!1)),apiRTC.createUserMediaStream({audioSourceId:kt,videoSourceId:Ft,facingMode:ln.facingMode,gum_config:sn,filters:ln.filters,type:Gt,success:function(Qt){jn.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+Qt.userMediaStreamId),Vt.constructor=!0,Vt.userMediaStreamId=Qt.userMediaStreamId,Yt(new Xt(Qt.stream,Vt))},failure:function(Qt,Zt){jn.debug("[createStreamFromUserMedia] failure :",Zt),dt(Zt)}})})}},{key:"createStreamFromMediaStream",value:function(kt){return jn.debug("createStreamFromMediaStream"),new Promise(function(Ft,sn){var ln={};ln.type=et.g.STREAM_TYPE_NO_INPUT,kt.getAudioTracks().length>0&&(ln.type=et.g.STREAM_TYPE_AUDIO),kt.getVideoTracks().length>0&&(ln.type=et.g.STREAM_TYPE_VIDEO),apiRTC.createUserMediaStream({type:"media",stream:kt,success:function(Yt){jn.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+Yt.userMediaStreamId),ln.constructor=!0,ln.userMediaStreamId=Yt.userMediaStreamId,Ft(new Xt(Yt.stream,ln))},failure:function(Yt,dt){jn.debug("[createStreamFromUserMedia] failure :",dt),sn()}})})}},{key:"createScreensharingStream",value:function(kt){return new Promise(function(Ft,sn){apiRTC.createUserMediaStream({type:"screenSharing",captureSourceType:kt,success:function(ln){jn.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+ln.userMediaStreamId);var Yt=new Xt(ln.stream,{constructor:!0,type:et.g.STREAM_TYPE_VIDEO,userMediaStreamId:ln.userMediaStreamId});Js.set(Yt,!0),Ft(Yt)},failure:function(ln,Yt){jn.debug("[createStreamFromUserMedia] failure :",Yt),sn(Yt)}})})}},{key:"createDisplayMediaStream",value:function(kt,Ft){return new Promise(function(sn,ln){apiRTC.createUserMediaStream({type:"screenSharing",captureSourceType:kt,displayMediaStreamConstraints:kt,forceExtensionOnChrome:Ft,success:function(Yt){jn.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+Yt.userMediaStreamId);var dt=new Xt(Yt.stream,{constructor:!0,type:et.g.STREAM_TYPE_VIDEO,userMediaStreamId:Yt.userMediaStreamId});Js.set(dt,!0),sn(dt)},failure:function(Yt,dt){jn.debug("[createStreamFromUserMedia] failure :",dt),ln(dt)}})})}},{key:"getLocalStreams",value:function(){return yo.values()}},{key:"getStream",value:function(kt){return kt!=null&&yo.has(kt.toString())?yo.get(kt.toString()):null}}]),Xt}(fn),dm=function(jt){qs(Xt,jt);var Ut=Ks(Xt);function Xt(kt,Ft,sn,ln){var Yt;return Hs(this,Xt),(Yt=Ut.call(this,kt,Ft)).parent=sn,Yt.childType=ln,ln==="noiseReduction"&&(Yt.audioFilterIsApplied=!0,Yt.audioAppliedFilter=ln),ln!=="blur"&&ln!=="backgroundImage"||(Yt.videoFilterIsApplied=!0,Yt.videoAppliedFilter=ln),Yt}return Gs(Xt,[{key:"release",value:function(kt){this.childType!=="blur"&&this.childType!=="backgroundImage"||this.parent.stopSelfieSegmentation(),this.parent.removeChildren(this.childType),this.clonedStream!==void 0&&(jn.debug("to be released ..."),this.clonedStream.getAudioTracks().forEach(function(Ft){Ft.stop()}),this.clonedStream.getVideoTracks().forEach(function(Ft){Ft.stop()})),ou(Fo(Xt.prototype),"release",this).call(this,kt)}}]),Xt}(so),Gr=function(jt){qs(Xt,jt);var Ut=Ks(Xt);function Xt(kt,Ft,sn){var ln;return Hs(this,Xt),(ln=Ut.call(this,kt)).name=ln.constructor.name,ln.appliedVideoProcessorType=Ft,ln.stream=sn,ln}return Gs(Xt)}(zs(Error)),Wo=function(jt){qs(Xt,jt);var Ut=Ks(Xt);function Xt(kt,Ft,sn){var ln;return Hs(this,Xt),(ln=Ut.call(this,kt)).name=ln.constructor.name,ln.appliedAudioProcessorType=Ft,ln.stream=sn,ln}return Gs(Xt)}(zs(Error));function Ys(jt,Ut){var Xt=typeof Symbol<"u"&&jt[Symbol.iterator]||jt["@@iterator"];if(!Xt){if(Array.isArray(jt)||(Xt=function(dt,vt){if(dt){if(typeof dt=="string")return tp(dt,vt);var Dt=Object.prototype.toString.call(dt).slice(8,-1);return Dt==="Object"&&dt.constructor&&(Dt=dt.constructor.name),Dt==="Map"||Dt==="Set"?Array.from(dt):Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt)?tp(dt,vt):void 0}}(jt))||Ut&&jt&&typeof jt.length=="number"){Xt&&(jt=Xt);var kt=0,Ft=function(){};return{s:Ft,n:function(){return kt>=jt.length?{done:!0}:{done:!1,value:jt[kt++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Yt=!1;return{s:function(){Xt=Xt.call(jt)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Yt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Yt)throw sn}}}}function tp(jt,Ut){(Ut==null||Ut>jt.length)&&(Ut=jt.length);for(var Xt=0,kt=new Array(Ut);Xt<Ut;Xt++)kt[Xt]=jt[Xt];return kt}function np(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}var fo=mt.Y.get("Session"),um=An.get(),_o=new(Go()),cu=Ro.get(),du=po.get(),pm=Symbol("ENTERPRISE_NOT_LOADED"),uu=Symbol("ENTERPRISE_LOADED"),rp=new WeakMap,ip=new WeakMap,ap=new WeakMap,Xs=function(){function jt(Ft,sn,ln){if(function(Yt,dt){if(!(Yt instanceof dt))throw new TypeError("Cannot call a class as a function")}(this,jt),fo.info("Create Enterprise"),!(ln instanceof Br))throw"Cannot create Enterprise without a session";rp.set(this,ln),ap.set(this,sn),ip.set(this,Ft),this.status=pm}var Ut,Xt,kt;return Ut=jt,Xt=[{key:"getSession",value:function(){return rp.get(this)}},{key:"getId",value:function(){return ip.get(this).toString()}},{key:"getApiKey",value:function(){return ap.get(this).toString()}},{key:"load",value:function(){var Ft=this;return new Promise(function(sn,ln){_o.getEnterpriseUserList(Ft.getId(),Ft.getSession().getToken()).then(function(Yt){fo.info("Enterprise loaded!",Yt);var dt,vt=Ys(Yt.users);try{for(vt.s();!(dt=vt.n()).done;){var Dt=dt.value;if(Ft.getSession().user.userId.toString()!==Dt.id.toString()){var Vt=cu.getOrCreateContact(Dt.id);Vt.profile=Dt,Vt.enterprise=Ft,Vt.userData.get("username")===null&&Vt.userData.setProp("username",Dt.username),Vt.userData.get("photo_url")===null&&Vt.userData.setProp("photo_url",Dt.photo_url)}}}catch(Gt){vt.e(Gt)}finally{vt.f()}Ft.status=uu,sn()}).catch(function(Yt){var dt="load() - Enterprise load error",vt={error:new Error(dt),code:et.g.ERROR_OTHER};Yt.hasOwnProperty("code")?vt.code=Yt.code:Yt.hasOwnProperty("http_code")&&(Yt.http_code.toString().startsWith("4")?vt.code=et.g.ERROR_INVALID_CREDENTIALS:vt.code=et.g.ERROR_SERVER_UNAVAILABLE),fo.error(dt,Yt),ln(vt)})})}},{key:"getContacts",value:function(){var Ft={};if(this.status!==uu)fo.error("Enterprise is not loaded, unable to getContacts");else{var sn,ln=cu.getContacts(),Yt=Ys(ln.keys());try{for(Yt.s();!(sn=Yt.n()).done;){var dt=sn.value,vt=ln.get(dt);vt.enterprise!==null&&vt.enterprise.id.toString()===this.getId()&&(Ft[vt.getId()]=vt)}}catch(Dt){Yt.e(Dt)}finally{Yt.f()}}return Ft}},{key:"getConfiguration",value:function(){return null}},{key:"uploadFile",value:function(Ft){var sn=this,ln=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Yt,dt){fo.info("uploadFile()"),sn.status===uu?_o.uploadFile(Ft,sn.getSession().getToken(),ln).then(function(vt){Yt(vt.url)}).catch(function(vt){fo.error(vt),dt(vt)}):(fo.error("Enterprise is not loaded, cannot upload file"),dt(new Error("Enterprise is not loaded, cannot upload file")))})}},{key:"getAvailableConferences",value:function(){var Ft=this;return fo.info("getAvailableConferences()"),new Promise(function(sn,ln){var Yt={};_o.getConferenceList(Ft.getSession().getToken()).then(function(dt){var vt,Dt=Ys(dt);try{for(Dt.s();!(vt=Dt.n()).done;){var Vt=vt.value;Yt[Vt.hash]=du.getOrCreateConference(Vt.hash),Yt[Vt.hash].friendlyName=Vt.friendlyName}}catch(Gt){Dt.e(Gt)}finally{Dt.f()}sn(Yt)}).catch(function(dt){fo.error(dt),ln(dt)})})}},{key:"getConference",value:function(Ft){var sn=this;return new Promise(function(ln,Yt){var dt={};dt.token=sn.getSession().getToken(),_o.getWebconf(Ft,dt).then(function(vt){return ln(du.getOrCreateConference(vt.hash))}).catch(function(vt){return fo.error("getConference",vt),Yt(vt)})})}},{key:"createPrivateConference",value:function(){var Ft=this,sn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return fo.info("createPrivateConference()"),new Promise(function(ln,Yt){var dt=sn.hasOwnProperty("friendlyName")?sn.friendlyName:Bt.g.guid(),vt=null,Dt=Ft.getSession().getToken();_o.createConference(Dt,dt,sn).then(function(Vt){(vt=du.getOrCreateConference(Vt.hash)).friendlyName=dt;var Gt=sn.hasOwnProperty("password")?sn.password:"";return vt.join({password:Gt,session:Ft.getSession()})}).then(function(){ln(vt)}).catch(function(Vt){var Gt="createPrivateConference() - Could not create conference";fo.error(Gt,Vt),Yt(new Error(Gt))})})}},{key:"getTags",value:function(Ft){var sn=this;return new Promise(function(ln,Yt){var dt={};Ft&&Ft.hasOwnProperty("webconfId")&&(dt.webconfId=Ft.webconfId),_o.getEnterpriseTagList(sn.getId(),sn.getSession().getToken(),dt).then(function(vt){return vt.hasOwnProperty("tags")&&Array.isArray(vt.tags)?ln(vt.tags):Yt(Bt.g.createError(et.g.ERROR_OTHER,"getTags() - unexpected response",fo))}).catch(function(vt){return Yt(Bt.g.createError(et.g.ERROR_OTHER,"getTags() - cannot get tags",fo,{fromError:vt}))})})}}],kt=[{key:"fetchEnterpriseInformation",value:function(Ft){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return sn.hasOwnProperty("cloudUrl")&&_o.setCloudURL(sn.cloudUrl),_o.getEnterpriseInformation(sn,Ft)}},{key:"fetchSiteAgents",value:function(Ft){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(ln,Yt){sn.hasOwnProperty("cloudUrl")&&_o.setCloudURL(sn.cloudUrl);var dt=[];_o.getSiteAgents(um.getActiveApiKey(),Ft,sn).then(function(vt){var Dt,Vt=Ys(vt);try{for(Vt.s();!(Dt=Vt.n()).done;){var Gt=Dt.value;dt.push({contact:cu.getOrCreateContact(Gt.id),title:Gt.title,nickname:Gt.nickname,isPrefered:Gt.isPrefered})}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}ln(dt)}).catch(function(vt){Yt(Bt.g.createError(et.g.ERROR_OTHER,"fetchSiteAgents() - could not fetch site agents",fo))})})}}],Xt&&np(Ut.prototype,Xt),kt&&np(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}();function pu(jt){return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},pu(jt)}function hm(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}function op(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}function hu(jt,Ut){return hu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,kt){return Xt.__proto__=kt,Xt},hu(jt,Ut)}function fm(jt,Ut){if(Ut&&(pu(Ut)==="object"||typeof Ut=="function"))return Ut;if(Ut!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bo(jt)}function Bo(jt){if(jt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return jt}function Qs(jt){return Qs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Ut){return Ut.__proto__||Object.getPrototypeOf(Ut)},Qs(jt)}s(3123);var mr=mt.Y.get("UserAgent"),Cr=An.get(),Oo=new(Go()),mm="apizee:",gm="apirtc:",vm="token:",Cm="apzkey:",bm="apiKey:",us=new WeakMap,ym=["mediaDeviceChanged","externalJsLoadingStatus","ccsConnectionStatus","userMediaError"],sp=function(jt){(function(dt,vt){if(typeof vt!="function"&&vt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(vt&&vt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),vt&&hu(dt,vt)})(Yt,jt);var Ut,Xt,kt,Ft,sn,ln=(Ft=Yt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,vt=Qs(Ft);if(sn){var Dt=Qs(this).constructor;dt=Reflect.construct(vt,arguments,Dt)}else dt=vt.apply(this,arguments);return fm(this,dt)});function Yt(){var dt,vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hm(this,Yt),dt=ln.call(this,mr),mr.debug("Create UserAgent"),dt.uri=vt.hasOwnProperty("uri")?vt.uri:null,dt.userId=null,dt.username=null,dt.profile=null,dt.preRegisterUserData=new Io,dt.callStatsMonitoringEnabled=null,dt.callStatsMonitoringInterval=null,dt.meshModeEnabled=null,dt.apiRTCMediaDeviceDetectionEnabled=!!vt.hasOwnProperty("apiRTCMediaDeviceDetectionEnabled")&&vt.apiRTCMediaDeviceDetectionEnabled,dt.apiRTCMediaDeviceDetectionDelay=vt.hasOwnProperty("apiRTCMediaDeviceDetectionDelay")?vt.apiRTCMediaDeviceDetectionDelay:et.g.APIRTC_MEDIA_DEVICE_DETECTION_DELAY,dt.targetBandwidthUsage=0,dt.videoBandwidthSettings={overallIncoming:3e3,overallOutgoing:3e3},dt.currentSession=null,dt.enterprise=null,dt.capabilities={whiteboardCursor:"ON",mediaDeviceChanged:"ON",webRTCCompliant:"ON",screenSharingCompliant:"ON",qoSStatCompliant:"ON",backgroundRemoval:"ON",streamCapabilities:"ON",noiseReduction:"ON",remoteAccessUser:"ON"},dt.browser=apiRTC.browser,dt.browser_major_version=apiRTC.browser_major_version,dt.browser_version=apiRTC.browser_version,dt.osName=apiRTC.osName,dt.osVersion=apiRTC.osVersion,dt.browserInfo=apiRTC.browserInfo,dt.browserDetails=apiRTC.browserDetails,dt.tFLiteModuleLoaded=!1,dt.tFLiteSIMDModule=null,dt.modelLoadedInModule=!1,dt.apiRTCStreamsList=new Map,us.set(Bo(dt),null),Cr.createWhiteBoard(),apiCC.activateScreenSharing();var Dt=function(Zt){tn.get(Bo(dt)).emit("mediaDeviceChanged",{added:Zt.detail.diff.added,removed:Zt.detail.diff.removed,updated:Zt.detail.diff.updated,updateReason:Zt.detail.updateReason,firstMediaDeviceListInitialization:Zt.detail.firstMediaDeviceListInitialization})};apiRTC.addEventListener("mediaDeviceChanged",Dt,"UserAgent");var Vt=function(Zt){tn.get(Bo(dt)).emit("externalJsLoadingStatus",{extjs:Zt.detail.extjs,status:Zt.detail.status})};apiRTC.addEventListener("externalJsLoadingStatus",Vt,"UserAgent");var Gt=function(Zt){var an=null;Zt.detail.channelEvent==="onChannelOpened"?an="connected":Zt.detail.channelEvent==="onChannelDisconnect"?an="disconnected":Zt.detail.channelEvent==="onChannelReconnecting"?an="retry":(Zt.detail.channelEvent==="onChannelConnectError"||Zt.detail.channelEvent==="onChannelError")&&(an="error"),an!==null&&tn.get(Bo(dt)).emit("ccsConnectionStatus",{status:an})};apiRTC.addEventListener("channelEvent",Gt,"UserAgent");var Qt=function(Zt){var an={error:Zt.detail.error};Zt.detail.callType==="media"?(an.audio=!0,an.video=!0,an.screenSharing=!1):Zt.detail.callType==="audio"?(an.audio=!0,an.video=!1,an.screenSharing=!1):Zt.detail.callType==="videoOnly"?(an.audio=!1,an.video=!0,an.screenSharing=!1):Zt.detail.callType==="screenSharing"?(an.audio=!1,an.video=!0,an.screenSharing=!0):Zt.detail.callType==="screenSharingWithAudio"&&(an.audio=!0,an.video=!0,an.screenSharing=!0),tn.get(Bo(dt)).emit("userMediaError",an)};return apiRTC.addEventListener("userMediaError",Qt,"UserAgent"),dt.checkUACapabilities(),dt.capabilities.mediaDeviceChanged==="OFF"&&(mr.debug("mediaDeviceChanged is not supported"),dt.apiRTCMediaDeviceDetectionEnabled===!0&&(mr.debug("apiRTCMediaDeviceDetectionEnabled is activated, starting process"),setInterval(function(){apiCC.mediaDeviceMgr.getMediaDevices()},dt.apiRTCMediaDeviceDetectionDelay))),apiRTC.userAgentInstance=Bo(dt),dt}return Ut=Yt,Xt=[{key:"fetchUserMediaDevices",value:function(){return mr.warn("DEPRECATION WARNING : fetchUserMediaDevices() is now deprecated, use getUserMediaDevices() instead"),new Promise(function(dt,vt){apiCC.browser==="IE"&&apiCC.browser_version>8?(apiCC.getMediaDevicesWithCB(apiCC.mediaDeviceMgr.gotSources),dt(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray)):apiCC.getMediaDevices().then(function(Dt){apiCC.mediaDeviceMgr.gotSources(Dt),dt(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray)}).catch(function(){mr.log("Error on MediaDeviceManager::getMediaDevices"),apiCC.mediaDeviceMgr.gotSources(null),vt(Bt.g.createError(et.g.ERROR_OTHER,"fetchUserMediaDevices() - Could not get media devices",mr))})})}},{key:"getUserMediaDevices",value:function(){return apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray}},{key:"createStream",value:function(){var dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return mr.info("createStream() with option :",dt),so.createStreamFromUserMedia(dt.audioInputId,dt.videoInputId,dt.constraints,dt)}},{key:"createStreamFromMediaStream",value:function(dt){return mr.info("createStreamFromMediaStream()"),so.createStreamFromMediaStream(dt)}},{key:"fetchNetworkInformation_v2",value:function(dt,vt){mr.debug("fetchNetworkInformation Version 2 :",dt);var Dt=Oo.cloudUrl;dt!=null&&(Dt=dt);var Vt={testServer:Dt,httpPing:{},upload:{},download:{}};return vt!=null&&Array.isArray(vt)?(apiRTC.bandwidthRatingThresholds=vt,mr.debug("New bandwidthRatingThresholds is defined :",apiRTC.bandwidthRatingThresholds)):mr.debug("Using default bandwidthRatingThresholds :",apiRTC.bandwidthRatingThresholds),apiRTC.bandwidthTestServer=Dt,mr.info("Start Network test"),new Promise(function(Gt,Qt){apiRTC.testUserPing(function(Zt,an){Zt!==null?Qt(Zt):(Vt.httpPing=an,apiRTC.testUserUpload(25e4,function(Cn,Rn){Cn!==null?Qt(Cn):(Vt.upload.kbps=8*Rn.kBPerSec,Vt.upload.rating=Rn.rating,apiRTC.testUserUploadLoop(5e5,Vt.upload,function(Kn,Xn){Kn!==null?Qt(Kn):(Vt.upload.kbps=8*Xn.kBPerSec,Vt.upload.rating=Xn.rating,apiRTC.testUserDownload(256,function(dr,hr){dr!==null?Qt(dr):(Vt.download.kbps=8*hr.kBPerSec,Vt.download.rating=hr.rating,apiRTC.testUserDownloadLoop(1e3,Vt.download,function(Mr,Xr){Mr!==null?Qt(Mr):(Vt.download.kbps=8*Xr.kBPerSec,Vt.download.rating=Xr.rating,Gt(Vt))}))}))}))}))})})}},{key:"fetchNetworkInformation_v1",value:function(dt,vt){mr.debug("fetchNetworkInformation Version 1 :",dt);var Dt=Oo.cloudUrl;dt!=null&&(Dt=dt);var Vt={testServer:Dt,httpPing:{},upload:{},download:{}};return vt!=null&&Array.isArray(vt)?(apiRTC.bandwidthRatingThresholds=vt,mr.debug("New bandwidthRatingThresholds is defined :",apiRTC.bandwidthRatingThresholds)):mr.debug("Using default bandwidthRatingThresholds :",apiRTC.bandwidthRatingThresholds),apiRTC.bandwidthTestServer=Dt,mr.info("Start Network test"),new Promise(function(Gt,Qt){apiRTC.testUserPing(function(Zt,an){Zt!==null?Qt(Zt):(Vt.httpPing=an,apiRTC.testUserUpload(25e4,function(Cn,Rn){Cn!==null?Qt(Cn):(Vt.upload.kbps=8*Rn.kBPerSec,Vt.upload.rating=Rn.rating,Vt.upload.kbps>=1e3&&apiRTC.testUserUpload(5e5,function(Kn,Xn){Kn!==null?Qt(Kn):(Vt.upload.kbps=8*Xn.kBPerSec,Vt.upload.rating=Xn.rating)}),apiRTC.testUserDownload(256,function(Kn,Xn){Kn!==null?Qt(Kn):(Vt.download.kbps=8*Xn.kBPerSec,Vt.download.rating=Xn.rating,Vt.download.kbps>=500&&Vt.download.kbps<1500?apiRTC.testUserDownload(500,function(dr,hr){dr!==null?Qt(dr):(Vt.download.kbps=8*hr.kBPerSec,Vt.download.rating=hr.rating,Gt(Vt))}):Vt.download.kbps>=1500?apiRTC.testUserDownload(768,function(dr,hr){dr!==null?Qt(dr):(Vt.download.kbps=8*hr.kBPerSec,Vt.download.rating=hr.rating,Gt(Vt))}):Gt(Vt))}))}))})})}},{key:"fetchNetworkInformation",value:function(dt,vt){return this.fetchNetworkInformation_v1(dt,vt)}},{key:"fetchGeolocationInformation",value:function(dt){return dt==null&&(dt={enableHighAccuracy:!1,timeout:1/0,maximumAge:0}),new Promise(function(vt,Dt){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(Vt){vt(Vt)},function(Vt){Dt(Vt)},dt)})}},{key:"setUserData",value:function(dt){this.currentSession&&this.currentSession.setUserData(dt)}},{key:"setUsername",value:function(dt){this.currentSession?this.currentSession.setUsername(dt):this.preRegisterUserData.setProp("username",dt)}},{key:"setPhotoUrl",value:function(dt){this.currentSession?this.currentSession.setPhotoUrl(dt):this.preRegisterUserData.setProp("photo_url",dt)}},{key:"getUserData",value:function(){return this.currentSession?this.currentSession.getUserData():this.preRegisterUserData}},{key:"getUsername",value:function(){return this.currentSession?this.currentSession.getUsername():this.preRegisterUserData.get("username")!==null?this.preRegisterUserData.get("username"):this.preRegisterUserData.get("nickname")!==null?this.preRegisterUserData.get("nickname"):this.username}},{key:"getPhotoUrl",value:function(){return this.currentSession?this.currentSession.getPhotoUrl():this.preRegisterUserData.get("photo_url")!==null?this.preRegisterUserData.get("photo_url"):this.preRegisterUserData.get("photoUrl")!==null?this.preRegisterUserData.get("photoUrl"):null}},{key:"fetchProfileInformation",value:function(dt){var vt=this,Dt=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Promise(function(Vt,Gt){var Qt=null;vt.profile===null||Dt?vt.userId&&(Qt=Cr.getActiveApiKey())!==null?Oo.getUserProfile(Qt,vt.userId,dt).then(function(Zt){vt.profile=Zt,Vt(Zt)}).catch(Gt):Gt("fetchProfileInformation() - missing registration"):Vt(vt.profile)})}},{key:"getEnterprise",value:function(){return us.get(this)}},{key:"getCurrentSession",value:function(){return this.currentSession}},{key:"getEventCenter",value:function(){return apiRTC.eventCenter}},{key:"startWhiteboard",value:function(dt,vt){mr.trace("startWhiteboard()"),Cr.whiteBoardClient.start(),Cr.whiteBoardClient.setCanvas(dt),vt!=null&&Cr.whiteBoardClient.setUserCursorColor(vt)}},{key:"stopWhiteboard",value:function(){mr.trace("stopWhiteboard()"),Cr.whiteBoardClient.stop()}},{key:"getWhiteboardClient",value:function(){return mr.trace("getWhiteboardClient()"),Cr.whiteBoardClient}},{key:"register",value:function(){var dt=this,vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(Dt,Vt){if(mr.info("Register "+dt.uri),vt.hasOwnProperty("uri")&&(dt.uri=vt.uri),vt.hasOwnProperty("cloudUrl")&&Oo.setCloudURL(vt.cloudUrl),vt.hasOwnProperty("cloudFetchRetries")&&Oo.setFetchRetries(vt.cloudFetchRetries),vt.hasOwnProperty("cloudFetchRetryDelay")&&Oo.setFetchRetryDelay(vt.cloudFetchRetryDelay),dt.uri!==null)if(dt.currentSession)Vt(Bt.g.createError(et.g.ERROR_APIRTC_SESSION_ALREADY_ON,"register() - Session already ON",mr));else if(dt.uri.startsWith(vm))Tm(dt,vt,Dt,Vt);else if(dt.uri.startsWith(mm)||dt.uri.startsWith(gm))Sm(dt,vt,Dt,Vt);else if(dt.uri.startsWith(Cm)||dt.uri.startsWith(bm))Im(dt,vt,Dt,Vt);else{var Gt=dt.uri.split(":")[0];Vt(Bt.g.createError(et.g.ERROR_REGISTRATION_URI_INVALID,"register() - prefix invalid used for uri :"+Gt,mr))}else Vt(Bt.g.createError(et.g.ERROR_REGISTRATION_URI_INVALID,"register() - Cannot register UserAgent, no uri was specified",mr))})}},{key:"unregister",value:function(){var dt=this,vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{invalidateUserToken:!0,unregister:!0};return new Promise(function(Dt,Vt){dt.currentSession!==null?dt.currentSession.disconnect(vt).then(function(){dt.currentSession=null,us.set(dt,null),Dt()}).catch(function(Gt){Vt(Bt.g.createError(et.g.ERROR_OTHER,"unregister() - unregistration error",mr))}):Vt(Bt.g.createError(et.g.ERROR_OTHER,"unregister() - no current session",mr))})}},{key:"isRegistered",value:function(){return this.currentSession!==null}},{key:"getDefaultDevices",value:function(){return{audioInput:apiCC.mediaDeviceMgr.defaultAudioInput,audioOutput:apiCC.mediaDeviceMgr.defaultAudioOuput,videoInput:apiCC.mediaDeviceMgr.defaultVideoInput}}},{key:"enableCallStatsMonitoring",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};["chrome","firefox","safari"].indexOf(apiCC.browserDetails.type)<0?mr.warn("enableCallStatsMonitoring() is only supported on Chrome, Firefox and Safari, support on other browsers will be added soon"):dt===!0?(this.callStatsMonitoringEnabled=!0,Bt.g.isPropertyTypeof(vt,"interval","number")&&vt.interval>=1e3&&(this.callStatsMonitoringInterval=vt.interval),this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.enableCallStatsMonitoring(!0,this.callStatsMonitoringInterval)):(this.callStatsMonitoringEnabled=!1,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.enableCallStatsMonitoring(!1))}},{key:"enableActiveSpeakerDetecting",value:function(dt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};dt===!0?Bt.g.isPropertyTypeof(vt,"threshold","number")&&vt.threshold>0?apiRTC.enableActiveSpeakerDetecting(!0,vt.threshold):apiRTC.enableActiveSpeakerDetecting(!0):apiRTC.enableActiveSpeakerDetecting(!1)}},{key:"enableMeshRoomMode",value:function(dt){dt===!1||dt===!0?(this.meshModeEnabled=dt,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.enableMeshRoomMode(dt)):mr.error("Wrong value",dt)}},{key:"setTargetBandwidthUsage",value:function(dt){typeof dt!="number"&&!isNaN(dt)&&dt>0?(this.targetBandwidthUsage=dt,this.isRegistered&&Cr.webRTCClient.setVideoBandwidth(dt)):mr.error("Unvalid target bandwidth usage value",dt)}},{key:"setOverallIncomingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.overallIncoming=dt,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.setOverallIncomingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.overallIncoming,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.setOverallIncomingVideoBandwidth(0))}},{key:"setOverallOutgoingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.overallOutgoing=dt,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.setOverallOutgoingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.overallOutgoing,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.setOverallOutgoingVideoBandwidth(0))}},{key:"setPerCallIncomingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.perCallIncoming=dt,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.setPerCallIncomingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.perCallIncoming,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.setPerCallIncomingVideoBandwidth(0))}},{key:"setPerCallOutgoingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.perCallOutgoing=dt,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.setPerCallOutgoingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.perCallOutgoing,this.isRegistered&&Cr.webRTCClient&&Cr.webRTCClient.setPerCallOutgoingVideoBandwidth(0))}},{key:"updateMediaOnCall",value:function(dt,vt){Cr.webRTCClient.updateMediaDeviceOnCall(dt,vt)}},{key:"getCapabilities",value:function(){return this.capabilities}},{key:"getBrowser",value:function(){return this.browser}},{key:"getBrowserMajorVersion",value:function(){return this.browser_major_version}},{key:"getBrowserVersion",value:function(){return this.browser_version}},{key:"getOsName",value:function(){return this.osName}},{key:"getOsVersion",value:function(){return this.osVersion}},{key:"getBrowserInfo",value:function(){return this.browserInfo}},{key:"getBrowserDetails",value:function(){return this.browserDetails}},{key:"getCPUArchitecture",value:function(){return this.getUserData().cpuArchitecture}},{key:"getDeviceVendor",value:function(){return this.getUserData().deviceVendor}},{key:"getDeviceModel",value:function(){return this.getUserData().deviceModel}},{key:"getEngineName",value:function(){return this.getUserData().engineName}},{key:"getEngineVersion",value:function(){return this.getUserData().engineVersion}},{key:"checkUACapabilities",value:function(){mr.debug("checkUACapabilities"),apiRTC.osName==="iOS"&&(mr.debug("Deactivating whiteboardCursor for iOS"),this.capabilities.whiteboardCursor="OFF"),apiRTC.osName==="Android"&&apiRTC.browser==="Chrome"&&(mr.debug("mediaDeviceChanged not supported on Chrome/Android"),this.capabilities.mediaDeviceChanged="OFF"),ft.Xh!=="Safari"&&ft.Xh!=="Mobile Safari"||(mr.debug("mediaDeviceChanged not supported on Safari"),this.capabilities.mediaDeviceChanged="OFF"),apiRTC.webRTCCompliant===!1&&(mr.debug("WebRTC not compliant"),this.capabilities.webRTCCompliant="OFF"),apiRTC.screenSharingCompliant===!1&&(mr.debug("screenSharing not compliant"),this.capabilities.screenSharingCompliant="OFF"),apiRTC.qoSStatCompliant===!1&&(mr.debug("qoS Stat not compliant"),this.capabilities.qoSStatCompliant="OFF"),ft.Xh!=="Safari"&&ft.Xh!=="Mobile Safari"||(mr.debug("background removal not compliant"),this.capabilities.backgroundRemoval="ON",mr.debug("noiseReduction not compliant"),this.capabilities.noiseReduction="OFF"),"getCapabilities"in MediaStreamTrack.prototype||(mr.debug("Stream capabilities not compliant"),this.capabilities.streamCapabilities="OFF"),(apiRTC.osName!=="Windows"&&apiRTC.osVersion!=="10"||apiRTC.osName!=="Windows"&&apiRTC.osVersion!=="11")&&(mr.debug("remoteAccessUser not compliant"),this.capabilities.remoteAccessUser="OFF")}},{key:"startPrecallTest",value:function(dt,vt,Dt,Vt,Gt){Cr.webRTCClient.startPrecallTest(dt,vt,Dt,Vt,Gt)}},{key:"sendLogToCloud",value:function(dt,vt,Dt,Vt){apiCC.sendLogToCloud(dt,vt,Dt,Vt)}},{key:"getStreamWithRoomNameAndCallId",value:function(dt,vt){mr.debug("getStreamWithRoomNameAndCallId");var Dt="NOT_FOUND";return apiRTC.userAgentInstance.apiRTCStreamsList.forEach(function(Vt){var Gt=0;if((Gt=Vt.publishedInConversations.get(dt))!==void 0&&Gt.toString()===vt.toString())return mr.debug(" Stream is found"),Dt=Vt;mr.debug(" This is not the stream")}),Dt}},{key:"getStreamWithMediaStreamId",value:function(dt){mr.debug("getStreamWithMediaStreamId");var vt="NOT_FOUND";return apiRTC.userAgentInstance.apiRTCStreamsList.forEach(function(Dt){if(Dt.data.id===dt.toString())return mr.debug(" Stream is found"),vt=Dt;mr.debug(" This is not the stream")}),vt}}],kt=[{key:"getAvailableEvents",value:function(){return ym}}],Xt&&op(Ut.prototype,Xt),kt&&op(Ut,kt),Object.defineProperty(Ut,"prototype",{writable:!1}),Yt}(fn),Sm=function(jt,Ut,Xt,kt){var Ft=jt.uri.split(":");mr.debug("register() - Registration using prefix :"+Ft[0]);var sn=Ft[1];Ut.password!==null&&typeof Ut.password=="string"?Oo.authentication(sn,Ut.password,Ut.captcha_token).then(function(ln){return lp(jt,ln.token,Ut)}).then(function(ln){Xt(ln)}).catch(function(ln){mr.error("registerPrefixApizee err : ",ln.message);var Yt="register() - An error occured during cloud credentials registration :"+JSON.stringify(ln),dt=ln;dt.message=Yt,ln.hasOwnProperty("code")?dt.code=ln.code:ln.hasOwnProperty("http_code")&&(ln.http_code.toString().startsWith("4")?dt.code=et.g.ERROR_INVALID_CREDENTIALS:dt.code=et.g.ERROR_SERVER_UNAVAILABLE),kt(dt)}):kt(Bt.g.createError(et.g.ERROR_INVALID_CREDENTIALS,"register() - No password was specified for apizee: UserAgent registration",mr))},Tm=function(jt,Ut,Xt,kt){mr.debug("register() - Registration using prefix :token:");var Ft=jt.uri.split(":")[1];Oo.checkUserToken(Ft).then(function(sn){return lp(jt,Ft,Ut)}).then(Xt).catch(function(sn){kt(Bt.g.createError(et.g.ERROR_OTHER,"register() - An error occured during cloud token registration",mr))})},Im=function(jt,Ut,Xt,kt){var Ft=jt.uri.split(":");mr.debug("register() - Registration using prefix :"+Ft[0]);var sn=Ft[1];if(!sn||typeof sn!="string")return kt(Bt.g.createError(et.g.ERROR_OTHER,"register() - Wrong apiKey",mr));new Promise(function(ln,Yt){Oo.getPreferredCCS(sn).then(function(dt){Ut.ccs&&Ut.ccs!==dt.ccs&&(mr.debug("Overloading CCS address with init option"),dt.ccs=Ut.ccs),ln(dt)}).catch(function(){Yt(Bt.g.createError(et.g.ERROR_OTHER,"register() - Could not get preferred CCS",mr))})}).then(function(ln){jt.currentSession=new Br(jt),jt.currentSession.user=jt,jt.currentSession.token=null,Bt.g.isPropertyTypeof(Ut,"nickname","string")?jt.username=Ut.nickname:jt.username="guest-"+Bt.g.guid().substr(0,13),jt.preRegisterUserData.setProp("username",jt.username),jt.preRegisterUserData.setProp("userConfId",jt.username+Date.now()),Ut.userData&&jt.preRegisterUserData.setProps(Ut.userData);var Yt={apiKey:sn,MCUActivated:!0,mcu:Ut.hasOwnProperty("mcu")?Ut.mcu:et.g.DEFAULT_MCU,nickname:jt.username,ccsServer:ln.ccs,bandwidthTestServer:Oo.cloudUrl,webRTCPluginActivated:!0,userData:jt.preRegisterUserData,tryAudioCallAfterUserMediaError:!0,extJsLoadingRetryNb:Ut.extJsLoadingRetryNb,extJsLoadingRetryDelay:Ut.extJsLoadingRetryDelay,ccsConnectionRetryNb:Ut.ccsConnectionRetryNb,ccsConnectionRetryDelay:Ut.ccsConnectionRetryDelay,turnServerAddress:Ut.turnServerAddress,userAcceptOnIncomingDataCall:Ut.userAcceptOnIncomingDataCall,userAcceptOnIncomingScreenSharingCall:Ut.userAcceptOnIncomingScreenSharingCall,cloudIsSecured:ln.secure};return Ut.hasOwnProperty("id")&&(Yt.apiCCId=Ut.id),Bt.g.isPropertyTypeof(Ut,"idPersistenceTimeout","number")&&Ut.idPersistenceTimeout>=0&&(Yt.apiCCIdPersistenceTimeout=Ut.idPersistenceTimeout),Ut.hasOwnProperty("groups")&&(Yt.presenceGroup=Ut.groups),Ut.hasOwnProperty("subscribeTo")&&(Yt.subscribeToPresenceGroup=Ut.subscribeTo),Ut.hasOwnProperty("contactDisconnectionDelay")&&(mr.debug("Setting contactDisconnectionDelay :",Ut.contactDisconnectionDelay),Cr.contactDisconnectionDelay=Ut.contactDisconnectionDelay),Yt.idConversionActivated=!1,Ut.hasOwnProperty("idConversionActivated")&&(Yt.idConversionActivated=Ut.idConversionActivated),Ut.hasOwnProperty("conversationSpace")&&(Yt.conversationSpace=Ut.conversationSpace),Ut.hasOwnProperty("token")&&(Yt.token=Ut.token,jt.currentSession.ccsToken=Ut.token),Cr.initializeApiRTC(Yt)}).then(function(ln){jt.callStatsMonitoringEnabled!==!1&&jt.callStatsMonitoringEnabled!==!0||Cr.webRTCClient.enableCallStatsMonitoring(jt.callStatsMonitoringEnabled,jt.callStatsMonitoringInterval),jt.meshModeEnabled!==!1&&jt.meshModeEnabled!==!0||Cr.webRTCClient.enableMeshRoomMode(jt.meshModeEnabled),jt.targetBandwidthUsage>0&&Cr.webRTCClient.setVideoBandwidth(jt.targetBandwidthUsage),jt.videoBandwidthSettings.overallIncoming>0&&Cr.webRTCClient.setOverallIncomingVideoBandwidth(jt.videoBandwidthSettings.overallIncoming),jt.videoBandwidthSettings.overallOutgoing>0&&Cr.webRTCClient.setOverallOutgoingVideoBandwidth(jt.videoBandwidthSettings.overallOutgoing),jt.videoBandwidthSettings.perCallIncoming>0&&Cr.webRTCClient.setPerCallIncomingVideoBandwidth(jt.videoBandwidthSettings.perCallIncoming),jt.videoBandwidthSettings.perCallOutgoing>0&&Cr.webRTCClient.setPerCallOutgoingVideoBandwidth(jt.videoBandwidthSettings.perCallOutgoing),jt.userId=ln,jt.currentSession.init(ln),mr.log("register() - APIRTC init OK",ln),Cr.apiRTCSession.userData!==void 0&&Cr.apiRTCSession.userData!==null&&(jt.currentSession.userData=new Io(Cr.apiRTCSession.userData)),Xt(jt.currentSession)}).catch(function(ln){kt(Bt.g.createError(et.g.ERROR_APIRTC_INITIALISATION_FAILED,"register() - ApiRTC Initialization error : "+ln,mr)),delete jt.currentSession,jt.currentSession=null})},lp=function(jt,Ut){var Xt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},kt=null,Ft=null;return mr.debug("initializeCloudUASession :",Xt),new Promise(function(sn,ln){Oo.getConnectedUserInformation(Ut).then(function(Yt){if(Ft=Yt,mr.debug("Connected user information : ",Yt),jt.currentSession=new Br(jt),jt.currentSession.user=jt,jt.currentSession.token=Yt.token,Xt.hasOwnProperty("idPersistenceTimeout")&&(jt.currentSession.idPersistenceTimeout=Xt.idPersistenceTimeout),jt.username=Yt.nickname,jt.preRegisterUserData.setProp("username",jt.username),jt.preRegisterUserData.setProp("nickname",jt.username),jt.preRegisterUserData.setProp("photo_url",Yt.photo_url),Yt.mail&&jt.preRegisterUserData.setProp("mail",Yt.mail),jt.preRegisterUserData.setProp("userConfId",jt.username+Date.now()),Xt.userData&&jt.preRegisterUserData.setProps(Xt.userData),!Xt.hasOwnProperty("overLoadedApiRTCKey")||Xt.overLoadedApiRTCKey===null||Xt.overLoadedApiRTCKey===void 0||Yt.apiKey===Xt.overLoadedApiRTCKey)return jt.userId=Yt.userId,kt=new Xs(Yt.enterpriseId,Yt.apiKey,jt.currentSession),us.set(jt,kt),kt.load();mr.debug("overLoadedApiRTCKey is defined :",Xt.overLoadedApiRTCKey),kt=new Xs(Yt.enterpriseId,Xt.overLoadedApiRTCKey,jt.currentSession),delete Xt.id,jt.userId=null,us.set(jt,kt),mr.debug("... no enterprise users data loading")}).then(function(){var Yt={apiKey:kt.getApiKey(),ccsServer:Xt.ccs||Ft.ccs,MCUActivated:!0,mcu:Xt.hasOwnProperty("mcu")?Xt.mcu:et.g.DEFAULT_MCU,nickname:jt.username,bandwidthTestServer:Oo.cloudUrl,webRTCPluginActivated:!0,apiCCId:Xt.hasOwnProperty("id")?Xt.id:jt.userId,userData:jt.preRegisterUserData,tryAudioCallAfterUserMediaError:!0,presenceGroup:["agent"],subscribeToPresenceGroup:["agent","visitor"],extJsLoadingRetryNb:Xt.extJsLoadingRetryNb,extJsLoadingRetryDelay:Xt.extJsLoadingRetryDelay,ccsConnectionRetryNb:Xt.ccsConnectionRetryNb,ccsConnectionRetryDelay:Xt.ccsConnectionRetryDelay,turnServerAddress:Xt.turnServerAddress,userAcceptOnIncomingDataCall:Xt.userAcceptOnIncomingDataCall,userAcceptOnIncomingScreenSharingCall:Xt.userAcceptOnIncomingScreenSharingCall};return Bt.g.isPropertyTypeof(Xt,"idPersistenceTimeout","number")&&Xt.idPersistenceTimeout>=0&&(Yt.apiCCIdPersistenceTimeout=Xt.idPersistenceTimeout),Xt.hasOwnProperty("groups")&&(Yt.presenceGroup=Xt.groups),Xt.hasOwnProperty("subscribeTo")&&(Yt.subscribeToPresenceGroup=Xt.subscribeTo),Xt.hasOwnProperty("contactDisconnectionDelay")&&(mr.debug("Setting contactDisconnectionDelay :",Xt.contactDisconnectionDelay),Cr.contactDisconnectionDelay=Xt.contactDisconnectionDelay),Yt.idConversionActivated=!1,Xt.hasOwnProperty("idConversionActivated")&&(Yt.idConversionActivated=Xt.idConversionActivated),Xt.hasOwnProperty("conversationSpace")&&(Yt.conversationSpace=Xt.conversationSpace),Cr.initializeApiRTC(Yt)}).then(function(Yt){jt.callStatsMonitoringEnabled!==!1&&jt.callStatsMonitoringEnabled!==!0||Cr.webRTCClient.enableCallStatsMonitoring(jt.callStatsMonitoringEnabled,jt.callStatsMonitoringInterval),jt.meshModeEnabled!==!1&&jt.meshModeEnabled!==!0||Cr.webRTCClient.enableMeshRoomMode(jt.meshModeEnabled),jt.targetBandwidthUsage>0&&Cr.webRTCClient.setVideoBandwidth(jt.targetBandwidthUsage),jt.videoBandwidthSettings.overallIncoming>0&&Cr.webRTCClient.setOverallIncomingVideoBandwidth(jt.videoBandwidthSettings.overallIncoming),jt.videoBandwidthSettings.overallOutgoing>0&&Cr.webRTCClient.setOverallOutgoingVideoBandwidth(jt.videoBandwidthSettings.overallOutgoing),jt.videoBandwidthSettings.perCallIncoming>0&&Cr.webRTCClient.setPerCallIncomingVideoBandwidth(jt.videoBandwidthSettings.perCallIncoming),jt.videoBandwidthSettings.perCallOutgoing>0&&Cr.webRTCClient.setPerCallOutgoingVideoBandwidth(jt.videoBandwidthSettings.perCallOutgoing),jt.currentSession.init(Yt),mr.info("APIRTC init OK",Yt),Cr.apiRTCSession.userData!==void 0&&Cr.apiRTCSession.userData!==null&&(jt.currentSession.userData=new Io(Cr.apiRTCSession.userData)),sn(jt.currentSession)}).catch(function(Yt){mr.error(Yt),ln(Yt)})})};function Rm(jt,Ut){for(var Xt=0;Xt<Ut.length;Xt++){var kt=Ut[Xt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(jt,kt.key,kt)}}var Xo=mt.Y.get("ResourcesLoader"),Em=function(){function jt(){(function(kt,Ft){if(!(kt instanceof Ft))throw new TypeError("Cannot call a class as a function")})(this,jt),this.loadedJsLinks=[]}var Ut,Xt;return Ut=jt,Xt=[{key:"loadjs",value:function(kt){function Ft(sn,ln,Yt){return kt.apply(this,arguments)}return Ft.toString=function(){return kt.toString()},Ft}(function(kt,Ft,sn){var ln=this;Xo.info("Load js resources",kt),Xo.debug("Already loaded js",this.loadedJsLinks);var Yt=sn.success;if((kt=kt.filter(function(dt){return!ln.loadedJsLinks.includes(dt)})).length===0)return Xo.debug("Skip resources loading, all resources previously loaded"),void(Yt instanceof Function&&Yt());Xo.debug("Filtered resources to load",kt),sn.success=function(){ln.loadedJsLinks.push.apply(ln.loadedJsLinks,kt),Yt instanceof Function&&Yt()},_e(kt,Ft,sn)})},{key:"unloadjs",value:function(kt){var Ft=this;Xo.info("Unload js",kt),kt.forEach(function(sn){var ln=document.querySelector('script[src="'+sn+'"]');ln!==void 0&&(ln.remove(),Ft.loadedJsLinks=Ft.loadedJsLinks.filter(function(Yt){return Yt!==sn}))}),Xo.debug("Scripts unloaded, currently loaded js",this.loadedJsLinks)}},{key:"reset",value:function(){unloadjs(this.loadedJsLinks),this.loadedJsLinks=[]}}],Xt&&Rm(Ut.prototype,Xt),Object.defineProperty(Ut,"prototype",{writable:!1}),jt}(),xr=mt.Y.get("Init"),_a=mt.Y.get("MediaDeviceManager");function fu(jt){return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ut){return typeof Ut}:function(Ut){return Ut&&typeof Symbol=="function"&&Ut.constructor===Symbol&&Ut!==Symbol.prototype?"symbol":typeof Ut},fu(jt)}at=s.hmd(at),console!=null&&(typeof apiRTC_React<"u"?console.info&&console.info("Loading APIRTC_REACT_NATIVE_MODULE"):console.info&&console.info("Loading APIRTC_MODULE")),window.Prototype&&delete Array.prototype.toJSON;var cp=new(Go());It.version="5.0.17",It.utils={},It.eventCenter=new Mt,It.resourcesLoader=new Em;for(var mu=0,dp=Object.keys(et.g);mu<dp.length;mu++){var up=dp[mu];It[up]=et.g[up]}It.utils.EventEmitter=pt,It.utils.EventCenter=Mt,It.MediaDevice=zt,It.Stream=so,It.Call=Qr,It.Conversation=jo,It.ConversationCall=Gl,It.Conference=Fs,It.Contact=No,It.Enterprise=Xs,It.SentInvitation=Do,It.ReceivedInvitation=On,It.ReceivedCallInvitation=Er,It.ReceivedConversationJoinRequest=Ho,It.ReceivedConversationInvitation=$t,It.ReceivedFileTransferInvitation=eo,It.ReceivedWhiteboardInvitation=vs,It.ReceivedDataChannelInvitation=zo,It.ReceivedPointerSharingInvitation=xl,It.PointerSharingRoom=ru,It.Session=Br,It.UserAgent=sp,It.UserData=Io,It.CloudApi=cp,It.DataChannel=ys,It.Observable=fn,It.setLogLevel=function(jt){mt.Y.setLogLevel(jt)};var pp=!1;window.apiRTC===void 0?(fu(at)==="object"&&at.exports&&(at.exports=It),window.apiRTC2=window.apiRTC=window.apiCC=window.CC=It,pp=!0):console.info("APIRTC_MODULE already loaded with version :",apiRTC.version),s(4170),pp===!0&&(It.init=function(jt){var Ut,Xt;if(xr.info("apiRTC initialization, version is :"+apiCC.version),xr.info("osName :"+apiCC.osName),xr.info("osVersion :"+apiCC.osVersion),xr.info("browser :"+apiCC.browser),xr.info("browser_version :"+apiCC.browser_version),Ut=jt.apiKey,Xt=!0,xr.info("apiKey :",Ut),Ut.indexOf("[")!==-1&&(Xt=!1),Xt===!0)if(jt.hasOwnProperty("apiCCId")&&jt.apiCCId!==null&&jt.apiCCId!==""&&function(ln){if(ln!==null){var Yt=ln;if(typeof Yt=="number"&&(Yt=String(Yt)),typeof Yt=="string")return Yt.length<=128}return!1}(jt.apiCCId)!==!0)xr.error("apiCCId format is not correct, leaving connection process");else{var kt="";if(kt=window!==void 0&&window.location!==void 0&&window.location.protocol!==void 0&&window.location.protocol!="https:"?"http":"https",ft.ag.name!=="iOS"&&ft.ag.name!=="Android"||(xr.log(ft.ag.name+" detected forcing protocol to https"),kt="https"),jt.ccsServer===void 0?(xr.debug("Setting ccsServer"),window!==void 0&&window.location!==void 0&&window.location.protocol!==void 0?window.location.protocol=="https:"||ft.ag.name==="iOS"||ft.ag.name==="Android"?jt.ccsServer="ccs5.apizee.com:443":jt.ccsServer="ccs5.apizee.com:80":jt.ccsServer="ccs5.apizee.com:443"):xr.log("ccsServer is defined on init()"),jt.bandwidthTestServer!==null&&jt.bandwidthTestServer!==void 0?(xr.log("bandwidthTestServer is defined :",jt.bandwidthTestServer),apiCC.bandwidthTestServer=jt.bandwidthTestServer):xr.log("bandwidthTestServer is not defined"),jt.userData!==void 0&&xr.log("userData :",jt.userData),apiCC.extJsLoadingRetryNb=jt.extJsLoadingRetryNb,apiCC.extJsLoadingRetryDelay=jt.extJsLoadingRetryDelay,apiCC.jsLoaded===!1){apiCC.initApiKey=jt.apiKey,apiCC.initApiCCId=jt.apiCCId;var Ft=function(){xr.log("sio loaded"),apiCC.jsLoaded=!0,apiCC.session=new apiCC.ApiCCSession(jt),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("sio","loaded")},sn={success:Ft,error:function(){xr.error("sio loading error"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("sio","error")},retrycb:function(){xr.warn("sio retry"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("sio","retry")}};apiCC.sioEmbedded?(window.rtcio=io,Ft()):apiRTC_sioLoader.load(kt,jt,sn)}else xr.log("apiRTC JS Librairies already loaded"),xr.log("initParameters have changed, need to reload session connection"),apiCC.addEventListener("sessionReady",jt.onReady),xr.log("initParameters.userData :",jt.userData),jt.apiCCId!==void 0&&jt.apiCCId!==""&&jt.apiCCId!==null||(xr.log("keeping apiCCId defined by apiRTC :"+jt.apiCCId),jt.apiCCId=apiCC.session.apiCCId),xr.log("initParameters.apiCCId :"+jt.apiCCId),jt.userData!==null&&jt.userData!==void 0?(xr.log("userData is defined :",jt.userData),apiCC.session.userData=jt.userData):xr.log("userData is not defined"),xr.log("apiCC.session.userData :",apiCC.session.userData),jt.token!==null&&jt.token!==void 0?(xr.log("token is defined :"+jt.token),apiCC.session.token=jt.token):(xr.log("token is not defined"),apiCC.session.token=null),jt.conversationSpace!==null&&jt.conversationSpace!==void 0?(xr.log("conversationSpace is defined :"+jt.conversationSpace),apiCC.session.conversationSpace=jt.conversationSpace):(xr.log("conversationSpace is not defined"),apiCC.session.conversationSpace=null),apiCC.session.reOpenChannel(jt.apiCCId,jt.apiKey),jt.nickname!==null&&jt.nickname!==void 0?(xr.log("Nickname is defined :"+jt.nickname),apiCC.session.nickname=jt.nickname):(xr.log("Nickname is not defined, setting to apiCCId value :"+apiCC.session.apiCCId),apiCC.session.nickname=apiCC.session.apiCCId),jt.photoURL!==null&&jt.photoURL!==void 0?(xr.log("photoURL is defined :"+jt.photoURL),apiCC.session.photoURL=jt.photoURL):(xr.log("photoURL is not defined"),apiCC.session.photoURL=null),jt.presenceGroup!==null&&jt.presenceGroup!==void 0?(xr.log("presenceGroup is defined :"+jt.presenceGroup),JSON.stringify(apiCC.session.presenceGroup)!==JSON.stringify(jt.presenceGroup)&&(xr.log("presenceGroup updated on initParameters"),apiCC.session.channel.updatePresenceGroupIsNeeded=!0,apiCC.session.channel.oldPresenceGroup===null&&(apiCC.session.channel.oldPresenceGroup=apiCC.session.presenceGroup),apiCC.session.channel.newPresenceGroup=jt.presenceGroup,apiCC.session.presenceGroup=jt.presenceGroup)):(xr.log('presenceGroup is not defined, setting to ["default"]'),JSON.stringify(apiCC.session.presenceGroup)!==JSON.stringify(["default"])&&(xr.log("presenceGroup updated on initParameters"),apiCC.session.channel.updatePresenceGroupIsNeeded=!0,apiCC.session.channel.oldPresenceGroup===null&&(apiCC.session.channel.oldPresenceGroup=apiCC.session.presenceGroup),apiCC.session.channel.newPresenceGroup=["default"],apiCC.session.presenceGroup=["default"])),jt.subscribeToPresenceGroup!==null&&jt.subscribeToPresenceGroup!==void 0?(xr.log("subscribeToPresenceGroup is defined :"+jt.subscribeToPresenceGroup),JSON.stringify(apiCC.session.subscribeToPresenceGroup)!==JSON.stringify(jt.subscribeToPresenceGroup)&&(xr.log("subscribeToPresenceGroup updated on initParameters"),apiCC.session.channel.updateSubscribeToPresenceGroupIsNeeded=!0,apiCC.session.channel.oldSubscribeToPresenceGroup===null&&(apiCC.session.channel.oldSubscribeToPresenceGroup=apiCC.session.subscribeToPresenceGroup),apiCC.session.channel.newSubscribeToPresenceGroup=jt.subscribeToPresenceGroup,apiCC.session.subscribeToPresenceGroup=jt.subscribeToPresenceGroup)):(xr.log('subscribeToPresenceGroup is not defined, setting to ["default"]'),JSON.stringify(apiCC.session.subscribeToPresenceGroup)!==JSON.stringify(["default"])&&(xr.log("subscribeToPresenceGroup updated on initParameters"),apiCC.session.channel.updateSubscribeToPresenceGroupIsNeeded=!0,apiCC.session.channel.oldSubscribeToPresenceGroup===null&&(apiCC.session.channel.oldSubscribeToPresenceGroup=apiCC.session.subscribeToPresenceGroup),apiCC.session.channel.newSubscribeToPresenceGroup=["default"],apiCC.session.subscribeToPresenceGroup=["default"])),apiCC.initApiKey=jt.apiKey,apiCC.initApiCCId=jt.apiCCId}else xr.error("Apikey format is not correct, leaving connection process")},s(8560),It.mediaDeviceMgr=new function(){this.audioDevicePresent=!0,this.videoDevicePresent=!0,this.audioOutputPresent=!0,this.mediaSourceInfos=null,this.mediaDeviceChangedDetected=!1,this.mediaDeviceSourceInfosArray={audioinput:{},audiooutput:{},videoinput:{}},this.mediaDeviceSourceInfosArrayBeforeGotSources=null,this.defaultVideoInput=null,this.defaultAudioInput=null,this.defaultAudioOuput=null,this.realMediaDevicesListInitialization=!1,this.realMediaDevicesListInitializationWasAlreadyDone=!1,_a.debug("MediaDeviceManager"),navigator.mediaDevices!==null&&navigator.mediaDevices!==void 0&&(navigator.mediaDevices.ondevicechange=function(jt){_a.debug("Media device have changed"),apiCC.mediaDeviceMgr.getMediaDevices("updatedOnDeviceChange")}),this.gotSources=function(jt,Ut){_a.debug("gotSources : sourceInfos :",jt),apiCC.mediaDeviceMgr.audioDevicePresent=!1,apiCC.mediaDeviceMgr.videoDevicePresent=!1,apiCC.mediaDeviceMgr.audioOutputPresent=!1;var Xt=!1;apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources=apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray;var kt={},Ft=!1;(0,Tt.fS)(apiCC.mediaDeviceMgr.mediaSourceInfos,jt)||(_a.debug("MediaDevices change detected"),Xt=!0);var sn,ln=null,Yt=0,dt=0,vt=0,Dt=null;if(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray={audioinput:{},audiooutput:{},videoinput:{}},apiCC.mediaDeviceMgr.mediaSourceInfos=jt,jt!==null)for(sn=0;sn!==jt.length;++sn)(ln=jt[sn]).deviceId!==null&&ln.deviceId!==""?(Dt=new zt(ln.deviceId,ln.kind),ln.label!==null&&ln.label!==void 0&&(this.realMediaDevicesListInitialization=!0)):(_a.debug("MediaDevices change but deviceId is not correct, using fakedeviceId :",sn),Dt=new zt(sn,ln.kind)),ln.kind==="audio"||ln.kind==="audioinput"?(apiCC.mediaDeviceMgr.audioDevicePresent||(apiCC.mediaDeviceMgr.audioDevicePresent=!0),Dt.label=ln.label||"microphone "+ ++Yt,apiCC.mediaDeviceMgr.defaultAudioInput===null&&(apiCC.mediaDeviceMgr.defaultAudioInput=Dt),ln.getCapabilities!==null&&ln.getCapabilities!==void 0?Dt.capabilities=ln.getCapabilities():_a.debug("getCapabilities not defined")):ln.kind==="video"||ln.kind==="videoinput"?(apiCC.mediaDeviceMgr.videoDevicePresent||(apiCC.mediaDeviceMgr.videoDevicePresent=!0),Dt.label=ln.label||"camera "+ ++dt,apiCC.mediaDeviceMgr.defaultVideoInput===null&&(apiCC.mediaDeviceMgr.defaultVideoInput=Dt),ln.getCapabilities!==null&&ln.getCapabilities!==void 0?Dt.capabilities=ln.getCapabilities():_a.debug("getCapabilities not defined")):ln.kind==="audiooutput"?(apiCC.mediaDeviceMgr.audioOutputPresent||(apiCC.mediaDeviceMgr.audioOutputPresent=!0),Dt.label=ln.label||"audio output "+ ++vt,apiCC.mediaDeviceMgr.defaultAudioOuput===null&&(apiCC.mediaDeviceMgr.defaultAudioOuput=Dt)):(Dt.label=ln.label||"other source "+ln.deviceId,_a.trace("Detected some other kind of source : "+ln.kind)),_a.trace("Local device : "+Dt.label+" - "+Dt.id),apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray[Dt.type]===void 0&&(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray[Dt.type]={}),apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray[Dt.type][Dt.id]=Dt;else _a.warn("Media detection is not supported by browser, considering micro and camera present"),apiCC.mediaDeviceMgr.audioDevicePresent=!0,apiCC.mediaDeviceMgr.videoDevicePresent=!0,apiCC.mediaDeviceMgr.audioOutputPresent=!0;if(_a.log("Audio device detected :"+apiCC.mediaDeviceMgr.audioDevicePresent),_a.log("Video device detected :"+apiCC.mediaDeviceMgr.videoDevicePresent),_a.log("audio Output device detected :"+apiCC.mediaDeviceMgr.audioOutputPresent),_a.debug("mediaDeviceSourceInfosArray :",apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray),apiCC.mediaDeviceMgr.audioDevicePresent===!1?apiCC.mediaDeviceMgr.videoDevicePresent===!1?apiCC.myWebRTC_Event.createErrorEvent("Video device is not present","NO_AUDIO_NO_VIDEO_DEVICE"):apiCC.myWebRTC_Event.createErrorEvent("Audio device is not present","NO_AUDIO_DEVICE"):apiCC.mediaDeviceMgr.videoDevicePresent===!1&&apiCC.myWebRTC_Event.createErrorEvent("Video device is not present","NO_VIDEO_DEVICE"),(0,Tt.fS)(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray,apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources)||(_a.debug("mediaDeviceSourceInfosArray change detected"),Xt=!0),Xt===!0){_a.debug("fireMediaChangedEvent :",Xt);var Vt=this.getMediaDeviceListsDiff(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray,apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources);this.realMediaDevicesListInitialization===!0&&this.realMediaDevicesListInitializationWasAlreadyDone===!1&&(_a.debug("This is the first real initialization of media device list"),Ft=!0),this.realMediaDevicesListInitialization===!0&&(this.realMediaDevicesListInitializationWasAlreadyDone=!0),this.mediaDeviceChangedDetected=!0,apiCC.myWebRTC_Event!==null&&apiCC.myWebRTC_Event.createMediaDeviceChangedEvent(Vt,Ut,Ft),_a.debug("fireMediaChangedEvent :",apiCC.mediaDeviceMgr.mediaSourceInfos)}apiCC.session&&apiCC.session.apiCCWebRTCClient&&(apiCC.session.apiCCWebRTCClient.webRTCClient.setGumConfigWithDevicePresent(),kt.audioDevicePresent=apiCC.mediaDeviceMgr.audioDevicePresent,kt.videoDevicePresent=apiCC.mediaDeviceMgr.videoDevicePresent,apiCC.session.setUserData(kt))},this.getMediaDevices=function(jt){_a.debug("MediaDeviceManager::getMediaDevices : updateReason :",jt),apiCC.browser==="IE"&&apiCC.browser_version>8?apiCC.getMediaDevicesWithCB(apiCC.mediaDeviceMgr.gotSources):apiCC.getMediaDevices().then(function(Ut){apiCC.mediaDeviceMgr.gotSources(Ut,jt)}).catch(function(){_a.log("Error on MediaDeviceManager::getMediaDevices"),apiCC.mediaDeviceMgr.gotSources(null,jt)})},this.getMediaDeviceListsDiff=function(jt,Ut){Ut!==void 0&&Ut||(Ut={}),jt!==void 0&&jt||(jt={});for(var Xt=[],kt=[],Ft=[],sn=0,ln=Object.keys(Ut);sn<ln.length;sn++){var Yt=ln[sn];if(jt[Yt]===void 0)kt[Yt]=Ut[Yt];else for(var dt=0,vt=Object.keys(Ut[Yt]);dt<vt.length;dt++){var Dt=vt[dt];jt[Yt][Dt]===void 0&&(kt[Yt]===void 0&&(kt[Yt]={}),kt[Yt][Dt]=Ut[Yt][Dt])}}for(var Vt=0,Gt=Object.keys(jt);Vt<Gt.length;Vt++)for(var Qt=Gt[Vt],Zt=0,an=Object.keys(jt[Qt]);Zt<an.length;Zt++){var Cn=an[Zt];Ut[Qt]!==void 0&&Ut[Qt][Cn]!==void 0||(Xt[Qt]===void 0&&(Xt[Qt]={}),Xt[Qt][Cn]=jt[Qt][Cn]),Ut[Qt]!==void 0&&Ut[Qt][Cn]!==void 0&&jt[Qt][Cn].label!==Ut[Qt][Cn].label&&(Ft[Qt]===void 0&&(Ft[Qt]={}),Ft[Qt][Cn]=jt[Qt][Cn])}return{added:Object.keys(Xt).length>0?Xt:null,removed:Object.keys(kt).length>0?kt:null,updated:Object.keys(Ft).length>0?Ft:null}}},It.mediaDeviceMgr.getMediaDevices(),It.webRTCCompliant=It.isWebRTCCompliant(),It.qoSStatCompliant=It.isQoSStatCompliant(),It.screenSharingCompliant=It.isScreenSharingCompliant());const wm=apiRTC},1549:(at,ut,s)=>{s.d(ut,{Y:()=>ht}),s(6992),s(1532),s(1539),s(8783),s(3948),s(2772),s(4916),s(5306),s(2222),s(5268),s(3710),s(3161),s(9653),s(9070),s(9753),s(2526),s(1817),s(2165),s(1038),s(7042),s(8309);var et=s(3173);function ot(it){return function(ft){if(Array.isArray(ft))return lt(ft)}(it)||function(ft){if(typeof Symbol<"u"&&ft[Symbol.iterator]!=null||ft["@@iterator"]!=null)return Array.from(ft)}(it)||function(ft,mt){if(ft){if(typeof ft=="string")return lt(ft,mt);var Tt=Object.prototype.toString.call(ft).slice(8,-1);return Tt==="Object"&&ft.constructor&&(Tt=ft.constructor.name),Tt==="Map"||Tt==="Set"?Array.from(ft):Tt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Tt)?lt(ft,mt):void 0}}(it)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function lt(it,ft){(ft==null||ft>it.length)&&(ft=it.length);for(var mt=0,Tt=new Array(ft);mt<ft;mt++)Tt[mt]=it[mt];return Tt}function St(it,ft){for(var mt=0;mt<ft.length;mt++){var Tt=ft[mt];Tt.enumerable=Tt.enumerable||!1,Tt.configurable=!0,"value"in Tt&&(Tt.writable=!0),Object.defineProperty(it,Tt.key,Tt)}}var pt=new Map,gt=et.g.LOG_LEVEL_WARN,ct=function(it){var ft,mt=null,Tt=null;for(ft=0;ft<it.length;ft++)typeof it[ft]=="string"&&(it[ft].indexOf('"type":"invite"')!==-1?it[ft].indexOf("candidate")===-1?it[ft].indexOf("S->C:")===-1?it[ft]="invite C->S: without candidate":it[ft]="invite S->C: without candidate":it[ft].indexOf("S->C:")===-1?it[ft]="invite C->S: with candidate":it[ft]="invite S->C: with candidate":it[ft].indexOf('"type":"200OK"')!==-1?it[ft].indexOf("candidate")===-1?it[ft].indexOf("S->C:")===-1?it[ft]="200OK C->S: without candidate":it[ft]="200OK S->C: without candidate":it[ft].indexOf("S->C:")===-1?it[ft]="200OK C->S: with candidate":it[ft]="200OK S->C: with candidate":it[ft].indexOf('"type":"candidate"')!==-1&&(it[ft].indexOf("S->C:")===-1?(mt=it[ft].replace(/C->S: /g,""),Tt=JSON.parse(mt),it[ft]="candidate C->S:"+Tt.candidate):(mt=it[ft].replace(/onChannelMessage S->C: /g,""),Tt=JSON.parse(mt),it[ft]="candidate S->C:"+Tt.candidate)));return it},ht=function(){function it(It){if(function(Pt,At){if(!(Pt instanceof At))throw new TypeError("Cannot call a class as a function")}(this,it),pt.has(It))throw new Error("Cannot construct singleton Logger");this.category=It,pt.set(It,this)}var ft,mt,Tt;return ft=it,mt=[{key:"trace",value:function(){for(var It=arguments.length,Pt=new Array(It),At=0;At<It;At++)Pt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_TRACE].concat(Pt))}},{key:"log",value:function(){for(var It=arguments.length,Pt=new Array(It),At=0;At<It;At++)Pt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_DEBUG].concat(Pt))}},{key:"debug",value:function(){for(var It=arguments.length,Pt=new Array(It),At=0;At<It;At++)Pt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_DEBUG].concat(Pt))}},{key:"info",value:function(){for(var It=arguments.length,Pt=new Array(It),At=0;At<It;At++)Pt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_INFO].concat(Pt))}},{key:"warn",value:function(){for(var It=arguments.length,Pt=new Array(It),At=0;At<It;At++)Pt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_WARN].concat(Pt))}},{key:"error",value:function(){for(var It=arguments.length,Pt=new Array(It),At=0;At<It;At++)Pt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_ERROR].concat(Pt))}},{key:"logMessage",value:function(It){for(var Pt=arguments.length,At=new Array(Pt>1?Pt-1:0),Nt=1;Nt<Pt;Nt++)At[Nt-1]=arguments[Nt];if(console!=null){if(It<=gt){var Ot="[".concat(new Date().toISOString(),"]");switch(It in et.g.LOG_LEVEL_LABELS&&(Ot+="[".concat(et.g.LOG_LEVEL_LABELS[It],"]")),Ot+=et.g.LOG_PREFIX+"(".concat(this.category,")"),It){case et.g.LOG_LEVEL_ERROR:var Mt;console.error&&(Mt=console).error.apply(Mt,[Ot].concat(ot(At)));break;case et.g.LOG_LEVEL_WARN:var bt;console.warn&&(bt=console).warn.apply(bt,[Ot].concat(ot(At)));break;case et.g.LOG_LEVEL_INFO:var Wt;console.info&&(Wt=console).info.apply(Wt,[Ot].concat(ot(At)));break;default:var zt;console.log&&(zt=console).log.apply(zt,[Ot].concat(ot(At)))}}typeof apiCC<"u"&&apiCC.logStorageActivated&&It<=apiCC.logStorageLevel&&(At=ct(At),apiCC.logStorage.push(JSON.stringify({name:"log",args:{0:"(".concat(this.category,")")+":"+At}})))}}}],Tt=[{key:"get",value:function(It){return pt.has(It)?pt.get(It):new it(It)}},{key:"setLogLevel",value:function(It){if(!Number.isInteger(It)||It<0)throw"Log level invalid";gt=It}},{key:"getLogLevel",value:function(){return gt}}],mt&&St(ft.prototype,mt),Tt&&St(ft,Tt),Object.defineProperty(ft,"prototype",{writable:!1}),it}()},3173:(at,ut,s)=>{s.d(ut,{g:()=>et}),s(2526),s(1817),s(1539);var et={LOG_PREFIX:"apiRTC",LOG_LEVEL_OFF:0,LOG_LEVEL_ERROR:1,LOG_LEVEL_WARN:2,LOG_LEVEL_INFO:3,LOG_LEVEL_DEBUG:4,LOG_LEVEL_TRACE:5,LOG_LEVEL_LABELS:{}};et.LOG_LEVEL_LABELS[et.LOG_LEVEL_ERROR]="ERROR",et.LOG_LEVEL_LABELS[et.LOG_LEVEL_WARN]="WARN",et.LOG_LEVEL_LABELS[et.LOG_LEVEL_INFO]="INFO",et.LOG_LEVEL_LABELS[et.LOG_LEVEL_DEBUG]="DEBUG",et.LOG_LEVEL_LABELS[et.LOG_LEVEL_TRACE]="TRACE",et.ERROR_OTHER=0,et.ERROR_INVALID_CREDENTIALS=1,et.ERROR_NETWORK_UNAVAILABLE=2,et.ERROR_SERVER_UNAVAILABLE=3,et.ERROR_UNAUTHORIZED=4,et.ERROR_APIRTC_INITIALISATION_FAILED=5,et.ERROR_APIRTC_SESSION_ALREADY_ON=6,et.ERROR_REGISTRATION_URI_INVALID=7,et.ERROR_NOT_FOUND=8,et.ERROR_BAD_PARAMETER=9,et.ERROR_INVITATION_STATE_INVALID=10,et.ERROR_TIMED_OUT=11,et.ERROR_STREAM_RECORD=12,et.ERROR_HTTP=13,et.ERROR_NOT_ALLOWED=14,et.ERROR_OPERATION_CANCELED=15,et.ERROR_WRONG_STATE=16,et.MEDIA_TYPE_PHOTO=0,et.MEDIA_TYPE_VIDEO=1,et.MEDIA_TYPE_AUDIO=2,et.MEDIA_TYPE_DOC=3,et.CONTACT_SEND_DATA_IDENTIFIER="contact_data",et.CONTACT_NEW_MEDIA_IDENTIFIER="contact_new_media",et.CONTACT_SEND_FILEINFO_IDENTIFIER="contact_file_info",et.CONTACT_DATACHANNEL_INVITATION="contact_datachannel_invitation",et.CONTACT_EVENTCENTER_DATA_REQUEST="contact_event_center_data_request",et.CONTACT_EVENTCENTER_DATA_ANSWER="contact_event_center_data_answer",et.CONTACT_GET_CAPABILITIES_IDENTIFIER="contact_get_capabilities",et.CONTACT_GET_CAPABILITIES_RESULT_IDENTIFIER="contact_get_capabilities_result",et.CONTACT_GET_SETTINGS_IDENTIFIER="contact_get_settings",et.CONTACT_GET_SETTINGS_RESULT_IDENTIFIER="contact_get_settings_result",et.CONTACT_GET_CONSTRAINTS_IDENTIFIER="contact_get_constraints",et.CONTACT_GET_CONSTRAINTS_RESULT_IDENTIFIER="contact_get_constraints_result",et.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER="contact_changed_constraints",et.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_IDENTIFIER="contact_get_remote_audio_flow_status",et.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_IDENTIFIER="contact_get_remote_video_flow_status",et.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_RESULT_IDENTIFIER="contact_get_remote_audio_flow_status_result",et.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_RESULT_IDENTIFIER="contact_get_remote_video_flow_status_result",et.CONTACT_GET_REMOTE_ERROR="contact_get_remote_error",et.CONTACT_APPLY_CONSTRAINTS_IDENTIFIER="contact_apply_constraints_identifier",et.CONTACT_APPLY_CONSTRAINTS_RESULT_IDENTIFIER="contact_apply_constraints_result_identifier",et.CONTACT_DISABLE_AUDIO_REQUEST="contact_disable_audio_request",et.CONTACT_DISABLE_AUDIO_ANSWER="contact_disable_audio_answer",et.CONTACT_ENABLE_AUDIO_REQUEST="contact_enable_audio_request",et.CONTACT_ENABLE_AUDIO_ANSWER="contact_enable_audio_answer",et.CONTACT_DISABLE_VIDEO_REQUEST="contact_disable_video_request",et.CONTACT_DISABLE_VIDEO_ANSWER="contact_disable_video_answer",et.CONTACT_ENABLE_VIDEO_REQUEST="contact_enable_video_request",et.CONTACT_ENABLE_VIDEO_ANSWER="contact_enable_video_answer",et.CONTACT_STREAM_UPDATED_INFO="contact_stream_updated_info",et.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER="contact_remote_access_invite",et.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER="contact_remote_access_answer",et.CONTACT_REMOTEACCESS_STOP_IDENTIFIER="contact_remote_access_stop",et.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE="contact_remote_access_app_status_message",et.CONTACT_REMOTEACCESS_APP_MESSAGE="contact_remote_access_app_message",et.CONVERSATION_ACCESS_GRANTED="GRANTED",et.CONVERSATION_NEED_MODERATOR_ACCEPTATION="NEED_MODERATOR_ACCEPTATION",et.CONVERSATION_ROLE_MODERATOR="moderator",et.CONVERSATION_ROLE_CONTRIBUTOR="contributor",et.CONVERSATION_ROLE_GUEST="guest",et.CONVERSATION_WAITING_ROOM_PREFIX="waiting-room-",et.CONVERSATION_SEND_DATA_IDENTIFIER="conv_data",et.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER="conv_persistent_data_update",et.CONVERSATION_JOIN_REQUEST_IDENTIFIER="conv_join_req",et.CONVERSATION_JOIN_ANSWER_IDENTIFIER="conv_join_ans",et.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER="conv_moderator_connected",et.CONVERSATION_NEW_MEDIA_IDENTIFIER="conv_new_media",et.CONVERSATION_CLOSED_IDENTIFIER="conv_closed",et.CONVERSATION_INVITATION_IDENTIFIER="conv_invite",et.INVITATION_ANSWER_IDENTIFIER="invite_ans",et.RECORD_BASE_URL="https://data2.apizee.com:10000/videoManager",et.RECORD_PLAY_URL=et.RECORD_BASE_URL+"?action=play&recordedFileName=",et.DEFAULT_MCU="mcu4.apizee.com",et.DEFAULT_TURNADDRESS="mp1.apizee.com",et.CALL_STATUS_WAITING_FOR_CALLEE=Symbol("CALL_STATUS_WAITING_FOR_CALLEE"),et.CALL_STATUS_ONGOING=Symbol("CALL_STATUS_ONGOING"),et.CALL_STATUS_ENDED=Symbol("CALL_STATUS_ENDED"),et.DATACHANNEL_STATUS_WAITING=Symbol("DATACHANNEL_STATUS_WAITING"),et.DATACHANNEL_STATUS_ONGOING=Symbol("DATACHANNEL_STATUS_ONGOING"),et.DATACHANNEL_STATUS_ENDED=Symbol("DATACHANNEL_STATUS_ENDED"),et.DATACHANNEL_TYPE_RECEIVE=Symbol("DATACHANNEL_TYPE_RECEIVE"),et.DATACHANNEL_TYPE_SEND=Symbol("DATACHANNEL_TYPE_SEND"),et.CONVERSATION_STATUS_JOINED=Symbol("CONVERSATION_STATUS_JOINED"),et.CONVERSATION_STATUS_NOT_JOINED=Symbol("CONVERSATION_STATUS_NOT_JOINED"),et.CONVERSATION_STATUS_WAITING=Symbol("CONVERSATION_STATUS_WAITING"),et.CONVERSATION_STATUS_JOINING=Symbol("CONVERSATION_STATUS_JOINING"),et.CONVERSATION_WHITEBOARD_STARTED=Symbol("CONVERSATION_WHITEBOARD_STARTED"),et.CONVERSATION_WHITEBOARD_NOT_STARTED=Symbol("CONVERSATION_WHITEBOARD_NOT_STARTED"),et.STATE_IDLE=Symbol("STATE_IDLE"),et.STATE_JOINING=Symbol("STATE_JOINING"),et.STATE_ACTIVE=Symbol("STATE_ACTIVE"),et.STATE_LEAVING=Symbol("STATE_LEAVING"),et.INVITATION_STATUS_ACCEPTED=Symbol("INVITATION_STATUS_ACCEPTED"),et.INVITATION_STATUS_DECLINED=Symbol("INVITATION_STATUS_DECLINED"),et.INVITATION_STATUS_STANDBY=Symbol("INVITATION_STATUS_STANDBY"),et.INVITATION_STATUS_EXPIRED=Symbol("INVITATION_STATUS_EXPIRED"),et.INVITATION_STATUS_CANCELLED=Symbol("INVITATION_STATUS_CANCELLED"),et.INVITATION_STATUS_ENDED=Symbol("INVITATION_STATUS_ENDED"),et.STREAM_TYPE_NO_INPUT="no_input",et.STREAM_TYPE_AUDIO="audio",et.STREAM_TYPE_VIDEO="video",et.STREAM_AUDIO_ANALYSIS_THRESHOLD=100,et.STREAM_AUDIO_NOISE_REDUCTION_VAI={soft:.7,medium:.8,hard:.9},et.CONTACT_DISCONNECTION_DELAY=1e4,et.CONVERSATION_JOIN_REQUEST_INTERVAL=5e3,et.APIRTC_MEDIA_DEVICE_DETECTION_DELAY=1e4,et.CONVERSATION_GROUP_CHAT_MEMBER_UPDATE_DELAY=5e3,et.CONVERSATION_WHITEBOARD_START_DELAY=5e3,et.CONVERSATION_RECORDING_STARTED_DELAY=1e4,et.CONVERSATION_RECORDING_STOPPED_DELAY=5e3,et.CONVERSATION_STREAMING_STARTED_DELAY=1e4,et.CONVERSATION_STREAMING_STOPPED_DELAY=1e4,et.CONVERSATION_PARTICIPANT_EJECTION_DELAY=5e3,et.JOIN_WAITING_ROOM_PRESENCE_GROUP_TIMEOUT=3e3},1215:(at,ut,s)=>{function et(pt){return et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(gt){return typeof gt}:function(gt){return gt&&typeof Symbol=="function"&&gt.constructor===Symbol&&gt!==Symbol.prototype?"symbol":typeof gt},et(pt)}function ot(pt,gt){return arguments.length===3?lt(arguments[0],arguments[1],arguments[2]):gt==="null"?pt===null:gt==="array"?pt!==null&&et(pt)==="object"&&Array.isArray(pt):pt!==null&&et(pt)===gt}function lt(pt,gt,ct){if(gt!==null&&et(gt)==="object"&&Array.isArray(gt)&&gt.length>=1){var ht=gt[0];if(gt.length>1)return ot(pt,"object")&&ot(ht,"string")&&pt.hasOwnProperty(ht)&&ot(pt[ht],"object")&&lt(pt[ht],gt.slice(1),ct);gt=ht}return ct==="undefined"?ot(pt,"object")&&ot(gt,"string")&&!pt.hasOwnProperty(gt)&&ot(pt[gt],ct):ot(pt,"object")&&ot(gt,"string")&&pt.hasOwnProperty(gt)&&ot(pt[gt],ct)}s.d(ut,{g:()=>St}),s(4916),s(5306),s(3710),s(1539),s(9714),s(7941),s(9575),s(6716),s(9554),s(6992),s(1532),s(8783),s(3948),s(9753),s(7042),s(3843),s(2564),s(2526),s(1817),s(2165);var St={assignObject:function(pt,gt){var ct,ht,it;for(pt==null&&(pt={}),ct=1;ct<arguments.length;ct+=1)for(ht in it=arguments[ct])it.hasOwnProperty(ht)&&(pt[ht]=it[ht]);return pt},throttle:function(pt,gt){var ct,ht,it,ft=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},mt=null,Tt=0,It=function(){Tt=ft.leading===!1?0:Date.now(),mt=null,it=pt.apply(ct,ht),mt||(ct=ht=null)};return function(){var Pt=Date.now();Tt||ft.leading!==!1||(Tt=Pt);var At=gt-(Pt-Tt);return ct=this,ht=arguments,At<=0||At>gt?(mt&&(clearTimeout(mt),mt=null),Tt=Pt,it=pt.apply(ct,ht),mt||(ct=ht=null)):mt||ft.trailing===!1||(mt=setTimeout(It,At)),it}},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(pt){var gt=16*Math.random()|0;return(pt==="x"?gt:3&gt|8).toString(16)})},hashString:function(pt){for(var gt=0,ct=0,ht=pt.length;ct<ht;)gt=(gt<<5)-gt+pt.charCodeAt(ct++)<<0;return Math.abs(gt)},arrayBuffertoString:function(pt){var gt=new DataView(pt);return new TextDecoder("utf-8").decode(gt)},getAudioContext:function(){return apiRTC.audioProcessor.getOrCreateAudioContext()},parseRecordingEvent:function(pt,gt){var ct=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return["roomName","callId","recordType","convId","mediaId","mediaURL","recordedFileName"].forEach(function(ht){gt.hasOwnProperty(ht)&&(ct[ht]=String(gt[ht]))}),gt.mediaType==="AUDIO-ONLY"?(ct.audioOnly=!0,ct.videoOnly=!1):gt.mediaType==="VIDEO-ONLY"?(ct.audioOnly=!1,ct.videoOnly=!0):(ct.audioOnly=!1,ct.videoOnly=!1),ct.recordType==="composite"&&(gt.hasOwnProperty("mode")?ct.mode=gt.mode:ct.mode="complete",gt.hasOwnProperty("labelEnabled")?(ct.labelEnabled=gt.labelEnabled===!0,ct.labelEnabled===!0&&gt.hasOwnProperty("labels")&&(ct.labels=gt.labels)):ct.labelEnabled=!1),ct},paramsToQueryString:function(pt){for(var gt="",ct=0,ht=Object.keys(pt);ct<ht.length;ct++){var it=ht[ct];gt+=gt===""?"?":"&",pt[it]===null||pt[it]===void 0?console.warn("apiRTC Utils - paramsToQueryString : "+it+" is undefined!"):gt+=it+"="+pt[it].toString()}return gt},createError:function(pt,gt,ct){var ht=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};ct&&ct.error(gt);var it={code:pt};return gt instanceof String?it.error=new Error(gt):gt instanceof Error?it.error=gt:it.error=new Error(String(gt)),ot(ht,"object")&&(ht.hasOwnProperty("fromError")&&(it.fromError=ht.fromError),ht.hasOwnProperty("httpCode")&&(it.httpCode=ht.httpCode)),it},isSet:function(pt){return pt!=null},isTypeof:ot,isPropertyTypeof:lt,_private:{dataCallsOnHold:new Map,dataChannelInvitations:new Map,dataCallsFileInfo:new Map}}},9662:(at,ut,s)=>{var et=s(614),ot=s(6330),lt=TypeError;at.exports=function(St){if(et(St))return St;throw lt(ot(St)+" is not a function")}},9483:(at,ut,s)=>{var et=s(4411),ot=s(6330),lt=TypeError;at.exports=function(St){if(et(St))return St;throw lt(ot(St)+" is not a constructor")}},6077:(at,ut,s)=>{var et=s(614),ot=String,lt=TypeError;at.exports=function(St){if(typeof St=="object"||et(St))return St;throw lt("Can't set "+ot(St)+" as a prototype")}},1223:(at,ut,s)=>{var et=s(5112),ot=s(30),lt=s(3070).f,St=et("unscopables"),pt=Array.prototype;pt[St]==null&&lt(pt,St,{configurable:!0,value:ot(null)}),at.exports=function(gt){pt[St][gt]=!0}},1530:(at,ut,s)=>{var et=s(8710).charAt;at.exports=function(ot,lt,St){return lt+(St?et(ot,lt).length:1)}},5787:(at,ut,s)=>{var et=s(7976),ot=TypeError;at.exports=function(lt,St){if(et(St,lt))return lt;throw ot("Incorrect invocation")}},9670:(at,ut,s)=>{var et=s(111),ot=String,lt=TypeError;at.exports=function(St){if(et(St))return St;throw lt(ot(St)+" is not an object")}},4019:at=>{at.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},7556:(at,ut,s)=>{var et=s(7293);at.exports=et(function(){if(typeof ArrayBuffer=="function"){var ot=new ArrayBuffer(8);Object.isExtensible(ot)&&Object.defineProperty(ot,"a",{value:8})}})},260:(at,ut,s)=>{var et,ot,lt,St=s(4019),pt=s(9781),gt=s(7854),ct=s(614),ht=s(111),it=s(2597),ft=s(648),mt=s(6330),Tt=s(8880),It=s(8052),Pt=s(3070).f,At=s(7976),Nt=s(9518),Ot=s(7674),Mt=s(5112),bt=s(9711),Wt=s(9909),zt=Wt.enforce,Bt=Wt.get,rn=gt.Int8Array,gn=rn&&rn.prototype,tn=gt.Uint8ClampedArray,Ht=tn&&tn.prototype,fn=rn&&Nt(rn),bn=gn&&Nt(gn),In=Object.prototype,un=gt.TypeError,mn=Mt("toStringTag"),yn=bt("TYPED_ARRAY_TAG"),pn=St&&!!Ot&&ft(gt.opera)!=="Opera",Tn=!1,kn={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},xn={BigInt64Array:8,BigUint64Array:8},Mn=function(An){var Nn=Nt(An);if(ht(Nn)){var Un=Bt(Nn);return Un&&it(Un,"TypedArrayConstructor")?Un.TypedArrayConstructor:Mn(Nn)}},Dn=function(An){if(!ht(An))return!1;var Nn=ft(An);return it(kn,Nn)||it(xn,Nn)};for(et in kn)(lt=(ot=gt[et])&&ot.prototype)?zt(lt).TypedArrayConstructor=ot:pn=!1;for(et in xn)(lt=(ot=gt[et])&&ot.prototype)&&(zt(lt).TypedArrayConstructor=ot);if((!pn||!ct(fn)||fn===Function.prototype)&&(fn=function(){throw un("Incorrect invocation")},pn))for(et in kn)gt[et]&&Ot(gt[et],fn);if((!pn||!bn||bn===In)&&(bn=fn.prototype,pn))for(et in kn)gt[et]&&Ot(gt[et].prototype,bn);if(pn&&Nt(Ht)!==bn&&Ot(Ht,bn),pt&&!it(bn,mn))for(et in Tn=!0,Pt(bn,mn,{get:function(){return ht(this)?this[yn]:void 0}}),kn)gt[et]&&Tt(gt[et],yn,et);at.exports={NATIVE_ARRAY_BUFFER_VIEWS:pn,TYPED_ARRAY_TAG:Tn&&yn,aTypedArray:function(An){if(Dn(An))return An;throw un("Target is not a typed array")},aTypedArrayConstructor:function(An){if(ct(An)&&(!Ot||At(fn,An)))return An;throw un(mt(An)+" is not a typed array constructor")},exportTypedArrayMethod:function(An,Nn,Un,Qn){if(pt){if(Un)for(var er in kn){var zn=gt[er];if(zn&&it(zn.prototype,An))try{delete zn.prototype[An]}catch{try{zn.prototype[An]=Nn}catch{}}}bn[An]&&!Un||It(bn,An,Un?Nn:pn&&gn[An]||Nn,Qn)}},exportTypedArrayStaticMethod:function(An,Nn,Un){var Qn,er;if(pt){if(Ot){if(Un){for(Qn in kn)if((er=gt[Qn])&&it(er,An))try{delete er[An]}catch{}}if(fn[An]&&!Un)return;try{return It(fn,An,Un?Nn:pn&&fn[An]||Nn)}catch{}}for(Qn in kn)!(er=gt[Qn])||er[An]&&!Un||It(er,An,Nn)}},getTypedArrayConstructor:Mn,isView:function(An){if(!ht(An))return!1;var Nn=ft(An);return Nn==="DataView"||it(kn,Nn)||it(xn,Nn)},isTypedArray:Dn,TypedArray:fn,TypedArrayPrototype:bn}},3331:(at,ut,s)=>{var et=s(7854),ot=s(1702),lt=s(9781),St=s(4019),pt=s(6530),gt=s(8880),ct=s(9190),ht=s(7293),it=s(5787),ft=s(9303),mt=s(7466),Tt=s(7067),It=s(1179),Pt=s(9518),At=s(7674),Nt=s(8006).f,Ot=s(3070).f,Mt=s(1285),bt=s(1589),Wt=s(8003),zt=s(9909),Bt=pt.PROPER,rn=pt.CONFIGURABLE,gn=zt.get,tn=zt.set,Ht="ArrayBuffer",fn="Wrong index",bn=et.ArrayBuffer,In=bn,un=In&&In.prototype,mn=et.DataView,yn=mn&&mn.prototype,pn=Object.prototype,Tn=et.Array,kn=et.RangeError,xn=ot(Mt),Mn=ot([].reverse),Dn=It.pack,An=It.unpack,Nn=function(vn){return[255&vn]},Un=function(vn){return[255&vn,vn>>8&255]},Qn=function(vn){return[255&vn,vn>>8&255,vn>>16&255,vn>>24&255]},er=function(vn){return vn[3]<<24|vn[2]<<16|vn[1]<<8|vn[0]},zn=function(vn){return Dn(vn,23,4)},lr=function(vn){return Dn(vn,52,8)},cn=function(vn,On){Ot(vn.prototype,On,{get:function(){return gn(this)[On]}})},Gn=function(vn,On,Kt,Rt){var nt=Tt(Kt),Ct=gn(vn);if(nt+On>Ct.byteLength)throw kn(fn);var yt=gn(Ct.buffer).bytes,xt=nt+Ct.byteOffset,wt=bt(yt,xt,xt+On);return Rt?wt:Mn(wt)},Yn=function(vn,On,Kt,Rt,nt,Ct){var yt=Tt(Kt),xt=gn(vn);if(yt+On>xt.byteLength)throw kn(fn);for(var wt=gn(xt.buffer).bytes,Lt=yt+xt.byteOffset,Et=Rt(+nt),$t=0;$t<On;$t++)wt[Lt+$t]=Et[Ct?$t:On-$t-1]};if(St){var or=Bt&&bn.name!==Ht;if(ht(function(){bn(1)})&&ht(function(){new bn(-1)})&&!ht(function(){return new bn,new bn(1.5),new bn(NaN),or&&!rn}))or&&rn&&gt(bn,"name",Ht);else{(In=function(vn){return it(this,un),new bn(Tt(vn))}).prototype=un;for(var Bn,rr=Nt(bn),Zn=0;rr.length>Zn;)(Bn=rr[Zn++])in In||gt(In,Bn,bn[Bn]);un.constructor=In}At&&Pt(yn)!==pn&&At(yn,pn);var _n=new mn(new In(2)),Ln=ot(yn.setInt8);_n.setInt8(0,2147483648),_n.setInt8(1,2147483649),!_n.getInt8(0)&&_n.getInt8(1)||ct(yn,{setInt8:function(vn,On){Ln(this,vn,On<<24>>24)},setUint8:function(vn,On){Ln(this,vn,On<<24>>24)}},{unsafe:!0})}else un=(In=function(vn){it(this,un);var On=Tt(vn);tn(this,{bytes:xn(Tn(On),0),byteLength:On}),lt||(this.byteLength=On)}).prototype,yn=(mn=function(vn,On,Kt){it(this,yn),it(vn,un);var Rt=gn(vn).byteLength,nt=ft(On);if(nt<0||nt>Rt)throw kn("Wrong offset");if(nt+(Kt=Kt===void 0?Rt-nt:mt(Kt))>Rt)throw kn("Wrong length");tn(this,{buffer:vn,byteLength:Kt,byteOffset:nt}),lt||(this.buffer=vn,this.byteLength=Kt,this.byteOffset=nt)}).prototype,lt&&(cn(In,"byteLength"),cn(mn,"buffer"),cn(mn,"byteLength"),cn(mn,"byteOffset")),ct(yn,{getInt8:function(vn){return Gn(this,1,vn)[0]<<24>>24},getUint8:function(vn){return Gn(this,1,vn)[0]},getInt16:function(vn){var On=Gn(this,2,vn,arguments.length>1?arguments[1]:void 0);return(On[1]<<8|On[0])<<16>>16},getUint16:function(vn){var On=Gn(this,2,vn,arguments.length>1?arguments[1]:void 0);return On[1]<<8|On[0]},getInt32:function(vn){return er(Gn(this,4,vn,arguments.length>1?arguments[1]:void 0))},getUint32:function(vn){return er(Gn(this,4,vn,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(vn){return An(Gn(this,4,vn,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(vn){return An(Gn(this,8,vn,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(vn,On){Yn(this,1,vn,Nn,On)},setUint8:function(vn,On){Yn(this,1,vn,Nn,On)},setInt16:function(vn,On){Yn(this,2,vn,Un,On,arguments.length>2?arguments[2]:void 0)},setUint16:function(vn,On){Yn(this,2,vn,Un,On,arguments.length>2?arguments[2]:void 0)},setInt32:function(vn,On){Yn(this,4,vn,Qn,On,arguments.length>2?arguments[2]:void 0)},setUint32:function(vn,On){Yn(this,4,vn,Qn,On,arguments.length>2?arguments[2]:void 0)},setFloat32:function(vn,On){Yn(this,4,vn,zn,On,arguments.length>2?arguments[2]:void 0)},setFloat64:function(vn,On){Yn(this,8,vn,lr,On,arguments.length>2?arguments[2]:void 0)}});Wt(In,Ht),Wt(mn,"DataView"),at.exports={ArrayBuffer:In,DataView:mn}},1048:(at,ut,s)=>{var et=s(7908),ot=s(1400),lt=s(6244),St=s(5117),pt=Math.min;at.exports=[].copyWithin||function(gt,ct){var ht=et(this),it=lt(ht),ft=ot(gt,it),mt=ot(ct,it),Tt=arguments.length>2?arguments[2]:void 0,It=pt((Tt===void 0?it:ot(Tt,it))-mt,it-ft),Pt=1;for(mt<ft&&ft<mt+It&&(Pt=-1,mt+=It-1,ft+=It-1);It-- >0;)mt in ht?ht[ft]=ht[mt]:St(ht,ft),ft+=Pt,mt+=Pt;return ht}},1285:(at,ut,s)=>{var et=s(7908),ot=s(1400),lt=s(6244);at.exports=function(St){for(var pt=et(this),gt=lt(pt),ct=arguments.length,ht=ot(ct>1?arguments[1]:void 0,gt),it=ct>2?arguments[2]:void 0,ft=it===void 0?gt:ot(it,gt);ft>ht;)pt[ht++]=St;return pt}},8533:(at,ut,s)=>{var et=s(2092).forEach,ot=s(9341)("forEach");at.exports=ot?[].forEach:function(lt){return et(this,lt,arguments.length>1?arguments[1]:void 0)}},7745:(at,ut,s)=>{var et=s(6244);at.exports=function(ot,lt){for(var St=0,pt=et(lt),gt=new ot(pt);pt>St;)gt[St]=lt[St++];return gt}},8457:(at,ut,s)=>{var et=s(9974),ot=s(6916),lt=s(7908),St=s(3411),pt=s(7659),gt=s(4411),ct=s(6244),ht=s(6135),it=s(8554),ft=s(1246),mt=Array;at.exports=function(Tt){var It=lt(Tt),Pt=gt(this),At=arguments.length,Nt=At>1?arguments[1]:void 0,Ot=Nt!==void 0;Ot&&(Nt=et(Nt,At>2?arguments[2]:void 0));var Mt,bt,Wt,zt,Bt,rn,gn=ft(It),tn=0;if(!gn||this===mt&&pt(gn))for(Mt=ct(It),bt=Pt?new this(Mt):mt(Mt);Mt>tn;tn++)rn=Ot?Nt(It[tn],tn):It[tn],ht(bt,tn,rn);else for(Bt=(zt=it(It,gn)).next,bt=Pt?new this:[];!(Wt=ot(Bt,zt)).done;tn++)rn=Ot?St(zt,Nt,[Wt.value,tn],!0):Wt.value,ht(bt,tn,rn);return bt.length=tn,bt}},1318:(at,ut,s)=>{var et=s(5656),ot=s(1400),lt=s(6244),St=function(pt){return function(gt,ct,ht){var it,ft=et(gt),mt=lt(ft),Tt=ot(ht,mt);if(pt&&ct!=ct){for(;mt>Tt;)if((it=ft[Tt++])!=it)return!0}else for(;mt>Tt;Tt++)if((pt||Tt in ft)&&ft[Tt]===ct)return pt||Tt||0;return!pt&&-1}};at.exports={includes:St(!0),indexOf:St(!1)}},2092:(at,ut,s)=>{var et=s(9974),ot=s(1702),lt=s(8361),St=s(7908),pt=s(6244),gt=s(5417),ct=ot([].push),ht=function(it){var ft=it==1,mt=it==2,Tt=it==3,It=it==4,Pt=it==6,At=it==7,Nt=it==5||Pt;return function(Ot,Mt,bt,Wt){for(var zt,Bt,rn=St(Ot),gn=lt(rn),tn=et(Mt,bt),Ht=pt(gn),fn=0,bn=Wt||gt,In=ft?bn(Ot,Ht):mt||At?bn(Ot,0):void 0;Ht>fn;fn++)if((Nt||fn in gn)&&(Bt=tn(zt=gn[fn],fn,rn),it))if(ft)In[fn]=Bt;else if(Bt)switch(it){case 3:return!0;case 5:return zt;case 6:return fn;case 2:ct(In,zt)}else switch(it){case 4:return!1;case 7:ct(In,zt)}return Pt?-1:Tt||It?It:In}};at.exports={forEach:ht(0),map:ht(1),filter:ht(2),some:ht(3),every:ht(4),find:ht(5),findIndex:ht(6),filterReject:ht(7)}},6583:(at,ut,s)=>{var et=s(2104),ot=s(5656),lt=s(9303),St=s(6244),pt=s(9341),gt=Math.min,ct=[].lastIndexOf,ht=!!ct&&1/[1].lastIndexOf(1,-0)<0,it=pt("lastIndexOf"),ft=ht||!it;at.exports=ft?function(mt){if(ht)return et(ct,this,arguments)||0;var Tt=ot(this),It=St(Tt),Pt=It-1;for(arguments.length>1&&(Pt=gt(Pt,lt(arguments[1]))),Pt<0&&(Pt=It+Pt);Pt>=0;Pt--)if(Pt in Tt&&Tt[Pt]===mt)return Pt||0;return-1}:ct},1194:(at,ut,s)=>{var et=s(7293),ot=s(5112),lt=s(7392),St=ot("species");at.exports=function(pt){return lt>=51||!et(function(){var gt=[];return(gt.constructor={})[St]=function(){return{foo:1}},gt[pt](Boolean).foo!==1})}},9341:(at,ut,s)=>{var et=s(7293);at.exports=function(ot,lt){var St=[][ot];return!!St&&et(function(){St.call(null,lt||function(){return 1},1)})}},3671:(at,ut,s)=>{var et=s(9662),ot=s(7908),lt=s(8361),St=s(6244),pt=TypeError,gt=function(ct){return function(ht,it,ft,mt){et(it);var Tt=ot(ht),It=lt(Tt),Pt=St(Tt),At=ct?Pt-1:0,Nt=ct?-1:1;if(ft<2)for(;;){if(At in It){mt=It[At],At+=Nt;break}if(At+=Nt,ct?At<0:Pt<=At)throw pt("Reduce of empty array with no initial value")}for(;ct?At>=0:Pt>At;At+=Nt)At in It&&(mt=it(mt,It[At],At,Tt));return mt}};at.exports={left:gt(!1),right:gt(!0)}},1589:(at,ut,s)=>{var et=s(1400),ot=s(6244),lt=s(6135),St=Array,pt=Math.max;at.exports=function(gt,ct,ht){for(var it=ot(gt),ft=et(ct,it),mt=et(ht===void 0?it:ht,it),Tt=St(pt(mt-ft,0)),It=0;ft<mt;ft++,It++)lt(Tt,It,gt[ft]);return Tt.length=It,Tt}},206:(at,ut,s)=>{var et=s(1702);at.exports=et([].slice)},4362:(at,ut,s)=>{var et=s(1589),ot=Math.floor,lt=function(gt,ct){var ht=gt.length,it=ot(ht/2);return ht<8?St(gt,ct):pt(gt,lt(et(gt,0,it),ct),lt(et(gt,it),ct),ct)},St=function(gt,ct){for(var ht,it,ft=gt.length,mt=1;mt<ft;){for(it=mt,ht=gt[mt];it&&ct(gt[it-1],ht)>0;)gt[it]=gt[--it];it!==mt++&&(gt[it]=ht)}return gt},pt=function(gt,ct,ht,it){for(var ft=ct.length,mt=ht.length,Tt=0,It=0;Tt<ft||It<mt;)gt[Tt+It]=Tt<ft&&It<mt?it(ct[Tt],ht[It])<=0?ct[Tt++]:ht[It++]:Tt<ft?ct[Tt++]:ht[It++];return gt};at.exports=lt},7475:(at,ut,s)=>{var et=s(3157),ot=s(4411),lt=s(111),St=s(5112)("species"),pt=Array;at.exports=function(gt){var ct;return et(gt)&&(ct=gt.constructor,(ot(ct)&&(ct===pt||et(ct.prototype))||lt(ct)&&(ct=ct[St])===null)&&(ct=void 0)),ct===void 0?pt:ct}},5417:(at,ut,s)=>{var et=s(7475);at.exports=function(ot,lt){return new(et(ot))(lt===0?0:lt)}},3411:(at,ut,s)=>{var et=s(9670),ot=s(9212);at.exports=function(lt,St,pt,gt){try{return gt?St(et(pt)[0],pt[1]):St(pt)}catch(ct){ot(lt,"throw",ct)}}},7072:(at,ut,s)=>{var et=s(5112)("iterator"),ot=!1;try{var lt=0,St={next:function(){return{done:!!lt++}},return:function(){ot=!0}};St[et]=function(){return this},Array.from(St,function(){throw 2})}catch{}at.exports=function(pt,gt){if(!gt&&!ot)return!1;var ct=!1;try{var ht={};ht[et]=function(){return{next:function(){return{done:ct=!0}}}},pt(ht)}catch{}return ct}},4326:(at,ut,s)=>{var et=s(1702),ot=et({}.toString),lt=et("".slice);at.exports=function(St){return lt(ot(St),8,-1)}},648:(at,ut,s)=>{var et=s(1694),ot=s(614),lt=s(4326),St=s(5112)("toStringTag"),pt=Object,gt=lt(function(){return arguments}())=="Arguments";at.exports=et?lt:function(ct){var ht,it,ft;return ct===void 0?"Undefined":ct===null?"Null":typeof(it=function(mt,Tt){try{return mt[Tt]}catch{}}(ht=pt(ct),St))=="string"?it:gt?lt(ht):(ft=lt(ht))=="Object"&&ot(ht.callee)?"Arguments":ft}},5631:(at,ut,s)=>{var et=s(3070).f,ot=s(30),lt=s(9190),St=s(9974),pt=s(5787),gt=s(408),ct=s(654),ht=s(6340),it=s(9781),ft=s(2423).fastKey,mt=s(9909),Tt=mt.set,It=mt.getterFor;at.exports={getConstructor:function(Pt,At,Nt,Ot){var Mt=Pt(function(rn,gn){pt(rn,bt),Tt(rn,{type:At,index:ot(null),first:void 0,last:void 0,size:0}),it||(rn.size=0),gn!=null&&gt(gn,rn[Ot],{that:rn,AS_ENTRIES:Nt})}),bt=Mt.prototype,Wt=It(At),zt=function(rn,gn,tn){var Ht,fn,bn=Wt(rn),In=Bt(rn,gn);return In?In.value=tn:(bn.last=In={index:fn=ft(gn,!0),key:gn,value:tn,previous:Ht=bn.last,next:void 0,removed:!1},bn.first||(bn.first=In),Ht&&(Ht.next=In),it?bn.size++:rn.size++,fn!=="F"&&(bn.index[fn]=In)),rn},Bt=function(rn,gn){var tn,Ht=Wt(rn),fn=ft(gn);if(fn!=="F")return Ht.index[fn];for(tn=Ht.first;tn;tn=tn.next)if(tn.key==gn)return tn};return lt(bt,{clear:function(){for(var rn=Wt(this),gn=rn.index,tn=rn.first;tn;)tn.removed=!0,tn.previous&&(tn.previous=tn.previous.next=void 0),delete gn[tn.index],tn=tn.next;rn.first=rn.last=void 0,it?rn.size=0:this.size=0},delete:function(rn){var gn=this,tn=Wt(gn),Ht=Bt(gn,rn);if(Ht){var fn=Ht.next,bn=Ht.previous;delete tn.index[Ht.index],Ht.removed=!0,bn&&(bn.next=fn),fn&&(fn.previous=bn),tn.first==Ht&&(tn.first=fn),tn.last==Ht&&(tn.last=bn),it?tn.size--:gn.size--}return!!Ht},forEach:function(rn){for(var gn,tn=Wt(this),Ht=St(rn,arguments.length>1?arguments[1]:void 0);gn=gn?gn.next:tn.first;)for(Ht(gn.value,gn.key,this);gn&&gn.removed;)gn=gn.previous},has:function(rn){return!!Bt(this,rn)}}),lt(bt,Nt?{get:function(rn){var gn=Bt(this,rn);return gn&&gn.value},set:function(rn,gn){return zt(this,rn===0?0:rn,gn)}}:{add:function(rn){return zt(this,rn=rn===0?0:rn,rn)}}),it&&et(bt,"size",{get:function(){return Wt(this).size}}),Mt},setStrong:function(Pt,At,Nt){var Ot=At+" Iterator",Mt=It(At),bt=It(Ot);ct(Pt,At,function(Wt,zt){Tt(this,{type:Ot,target:Wt,state:Mt(Wt),kind:zt,last:void 0})},function(){for(var Wt=bt(this),zt=Wt.kind,Bt=Wt.last;Bt&&Bt.removed;)Bt=Bt.previous;return Wt.target&&(Wt.last=Bt=Bt?Bt.next:Wt.state.first)?zt=="keys"?{value:Bt.key,done:!1}:zt=="values"?{value:Bt.value,done:!1}:{value:[Bt.key,Bt.value],done:!1}:(Wt.target=void 0,{value:void 0,done:!0})},Nt?"entries":"values",!Nt,!0),ht(At)}}},9320:(at,ut,s)=>{var et=s(1702),ot=s(9190),lt=s(2423).getWeakData,St=s(9670),pt=s(111),gt=s(5787),ct=s(408),ht=s(2092),it=s(2597),ft=s(9909),mt=ft.set,Tt=ft.getterFor,It=ht.find,Pt=ht.findIndex,At=et([].splice),Nt=0,Ot=function(Wt){return Wt.frozen||(Wt.frozen=new Mt)},Mt=function(){this.entries=[]},bt=function(Wt,zt){return It(Wt.entries,function(Bt){return Bt[0]===zt})};Mt.prototype={get:function(Wt){var zt=bt(this,Wt);if(zt)return zt[1]},has:function(Wt){return!!bt(this,Wt)},set:function(Wt,zt){var Bt=bt(this,Wt);Bt?Bt[1]=zt:this.entries.push([Wt,zt])},delete:function(Wt){var zt=Pt(this.entries,function(Bt){return Bt[0]===Wt});return~zt&&At(this.entries,zt,1),!!~zt}},at.exports={getConstructor:function(Wt,zt,Bt,rn){var gn=Wt(function(bn,In){gt(bn,tn),mt(bn,{type:zt,id:Nt++,frozen:void 0}),In!=null&&ct(In,bn[rn],{that:bn,AS_ENTRIES:Bt})}),tn=gn.prototype,Ht=Tt(zt),fn=function(bn,In,un){var mn=Ht(bn),yn=lt(St(In),!0);return yn===!0?Ot(mn).set(In,un):yn[mn.id]=un,bn};return ot(tn,{delete:function(bn){var In=Ht(this);if(!pt(bn))return!1;var un=lt(bn);return un===!0?Ot(In).delete(bn):un&&it(un,In.id)&&delete un[In.id]},has:function(bn){var In=Ht(this);if(!pt(bn))return!1;var un=lt(bn);return un===!0?Ot(In).has(bn):un&&it(un,In.id)}}),ot(tn,Bt?{get:function(bn){var In=Ht(this);if(pt(bn)){var un=lt(bn);return un===!0?Ot(In).get(bn):un?un[In.id]:void 0}},set:function(bn,In){return fn(this,bn,In)}}:{add:function(bn){return fn(this,bn,!0)}}),gn}}},7710:(at,ut,s)=>{var et=s(2109),ot=s(7854),lt=s(1702),St=s(4705),pt=s(8052),gt=s(2423),ct=s(408),ht=s(5787),it=s(614),ft=s(111),mt=s(7293),Tt=s(7072),It=s(8003),Pt=s(9587);at.exports=function(At,Nt,Ot){var Mt=At.indexOf("Map")!==-1,bt=At.indexOf("Weak")!==-1,Wt=Mt?"set":"add",zt=ot[At],Bt=zt&&zt.prototype,rn=zt,gn={},tn=function(mn){var yn=lt(Bt[mn]);pt(Bt,mn,mn=="add"?function(pn){return yn(this,pn===0?0:pn),this}:mn=="delete"?function(pn){return!(bt&&!ft(pn))&&yn(this,pn===0?0:pn)}:mn=="get"?function(pn){return bt&&!ft(pn)?void 0:yn(this,pn===0?0:pn)}:mn=="has"?function(pn){return!(bt&&!ft(pn))&&yn(this,pn===0?0:pn)}:function(pn,Tn){return yn(this,pn===0?0:pn,Tn),this})};if(St(At,!it(zt)||!(bt||Bt.forEach&&!mt(function(){new zt().entries().next()}))))rn=Ot.getConstructor(Nt,At,Mt,Wt),gt.enable();else if(St(At,!0)){var Ht=new rn,fn=Ht[Wt](bt?{}:-0,1)!=Ht,bn=mt(function(){Ht.has(1)}),In=Tt(function(mn){new zt(mn)}),un=!bt&&mt(function(){for(var mn=new zt,yn=5;yn--;)mn[Wt](yn,yn);return!mn.has(-0)});In||((rn=Nt(function(mn,yn){ht(mn,Bt);var pn=Pt(new zt,mn,rn);return yn!=null&&ct(yn,pn[Wt],{that:pn,AS_ENTRIES:Mt}),pn})).prototype=Bt,Bt.constructor=rn),(bn||un)&&(tn("delete"),tn("has"),Mt&&tn("get")),(un||fn)&&tn(Wt),bt&&Bt.clear&&delete Bt.clear}return gn[At]=rn,et({global:!0,constructor:!0,forced:rn!=zt},gn),It(rn,At),bt||Ot.setStrong(rn,At,Mt),rn}},9920:(at,ut,s)=>{var et=s(2597),ot=s(3887),lt=s(1236),St=s(3070);at.exports=function(pt,gt,ct){for(var ht=ot(gt),it=St.f,ft=lt.f,mt=0;mt<ht.length;mt++){var Tt=ht[mt];et(pt,Tt)||ct&&et(ct,Tt)||it(pt,Tt,ft(gt,Tt))}}},4964:(at,ut,s)=>{var et=s(5112)("match");at.exports=function(ot){var lt=/./;try{"/./"[ot](lt)}catch{try{return lt[et]=!1,"/./"[ot](lt)}catch{}}return!1}},8544:(at,ut,s)=>{var et=s(7293);at.exports=!et(function(){function ot(){}return ot.prototype.constructor=null,Object.getPrototypeOf(new ot)!==ot.prototype})},4994:(at,ut,s)=>{var et=s(3383).IteratorPrototype,ot=s(30),lt=s(9114),St=s(8003),pt=s(7497),gt=function(){return this};at.exports=function(ct,ht,it,ft){var mt=ht+" Iterator";return ct.prototype=ot(et,{next:lt(+!ft,it)}),St(ct,mt,!1,!0),pt[mt]=gt,ct}},8880:(at,ut,s)=>{var et=s(9781),ot=s(3070),lt=s(9114);at.exports=et?function(St,pt,gt){return ot.f(St,pt,lt(1,gt))}:function(St,pt,gt){return St[pt]=gt,St}},9114:at=>{at.exports=function(ut,s){return{enumerable:!(1&ut),configurable:!(2&ut),writable:!(4&ut),value:s}}},6135:(at,ut,s)=>{var et=s(4948),ot=s(3070),lt=s(9114);at.exports=function(St,pt,gt){var ct=et(pt);ct in St?ot.f(St,ct,lt(0,gt)):St[ct]=gt}},5573:(at,ut,s)=>{var et=s(1702),ot=s(7293),lt=s(6650).start,St=RangeError,pt=Math.abs,gt=Date.prototype,ct=gt.toISOString,ht=et(gt.getTime),it=et(gt.getUTCDate),ft=et(gt.getUTCFullYear),mt=et(gt.getUTCHours),Tt=et(gt.getUTCMilliseconds),It=et(gt.getUTCMinutes),Pt=et(gt.getUTCMonth),At=et(gt.getUTCSeconds);at.exports=ot(function(){return ct.call(new Date(-50000000000001))!="0385-07-25T07:06:39.999Z"})||!ot(function(){ct.call(new Date(NaN))})?function(){if(!isFinite(ht(this)))throw St("Invalid time value");var Nt=this,Ot=ft(Nt),Mt=Tt(Nt),bt=Ot<0?"-":Ot>9999?"+":"";return bt+lt(pt(Ot),bt?6:4,0)+"-"+lt(Pt(Nt)+1,2,0)+"-"+lt(it(Nt),2,0)+"T"+lt(mt(Nt),2,0)+":"+lt(It(Nt),2,0)+":"+lt(At(Nt),2,0)+"."+lt(Mt,3,0)+"Z"}:ct},7045:(at,ut,s)=>{var et=s(6339),ot=s(3070);at.exports=function(lt,St,pt){return pt.get&&et(pt.get,St,{getter:!0}),pt.set&&et(pt.set,St,{setter:!0}),ot.f(lt,St,pt)}},8052:(at,ut,s)=>{var et=s(614),ot=s(3070),lt=s(6339),St=s(3072);at.exports=function(pt,gt,ct,ht){ht||(ht={});var it=ht.enumerable,ft=ht.name!==void 0?ht.name:gt;if(et(ct)&&lt(ct,ft,ht),ht.global)it?pt[gt]=ct:St(gt,ct);else{try{ht.unsafe?pt[gt]&&(it=!0):delete pt[gt]}catch{}it?pt[gt]=ct:ot.f(pt,gt,{value:ct,enumerable:!1,configurable:!ht.nonConfigurable,writable:!ht.nonWritable})}return pt}},9190:(at,ut,s)=>{var et=s(8052);at.exports=function(ot,lt,St){for(var pt in lt)et(ot,pt,lt[pt],St);return ot}},3072:(at,ut,s)=>{var et=s(7854),ot=Object.defineProperty;at.exports=function(lt,St){try{ot(et,lt,{value:St,configurable:!0,writable:!0})}catch{et[lt]=St}return St}},654:(at,ut,s)=>{var et=s(2109),ot=s(6916),lt=s(1913),St=s(6530),pt=s(614),gt=s(4994),ct=s(9518),ht=s(7674),it=s(8003),ft=s(8880),mt=s(8052),Tt=s(5112),It=s(7497),Pt=s(3383),At=St.PROPER,Nt=St.CONFIGURABLE,Ot=Pt.IteratorPrototype,Mt=Pt.BUGGY_SAFARI_ITERATORS,bt=Tt("iterator"),Wt="keys",zt="values",Bt="entries",rn=function(){return this};at.exports=function(gn,tn,Ht,fn,bn,In,un){gt(Ht,tn,fn);var mn,yn,pn,Tn=function(Un){if(Un===bn&&An)return An;if(!Mt&&Un in Mn)return Mn[Un];switch(Un){case Wt:case zt:case Bt:return function(){return new Ht(this,Un)}}return function(){return new Ht(this)}},kn=tn+" Iterator",xn=!1,Mn=gn.prototype,Dn=Mn[bt]||Mn["@@iterator"]||bn&&Mn[bn],An=!Mt&&Dn||Tn(bn),Nn=tn=="Array"&&Mn.entries||Dn;if(Nn&&(mn=ct(Nn.call(new gn)))!==Object.prototype&&mn.next&&(lt||ct(mn)===Ot||(ht?ht(mn,Ot):pt(mn[bt])||mt(mn,bt,rn)),it(mn,kn,!0,!0),lt&&(It[kn]=rn)),At&&bn==zt&&Dn&&Dn.name!==zt&&(!lt&&Nt?ft(Mn,"name",zt):(xn=!0,An=function(){return ot(Dn,this)})),bn)if(yn={values:Tn(zt),keys:In?An:Tn(Wt),entries:Tn(Bt)},un)for(pn in yn)(Mt||xn||!(pn in Mn))&&mt(Mn,pn,yn[pn]);else et({target:tn,proto:!0,forced:Mt||xn},yn);return lt&&!un||Mn[bt]===An||mt(Mn,bt,An,{name:bn}),It[tn]=An,yn}},7235:(at,ut,s)=>{var et=s(857),ot=s(2597),lt=s(6061),St=s(3070).f;at.exports=function(pt){var gt=et.Symbol||(et.Symbol={});ot(gt,pt)||St(gt,pt,{value:lt.f(pt)})}},5117:(at,ut,s)=>{var et=s(6330),ot=TypeError;at.exports=function(lt,St){if(!delete lt[St])throw ot("Cannot delete property "+et(St)+" of "+et(lt))}},9781:(at,ut,s)=>{var et=s(7293);at.exports=!et(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},317:(at,ut,s)=>{var et=s(7854),ot=s(111),lt=et.document,St=ot(lt)&&ot(lt.createElement);at.exports=function(pt){return St?lt.createElement(pt):{}}},7207:at=>{var ut=TypeError;at.exports=function(s){if(s>9007199254740991)throw ut("Maximum allowed index exceeded");return s}},8324:at=>{at.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(at,ut,s)=>{var et=s(317)("span").classList,ot=et&&et.constructor&&et.constructor.prototype;at.exports=ot===Object.prototype?void 0:ot},8886:(at,ut,s)=>{var et=s(8113).match(/firefox\/(\d+)/i);at.exports=!!et&&+et[1]},7871:at=>{at.exports=typeof window=="object"&&typeof Deno!="object"},256:(at,ut,s)=>{var et=s(8113);at.exports=/MSIE|Trident/.test(et)},1528:(at,ut,s)=>{var et=s(8113),ot=s(7854);at.exports=/ipad|iphone|ipod/i.test(et)&&ot.Pebble!==void 0},6833:(at,ut,s)=>{var et=s(8113);at.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(et)},2805:(at,ut,s)=>{var et=s(4326),ot=s(7854);at.exports=et(ot.process)=="process"},1036:(at,ut,s)=>{var et=s(8113);at.exports=/web0s(?!.*chrome)/i.test(et)},8113:(at,ut,s)=>{var et=s(5005);at.exports=et("navigator","userAgent")||""},7392:(at,ut,s)=>{var et,ot,lt=s(7854),St=s(8113),pt=lt.process,gt=lt.Deno,ct=pt&&pt.versions||gt&&gt.version,ht=ct&&ct.v8;ht&&(ot=(et=ht.split("."))[0]>0&&et[0]<4?1:+(et[0]+et[1])),!ot&&St&&(!(et=St.match(/Edge\/(\d+)/))||et[1]>=74)&&(et=St.match(/Chrome\/(\d+)/))&&(ot=+et[1]),at.exports=ot},8008:(at,ut,s)=>{var et=s(8113).match(/AppleWebKit\/(\d+)\./);at.exports=!!et&&+et[1]},748:at=>{at.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:(at,ut,s)=>{var et=s(7854),ot=s(1236).f,lt=s(8880),St=s(8052),pt=s(3072),gt=s(9920),ct=s(4705);at.exports=function(ht,it){var ft,mt,Tt,It,Pt,At=ht.target,Nt=ht.global,Ot=ht.stat;if(ft=Nt?et:Ot?et[At]||pt(At,{}):(et[At]||{}).prototype)for(mt in it){if(It=it[mt],Tt=ht.dontCallGetSet?(Pt=ot(ft,mt))&&Pt.value:ft[mt],!ct(Nt?mt:At+(Ot?".":"#")+mt,ht.forced)&&Tt!==void 0){if(typeof It==typeof Tt)continue;gt(It,Tt)}(ht.sham||Tt&&Tt.sham)&&lt(It,"sham",!0),St(ft,mt,It,ht)}}},7293:at=>{at.exports=function(ut){try{return!!ut()}catch{return!0}}},7007:(at,ut,s)=>{s(4916);var et=s(1702),ot=s(8052),lt=s(2261),St=s(7293),pt=s(5112),gt=s(8880),ct=pt("species"),ht=RegExp.prototype;at.exports=function(it,ft,mt,Tt){var It=pt(it),Pt=!St(function(){var Mt={};return Mt[It]=function(){return 7},""[it](Mt)!=7}),At=Pt&&!St(function(){var Mt=!1,bt=/a/;return it==="split"&&((bt={}).constructor={},bt.constructor[ct]=function(){return bt},bt.flags="",bt[It]=/./[It]),bt.exec=function(){return Mt=!0,null},bt[It](""),!Mt});if(!Pt||!At||mt){var Nt=et(/./[It]),Ot=ft(It,""[it],function(Mt,bt,Wt,zt,Bt){var rn=et(Mt),gn=bt.exec;return gn===lt||gn===ht.exec?Pt&&!Bt?{done:!0,value:Nt(bt,Wt,zt)}:{done:!0,value:rn(Wt,bt,zt)}:{done:!1}});ot(String.prototype,it,Ot[0]),ot(ht,It,Ot[1])}Tt&&gt(ht[It],"sham",!0)}},6677:(at,ut,s)=>{var et=s(7293);at.exports=!et(function(){return Object.isExtensible(Object.preventExtensions({}))})},2104:(at,ut,s)=>{var et=s(4374),ot=Function.prototype,lt=ot.apply,St=ot.call;at.exports=typeof Reflect=="object"&&Reflect.apply||(et?St.bind(lt):function(){return St.apply(lt,arguments)})},9974:(at,ut,s)=>{var et=s(1702),ot=s(9662),lt=s(4374),St=et(et.bind);at.exports=function(pt,gt){return ot(pt),gt===void 0?pt:lt?St(pt,gt):function(){return pt.apply(gt,arguments)}}},4374:(at,ut,s)=>{var et=s(7293);at.exports=!et(function(){var ot=(function(){}).bind();return typeof ot!="function"||ot.hasOwnProperty("prototype")})},7065:(at,ut,s)=>{var et=s(1702),ot=s(9662),lt=s(111),St=s(2597),pt=s(206),gt=s(4374),ct=Function,ht=et([].concat),it=et([].join),ft={},mt=function(Tt,It,Pt){if(!St(ft,It)){for(var At=[],Nt=0;Nt<It;Nt++)At[Nt]="a["+Nt+"]";ft[It]=ct("C,a","return new C("+it(At,",")+")")}return ft[It](Tt,Pt)};at.exports=gt?ct.bind:function(Tt){var It=ot(this),Pt=It.prototype,At=pt(arguments,1),Nt=function(){var Ot=ht(At,pt(arguments));return this instanceof Nt?mt(It,Ot.length,Ot):It.apply(Tt,Ot)};return lt(Pt)&&(Nt.prototype=Pt),Nt}},6916:(at,ut,s)=>{var et=s(4374),ot=Function.prototype.call;at.exports=et?ot.bind(ot):function(){return ot.apply(ot,arguments)}},6530:(at,ut,s)=>{var et=s(9781),ot=s(2597),lt=Function.prototype,St=et&&Object.getOwnPropertyDescriptor,pt=ot(lt,"name"),gt=pt&&(function(){}).name==="something",ct=pt&&(!et||et&&St(lt,"name").configurable);at.exports={EXISTS:pt,PROPER:gt,CONFIGURABLE:ct}},1702:(at,ut,s)=>{var et=s(4374),ot=Function.prototype,lt=ot.bind,St=ot.call,pt=et&&lt.bind(St,St);at.exports=et?function(gt){return gt&&pt(gt)}:function(gt){return gt&&function(){return St.apply(gt,arguments)}}},5005:(at,ut,s)=>{var et=s(7854),ot=s(614),lt=function(St){return ot(St)?St:void 0};at.exports=function(St,pt){return arguments.length<2?lt(et[St]):et[St]&&et[St][pt]}},1246:(at,ut,s)=>{var et=s(648),ot=s(8173),lt=s(7497),St=s(5112)("iterator");at.exports=function(pt){if(pt!=null)return ot(pt,St)||ot(pt,"@@iterator")||lt[et(pt)]}},8554:(at,ut,s)=>{var et=s(6916),ot=s(9662),lt=s(9670),St=s(6330),pt=s(1246),gt=TypeError;at.exports=function(ct,ht){var it=arguments.length<2?pt(ct):ht;if(ot(it))return lt(et(it,ct));throw gt(St(ct)+" is not iterable")}},8173:(at,ut,s)=>{var et=s(9662);at.exports=function(ot,lt){var St=ot[lt];return St==null?void 0:et(St)}},647:(at,ut,s)=>{var et=s(1702),ot=s(7908),lt=Math.floor,St=et("".charAt),pt=et("".replace),gt=et("".slice),ct=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,ht=/\$([$&'`]|\d{1,2})/g;at.exports=function(it,ft,mt,Tt,It,Pt){var At=mt+it.length,Nt=Tt.length,Ot=ht;return It!==void 0&&(It=ot(It),Ot=ct),pt(Pt,Ot,function(Mt,bt){var Wt;switch(St(bt,0)){case"$":return"$";case"&":return it;case"`":return gt(ft,0,mt);case"'":return gt(ft,At);case"<":Wt=It[gt(bt,1,-1)];break;default:var zt=+bt;if(zt===0)return Mt;if(zt>Nt){var Bt=lt(zt/10);return Bt===0?Mt:Bt<=Nt?Tt[Bt-1]===void 0?St(bt,1):Tt[Bt-1]+St(bt,1):Mt}Wt=Tt[zt-1]}return Wt===void 0?"":Wt})}},7854:(at,ut,s)=>{var et=function(ot){return ot&&ot.Math==Math&&ot};at.exports=et(typeof globalThis=="object"&&globalThis)||et(typeof window=="object"&&window)||et(typeof self=="object"&&self)||et(typeof s.g=="object"&&s.g)||function(){return this}()||Function("return this")()},2597:(at,ut,s)=>{var et=s(1702),ot=s(7908),lt=et({}.hasOwnProperty);at.exports=Object.hasOwn||function(St,pt){return lt(ot(St),pt)}},3501:at=>{at.exports={}},842:(at,ut,s)=>{var et=s(7854);at.exports=function(ot,lt){var St=et.console;St&&St.error&&(arguments.length==1?St.error(ot):St.error(ot,lt))}},490:(at,ut,s)=>{var et=s(5005);at.exports=et("document","documentElement")},4664:(at,ut,s)=>{var et=s(9781),ot=s(7293),lt=s(317);at.exports=!et&&!ot(function(){return Object.defineProperty(lt("div"),"a",{get:function(){return 7}}).a!=7})},1179:at=>{var ut=Array,s=Math.abs,et=Math.pow,ot=Math.floor,lt=Math.log,St=Math.LN2;at.exports={pack:function(pt,gt,ct){var ht,it,ft,mt=ut(ct),Tt=8*ct-gt-1,It=(1<<Tt)-1,Pt=It>>1,At=gt===23?et(2,-24)-et(2,-77):0,Nt=pt<0||pt===0&&1/pt<0?1:0,Ot=0;for((pt=s(pt))!=pt||pt===1/0?(it=pt!=pt?1:0,ht=It):(ht=ot(lt(pt)/St),pt*(ft=et(2,-ht))<1&&(ht--,ft*=2),(pt+=ht+Pt>=1?At/ft:At*et(2,1-Pt))*ft>=2&&(ht++,ft/=2),ht+Pt>=It?(it=0,ht=It):ht+Pt>=1?(it=(pt*ft-1)*et(2,gt),ht+=Pt):(it=pt*et(2,Pt-1)*et(2,gt),ht=0));gt>=8;)mt[Ot++]=255&it,it/=256,gt-=8;for(ht=ht<<gt|it,Tt+=gt;Tt>0;)mt[Ot++]=255&ht,ht/=256,Tt-=8;return mt[--Ot]|=128*Nt,mt},unpack:function(pt,gt){var ct,ht=pt.length,it=8*ht-gt-1,ft=(1<<it)-1,mt=ft>>1,Tt=it-7,It=ht-1,Pt=pt[It--],At=127&Pt;for(Pt>>=7;Tt>0;)At=256*At+pt[It--],Tt-=8;for(ct=At&(1<<-Tt)-1,At>>=-Tt,Tt+=gt;Tt>0;)ct=256*ct+pt[It--],Tt-=8;if(At===0)At=1-mt;else{if(At===ft)return ct?NaN:Pt?-1/0:1/0;ct+=et(2,gt),At-=mt}return(Pt?-1:1)*ct*et(2,At-gt)}}},8361:(at,ut,s)=>{var et=s(1702),ot=s(7293),lt=s(4326),St=Object,pt=et("".split);at.exports=ot(function(){return!St("z").propertyIsEnumerable(0)})?function(gt){return lt(gt)=="String"?pt(gt,""):St(gt)}:St},9587:(at,ut,s)=>{var et=s(614),ot=s(111),lt=s(7674);at.exports=function(St,pt,gt){var ct,ht;return lt&&et(ct=pt.constructor)&&ct!==gt&&ot(ht=ct.prototype)&&ht!==gt.prototype&&lt(St,ht),St}},2788:(at,ut,s)=>{var et=s(1702),ot=s(614),lt=s(5465),St=et(Function.toString);ot(lt.inspectSource)||(lt.inspectSource=function(pt){return St(pt)}),at.exports=lt.inspectSource},2423:(at,ut,s)=>{var et=s(2109),ot=s(1702),lt=s(3501),St=s(111),pt=s(2597),gt=s(3070).f,ct=s(8006),ht=s(1156),it=s(2050),ft=s(9711),mt=s(6677),Tt=!1,It=ft("meta"),Pt=0,At=function(Ot){gt(Ot,It,{value:{objectID:"O"+Pt++,weakData:{}}})},Nt=at.exports={enable:function(){Nt.enable=function(){},Tt=!0;var Ot=ct.f,Mt=ot([].splice),bt={};bt[It]=1,Ot(bt).length&&(ct.f=function(Wt){for(var zt=Ot(Wt),Bt=0,rn=zt.length;Bt<rn;Bt++)if(zt[Bt]===It){Mt(zt,Bt,1);break}return zt},et({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:ht.f}))},fastKey:function(Ot,Mt){if(!St(Ot))return typeof Ot=="symbol"?Ot:(typeof Ot=="string"?"S":"P")+Ot;if(!pt(Ot,It)){if(!it(Ot))return"F";if(!Mt)return"E";At(Ot)}return Ot[It].objectID},getWeakData:function(Ot,Mt){if(!pt(Ot,It)){if(!it(Ot))return!0;if(!Mt)return!1;At(Ot)}return Ot[It].weakData},onFreeze:function(Ot){return mt&&Tt&&it(Ot)&&!pt(Ot,It)&&At(Ot),Ot}};lt[It]=!0},9909:(at,ut,s)=>{var et,ot,lt,St=s(8536),pt=s(7854),gt=s(1702),ct=s(111),ht=s(8880),it=s(2597),ft=s(5465),mt=s(6200),Tt=s(3501),It="Object already initialized",Pt=pt.TypeError,At=pt.WeakMap;if(St||ft.state){var Nt=ft.state||(ft.state=new At),Ot=gt(Nt.get),Mt=gt(Nt.has),bt=gt(Nt.set);et=function(zt,Bt){if(Mt(Nt,zt))throw new Pt(It);return Bt.facade=zt,bt(Nt,zt,Bt),Bt},ot=function(zt){return Ot(Nt,zt)||{}},lt=function(zt){return Mt(Nt,zt)}}else{var Wt=mt("state");Tt[Wt]=!0,et=function(zt,Bt){if(it(zt,Wt))throw new Pt(It);return Bt.facade=zt,ht(zt,Wt,Bt),Bt},ot=function(zt){return it(zt,Wt)?zt[Wt]:{}},lt=function(zt){return it(zt,Wt)}}at.exports={set:et,get:ot,has:lt,enforce:function(zt){return lt(zt)?ot(zt):et(zt,{})},getterFor:function(zt){return function(Bt){var rn;if(!ct(Bt)||(rn=ot(Bt)).type!==zt)throw Pt("Incompatible receiver, "+zt+" required");return rn}}}},7659:(at,ut,s)=>{var et=s(5112),ot=s(7497),lt=et("iterator"),St=Array.prototype;at.exports=function(pt){return pt!==void 0&&(ot.Array===pt||St[lt]===pt)}},3157:(at,ut,s)=>{var et=s(4326);at.exports=Array.isArray||function(ot){return et(ot)=="Array"}},614:at=>{at.exports=function(ut){return typeof ut=="function"}},4411:(at,ut,s)=>{var et=s(1702),ot=s(7293),lt=s(614),St=s(648),pt=s(5005),gt=s(2788),ct=function(){},ht=[],it=pt("Reflect","construct"),ft=/^\s*(?:class|function)\b/,mt=et(ft.exec),Tt=!ft.exec(ct),It=function(At){if(!lt(At))return!1;try{return it(ct,ht,At),!0}catch{return!1}},Pt=function(At){if(!lt(At))return!1;switch(St(At)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Tt||!!mt(ft,gt(At))}catch{return!0}};Pt.sham=!0,at.exports=!it||ot(function(){var At;return It(It.call)||!It(Object)||!It(function(){At=!0})||At})?Pt:It},5032:(at,ut,s)=>{var et=s(2597);at.exports=function(ot){return ot!==void 0&&(et(ot,"value")||et(ot,"writable"))}},4705:(at,ut,s)=>{var et=s(7293),ot=s(614),lt=/#|\.prototype\./,St=function(it,ft){var mt=gt[pt(it)];return mt==ht||mt!=ct&&(ot(ft)?et(ft):!!ft)},pt=St.normalize=function(it){return String(it).replace(lt,".").toLowerCase()},gt=St.data={},ct=St.NATIVE="N",ht=St.POLYFILL="P";at.exports=St},5988:(at,ut,s)=>{var et=s(111),ot=Math.floor;at.exports=Number.isInteger||function(lt){return!et(lt)&&isFinite(lt)&&ot(lt)===lt}},111:(at,ut,s)=>{var et=s(614);at.exports=function(ot){return typeof ot=="object"?ot!==null:et(ot)}},1913:at=>{at.exports=!1},7850:(at,ut,s)=>{var et=s(111),ot=s(4326),lt=s(5112)("match");at.exports=function(St){var pt;return et(St)&&((pt=St[lt])!==void 0?!!pt:ot(St)=="RegExp")}},2190:(at,ut,s)=>{var et=s(5005),ot=s(614),lt=s(7976),St=s(3307),pt=Object;at.exports=St?function(gt){return typeof gt=="symbol"}:function(gt){var ct=et("Symbol");return ot(ct)&&lt(ct.prototype,pt(gt))}},408:(at,ut,s)=>{var et=s(9974),ot=s(6916),lt=s(9670),St=s(6330),pt=s(7659),gt=s(6244),ct=s(7976),ht=s(8554),it=s(1246),ft=s(9212),mt=TypeError,Tt=function(Pt,At){this.stopped=Pt,this.result=At},It=Tt.prototype;at.exports=function(Pt,At,Nt){var Ot,Mt,bt,Wt,zt,Bt,rn,gn=Nt&&Nt.that,tn=!(!Nt||!Nt.AS_ENTRIES),Ht=!(!Nt||!Nt.IS_RECORD),fn=!(!Nt||!Nt.IS_ITERATOR),bn=!(!Nt||!Nt.INTERRUPTED),In=et(At,gn),un=function(yn){return Ot&&ft(Ot,"normal",yn),new Tt(!0,yn)},mn=function(yn){return tn?(lt(yn),bn?In(yn[0],yn[1],un):In(yn[0],yn[1])):bn?In(yn,un):In(yn)};if(Ht)Ot=Pt.iterator;else if(fn)Ot=Pt;else{if(!(Mt=it(Pt)))throw mt(St(Pt)+" is not iterable");if(pt(Mt)){for(bt=0,Wt=gt(Pt);Wt>bt;bt++)if((zt=mn(Pt[bt]))&&ct(It,zt))return zt;return new Tt(!1)}Ot=ht(Pt,Mt)}for(Bt=Ht?Pt.next:Ot.next;!(rn=ot(Bt,Ot)).done;){try{zt=mn(rn.value)}catch(yn){ft(Ot,"throw",yn)}if(typeof zt=="object"&&zt&&ct(It,zt))return zt}return new Tt(!1)}},9212:(at,ut,s)=>{var et=s(6916),ot=s(9670),lt=s(8173);at.exports=function(St,pt,gt){var ct,ht;ot(St);try{if(!(ct=lt(St,"return"))){if(pt==="throw")throw gt;return gt}ct=et(ct,St)}catch(it){ht=!0,ct=it}if(pt==="throw")throw gt;if(ht)throw ct;return ot(ct),gt}},3383:(at,ut,s)=>{var et,ot,lt,St=s(7293),pt=s(614),gt=s(30),ct=s(9518),ht=s(8052),it=s(5112),ft=s(1913),mt=it("iterator"),Tt=!1;[].keys&&("next"in(lt=[].keys())?(ot=ct(ct(lt)))!==Object.prototype&&(et=ot):Tt=!0),et==null||St(function(){var It={};return et[mt].call(It)!==It})?et={}:ft&&(et=gt(et)),pt(et[mt])||ht(et,mt,function(){return this}),at.exports={IteratorPrototype:et,BUGGY_SAFARI_ITERATORS:Tt}},7497:at=>{at.exports={}},6244:(at,ut,s)=>{var et=s(7466);at.exports=function(ot){return et(ot.length)}},6339:(at,ut,s)=>{var et=s(7293),ot=s(614),lt=s(2597),St=s(9781),pt=s(6530).CONFIGURABLE,gt=s(2788),ct=s(9909),ht=ct.enforce,it=ct.get,ft=Object.defineProperty,mt=St&&!et(function(){return ft(function(){},"length",{value:8}).length!==8}),Tt=String(String).split("String"),It=at.exports=function(Pt,At,Nt){String(At).slice(0,7)==="Symbol("&&(At="["+String(At).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),Nt&&Nt.getter&&(At="get "+At),Nt&&Nt.setter&&(At="set "+At),(!lt(Pt,"name")||pt&&Pt.name!==At)&&(St?ft(Pt,"name",{value:At,configurable:!0}):Pt.name=At),mt&&Nt&&lt(Nt,"arity")&&Pt.length!==Nt.arity&&ft(Pt,"length",{value:Nt.arity});try{Nt&&lt(Nt,"constructor")&&Nt.constructor?St&&ft(Pt,"prototype",{writable:!1}):Pt.prototype&&(Pt.prototype=void 0)}catch{}var Ot=ht(Pt);return lt(Ot,"source")||(Ot.source=Tt.join(typeof At=="string"?At:"")),Pt};Function.prototype.toString=It(function(){return ot(this)&&it(this).source||gt(this)},"toString")},403:at=>{var ut=Math.log,s=Math.LOG10E;at.exports=Math.log10||function(et){return ut(et)*s}},4758:at=>{var ut=Math.ceil,s=Math.floor;at.exports=Math.trunc||function(et){var ot=+et;return(ot>0?s:ut)(ot)}},5948:(at,ut,s)=>{var et,ot,lt,St,pt,gt,ct,ht,it=s(7854),ft=s(9974),mt=s(1236).f,Tt=s(261).set,It=s(6833),Pt=s(1528),At=s(1036),Nt=s(2805),Ot=it.MutationObserver||it.WebKitMutationObserver,Mt=it.document,bt=it.process,Wt=it.Promise,zt=mt(it,"queueMicrotask"),Bt=zt&&zt.value;Bt||(et=function(){var rn,gn;for(Nt&&(rn=bt.domain)&&rn.exit();ot;){gn=ot.fn,ot=ot.next;try{gn()}catch(tn){throw ot?St():lt=void 0,tn}}lt=void 0,rn&&rn.enter()},It||Nt||At||!Ot||!Mt?!Pt&&Wt&&Wt.resolve?((ct=Wt.resolve(void 0)).constructor=Wt,ht=ft(ct.then,ct),St=function(){ht(et)}):Nt?St=function(){bt.nextTick(et)}:(Tt=ft(Tt,it),St=function(){Tt(et)}):(pt=!0,gt=Mt.createTextNode(""),new Ot(et).observe(gt,{characterData:!0}),St=function(){gt.data=pt=!pt})),at.exports=Bt||function(rn){var gn={fn:rn,next:void 0};lt&&(lt.next=gn),ot||(ot=gn,St()),lt=gn}},735:(at,ut,s)=>{var et=s(133);at.exports=et&&!!Symbol.for&&!!Symbol.keyFor},133:(at,ut,s)=>{var et=s(7392),ot=s(7293);at.exports=!!Object.getOwnPropertySymbols&&!ot(function(){var lt=Symbol();return!String(lt)||!(Object(lt)instanceof Symbol)||!Symbol.sham&&et&&et<41})},590:(at,ut,s)=>{var et=s(7293),ot=s(5112),lt=s(1913),St=ot("iterator");at.exports=!et(function(){var pt=new URL("b?a=1&b=2&c=3","http://a"),gt=pt.searchParams,ct="";return pt.pathname="c%20d",gt.forEach(function(ht,it){gt.delete("b"),ct+=it+ht}),lt&&!pt.toJSON||!gt.sort||pt.href!=="http://a/c%20d?a=1&c=3"||gt.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!gt[St]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||ct!=="a1c3"||new URL("http://x",void 0).host!=="x"})},8536:(at,ut,s)=>{var et=s(7854),ot=s(614),lt=s(2788),St=et.WeakMap;at.exports=ot(St)&&/native code/.test(lt(St))},8523:(at,ut,s)=>{var et=s(9662),ot=function(lt){var St,pt;this.promise=new lt(function(gt,ct){if(St!==void 0||pt!==void 0)throw TypeError("Bad Promise constructor");St=gt,pt=ct}),this.resolve=et(St),this.reject=et(pt)};at.exports.f=function(lt){return new ot(lt)}},3929:(at,ut,s)=>{var et=s(7850),ot=TypeError;at.exports=function(lt){if(et(lt))throw ot("The method doesn't accept regular expressions");return lt}},3009:(at,ut,s)=>{var et=s(7854),ot=s(7293),lt=s(1702),St=s(1340),pt=s(3111).trim,gt=s(1361),ct=et.parseInt,ht=et.Symbol,it=ht&&ht.iterator,ft=/^[+-]?0x/i,mt=lt(ft.exec),Tt=ct(gt+"08")!==8||ct(gt+"0x16")!==22||it&&!ot(function(){ct(Object(it))});at.exports=Tt?function(It,Pt){var At=pt(St(It));return ct(At,Pt>>>0||(mt(ft,At)?16:10))}:ct},1574:(at,ut,s)=>{var et=s(9781),ot=s(1702),lt=s(6916),St=s(7293),pt=s(1956),gt=s(5181),ct=s(5296),ht=s(7908),it=s(8361),ft=Object.assign,mt=Object.defineProperty,Tt=ot([].concat);at.exports=!ft||St(function(){if(et&&ft({b:1},ft(mt({},"a",{enumerable:!0,get:function(){mt(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var It={},Pt={},At=Symbol(),Nt="abcdefghijklmnopqrst";return It[At]=7,Nt.split("").forEach(function(Ot){Pt[Ot]=Ot}),ft({},It)[At]!=7||pt(ft({},Pt)).join("")!=Nt})?function(It,Pt){for(var At=ht(It),Nt=arguments.length,Ot=1,Mt=gt.f,bt=ct.f;Nt>Ot;)for(var Wt,zt=it(arguments[Ot++]),Bt=Mt?Tt(pt(zt),Mt(zt)):pt(zt),rn=Bt.length,gn=0;rn>gn;)Wt=Bt[gn++],et&&!lt(bt,zt,Wt)||(At[Wt]=zt[Wt]);return At}:ft},30:(at,ut,s)=>{var et,ot=s(9670),lt=s(6048),St=s(748),pt=s(3501),gt=s(490),ct=s(317),ht=s(6200)("IE_PROTO"),it=function(){},ft=function(It){return"<script>"+It+"<\/script>"},mt=function(It){It.write(ft("")),It.close();var Pt=It.parentWindow.Object;return It=null,Pt},Tt=function(){try{et=new ActiveXObject("htmlfile")}catch{}var It,Pt;Tt=typeof document<"u"?document.domain&&et?mt(et):((Pt=ct("iframe")).style.display="none",gt.appendChild(Pt),Pt.src="javascript:",(It=Pt.contentWindow.document).open(),It.write(ft("document.F=Object")),It.close(),It.F):mt(et);for(var At=St.length;At--;)delete Tt.prototype[St[At]];return Tt()};pt[ht]=!0,at.exports=Object.create||function(It,Pt){var At;return It!==null?(it.prototype=ot(It),At=new it,it.prototype=null,At[ht]=It):At=Tt(),Pt===void 0?At:lt.f(At,Pt)}},6048:(at,ut,s)=>{var et=s(9781),ot=s(3353),lt=s(3070),St=s(9670),pt=s(5656),gt=s(1956);ut.f=et&&!ot?Object.defineProperties:function(ct,ht){St(ct);for(var it,ft=pt(ht),mt=gt(ht),Tt=mt.length,It=0;Tt>It;)lt.f(ct,it=mt[It++],ft[it]);return ct}},3070:(at,ut,s)=>{var et=s(9781),ot=s(4664),lt=s(3353),St=s(9670),pt=s(4948),gt=TypeError,ct=Object.defineProperty,ht=Object.getOwnPropertyDescriptor;ut.f=et?lt?function(it,ft,mt){if(St(it),ft=pt(ft),St(mt),typeof it=="function"&&ft==="prototype"&&"value"in mt&&"writable"in mt&&!mt.writable){var Tt=ht(it,ft);Tt&&Tt.writable&&(it[ft]=mt.value,mt={configurable:"configurable"in mt?mt.configurable:Tt.configurable,enumerable:"enumerable"in mt?mt.enumerable:Tt.enumerable,writable:!1})}return ct(it,ft,mt)}:ct:function(it,ft,mt){if(St(it),ft=pt(ft),St(mt),ot)try{return ct(it,ft,mt)}catch{}if("get"in mt||"set"in mt)throw gt("Accessors not supported");return"value"in mt&&(it[ft]=mt.value),it}},1236:(at,ut,s)=>{var et=s(9781),ot=s(6916),lt=s(5296),St=s(9114),pt=s(5656),gt=s(4948),ct=s(2597),ht=s(4664),it=Object.getOwnPropertyDescriptor;ut.f=et?it:function(ft,mt){if(ft=pt(ft),mt=gt(mt),ht)try{return it(ft,mt)}catch{}if(ct(ft,mt))return St(!ot(lt.f,ft,mt),ft[mt])}},1156:(at,ut,s)=>{var et=s(4326),ot=s(5656),lt=s(8006).f,St=s(1589),pt=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];at.exports.f=function(gt){return pt&&et(gt)=="Window"?function(ct){try{return lt(ct)}catch{return St(pt)}}(gt):lt(ot(gt))}},8006:(at,ut,s)=>{var et=s(6324),ot=s(748).concat("length","prototype");ut.f=Object.getOwnPropertyNames||function(lt){return et(lt,ot)}},5181:(at,ut)=>{ut.f=Object.getOwnPropertySymbols},9518:(at,ut,s)=>{var et=s(2597),ot=s(614),lt=s(7908),St=s(6200),pt=s(8544),gt=St("IE_PROTO"),ct=Object,ht=ct.prototype;at.exports=pt?ct.getPrototypeOf:function(it){var ft=lt(it);if(et(ft,gt))return ft[gt];var mt=ft.constructor;return ot(mt)&&ft instanceof mt?mt.prototype:ft instanceof ct?ht:null}},2050:(at,ut,s)=>{var et=s(7293),ot=s(111),lt=s(4326),St=s(7556),pt=Object.isExtensible,gt=et(function(){});at.exports=gt||St?function(ct){return!!ot(ct)&&(!St||lt(ct)!="ArrayBuffer")&&(!pt||pt(ct))}:pt},7976:(at,ut,s)=>{var et=s(1702);at.exports=et({}.isPrototypeOf)},6324:(at,ut,s)=>{var et=s(1702),ot=s(2597),lt=s(5656),St=s(1318).indexOf,pt=s(3501),gt=et([].push);at.exports=function(ct,ht){var it,ft=lt(ct),mt=0,Tt=[];for(it in ft)!ot(pt,it)&&ot(ft,it)&&gt(Tt,it);for(;ht.length>mt;)ot(ft,it=ht[mt++])&&(~St(Tt,it)||gt(Tt,it));return Tt}},1956:(at,ut,s)=>{var et=s(6324),ot=s(748);at.exports=Object.keys||function(lt){return et(lt,ot)}},5296:(at,ut)=>{var s={}.propertyIsEnumerable,et=Object.getOwnPropertyDescriptor,ot=et&&!s.call({1:2},1);ut.f=ot?function(lt){var St=et(this,lt);return!!St&&St.enumerable}:s},7674:(at,ut,s)=>{var et=s(1702),ot=s(9670),lt=s(6077);at.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var St,pt=!1,gt={};try{(St=et(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(gt,[]),pt=gt instanceof Array}catch{}return function(ct,ht){return ot(ct),lt(ht),pt?St(ct,ht):ct.__proto__=ht,ct}}():void 0)},4699:(at,ut,s)=>{var et=s(9781),ot=s(1702),lt=s(1956),St=s(5656),pt=ot(s(5296).f),gt=ot([].push),ct=function(ht){return function(it){for(var ft,mt=St(it),Tt=lt(mt),It=Tt.length,Pt=0,At=[];It>Pt;)ft=Tt[Pt++],et&&!pt(mt,ft)||gt(At,ht?[ft,mt[ft]]:mt[ft]);return At}};at.exports={entries:ct(!0),values:ct(!1)}},288:(at,ut,s)=>{var et=s(1694),ot=s(648);at.exports=et?{}.toString:function(){return"[object "+ot(this)+"]"}},2140:(at,ut,s)=>{var et=s(6916),ot=s(614),lt=s(111),St=TypeError;at.exports=function(pt,gt){var ct,ht;if(gt==="string"&&ot(ct=pt.toString)&&!lt(ht=et(ct,pt))||ot(ct=pt.valueOf)&&!lt(ht=et(ct,pt))||gt!=="string"&&ot(ct=pt.toString)&&!lt(ht=et(ct,pt)))return ht;throw St("Can't convert object to primitive value")}},3887:(at,ut,s)=>{var et=s(5005),ot=s(1702),lt=s(8006),St=s(5181),pt=s(9670),gt=ot([].concat);at.exports=et("Reflect","ownKeys")||function(ct){var ht=lt.f(pt(ct)),it=St.f;return it?gt(ht,it(ct)):ht}},857:(at,ut,s)=>{var et=s(7854);at.exports=et},2534:at=>{at.exports=function(ut){try{return{error:!1,value:ut()}}catch(s){return{error:!0,value:s}}}},3702:(at,ut,s)=>{var et=s(7854),ot=s(2492),lt=s(614),St=s(4705),pt=s(2788),gt=s(5112),ct=s(7871),ht=s(1913),it=s(7392),ft=ot&&ot.prototype,mt=gt("species"),Tt=!1,It=lt(et.PromiseRejectionEvent),Pt=St("Promise",function(){var At=pt(ot),Nt=At!==String(ot);if(!Nt&&it===66||ht&&(!ft.catch||!ft.finally))return!0;if(it>=51&&/native code/.test(At))return!1;var Ot=new ot(function(bt){bt(1)}),Mt=function(bt){bt(function(){},function(){})};return(Ot.constructor={})[mt]=Mt,!(Tt=Ot.then(function(){})instanceof Mt)||!Nt&&ct&&!It});at.exports={CONSTRUCTOR:Pt,REJECTION_EVENT:It,SUBCLASSING:Tt}},2492:(at,ut,s)=>{var et=s(7854);at.exports=et.Promise},9478:(at,ut,s)=>{var et=s(9670),ot=s(111),lt=s(8523);at.exports=function(St,pt){if(et(St),ot(pt)&&pt.constructor===St)return pt;var gt=lt.f(St);return(0,gt.resolve)(pt),gt.promise}},612:(at,ut,s)=>{var et=s(2492),ot=s(7072),lt=s(3702).CONSTRUCTOR;at.exports=lt||!ot(function(St){et.all(St).then(void 0,function(){})})},2626:(at,ut,s)=>{var et=s(3070).f;at.exports=function(ot,lt,St){St in ot||et(ot,St,{configurable:!0,get:function(){return lt[St]},set:function(pt){lt[St]=pt}})}},8572:at=>{var ut=function(){this.head=null,this.tail=null};ut.prototype={add:function(s){var et={item:s,next:null};this.head?this.tail.next=et:this.head=et,this.tail=et},get:function(){var s=this.head;if(s)return this.head=s.next,this.tail===s&&(this.tail=null),s.item}},at.exports=ut},7651:(at,ut,s)=>{var et=s(6916),ot=s(9670),lt=s(614),St=s(4326),pt=s(2261),gt=TypeError;at.exports=function(ct,ht){var it=ct.exec;if(lt(it)){var ft=et(it,ct,ht);return ft!==null&&ot(ft),ft}if(St(ct)==="RegExp")return et(pt,ct,ht);throw gt("RegExp#exec called on incompatible receiver")}},2261:(at,ut,s)=>{var et,ot,lt=s(6916),St=s(1702),pt=s(1340),gt=s(7066),ct=s(2999),ht=s(2309),it=s(30),ft=s(9909).get,mt=s(9441),Tt=s(7168),It=ht("native-string-replace",String.prototype.replace),Pt=RegExp.prototype.exec,At=Pt,Nt=St("".charAt),Ot=St("".indexOf),Mt=St("".replace),bt=St("".slice),Wt=(ot=/b*/g,lt(Pt,et=/a/,"a"),lt(Pt,ot,"a"),et.lastIndex!==0||ot.lastIndex!==0),zt=ct.BROKEN_CARET,Bt=/()??/.exec("")[1]!==void 0;(Wt||Bt||zt||mt||Tt)&&(At=function(rn){var gn,tn,Ht,fn,bn,In,un,mn=this,yn=ft(mn),pn=pt(rn),Tn=yn.raw;if(Tn)return Tn.lastIndex=mn.lastIndex,gn=lt(At,Tn,pn),mn.lastIndex=Tn.lastIndex,gn;var kn=yn.groups,xn=zt&&mn.sticky,Mn=lt(gt,mn),Dn=mn.source,An=0,Nn=pn;if(xn&&(Mn=Mt(Mn,"y",""),Ot(Mn,"g")===-1&&(Mn+="g"),Nn=bt(pn,mn.lastIndex),mn.lastIndex>0&&(!mn.multiline||mn.multiline&&Nt(pn,mn.lastIndex-1)!==`
`)&&(Dn="(?: "+Dn+")",Nn=" "+Nn,An++),tn=new RegExp("^(?:"+Dn+")",Mn)),Bt&&(tn=new RegExp("^"+Dn+"$(?!\\s)",Mn)),Wt&&(Ht=mn.lastIndex),fn=lt(Pt,xn?tn:mn,Nn),xn?fn?(fn.input=bt(fn.input,An),fn[0]=bt(fn[0],An),fn.index=mn.lastIndex,mn.lastIndex+=fn[0].length):mn.lastIndex=0:Wt&&fn&&(mn.lastIndex=mn.global?fn.index+fn[0].length:Ht),Bt&&fn&&fn.length>1&&lt(It,fn[0],tn,function(){for(bn=1;bn<arguments.length-2;bn++)arguments[bn]===void 0&&(fn[bn]=void 0)}),fn&&kn)for(fn.groups=In=it(null),bn=0;bn<kn.length;bn++)In[(un=kn[bn])[0]]=fn[un[1]];return fn}),at.exports=At},7066:(at,ut,s)=>{var et=s(9670);at.exports=function(){var ot=et(this),lt="";return ot.hasIndices&&(lt+="d"),ot.global&&(lt+="g"),ot.ignoreCase&&(lt+="i"),ot.multiline&&(lt+="m"),ot.dotAll&&(lt+="s"),ot.unicode&&(lt+="u"),ot.unicodeSets&&(lt+="v"),ot.sticky&&(lt+="y"),lt}},4706:(at,ut,s)=>{var et=s(6916),ot=s(2597),lt=s(7976),St=s(7066),pt=RegExp.prototype;at.exports=function(gt){var ct=gt.flags;return ct!==void 0||"flags"in pt||ot(gt,"flags")||!lt(pt,gt)?ct:et(St,gt)}},2999:(at,ut,s)=>{var et=s(7293),ot=s(7854).RegExp,lt=et(function(){var gt=ot("a","y");return gt.lastIndex=2,gt.exec("abcd")!=null}),St=lt||et(function(){return!ot("a","y").sticky}),pt=lt||et(function(){var gt=ot("^r","gy");return gt.lastIndex=2,gt.exec("str")!=null});at.exports={BROKEN_CARET:pt,MISSED_STICKY:St,UNSUPPORTED_Y:lt}},9441:(at,ut,s)=>{var et=s(7293),ot=s(7854).RegExp;at.exports=et(function(){var lt=ot(".","s");return!(lt.dotAll&&lt.exec(`
`)&&lt.flags==="s")})},7168:(at,ut,s)=>{var et=s(7293),ot=s(7854).RegExp;at.exports=et(function(){var lt=ot("(?<a>b)","g");return lt.exec("b").groups.a!=="b"||"b".replace(lt,"$<a>c")!=="bc"})},4488:at=>{var ut=TypeError;at.exports=function(s){if(s==null)throw ut("Can't call method on "+s);return s}},1150:at=>{at.exports=Object.is||function(ut,s){return ut===s?ut!==0||1/ut==1/s:ut!=ut&&s!=s}},7152:(at,ut,s)=>{var et=s(7854),ot=s(2104),lt=s(614),St=s(8113),pt=s(206),gt=s(8053),ct=/MSIE .\./.test(St),ht=et.Function,it=function(ft){return ct?function(mt,Tt){var It=gt(arguments.length,1)>2,Pt=lt(mt)?mt:ht(mt),At=It?pt(arguments,2):void 0;return ft(It?function(){ot(Pt,this,At)}:Pt,Tt)}:ft};at.exports={setTimeout:it(et.setTimeout),setInterval:it(et.setInterval)}},6340:(at,ut,s)=>{var et=s(5005),ot=s(3070),lt=s(5112),St=s(9781),pt=lt("species");at.exports=function(gt){var ct=et(gt),ht=ot.f;St&&ct&&!ct[pt]&&ht(ct,pt,{configurable:!0,get:function(){return this}})}},8003:(at,ut,s)=>{var et=s(3070).f,ot=s(2597),lt=s(5112)("toStringTag");at.exports=function(St,pt,gt){St&&!gt&&(St=St.prototype),St&&!ot(St,lt)&&et(St,lt,{configurable:!0,value:pt})}},6200:(at,ut,s)=>{var et=s(2309),ot=s(9711),lt=et("keys");at.exports=function(St){return lt[St]||(lt[St]=ot(St))}},5465:(at,ut,s)=>{var et=s(7854),ot=s(3072),lt="__core-js_shared__",St=et[lt]||ot(lt,{});at.exports=St},2309:(at,ut,s)=>{var et=s(1913),ot=s(5465);(at.exports=function(lt,St){return ot[lt]||(ot[lt]=St!==void 0?St:{})})("versions",[]).push({version:"3.23.4",mode:et?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.4/LICENSE",source:"https://github.com/zloirock/core-js"})},6707:(at,ut,s)=>{var et=s(9670),ot=s(9483),lt=s(5112)("species");at.exports=function(St,pt){var gt,ct=et(St).constructor;return ct===void 0||(gt=et(ct)[lt])==null?pt:ot(gt)}},8710:(at,ut,s)=>{var et=s(1702),ot=s(9303),lt=s(1340),St=s(4488),pt=et("".charAt),gt=et("".charCodeAt),ct=et("".slice),ht=function(it){return function(ft,mt){var Tt,It,Pt=lt(St(ft)),At=ot(mt),Nt=Pt.length;return At<0||At>=Nt?it?"":void 0:(Tt=gt(Pt,At))<55296||Tt>56319||At+1===Nt||(It=gt(Pt,At+1))<56320||It>57343?it?pt(Pt,At):Tt:it?ct(Pt,At,At+2):It-56320+(Tt-55296<<10)+65536}};at.exports={codeAt:ht(!1),charAt:ht(!0)}},6650:(at,ut,s)=>{var et=s(1702),ot=s(7466),lt=s(1340),St=s(8415),pt=s(4488),gt=et(St),ct=et("".slice),ht=Math.ceil,it=function(ft){return function(mt,Tt,It){var Pt,At,Nt=lt(pt(mt)),Ot=ot(Tt),Mt=Nt.length,bt=It===void 0?" ":lt(It);return Ot<=Mt||bt==""?Nt:((At=gt(bt,ht((Pt=Ot-Mt)/bt.length))).length>Pt&&(At=ct(At,0,Pt)),ft?Nt+At:At+Nt)}};at.exports={start:it(!1),end:it(!0)}},3197:(at,ut,s)=>{var et=s(1702),ot=2147483647,lt=/[^\0-\u007E]/,St=/[.\u3002\uFF0E\uFF61]/g,pt="Overflow: input needs wider integers to process",gt=RangeError,ct=et(St.exec),ht=Math.floor,it=String.fromCharCode,ft=et("".charCodeAt),mt=et([].join),Tt=et([].push),It=et("".replace),Pt=et("".split),At=et("".toLowerCase),Nt=function(bt){return bt+22+75*(bt<26)},Ot=function(bt,Wt,zt){var Bt=0;for(bt=zt?ht(bt/700):bt>>1,bt+=ht(bt/Wt);bt>455;)bt=ht(bt/35),Bt+=36;return ht(Bt+36*bt/(bt+38))},Mt=function(bt){var Wt=[];bt=function(xn){for(var Mn=[],Dn=0,An=xn.length;Dn<An;){var Nn=ft(xn,Dn++);if(Nn>=55296&&Nn<=56319&&Dn<An){var Un=ft(xn,Dn++);(64512&Un)==56320?Tt(Mn,((1023&Nn)<<10)+(1023&Un)+65536):(Tt(Mn,Nn),Dn--)}else Tt(Mn,Nn)}return Mn}(bt);var zt,Bt,rn=bt.length,gn=128,tn=0,Ht=72;for(zt=0;zt<bt.length;zt++)(Bt=bt[zt])<128&&Tt(Wt,it(Bt));var fn=Wt.length,bn=fn;for(fn&&Tt(Wt,"-");bn<rn;){var In=ot;for(zt=0;zt<bt.length;zt++)(Bt=bt[zt])>=gn&&Bt<In&&(In=Bt);var un=bn+1;if(In-gn>ht((ot-tn)/un))throw gt(pt);for(tn+=(In-gn)*un,gn=In,zt=0;zt<bt.length;zt++){if((Bt=bt[zt])<gn&&++tn>ot)throw gt(pt);if(Bt==gn){for(var mn=tn,yn=36;;){var pn=yn<=Ht?1:yn>=Ht+26?26:yn-Ht;if(mn<pn)break;var Tn=mn-pn,kn=36-pn;Tt(Wt,it(Nt(pn+Tn%kn))),mn=ht(Tn/kn),yn+=36}Tt(Wt,it(Nt(mn))),Ht=Ot(tn,un,bn==fn),tn=0,bn++}}tn++,gn++}return mt(Wt,"")};at.exports=function(bt){var Wt,zt,Bt=[],rn=Pt(It(At(bt),St,"."),".");for(Wt=0;Wt<rn.length;Wt++)zt=rn[Wt],Tt(Bt,ct(lt,zt)?"xn--"+Mt(zt):zt);return mt(Bt,".")}},8415:(at,ut,s)=>{var et=s(9303),ot=s(1340),lt=s(4488),St=RangeError;at.exports=function(pt){var gt=ot(lt(this)),ct="",ht=et(pt);if(ht<0||ht==1/0)throw St("Wrong number of repetitions");for(;ht>0;(ht>>>=1)&&(gt+=gt))1&ht&&(ct+=gt);return ct}},3111:(at,ut,s)=>{var et=s(1702),ot=s(4488),lt=s(1340),St=s(1361),pt=et("".replace),gt="["+St+"]",ct=RegExp("^"+gt+gt+"*"),ht=RegExp(gt+gt+"*$"),it=function(ft){return function(mt){var Tt=lt(ot(mt));return 1&ft&&(Tt=pt(Tt,ct,"")),2&ft&&(Tt=pt(Tt,ht,"")),Tt}};at.exports={start:it(1),end:it(2),trim:it(3)}},6532:(at,ut,s)=>{var et=s(6916),ot=s(5005),lt=s(5112),St=s(8052);at.exports=function(){var pt=ot("Symbol"),gt=pt&&pt.prototype,ct=gt&&gt.valueOf,ht=lt("toPrimitive");gt&&!gt[ht]&&St(gt,ht,function(it){return et(ct,this)},{arity:1})}},261:(at,ut,s)=>{var et,ot,lt,St,pt=s(7854),gt=s(2104),ct=s(9974),ht=s(614),it=s(2597),ft=s(7293),mt=s(490),Tt=s(206),It=s(317),Pt=s(8053),At=s(6833),Nt=s(2805),Ot=pt.setImmediate,Mt=pt.clearImmediate,bt=pt.process,Wt=pt.Dispatch,zt=pt.Function,Bt=pt.MessageChannel,rn=pt.String,gn=0,tn={};try{et=pt.location}catch{}var Ht=function(un){if(it(tn,un)){var mn=tn[un];delete tn[un],mn()}},fn=function(un){return function(){Ht(un)}},bn=function(un){Ht(un.data)},In=function(un){pt.postMessage(rn(un),et.protocol+"//"+et.host)};Ot&&Mt||(Ot=function(un){Pt(arguments.length,1);var mn=ht(un)?un:zt(un),yn=Tt(arguments,1);return tn[++gn]=function(){gt(mn,void 0,yn)},ot(gn),gn},Mt=function(un){delete tn[un]},Nt?ot=function(un){bt.nextTick(fn(un))}:Wt&&Wt.now?ot=function(un){Wt.now(fn(un))}:Bt&&!At?(St=(lt=new Bt).port2,lt.port1.onmessage=bn,ot=ct(St.postMessage,St)):pt.addEventListener&&ht(pt.postMessage)&&!pt.importScripts&&et&&et.protocol!=="file:"&&!ft(In)?(ot=In,pt.addEventListener("message",bn,!1)):ot="onreadystatechange"in It("script")?function(un){mt.appendChild(It("script")).onreadystatechange=function(){mt.removeChild(this),Ht(un)}}:function(un){setTimeout(fn(un),0)}),at.exports={set:Ot,clear:Mt}},863:(at,ut,s)=>{var et=s(1702);at.exports=et(1 .valueOf)},1400:(at,ut,s)=>{var et=s(9303),ot=Math.max,lt=Math.min;at.exports=function(St,pt){var gt=et(St);return gt<0?ot(gt+pt,0):lt(gt,pt)}},4599:(at,ut,s)=>{var et=s(7593),ot=TypeError;at.exports=function(lt){var St=et(lt,"number");if(typeof St=="number")throw ot("Can't convert number to bigint");return BigInt(St)}},7067:(at,ut,s)=>{var et=s(9303),ot=s(7466),lt=RangeError;at.exports=function(St){if(St===void 0)return 0;var pt=et(St),gt=ot(pt);if(pt!==gt)throw lt("Wrong length or index");return gt}},5656:(at,ut,s)=>{var et=s(8361),ot=s(4488);at.exports=function(lt){return et(ot(lt))}},9303:(at,ut,s)=>{var et=s(4758);at.exports=function(ot){var lt=+ot;return lt!=lt||lt===0?0:et(lt)}},7466:(at,ut,s)=>{var et=s(9303),ot=Math.min;at.exports=function(lt){return lt>0?ot(et(lt),9007199254740991):0}},7908:(at,ut,s)=>{var et=s(4488),ot=Object;at.exports=function(lt){return ot(et(lt))}},4590:(at,ut,s)=>{var et=s(3002),ot=RangeError;at.exports=function(lt,St){var pt=et(lt);if(pt%St)throw ot("Wrong offset");return pt}},3002:(at,ut,s)=>{var et=s(9303),ot=RangeError;at.exports=function(lt){var St=et(lt);if(St<0)throw ot("The argument can't be less than 0");return St}},7593:(at,ut,s)=>{var et=s(6916),ot=s(111),lt=s(2190),St=s(8173),pt=s(2140),gt=s(5112),ct=TypeError,ht=gt("toPrimitive");at.exports=function(it,ft){if(!ot(it)||lt(it))return it;var mt,Tt=St(it,ht);if(Tt){if(ft===void 0&&(ft="default"),mt=et(Tt,it,ft),!ot(mt)||lt(mt))return mt;throw ct("Can't convert object to primitive value")}return ft===void 0&&(ft="number"),pt(it,ft)}},4948:(at,ut,s)=>{var et=s(7593),ot=s(2190);at.exports=function(lt){var St=et(lt,"string");return ot(St)?St:St+""}},1694:(at,ut,s)=>{var et={};et[s(5112)("toStringTag")]="z",at.exports=String(et)==="[object z]"},1340:(at,ut,s)=>{var et=s(648),ot=String;at.exports=function(lt){if(et(lt)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return ot(lt)}},6330:at=>{var ut=String;at.exports=function(s){try{return ut(s)}catch{return"Object"}}},9843:(at,ut,s)=>{var et=s(2109),ot=s(7854),lt=s(6916),St=s(9781),pt=s(3832),gt=s(260),ct=s(3331),ht=s(5787),it=s(9114),ft=s(8880),mt=s(5988),Tt=s(7466),It=s(7067),Pt=s(4590),At=s(4948),Nt=s(2597),Ot=s(648),Mt=s(111),bt=s(2190),Wt=s(30),zt=s(7976),Bt=s(7674),rn=s(8006).f,gn=s(7321),tn=s(2092).forEach,Ht=s(6340),fn=s(3070),bn=s(1236),In=s(9909),un=s(9587),mn=In.get,yn=In.set,pn=In.enforce,Tn=fn.f,kn=bn.f,xn=Math.round,Mn=ot.RangeError,Dn=ct.ArrayBuffer,An=Dn.prototype,Nn=ct.DataView,Un=gt.NATIVE_ARRAY_BUFFER_VIEWS,Qn=gt.TYPED_ARRAY_TAG,er=gt.TypedArray,zn=gt.TypedArrayPrototype,lr=gt.aTypedArrayConstructor,cn=gt.isTypedArray,Gn="BYTES_PER_ELEMENT",Yn="Wrong length",or=function(vn,On){lr(vn);for(var Kt=0,Rt=On.length,nt=new vn(Rt);Rt>Kt;)nt[Kt]=On[Kt++];return nt},Bn=function(vn,On){Tn(vn,On,{get:function(){return mn(this)[On]}})},rr=function(vn){var On;return zt(An,vn)||(On=Ot(vn))=="ArrayBuffer"||On=="SharedArrayBuffer"},Zn=function(vn,On){return cn(vn)&&!bt(On)&&On in vn&&mt(+On)&&On>=0},_n=function(vn,On){return On=At(On),Zn(vn,On)?it(2,vn[On]):kn(vn,On)},Ln=function(vn,On,Kt){return On=At(On),!(Zn(vn,On)&&Mt(Kt)&&Nt(Kt,"value"))||Nt(Kt,"get")||Nt(Kt,"set")||Kt.configurable||Nt(Kt,"writable")&&!Kt.writable||Nt(Kt,"enumerable")&&!Kt.enumerable?Tn(vn,On,Kt):(vn[On]=Kt.value,vn)};St?(Un||(bn.f=_n,fn.f=Ln,Bn(zn,"buffer"),Bn(zn,"byteOffset"),Bn(zn,"byteLength"),Bn(zn,"length")),et({target:"Object",stat:!0,forced:!Un},{getOwnPropertyDescriptor:_n,defineProperty:Ln}),at.exports=function(vn,On,Kt){var Rt=vn.match(/\d+$/)[0]/8,nt=vn+(Kt?"Clamped":"")+"Array",Ct="get"+vn,yt="set"+vn,xt=ot[nt],wt=xt,Lt=wt&&wt.prototype,Et={},$t=function(en,qt){Tn(en,qt,{get:function(){return function(on,hn){var nn=mn(on);return nn.view[Ct](hn*Rt+nn.byteOffset,!0)}(this,qt)},set:function(on){return function(hn,nn,dn){var Sn=mn(hn);Kt&&(dn=(dn=xn(dn))<0?0:dn>255?255:255&dn),Sn.view[yt](nn*Rt+Sn.byteOffset,dn,!0)}(this,qt,on)},enumerable:!0})};Un?pt&&(wt=On(function(en,qt,on,hn){return ht(en,Lt),un(Mt(qt)?rr(qt)?hn!==void 0?new xt(qt,Pt(on,Rt),hn):on!==void 0?new xt(qt,Pt(on,Rt)):new xt(qt):cn(qt)?or(wt,qt):lt(gn,wt,qt):new xt(It(qt)),en,wt)}),Bt&&Bt(wt,er),tn(rn(xt),function(en){en in wt||ft(wt,en,xt[en])}),wt.prototype=Lt):(wt=On(function(en,qt,on,hn){ht(en,Lt);var nn,dn,Sn,wn=0,En=0;if(Mt(qt)){if(!rr(qt))return cn(qt)?or(wt,qt):lt(gn,wt,qt);nn=qt,En=Pt(on,Rt);var Pn=qt.byteLength;if(hn===void 0){if(Pn%Rt||(dn=Pn-En)<0)throw Mn(Yn)}else if((dn=Tt(hn)*Rt)+En>Pn)throw Mn(Yn);Sn=dn/Rt}else Sn=It(qt),nn=new Dn(dn=Sn*Rt);for(yn(en,{buffer:nn,byteOffset:En,byteLength:dn,length:Sn,view:new Nn(nn)});wn<Sn;)$t(en,wn++)}),Bt&&Bt(wt,er),Lt=wt.prototype=Wt(zn)),Lt.constructor!==wt&&ft(Lt,"constructor",wt),pn(Lt).TypedArrayConstructor=wt,Qn&&ft(Lt,Qn,nt);var Jt=wt!=xt;Et[nt]=wt,et({global:!0,constructor:!0,forced:Jt,sham:!Un},Et),Gn in wt||ft(wt,Gn,Rt),Gn in Lt||ft(Lt,Gn,Rt),Ht(nt)}):at.exports=function(){}},3832:(at,ut,s)=>{var et=s(7854),ot=s(7293),lt=s(7072),St=s(260).NATIVE_ARRAY_BUFFER_VIEWS,pt=et.ArrayBuffer,gt=et.Int8Array;at.exports=!St||!ot(function(){gt(1)})||!ot(function(){new gt(-1)})||!lt(function(ct){new gt,new gt(null),new gt(1.5),new gt(ct)},!0)||ot(function(){return new gt(new pt(2),1,void 0).length!==1})},3074:(at,ut,s)=>{var et=s(7745),ot=s(6304);at.exports=function(lt,St){return et(ot(lt),St)}},7321:(at,ut,s)=>{var et=s(9974),ot=s(6916),lt=s(9483),St=s(7908),pt=s(6244),gt=s(8554),ct=s(1246),ht=s(7659),it=s(260).aTypedArrayConstructor;at.exports=function(ft){var mt,Tt,It,Pt,At,Nt,Ot=lt(this),Mt=St(ft),bt=arguments.length,Wt=bt>1?arguments[1]:void 0,zt=Wt!==void 0,Bt=ct(Mt);if(Bt&&!ht(Bt))for(Nt=(At=gt(Mt,Bt)).next,Mt=[];!(Pt=ot(Nt,At)).done;)Mt.push(Pt.value);for(zt&&bt>2&&(Wt=et(Wt,arguments[2])),Tt=pt(Mt),It=new(it(Ot))(Tt),mt=0;Tt>mt;mt++)It[mt]=zt?Wt(Mt[mt],mt):Mt[mt];return It}},6304:(at,ut,s)=>{var et=s(260),ot=s(6707),lt=et.aTypedArrayConstructor,St=et.getTypedArrayConstructor;at.exports=function(pt){return lt(ot(pt,St(pt)))}},9711:(at,ut,s)=>{var et=s(1702),ot=0,lt=Math.random(),St=et(1 .toString);at.exports=function(pt){return"Symbol("+(pt===void 0?"":pt)+")_"+St(++ot+lt,36)}},3307:(at,ut,s)=>{var et=s(133);at.exports=et&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3353:(at,ut,s)=>{var et=s(9781),ot=s(7293);at.exports=et&&ot(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},8053:at=>{var ut=TypeError;at.exports=function(s,et){if(s<et)throw ut("Not enough arguments");return s}},6061:(at,ut,s)=>{var et=s(5112);ut.f=et},5112:(at,ut,s)=>{var et=s(7854),ot=s(2309),lt=s(2597),St=s(9711),pt=s(133),gt=s(3307),ct=ot("wks"),ht=et.Symbol,it=ht&&ht.for,ft=gt?ht:ht&&ht.withoutSetter||St;at.exports=function(mt){if(!lt(ct,mt)||!pt&&typeof ct[mt]!="string"){var Tt="Symbol."+mt;pt&&lt(ht,mt)?ct[mt]=ht[mt]:ct[mt]=gt&&it?it(Tt):ft(Tt)}return ct[mt]}},1361:at=>{at.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},8264:(at,ut,s)=>{var et=s(2109),ot=s(7854),lt=s(3331),St=s(6340),pt=lt.ArrayBuffer;et({global:!0,constructor:!0,forced:ot.ArrayBuffer!==pt},{ArrayBuffer:pt}),St("ArrayBuffer")},9575:(at,ut,s)=>{var et=s(2109),ot=s(1702),lt=s(7293),St=s(3331),pt=s(9670),gt=s(1400),ct=s(7466),ht=s(6707),it=St.ArrayBuffer,ft=St.DataView,mt=ft.prototype,Tt=ot(it.prototype.slice),It=ot(mt.getUint8),Pt=ot(mt.setUint8);et({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:lt(function(){return!new it(2).slice(1,void 0).byteLength})},{slice:function(At,Nt){if(Tt&&Nt===void 0)return Tt(pt(this),At);for(var Ot=pt(this).byteLength,Mt=gt(At,Ot),bt=gt(Nt===void 0?Ot:Nt,Ot),Wt=new(ht(this,it))(ct(bt-Mt)),zt=new ft(this),Bt=new ft(Wt),rn=0;Mt<bt;)Pt(Bt,rn++,It(zt,Mt++));return Wt}})},2222:(at,ut,s)=>{var et=s(2109),ot=s(7293),lt=s(3157),St=s(111),pt=s(7908),gt=s(6244),ct=s(7207),ht=s(6135),it=s(5417),ft=s(1194),mt=s(5112),Tt=s(7392),It=mt("isConcatSpreadable"),Pt=Tt>=51||!ot(function(){var Ot=[];return Ot[It]=!1,Ot.concat()[0]!==Ot}),At=ft("concat"),Nt=function(Ot){if(!St(Ot))return!1;var Mt=Ot[It];return Mt!==void 0?!!Mt:lt(Ot)};et({target:"Array",proto:!0,arity:1,forced:!Pt||!At},{concat:function(Ot){var Mt,bt,Wt,zt,Bt,rn=pt(this),gn=it(rn,0),tn=0;for(Mt=-1,Wt=arguments.length;Mt<Wt;Mt++)if(Nt(Bt=Mt===-1?rn:arguments[Mt]))for(zt=gt(Bt),ct(tn+zt),bt=0;bt<zt;bt++,tn++)bt in Bt&&ht(gn,tn,Bt[bt]);else ct(tn+1),ht(gn,tn++,Bt);return gn.length=tn,gn}})},3290:(at,ut,s)=>{var et=s(2109),ot=s(1285),lt=s(1223);et({target:"Array",proto:!0},{fill:ot}),lt("fill")},7327:(at,ut,s)=>{var et=s(2109),ot=s(2092).filter;et({target:"Array",proto:!0,forced:!s(1194)("filter")},{filter:function(lt){return ot(this,lt,arguments.length>1?arguments[1]:void 0)}})},4553:(at,ut,s)=>{var et=s(2109),ot=s(2092).findIndex,lt=s(1223),St="findIndex",pt=!0;St in[]&&Array(1).findIndex(function(){pt=!1}),et({target:"Array",proto:!0,forced:pt},{findIndex:function(gt){return ot(this,gt,arguments.length>1?arguments[1]:void 0)}}),lt(St)},9826:(at,ut,s)=>{var et=s(2109),ot=s(2092).find,lt=s(1223),St="find",pt=!0;St in[]&&Array(1).find(function(){pt=!1}),et({target:"Array",proto:!0,forced:pt},{find:function(gt){return ot(this,gt,arguments.length>1?arguments[1]:void 0)}}),lt(St)},9554:(at,ut,s)=>{var et=s(2109),ot=s(8533);et({target:"Array",proto:!0,forced:[].forEach!=ot},{forEach:ot})},1038:(at,ut,s)=>{var et=s(2109),ot=s(8457);et({target:"Array",stat:!0,forced:!s(7072)(function(lt){Array.from(lt)})},{from:ot})},6699:(at,ut,s)=>{var et=s(2109),ot=s(1318).includes,lt=s(7293),St=s(1223);et({target:"Array",proto:!0,forced:lt(function(){return!Array(1).includes()})},{includes:function(pt){return ot(this,pt,arguments.length>1?arguments[1]:void 0)}}),St("includes")},2772:(at,ut,s)=>{var et=s(2109),ot=s(1702),lt=s(1318).indexOf,St=s(9341),pt=ot([].indexOf),gt=!!pt&&1/pt([1],1,-0)<0,ct=St("indexOf");et({target:"Array",proto:!0,forced:gt||!ct},{indexOf:function(ht){var it=arguments.length>1?arguments[1]:void 0;return gt?pt(this,ht,it)||0:lt(this,ht,it)}})},9753:(at,ut,s)=>{s(2109)({target:"Array",stat:!0},{isArray:s(3157)})},6992:(at,ut,s)=>{var et=s(5656),ot=s(1223),lt=s(7497),St=s(9909),pt=s(3070).f,gt=s(654),ct=s(1913),ht=s(9781),it="Array Iterator",ft=St.set,mt=St.getterFor(it);at.exports=gt(Array,"Array",function(It,Pt){ft(this,{type:it,target:et(It),index:0,kind:Pt})},function(){var It=mt(this),Pt=It.target,At=It.kind,Nt=It.index++;return!Pt||Nt>=Pt.length?(It.target=void 0,{value:void 0,done:!0}):At=="keys"?{value:Nt,done:!1}:At=="values"?{value:Pt[Nt],done:!1}:{value:[Nt,Pt[Nt]],done:!1}},"values");var Tt=lt.Arguments=lt.Array;if(ot("keys"),ot("values"),ot("entries"),!ct&&ht&&Tt.name!=="values")try{pt(Tt,"name",{value:"values"})}catch{}},9600:(at,ut,s)=>{var et=s(2109),ot=s(1702),lt=s(8361),St=s(5656),pt=s(9341),gt=ot([].join),ct=lt!=Object,ht=pt("join",",");et({target:"Array",proto:!0,forced:ct||!ht},{join:function(it){return gt(St(this),it===void 0?",":it)}})},4986:(at,ut,s)=>{var et=s(2109),ot=s(6583);et({target:"Array",proto:!0,forced:ot!==[].lastIndexOf},{lastIndexOf:ot})},1249:(at,ut,s)=>{var et=s(2109),ot=s(2092).map;et({target:"Array",proto:!0,forced:!s(1194)("map")},{map:function(lt){return ot(this,lt,arguments.length>1?arguments[1]:void 0)}})},7042:(at,ut,s)=>{var et=s(2109),ot=s(3157),lt=s(4411),St=s(111),pt=s(1400),gt=s(6244),ct=s(5656),ht=s(6135),it=s(5112),ft=s(1194),mt=s(206),Tt=ft("slice"),It=it("species"),Pt=Array,At=Math.max;et({target:"Array",proto:!0,forced:!Tt},{slice:function(Nt,Ot){var Mt,bt,Wt,zt=ct(this),Bt=gt(zt),rn=pt(Nt,Bt),gn=pt(Ot===void 0?Bt:Ot,Bt);if(ot(zt)&&(Mt=zt.constructor,(lt(Mt)&&(Mt===Pt||ot(Mt.prototype))||St(Mt)&&(Mt=Mt[It])===null)&&(Mt=void 0),Mt===Pt||Mt===void 0))return mt(zt,rn,gn);for(bt=new(Mt===void 0?Pt:Mt)(At(gn-rn,0)),Wt=0;rn<gn;rn++,Wt++)rn in zt&&ht(bt,Wt,zt[rn]);return bt.length=Wt,bt}})},2707:(at,ut,s)=>{var et=s(2109),ot=s(1702),lt=s(9662),St=s(7908),pt=s(6244),gt=s(5117),ct=s(1340),ht=s(7293),it=s(4362),ft=s(9341),mt=s(8886),Tt=s(256),It=s(7392),Pt=s(8008),At=[],Nt=ot(At.sort),Ot=ot(At.push),Mt=ht(function(){At.sort(void 0)}),bt=ht(function(){At.sort(null)}),Wt=ft("sort"),zt=!ht(function(){if(It)return It<70;if(!(mt&&mt>3)){if(Tt)return!0;if(Pt)return Pt<603;var Bt,rn,gn,tn,Ht="";for(Bt=65;Bt<76;Bt++){switch(rn=String.fromCharCode(Bt),Bt){case 66:case 69:case 70:case 72:gn=3;break;case 68:case 71:gn=4;break;default:gn=2}for(tn=0;tn<47;tn++)At.push({k:rn+tn,v:gn})}for(At.sort(function(fn,bn){return bn.v-fn.v}),tn=0;tn<At.length;tn++)rn=At[tn].k.charAt(0),Ht.charAt(Ht.length-1)!==rn&&(Ht+=rn);return Ht!=="DGBEFHACIJK"}});et({target:"Array",proto:!0,forced:Mt||!bt||!Wt||!zt},{sort:function(Bt){Bt!==void 0&&lt(Bt);var rn=St(this);if(zt)return Bt===void 0?Nt(rn):Nt(rn,Bt);var gn,tn,Ht=[],fn=pt(rn);for(tn=0;tn<fn;tn++)tn in rn&&Ot(Ht,rn[tn]);for(it(Ht,function(bn){return function(In,un){return un===void 0?-1:In===void 0?1:bn!==void 0?+bn(In,un)||0:ct(In)>ct(un)?1:-1}}(Bt)),gn=Ht.length,tn=0;tn<gn;)rn[tn]=Ht[tn++];for(;tn<fn;)gt(rn,tn++);return rn}})},561:(at,ut,s)=>{var et=s(2109),ot=s(7908),lt=s(1400),St=s(9303),pt=s(6244),gt=s(7207),ct=s(5417),ht=s(6135),it=s(5117),ft=s(1194)("splice"),mt=Math.max,Tt=Math.min;et({target:"Array",proto:!0,forced:!ft},{splice:function(It,Pt){var At,Nt,Ot,Mt,bt,Wt,zt=ot(this),Bt=pt(zt),rn=lt(It,Bt),gn=arguments.length;for(gn===0?At=Nt=0:gn===1?(At=0,Nt=Bt-rn):(At=gn-2,Nt=Tt(mt(St(Pt),0),Bt-rn)),gt(Bt+At-Nt),Ot=ct(zt,Nt),Mt=0;Mt<Nt;Mt++)(bt=rn+Mt)in zt&&ht(Ot,Mt,zt[bt]);if(Ot.length=Nt,At<Nt){for(Mt=rn;Mt<Bt-Nt;Mt++)Wt=Mt+At,(bt=Mt+Nt)in zt?zt[Wt]=zt[bt]:it(zt,Wt);for(Mt=Bt;Mt>Bt-Nt+At;Mt--)it(zt,Mt-1)}else if(At>Nt)for(Mt=Bt-Nt;Mt>rn;Mt--)Wt=Mt+At-1,(bt=Mt+Nt-1)in zt?zt[Wt]=zt[bt]:it(zt,Wt);for(Mt=0;Mt<At;Mt++)zt[Mt+rn]=arguments[Mt+2];return zt.length=Bt-Nt+At,Ot}})},3690:(at,ut,s)=>{var et=s(2109),ot=s(3331);et({global:!0,constructor:!0,forced:!s(4019)},{DataView:ot.DataView})},6716:(at,ut,s)=>{s(3690)},3843:(at,ut,s)=>{var et=s(2109),ot=s(1702),lt=Date,St=ot(lt.prototype.getTime);et({target:"Date",stat:!0},{now:function(){return St(new lt)}})},5268:(at,ut,s)=>{var et=s(2109),ot=s(5573);et({target:"Date",proto:!0,forced:Date.prototype.toISOString!==ot},{toISOString:ot})},5735:(at,ut,s)=>{var et=s(2109),ot=s(7293),lt=s(7908),St=s(7593);et({target:"Date",proto:!0,arity:1,forced:ot(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1})},{toJSON:function(pt){var gt=lt(this),ct=St(gt,"number");return typeof ct!="number"||isFinite(ct)?gt.toISOString():null}})},3710:(at,ut,s)=>{var et=s(1702),ot=s(8052),lt=Date.prototype,St="Invalid Date",pt=et(lt.toString),gt=et(lt.getTime);String(new Date(NaN))!=St&&ot(lt,"toString",function(){var ct=gt(this);return ct==ct?pt(this):St})},4812:(at,ut,s)=>{var et=s(2109),ot=s(7065);et({target:"Function",proto:!0,forced:Function.bind!==ot},{bind:ot})},8309:(at,ut,s)=>{var et=s(9781),ot=s(6530).EXISTS,lt=s(1702),St=s(3070).f,pt=Function.prototype,gt=lt(pt.toString),ct=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,ht=lt(ct.exec);et&&!ot&&St(pt,"name",{configurable:!0,get:function(){try{return ht(ct,gt(this))[1]}catch{return""}}})},8862:(at,ut,s)=>{var et=s(2109),ot=s(5005),lt=s(2104),St=s(6916),pt=s(1702),gt=s(7293),ct=s(3157),ht=s(614),it=s(111),ft=s(2190),mt=s(206),Tt=s(133),It=ot("JSON","stringify"),Pt=pt(/./.exec),At=pt("".charAt),Nt=pt("".charCodeAt),Ot=pt("".replace),Mt=pt(1 .toString),bt=/[\uD800-\uDFFF]/g,Wt=/^[\uD800-\uDBFF]$/,zt=/^[\uDC00-\uDFFF]$/,Bt=!Tt||gt(function(){var Ht=ot("Symbol")();return It([Ht])!="[null]"||It({a:Ht})!="{}"||It(Object(Ht))!="{}"}),rn=gt(function(){return It("\uDF06\uD834")!=='"\\udf06\\ud834"'||It("\uDEAD")!=='"\\udead"'}),gn=function(Ht,fn){var bn=mt(arguments),In=fn;if((it(fn)||Ht!==void 0)&&!ft(Ht))return ct(fn)||(fn=function(un,mn){if(ht(In)&&(mn=St(In,this,un,mn)),!ft(mn))return mn}),bn[1]=fn,lt(It,null,bn)},tn=function(Ht,fn,bn){var In=At(bn,fn-1),un=At(bn,fn+1);return Pt(Wt,Ht)&&!Pt(zt,un)||Pt(zt,Ht)&&!Pt(Wt,In)?"\\u"+Mt(Nt(Ht,0),16):Ht};It&&et({target:"JSON",stat:!0,arity:3,forced:Bt||rn},{stringify:function(Ht,fn,bn){var In=mt(arguments),un=lt(Bt?gn:It,null,In);return rn&&typeof un=="string"?Ot(un,bt,tn):un}})},3706:(at,ut,s)=>{var et=s(7854);s(8003)(et.JSON,"JSON",!0)},9098:(at,ut,s)=>{s(7710)("Map",function(et){return function(){return et(this,arguments.length?arguments[0]:void 0)}},s(5631))},1532:(at,ut,s)=>{s(9098)},658:(at,ut,s)=>{s(2109)({target:"Math",stat:!0},{log10:s(403)})},2703:(at,ut,s)=>{s(8003)(Math,"Math",!0)},9653:(at,ut,s)=>{var et=s(9781),ot=s(7854),lt=s(1702),St=s(4705),pt=s(8052),gt=s(2597),ct=s(9587),ht=s(7976),it=s(2190),ft=s(7593),mt=s(7293),Tt=s(8006).f,It=s(1236).f,Pt=s(3070).f,At=s(863),Nt=s(3111).trim,Ot="Number",Mt=ot.Number,bt=Mt.prototype,Wt=ot.TypeError,zt=lt("".slice),Bt=lt("".charCodeAt),rn=function(In){var un=ft(In,"number");return typeof un=="bigint"?un:gn(un)},gn=function(In){var un,mn,yn,pn,Tn,kn,xn,Mn,Dn=ft(In,"number");if(it(Dn))throw Wt("Cannot convert a Symbol value to a number");if(typeof Dn=="string"&&Dn.length>2){if(Dn=Nt(Dn),(un=Bt(Dn,0))===43||un===45){if((mn=Bt(Dn,2))===88||mn===120)return NaN}else if(un===48){switch(Bt(Dn,1)){case 66:case 98:yn=2,pn=49;break;case 79:case 111:yn=8,pn=55;break;default:return+Dn}for(kn=(Tn=zt(Dn,2)).length,xn=0;xn<kn;xn++)if((Mn=Bt(Tn,xn))<48||Mn>pn)return NaN;return parseInt(Tn,yn)}}return+Dn};if(St(Ot,!Mt(" 0o1")||!Mt("0b1")||Mt("+0x1"))){for(var tn,Ht=function(In){var un=arguments.length<1?0:Mt(rn(In)),mn=this;return ht(bt,mn)&&mt(function(){At(mn)})?ct(Object(un),mn,Ht):un},fn=et?Tt(Mt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),bn=0;fn.length>bn;bn++)gt(Mt,tn=fn[bn])&&!gt(Ht,tn)&&Pt(Ht,tn,It(Mt,tn));Ht.prototype=bt,bt.constructor=Ht,pt(ot,Ot,Ht,{constructor:!0})}},3161:(at,ut,s)=>{s(2109)({target:"Number",stat:!0},{isInteger:s(5988)})},4363:(at,ut,s)=>{s(2109)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},9601:(at,ut,s)=>{var et=s(2109),ot=s(1574);et({target:"Object",stat:!0,arity:2,forced:Object.assign!==ot},{assign:ot})},8011:(at,ut,s)=>{s(2109)({target:"Object",stat:!0,sham:!s(9781)},{create:s(30)})},9070:(at,ut,s)=>{var et=s(2109),ot=s(9781),lt=s(3070).f;et({target:"Object",stat:!0,forced:Object.defineProperty!==lt,sham:!ot},{defineProperty:lt})},9720:(at,ut,s)=>{var et=s(2109),ot=s(4699).entries;et({target:"Object",stat:!0},{entries:function(lt){return ot(lt)}})},5003:(at,ut,s)=>{var et=s(2109),ot=s(7293),lt=s(5656),St=s(1236).f,pt=s(9781),gt=ot(function(){St(1)});et({target:"Object",stat:!0,forced:!pt||gt,sham:!pt},{getOwnPropertyDescriptor:function(ct,ht){return St(lt(ct),ht)}})},9660:(at,ut,s)=>{var et=s(2109),ot=s(133),lt=s(7293),St=s(5181),pt=s(7908);et({target:"Object",stat:!0,forced:!ot||lt(function(){St.f(1)})},{getOwnPropertySymbols:function(gt){var ct=St.f;return ct?ct(pt(gt)):[]}})},489:(at,ut,s)=>{var et=s(2109),ot=s(7293),lt=s(7908),St=s(9518),pt=s(8544);et({target:"Object",stat:!0,forced:ot(function(){St(1)}),sham:!pt},{getPrototypeOf:function(gt){return St(lt(gt))}})},7941:(at,ut,s)=>{var et=s(2109),ot=s(7908),lt=s(1956);et({target:"Object",stat:!0,forced:s(7293)(function(){lt(1)})},{keys:function(St){return lt(ot(St))}})},8304:(at,ut,s)=>{s(2109)({target:"Object",stat:!0},{setPrototypeOf:s(7674)})},1539:(at,ut,s)=>{var et=s(1694),ot=s(8052),lt=s(288);et||ot(Object.prototype,"toString",lt,{unsafe:!0})},2479:(at,ut,s)=>{var et=s(2109),ot=s(4699).values;et({target:"Object",stat:!0},{values:function(lt){return ot(lt)}})},1058:(at,ut,s)=>{var et=s(2109),ot=s(3009);et({global:!0,forced:parseInt!=ot},{parseInt:ot})},821:(at,ut,s)=>{var et=s(2109),ot=s(6916),lt=s(9662),St=s(8523),pt=s(2534),gt=s(408);et({target:"Promise",stat:!0,forced:s(612)},{all:function(ct){var ht=this,it=St.f(ht),ft=it.resolve,mt=it.reject,Tt=pt(function(){var It=lt(ht.resolve),Pt=[],At=0,Nt=1;gt(ct,function(Ot){var Mt=At++,bt=!1;Nt++,ot(It,ht,Ot).then(function(Wt){bt||(bt=!0,Pt[Mt]=Wt,--Nt||ft(Pt))},mt)}),--Nt||ft(Pt)});return Tt.error&&mt(Tt.value),it.promise}})},4164:(at,ut,s)=>{var et=s(2109),ot=s(1913),lt=s(3702).CONSTRUCTOR,St=s(2492),pt=s(5005),gt=s(614),ct=s(8052),ht=St&&St.prototype;if(et({target:"Promise",proto:!0,forced:lt,real:!0},{catch:function(ft){return this.then(void 0,ft)}}),!ot&&gt(St)){var it=pt("Promise").prototype.catch;ht.catch!==it&&ct(ht,"catch",it,{unsafe:!0})}},3401:(at,ut,s)=>{var et,ot,lt,St=s(2109),pt=s(1913),gt=s(2805),ct=s(7854),ht=s(6916),it=s(8052),ft=s(7674),mt=s(8003),Tt=s(6340),It=s(9662),Pt=s(614),At=s(111),Nt=s(5787),Ot=s(6707),Mt=s(261).set,bt=s(5948),Wt=s(842),zt=s(2534),Bt=s(8572),rn=s(9909),gn=s(2492),tn=s(3702),Ht=s(8523),fn="Promise",bn=tn.CONSTRUCTOR,In=tn.REJECTION_EVENT,un=tn.SUBCLASSING,mn=rn.getterFor(fn),yn=rn.set,pn=gn&&gn.prototype,Tn=gn,kn=pn,xn=ct.TypeError,Mn=ct.document,Dn=ct.process,An=Ht.f,Nn=An,Un=!!(Mn&&Mn.createEvent&&ct.dispatchEvent),Qn="unhandledrejection",er=function(_n){var Ln;return!(!At(_n)||!Pt(Ln=_n.then))&&Ln},zn=function(_n,Ln){var vn,On,Kt,Rt=Ln.value,nt=Ln.state==1,Ct=nt?_n.ok:_n.fail,yt=_n.resolve,xt=_n.reject,wt=_n.domain;try{Ct?(nt||(Ln.rejection===2&&or(Ln),Ln.rejection=1),Ct===!0?vn=Rt:(wt&&wt.enter(),vn=Ct(Rt),wt&&(wt.exit(),Kt=!0)),vn===_n.promise?xt(xn("Promise-chain cycle")):(On=er(vn))?ht(On,vn,yt,xt):yt(vn)):xt(Rt)}catch(Lt){wt&&!Kt&&wt.exit(),xt(Lt)}},lr=function(_n,Ln){_n.notified||(_n.notified=!0,bt(function(){for(var vn,On=_n.reactions;vn=On.get();)zn(vn,_n);_n.notified=!1,Ln&&!_n.rejection&&Gn(_n)}))},cn=function(_n,Ln,vn){var On,Kt;Un?((On=Mn.createEvent("Event")).promise=Ln,On.reason=vn,On.initEvent(_n,!1,!0),ct.dispatchEvent(On)):On={promise:Ln,reason:vn},!In&&(Kt=ct["on"+_n])?Kt(On):_n===Qn&&Wt("Unhandled promise rejection",vn)},Gn=function(_n){ht(Mt,ct,function(){var Ln,vn=_n.facade,On=_n.value;if(Yn(_n)&&(Ln=zt(function(){gt?Dn.emit("unhandledRejection",On,vn):cn(Qn,vn,On)}),_n.rejection=gt||Yn(_n)?2:1,Ln.error))throw Ln.value})},Yn=function(_n){return _n.rejection!==1&&!_n.parent},or=function(_n){ht(Mt,ct,function(){var Ln=_n.facade;gt?Dn.emit("rejectionHandled",Ln):cn("rejectionhandled",Ln,_n.value)})},Bn=function(_n,Ln,vn){return function(On){_n(Ln,On,vn)}},rr=function(_n,Ln,vn){_n.done||(_n.done=!0,vn&&(_n=vn),_n.value=Ln,_n.state=2,lr(_n,!0))},Zn=function(_n,Ln,vn){if(!_n.done){_n.done=!0,vn&&(_n=vn);try{if(_n.facade===Ln)throw xn("Promise can't be resolved itself");var On=er(Ln);On?bt(function(){var Kt={done:!1};try{ht(On,Ln,Bn(Zn,Kt,_n),Bn(rr,Kt,_n))}catch(Rt){rr(Kt,Rt,_n)}}):(_n.value=Ln,_n.state=1,lr(_n,!1))}catch(Kt){rr({done:!1},Kt,_n)}}};if(bn&&(kn=(Tn=function(_n){Nt(this,kn),It(_n),ht(et,this);var Ln=mn(this);try{_n(Bn(Zn,Ln),Bn(rr,Ln))}catch(vn){rr(Ln,vn)}}).prototype,(et=function(_n){yn(this,{type:fn,done:!1,notified:!1,parent:!1,reactions:new Bt,rejection:!1,state:0,value:void 0})}).prototype=it(kn,"then",function(_n,Ln){var vn=mn(this),On=An(Ot(this,Tn));return vn.parent=!0,On.ok=!Pt(_n)||_n,On.fail=Pt(Ln)&&Ln,On.domain=gt?Dn.domain:void 0,vn.state==0?vn.reactions.add(On):bt(function(){zn(On,vn)}),On.promise}),ot=function(){var _n=new et,Ln=mn(_n);this.promise=_n,this.resolve=Bn(Zn,Ln),this.reject=Bn(rr,Ln)},Ht.f=An=function(_n){return _n===Tn||_n===void 0?new ot(_n):Nn(_n)},!pt&&Pt(gn)&&pn!==Object.prototype)){lt=pn.then,un||it(pn,"then",function(_n,Ln){var vn=this;return new Tn(function(On,Kt){ht(lt,vn,On,Kt)}).then(_n,Ln)},{unsafe:!0});try{delete pn.constructor}catch{}ft&&ft(pn,kn)}St({global:!0,constructor:!0,wrap:!0,forced:bn},{Promise:Tn}),mt(Tn,fn,!1,!0),Tt(fn)},8674:(at,ut,s)=>{s(3401),s(821),s(4164),s(6027),s(683),s(6294)},6027:(at,ut,s)=>{var et=s(2109),ot=s(6916),lt=s(9662),St=s(8523),pt=s(2534),gt=s(408);et({target:"Promise",stat:!0,forced:s(612)},{race:function(ct){var ht=this,it=St.f(ht),ft=it.reject,mt=pt(function(){var Tt=lt(ht.resolve);gt(ct,function(It){ot(Tt,ht,It).then(it.resolve,ft)})});return mt.error&&ft(mt.value),it.promise}})},683:(at,ut,s)=>{var et=s(2109),ot=s(6916),lt=s(8523);et({target:"Promise",stat:!0,forced:s(3702).CONSTRUCTOR},{reject:function(St){var pt=lt.f(this);return ot(pt.reject,void 0,St),pt.promise}})},6294:(at,ut,s)=>{var et=s(2109),ot=s(5005),lt=s(1913),St=s(2492),pt=s(3702).CONSTRUCTOR,gt=s(9478),ct=ot("Promise"),ht=lt&&!pt;et({target:"Promise",stat:!0,forced:lt||pt},{resolve:function(it){return gt(ht&&this===ct?St:this,it)}})},2419:(at,ut,s)=>{var et=s(2109),ot=s(5005),lt=s(2104),St=s(7065),pt=s(9483),gt=s(9670),ct=s(111),ht=s(30),it=s(7293),ft=ot("Reflect","construct"),mt=Object.prototype,Tt=[].push,It=it(function(){function Nt(){}return!(ft(function(){},[],Nt)instanceof Nt)}),Pt=!it(function(){ft(function(){})}),At=It||Pt;et({target:"Reflect",stat:!0,forced:At,sham:At},{construct:function(Nt,Ot){pt(Nt),gt(Ot);var Mt=arguments.length<3?Nt:pt(arguments[2]);if(Pt&&!It)return ft(Nt,Ot,Mt);if(Nt==Mt){switch(Ot.length){case 0:return new Nt;case 1:return new Nt(Ot[0]);case 2:return new Nt(Ot[0],Ot[1]);case 3:return new Nt(Ot[0],Ot[1],Ot[2]);case 4:return new Nt(Ot[0],Ot[1],Ot[2],Ot[3])}var bt=[null];return lt(Tt,bt,Ot),new(lt(St,Nt,bt))}var Wt=Mt.prototype,zt=ht(ct(Wt)?Wt:mt),Bt=lt(Nt,zt,Ot);return ct(Bt)?Bt:zt}})},4819:(at,ut,s)=>{var et=s(2109),ot=s(6916),lt=s(111),St=s(9670),pt=s(5032),gt=s(1236),ct=s(9518);et({target:"Reflect",stat:!0},{get:function ht(it,ft){var mt,Tt,It=arguments.length<3?it:arguments[2];return St(it)===It?it[ft]:(mt=gt.f(it,ft))?pt(mt)?mt.value:mt.get===void 0?void 0:ot(mt.get,It):lt(Tt=ct(it))?ht(Tt,ft,It):void 0}})},4603:(at,ut,s)=>{var et=s(9781),ot=s(7854),lt=s(1702),St=s(4705),pt=s(9587),gt=s(8880),ct=s(8006).f,ht=s(7976),it=s(7850),ft=s(1340),mt=s(4706),Tt=s(2999),It=s(2626),Pt=s(8052),At=s(7293),Nt=s(2597),Ot=s(9909).enforce,Mt=s(6340),bt=s(5112),Wt=s(9441),zt=s(7168),Bt=bt("match"),rn=ot.RegExp,gn=rn.prototype,tn=ot.SyntaxError,Ht=lt(gn.exec),fn=lt("".charAt),bn=lt("".replace),In=lt("".indexOf),un=lt("".slice),mn=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,yn=/a/g,pn=/a/g,Tn=new rn(yn)!==yn,kn=Tt.MISSED_STICKY,xn=Tt.UNSUPPORTED_Y;if(St("RegExp",et&&(!Tn||kn||Wt||zt||At(function(){return pn[Bt]=!1,rn(yn)!=yn||rn(pn)==pn||rn(yn,"i")!="/a/i"})))){for(var Mn=function(Nn,Un){var Qn,er,zn,lr,cn,Gn,Yn=ht(gn,this),or=it(Nn),Bn=Un===void 0,rr=[],Zn=Nn;if(!Yn&&or&&Bn&&Nn.constructor===Mn)return Nn;if((or||ht(gn,Nn))&&(Nn=Nn.source,Bn&&(Un=mt(Zn))),Nn=Nn===void 0?"":ft(Nn),Un=Un===void 0?"":ft(Un),Zn=Nn,Wt&&"dotAll"in yn&&(er=!!Un&&In(Un,"s")>-1)&&(Un=bn(Un,/s/g,"")),Qn=Un,kn&&"sticky"in yn&&(zn=!!Un&&In(Un,"y")>-1)&&xn&&(Un=bn(Un,/y/g,"")),zt&&(lr=function(_n){for(var Ln,vn=_n.length,On=0,Kt="",Rt=[],nt={},Ct=!1,yt=!1,xt=0,wt="";On<=vn;On++){if((Ln=fn(_n,On))==="\\")Ln+=fn(_n,++On);else if(Ln==="]")Ct=!1;else if(!Ct)switch(!0){case Ln==="[":Ct=!0;break;case Ln==="(":Ht(mn,un(_n,On+1))&&(On+=2,yt=!0),Kt+=Ln,xt++;continue;case(Ln===">"&&yt):if(wt===""||Nt(nt,wt))throw new tn("Invalid capture group name");nt[wt]=!0,Rt[Rt.length]=[wt,xt],yt=!1,wt="";continue}yt?wt+=Ln:Kt+=Ln}return[Kt,Rt]}(Nn),Nn=lr[0],rr=lr[1]),cn=pt(rn(Nn,Un),Yn?this:gn,Mn),(er||zn||rr.length)&&(Gn=Ot(cn),er&&(Gn.dotAll=!0,Gn.raw=Mn(function(_n){for(var Ln,vn=_n.length,On=0,Kt="",Rt=!1;On<=vn;On++)(Ln=fn(_n,On))!=="\\"?Rt||Ln!=="."?(Ln==="["?Rt=!0:Ln==="]"&&(Rt=!1),Kt+=Ln):Kt+="[\\s\\S]":Kt+=Ln+fn(_n,++On);return Kt}(Nn),Qn)),zn&&(Gn.sticky=!0),rr.length&&(Gn.groups=rr)),Nn!==Zn)try{gt(cn,"source",Zn===""?"(?:)":Zn)}catch{}return cn},Dn=ct(rn),An=0;Dn.length>An;)It(Mn,rn,Dn[An++]);gn.constructor=Mn,Mn.prototype=gn,Pt(ot,"RegExp",Mn,{constructor:!0})}Mt("RegExp")},4916:(at,ut,s)=>{var et=s(2109),ot=s(2261);et({target:"RegExp",proto:!0,forced:/./.exec!==ot},{exec:ot})},9714:(at,ut,s)=>{var et=s(6530).PROPER,ot=s(8052),lt=s(9670),St=s(1340),pt=s(7293),gt=s(4706),ct="toString",ht=RegExp.prototype.toString,it=pt(function(){return ht.call({source:"a",flags:"b"})!="/a/b"}),ft=et&&ht.name!=ct;(it||ft)&&ot(RegExp.prototype,ct,function(){var mt=lt(this);return"/"+St(mt.source)+"/"+St(gt(mt))},{unsafe:!0})},7227:(at,ut,s)=>{s(7710)("Set",function(et){return function(){return et(this,arguments.length?arguments[0]:void 0)}},s(5631))},189:(at,ut,s)=>{s(7227)},2023:(at,ut,s)=>{var et=s(2109),ot=s(1702),lt=s(3929),St=s(4488),pt=s(1340),gt=s(4964),ct=ot("".indexOf);et({target:"String",proto:!0,forced:!gt("includes")},{includes:function(ht){return!!~ct(pt(St(this)),pt(lt(ht)),arguments.length>1?arguments[1]:void 0)}})},8783:(at,ut,s)=>{var et=s(8710).charAt,ot=s(1340),lt=s(9909),St=s(654),pt="String Iterator",gt=lt.set,ct=lt.getterFor(pt);St(String,"String",function(ht){gt(this,{type:pt,string:ot(ht),index:0})},function(){var ht,it=ct(this),ft=it.string,mt=it.index;return mt>=ft.length?{value:void 0,done:!0}:(ht=et(ft,mt),it.index+=ht.length,{value:ht,done:!1})})},4723:(at,ut,s)=>{var et=s(6916),ot=s(7007),lt=s(9670),St=s(7466),pt=s(1340),gt=s(4488),ct=s(8173),ht=s(1530),it=s(7651);ot("match",function(ft,mt,Tt){return[function(It){var Pt=gt(this),At=It==null?void 0:ct(It,ft);return At?et(At,It,Pt):new RegExp(It)[ft](pt(Pt))},function(It){var Pt=lt(this),At=pt(It),Nt=Tt(mt,Pt,At);if(Nt.done)return Nt.value;if(!Pt.global)return it(Pt,At);var Ot=Pt.unicode;Pt.lastIndex=0;for(var Mt,bt=[],Wt=0;(Mt=it(Pt,At))!==null;){var zt=pt(Mt[0]);bt[Wt]=zt,zt===""&&(Pt.lastIndex=ht(At,St(Pt.lastIndex),Ot)),Wt++}return Wt===0?null:bt}]})},5306:(at,ut,s)=>{var et=s(2104),ot=s(6916),lt=s(1702),St=s(7007),pt=s(7293),gt=s(9670),ct=s(614),ht=s(9303),it=s(7466),ft=s(1340),mt=s(4488),Tt=s(1530),It=s(8173),Pt=s(647),At=s(7651),Nt=s(5112)("replace"),Ot=Math.max,Mt=Math.min,bt=lt([].concat),Wt=lt([].push),zt=lt("".indexOf),Bt=lt("".slice),rn="a".replace(/./,"$0")==="$0",gn=!!/./[Nt]&&/./[Nt]("a","$0")==="";St("replace",function(tn,Ht,fn){var bn=gn?"$":"$0";return[function(In,un){var mn=mt(this),yn=In==null?void 0:It(In,Nt);return yn?ot(yn,In,mn,un):ot(Ht,ft(mn),In,un)},function(In,un){var mn=gt(this),yn=ft(In);if(typeof un=="string"&&zt(un,bn)===-1&&zt(un,"$<")===-1){var pn=fn(Ht,mn,yn,un);if(pn.done)return pn.value}var Tn=ct(un);Tn||(un=ft(un));var kn=mn.global;if(kn){var xn=mn.unicode;mn.lastIndex=0}for(var Mn=[];;){var Dn=At(mn,yn);if(Dn===null||(Wt(Mn,Dn),!kn))break;ft(Dn[0])===""&&(mn.lastIndex=Tt(yn,it(mn.lastIndex),xn))}for(var An,Nn="",Un=0,Qn=0;Qn<Mn.length;Qn++){for(var er=ft((Dn=Mn[Qn])[0]),zn=Ot(Mt(ht(Dn.index),yn.length),0),lr=[],cn=1;cn<Dn.length;cn++)Wt(lr,(An=Dn[cn])===void 0?An:String(An));var Gn=Dn.groups;if(Tn){var Yn=bt([er],lr,zn,yn);Gn!==void 0&&Wt(Yn,Gn);var or=ft(et(un,void 0,Yn))}else or=Pt(er,yn,zn,lr,Gn,un);zn>=Un&&(Nn+=Bt(yn,Un,zn)+or,Un=zn+er.length)}return Nn+Bt(yn,Un)}]},!!pt(function(){var tn=/./;return tn.exec=function(){var Ht=[];return Ht.groups={a:"7"},Ht},"".replace(tn,"$<a>")!=="7"})||!rn||gn)},4765:(at,ut,s)=>{var et=s(6916),ot=s(7007),lt=s(9670),St=s(4488),pt=s(1150),gt=s(1340),ct=s(8173),ht=s(7651);ot("search",function(it,ft,mt){return[function(Tt){var It=St(this),Pt=Tt==null?void 0:ct(Tt,it);return Pt?et(Pt,Tt,It):new RegExp(Tt)[it](gt(It))},function(Tt){var It=lt(this),Pt=gt(Tt),At=mt(ft,It,Pt);if(At.done)return At.value;var Nt=It.lastIndex;pt(Nt,0)||(It.lastIndex=0);var Ot=ht(It,Pt);return pt(It.lastIndex,Nt)||(It.lastIndex=Nt),Ot===null?-1:Ot.index}]})},3123:(at,ut,s)=>{var et=s(2104),ot=s(6916),lt=s(1702),St=s(7007),pt=s(7850),gt=s(9670),ct=s(4488),ht=s(6707),it=s(1530),ft=s(7466),mt=s(1340),Tt=s(8173),It=s(1589),Pt=s(7651),At=s(2261),Nt=s(2999),Ot=s(7293),Mt=Nt.UNSUPPORTED_Y,bt=4294967295,Wt=Math.min,zt=[].push,Bt=lt(/./.exec),rn=lt(zt),gn=lt("".slice);St("split",function(tn,Ht,fn){var bn;return bn="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?function(In,un){var mn=mt(ct(this)),yn=un===void 0?bt:un>>>0;if(yn===0)return[];if(In===void 0)return[mn];if(!pt(In))return ot(Ht,mn,In,yn);for(var pn,Tn,kn,xn=[],Mn=(In.ignoreCase?"i":"")+(In.multiline?"m":"")+(In.unicode?"u":"")+(In.sticky?"y":""),Dn=0,An=new RegExp(In.source,Mn+"g");(pn=ot(At,An,mn))&&!((Tn=An.lastIndex)>Dn&&(rn(xn,gn(mn,Dn,pn.index)),pn.length>1&&pn.index<mn.length&&et(zt,xn,It(pn,1)),kn=pn[0].length,Dn=Tn,xn.length>=yn));)An.lastIndex===pn.index&&An.lastIndex++;return Dn===mn.length?!kn&&Bt(An,"")||rn(xn,""):rn(xn,gn(mn,Dn)),xn.length>yn?It(xn,0,yn):xn}:"0".split(void 0,0).length?function(In,un){return In===void 0&&un===0?[]:ot(Ht,this,In,un)}:Ht,[function(In,un){var mn=ct(this),yn=In==null?void 0:Tt(In,tn);return yn?ot(yn,In,mn,un):ot(bn,mt(mn),In,un)},function(In,un){var mn=gt(this),yn=mt(In),pn=fn(bn,mn,yn,un,bn!==Ht);if(pn.done)return pn.value;var Tn=ht(mn,RegExp),kn=mn.unicode,xn=(mn.ignoreCase?"i":"")+(mn.multiline?"m":"")+(mn.unicode?"u":"")+(Mt?"g":"y"),Mn=new Tn(Mt?"^(?:"+mn.source+")":mn,xn),Dn=un===void 0?bt:un>>>0;if(Dn===0)return[];if(yn.length===0)return Pt(Mn,yn)===null?[yn]:[];for(var An=0,Nn=0,Un=[];Nn<yn.length;){Mn.lastIndex=Mt?0:Nn;var Qn,er=Pt(Mn,Mt?gn(yn,Nn):yn);if(er===null||(Qn=Wt(ft(Mn.lastIndex+(Mt?Nn:0)),yn.length))===An)Nn=it(yn,Nn,kn);else{if(rn(Un,gn(yn,An,Nn)),Un.length===Dn)return Un;for(var zn=1;zn<=er.length-1;zn++)if(rn(Un,er[zn]),Un.length===Dn)return Un;Nn=An=Qn}}return rn(Un,gn(yn,An)),Un}]},!!Ot(function(){var tn=/(?:)/,Ht=tn.exec;tn.exec=function(){return Ht.apply(this,arguments)};var fn="ab".split(tn);return fn.length!==2||fn[0]!=="a"||fn[1]!=="b"}),Mt)},6755:(at,ut,s)=>{var et,ot=s(2109),lt=s(1702),St=s(1236).f,pt=s(7466),gt=s(1340),ct=s(3929),ht=s(4488),it=s(4964),ft=s(1913),mt=lt("".startsWith),Tt=lt("".slice),It=Math.min,Pt=it("startsWith");ot({target:"String",proto:!0,forced:!(!ft&&!Pt&&(et=St(String.prototype,"startsWith"),et&&!et.writable)||Pt)},{startsWith:function(At){var Nt=gt(ht(this));ct(At);var Ot=pt(It(arguments.length>1?arguments[1]:void 0,Nt.length)),Mt=gt(At);return mt?mt(Nt,Mt,Ot):Tt(Nt,Ot,Ot+Mt.length)===Mt}})},2443:(at,ut,s)=>{s(7235)("asyncIterator")},4032:(at,ut,s)=>{var et=s(2109),ot=s(7854),lt=s(6916),St=s(1702),pt=s(1913),gt=s(9781),ct=s(133),ht=s(7293),it=s(2597),ft=s(7976),mt=s(9670),Tt=s(5656),It=s(4948),Pt=s(1340),At=s(9114),Nt=s(30),Ot=s(1956),Mt=s(8006),bt=s(1156),Wt=s(5181),zt=s(1236),Bt=s(3070),rn=s(6048),gn=s(5296),tn=s(8052),Ht=s(2309),fn=s(6200),bn=s(3501),In=s(9711),un=s(5112),mn=s(6061),yn=s(7235),pn=s(6532),Tn=s(8003),kn=s(9909),xn=s(2092).forEach,Mn=fn("hidden"),Dn="Symbol",An=kn.set,Nn=kn.getterFor(Dn),Un=Object.prototype,Qn=ot.Symbol,er=Qn&&Qn.prototype,zn=ot.TypeError,lr=ot.QObject,cn=zt.f,Gn=Bt.f,Yn=bt.f,or=gn.f,Bn=St([].push),rr=Ht("symbols"),Zn=Ht("op-symbols"),_n=Ht("wks"),Ln=!lr||!lr.prototype||!lr.prototype.findChild,vn=gt&&ht(function(){return Nt(Gn({},"a",{get:function(){return Gn(this,"a",{value:7}).a}})).a!=7})?function(wt,Lt,Et){var $t=cn(Un,Lt);$t&&delete Un[Lt],Gn(wt,Lt,Et),$t&&wt!==Un&&Gn(Un,Lt,$t)}:Gn,On=function(wt,Lt){var Et=rr[wt]=Nt(er);return An(Et,{type:Dn,tag:wt,description:Lt}),gt||(Et.description=Lt),Et},Kt=function(wt,Lt,Et){wt===Un&&Kt(Zn,Lt,Et),mt(wt);var $t=It(Lt);return mt(Et),it(rr,$t)?(Et.enumerable?(it(wt,Mn)&&wt[Mn][$t]&&(wt[Mn][$t]=!1),Et=Nt(Et,{enumerable:At(0,!1)})):(it(wt,Mn)||Gn(wt,Mn,At(1,{})),wt[Mn][$t]=!0),vn(wt,$t,Et)):Gn(wt,$t,Et)},Rt=function(wt,Lt){mt(wt);var Et=Tt(Lt),$t=Ot(Et).concat(xt(Et));return xn($t,function(Jt){gt&&!lt(nt,Et,Jt)||Kt(wt,Jt,Et[Jt])}),wt},nt=function(wt){var Lt=It(wt),Et=lt(or,this,Lt);return!(this===Un&&it(rr,Lt)&&!it(Zn,Lt))&&(!(Et||!it(this,Lt)||!it(rr,Lt)||it(this,Mn)&&this[Mn][Lt])||Et)},Ct=function(wt,Lt){var Et=Tt(wt),$t=It(Lt);if(Et!==Un||!it(rr,$t)||it(Zn,$t)){var Jt=cn(Et,$t);return!Jt||!it(rr,$t)||it(Et,Mn)&&Et[Mn][$t]||(Jt.enumerable=!0),Jt}},yt=function(wt){var Lt=Yn(Tt(wt)),Et=[];return xn(Lt,function($t){it(rr,$t)||it(bn,$t)||Bn(Et,$t)}),Et},xt=function(wt){var Lt=wt===Un,Et=Yn(Lt?Zn:Tt(wt)),$t=[];return xn(Et,function(Jt){!it(rr,Jt)||Lt&&!it(Un,Jt)||Bn($t,rr[Jt])}),$t};ct||(tn(er=(Qn=function(){if(ft(er,this))throw zn("Symbol is not a constructor");var wt=arguments.length&&arguments[0]!==void 0?Pt(arguments[0]):void 0,Lt=In(wt),Et=function($t){this===Un&&lt(Et,Zn,$t),it(this,Mn)&&it(this[Mn],Lt)&&(this[Mn][Lt]=!1),vn(this,Lt,At(1,$t))};return gt&&Ln&&vn(Un,Lt,{configurable:!0,set:Et}),On(Lt,wt)}).prototype,"toString",function(){return Nn(this).tag}),tn(Qn,"withoutSetter",function(wt){return On(In(wt),wt)}),gn.f=nt,Bt.f=Kt,rn.f=Rt,zt.f=Ct,Mt.f=bt.f=yt,Wt.f=xt,mn.f=function(wt){return On(un(wt),wt)},gt&&(Gn(er,"description",{configurable:!0,get:function(){return Nn(this).description}}),pt||tn(Un,"propertyIsEnumerable",nt,{unsafe:!0}))),et({global:!0,constructor:!0,wrap:!0,forced:!ct,sham:!ct},{Symbol:Qn}),xn(Ot(_n),function(wt){yn(wt)}),et({target:Dn,stat:!0,forced:!ct},{useSetter:function(){Ln=!0},useSimple:function(){Ln=!1}}),et({target:"Object",stat:!0,forced:!ct,sham:!gt},{create:function(wt,Lt){return Lt===void 0?Nt(wt):Rt(Nt(wt),Lt)},defineProperty:Kt,defineProperties:Rt,getOwnPropertyDescriptor:Ct}),et({target:"Object",stat:!0,forced:!ct},{getOwnPropertyNames:yt}),pn(),Tn(Qn,Dn),bn[Mn]=!0},1817:(at,ut,s)=>{var et=s(2109),ot=s(9781),lt=s(7854),St=s(1702),pt=s(2597),gt=s(614),ct=s(7976),ht=s(1340),it=s(3070).f,ft=s(9920),mt=lt.Symbol,Tt=mt&&mt.prototype;if(ot&&gt(mt)&&(!("description"in Tt)||mt().description!==void 0)){var It={},Pt=function(){var zt=arguments.length<1||arguments[0]===void 0?void 0:ht(arguments[0]),Bt=ct(Tt,this)?new mt(zt):zt===void 0?mt():mt(zt);return zt===""&&(It[Bt]=!0),Bt};ft(Pt,mt),Pt.prototype=Tt,Tt.constructor=Pt;var At=String(mt("test"))=="Symbol(test)",Nt=St(Tt.toString),Ot=St(Tt.valueOf),Mt=/^Symbol\((.*)\)[^)]+$/,bt=St("".replace),Wt=St("".slice);it(Tt,"description",{configurable:!0,get:function(){var zt=Ot(this),Bt=Nt(zt);if(pt(It,zt))return"";var rn=At?Wt(Bt,7,-1):bt(Bt,Mt,"$1");return rn===""?void 0:rn}}),et({global:!0,constructor:!0,forced:!0},{Symbol:Pt})}},763:(at,ut,s)=>{var et=s(2109),ot=s(5005),lt=s(2597),St=s(1340),pt=s(2309),gt=s(735),ct=pt("string-to-symbol-registry"),ht=pt("symbol-to-string-registry");et({target:"Symbol",stat:!0,forced:!gt},{for:function(it){var ft=St(it);if(lt(ct,ft))return ct[ft];var mt=ot("Symbol")(ft);return ct[ft]=mt,ht[mt]=ft,mt}})},2165:(at,ut,s)=>{s(7235)("iterator")},2526:(at,ut,s)=>{s(4032),s(763),s(6620),s(8862),s(9660)},6620:(at,ut,s)=>{var et=s(2109),ot=s(2597),lt=s(2190),St=s(6330),pt=s(2309),gt=s(735),ct=pt("symbol-to-string-registry");et({target:"Symbol",stat:!0,forced:!gt},{keyFor:function(ht){if(!lt(ht))throw TypeError(St(ht)+" is not a symbol");if(ot(ct,ht))return ct[ht]}})},3680:(at,ut,s)=>{var et=s(5005),ot=s(7235),lt=s(8003);ot("toStringTag"),lt(et("Symbol"),"Symbol")},2990:(at,ut,s)=>{var et=s(1702),ot=s(260),lt=et(s(1048)),St=ot.aTypedArray;(0,ot.exportTypedArrayMethod)("copyWithin",function(pt,gt){return lt(St(this),pt,gt,arguments.length>2?arguments[2]:void 0)})},8927:(at,ut,s)=>{var et=s(260),ot=s(2092).every,lt=et.aTypedArray;(0,et.exportTypedArrayMethod)("every",function(St){return ot(lt(this),St,arguments.length>1?arguments[1]:void 0)})},3105:(at,ut,s)=>{var et=s(260),ot=s(1285),lt=s(4599),St=s(648),pt=s(6916),gt=s(1702),ct=s(7293),ht=et.aTypedArray,it=et.exportTypedArrayMethod,ft=gt("".slice);it("fill",function(mt){var Tt=arguments.length;ht(this);var It=ft(St(this),0,3)==="Big"?lt(mt):+mt;return pt(ot,this,It,Tt>1?arguments[1]:void 0,Tt>2?arguments[2]:void 0)},ct(function(){var mt=0;return new Int8Array(2).fill({valueOf:function(){return mt++}}),mt!==1}))},5035:(at,ut,s)=>{var et=s(260),ot=s(2092).filter,lt=s(3074),St=et.aTypedArray;(0,et.exportTypedArrayMethod)("filter",function(pt){var gt=ot(St(this),pt,arguments.length>1?arguments[1]:void 0);return lt(this,gt)})},7174:(at,ut,s)=>{var et=s(260),ot=s(2092).findIndex,lt=et.aTypedArray;(0,et.exportTypedArrayMethod)("findIndex",function(St){return ot(lt(this),St,arguments.length>1?arguments[1]:void 0)})},4345:(at,ut,s)=>{var et=s(260),ot=s(2092).find,lt=et.aTypedArray;(0,et.exportTypedArrayMethod)("find",function(St){return ot(lt(this),St,arguments.length>1?arguments[1]:void 0)})},2846:(at,ut,s)=>{var et=s(260),ot=s(2092).forEach,lt=et.aTypedArray;(0,et.exportTypedArrayMethod)("forEach",function(St){ot(lt(this),St,arguments.length>1?arguments[1]:void 0)})},4731:(at,ut,s)=>{var et=s(260),ot=s(1318).includes,lt=et.aTypedArray;(0,et.exportTypedArrayMethod)("includes",function(St){return ot(lt(this),St,arguments.length>1?arguments[1]:void 0)})},7209:(at,ut,s)=>{var et=s(260),ot=s(1318).indexOf,lt=et.aTypedArray;(0,et.exportTypedArrayMethod)("indexOf",function(St){return ot(lt(this),St,arguments.length>1?arguments[1]:void 0)})},6319:(at,ut,s)=>{var et=s(7854),ot=s(7293),lt=s(1702),St=s(260),pt=s(6992),gt=s(5112)("iterator"),ct=et.Uint8Array,ht=lt(pt.values),it=lt(pt.keys),ft=lt(pt.entries),mt=St.aTypedArray,Tt=St.exportTypedArrayMethod,It=ct&&ct.prototype,Pt=!ot(function(){It[gt].call([1])}),At=!!It&&It.values&&It[gt]===It.values&&It.values.name==="values",Nt=function(){return ht(mt(this))};Tt("entries",function(){return ft(mt(this))},Pt),Tt("keys",function(){return it(mt(this))},Pt),Tt("values",Nt,Pt||!At,{name:"values"}),Tt(gt,Nt,Pt||!At,{name:"values"})},8867:(at,ut,s)=>{var et=s(260),ot=s(1702),lt=et.aTypedArray,St=et.exportTypedArrayMethod,pt=ot([].join);St("join",function(gt){return pt(lt(this),gt)})},7789:(at,ut,s)=>{var et=s(260),ot=s(2104),lt=s(6583),St=et.aTypedArray;(0,et.exportTypedArrayMethod)("lastIndexOf",function(pt){var gt=arguments.length;return ot(lt,St(this),gt>1?[pt,arguments[1]]:[pt])})},3739:(at,ut,s)=>{var et=s(260),ot=s(2092).map,lt=s(6304),St=et.aTypedArray;(0,et.exportTypedArrayMethod)("map",function(pt){return ot(St(this),pt,arguments.length>1?arguments[1]:void 0,function(gt,ct){return new(lt(gt))(ct)})})},4483:(at,ut,s)=>{var et=s(260),ot=s(3671).right,lt=et.aTypedArray;(0,et.exportTypedArrayMethod)("reduceRight",function(St){var pt=arguments.length;return ot(lt(this),St,pt,pt>1?arguments[1]:void 0)})},9368:(at,ut,s)=>{var et=s(260),ot=s(3671).left,lt=et.aTypedArray;(0,et.exportTypedArrayMethod)("reduce",function(St){var pt=arguments.length;return ot(lt(this),St,pt,pt>1?arguments[1]:void 0)})},2056:(at,ut,s)=>{var et=s(260),ot=et.aTypedArray,lt=et.exportTypedArrayMethod,St=Math.floor;lt("reverse",function(){for(var pt,gt=this,ct=ot(gt).length,ht=St(ct/2),it=0;it<ht;)pt=gt[it],gt[it++]=gt[--ct],gt[ct]=pt;return gt})},3462:(at,ut,s)=>{var et=s(7854),ot=s(6916),lt=s(260),St=s(6244),pt=s(4590),gt=s(7908),ct=s(7293),ht=et.RangeError,it=et.Int8Array,ft=it&&it.prototype,mt=ft&&ft.set,Tt=lt.aTypedArray,It=lt.exportTypedArrayMethod,Pt=!ct(function(){var Nt=new Uint8ClampedArray(2);return ot(mt,Nt,{length:1,0:3},1),Nt[1]!==3}),At=Pt&&lt.NATIVE_ARRAY_BUFFER_VIEWS&&ct(function(){var Nt=new it(2);return Nt.set(1),Nt.set("2",1),Nt[0]!==0||Nt[1]!==2});It("set",function(Nt){Tt(this);var Ot=pt(arguments.length>1?arguments[1]:void 0,1),Mt=gt(Nt);if(Pt)return ot(mt,this,Mt,Ot);var bt=this.length,Wt=St(Mt),zt=0;if(Wt+Ot>bt)throw ht("Wrong length");for(;zt<Wt;)this[Ot+zt]=Mt[zt++]},!Pt||At)},678:(at,ut,s)=>{var et=s(260),ot=s(6304),lt=s(7293),St=s(206),pt=et.aTypedArray;(0,et.exportTypedArrayMethod)("slice",function(gt,ct){for(var ht=St(pt(this),gt,ct),it=ot(this),ft=0,mt=ht.length,Tt=new it(mt);mt>ft;)Tt[ft]=ht[ft++];return Tt},lt(function(){new Int8Array(1).slice()}))},7462:(at,ut,s)=>{var et=s(260),ot=s(2092).some,lt=et.aTypedArray;(0,et.exportTypedArrayMethod)("some",function(St){return ot(lt(this),St,arguments.length>1?arguments[1]:void 0)})},3824:(at,ut,s)=>{var et=s(7854),ot=s(1702),lt=s(7293),St=s(9662),pt=s(4362),gt=s(260),ct=s(8886),ht=s(256),it=s(7392),ft=s(8008),mt=gt.aTypedArray,Tt=gt.exportTypedArrayMethod,It=et.Uint16Array,Pt=It&&ot(It.prototype.sort),At=!(!Pt||lt(function(){Pt(new It(2),null)})&&lt(function(){Pt(new It(2),{})})),Nt=!!Pt&&!lt(function(){if(it)return it<74;if(ct)return ct<67;if(ht)return!0;if(ft)return ft<602;var Ot,Mt,bt=new It(516),Wt=Array(516);for(Ot=0;Ot<516;Ot++)Mt=Ot%4,bt[Ot]=515-Ot,Wt[Ot]=Ot-2*Mt+3;for(Pt(bt,function(zt,Bt){return(zt/4|0)-(Bt/4|0)}),Ot=0;Ot<516;Ot++)if(bt[Ot]!==Wt[Ot])return!0});Tt("sort",function(Ot){return Ot!==void 0&&St(Ot),Nt?Pt(this,Ot):pt(mt(this),function(Mt){return function(bt,Wt){return Mt!==void 0?+Mt(bt,Wt)||0:Wt!=Wt?-1:bt!=bt?1:bt===0&&Wt===0?1/bt>0&&1/Wt<0?1:-1:bt>Wt}}(Ot))},!Nt||At)},5021:(at,ut,s)=>{var et=s(260),ot=s(7466),lt=s(1400),St=s(6304),pt=et.aTypedArray;(0,et.exportTypedArrayMethod)("subarray",function(gt,ct){var ht=pt(this),it=ht.length,ft=lt(gt,it);return new(St(ht))(ht.buffer,ht.byteOffset+ft*ht.BYTES_PER_ELEMENT,ot((ct===void 0?it:lt(ct,it))-ft))})},2974:(at,ut,s)=>{var et=s(7854),ot=s(2104),lt=s(260),St=s(7293),pt=s(206),gt=et.Int8Array,ct=lt.aTypedArray,ht=lt.exportTypedArrayMethod,it=[].toLocaleString,ft=!!gt&&St(function(){it.call(new gt(1))});ht("toLocaleString",function(){return ot(it,ft?pt(ct(this)):ct(this),pt(arguments))},St(function(){return[1,2].toLocaleString()!=new gt([1,2]).toLocaleString()})||!St(function(){gt.prototype.toLocaleString.call([1,2])}))},5016:(at,ut,s)=>{var et=s(260).exportTypedArrayMethod,ot=s(7293),lt=s(7854),St=s(1702),pt=lt.Uint8Array,gt=pt&&pt.prototype||{},ct=[].toString,ht=St([].join);ot(function(){ct.call({})})&&(ct=function(){return ht(this)});var it=gt.toString!=ct;et("toString",ct,it)},2472:(at,ut,s)=>{s(9843)("Uint8",function(et){return function(ot,lt,St){return et(this,ot,lt,St)}})},9743:(at,ut,s)=>{s(9843)("Uint8",function(et){return function(ot,lt,St){return et(this,ot,lt,St)}},!0)},1202:(at,ut,s)=>{var et,ot=s(7854),lt=s(1702),St=s(9190),pt=s(2423),gt=s(7710),ct=s(9320),ht=s(111),it=s(2050),ft=s(9909).enforce,mt=s(8536),Tt=!ot.ActiveXObject&&"ActiveXObject"in ot,It=function(Wt){return function(){return Wt(this,arguments.length?arguments[0]:void 0)}},Pt=gt("WeakMap",It,ct);if(mt&&Tt){et=ct.getConstructor(It,"WeakMap",!0),pt.enable();var At=Pt.prototype,Nt=lt(At.delete),Ot=lt(At.has),Mt=lt(At.get),bt=lt(At.set);St(At,{delete:function(Wt){if(ht(Wt)&&!it(Wt)){var zt=ft(this);return zt.frozen||(zt.frozen=new et),Nt(this,Wt)||zt.frozen.delete(Wt)}return Nt(this,Wt)},has:function(Wt){if(ht(Wt)&&!it(Wt)){var zt=ft(this);return zt.frozen||(zt.frozen=new et),Ot(this,Wt)||zt.frozen.has(Wt)}return Ot(this,Wt)},get:function(Wt){if(ht(Wt)&&!it(Wt)){var zt=ft(this);return zt.frozen||(zt.frozen=new et),Ot(this,Wt)?Mt(this,Wt):zt.frozen.get(Wt)}return Mt(this,Wt)},set:function(Wt,zt){if(ht(Wt)&&!it(Wt)){var Bt=ft(this);Bt.frozen||(Bt.frozen=new et),Ot(this,Wt)?bt(this,Wt,zt):Bt.frozen.set(Wt,zt)}else bt(this,Wt,zt);return this}})}},4129:(at,ut,s)=>{s(1202)},4747:(at,ut,s)=>{var et=s(7854),ot=s(8324),lt=s(8509),St=s(8533),pt=s(8880),gt=function(ht){if(ht&&ht.forEach!==St)try{pt(ht,"forEach",St)}catch{ht.forEach=St}};for(var ct in ot)ot[ct]&&gt(et[ct]&&et[ct].prototype);gt(lt)},3948:(at,ut,s)=>{var et=s(7854),ot=s(8324),lt=s(8509),St=s(6992),pt=s(8880),gt=s(5112),ct=gt("iterator"),ht=gt("toStringTag"),it=St.values,ft=function(Tt,It){if(Tt){if(Tt[ct]!==it)try{pt(Tt,ct,it)}catch{Tt[ct]=it}if(Tt[ht]||pt(Tt,ht,It),ot[It]){for(var Pt in St)if(Tt[Pt]!==St[Pt])try{pt(Tt,Pt,St[Pt])}catch{Tt[Pt]=St[Pt]}}}};for(var mt in ot)ft(et[mt]&&et[mt].prototype,mt);ft(lt,"DOMTokenList")},6815:(at,ut,s)=>{var et=s(2109),ot=s(7854),lt=s(7152).setInterval;et({global:!0,bind:!0,forced:ot.setInterval!==lt},{setInterval:lt})},8417:(at,ut,s)=>{var et=s(2109),ot=s(7854),lt=s(7152).setTimeout;et({global:!0,bind:!0,forced:ot.setTimeout!==lt},{setTimeout:lt})},2564:(at,ut,s)=>{s(6815),s(8417)},5556:(at,ut,s)=>{s(6992);var et=s(2109),ot=s(7854),lt=s(6916),St=s(1702),pt=s(9781),gt=s(590),ct=s(8052),ht=s(9190),it=s(8003),ft=s(4994),mt=s(9909),Tt=s(5787),It=s(614),Pt=s(2597),At=s(9974),Nt=s(648),Ot=s(9670),Mt=s(111),bt=s(1340),Wt=s(30),zt=s(9114),Bt=s(8554),rn=s(1246),gn=s(8053),tn=s(5112),Ht=s(4362),fn=tn("iterator"),bn="URLSearchParams",In="URLSearchParamsIterator",un=mt.set,mn=mt.getterFor(bn),yn=mt.getterFor(In),pn=Object.getOwnPropertyDescriptor,Tn=function(qt){if(!pt)return ot[qt];var on=pn(ot,qt);return on&&on.value},kn=Tn("fetch"),xn=Tn("Request"),Mn=Tn("Headers"),Dn=xn&&xn.prototype,An=Mn&&Mn.prototype,Nn=ot.RegExp,Un=ot.TypeError,Qn=ot.decodeURIComponent,er=ot.encodeURIComponent,zn=St("".charAt),lr=St([].join),cn=St([].push),Gn=St("".replace),Yn=St([].shift),or=St([].splice),Bn=St("".split),rr=St("".slice),Zn=/\+/g,_n=Array(4),Ln=function(qt){return _n[qt-1]||(_n[qt-1]=Nn("((?:%[\\da-f]{2}){"+qt+"})","gi"))},vn=function(qt){try{return Qn(qt)}catch{return qt}},On=function(qt){var on=Gn(qt,Zn," "),hn=4;try{return Qn(on)}catch{for(;hn;)on=Gn(on,Ln(hn--),vn);return on}},Kt=/[!'()~]|%20/g,Rt={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},nt=function(qt){return Rt[qt]},Ct=function(qt){return Gn(er(qt),Kt,nt)},yt=ft(function(qt,on){un(this,{type:In,iterator:Bt(mn(qt).entries),kind:on})},"Iterator",function(){var qt=yn(this),on=qt.kind,hn=qt.iterator.next(),nn=hn.value;return hn.done||(hn.value=on==="keys"?nn.key:on==="values"?nn.value:[nn.key,nn.value]),hn},!0),xt=function(qt){this.entries=[],this.url=null,qt!==void 0&&(Mt(qt)?this.parseObject(qt):this.parseQuery(typeof qt=="string"?zn(qt,0)==="?"?rr(qt,1):qt:bt(qt)))};xt.prototype={type:bn,bindURL:function(qt){this.url=qt,this.update()},parseObject:function(qt){var on,hn,nn,dn,Sn,wn,En,Pn=rn(qt);if(Pn)for(hn=(on=Bt(qt,Pn)).next;!(nn=lt(hn,on)).done;){if(Sn=(dn=Bt(Ot(nn.value))).next,(wn=lt(Sn,dn)).done||(En=lt(Sn,dn)).done||!lt(Sn,dn).done)throw Un("Expected sequence with length 2");cn(this.entries,{key:bt(wn.value),value:bt(En.value)})}else for(var Wn in qt)Pt(qt,Wn)&&cn(this.entries,{key:Wn,value:bt(qt[Wn])})},parseQuery:function(qt){if(qt)for(var on,hn,nn=Bn(qt,"&"),dn=0;dn<nn.length;)(on=nn[dn++]).length&&(hn=Bn(on,"="),cn(this.entries,{key:On(Yn(hn)),value:On(lr(hn,"="))}))},serialize:function(){for(var qt,on=this.entries,hn=[],nn=0;nn<on.length;)qt=on[nn++],cn(hn,Ct(qt.key)+"="+Ct(qt.value));return lr(hn,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var wt=function(){Tt(this,Lt);var qt=arguments.length>0?arguments[0]:void 0;un(this,new xt(qt))},Lt=wt.prototype;if(ht(Lt,{append:function(qt,on){gn(arguments.length,2);var hn=mn(this);cn(hn.entries,{key:bt(qt),value:bt(on)}),hn.updateURL()},delete:function(qt){gn(arguments.length,1);for(var on=mn(this),hn=on.entries,nn=bt(qt),dn=0;dn<hn.length;)hn[dn].key===nn?or(hn,dn,1):dn++;on.updateURL()},get:function(qt){gn(arguments.length,1);for(var on=mn(this).entries,hn=bt(qt),nn=0;nn<on.length;nn++)if(on[nn].key===hn)return on[nn].value;return null},getAll:function(qt){gn(arguments.length,1);for(var on=mn(this).entries,hn=bt(qt),nn=[],dn=0;dn<on.length;dn++)on[dn].key===hn&&cn(nn,on[dn].value);return nn},has:function(qt){gn(arguments.length,1);for(var on=mn(this).entries,hn=bt(qt),nn=0;nn<on.length;)if(on[nn++].key===hn)return!0;return!1},set:function(qt,on){gn(arguments.length,1);for(var hn,nn=mn(this),dn=nn.entries,Sn=!1,wn=bt(qt),En=bt(on),Pn=0;Pn<dn.length;Pn++)(hn=dn[Pn]).key===wn&&(Sn?or(dn,Pn--,1):(Sn=!0,hn.value=En));Sn||cn(dn,{key:wn,value:En}),nn.updateURL()},sort:function(){var qt=mn(this);Ht(qt.entries,function(on,hn){return on.key>hn.key?1:-1}),qt.updateURL()},forEach:function(qt){for(var on,hn=mn(this).entries,nn=At(qt,arguments.length>1?arguments[1]:void 0),dn=0;dn<hn.length;)nn((on=hn[dn++]).value,on.key,this)},keys:function(){return new yt(this,"keys")},values:function(){return new yt(this,"values")},entries:function(){return new yt(this,"entries")}},{enumerable:!0}),ct(Lt,fn,Lt.entries,{name:"entries"}),ct(Lt,"toString",function(){return mn(this).serialize()},{enumerable:!0}),it(wt,bn),et({global:!0,constructor:!0,forced:!gt},{URLSearchParams:wt}),!gt&&It(Mn)){var Et=St(An.has),$t=St(An.set),Jt=function(qt){if(Mt(qt)){var on,hn=qt.body;if(Nt(hn)===bn)return on=qt.headers?new Mn(qt.headers):new Mn,Et(on,"content-type")||$t(on,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Wt(qt,{body:zt(0,bt(hn)),headers:zt(0,on)})}return qt};if(It(kn)&&et({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(qt){return kn(qt,arguments.length>1?Jt(arguments[1]):{})}}),It(xn)){var en=function(qt){return Tt(this,Dn),new xn(qt,arguments.length>1?Jt(arguments[1]):{})};Dn.constructor=en,en.prototype=Dn,et({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:en})}}at.exports={URLSearchParams:wt,getState:mn}},1637:(at,ut,s)=>{s(5556)},8789:(at,ut,s)=>{s(8783);var et,ot=s(2109),lt=s(9781),St=s(590),pt=s(7854),gt=s(9974),ct=s(1702),ht=s(8052),it=s(7045),ft=s(5787),mt=s(2597),Tt=s(1574),It=s(8457),Pt=s(1589),At=s(8710).codeAt,Nt=s(3197),Ot=s(1340),Mt=s(8003),bt=s(8053),Wt=s(5556),zt=s(9909),Bt=zt.set,rn=zt.getterFor("URL"),gn=Wt.URLSearchParams,tn=Wt.getState,Ht=pt.URL,fn=pt.TypeError,bn=pt.parseInt,In=Math.floor,un=Math.pow,mn=ct("".charAt),yn=ct(/./.exec),pn=ct([].join),Tn=ct(1 .toString),kn=ct([].pop),xn=ct([].push),Mn=ct("".replace),Dn=ct([].shift),An=ct("".split),Nn=ct("".slice),Un=ct("".toLowerCase),Qn=ct([].unshift),er="Invalid scheme",zn="Invalid host",lr="Invalid port",cn=/[a-z]/i,Gn=/[\d+-.a-z]/i,Yn=/\d/,or=/^0x/i,Bn=/^[0-7]+$/,rr=/^\d+$/,Zn=/^[\da-f]+$/i,_n=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Ln=/[\0\t\n\r #/:<>?@[\\\]^|]/,vn=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,On=/[\t\n\r]/g,Kt=function(Vn){var ar,Hn,vr,qn;if(typeof Vn=="number"){for(ar=[],Hn=0;Hn<4;Hn++)Qn(ar,Vn%256),Vn=In(Vn/256);return pn(ar,".")}if(typeof Vn=="object"){for(ar="",vr=function(jr){for(var _r=null,Er=1,Fn=null,pr=0,Pr=0;Pr<8;Pr++)jr[Pr]!==0?(pr>Er&&(_r=Fn,Er=pr),Fn=null,pr=0):(Fn===null&&(Fn=Pr),++pr);return pr>Er&&(_r=Fn,Er=pr),_r}(Vn),Hn=0;Hn<8;Hn++)qn&&Vn[Hn]===0||(qn&&(qn=!1),vr===Hn?(ar+=Hn?":":"::",qn=!0):(ar+=Tn(Vn[Hn],16),Hn<7&&(ar+=":")));return"["+ar+"]"}return Vn},Rt={},nt=Tt({},Rt,{" ":1,'"':1,"<":1,">":1,"`":1}),Ct=Tt({},nt,{"#":1,"?":1,"{":1,"}":1}),yt=Tt({},Ct,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),xt=function(Vn,ar){var Hn=At(Vn,0);return Hn>32&&Hn<127&&!mt(ar,Vn)?Vn:encodeURIComponent(Vn)},wt={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Lt=function(Vn,ar){var Hn;return Vn.length==2&&yn(cn,mn(Vn,0))&&((Hn=mn(Vn,1))==":"||!ar&&Hn=="|")},Et=function(Vn){var ar;return Vn.length>1&&Lt(Nn(Vn,0,2))&&(Vn.length==2||(ar=mn(Vn,2))==="/"||ar==="\\"||ar==="?"||ar==="#")},$t=function(Vn){return Vn==="."||Un(Vn)==="%2e"},Jt={},en={},qt={},on={},hn={},nn={},dn={},Sn={},wn={},En={},Pn={},Wn={},ir={},fr={},gr={},yr={},Rr={},kr={},Qr={},Yr={},Sr={},Nr=function(Vn,ar,Hn){var vr,qn,jr,_r=Ot(Vn);if(ar){if(qn=this.parse(_r))throw fn(qn);this.searchParams=null}else{if(Hn!==void 0&&(vr=new Nr(Hn,!0)),qn=this.parse(_r,null,vr))throw fn(qn);(jr=tn(new gn)).bindURL(this),this.searchParams=jr}};Nr.prototype={type:"URL",parse:function(Vn,ar,Hn){var vr,qn,jr,_r,Er,Fn=this,pr=ar||Jt,Pr=0,Tr="",qr=!1,$r=!1,Co=!1;for(Vn=Ot(Vn),ar||(Fn.scheme="",Fn.username="",Fn.password="",Fn.host=null,Fn.port=null,Fn.path=[],Fn.query=null,Fn.fragment=null,Fn.cannotBeABaseURL=!1,Vn=Mn(Vn,vn,"")),Vn=Mn(Vn,On,""),vr=It(Vn);Pr<=vr.length;){switch(qn=vr[Pr],pr){case Jt:if(!qn||!yn(cn,qn)){if(ar)return er;pr=qt;continue}Tr+=Un(qn),pr=en;break;case en:if(qn&&(yn(Gn,qn)||qn=="+"||qn=="-"||qn=="."))Tr+=Un(qn);else{if(qn!=":"){if(ar)return er;Tr="",pr=qt,Pr=0;continue}if(ar&&(Fn.isSpecial()!=mt(wt,Tr)||Tr=="file"&&(Fn.includesCredentials()||Fn.port!==null)||Fn.scheme=="file"&&!Fn.host))return;if(Fn.scheme=Tr,ar)return void(Fn.isSpecial()&&wt[Fn.scheme]==Fn.port&&(Fn.port=null));Tr="",Fn.scheme=="file"?pr=fr:Fn.isSpecial()&&Hn&&Hn.scheme==Fn.scheme?pr=on:Fn.isSpecial()?pr=Sn:vr[Pr+1]=="/"?(pr=hn,Pr++):(Fn.cannotBeABaseURL=!0,xn(Fn.path,""),pr=Qr)}break;case qt:if(!Hn||Hn.cannotBeABaseURL&&qn!="#")return er;if(Hn.cannotBeABaseURL&&qn=="#"){Fn.scheme=Hn.scheme,Fn.path=Pt(Hn.path),Fn.query=Hn.query,Fn.fragment="",Fn.cannotBeABaseURL=!0,pr=Sr;break}pr=Hn.scheme=="file"?fr:nn;continue;case on:if(qn!="/"||vr[Pr+1]!="/"){pr=nn;continue}pr=wn,Pr++;break;case hn:if(qn=="/"){pr=En;break}pr=kr;continue;case nn:if(Fn.scheme=Hn.scheme,qn==et)Fn.username=Hn.username,Fn.password=Hn.password,Fn.host=Hn.host,Fn.port=Hn.port,Fn.path=Pt(Hn.path),Fn.query=Hn.query;else if(qn=="/"||qn=="\\"&&Fn.isSpecial())pr=dn;else if(qn=="?")Fn.username=Hn.username,Fn.password=Hn.password,Fn.host=Hn.host,Fn.port=Hn.port,Fn.path=Pt(Hn.path),Fn.query="",pr=Yr;else{if(qn!="#"){Fn.username=Hn.username,Fn.password=Hn.password,Fn.host=Hn.host,Fn.port=Hn.port,Fn.path=Pt(Hn.path),Fn.path.length--,pr=kr;continue}Fn.username=Hn.username,Fn.password=Hn.password,Fn.host=Hn.host,Fn.port=Hn.port,Fn.path=Pt(Hn.path),Fn.query=Hn.query,Fn.fragment="",pr=Sr}break;case dn:if(!Fn.isSpecial()||qn!="/"&&qn!="\\"){if(qn!="/"){Fn.username=Hn.username,Fn.password=Hn.password,Fn.host=Hn.host,Fn.port=Hn.port,pr=kr;continue}pr=En}else pr=wn;break;case Sn:if(pr=wn,qn!="/"||mn(Tr,Pr+1)!="/")continue;Pr++;break;case wn:if(qn!="/"&&qn!="\\"){pr=En;continue}break;case En:if(qn=="@"){qr&&(Tr="%40"+Tr),qr=!0,jr=It(Tr);for(var eo=0;eo<jr.length;eo++){var ga=jr[eo];if(ga!=":"||Co){var ms=xt(ga,yt);Co?Fn.password+=ms:Fn.username+=ms}else Co=!0}Tr=""}else if(qn==et||qn=="/"||qn=="?"||qn=="#"||qn=="\\"&&Fn.isSpecial()){if(qr&&Tr=="")return"Invalid authority";Pr-=It(Tr).length+1,Tr="",pr=Pn}else Tr+=qn;break;case Pn:case Wn:if(ar&&Fn.scheme=="file"){pr=yr;continue}if(qn!=":"||$r){if(qn==et||qn=="/"||qn=="?"||qn=="#"||qn=="\\"&&Fn.isSpecial()){if(Fn.isSpecial()&&Tr=="")return zn;if(ar&&Tr==""&&(Fn.includesCredentials()||Fn.port!==null))return;if(_r=Fn.parseHost(Tr))return _r;if(Tr="",pr=Rr,ar)return;continue}qn=="["?$r=!0:qn=="]"&&($r=!1),Tr+=qn}else{if(Tr=="")return zn;if(_r=Fn.parseHost(Tr))return _r;if(Tr="",pr=ir,ar==Wn)return}break;case ir:if(!yn(Yn,qn)){if(qn==et||qn=="/"||qn=="?"||qn=="#"||qn=="\\"&&Fn.isSpecial()||ar){if(Tr!=""){var Qo=bn(Tr,10);if(Qo>65535)return lr;Fn.port=Fn.isSpecial()&&Qo===wt[Fn.scheme]?null:Qo,Tr=""}if(ar)return;pr=Rr;continue}return lr}Tr+=qn;break;case fr:if(Fn.scheme="file",qn=="/"||qn=="\\")pr=gr;else{if(!Hn||Hn.scheme!="file"){pr=kr;continue}if(qn==et)Fn.host=Hn.host,Fn.path=Pt(Hn.path),Fn.query=Hn.query;else if(qn=="?")Fn.host=Hn.host,Fn.path=Pt(Hn.path),Fn.query="",pr=Yr;else{if(qn!="#"){Et(pn(Pt(vr,Pr),""))||(Fn.host=Hn.host,Fn.path=Pt(Hn.path),Fn.shortenPath()),pr=kr;continue}Fn.host=Hn.host,Fn.path=Pt(Hn.path),Fn.query=Hn.query,Fn.fragment="",pr=Sr}}break;case gr:if(qn=="/"||qn=="\\"){pr=yr;break}Hn&&Hn.scheme=="file"&&!Et(pn(Pt(vr,Pr),""))&&(Lt(Hn.path[0],!0)?xn(Fn.path,Hn.path[0]):Fn.host=Hn.host),pr=kr;continue;case yr:if(qn==et||qn=="/"||qn=="\\"||qn=="?"||qn=="#"){if(!ar&&Lt(Tr))pr=kr;else if(Tr==""){if(Fn.host="",ar)return;pr=Rr}else{if(_r=Fn.parseHost(Tr))return _r;if(Fn.host=="localhost"&&(Fn.host=""),ar)return;Tr="",pr=Rr}continue}Tr+=qn;break;case Rr:if(Fn.isSpecial()){if(pr=kr,qn!="/"&&qn!="\\")continue}else if(ar||qn!="?")if(ar||qn!="#"){if(qn!=et&&(pr=kr,qn!="/"))continue}else Fn.fragment="",pr=Sr;else Fn.query="",pr=Yr;break;case kr:if(qn==et||qn=="/"||qn=="\\"&&Fn.isSpecial()||!ar&&(qn=="?"||qn=="#")){if((Er=Un(Er=Tr))===".."||Er==="%2e."||Er===".%2e"||Er==="%2e%2e"?(Fn.shortenPath(),qn=="/"||qn=="\\"&&Fn.isSpecial()||xn(Fn.path,"")):$t(Tr)?qn=="/"||qn=="\\"&&Fn.isSpecial()||xn(Fn.path,""):(Fn.scheme=="file"&&!Fn.path.length&&Lt(Tr)&&(Fn.host&&(Fn.host=""),Tr=mn(Tr,0)+":"),xn(Fn.path,Tr)),Tr="",Fn.scheme=="file"&&(qn==et||qn=="?"||qn=="#"))for(;Fn.path.length>1&&Fn.path[0]==="";)Dn(Fn.path);qn=="?"?(Fn.query="",pr=Yr):qn=="#"&&(Fn.fragment="",pr=Sr)}else Tr+=xt(qn,Ct);break;case Qr:qn=="?"?(Fn.query="",pr=Yr):qn=="#"?(Fn.fragment="",pr=Sr):qn!=et&&(Fn.path[0]+=xt(qn,Rt));break;case Yr:ar||qn!="#"?qn!=et&&(qn=="'"&&Fn.isSpecial()?Fn.query+="%27":Fn.query+=qn=="#"?"%23":xt(qn,Rt)):(Fn.fragment="",pr=Sr);break;case Sr:qn!=et&&(Fn.fragment+=xt(qn,nt))}Pr++}},parseHost:function(Vn){var ar,Hn,vr;if(mn(Vn,0)=="["){if(mn(Vn,Vn.length-1)!="]"||(ar=function(qn){var jr,_r,Er,Fn,pr,Pr,Tr,qr=[0,0,0,0,0,0,0,0],$r=0,Co=null,eo=0,ga=function(){return mn(qn,eo)};if(ga()==":"){if(mn(qn,1)!=":")return;eo+=2,Co=++$r}for(;ga();){if($r==8)return;if(ga()!=":"){for(jr=_r=0;_r<4&&yn(Zn,ga());)jr=16*jr+bn(ga(),16),eo++,_r++;if(ga()=="."){if(_r==0||(eo-=_r,$r>6))return;for(Er=0;ga();){if(Fn=null,Er>0){if(!(ga()=="."&&Er<4))return;eo++}if(!yn(Yn,ga()))return;for(;yn(Yn,ga());){if(pr=bn(ga(),10),Fn===null)Fn=pr;else{if(Fn==0)return;Fn=10*Fn+pr}if(Fn>255)return;eo++}qr[$r]=256*qr[$r]+Fn,++Er!=2&&Er!=4||$r++}if(Er!=4)return;break}if(ga()==":"){if(eo++,!ga())return}else if(ga())return;qr[$r++]=jr}else{if(Co!==null)return;eo++,Co=++$r}}if(Co!==null)for(Pr=$r-Co,$r=7;$r!=0&&Pr>0;)Tr=qr[$r],qr[$r--]=qr[Co+Pr-1],qr[Co+--Pr]=Tr;else if($r!=8)return;return qr}(Nn(Vn,1,-1)),!ar))return zn;this.host=ar}else if(this.isSpecial()){if(Vn=Nt(Vn),yn(_n,Vn)||(ar=function(qn){var jr,_r,Er,Fn,pr,Pr,Tr,qr=An(qn,".");if(qr.length&&qr[qr.length-1]==""&&qr.length--,(jr=qr.length)>4)return qn;for(_r=[],Er=0;Er<jr;Er++){if((Fn=qr[Er])=="")return qn;if(pr=10,Fn.length>1&&mn(Fn,0)=="0"&&(pr=yn(or,Fn)?16:8,Fn=Nn(Fn,pr==8?1:2)),Fn==="")Pr=0;else{if(!yn(pr==10?rr:pr==8?Bn:Zn,Fn))return qn;Pr=bn(Fn,pr)}xn(_r,Pr)}for(Er=0;Er<jr;Er++)if(Pr=_r[Er],Er==jr-1){if(Pr>=un(256,5-jr))return null}else if(Pr>255)return null;for(Tr=kn(_r),Er=0;Er<_r.length;Er++)Tr+=_r[Er]*un(256,3-Er);return Tr}(Vn),ar===null))return zn;this.host=ar}else{if(yn(Ln,Vn))return zn;for(ar="",Hn=It(Vn),vr=0;vr<Hn.length;vr++)ar+=xt(Hn[vr],Rt);this.host=ar}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return mt(wt,this.scheme)},shortenPath:function(){var Vn=this.path,ar=Vn.length;!ar||this.scheme=="file"&&ar==1&&Lt(Vn[0],!0)||Vn.length--},serialize:function(){var Vn=this,ar=Vn.scheme,Hn=Vn.username,vr=Vn.password,qn=Vn.host,jr=Vn.port,_r=Vn.path,Er=Vn.query,Fn=Vn.fragment,pr=ar+":";return qn!==null?(pr+="//",Vn.includesCredentials()&&(pr+=Hn+(vr?":"+vr:"")+"@"),pr+=Kt(qn),jr!==null&&(pr+=":"+jr)):ar=="file"&&(pr+="//"),pr+=Vn.cannotBeABaseURL?_r[0]:_r.length?"/"+pn(_r,"/"):"",Er!==null&&(pr+="?"+Er),Fn!==null&&(pr+="#"+Fn),pr},setHref:function(Vn){var ar=this.parse(Vn);if(ar)throw fn(ar);this.searchParams.update()},getOrigin:function(){var Vn=this.scheme,ar=this.port;if(Vn=="blob")try{return new wr(Vn.path[0]).origin}catch{return"null"}return Vn!="file"&&this.isSpecial()?Vn+"://"+Kt(this.host)+(ar!==null?":"+ar:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(Vn){this.parse(Ot(Vn)+":",Jt)},getUsername:function(){return this.username},setUsername:function(Vn){var ar=It(Ot(Vn));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var Hn=0;Hn<ar.length;Hn++)this.username+=xt(ar[Hn],yt)}},getPassword:function(){return this.password},setPassword:function(Vn){var ar=It(Ot(Vn));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var Hn=0;Hn<ar.length;Hn++)this.password+=xt(ar[Hn],yt)}},getHost:function(){var Vn=this.host,ar=this.port;return Vn===null?"":ar===null?Kt(Vn):Kt(Vn)+":"+ar},setHost:function(Vn){this.cannotBeABaseURL||this.parse(Vn,Pn)},getHostname:function(){var Vn=this.host;return Vn===null?"":Kt(Vn)},setHostname:function(Vn){this.cannotBeABaseURL||this.parse(Vn,Wn)},getPort:function(){var Vn=this.port;return Vn===null?"":Ot(Vn)},setPort:function(Vn){this.cannotHaveUsernamePasswordPort()||((Vn=Ot(Vn))==""?this.port=null:this.parse(Vn,ir))},getPathname:function(){var Vn=this.path;return this.cannotBeABaseURL?Vn[0]:Vn.length?"/"+pn(Vn,"/"):""},setPathname:function(Vn){this.cannotBeABaseURL||(this.path=[],this.parse(Vn,Rr))},getSearch:function(){var Vn=this.query;return Vn?"?"+Vn:""},setSearch:function(Vn){(Vn=Ot(Vn))==""?this.query=null:(mn(Vn,0)=="?"&&(Vn=Nn(Vn,1)),this.query="",this.parse(Vn,Yr)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var Vn=this.fragment;return Vn?"#"+Vn:""},setHash:function(Vn){(Vn=Ot(Vn))!=""?(mn(Vn,0)=="#"&&(Vn=Nn(Vn,1)),this.fragment="",this.parse(Vn,Sr)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var wr=function(Vn){var ar=ft(this,Ar),Hn=bt(arguments.length,1)>1?arguments[1]:void 0,vr=Bt(ar,new Nr(Vn,!1,Hn));lt||(ar.href=vr.serialize(),ar.origin=vr.getOrigin(),ar.protocol=vr.getProtocol(),ar.username=vr.getUsername(),ar.password=vr.getPassword(),ar.host=vr.getHost(),ar.hostname=vr.getHostname(),ar.port=vr.getPort(),ar.pathname=vr.getPathname(),ar.search=vr.getSearch(),ar.searchParams=vr.getSearchParams(),ar.hash=vr.getHash())},Ar=wr.prototype,Lr=function(Vn,ar){return{get:function(){return rn(this)[Vn]()},set:ar&&function(Hn){return rn(this)[ar](Hn)},configurable:!0,enumerable:!0}};if(lt&&(it(Ar,"href",Lr("serialize","setHref")),it(Ar,"origin",Lr("getOrigin")),it(Ar,"protocol",Lr("getProtocol","setProtocol")),it(Ar,"username",Lr("getUsername","setUsername")),it(Ar,"password",Lr("getPassword","setPassword")),it(Ar,"host",Lr("getHost","setHost")),it(Ar,"hostname",Lr("getHostname","setHostname")),it(Ar,"port",Lr("getPort","setPort")),it(Ar,"pathname",Lr("getPathname","setPathname")),it(Ar,"search",Lr("getSearch","setSearch")),it(Ar,"searchParams",Lr("getSearchParams")),it(Ar,"hash",Lr("getHash","setHash"))),ht(Ar,"toJSON",function(){return rn(this).serialize()},{enumerable:!0}),ht(Ar,"toString",function(){return rn(this).serialize()},{enumerable:!0}),Ht){var Hr=Ht.createObjectURL,na=Ht.revokeObjectURL;Hr&&ht(wr,"createObjectURL",gt(Hr,Ht)),na&&ht(wr,"revokeObjectURL",gt(na,Ht))}Mt(wr,"URL"),ot({global:!0,constructor:!0,forced:!St,sham:!lt},{URL:wr})},285:(at,ut,s)=>{s(8789)},3753:(at,ut,s)=>{var et=s(2109),ot=s(6916);et({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return ot(URL.prototype.toString,this)}})},7987:function(at,ut,s){var et,ot;et=function(lt){var St,pt,gt={template:"[%t] %l:",levelFormatter:function(it){return it.toUpperCase()},nameFormatter:function(it){return it||"root"},timestampFormatter:function(it){return it.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")},format:void 0},ct={},ht={reg:function(it){if(!it||!it.getLogger)throw new TypeError("Argument is not a root logger");St=it},apply:function(it,ft){if(!it||!it.setLevel)throw new TypeError("Argument is not a logger");var mt=it.methodFactory,Tt=it.name||"",It=ct[Tt]||ct[""]||gt;return ct[Tt]||(it.methodFactory=function(Pt,At,Nt){var Ot=mt(Pt,At,Nt),Mt=ct[Nt]||ct[""],bt=Mt.template.indexOf("%t")!==-1,Wt=Mt.template.indexOf("%l")!==-1,zt=Mt.template.indexOf("%n")!==-1;return function(){for(var Bt="",rn=arguments.length,gn=Array(rn),tn=0;tn<rn;tn++)gn[tn]=arguments[tn];if(Tt||!ct[Nt]){var Ht=Mt.timestampFormatter(new Date),fn=Mt.levelFormatter(Pt),bn=Mt.nameFormatter(Nt);Mt.format?Bt+=Mt.format(fn,bn,Ht):(Bt+=Mt.template,bt&&(Bt=Bt.replace(/%t/,Ht)),Wt&&(Bt=Bt.replace(/%l/,fn)),zt&&(Bt=Bt.replace(/%n/,bn))),gn.length&&typeof gn[0]=="string"?gn[0]=Bt+" "+gn[0]:gn.unshift(Bt)}Ot.apply(void 0,gn)}}),(ft=ft||{}).template&&(ft.format=void 0),ct[Tt]=function(Pt){for(var At,Nt=1,Ot=arguments.length;Nt<Ot;Nt++)for(At in arguments[Nt])Object.prototype.hasOwnProperty.call(arguments[Nt],At)&&(Pt[At]=arguments[Nt][At]);return Pt}({},It,ft),it.setLevel(it.getLevel()),St||it.warn("It is necessary to call the function reg() of loglevel-plugin-prefix before calling apply. From the next release, it will throw an error. See more: https://github.com/kutuluk/loglevel-plugin-prefix/blob/master/README.md"),it}};return lt&&(pt=lt.prefix,ht.noConflict=function(){return lt.prefix===ht&&(lt.prefix=pt),ht}),ht},(ot=et.call(ut,s,ut,at))===void 0||(at.exports=ot)},2043:function(at,ut,s){var et,ot;(function(lt,St){et=function(){var pt=function(){},gt="undefined",ct=typeof window!==gt&&typeof window.navigator!==gt&&/Trident\/|MSIE /.test(window.navigator.userAgent),ht=["trace","debug","info","warn","error"];function it(bt,Wt){var zt=bt[Wt];if(typeof zt.bind=="function")return zt.bind(bt);try{return Function.prototype.bind.call(zt,bt)}catch{return function(){return Function.prototype.apply.apply(zt,[bt,arguments])}}}function ft(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function mt(bt){return bt==="debug"&&(bt="log"),typeof console!==gt&&(bt==="trace"&&ct?ft:console[bt]!==void 0?it(console,bt):console.log!==void 0?it(console,"log"):pt)}function Tt(bt,Wt){for(var zt=0;zt<ht.length;zt++){var Bt=ht[zt];this[Bt]=zt<bt?pt:this.methodFactory(Bt,bt,Wt)}this.log=this.debug}function It(bt,Wt,zt){return function(){typeof console!==gt&&(Tt.call(this,Wt,zt),this[bt].apply(this,arguments))}}function Pt(bt,Wt,zt){return mt(bt)||It.apply(this,arguments)}function At(bt,Wt,zt){var Bt,rn=this;Wt=Wt??"WARN";var gn="loglevel";function tn(){var fn;if(typeof window!==gt&&gn){try{fn=window.localStorage[gn]}catch{}if(typeof fn===gt)try{var bn=window.document.cookie,In=bn.indexOf(encodeURIComponent(gn)+"=");In!==-1&&(fn=/^([^;]+)/.exec(bn.slice(In))[1])}catch{}return rn.levels[fn]===void 0&&(fn=void 0),fn}}typeof bt=="string"?gn+=":"+bt:typeof bt=="symbol"&&(gn=void 0),rn.name=bt,rn.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},rn.methodFactory=zt||Pt,rn.getLevel=function(){return Bt},rn.setLevel=function(fn,bn){if(typeof fn=="string"&&rn.levels[fn.toUpperCase()]!==void 0&&(fn=rn.levels[fn.toUpperCase()]),!(typeof fn=="number"&&fn>=0&&fn<=rn.levels.SILENT))throw"log.setLevel() called with invalid level: "+fn;if(Bt=fn,bn!==!1&&function(In){var un=(ht[In]||"silent").toUpperCase();if(typeof window!==gt&&gn){try{return void(window.localStorage[gn]=un)}catch{}try{window.document.cookie=encodeURIComponent(gn)+"="+un+";"}catch{}}}(fn),Tt.call(rn,fn,bt),typeof console===gt&&fn<rn.levels.SILENT)return"No console available for logging"},rn.setDefaultLevel=function(fn){Wt=fn,tn()||rn.setLevel(fn,!1)},rn.resetLevel=function(){rn.setLevel(Wt,!1),function(){if(typeof window!==gt&&gn){try{return void window.localStorage.removeItem(gn)}catch{}try{window.document.cookie=encodeURIComponent(gn)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}()},rn.enableAll=function(fn){rn.setLevel(rn.levels.TRACE,fn)},rn.disableAll=function(fn){rn.setLevel(rn.levels.SILENT,fn)};var Ht=tn();Ht==null&&(Ht=Wt),rn.setLevel(Ht,!1)}var Nt=new At,Ot={};Nt.getLogger=function(bt){if(typeof bt!="symbol"&&typeof bt!="string"||bt==="")throw new TypeError("You must supply a name when creating a logger.");var Wt=Ot[bt];return Wt||(Wt=Ot[bt]=new At(bt,Nt.getLevel(),Nt.methodFactory)),Wt};var Mt=typeof window!==gt?window.log:void 0;return Nt.noConflict=function(){return typeof window!==gt&&window.log===Nt&&(window.log=Mt),Nt},Nt.getLoggers=function(){return Ot},Nt.default=Nt,Nt},(ot=et.call(ut,s,ut,at))===void 0||(at.exports=ot)})()},7618:at=>{function ut(Bt,rn){if(!et)return!1;const gn=Bt.buffer;let tn=it.get(gn);if(tn==null){if((tn=s.validate(gn))&&rn)try{new s.Instance(new s.Module(gn)).exports[0]()}catch{tn=!1}it.set(gn,tn)}return tn}const s=globalThis.WebAssembly,et=typeof s=="object",ot=Bt=>Bt!==void 0,lt=(...Bt)=>Uint8Array.of(0,97,115,109,1,0,0,0,...Bt),St=(...Bt)=>Uint32Array.of(1836278016,1,...Bt),pt=(...Bt)=>St(1610679297,33751040,...Bt,40239360,259),gt=(...Bt)=>lt(1,4,1,96,0,0,3,2,1,0,...Bt,11,0,10,4,110,97,109,101,2,3,1,0,0),ct=(...Bt)=>Uint16Array.of(24832,28019,1,0,1025,24577,0,515,1,...Bt),ht=(...Bt)=>ct(...Bt,2842,4096,28164,28001,357,260,256,560,259,0),it=new WeakMap,ft=St(1610679553,58589440,117440770,805372165,101318656,1107297281,268438272,1835101700,17039717,36700416,259),mt=lt(5,3,1,4,1,0,8,4,110,97,109,101,2,1,0),Tt=ct(773,1,2561,269,11,65,65,65,3068,2816,2560,28164,28001,613,259,0),It=St(1610679297,33751040,134873089,100664833,185276736),Pt=lt(2,8,1,1,97,1,98,3,127,1,6,6,1,127,1,65,0,11,7,5,1,1,97,3,1,0,8,4,110,97,109,101,2,1,0),At=Uint16Array.of(24832,28019,1,0,1537,24577,512,32639,515,1,2058,1537,16640,16640,2816,2560,28164,28001,613,259,0),Nt=ht(3082,2561,17152,0,0,252),Ot=ht(2058,1537,16640,49152),Mt=pt(101318657,301990913,268438272,1835101700,17039717),bt=gt(5,4,1,3,1,1,10,7,1,5,0,254,3,0),Wt=pt(84344833,6357249,17369600,4259847,186257917,1845758464),zt=gt(10,7,1,5,0,208,112,26);at.exports={support:(Bt=1)=>et&&ut(Uint32Array.of(1836278016,Bt)),get supportStreaming(){return et&&ot(s.instantiateStreaming)},feature:{get bigInt(){return ut(ft,!0)},get bulk(){return ut(Tt)},get exceptions(){return ut(It)},get memory64(){return ut(mt)},get mutableGlobal(){return ut(Pt)},get multiValue(){return ut(At)},get saturateConversions(){return ut(Nt)},get signExtensions(){return ut(Ot)},get tailCall(){return ut(Mt)},get threads(){return ut(bt)},get simd(){return ut(Wt)},get references(){return ut(zt)},get typeReflection(){return et&&ot(s.Memory.type)},get funcReferences(){return et&&ot(s.Function)}}}}},rt={};function st(at){var ut=rt[at];if(ut!==void 0)return ut.exports;var s=rt[at]={id:at,loaded:!1,exports:{}};return tt[at].call(s.exports,s,s.exports,st),s.loaded=!0,s.exports}return st.amdO={},st.n=at=>{var ut=at&&at.__esModule?()=>at.default:()=>at;return st.d(ut,{a:ut}),ut},st.d=(at,ut)=>{for(var s in ut)st.o(ut,s)&&!st.o(at,s)&&Object.defineProperty(at,s,{enumerable:!0,get:ut[s]})},st.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),st.hmd=at=>((at=Object.create(at)).children||(at.children=[]),Object.defineProperty(at,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+at.id)}}),at),st.o=(at,ut)=>Object.prototype.hasOwnProperty.call(at,ut),st.r=at=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(at,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(at,"__esModule",{value:!0})},st(1256)})())})(apiRTC_min,apiRTC_min.exports);var apiRTC_minExports=apiRTC_min.exports;function _objectWithoutPropertiesLoose(a,o){if(a==null)return{};var _e={},tt=Object.keys(a),rt,st;for(st=0;st<tt.length;st++)rt=tt[st],!(o.indexOf(rt)>=0)&&(_e[rt]=a[rt]);return _e}function _extends(){return _extends=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var tt in _e)Object.prototype.hasOwnProperty.call(_e,tt)&&(a[tt]=_e[tt])}return a},_extends.apply(this,arguments)}function r$1(a){var o,_e,tt="";if(typeof a=="string"||typeof a=="number")tt+=a;else if(typeof a=="object")if(Array.isArray(a))for(o=0;o<a.length;o++)a[o]&&(_e=r$1(a[o]))&&(tt&&(tt+=" "),tt+=_e);else for(o in a)a[o]&&(tt&&(tt+=" "),tt+=o);return tt}function clsx(){for(var a,o,_e=0,tt="";_e<arguments.length;)(a=arguments[_e++])&&(o=r$1(a))&&(tt&&(tt+=" "),tt+=o);return tt}function isPlainObject(a){return a!==null&&typeof a=="object"&&a.constructor===Object}function deepClone(a){if(!isPlainObject(a))return a;const o={};return Object.keys(a).forEach(_e=>{o[_e]=deepClone(a[_e])}),o}function deepmerge(a,o,_e={clone:!0}){const tt=_e.clone?_extends({},a):a;return isPlainObject(a)&&isPlainObject(o)&&Object.keys(o).forEach(rt=>{rt!=="__proto__"&&(isPlainObject(o[rt])&&rt in a&&isPlainObject(a[rt])?tt[rt]=deepmerge(a[rt],o[rt],_e):_e.clone?tt[rt]=isPlainObject(o[rt])?deepClone(o[rt]):o[rt]:tt[rt]=o[rt])}),tt}function formatMuiErrorMessage(a){let o="https://mui.com/production-error/?code="+a;for(let _e=1;_e<arguments.length;_e+=1)o+="&args[]="+encodeURIComponent(arguments[_e]);return"Minified MUI error #"+a+"; visit "+o+" for the full message."}var reactIs_production_min$1={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b$2=Symbol.for("react.element"),c$2=Symbol.for("react.portal"),d$2=Symbol.for("react.fragment"),e$1=Symbol.for("react.strict_mode"),f$1=Symbol.for("react.profiler"),g$2=Symbol.for("react.provider"),h$1=Symbol.for("react.context"),k$1=Symbol.for("react.server_context"),l$1=Symbol.for("react.forward_ref"),m$2=Symbol.for("react.suspense"),n$1=Symbol.for("react.suspense_list"),p$1=Symbol.for("react.memo"),q$2=Symbol.for("react.lazy"),t$1=Symbol.for("react.offscreen"),u$1;u$1=Symbol.for("react.module.reference");function v$1(a){if(typeof a=="object"&&a!==null){var o=a.$$typeof;switch(o){case b$2:switch(a=a.type,a){case d$2:case f$1:case e$1:case m$2:case n$1:return a;default:switch(a=a&&a.$$typeof,a){case k$1:case h$1:case l$1:case q$2:case p$1:case g$2:return a;default:return o}}case c$2:return o}}}reactIs_production_min$1.ContextConsumer=h$1;reactIs_production_min$1.ContextProvider=g$2;reactIs_production_min$1.Element=b$2;reactIs_production_min$1.ForwardRef=l$1;reactIs_production_min$1.Fragment=d$2;reactIs_production_min$1.Lazy=q$2;reactIs_production_min$1.Memo=p$1;reactIs_production_min$1.Portal=c$2;reactIs_production_min$1.Profiler=f$1;reactIs_production_min$1.StrictMode=e$1;reactIs_production_min$1.Suspense=m$2;reactIs_production_min$1.SuspenseList=n$1;reactIs_production_min$1.isAsyncMode=function(){return!1};reactIs_production_min$1.isConcurrentMode=function(){return!1};reactIs_production_min$1.isContextConsumer=function(a){return v$1(a)===h$1};reactIs_production_min$1.isContextProvider=function(a){return v$1(a)===g$2};reactIs_production_min$1.isElement=function(a){return typeof a=="object"&&a!==null&&a.$$typeof===b$2};reactIs_production_min$1.isForwardRef=function(a){return v$1(a)===l$1};reactIs_production_min$1.isFragment=function(a){return v$1(a)===d$2};reactIs_production_min$1.isLazy=function(a){return v$1(a)===q$2};reactIs_production_min$1.isMemo=function(a){return v$1(a)===p$1};reactIs_production_min$1.isPortal=function(a){return v$1(a)===c$2};reactIs_production_min$1.isProfiler=function(a){return v$1(a)===f$1};reactIs_production_min$1.isStrictMode=function(a){return v$1(a)===e$1};reactIs_production_min$1.isSuspense=function(a){return v$1(a)===m$2};reactIs_production_min$1.isSuspenseList=function(a){return v$1(a)===n$1};reactIs_production_min$1.isValidElementType=function(a){return typeof a=="string"||typeof a=="function"||a===d$2||a===f$1||a===e$1||a===m$2||a===n$1||a===t$1||typeof a=="object"&&a!==null&&(a.$$typeof===q$2||a.$$typeof===p$1||a.$$typeof===g$2||a.$$typeof===h$1||a.$$typeof===l$1||a.$$typeof===u$1||a.getModuleId!==void 0)};reactIs_production_min$1.typeOf=v$1;function capitalize(a){if(typeof a!="string")throw new Error(formatMuiErrorMessage(7));return a.charAt(0).toUpperCase()+a.slice(1)}function createChainedFunction(...a){return a.reduce((o,_e)=>_e==null?o:function(...rt){o.apply(this,rt),_e.apply(this,rt)},()=>{})}function debounce$1(a,o=166){let _e;function tt(...rt){const st=()=>{a.apply(this,rt)};clearTimeout(_e),_e=setTimeout(st,o)}return tt.clear=()=>{clearTimeout(_e)},tt}function ownerDocument(a){return a&&a.ownerDocument||document}function ownerWindow(a){return ownerDocument(a).defaultView||window}function setRef(a,o){typeof a=="function"?a(o):a&&(a.current=o)}const useEnhancedEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,useEnhancedEffect$1=useEnhancedEffect;let globalId=0;function useGlobalId(a){const[o,_e]=reactExports.useState(a),tt=a||o;return reactExports.useEffect(()=>{o==null&&(globalId+=1,_e(`mui-${globalId}`))},[o]),tt}const maybeReactUseId=React$2["useId".toString()];function useId(a){if(maybeReactUseId!==void 0){const o=maybeReactUseId();return a??o}return useGlobalId(a)}function useControlled({controlled:a,default:o,name:_e,state:tt="value"}){const{current:rt}=reactExports.useRef(a!==void 0),[st,at]=reactExports.useState(o),ut=rt?a:st,s=reactExports.useCallback(et=>{rt||at(et)},[]);return[ut,s]}function useEventCallback(a){const o=reactExports.useRef(a);return useEnhancedEffect$1(()=>{o.current=a}),reactExports.useCallback((..._e)=>(0,o.current)(..._e),[])}function useForkRef(...a){return reactExports.useMemo(()=>a.every(o=>o==null)?null:o=>{a.forEach(_e=>{setRef(_e,o)})},a)}let hadKeyboardEvent=!0,hadFocusVisibleRecently=!1,hadFocusVisibleRecentlyTimeout;const inputTypesWhitelist={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function focusTriggersKeyboardModality(a){const{type:o,tagName:_e}=a;return!!(_e==="INPUT"&&inputTypesWhitelist[o]&&!a.readOnly||_e==="TEXTAREA"&&!a.readOnly||a.isContentEditable)}function handleKeyDown(a){a.metaKey||a.altKey||a.ctrlKey||(hadKeyboardEvent=!0)}function handlePointerDown(){hadKeyboardEvent=!1}function handleVisibilityChange(){this.visibilityState==="hidden"&&hadFocusVisibleRecently&&(hadKeyboardEvent=!0)}function prepare(a){a.addEventListener("keydown",handleKeyDown,!0),a.addEventListener("mousedown",handlePointerDown,!0),a.addEventListener("pointerdown",handlePointerDown,!0),a.addEventListener("touchstart",handlePointerDown,!0),a.addEventListener("visibilitychange",handleVisibilityChange,!0)}function isFocusVisible(a){const{target:o}=a;try{return o.matches(":focus-visible")}catch{}return hadKeyboardEvent||focusTriggersKeyboardModality(o)}function useIsFocusVisible(){const a=reactExports.useCallback(rt=>{rt!=null&&prepare(rt.ownerDocument)},[]),o=reactExports.useRef(!1);function _e(){return o.current?(hadFocusVisibleRecently=!0,window.clearTimeout(hadFocusVisibleRecentlyTimeout),hadFocusVisibleRecentlyTimeout=window.setTimeout(()=>{hadFocusVisibleRecently=!1},100),o.current=!1,!0):!1}function tt(rt){return isFocusVisible(rt)?(o.current=!0,!0):!1}return{isFocusVisibleRef:o,onFocus:tt,onBlur:_e,ref:a}}function getScrollbarSize(a){const o=a.documentElement.clientWidth;return Math.abs(window.innerWidth-o)}function resolveProps(a,o){const _e=_extends({},o);return Object.keys(a).forEach(tt=>{if(tt.toString().match(/^(components|slots)$/))_e[tt]=_extends({},a[tt],_e[tt]);else if(tt.toString().match(/^(componentsProps|slotProps)$/)){const rt=a[tt]||{},st=o[tt];_e[tt]={},!st||!Object.keys(st)?_e[tt]=rt:!rt||!Object.keys(rt)?_e[tt]=st:(_e[tt]=_extends({},st),Object.keys(rt).forEach(at=>{_e[tt][at]=resolveProps(rt[at],st[at])}))}else _e[tt]===void 0&&(_e[tt]=a[tt])}),_e}function composeClasses(a,o,_e=void 0){const tt={};return Object.keys(a).forEach(rt=>{tt[rt]=a[rt].reduce((st,at)=>{if(at){const ut=o(at);ut!==""&&st.push(ut),_e&&_e[at]&&st.push(_e[at])}return st},[]).join(" ")}),tt}const defaultGenerator=a=>a,createClassNameGenerator=()=>{let a=defaultGenerator;return{configure(o){a=o},generate(o){return a(o)},reset(){a=defaultGenerator}}},ClassNameGenerator=createClassNameGenerator(),ClassNameGenerator$1=ClassNameGenerator,globalStateClassesMapping={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function generateUtilityClass(a,o,_e="Mui"){const tt=globalStateClassesMapping[o];return tt?`${_e}-${tt}`:`${ClassNameGenerator$1.generate(a)}-${o}`}function generateUtilityClasses(a,o,_e="Mui"){const tt={};return o.forEach(rt=>{tt[rt]=generateUtilityClass(a,rt,_e)}),tt}function memoize$1(a){var o=Object.create(null);return function(_e){return o[_e]===void 0&&(o[_e]=a(_e)),o[_e]}}var reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=memoize$1(function(a){return reactPropsRegex.test(a)||a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&a.charCodeAt(2)<91});function sheetForTag(a){if(a.sheet)return a.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===a)return document.styleSheets[o]}function createStyleElement(a){var o=document.createElement("style");return o.setAttribute("data-emotion",a.key),a.nonce!==void 0&&o.setAttribute("nonce",a.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var StyleSheet=function(){function a(_e){var tt=this;this._insertTag=function(rt){var st;tt.tags.length===0?tt.insertionPoint?st=tt.insertionPoint.nextSibling:tt.prepend?st=tt.container.firstChild:st=tt.before:st=tt.tags[tt.tags.length-1].nextSibling,tt.container.insertBefore(rt,st),tt.tags.push(rt)},this.isSpeedy=_e.speedy===void 0?!0:_e.speedy,this.tags=[],this.ctr=0,this.nonce=_e.nonce,this.key=_e.key,this.container=_e.container,this.prepend=_e.prepend,this.insertionPoint=_e.insertionPoint,this.before=null}var o=a.prototype;return o.hydrate=function(tt){tt.forEach(this._insertTag)},o.insert=function(tt){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(createStyleElement(this));var rt=this.tags[this.tags.length-1];if(this.isSpeedy){var st=sheetForTag(rt);try{st.insertRule(tt,st.cssRules.length)}catch{}}else rt.appendChild(document.createTextNode(tt));this.ctr++},o.flush=function(){this.tags.forEach(function(tt){return tt.parentNode&&tt.parentNode.removeChild(tt)}),this.tags=[],this.ctr=0},a}(),MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",LAYER="@layer",abs=Math.abs,from=String.fromCharCode,assign=Object.assign;function hash$2(a,o){return charat(a,0)^45?(((o<<2^charat(a,0))<<2^charat(a,1))<<2^charat(a,2))<<2^charat(a,3):0}function trim(a){return a.trim()}function match(a,o){return(a=o.exec(a))?a[0]:a}function replace(a,o,_e){return a.replace(o,_e)}function indexof(a,o){return a.indexOf(o)}function charat(a,o){return a.charCodeAt(o)|0}function substr(a,o,_e){return a.slice(o,_e)}function strlen(a){return a.length}function sizeof(a){return a.length}function append(a,o){return o.push(a),a}function combine(a,o){return a.map(o).join("")}var line=1,column=1,length=0,position=0,character=0,characters="";function node(a,o,_e,tt,rt,st,at){return{value:a,root:o,parent:_e,type:tt,props:rt,children:st,line,column,length:at,return:""}}function copy(a,o){return assign(node("",null,null,"",null,null,0),a,{length:-a.length},o)}function char(){return character}function prev(){return character=position>0?charat(characters,--position):0,column--,character===10&&(column=1,line--),character}function next(){return character=position<length?charat(characters,position++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position)}function caret(){return position}function slice(a,o){return substr(characters,a,o)}function token(a){switch(a){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(a){return line=column=1,length=strlen(characters=a),position=0,[]}function dealloc(a){return characters="",a}function delimit(a){return trim(slice(position-1,delimiter(a===91?a+2:a===40?a+1:a)))}function whitespace(a){for(;(character=peek())&&character<33;)next();return token(a)>2||token(character)>3?"":" "}function escaping(a,o){for(;--o&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice(a,caret()+(o<6&&peek()==32&&next()==32))}function delimiter(a){for(;next();)switch(character){case a:return position;case 34:case 39:a!==34&&a!==39&&delimiter(character);break;case 40:a===41&&delimiter(a);break;case 92:next();break}return position}function commenter(a,o){for(;next()&&a+character!==47+10;)if(a+character===42+42&&peek()===47)break;return"/*"+slice(o,position-1)+"*"+from(a===47?a:next())}function identifier(a){for(;!token(peek());)next();return slice(a,position)}function compile(a){return dealloc(parse("",null,null,null,[""],a=alloc(a),0,[0],a))}function parse(a,o,_e,tt,rt,st,at,ut,s){for(var et=0,ot=0,lt=at,St=0,pt=0,gt=0,ct=1,ht=1,it=1,ft=0,mt="",Tt=rt,It=st,Pt=tt,At=mt;ht;)switch(gt=ft,ft=next()){case 40:if(gt!=108&&charat(At,lt-1)==58){indexof(At+=replace(delimit(ft),"&","&\f"),"&\f")!=-1&&(it=-1);break}case 34:case 39:case 91:At+=delimit(ft);break;case 9:case 10:case 13:case 32:At+=whitespace(gt);break;case 92:At+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),o,_e),s);break;default:At+="/"}break;case 123*ct:ut[et++]=strlen(At)*it;case 125*ct:case 59:case 0:switch(ft){case 0:case 125:ht=0;case 59+ot:it==-1&&(At=replace(At,/\f/g,"")),pt>0&&strlen(At)-lt&&append(pt>32?declaration(At+";",tt,_e,lt-1):declaration(replace(At," ","")+";",tt,_e,lt-2),s);break;case 59:At+=";";default:if(append(Pt=ruleset(At,o,_e,et,ot,rt,ut,mt,Tt=[],It=[],lt),st),ft===123)if(ot===0)parse(At,o,Pt,Pt,Tt,st,lt,ut,It);else switch(St===99&&charat(At,3)===110?100:St){case 100:case 108:case 109:case 115:parse(a,Pt,Pt,tt&&append(ruleset(a,Pt,Pt,0,0,rt,ut,mt,rt,Tt=[],lt),It),rt,It,lt,ut,tt?Tt:It);break;default:parse(At,Pt,Pt,Pt,[""],It,0,ut,It)}}et=ot=pt=0,ct=it=1,mt=At="",lt=at;break;case 58:lt=1+strlen(At),pt=gt;default:if(ct<1){if(ft==123)--ct;else if(ft==125&&ct++==0&&prev()==125)continue}switch(At+=from(ft),ft*ct){case 38:it=ot>0?1:(At+="\f",-1);break;case 44:ut[et++]=(strlen(At)-1)*it,it=1;break;case 64:peek()===45&&(At+=delimit(next())),St=peek(),ot=lt=strlen(mt=At+=identifier(caret())),ft++;break;case 45:gt===45&&strlen(At)==2&&(ct=0)}}return st}function ruleset(a,o,_e,tt,rt,st,at,ut,s,et,ot){for(var lt=rt-1,St=rt===0?st:[""],pt=sizeof(St),gt=0,ct=0,ht=0;gt<tt;++gt)for(var it=0,ft=substr(a,lt+1,lt=abs(ct=at[gt])),mt=a;it<pt;++it)(mt=trim(ct>0?St[it]+" "+ft:replace(ft,/&\f/g,St[it])))&&(s[ht++]=mt);return node(a,o,_e,rt===0?RULESET:ut,s,et,ot)}function comment(a,o,_e){return node(a,o,_e,COMMENT,from(char()),substr(a,2,-2),0)}function declaration(a,o,_e,tt){return node(a,o,_e,DECLARATION,substr(a,0,tt),substr(a,tt+1,-1),tt)}function serialize(a,o){for(var _e="",tt=sizeof(a),rt=0;rt<tt;rt++)_e+=o(a[rt],rt,a,o)||"";return _e}function stringify(a,o,_e,tt){switch(a.type){case LAYER:if(a.children.length)break;case IMPORT:case DECLARATION:return a.return=a.return||a.value;case COMMENT:return"";case KEYFRAMES:return a.return=a.value+"{"+serialize(a.children,tt)+"}";case RULESET:a.value=a.props.join(",")}return strlen(_e=serialize(a.children,tt))?a.return=a.value+"{"+_e+"}":""}function middleware(a){var o=sizeof(a);return function(_e,tt,rt,st){for(var at="",ut=0;ut<o;ut++)at+=a[ut](_e,tt,rt,st)||"";return at}}function rulesheet(a){return function(o){o.root||(o=o.return)&&a(o)}}var identifierWithPointTracking=function(o,_e,tt){for(var rt=0,st=0;rt=st,st=peek(),rt===38&&st===12&&(_e[tt]=1),!token(st);)next();return slice(o,position)},toRules=function(o,_e){var tt=-1,rt=44;do switch(token(rt)){case 0:rt===38&&peek()===12&&(_e[tt]=1),o[tt]+=identifierWithPointTracking(position-1,_e,tt);break;case 2:o[tt]+=delimit(rt);break;case 4:if(rt===44){o[++tt]=peek()===58?"&\f":"",_e[tt]=o[tt].length;break}default:o[tt]+=from(rt)}while(rt=next());return o},getRules=function(o,_e){return dealloc(toRules(alloc(o),_e))},fixedElements=new WeakMap,compat=function(o){if(!(o.type!=="rule"||!o.parent||o.length<1)){for(var _e=o.value,tt=o.parent,rt=o.column===tt.column&&o.line===tt.line;tt.type!=="rule";)if(tt=tt.parent,!tt)return;if(!(o.props.length===1&&_e.charCodeAt(0)!==58&&!fixedElements.get(tt))&&!rt){fixedElements.set(o,!0);for(var st=[],at=getRules(_e,st),ut=tt.props,s=0,et=0;s<at.length;s++)for(var ot=0;ot<ut.length;ot++,et++)o.props[et]=st[s]?at[s].replace(/&\f/g,ut[ot]):ut[ot]+" "+at[s]}}},removeLabel=function(o){if(o.type==="decl"){var _e=o.value;_e.charCodeAt(0)===108&&_e.charCodeAt(2)===98&&(o.return="",o.value="")}};function prefix(a,o){switch(hash$2(a,o)){case 5103:return WEBKIT+"print-"+a+a;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+a+a;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+a+MOZ+a+MS+a+a;case 6828:case 4268:return WEBKIT+a+MS+a+a;case 6165:return WEBKIT+a+MS+"flex-"+a+a;case 5187:return WEBKIT+a+replace(a,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+a;case 5443:return WEBKIT+a+MS+"flex-item-"+replace(a,/flex-|-self/,"")+a;case 4675:return WEBKIT+a+MS+"flex-line-pack"+replace(a,/align-content|flex-|-self/,"")+a;case 5548:return WEBKIT+a+MS+replace(a,"shrink","negative")+a;case 5292:return WEBKIT+a+MS+replace(a,"basis","preferred-size")+a;case 6060:return WEBKIT+"box-"+replace(a,"-grow","")+WEBKIT+a+MS+replace(a,"grow","positive")+a;case 4554:return WEBKIT+replace(a,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+a;case 6187:return replace(replace(replace(a,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),a,"")+a;case 5495:case 3959:return replace(a,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace(replace(a,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+a+a;case 4095:case 3583:case 4068:case 2532:return replace(a,/(.+)-inline(.+)/,WEBKIT+"$1$2")+a;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(a)-1-o>6)switch(charat(a,o+1)){case 109:if(charat(a,o+4)!==45)break;case 102:return replace(a,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(a,o+3)==108?"$3":"$2-$3"))+a;case 115:return~indexof(a,"stretch")?prefix(replace(a,"stretch","fill-available"),o)+a:a}break;case 4949:if(charat(a,o+1)!==115)break;case 6444:switch(charat(a,strlen(a)-3-(~indexof(a,"!important")&&10))){case 107:return replace(a,":",":"+WEBKIT)+a;case 101:return replace(a,/(.+:)([^;!]+)(;|!.+)?/,"$1"+WEBKIT+(charat(a,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+a}break;case 5936:switch(charat(a,o+11)){case 114:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"tb")+a;case 108:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"tb-rl")+a;case 45:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"lr")+a}return WEBKIT+a+MS+a+a}return a}var prefixer=function(o,_e,tt,rt){if(o.length>-1&&!o.return)switch(o.type){case DECLARATION:o.return=prefix(o.value,o.length);break;case KEYFRAMES:return serialize([copy(o,{value:replace(o.value,"@","@"+WEBKIT)})],rt);case RULESET:if(o.length)return combine(o.props,function(st){switch(match(st,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return serialize([copy(o,{props:[replace(st,/:(read-\w+)/,":"+MOZ+"$1")]})],rt);case"::placeholder":return serialize([copy(o,{props:[replace(st,/:(plac\w+)/,":"+WEBKIT+"input-$1")]}),copy(o,{props:[replace(st,/:(plac\w+)/,":"+MOZ+"$1")]}),copy(o,{props:[replace(st,/:(plac\w+)/,MS+"input-$1")]})],rt)}return""})}},defaultStylisPlugins=[prefixer],createCache=function(o){var _e=o.key;if(_e==="css"){var tt=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(tt,function(ct){var ht=ct.getAttribute("data-emotion");ht.indexOf(" ")!==-1&&(document.head.appendChild(ct),ct.setAttribute("data-s",""))})}var rt=o.stylisPlugins||defaultStylisPlugins,st={},at,ut=[];at=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+_e+' "]'),function(ct){for(var ht=ct.getAttribute("data-emotion").split(" "),it=1;it<ht.length;it++)st[ht[it]]=!0;ut.push(ct)});var s,et=[compat,removeLabel];{var ot,lt=[stringify,rulesheet(function(ct){ot.insert(ct)})],St=middleware(et.concat(rt,lt)),pt=function(ht){return serialize(compile(ht),St)};s=function(ht,it,ft,mt){ot=ft,pt(ht?ht+"{"+it.styles+"}":it.styles),mt&&(gt.inserted[it.name]=!0)}}var gt={key:_e,sheet:new StyleSheet({key:_e,container:at,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend,insertionPoint:o.insertionPoint}),nonce:o.nonce,inserted:st,registered:{},insert:s};return gt.sheet.hydrate(ut),gt},reactIs$1={exports:{}},reactIs_production_min={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b$1=typeof Symbol=="function"&&Symbol.for,c$1=b$1?Symbol.for("react.element"):60103,d$1=b$1?Symbol.for("react.portal"):60106,e=b$1?Symbol.for("react.fragment"):60107,f=b$1?Symbol.for("react.strict_mode"):60108,g$1=b$1?Symbol.for("react.profiler"):60114,h=b$1?Symbol.for("react.provider"):60109,k=b$1?Symbol.for("react.context"):60110,l=b$1?Symbol.for("react.async_mode"):60111,m$1=b$1?Symbol.for("react.concurrent_mode"):60111,n=b$1?Symbol.for("react.forward_ref"):60112,p=b$1?Symbol.for("react.suspense"):60113,q$1=b$1?Symbol.for("react.suspense_list"):60120,r=b$1?Symbol.for("react.memo"):60115,t=b$1?Symbol.for("react.lazy"):60116,v=b$1?Symbol.for("react.block"):60121,w$1=b$1?Symbol.for("react.fundamental"):60117,x$1=b$1?Symbol.for("react.responder"):60118,y$1=b$1?Symbol.for("react.scope"):60119;function z$1(a){if(typeof a=="object"&&a!==null){var o=a.$$typeof;switch(o){case c$1:switch(a=a.type,a){case l:case m$1:case e:case g$1:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k:case n:case t:case r:case h:return a;default:return o}}case d$1:return o}}}function A$2(a){return z$1(a)===m$1}reactIs_production_min.AsyncMode=l;reactIs_production_min.ConcurrentMode=m$1;reactIs_production_min.ContextConsumer=k;reactIs_production_min.ContextProvider=h;reactIs_production_min.Element=c$1;reactIs_production_min.ForwardRef=n;reactIs_production_min.Fragment=e;reactIs_production_min.Lazy=t;reactIs_production_min.Memo=r;reactIs_production_min.Portal=d$1;reactIs_production_min.Profiler=g$1;reactIs_production_min.StrictMode=f;reactIs_production_min.Suspense=p;reactIs_production_min.isAsyncMode=function(a){return A$2(a)||z$1(a)===l};reactIs_production_min.isConcurrentMode=A$2;reactIs_production_min.isContextConsumer=function(a){return z$1(a)===k};reactIs_production_min.isContextProvider=function(a){return z$1(a)===h};reactIs_production_min.isElement=function(a){return typeof a=="object"&&a!==null&&a.$$typeof===c$1};reactIs_production_min.isForwardRef=function(a){return z$1(a)===n};reactIs_production_min.isFragment=function(a){return z$1(a)===e};reactIs_production_min.isLazy=function(a){return z$1(a)===t};reactIs_production_min.isMemo=function(a){return z$1(a)===r};reactIs_production_min.isPortal=function(a){return z$1(a)===d$1};reactIs_production_min.isProfiler=function(a){return z$1(a)===g$1};reactIs_production_min.isStrictMode=function(a){return z$1(a)===f};reactIs_production_min.isSuspense=function(a){return z$1(a)===p};reactIs_production_min.isValidElementType=function(a){return typeof a=="string"||typeof a=="function"||a===e||a===m$1||a===g$1||a===f||a===p||a===q$1||typeof a=="object"&&a!==null&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w$1||a.$$typeof===x$1||a.$$typeof===y$1||a.$$typeof===v)};reactIs_production_min.typeOf=z$1;reactIs$1.exports=reactIs_production_min;var reactIsExports=reactIs$1.exports,reactIs=reactIsExports,FORWARD_REF_STATICS={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MEMO_STATICS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TYPE_STATICS={};TYPE_STATICS[reactIs.ForwardRef]=FORWARD_REF_STATICS;TYPE_STATICS[reactIs.Memo]=MEMO_STATICS;var isBrowser=!0;function getRegisteredStyles(a,o,_e){var tt="";return _e.split(" ").forEach(function(rt){a[rt]!==void 0?o.push(a[rt]+";"):tt+=rt+" "}),tt}var registerStyles=function(o,_e,tt){var rt=o.key+"-"+_e.name;(tt===!1||isBrowser===!1)&&o.registered[rt]===void 0&&(o.registered[rt]=_e.styles)},insertStyles=function(o,_e,tt){registerStyles(o,_e,tt);var rt=o.key+"-"+_e.name;if(o.inserted[_e.name]===void 0){var st=_e;do o.insert(_e===st?"."+rt:"",st,o.sheet,!0),st=st.next;while(st!==void 0)}};function murmur2(a){for(var o=0,_e,tt=0,rt=a.length;rt>=4;++tt,rt-=4)_e=a.charCodeAt(tt)&255|(a.charCodeAt(++tt)&255)<<8|(a.charCodeAt(++tt)&255)<<16|(a.charCodeAt(++tt)&255)<<24,_e=(_e&65535)*1540483477+((_e>>>16)*59797<<16),_e^=_e>>>24,o=(_e&65535)*1540483477+((_e>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(rt){case 3:o^=(a.charCodeAt(tt+2)&255)<<16;case 2:o^=(a.charCodeAt(tt+1)&255)<<8;case 1:o^=a.charCodeAt(tt)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var unitlessKeys={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function(o){return o.charCodeAt(1)===45},isProcessableValue=function(o){return o!=null&&typeof o!="boolean"},processStyleName=memoize$1(function(a){return isCustomProperty(a)?a:a.replace(hyphenateRegex,"-$&").toLowerCase()}),processStyleValue=function(o,_e){switch(o){case"animation":case"animationName":if(typeof _e=="string")return _e.replace(animationRegex,function(tt,rt,st){return cursor={name:rt,styles:st,next:cursor},rt})}return unitlessKeys[o]!==1&&!isCustomProperty(o)&&typeof _e=="number"&&_e!==0?_e+"px":_e},noComponentSelectorMessage="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function handleInterpolation(a,o,_e){if(_e==null)return"";if(_e.__emotion_styles!==void 0)return _e;switch(typeof _e){case"boolean":return"";case"object":{if(_e.anim===1)return cursor={name:_e.name,styles:_e.styles,next:cursor},_e.name;if(_e.styles!==void 0){var tt=_e.next;if(tt!==void 0)for(;tt!==void 0;)cursor={name:tt.name,styles:tt.styles,next:cursor},tt=tt.next;var rt=_e.styles+";";return rt}return createStringFromObject(a,o,_e)}case"function":{if(a!==void 0){var st=cursor,at=_e(a);return cursor=st,handleInterpolation(a,o,at)}break}}if(o==null)return _e;var ut=o[_e];return ut!==void 0?ut:_e}function createStringFromObject(a,o,_e){var tt="";if(Array.isArray(_e))for(var rt=0;rt<_e.length;rt++)tt+=handleInterpolation(a,o,_e[rt])+";";else for(var st in _e){var at=_e[st];if(typeof at!="object")o!=null&&o[at]!==void 0?tt+=st+"{"+o[at]+"}":isProcessableValue(at)&&(tt+=processStyleName(st)+":"+processStyleValue(st,at)+";");else if(Array.isArray(at)&&typeof at[0]=="string"&&(o==null||o[at[0]]===void 0))for(var ut=0;ut<at.length;ut++)isProcessableValue(at[ut])&&(tt+=processStyleName(st)+":"+processStyleValue(st,at[ut])+";");else{var s=handleInterpolation(a,o,at);switch(st){case"animation":case"animationName":{tt+=processStyleName(st)+":"+s+";";break}default:tt+=st+"{"+s+"}"}}}return tt}var labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g,cursor,serializeStyles=function(o,_e,tt){if(o.length===1&&typeof o[0]=="object"&&o[0]!==null&&o[0].styles!==void 0)return o[0];var rt=!0,st="";cursor=void 0;var at=o[0];at==null||at.raw===void 0?(rt=!1,st+=handleInterpolation(tt,_e,at)):st+=at[0];for(var ut=1;ut<o.length;ut++)st+=handleInterpolation(tt,_e,o[ut]),rt&&(st+=at[ut]);labelPattern.lastIndex=0;for(var s="",et;(et=labelPattern.exec(st))!==null;)s+="-"+et[1];var ot=murmur2(st)+s;return{name:ot,styles:st,next:cursor}},syncFallback=function(o){return o()},useInsertionEffect=React$2["useInsertionEffect"]?React$2["useInsertionEffect"]:!1,useInsertionEffectAlwaysWithSyncFallback=useInsertionEffect||syncFallback,useInsertionEffectWithLayoutFallback=useInsertionEffect||reactExports.useLayoutEffect,EmotionCacheContext=reactExports.createContext(typeof HTMLElement<"u"?createCache({key:"css"}):null);EmotionCacheContext.Provider;var withEmotionCache=function(o){return reactExports.forwardRef(function(_e,tt){var rt=reactExports.useContext(EmotionCacheContext);return o(_e,rt,tt)})},ThemeContext$2=reactExports.createContext({}),Global=withEmotionCache(function(a,o){var _e=a.styles,tt=serializeStyles([_e],void 0,reactExports.useContext(ThemeContext$2)),rt=reactExports.useRef();return useInsertionEffectWithLayoutFallback(function(){var st=o.key+"-global",at=new o.sheet.constructor({key:st,nonce:o.sheet.nonce,container:o.sheet.container,speedy:o.sheet.isSpeedy}),ut=!1,s=document.querySelector('style[data-emotion="'+st+" "+tt.name+'"]');return o.sheet.tags.length&&(at.before=o.sheet.tags[0]),s!==null&&(ut=!0,s.setAttribute("data-emotion",st),at.hydrate([s])),rt.current=[at,ut],function(){at.flush()}},[o]),useInsertionEffectWithLayoutFallback(function(){var st=rt.current,at=st[0],ut=st[1];if(ut){st[1]=!1;return}if(tt.next!==void 0&&insertStyles(o,tt.next,!0),at.tags.length){var s=at.tags[at.tags.length-1].nextElementSibling;at.before=s,at.flush()}o.insert("",tt,at,!1)},[o,tt.name]),null});function css(){for(var a=arguments.length,o=new Array(a),_e=0;_e<a;_e++)o[_e]=arguments[_e];return serializeStyles(o)}var keyframes=function(){var o=css.apply(void 0,arguments),_e="animation-"+o.name;return{name:_e,styles:"@keyframes "+_e+"{"+o.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},testOmitPropsOnStringTag=isPropValid,testOmitPropsOnComponent=function(o){return o!=="theme"},getDefaultShouldForwardProp=function(o){return typeof o=="string"&&o.charCodeAt(0)>96?testOmitPropsOnStringTag:testOmitPropsOnComponent},composeShouldForwardProps=function(o,_e,tt){var rt;if(_e){var st=_e.shouldForwardProp;rt=o.__emotion_forwardProp&&st?function(at){return o.__emotion_forwardProp(at)&&st(at)}:st}return typeof rt!="function"&&tt&&(rt=o.__emotion_forwardProp),rt},Insertion=function(o){var _e=o.cache,tt=o.serialized,rt=o.isStringTag;return registerStyles(_e,tt,rt),useInsertionEffectAlwaysWithSyncFallback(function(){return insertStyles(_e,tt,rt)}),null},createStyled$1=function a(o,_e){var tt=o.__emotion_real===o,rt=tt&&o.__emotion_base||o,st,at;_e!==void 0&&(st=_e.label,at=_e.target);var ut=composeShouldForwardProps(o,_e,tt),s=ut||getDefaultShouldForwardProp(rt),et=!s("as");return function(){var ot=arguments,lt=tt&&o.__emotion_styles!==void 0?o.__emotion_styles.slice(0):[];if(st!==void 0&&lt.push("label:"+st+";"),ot[0]==null||ot[0].raw===void 0)lt.push.apply(lt,ot);else{lt.push(ot[0][0]);for(var St=ot.length,pt=1;pt<St;pt++)lt.push(ot[pt],ot[0][pt])}var gt=withEmotionCache(function(ct,ht,it){var ft=et&&ct.as||rt,mt="",Tt=[],It=ct;if(ct.theme==null){It={};for(var Pt in ct)It[Pt]=ct[Pt];It.theme=reactExports.useContext(ThemeContext$2)}typeof ct.className=="string"?mt=getRegisteredStyles(ht.registered,Tt,ct.className):ct.className!=null&&(mt=ct.className+" ");var At=serializeStyles(lt.concat(Tt),ht.registered,It);mt+=ht.key+"-"+At.name,at!==void 0&&(mt+=" "+at);var Nt=et&&ut===void 0?getDefaultShouldForwardProp(ft):s,Ot={};for(var Mt in ct)et&&Mt==="as"||Nt(Mt)&&(Ot[Mt]=ct[Mt]);return Ot.className=mt,Ot.ref=it,reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(Insertion,{cache:ht,serialized:At,isStringTag:typeof ft=="string"}),reactExports.createElement(ft,Ot))});return gt.displayName=st!==void 0?st:"Styled("+(typeof rt=="string"?rt:rt.displayName||rt.name||"Component")+")",gt.defaultProps=o.defaultProps,gt.__emotion_real=gt,gt.__emotion_base=rt,gt.__emotion_styles=lt,gt.__emotion_forwardProp=ut,Object.defineProperty(gt,"toString",{value:function(){return"."+at}}),gt.withComponent=function(ct,ht){return a(ct,_extends({},_e,ht,{shouldForwardProp:composeShouldForwardProps(gt,ht,!0)})).apply(void 0,lt)},gt}},tags=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],newStyled=createStyled$1.bind();tags.forEach(function(a){newStyled[a]=newStyled(a)});function isEmpty$4(a){return a==null||Object.keys(a).length===0}function GlobalStyles$2(a){const{styles:o,defaultTheme:_e={}}=a,tt=typeof o=="function"?rt=>o(isEmpty$4(rt)?_e:rt):o;return jsxRuntimeExports.jsx(Global,{styles:tt})}/**
 * @mui/styled-engine v5.14.14
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function styled$3(a,o){return newStyled(a,o)}const internal_processStyles=(a,o)=>{Array.isArray(a.__emotion_styles)&&(a.__emotion_styles=o(a.__emotion_styles))},_excluded$T=["values","unit","step"],sortBreakpointsValues=a=>{const o=Object.keys(a).map(_e=>({key:_e,val:a[_e]}))||[];return o.sort((_e,tt)=>_e.val-tt.val),o.reduce((_e,tt)=>_extends({},_e,{[tt.key]:tt.val}),{})};function createBreakpoints(a){const{values:o={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:_e="px",step:tt=5}=a,rt=_objectWithoutPropertiesLoose(a,_excluded$T),st=sortBreakpointsValues(o),at=Object.keys(st);function ut(St){return`@media (min-width:${typeof o[St]=="number"?o[St]:St}${_e})`}function s(St){return`@media (max-width:${(typeof o[St]=="number"?o[St]:St)-tt/100}${_e})`}function et(St,pt){const gt=at.indexOf(pt);return`@media (min-width:${typeof o[St]=="number"?o[St]:St}${_e}) and (max-width:${(gt!==-1&&typeof o[at[gt]]=="number"?o[at[gt]]:pt)-tt/100}${_e})`}function ot(St){return at.indexOf(St)+1<at.length?et(St,at[at.indexOf(St)+1]):ut(St)}function lt(St){const pt=at.indexOf(St);return pt===0?ut(at[1]):pt===at.length-1?s(at[pt]):et(St,at[at.indexOf(St)+1]).replace("@media","@media not all and")}return _extends({keys:at,values:st,up:ut,down:s,between:et,only:ot,not:lt,unit:_e},rt)}const shape={borderRadius:4},shape$1=shape;function merge(a,o){return o?deepmerge(a,o,{clone:!1}):a}const values$1={xs:0,sm:600,md:900,lg:1200,xl:1536},defaultBreakpoints={keys:["xs","sm","md","lg","xl"],up:a=>`@media (min-width:${values$1[a]}px)`};function handleBreakpoints(a,o,_e){const tt=a.theme||{};if(Array.isArray(o)){const st=tt.breakpoints||defaultBreakpoints;return o.reduce((at,ut,s)=>(at[st.up(st.keys[s])]=_e(o[s]),at),{})}if(typeof o=="object"){const st=tt.breakpoints||defaultBreakpoints;return Object.keys(o).reduce((at,ut)=>{if(Object.keys(st.values||values$1).indexOf(ut)!==-1){const s=st.up(ut);at[s]=_e(o[ut],ut)}else{const s=ut;at[s]=o[s]}return at},{})}return _e(o)}function createEmptyBreakpointObject(a={}){var o;return((o=a.keys)==null?void 0:o.reduce((tt,rt)=>{const st=a.up(rt);return tt[st]={},tt},{}))||{}}function removeUnusedBreakpoints(a,o){return a.reduce((_e,tt)=>{const rt=_e[tt];return(!rt||Object.keys(rt).length===0)&&delete _e[tt],_e},o)}function mergeBreakpointsInOrder(a,...o){const _e=createEmptyBreakpointObject(a),tt=[_e,...o].reduce((rt,st)=>deepmerge(rt,st),{});return removeUnusedBreakpoints(Object.keys(_e),tt)}function computeBreakpointsBase(a,o){if(typeof a!="object")return{};const _e={},tt=Object.keys(o);return Array.isArray(a)?tt.forEach((rt,st)=>{st<a.length&&(_e[rt]=!0)}):tt.forEach(rt=>{a[rt]!=null&&(_e[rt]=!0)}),_e}function resolveBreakpointValues({values:a,breakpoints:o,base:_e}){const tt=_e||computeBreakpointsBase(a,o),rt=Object.keys(tt);if(rt.length===0)return a;let st;return rt.reduce((at,ut,s)=>(Array.isArray(a)?(at[ut]=a[s]!=null?a[s]:a[st],st=s):typeof a=="object"?(at[ut]=a[ut]!=null?a[ut]:a[st],st=ut):at[ut]=a,at),{})}function getPath(a,o,_e=!0){if(!o||typeof o!="string")return null;if(a&&a.vars&&_e){const tt=`vars.${o}`.split(".").reduce((rt,st)=>rt&&rt[st]?rt[st]:null,a);if(tt!=null)return tt}return o.split(".").reduce((tt,rt)=>tt&&tt[rt]!=null?tt[rt]:null,a)}function getStyleValue$1(a,o,_e,tt=_e){let rt;return typeof a=="function"?rt=a(_e):Array.isArray(a)?rt=a[_e]||tt:rt=getPath(a,_e)||tt,o&&(rt=o(rt,tt,a)),rt}function style$2(a){const{prop:o,cssProperty:_e=a.prop,themeKey:tt,transform:rt}=a,st=at=>{if(at[o]==null)return null;const ut=at[o],s=at.theme,et=getPath(s,tt)||{};return handleBreakpoints(at,ut,lt=>{let St=getStyleValue$1(et,rt,lt);return lt===St&&typeof lt=="string"&&(St=getStyleValue$1(et,rt,`${o}${lt==="default"?"":capitalize(lt)}`,lt)),_e===!1?St:{[_e]:St}})};return st.propTypes={},st.filterProps=[o],st}function memoize(a){const o={};return _e=>(o[_e]===void 0&&(o[_e]=a(_e)),o[_e])}const properties={m:"margin",p:"padding"},directions={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},aliases={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},getCssProperties=memoize(a=>{if(a.length>2)if(aliases[a])a=aliases[a];else return[a];const[o,_e]=a.split(""),tt=properties[o],rt=directions[_e]||"";return Array.isArray(rt)?rt.map(st=>tt+st):[tt+rt]}),marginKeys=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],paddingKeys=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...marginKeys,...paddingKeys];function createUnaryUnit(a,o,_e,tt){var rt;const st=(rt=getPath(a,o,!1))!=null?rt:_e;return typeof st=="number"?at=>typeof at=="string"?at:st*at:Array.isArray(st)?at=>typeof at=="string"?at:st[at]:typeof st=="function"?st:()=>{}}function createUnarySpacing(a){return createUnaryUnit(a,"spacing",8)}function getValue(a,o){if(typeof o=="string"||o==null)return o;const _e=Math.abs(o),tt=a(_e);return o>=0?tt:typeof tt=="number"?-tt:`-${tt}`}function getStyleFromPropValue(a,o){return _e=>a.reduce((tt,rt)=>(tt[rt]=getValue(o,_e),tt),{})}function resolveCssProperty(a,o,_e,tt){if(o.indexOf(_e)===-1)return null;const rt=getCssProperties(_e),st=getStyleFromPropValue(rt,tt),at=a[_e];return handleBreakpoints(a,at,st)}function style$1(a,o){const _e=createUnarySpacing(a.theme);return Object.keys(a).map(tt=>resolveCssProperty(a,o,tt,_e)).reduce(merge,{})}function margin(a){return style$1(a,marginKeys)}margin.propTypes={};margin.filterProps=marginKeys;function padding(a){return style$1(a,paddingKeys)}padding.propTypes={};padding.filterProps=paddingKeys;function createSpacing(a=8){if(a.mui)return a;const o=createUnarySpacing({spacing:a}),_e=(...tt)=>(tt.length===0?[1]:tt).map(st=>{const at=o(st);return typeof at=="number"?`${at}px`:at}).join(" ");return _e.mui=!0,_e}function compose(...a){const o=a.reduce((tt,rt)=>(rt.filterProps.forEach(st=>{tt[st]=rt}),tt),{}),_e=tt=>Object.keys(tt).reduce((rt,st)=>o[st]?merge(rt,o[st](tt)):rt,{});return _e.propTypes={},_e.filterProps=a.reduce((tt,rt)=>tt.concat(rt.filterProps),[]),_e}function borderTransform(a){return typeof a!="number"?a:`${a}px solid`}const border=style$2({prop:"border",themeKey:"borders",transform:borderTransform}),borderTop=style$2({prop:"borderTop",themeKey:"borders",transform:borderTransform}),borderRight=style$2({prop:"borderRight",themeKey:"borders",transform:borderTransform}),borderBottom=style$2({prop:"borderBottom",themeKey:"borders",transform:borderTransform}),borderLeft=style$2({prop:"borderLeft",themeKey:"borders",transform:borderTransform}),borderColor=style$2({prop:"borderColor",themeKey:"palette"}),borderTopColor=style$2({prop:"borderTopColor",themeKey:"palette"}),borderRightColor=style$2({prop:"borderRightColor",themeKey:"palette"}),borderBottomColor=style$2({prop:"borderBottomColor",themeKey:"palette"}),borderLeftColor=style$2({prop:"borderLeftColor",themeKey:"palette"}),borderRadius=a=>{if(a.borderRadius!==void 0&&a.borderRadius!==null){const o=createUnaryUnit(a.theme,"shape.borderRadius",4),_e=tt=>({borderRadius:getValue(o,tt)});return handleBreakpoints(a,a.borderRadius,_e)}return null};borderRadius.propTypes={};borderRadius.filterProps=["borderRadius"];compose(border,borderTop,borderRight,borderBottom,borderLeft,borderColor,borderTopColor,borderRightColor,borderBottomColor,borderLeftColor,borderRadius);const gap=a=>{if(a.gap!==void 0&&a.gap!==null){const o=createUnaryUnit(a.theme,"spacing",8),_e=tt=>({gap:getValue(o,tt)});return handleBreakpoints(a,a.gap,_e)}return null};gap.propTypes={};gap.filterProps=["gap"];const columnGap=a=>{if(a.columnGap!==void 0&&a.columnGap!==null){const o=createUnaryUnit(a.theme,"spacing",8),_e=tt=>({columnGap:getValue(o,tt)});return handleBreakpoints(a,a.columnGap,_e)}return null};columnGap.propTypes={};columnGap.filterProps=["columnGap"];const rowGap=a=>{if(a.rowGap!==void 0&&a.rowGap!==null){const o=createUnaryUnit(a.theme,"spacing",8),_e=tt=>({rowGap:getValue(o,tt)});return handleBreakpoints(a,a.rowGap,_e)}return null};rowGap.propTypes={};rowGap.filterProps=["rowGap"];const gridColumn=style$2({prop:"gridColumn"}),gridRow=style$2({prop:"gridRow"}),gridAutoFlow=style$2({prop:"gridAutoFlow"}),gridAutoColumns=style$2({prop:"gridAutoColumns"}),gridAutoRows=style$2({prop:"gridAutoRows"}),gridTemplateColumns=style$2({prop:"gridTemplateColumns"}),gridTemplateRows=style$2({prop:"gridTemplateRows"}),gridTemplateAreas=style$2({prop:"gridTemplateAreas"}),gridArea=style$2({prop:"gridArea"});compose(gap,columnGap,rowGap,gridColumn,gridRow,gridAutoFlow,gridAutoColumns,gridAutoRows,gridTemplateColumns,gridTemplateRows,gridTemplateAreas,gridArea);function paletteTransform(a,o){return o==="grey"?o:a}const color=style$2({prop:"color",themeKey:"palette",transform:paletteTransform}),bgcolor=style$2({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:paletteTransform}),backgroundColor=style$2({prop:"backgroundColor",themeKey:"palette",transform:paletteTransform});compose(color,bgcolor,backgroundColor);function sizingTransform(a){return a<=1&&a!==0?`${a*100}%`:a}const width=style$2({prop:"width",transform:sizingTransform}),maxWidth=a=>{if(a.maxWidth!==void 0&&a.maxWidth!==null){const o=_e=>{var tt,rt;const st=((tt=a.theme)==null||(tt=tt.breakpoints)==null||(tt=tt.values)==null?void 0:tt[_e])||values$1[_e];return st?((rt=a.theme)==null||(rt=rt.breakpoints)==null?void 0:rt.unit)!=="px"?{maxWidth:`${st}${a.theme.breakpoints.unit}`}:{maxWidth:st}:{maxWidth:sizingTransform(_e)}};return handleBreakpoints(a,a.maxWidth,o)}return null};maxWidth.filterProps=["maxWidth"];const minWidth=style$2({prop:"minWidth",transform:sizingTransform}),height=style$2({prop:"height",transform:sizingTransform}),maxHeight=style$2({prop:"maxHeight",transform:sizingTransform}),minHeight=style$2({prop:"minHeight",transform:sizingTransform});style$2({prop:"size",cssProperty:"width",transform:sizingTransform});style$2({prop:"size",cssProperty:"height",transform:sizingTransform});const boxSizing=style$2({prop:"boxSizing"});compose(width,maxWidth,minWidth,height,maxHeight,minHeight,boxSizing);const defaultSxConfig={border:{themeKey:"borders",transform:borderTransform},borderTop:{themeKey:"borders",transform:borderTransform},borderRight:{themeKey:"borders",transform:borderTransform},borderBottom:{themeKey:"borders",transform:borderTransform},borderLeft:{themeKey:"borders",transform:borderTransform},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:borderRadius},color:{themeKey:"palette",transform:paletteTransform},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:paletteTransform},backgroundColor:{themeKey:"palette",transform:paletteTransform},p:{style:padding},pt:{style:padding},pr:{style:padding},pb:{style:padding},pl:{style:padding},px:{style:padding},py:{style:padding},padding:{style:padding},paddingTop:{style:padding},paddingRight:{style:padding},paddingBottom:{style:padding},paddingLeft:{style:padding},paddingX:{style:padding},paddingY:{style:padding},paddingInline:{style:padding},paddingInlineStart:{style:padding},paddingInlineEnd:{style:padding},paddingBlock:{style:padding},paddingBlockStart:{style:padding},paddingBlockEnd:{style:padding},m:{style:margin},mt:{style:margin},mr:{style:margin},mb:{style:margin},ml:{style:margin},mx:{style:margin},my:{style:margin},margin:{style:margin},marginTop:{style:margin},marginRight:{style:margin},marginBottom:{style:margin},marginLeft:{style:margin},marginX:{style:margin},marginY:{style:margin},marginInline:{style:margin},marginInlineStart:{style:margin},marginInlineEnd:{style:margin},marginBlock:{style:margin},marginBlockStart:{style:margin},marginBlockEnd:{style:margin},displayPrint:{cssProperty:!1,transform:a=>({"@media print":{display:a}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:gap},rowGap:{style:rowGap},columnGap:{style:columnGap},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:sizingTransform},maxWidth:{style:maxWidth},minWidth:{transform:sizingTransform},height:{transform:sizingTransform},maxHeight:{transform:sizingTransform},minHeight:{transform:sizingTransform},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},defaultSxConfig$1=defaultSxConfig;function objectsHaveSameKeys(...a){const o=a.reduce((tt,rt)=>tt.concat(Object.keys(rt)),[]),_e=new Set(o);return a.every(tt=>_e.size===Object.keys(tt).length)}function callIfFn(a,o){return typeof a=="function"?a(o):a}function unstable_createStyleFunctionSx(){function a(_e,tt,rt,st){const at={[_e]:tt,theme:rt},ut=st[_e];if(!ut)return{[_e]:tt};const{cssProperty:s=_e,themeKey:et,transform:ot,style:lt}=ut;if(tt==null)return null;if(et==="typography"&&tt==="inherit")return{[_e]:tt};const St=getPath(rt,et)||{};return lt?lt(at):handleBreakpoints(at,tt,gt=>{let ct=getStyleValue$1(St,ot,gt);return gt===ct&&typeof gt=="string"&&(ct=getStyleValue$1(St,ot,`${_e}${gt==="default"?"":capitalize(gt)}`,gt)),s===!1?ct:{[s]:ct}})}function o(_e){var tt;const{sx:rt,theme:st={}}=_e||{};if(!rt)return null;const at=(tt=st.unstable_sxConfig)!=null?tt:defaultSxConfig$1;function ut(s){let et=s;if(typeof s=="function")et=s(st);else if(typeof s!="object")return s;if(!et)return null;const ot=createEmptyBreakpointObject(st.breakpoints),lt=Object.keys(ot);let St=ot;return Object.keys(et).forEach(pt=>{const gt=callIfFn(et[pt],st);if(gt!=null)if(typeof gt=="object")if(at[pt])St=merge(St,a(pt,gt,st,at));else{const ct=handleBreakpoints({theme:st},gt,ht=>({[pt]:ht}));objectsHaveSameKeys(ct,gt)?St[pt]=o({sx:gt,theme:st}):St=merge(St,ct)}else St=merge(St,a(pt,gt,st,at))}),removeUnusedBreakpoints(lt,St)}return Array.isArray(rt)?rt.map(ut):ut(rt)}return o}const styleFunctionSx=unstable_createStyleFunctionSx();styleFunctionSx.filterProps=["sx"];const styleFunctionSx$1=styleFunctionSx,_excluded$S=["breakpoints","palette","spacing","shape"];function createTheme$1(a={},...o){const{breakpoints:_e={},palette:tt={},spacing:rt,shape:st={}}=a,at=_objectWithoutPropertiesLoose(a,_excluded$S),ut=createBreakpoints(_e),s=createSpacing(rt);let et=deepmerge({breakpoints:ut,direction:"ltr",components:{},palette:_extends({mode:"light"},tt),spacing:s,shape:_extends({},shape$1,st)},at);return et=o.reduce((ot,lt)=>deepmerge(ot,lt),et),et.unstable_sxConfig=_extends({},defaultSxConfig$1,at==null?void 0:at.unstable_sxConfig),et.unstable_sx=function(lt){return styleFunctionSx$1({sx:lt,theme:this})},et}function isObjectEmpty(a){return Object.keys(a).length===0}function useTheme$3(a=null){const o=reactExports.useContext(ThemeContext$2);return!o||isObjectEmpty(o)?a:o}const systemDefaultTheme$1=createTheme$1();function useTheme$2(a=systemDefaultTheme$1){return useTheme$3(a)}function GlobalStyles$1({styles:a,themeId:o,defaultTheme:_e={}}){const tt=useTheme$2(_e),rt=typeof a=="function"?a(o&&tt[o]||tt):a;return jsxRuntimeExports.jsx(GlobalStyles$2,{styles:rt})}const _excluded$R=["sx"],splitProps=a=>{var o,_e;const tt={systemProps:{},otherProps:{}},rt=(o=a==null||(_e=a.theme)==null?void 0:_e.unstable_sxConfig)!=null?o:defaultSxConfig$1;return Object.keys(a).forEach(st=>{rt[st]?tt.systemProps[st]=a[st]:tt.otherProps[st]=a[st]}),tt};function extendSxProp(a){const{sx:o}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$R),{systemProps:tt,otherProps:rt}=splitProps(_e);let st;return Array.isArray(o)?st=[tt,...o]:typeof o=="function"?st=(...at)=>{const ut=o(...at);return isPlainObject(ut)?_extends({},tt,ut):tt}:st=_extends({},tt,o),_extends({},rt,{sx:st})}const _excluded$Q=["className","component"];function createBox(a={}){const{themeId:o,defaultTheme:_e,defaultClassName:tt="MuiBox-root",generateClassName:rt}=a,st=styled$3("div",{shouldForwardProp:ut=>ut!=="theme"&&ut!=="sx"&&ut!=="as"})(styleFunctionSx$1);return reactExports.forwardRef(function(s,et){const ot=useTheme$2(_e),lt=extendSxProp(s),{className:St,component:pt="div"}=lt,gt=_objectWithoutPropertiesLoose(lt,_excluded$Q);return jsxRuntimeExports.jsx(st,_extends({as:pt,ref:et,className:clsx(St,rt?rt(tt):tt),theme:o&&ot[o]||ot},gt))})}const _excluded$P=["variant"];function isEmpty$3(a){return a.length===0}function propsToClassKey(a){const{variant:o}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$P);let tt=o||"";return Object.keys(_e).sort().forEach(rt=>{rt==="color"?tt+=isEmpty$3(tt)?a[rt]:capitalize(a[rt]):tt+=`${isEmpty$3(tt)?rt:capitalize(rt)}${capitalize(a[rt].toString())}`}),tt}const _excluded$O=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function isEmpty$2(a){return Object.keys(a).length===0}function isStringTag(a){return typeof a=="string"&&a.charCodeAt(0)>96}const getStyleOverrides=(a,o)=>o.components&&o.components[a]&&o.components[a].styleOverrides?o.components[a].styleOverrides:null,transformVariants=a=>{const o={};return a&&a.forEach(_e=>{const tt=propsToClassKey(_e.props);o[tt]=_e.style}),o},getVariantStyles=(a,o)=>{let _e=[];return o&&o.components&&o.components[a]&&o.components[a].variants&&(_e=o.components[a].variants),transformVariants(_e)},variantsResolver=(a,o,_e)=>{const{ownerState:tt={}}=a,rt=[];return _e&&_e.forEach(st=>{let at=!0;Object.keys(st.props).forEach(ut=>{tt[ut]!==st.props[ut]&&a[ut]!==st.props[ut]&&(at=!1)}),at&&rt.push(o[propsToClassKey(st.props)])}),rt},themeVariantsResolver=(a,o,_e,tt)=>{var rt;const st=_e==null||(rt=_e.components)==null||(rt=rt[tt])==null?void 0:rt.variants;return variantsResolver(a,o,st)};function shouldForwardProp(a){return a!=="ownerState"&&a!=="theme"&&a!=="sx"&&a!=="as"}const systemDefaultTheme=createTheme$1(),lowercaseFirstLetter=a=>a&&a.charAt(0).toLowerCase()+a.slice(1);function resolveTheme({defaultTheme:a,theme:o,themeId:_e}){return isEmpty$2(o)?a:o[_e]||o}function defaultOverridesResolver(a){return a?(o,_e)=>_e[a]:null}const muiStyledFunctionResolver=({styledArg:a,props:o,defaultTheme:_e,themeId:tt})=>{const rt=a(_extends({},o,{theme:resolveTheme(_extends({},o,{defaultTheme:_e,themeId:tt}))}));let st;if(rt&&rt.variants&&(st=rt.variants,delete rt.variants),st){const at=variantsResolver(o,transformVariants(st),st);return[rt,...at]}return rt};function createStyled(a={}){const{themeId:o,defaultTheme:_e=systemDefaultTheme,rootShouldForwardProp:tt=shouldForwardProp,slotShouldForwardProp:rt=shouldForwardProp}=a,st=at=>styleFunctionSx$1(_extends({},at,{theme:resolveTheme(_extends({},at,{defaultTheme:_e,themeId:o}))}));return st.__mui_systemSx=!0,(at,ut={})=>{internal_processStyles(at,Tt=>Tt.filter(It=>!(It!=null&&It.__mui_systemSx)));const{name:s,slot:et,skipVariantsResolver:ot,skipSx:lt,overridesResolver:St=defaultOverridesResolver(lowercaseFirstLetter(et))}=ut,pt=_objectWithoutPropertiesLoose(ut,_excluded$O),gt=ot!==void 0?ot:et&&et!=="Root"&&et!=="root"||!1,ct=lt||!1;let ht,it=shouldForwardProp;et==="Root"||et==="root"?it=tt:et?it=rt:isStringTag(at)&&(it=void 0);const ft=styled$3(at,_extends({shouldForwardProp:it,label:ht},pt)),mt=(Tt,...It)=>{const Pt=It?It.map(Mt=>{if(typeof Mt=="function"&&Mt.__emotion_real!==Mt)return bt=>muiStyledFunctionResolver({styledArg:Mt,props:bt,defaultTheme:_e,themeId:o});if(isPlainObject(Mt)){let bt=Mt,Wt;return Mt&&Mt.variants&&(Wt=Mt.variants,delete bt.variants,bt=zt=>{let Bt=Mt;return variantsResolver(zt,transformVariants(Wt),Wt).forEach(gn=>{Bt=deepmerge(Bt,gn)}),Bt}),bt}return Mt}):[];let At=Tt;if(isPlainObject(Tt)){let Mt;Tt&&Tt.variants&&(Mt=Tt.variants,delete At.variants,At=bt=>{let Wt=Tt;return variantsResolver(bt,transformVariants(Mt),Mt).forEach(Bt=>{Wt=deepmerge(Wt,Bt)}),Wt})}else typeof Tt=="function"&&Tt.__emotion_real!==Tt&&(At=Mt=>muiStyledFunctionResolver({styledArg:Tt,props:Mt,defaultTheme:_e,themeId:o}));s&&St&&Pt.push(Mt=>{const bt=resolveTheme(_extends({},Mt,{defaultTheme:_e,themeId:o})),Wt=getStyleOverrides(s,bt);if(Wt){const zt={};return Object.entries(Wt).forEach(([Bt,rn])=>{zt[Bt]=typeof rn=="function"?rn(_extends({},Mt,{theme:bt})):rn}),St(Mt,zt)}return null}),s&&!gt&&Pt.push(Mt=>{const bt=resolveTheme(_extends({},Mt,{defaultTheme:_e,themeId:o}));return themeVariantsResolver(Mt,getVariantStyles(s,bt),bt,s)}),ct||Pt.push(st);const Nt=Pt.length-It.length;if(Array.isArray(Tt)&&Nt>0){const Mt=new Array(Nt).fill("");At=[...Tt,...Mt],At.raw=[...Tt.raw,...Mt]}const Ot=ft(At,...Pt);return at.muiName&&(Ot.muiName=at.muiName),Ot};return ft.withConfig&&(mt.withConfig=ft.withConfig),mt}}const styled$2=createStyled(),systemStyled=styled$2;function getThemeProps(a){const{theme:o,name:_e,props:tt}=a;return!o||!o.components||!o.components[_e]||!o.components[_e].defaultProps?tt:resolveProps(o.components[_e].defaultProps,tt)}function useThemeProps$1({props:a,name:o,defaultTheme:_e,themeId:tt}){let rt=useTheme$2(_e);return tt&&(rt=rt[tt]||rt),getThemeProps({theme:rt,name:o,props:a})}function clamp(a,o=0,_e=1){return Math.min(Math.max(o,a),_e)}function hexToRgb(a){a=a.slice(1);const o=new RegExp(`.{1,${a.length>=6?2:1}}`,"g");let _e=a.match(o);return _e&&_e[0].length===1&&(_e=_e.map(tt=>tt+tt)),_e?`rgb${_e.length===4?"a":""}(${_e.map((tt,rt)=>rt<3?parseInt(tt,16):Math.round(parseInt(tt,16)/255*1e3)/1e3).join(", ")})`:""}function decomposeColor(a){if(a.type)return a;if(a.charAt(0)==="#")return decomposeColor(hexToRgb(a));const o=a.indexOf("("),_e=a.substring(0,o);if(["rgb","rgba","hsl","hsla","color"].indexOf(_e)===-1)throw new Error(formatMuiErrorMessage(9,a));let tt=a.substring(o+1,a.length-1),rt;if(_e==="color"){if(tt=tt.split(" "),rt=tt.shift(),tt.length===4&&tt[3].charAt(0)==="/"&&(tt[3]=tt[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(rt)===-1)throw new Error(formatMuiErrorMessage(10,rt))}else tt=tt.split(",");return tt=tt.map(st=>parseFloat(st)),{type:_e,values:tt,colorSpace:rt}}function recomposeColor(a){const{type:o,colorSpace:_e}=a;let{values:tt}=a;return o.indexOf("rgb")!==-1?tt=tt.map((rt,st)=>st<3?parseInt(rt,10):rt):o.indexOf("hsl")!==-1&&(tt[1]=`${tt[1]}%`,tt[2]=`${tt[2]}%`),o.indexOf("color")!==-1?tt=`${_e} ${tt.join(" ")}`:tt=`${tt.join(", ")}`,`${o}(${tt})`}function hslToRgb(a){a=decomposeColor(a);const{values:o}=a,_e=o[0],tt=o[1]/100,rt=o[2]/100,st=tt*Math.min(rt,1-rt),at=(et,ot=(et+_e/30)%12)=>rt-st*Math.max(Math.min(ot-3,9-ot,1),-1);let ut="rgb";const s=[Math.round(at(0)*255),Math.round(at(8)*255),Math.round(at(4)*255)];return a.type==="hsla"&&(ut+="a",s.push(o[3])),recomposeColor({type:ut,values:s})}function getLuminance(a){a=decomposeColor(a);let o=a.type==="hsl"||a.type==="hsla"?decomposeColor(hslToRgb(a)).values:a.values;return o=o.map(_e=>(a.type!=="color"&&(_e/=255),_e<=.03928?_e/12.92:((_e+.055)/1.055)**2.4)),Number((.2126*o[0]+.7152*o[1]+.0722*o[2]).toFixed(3))}function getContrastRatio(a,o){const _e=getLuminance(a),tt=getLuminance(o);return(Math.max(_e,tt)+.05)/(Math.min(_e,tt)+.05)}function alpha(a,o){return a=decomposeColor(a),o=clamp(o),(a.type==="rgb"||a.type==="hsl")&&(a.type+="a"),a.type==="color"?a.values[3]=`/${o}`:a.values[3]=o,recomposeColor(a)}function darken(a,o){if(a=decomposeColor(a),o=clamp(o),a.type.indexOf("hsl")!==-1)a.values[2]*=1-o;else if(a.type.indexOf("rgb")!==-1||a.type.indexOf("color")!==-1)for(let _e=0;_e<3;_e+=1)a.values[_e]*=1-o;return recomposeColor(a)}function lighten(a,o){if(a=decomposeColor(a),o=clamp(o),a.type.indexOf("hsl")!==-1)a.values[2]+=(100-a.values[2])*o;else if(a.type.indexOf("rgb")!==-1)for(let _e=0;_e<3;_e+=1)a.values[_e]+=(255-a.values[_e])*o;else if(a.type.indexOf("color")!==-1)for(let _e=0;_e<3;_e+=1)a.values[_e]+=(1-a.values[_e])*o;return recomposeColor(a)}const ThemeContext=reactExports.createContext(null),ThemeContext$1=ThemeContext;function useTheme$1(){return reactExports.useContext(ThemeContext$1)}const hasSymbol=typeof Symbol=="function"&&Symbol.for,nested=hasSymbol?Symbol.for("mui.nested"):"__THEME_NESTED__";function mergeOuterLocalTheme(a,o){return typeof o=="function"?o(a):_extends({},a,o)}function ThemeProvider$2(a){const{children:o,theme:_e}=a,tt=useTheme$1(),rt=reactExports.useMemo(()=>{const st=tt===null?_e:mergeOuterLocalTheme(tt,_e);return st!=null&&(st[nested]=tt!==null),st},[_e,tt]);return jsxRuntimeExports.jsx(ThemeContext$1.Provider,{value:rt,children:o})}const EMPTY_THEME={};function useThemeScoping(a,o,_e,tt=!1){return reactExports.useMemo(()=>{const rt=a&&o[a]||o;if(typeof _e=="function"){const st=_e(rt),at=a?_extends({},o,{[a]:st}):st;return tt?()=>at:at}return a?_extends({},o,{[a]:_e}):_extends({},o,_e)},[a,o,_e,tt])}function ThemeProvider$1(a){const{children:o,theme:_e,themeId:tt}=a,rt=useTheme$3(EMPTY_THEME),st=useTheme$1()||EMPTY_THEME,at=useThemeScoping(tt,rt,_e),ut=useThemeScoping(tt,st,_e,!0);return jsxRuntimeExports.jsx(ThemeProvider$2,{theme:ut,children:jsxRuntimeExports.jsx(ThemeContext$2.Provider,{value:at,children:o})})}const _excluded$N=["className","component","disableGutters","fixed","maxWidth","classes"],defaultTheme$4=createTheme$1(),defaultCreateStyledComponent$1=systemStyled("div",{name:"MuiContainer",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[`maxWidth${capitalize(String(_e.maxWidth))}`],_e.fixed&&o.fixed,_e.disableGutters&&o.disableGutters]}}),useThemePropsDefault$1=a=>useThemeProps$1({props:a,name:"MuiContainer",defaultTheme:defaultTheme$4}),useUtilityClasses$z=(a,o)=>{const _e=s=>generateUtilityClass(o,s),{classes:tt,fixed:rt,disableGutters:st,maxWidth:at}=a,ut={root:["root",at&&`maxWidth${capitalize(String(at))}`,rt&&"fixed",st&&"disableGutters"]};return composeClasses(ut,_e,tt)};function createContainer(a={}){const{createStyledComponent:o=defaultCreateStyledComponent$1,useThemeProps:_e=useThemePropsDefault$1,componentName:tt="MuiContainer"}=a,rt=o(({theme:at,ownerState:ut})=>_extends({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!ut.disableGutters&&{paddingLeft:at.spacing(2),paddingRight:at.spacing(2),[at.breakpoints.up("sm")]:{paddingLeft:at.spacing(3),paddingRight:at.spacing(3)}}),({theme:at,ownerState:ut})=>ut.fixed&&Object.keys(at.breakpoints.values).reduce((s,et)=>{const ot=et,lt=at.breakpoints.values[ot];return lt!==0&&(s[at.breakpoints.up(ot)]={maxWidth:`${lt}${at.breakpoints.unit}`}),s},{}),({theme:at,ownerState:ut})=>_extends({},ut.maxWidth==="xs"&&{[at.breakpoints.up("xs")]:{maxWidth:Math.max(at.breakpoints.values.xs,444)}},ut.maxWidth&&ut.maxWidth!=="xs"&&{[at.breakpoints.up(ut.maxWidth)]:{maxWidth:`${at.breakpoints.values[ut.maxWidth]}${at.breakpoints.unit}`}}));return reactExports.forwardRef(function(ut,s){const et=_e(ut),{className:ot,component:lt="div",disableGutters:St=!1,fixed:pt=!1,maxWidth:gt="lg"}=et,ct=_objectWithoutPropertiesLoose(et,_excluded$N),ht=_extends({},et,{component:lt,disableGutters:St,fixed:pt,maxWidth:gt}),it=useUtilityClasses$z(ht,tt);return jsxRuntimeExports.jsx(rt,_extends({as:lt,ownerState:ht,className:clsx(it.root,ot),ref:s},ct))})}const _excluded$M=["component","direction","spacing","divider","children","className","useFlexGap"],defaultTheme$3=createTheme$1(),defaultCreateStyledComponent=systemStyled("div",{name:"MuiStack",slot:"Root",overridesResolver:(a,o)=>o.root});function useThemePropsDefault(a){return useThemeProps$1({props:a,name:"MuiStack",defaultTheme:defaultTheme$3})}function joinChildren(a,o){const _e=reactExports.Children.toArray(a).filter(Boolean);return _e.reduce((tt,rt,st)=>(tt.push(rt),st<_e.length-1&&tt.push(reactExports.cloneElement(o,{key:`separator-${st}`})),tt),[])}const getSideFromDirection=a=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[a],style=({ownerState:a,theme:o})=>{let _e=_extends({display:"flex",flexDirection:"column"},handleBreakpoints({theme:o},resolveBreakpointValues({values:a.direction,breakpoints:o.breakpoints.values}),tt=>({flexDirection:tt})));if(a.spacing){const tt=createUnarySpacing(o),rt=Object.keys(o.breakpoints.values).reduce((s,et)=>((typeof a.spacing=="object"&&a.spacing[et]!=null||typeof a.direction=="object"&&a.direction[et]!=null)&&(s[et]=!0),s),{}),st=resolveBreakpointValues({values:a.direction,base:rt}),at=resolveBreakpointValues({values:a.spacing,base:rt});typeof st=="object"&&Object.keys(st).forEach((s,et,ot)=>{if(!st[s]){const St=et>0?st[ot[et-1]]:"column";st[s]=St}}),_e=deepmerge(_e,handleBreakpoints({theme:o},at,(s,et)=>a.useFlexGap?{gap:getValue(tt,s)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${getSideFromDirection(et?st[et]:a.direction)}`]:getValue(tt,s)}}))}return _e=mergeBreakpointsInOrder(o.breakpoints,_e),_e};function createStack(a={}){const{createStyledComponent:o=defaultCreateStyledComponent,useThemeProps:_e=useThemePropsDefault,componentName:tt="MuiStack"}=a,rt=()=>composeClasses({root:["root"]},s=>generateUtilityClass(tt,s),{}),st=o(style);return reactExports.forwardRef(function(s,et){const ot=_e(s),lt=extendSxProp(ot),{component:St="div",direction:pt="column",spacing:gt=0,divider:ct,children:ht,className:it,useFlexGap:ft=!1}=lt,mt=_objectWithoutPropertiesLoose(lt,_excluded$M),Tt={direction:pt,spacing:gt,useFlexGap:ft},It=rt();return jsxRuntimeExports.jsx(st,_extends({as:St,ownerState:Tt,ref:et,className:clsx(It.root,it)},mt,{children:ct?joinChildren(ht,ct):ht}))})}function createMixins(a,o){return _extends({toolbar:{minHeight:56,[a.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[a.up("sm")]:{minHeight:64}}},o)}const common={black:"#000",white:"#fff"},common$1=common,grey={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},grey$1=grey,purple={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},purple$1=purple,red={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},red$1=red,orange={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},orange$1=orange,blue={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},blue$1=blue,lightBlue={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},lightBlue$1=lightBlue,green={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},green$1=green,_excluded$L=["mode","contrastThreshold","tonalOffset"],light={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:common$1.white,default:common$1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},dark={text:{primary:common$1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:common$1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function addLightOrDark(a,o,_e,tt){const rt=tt.light||tt,st=tt.dark||tt*1.5;a[o]||(a.hasOwnProperty(_e)?a[o]=a[_e]:o==="light"?a.light=lighten(a.main,rt):o==="dark"&&(a.dark=darken(a.main,st)))}function getDefaultPrimary(a="light"){return a==="dark"?{main:blue$1[200],light:blue$1[50],dark:blue$1[400]}:{main:blue$1[700],light:blue$1[400],dark:blue$1[800]}}function getDefaultSecondary(a="light"){return a==="dark"?{main:purple$1[200],light:purple$1[50],dark:purple$1[400]}:{main:purple$1[500],light:purple$1[300],dark:purple$1[700]}}function getDefaultError(a="light"){return a==="dark"?{main:red$1[500],light:red$1[300],dark:red$1[700]}:{main:red$1[700],light:red$1[400],dark:red$1[800]}}function getDefaultInfo(a="light"){return a==="dark"?{main:lightBlue$1[400],light:lightBlue$1[300],dark:lightBlue$1[700]}:{main:lightBlue$1[700],light:lightBlue$1[500],dark:lightBlue$1[900]}}function getDefaultSuccess(a="light"){return a==="dark"?{main:green$1[400],light:green$1[300],dark:green$1[700]}:{main:green$1[800],light:green$1[500],dark:green$1[900]}}function getDefaultWarning(a="light"){return a==="dark"?{main:orange$1[400],light:orange$1[300],dark:orange$1[700]}:{main:"#ed6c02",light:orange$1[500],dark:orange$1[900]}}function createPalette(a){const{mode:o="light",contrastThreshold:_e=3,tonalOffset:tt=.2}=a,rt=_objectWithoutPropertiesLoose(a,_excluded$L),st=a.primary||getDefaultPrimary(o),at=a.secondary||getDefaultSecondary(o),ut=a.error||getDefaultError(o),s=a.info||getDefaultInfo(o),et=a.success||getDefaultSuccess(o),ot=a.warning||getDefaultWarning(o);function lt(ct){return getContrastRatio(ct,dark.text.primary)>=_e?dark.text.primary:light.text.primary}const St=({color:ct,name:ht,mainShade:it=500,lightShade:ft=300,darkShade:mt=700})=>{if(ct=_extends({},ct),!ct.main&&ct[it]&&(ct.main=ct[it]),!ct.hasOwnProperty("main"))throw new Error(formatMuiErrorMessage(11,ht?` (${ht})`:"",it));if(typeof ct.main!="string")throw new Error(formatMuiErrorMessage(12,ht?` (${ht})`:"",JSON.stringify(ct.main)));return addLightOrDark(ct,"light",ft,tt),addLightOrDark(ct,"dark",mt,tt),ct.contrastText||(ct.contrastText=lt(ct.main)),ct},pt={dark,light};return deepmerge(_extends({common:_extends({},common$1),mode:o,primary:St({color:st,name:"primary"}),secondary:St({color:at,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:St({color:ut,name:"error"}),warning:St({color:ot,name:"warning"}),info:St({color:s,name:"info"}),success:St({color:et,name:"success"}),grey:grey$1,contrastThreshold:_e,getContrastText:lt,augmentColor:St,tonalOffset:tt},pt[o]),rt)}const _excluded$K=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function round$2(a){return Math.round(a*1e5)/1e5}const caseAllCaps={textTransform:"uppercase"},defaultFontFamily='"Roboto", "Helvetica", "Arial", sans-serif';function createTypography(a,o){const _e=typeof o=="function"?o(a):o,{fontFamily:tt=defaultFontFamily,fontSize:rt=14,fontWeightLight:st=300,fontWeightRegular:at=400,fontWeightMedium:ut=500,fontWeightBold:s=700,htmlFontSize:et=16,allVariants:ot,pxToRem:lt}=_e,St=_objectWithoutPropertiesLoose(_e,_excluded$K),pt=rt/14,gt=lt||(it=>`${it/et*pt}rem`),ct=(it,ft,mt,Tt,It)=>_extends({fontFamily:tt,fontWeight:it,fontSize:gt(ft),lineHeight:mt},tt===defaultFontFamily?{letterSpacing:`${round$2(Tt/ft)}em`}:{},It,ot),ht={h1:ct(st,96,1.167,-1.5),h2:ct(st,60,1.2,-.5),h3:ct(at,48,1.167,0),h4:ct(at,34,1.235,.25),h5:ct(at,24,1.334,0),h6:ct(ut,20,1.6,.15),subtitle1:ct(at,16,1.75,.15),subtitle2:ct(ut,14,1.57,.1),body1:ct(at,16,1.5,.15),body2:ct(at,14,1.43,.15),button:ct(ut,14,1.75,.4,caseAllCaps),caption:ct(at,12,1.66,.4),overline:ct(at,12,2.66,1,caseAllCaps),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return deepmerge(_extends({htmlFontSize:et,pxToRem:gt,fontFamily:tt,fontSize:rt,fontWeightLight:st,fontWeightRegular:at,fontWeightMedium:ut,fontWeightBold:s},ht),St,{clone:!1})}const shadowKeyUmbraOpacity=.2,shadowKeyPenumbraOpacity=.14,shadowAmbientShadowOpacity=.12;function createShadow(...a){return[`${a[0]}px ${a[1]}px ${a[2]}px ${a[3]}px rgba(0,0,0,${shadowKeyUmbraOpacity})`,`${a[4]}px ${a[5]}px ${a[6]}px ${a[7]}px rgba(0,0,0,${shadowKeyPenumbraOpacity})`,`${a[8]}px ${a[9]}px ${a[10]}px ${a[11]}px rgba(0,0,0,${shadowAmbientShadowOpacity})`].join(",")}const shadows=["none",createShadow(0,2,1,-1,0,1,1,0,0,1,3,0),createShadow(0,3,1,-2,0,2,2,0,0,1,5,0),createShadow(0,3,3,-2,0,3,4,0,0,1,8,0),createShadow(0,2,4,-1,0,4,5,0,0,1,10,0),createShadow(0,3,5,-1,0,5,8,0,0,1,14,0),createShadow(0,3,5,-1,0,6,10,0,0,1,18,0),createShadow(0,4,5,-2,0,7,10,1,0,2,16,1),createShadow(0,5,5,-3,0,8,10,1,0,3,14,2),createShadow(0,5,6,-3,0,9,12,1,0,3,16,2),createShadow(0,6,6,-3,0,10,14,1,0,4,18,3),createShadow(0,6,7,-4,0,11,15,1,0,4,20,3),createShadow(0,7,8,-4,0,12,17,2,0,5,22,4),createShadow(0,7,8,-4,0,13,19,2,0,5,24,4),createShadow(0,7,9,-4,0,14,21,2,0,5,26,4),createShadow(0,8,9,-5,0,15,22,2,0,6,28,5),createShadow(0,8,10,-5,0,16,24,2,0,6,30,5),createShadow(0,8,11,-5,0,17,26,2,0,6,32,5),createShadow(0,9,11,-5,0,18,28,2,0,7,34,6),createShadow(0,9,12,-6,0,19,29,2,0,7,36,6),createShadow(0,10,13,-6,0,20,31,3,0,8,38,7),createShadow(0,10,13,-6,0,21,33,3,0,8,40,7),createShadow(0,10,14,-6,0,22,35,3,0,8,42,7),createShadow(0,11,14,-7,0,23,36,3,0,9,44,8),createShadow(0,11,15,-7,0,24,38,3,0,9,46,8)],shadows$1=shadows,_excluded$J=["duration","easing","delay"],easing={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},duration={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function formatMs(a){return`${Math.round(a)}ms`}function getAutoHeightDuration(a){if(!a)return 0;const o=a/36;return Math.round((4+15*o**.25+o/5)*10)}function createTransitions(a){const o=_extends({},easing,a.easing),_e=_extends({},duration,a.duration);return _extends({getAutoHeightDuration,create:(rt=["all"],st={})=>{const{duration:at=_e.standard,easing:ut=o.easeInOut,delay:s=0}=st;return _objectWithoutPropertiesLoose(st,_excluded$J),(Array.isArray(rt)?rt:[rt]).map(et=>`${et} ${typeof at=="string"?at:formatMs(at)} ${ut} ${typeof s=="string"?s:formatMs(s)}`).join(",")}},a,{easing:o,duration:_e})}const zIndex={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},zIndex$1=zIndex,_excluded$I=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function createTheme(a={},...o){const{mixins:_e={},palette:tt={},transitions:rt={},typography:st={}}=a,at=_objectWithoutPropertiesLoose(a,_excluded$I);if(a.vars)throw new Error(formatMuiErrorMessage(18));const ut=createPalette(tt),s=createTheme$1(a);let et=deepmerge(s,{mixins:createMixins(s.breakpoints,_e),palette:ut,shadows:shadows$1.slice(),typography:createTypography(ut,st),transitions:createTransitions(rt),zIndex:_extends({},zIndex$1)});return et=deepmerge(et,at),et=o.reduce((ot,lt)=>deepmerge(ot,lt),et),et.unstable_sxConfig=_extends({},defaultSxConfig$1,at==null?void 0:at.unstable_sxConfig),et.unstable_sx=function(lt){return styleFunctionSx$1({sx:lt,theme:this})},et}const defaultTheme$1=createTheme(),defaultTheme$2=defaultTheme$1,THEME_ID="$$material",rootShouldForwardProp=a=>shouldForwardProp(a)&&a!=="classes",slotShouldForwardProp=shouldForwardProp,styled=createStyled({themeId:THEME_ID,defaultTheme:defaultTheme$2,rootShouldForwardProp}),styled$1=styled;function useThemeProps({props:a,name:o}){return useThemeProps$1({props:a,name:o,defaultTheme:defaultTheme$2,themeId:THEME_ID})}function useTheme(){const a=useTheme$2(defaultTheme$2);return a[THEME_ID]||a}const GridContext=reactExports.createContext(),GridContext$1=GridContext;function getGridUtilityClass(a){return generateUtilityClass("MuiGrid",a)}const SPACINGS=[0,1,2,3,4,5,6,7,8,9,10],DIRECTIONS=["column-reverse","column","row-reverse","row"],WRAPS=["nowrap","wrap-reverse","wrap"],GRID_SIZES=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],gridClasses=generateUtilityClasses("MuiGrid",["root","container","item","zeroMinWidth",...SPACINGS.map(a=>`spacing-xs-${a}`),...DIRECTIONS.map(a=>`direction-xs-${a}`),...WRAPS.map(a=>`wrap-xs-${a}`),...GRID_SIZES.map(a=>`grid-xs-${a}`),...GRID_SIZES.map(a=>`grid-sm-${a}`),...GRID_SIZES.map(a=>`grid-md-${a}`),...GRID_SIZES.map(a=>`grid-lg-${a}`),...GRID_SIZES.map(a=>`grid-xl-${a}`)]),gridClasses$1=gridClasses,_excluded$H=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function getOffset(a){const o=parseFloat(a);return`${o}${String(a).replace(String(o),"")||"px"}`}function generateGrid({theme:a,ownerState:o}){let _e;return a.breakpoints.keys.reduce((tt,rt)=>{let st={};if(o[rt]&&(_e=o[rt]),!_e)return tt;if(_e===!0)st={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(_e==="auto")st={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const at=resolveBreakpointValues({values:o.columns,breakpoints:a.breakpoints.values}),ut=typeof at=="object"?at[rt]:at;if(ut==null)return tt;const s=`${Math.round(_e/ut*1e8)/1e6}%`;let et={};if(o.container&&o.item&&o.columnSpacing!==0){const ot=a.spacing(o.columnSpacing);if(ot!=="0px"){const lt=`calc(${s} + ${getOffset(ot)})`;et={flexBasis:lt,maxWidth:lt}}}st=_extends({flexBasis:s,flexGrow:0,maxWidth:s},et)}return a.breakpoints.values[rt]===0?Object.assign(tt,st):tt[a.breakpoints.up(rt)]=st,tt},{})}function generateDirection({theme:a,ownerState:o}){const _e=resolveBreakpointValues({values:o.direction,breakpoints:a.breakpoints.values});return handleBreakpoints({theme:a},_e,tt=>{const rt={flexDirection:tt};return tt.indexOf("column")===0&&(rt[`& > .${gridClasses$1.item}`]={maxWidth:"none"}),rt})}function extractZeroValueBreakpointKeys({breakpoints:a,values:o}){let _e="";Object.keys(o).forEach(rt=>{_e===""&&o[rt]!==0&&(_e=rt)});const tt=Object.keys(a).sort((rt,st)=>a[rt]-a[st]);return tt.slice(0,tt.indexOf(_e))}function generateRowGap({theme:a,ownerState:o}){const{container:_e,rowSpacing:tt}=o;let rt={};if(_e&&tt!==0){const st=resolveBreakpointValues({values:tt,breakpoints:a.breakpoints.values});let at;typeof st=="object"&&(at=extractZeroValueBreakpointKeys({breakpoints:a.breakpoints.values,values:st})),rt=handleBreakpoints({theme:a},st,(ut,s)=>{var et;const ot=a.spacing(ut);return ot!=="0px"?{marginTop:`-${getOffset(ot)}`,[`& > .${gridClasses$1.item}`]:{paddingTop:getOffset(ot)}}:(et=at)!=null&&et.includes(s)?{}:{marginTop:0,[`& > .${gridClasses$1.item}`]:{paddingTop:0}}})}return rt}function generateColumnGap({theme:a,ownerState:o}){const{container:_e,columnSpacing:tt}=o;let rt={};if(_e&&tt!==0){const st=resolveBreakpointValues({values:tt,breakpoints:a.breakpoints.values});let at;typeof st=="object"&&(at=extractZeroValueBreakpointKeys({breakpoints:a.breakpoints.values,values:st})),rt=handleBreakpoints({theme:a},st,(ut,s)=>{var et;const ot=a.spacing(ut);return ot!=="0px"?{width:`calc(100% + ${getOffset(ot)})`,marginLeft:`-${getOffset(ot)}`,[`& > .${gridClasses$1.item}`]:{paddingLeft:getOffset(ot)}}:(et=at)!=null&&et.includes(s)?{}:{width:"100%",marginLeft:0,[`& > .${gridClasses$1.item}`]:{paddingLeft:0}}})}return rt}function resolveSpacingStyles(a,o,_e={}){if(!a||a<=0)return[];if(typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number")return[_e[`spacing-xs-${String(a)}`]];const tt=[];return o.forEach(rt=>{const st=a[rt];Number(st)>0&&tt.push(_e[`spacing-${rt}-${String(st)}`])}),tt}const GridRoot=styled$1("div",{name:"MuiGrid",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a,{container:tt,direction:rt,item:st,spacing:at,wrap:ut,zeroMinWidth:s,breakpoints:et}=_e;let ot=[];tt&&(ot=resolveSpacingStyles(at,et,o));const lt=[];return et.forEach(St=>{const pt=_e[St];pt&&lt.push(o[`grid-${St}-${String(pt)}`])}),[o.root,tt&&o.container,st&&o.item,s&&o.zeroMinWidth,...ot,rt!=="row"&&o[`direction-xs-${String(rt)}`],ut!=="wrap"&&o[`wrap-xs-${String(ut)}`],...lt]}})(({ownerState:a})=>_extends({boxSizing:"border-box"},a.container&&{display:"flex",flexWrap:"wrap",width:"100%"},a.item&&{margin:0},a.zeroMinWidth&&{minWidth:0},a.wrap!=="wrap"&&{flexWrap:a.wrap}),generateDirection,generateRowGap,generateColumnGap,generateGrid);function resolveSpacingClasses(a,o){if(!a||a<=0)return[];if(typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number")return[`spacing-xs-${String(a)}`];const _e=[];return o.forEach(tt=>{const rt=a[tt];if(Number(rt)>0){const st=`spacing-${tt}-${String(rt)}`;_e.push(st)}}),_e}const useUtilityClasses$y=a=>{const{classes:o,container:_e,direction:tt,item:rt,spacing:st,wrap:at,zeroMinWidth:ut,breakpoints:s}=a;let et=[];_e&&(et=resolveSpacingClasses(st,s));const ot=[];s.forEach(St=>{const pt=a[St];pt&&ot.push(`grid-${St}-${String(pt)}`)});const lt={root:["root",_e&&"container",rt&&"item",ut&&"zeroMinWidth",...et,tt!=="row"&&`direction-xs-${String(tt)}`,at!=="wrap"&&`wrap-xs-${String(at)}`,...ot]};return composeClasses(lt,getGridUtilityClass,o)},Grid=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiGrid"}),{breakpoints:rt}=useTheme(),st=extendSxProp(tt),{className:at,columns:ut,columnSpacing:s,component:et="div",container:ot=!1,direction:lt="row",item:St=!1,rowSpacing:pt,spacing:gt=0,wrap:ct="wrap",zeroMinWidth:ht=!1}=st,it=_objectWithoutPropertiesLoose(st,_excluded$H),ft=pt||gt,mt=s||gt,Tt=reactExports.useContext(GridContext$1),It=ot?ut||12:Tt,Pt={},At=_extends({},it);rt.keys.forEach(Mt=>{it[Mt]!=null&&(Pt[Mt]=it[Mt],delete At[Mt])});const Nt=_extends({},st,{columns:It,container:ot,direction:lt,item:St,rowSpacing:ft,columnSpacing:mt,wrap:ct,zeroMinWidth:ht,spacing:gt},Pt,{breakpoints:rt.keys}),Ot=useUtilityClasses$y(Nt);return jsxRuntimeExports.jsx(GridContext$1.Provider,{value:It,children:jsxRuntimeExports.jsx(GridRoot,_extends({ownerState:Nt,className:clsx(Ot.root,at),as:et,ref:_e},At))})}),u=Grid,ListContext=reactExports.createContext({}),ListContext$1=ListContext;function _setPrototypeOf(a,o){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(tt,rt){return tt.__proto__=rt,tt},_setPrototypeOf(a,o)}function _inheritsLoose(a,o){a.prototype=Object.create(o.prototype),a.prototype.constructor=a,_setPrototypeOf(a,o)}const config={disabled:!1},TransitionGroupContext=React$1.createContext(null);var forceReflow=function(o){return o.scrollTop},UNMOUNTED="unmounted",EXITED="exited",ENTERING="entering",ENTERED="entered",EXITING="exiting",Transition=function(a){_inheritsLoose(o,a);function o(tt,rt){var st;st=a.call(this,tt,rt)||this;var at=rt,ut=at&&!at.isMounting?tt.enter:tt.appear,s;return st.appearStatus=null,tt.in?ut?(s=EXITED,st.appearStatus=ENTERING):s=ENTERED:tt.unmountOnExit||tt.mountOnEnter?s=UNMOUNTED:s=EXITED,st.state={status:s},st.nextCallback=null,st}o.getDerivedStateFromProps=function(rt,st){var at=rt.in;return at&&st.status===UNMOUNTED?{status:EXITED}:null};var _e=o.prototype;return _e.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},_e.componentDidUpdate=function(rt){var st=null;if(rt!==this.props){var at=this.state.status;this.props.in?at!==ENTERING&&at!==ENTERED&&(st=ENTERING):(at===ENTERING||at===ENTERED)&&(st=EXITING)}this.updateStatus(!1,st)},_e.componentWillUnmount=function(){this.cancelNextCallback()},_e.getTimeouts=function(){var rt=this.props.timeout,st,at,ut;return st=at=ut=rt,rt!=null&&typeof rt!="number"&&(st=rt.exit,at=rt.enter,ut=rt.appear!==void 0?rt.appear:at),{exit:st,enter:at,appear:ut}},_e.updateStatus=function(rt,st){if(rt===void 0&&(rt=!1),st!==null)if(this.cancelNextCallback(),st===ENTERING){if(this.props.unmountOnExit||this.props.mountOnEnter){var at=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this);at&&forceReflow(at)}this.performEnter(rt)}else this.performExit();else this.props.unmountOnExit&&this.state.status===EXITED&&this.setState({status:UNMOUNTED})},_e.performEnter=function(rt){var st=this,at=this.props.enter,ut=this.context?this.context.isMounting:rt,s=this.props.nodeRef?[ut]:[ReactDOM.findDOMNode(this),ut],et=s[0],ot=s[1],lt=this.getTimeouts(),St=ut?lt.appear:lt.enter;if(!rt&&!at||config.disabled){this.safeSetState({status:ENTERED},function(){st.props.onEntered(et)});return}this.props.onEnter(et,ot),this.safeSetState({status:ENTERING},function(){st.props.onEntering(et,ot),st.onTransitionEnd(St,function(){st.safeSetState({status:ENTERED},function(){st.props.onEntered(et,ot)})})})},_e.performExit=function(){var rt=this,st=this.props.exit,at=this.getTimeouts(),ut=this.props.nodeRef?void 0:ReactDOM.findDOMNode(this);if(!st||config.disabled){this.safeSetState({status:EXITED},function(){rt.props.onExited(ut)});return}this.props.onExit(ut),this.safeSetState({status:EXITING},function(){rt.props.onExiting(ut),rt.onTransitionEnd(at.exit,function(){rt.safeSetState({status:EXITED},function(){rt.props.onExited(ut)})})})},_e.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},_e.safeSetState=function(rt,st){st=this.setNextCallback(st),this.setState(rt,st)},_e.setNextCallback=function(rt){var st=this,at=!0;return this.nextCallback=function(ut){at&&(at=!1,st.nextCallback=null,rt(ut))},this.nextCallback.cancel=function(){at=!1},this.nextCallback},_e.onTransitionEnd=function(rt,st){this.setNextCallback(st);var at=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this),ut=rt==null&&!this.props.addEndListener;if(!at||ut){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var s=this.props.nodeRef?[this.nextCallback]:[at,this.nextCallback],et=s[0],ot=s[1];this.props.addEndListener(et,ot)}rt!=null&&setTimeout(this.nextCallback,rt)},_e.render=function(){var rt=this.state.status;if(rt===UNMOUNTED)return null;var st=this.props,at=st.children;st.in,st.mountOnEnter,st.unmountOnExit,st.appear,st.enter,st.exit,st.timeout,st.addEndListener,st.onEnter,st.onEntering,st.onEntered,st.onExit,st.onExiting,st.onExited,st.nodeRef;var ut=_objectWithoutPropertiesLoose(st,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React$1.createElement(TransitionGroupContext.Provider,{value:null},typeof at=="function"?at(rt,ut):React$1.cloneElement(React$1.Children.only(at),ut))},o}(React$1.Component);Transition.contextType=TransitionGroupContext;Transition.propTypes={};function noop(){}Transition.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:noop,onEntering:noop,onEntered:noop,onExit:noop,onExiting:noop,onExited:noop};Transition.UNMOUNTED=UNMOUNTED;Transition.EXITED=EXITED;Transition.ENTERING=ENTERING;Transition.ENTERED=ENTERED;Transition.EXITING=EXITING;const Transition$1=Transition;function _assertThisInitialized(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function getChildMapping(a,o){var _e=function(st){return o&&reactExports.isValidElement(st)?o(st):st},tt=Object.create(null);return a&&reactExports.Children.map(a,function(rt){return rt}).forEach(function(rt){tt[rt.key]=_e(rt)}),tt}function mergeChildMappings(a,o){a=a||{},o=o||{};function _e(ot){return ot in o?o[ot]:a[ot]}var tt=Object.create(null),rt=[];for(var st in a)st in o?rt.length&&(tt[st]=rt,rt=[]):rt.push(st);var at,ut={};for(var s in o){if(tt[s])for(at=0;at<tt[s].length;at++){var et=tt[s][at];ut[tt[s][at]]=_e(et)}ut[s]=_e(s)}for(at=0;at<rt.length;at++)ut[rt[at]]=_e(rt[at]);return ut}function getProp(a,o,_e){return _e[o]!=null?_e[o]:a.props[o]}function getInitialChildMapping(a,o){return getChildMapping(a.children,function(_e){return reactExports.cloneElement(_e,{onExited:o.bind(null,_e),in:!0,appear:getProp(_e,"appear",a),enter:getProp(_e,"enter",a),exit:getProp(_e,"exit",a)})})}function getNextChildMapping(a,o,_e){var tt=getChildMapping(a.children),rt=mergeChildMappings(o,tt);return Object.keys(rt).forEach(function(st){var at=rt[st];if(reactExports.isValidElement(at)){var ut=st in o,s=st in tt,et=o[st],ot=reactExports.isValidElement(et)&&!et.props.in;s&&(!ut||ot)?rt[st]=reactExports.cloneElement(at,{onExited:_e.bind(null,at),in:!0,exit:getProp(at,"exit",a),enter:getProp(at,"enter",a)}):!s&&ut&&!ot?rt[st]=reactExports.cloneElement(at,{in:!1}):s&&ut&&reactExports.isValidElement(et)&&(rt[st]=reactExports.cloneElement(at,{onExited:_e.bind(null,at),in:et.props.in,exit:getProp(at,"exit",a),enter:getProp(at,"enter",a)}))}}),rt}var values=Object.values||function(a){return Object.keys(a).map(function(o){return a[o]})},defaultProps={component:"div",childFactory:function(o){return o}},TransitionGroup=function(a){_inheritsLoose(o,a);function o(tt,rt){var st;st=a.call(this,tt,rt)||this;var at=st.handleExited.bind(_assertThisInitialized(st));return st.state={contextValue:{isMounting:!0},handleExited:at,firstRender:!0},st}var _e=o.prototype;return _e.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},_e.componentWillUnmount=function(){this.mounted=!1},o.getDerivedStateFromProps=function(rt,st){var at=st.children,ut=st.handleExited,s=st.firstRender;return{children:s?getInitialChildMapping(rt,ut):getNextChildMapping(rt,at,ut),firstRender:!1}},_e.handleExited=function(rt,st){var at=getChildMapping(this.props.children);rt.key in at||(rt.props.onExited&&rt.props.onExited(st),this.mounted&&this.setState(function(ut){var s=_extends({},ut.children);return delete s[rt.key],{children:s}}))},_e.render=function(){var rt=this.props,st=rt.component,at=rt.childFactory,ut=_objectWithoutPropertiesLoose(rt,["component","childFactory"]),s=this.state.contextValue,et=values(this.state.children).map(at);return delete ut.appear,delete ut.enter,delete ut.exit,st===null?React$1.createElement(TransitionGroupContext.Provider,{value:s},et):React$1.createElement(TransitionGroupContext.Provider,{value:s},React$1.createElement(st,ut,et))},o}(React$1.Component);TransitionGroup.propTypes={};TransitionGroup.defaultProps=defaultProps;const TransitionGroup$1=TransitionGroup;function Ripple(a){const{className:o,classes:_e,pulsate:tt=!1,rippleX:rt,rippleY:st,rippleSize:at,in:ut,onExited:s,timeout:et}=a,[ot,lt]=reactExports.useState(!1),St=clsx(o,_e.ripple,_e.rippleVisible,tt&&_e.ripplePulsate),pt={width:at,height:at,top:-(at/2)+st,left:-(at/2)+rt},gt=clsx(_e.child,ot&&_e.childLeaving,tt&&_e.childPulsate);return!ut&&!ot&&lt(!0),reactExports.useEffect(()=>{if(!ut&&s!=null){const ct=setTimeout(s,et);return()=>{clearTimeout(ct)}}},[s,ut,et]),jsxRuntimeExports.jsx("span",{className:St,style:pt,children:jsxRuntimeExports.jsx("span",{className:gt})})}const touchRippleClasses=generateUtilityClasses("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),touchRippleClasses$1=touchRippleClasses,_excluded$G=["center","classes","className"];let _$3=a=>a,_t$2,_t2$2,_t3$2,_t4$2;const DURATION=550,DELAY_RIPPLE=80,enterKeyframe=keyframes(_t$2||(_t$2=_$3`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),exitKeyframe=keyframes(_t2$2||(_t2$2=_$3`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),pulsateKeyframe=keyframes(_t3$2||(_t3$2=_$3`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),TouchRippleRoot=styled$1("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),TouchRippleRipple=styled$1(Ripple,{name:"MuiTouchRipple",slot:"Ripple"})(_t4$2||(_t4$2=_$3`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),touchRippleClasses$1.rippleVisible,enterKeyframe,DURATION,({theme:a})=>a.transitions.easing.easeInOut,touchRippleClasses$1.ripplePulsate,({theme:a})=>a.transitions.duration.shorter,touchRippleClasses$1.child,touchRippleClasses$1.childLeaving,exitKeyframe,DURATION,({theme:a})=>a.transitions.easing.easeInOut,touchRippleClasses$1.childPulsate,pulsateKeyframe,({theme:a})=>a.transitions.easing.easeInOut),TouchRipple=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiTouchRipple"}),{center:rt=!1,classes:st={},className:at}=tt,ut=_objectWithoutPropertiesLoose(tt,_excluded$G),[s,et]=reactExports.useState([]),ot=reactExports.useRef(0),lt=reactExports.useRef(null);reactExports.useEffect(()=>{lt.current&&(lt.current(),lt.current=null)},[s]);const St=reactExports.useRef(!1),pt=reactExports.useRef(0),gt=reactExports.useRef(null),ct=reactExports.useRef(null);reactExports.useEffect(()=>()=>{pt.current&&clearTimeout(pt.current)},[]);const ht=reactExports.useCallback(Tt=>{const{pulsate:It,rippleX:Pt,rippleY:At,rippleSize:Nt,cb:Ot}=Tt;et(Mt=>[...Mt,jsxRuntimeExports.jsx(TouchRippleRipple,{classes:{ripple:clsx(st.ripple,touchRippleClasses$1.ripple),rippleVisible:clsx(st.rippleVisible,touchRippleClasses$1.rippleVisible),ripplePulsate:clsx(st.ripplePulsate,touchRippleClasses$1.ripplePulsate),child:clsx(st.child,touchRippleClasses$1.child),childLeaving:clsx(st.childLeaving,touchRippleClasses$1.childLeaving),childPulsate:clsx(st.childPulsate,touchRippleClasses$1.childPulsate)},timeout:DURATION,pulsate:It,rippleX:Pt,rippleY:At,rippleSize:Nt},ot.current)]),ot.current+=1,lt.current=Ot},[st]),it=reactExports.useCallback((Tt={},It={},Pt=()=>{})=>{const{pulsate:At=!1,center:Nt=rt||It.pulsate,fakeElement:Ot=!1}=It;if((Tt==null?void 0:Tt.type)==="mousedown"&&St.current){St.current=!1;return}(Tt==null?void 0:Tt.type)==="touchstart"&&(St.current=!0);const Mt=Ot?null:ct.current,bt=Mt?Mt.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Wt,zt,Bt;if(Nt||Tt===void 0||Tt.clientX===0&&Tt.clientY===0||!Tt.clientX&&!Tt.touches)Wt=Math.round(bt.width/2),zt=Math.round(bt.height/2);else{const{clientX:rn,clientY:gn}=Tt.touches&&Tt.touches.length>0?Tt.touches[0]:Tt;Wt=Math.round(rn-bt.left),zt=Math.round(gn-bt.top)}if(Nt)Bt=Math.sqrt((2*bt.width**2+bt.height**2)/3),Bt%2===0&&(Bt+=1);else{const rn=Math.max(Math.abs((Mt?Mt.clientWidth:0)-Wt),Wt)*2+2,gn=Math.max(Math.abs((Mt?Mt.clientHeight:0)-zt),zt)*2+2;Bt=Math.sqrt(rn**2+gn**2)}Tt!=null&&Tt.touches?gt.current===null&&(gt.current=()=>{ht({pulsate:At,rippleX:Wt,rippleY:zt,rippleSize:Bt,cb:Pt})},pt.current=setTimeout(()=>{gt.current&&(gt.current(),gt.current=null)},DELAY_RIPPLE)):ht({pulsate:At,rippleX:Wt,rippleY:zt,rippleSize:Bt,cb:Pt})},[rt,ht]),ft=reactExports.useCallback(()=>{it({},{pulsate:!0})},[it]),mt=reactExports.useCallback((Tt,It)=>{if(clearTimeout(pt.current),(Tt==null?void 0:Tt.type)==="touchend"&&gt.current){gt.current(),gt.current=null,pt.current=setTimeout(()=>{mt(Tt,It)});return}gt.current=null,et(Pt=>Pt.length>0?Pt.slice(1):Pt),lt.current=It},[]);return reactExports.useImperativeHandle(_e,()=>({pulsate:ft,start:it,stop:mt}),[ft,it,mt]),jsxRuntimeExports.jsx(TouchRippleRoot,_extends({className:clsx(touchRippleClasses$1.root,st.root,at),ref:ct},ut,{children:jsxRuntimeExports.jsx(TransitionGroup$1,{component:null,exit:!0,children:s})}))}),TouchRipple$1=TouchRipple;function getButtonBaseUtilityClass(a){return generateUtilityClass("MuiButtonBase",a)}const buttonBaseClasses=generateUtilityClasses("MuiButtonBase",["root","disabled","focusVisible"]),buttonBaseClasses$1=buttonBaseClasses,_excluded$F=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],useUtilityClasses$x=a=>{const{disabled:o,focusVisible:_e,focusVisibleClassName:tt,classes:rt}=a,at=composeClasses({root:["root",o&&"disabled",_e&&"focusVisible"]},getButtonBaseUtilityClass,rt);return _e&&tt&&(at.root+=` ${tt}`),at},ButtonBaseRoot=styled$1("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(a,o)=>o.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${buttonBaseClasses$1.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),ButtonBase=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiButtonBase"}),{action:rt,centerRipple:st=!1,children:at,className:ut,component:s="button",disabled:et=!1,disableRipple:ot=!1,disableTouchRipple:lt=!1,focusRipple:St=!1,LinkComponent:pt="a",onBlur:gt,onClick:ct,onContextMenu:ht,onDragLeave:it,onFocus:ft,onFocusVisible:mt,onKeyDown:Tt,onKeyUp:It,onMouseDown:Pt,onMouseLeave:At,onMouseUp:Nt,onTouchEnd:Ot,onTouchMove:Mt,onTouchStart:bt,tabIndex:Wt=0,TouchRippleProps:zt,touchRippleRef:Bt,type:rn}=tt,gn=_objectWithoutPropertiesLoose(tt,_excluded$F),tn=reactExports.useRef(null),Ht=reactExports.useRef(null),fn=useForkRef(Ht,Bt),{isFocusVisibleRef:bn,onFocus:In,onBlur:un,ref:mn}=useIsFocusVisible(),[yn,pn]=reactExports.useState(!1);et&&yn&&pn(!1),reactExports.useImperativeHandle(rt,()=>({focusVisible:()=>{pn(!0),tn.current.focus()}}),[]);const[Tn,kn]=reactExports.useState(!1);reactExports.useEffect(()=>{kn(!0)},[]);const xn=Tn&&!ot&&!et;reactExports.useEffect(()=>{yn&&St&&!ot&&Tn&&Ht.current.pulsate()},[ot,St,yn,Tn]);function Mn(Kt,Rt,nt=lt){return useEventCallback(Ct=>(Rt&&Rt(Ct),!nt&&Ht.current&&Ht.current[Kt](Ct),!0))}const Dn=Mn("start",Pt),An=Mn("stop",ht),Nn=Mn("stop",it),Un=Mn("stop",Nt),Qn=Mn("stop",Kt=>{yn&&Kt.preventDefault(),At&&At(Kt)}),er=Mn("start",bt),zn=Mn("stop",Ot),lr=Mn("stop",Mt),cn=Mn("stop",Kt=>{un(Kt),bn.current===!1&&pn(!1),gt&&gt(Kt)},!1),Gn=useEventCallback(Kt=>{tn.current||(tn.current=Kt.currentTarget),In(Kt),bn.current===!0&&(pn(!0),mt&&mt(Kt)),ft&&ft(Kt)}),Yn=()=>{const Kt=tn.current;return s&&s!=="button"&&!(Kt.tagName==="A"&&Kt.href)},or=reactExports.useRef(!1),Bn=useEventCallback(Kt=>{St&&!or.current&&yn&&Ht.current&&Kt.key===" "&&(or.current=!0,Ht.current.stop(Kt,()=>{Ht.current.start(Kt)})),Kt.target===Kt.currentTarget&&Yn()&&Kt.key===" "&&Kt.preventDefault(),Tt&&Tt(Kt),Kt.target===Kt.currentTarget&&Yn()&&Kt.key==="Enter"&&!et&&(Kt.preventDefault(),ct&&ct(Kt))}),rr=useEventCallback(Kt=>{St&&Kt.key===" "&&Ht.current&&yn&&!Kt.defaultPrevented&&(or.current=!1,Ht.current.stop(Kt,()=>{Ht.current.pulsate(Kt)})),It&&It(Kt),ct&&Kt.target===Kt.currentTarget&&Yn()&&Kt.key===" "&&!Kt.defaultPrevented&&ct(Kt)});let Zn=s;Zn==="button"&&(gn.href||gn.to)&&(Zn=pt);const _n={};Zn==="button"?(_n.type=rn===void 0?"button":rn,_n.disabled=et):(!gn.href&&!gn.to&&(_n.role="button"),et&&(_n["aria-disabled"]=et));const Ln=useForkRef(_e,mn,tn),vn=_extends({},tt,{centerRipple:st,component:s,disabled:et,disableRipple:ot,disableTouchRipple:lt,focusRipple:St,tabIndex:Wt,focusVisible:yn}),On=useUtilityClasses$x(vn);return jsxRuntimeExports.jsxs(ButtonBaseRoot,_extends({as:Zn,className:clsx(On.root,ut),ownerState:vn,onBlur:cn,onClick:ct,onContextMenu:An,onFocus:Gn,onKeyDown:Bn,onKeyUp:rr,onMouseDown:Dn,onMouseLeave:Qn,onMouseUp:Un,onDragLeave:Nn,onTouchEnd:zn,onTouchMove:lr,onTouchStart:er,ref:Ln,tabIndex:et?-1:Wt,type:rn},_n,gn,{children:[at,xn?jsxRuntimeExports.jsx(TouchRipple$1,_extends({ref:fn,center:st},zt)):null]}))}),ButtonBase$1=ButtonBase,dividerClasses=generateUtilityClasses("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),dividerClasses$1=dividerClasses,listItemIconClasses=generateUtilityClasses("MuiListItemIcon",["root","alignItemsFlexStart"]),listItemIconClasses$1=listItemIconClasses;function getTypographyUtilityClass(a){return generateUtilityClass("MuiTypography",a)}generateUtilityClasses("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const _excluded$E=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],useUtilityClasses$w=a=>{const{align:o,gutterBottom:_e,noWrap:tt,paragraph:rt,variant:st,classes:at}=a,ut={root:["root",st,a.align!=="inherit"&&`align${capitalize(o)}`,_e&&"gutterBottom",tt&&"noWrap",rt&&"paragraph"]};return composeClasses(ut,getTypographyUtilityClass,at)},TypographyRoot=styled$1("span",{name:"MuiTypography",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.variant&&o[_e.variant],_e.align!=="inherit"&&o[`align${capitalize(_e.align)}`],_e.noWrap&&o.noWrap,_e.gutterBottom&&o.gutterBottom,_e.paragraph&&o.paragraph]}})(({theme:a,ownerState:o})=>_extends({margin:0},o.variant==="inherit"&&{font:"inherit"},o.variant!=="inherit"&&a.typography[o.variant],o.align!=="inherit"&&{textAlign:o.align},o.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},o.gutterBottom&&{marginBottom:"0.35em"},o.paragraph&&{marginBottom:16})),defaultVariantMapping={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},colorTransformations$1={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},transformDeprecatedColors$1=a=>colorTransformations$1[a]||a,Typography=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiTypography"}),rt=transformDeprecatedColors$1(tt.color),st=extendSxProp(_extends({},tt,{color:rt})),{align:at="inherit",className:ut,component:s,gutterBottom:et=!1,noWrap:ot=!1,paragraph:lt=!1,variant:St="body1",variantMapping:pt=defaultVariantMapping}=st,gt=_objectWithoutPropertiesLoose(st,_excluded$E),ct=_extends({},st,{align:at,color:rt,className:ut,component:s,gutterBottom:et,noWrap:ot,paragraph:lt,variant:St,variantMapping:pt}),ht=s||(lt?"p":pt[St]||defaultVariantMapping[St])||"span",it=useUtilityClasses$w(ct);return jsxRuntimeExports.jsx(TypographyRoot,_extends({as:ht,ref:_e,ownerState:ct,className:clsx(it.root,ut)},gt))}),Typography$1=Typography,listItemTextClasses=generateUtilityClasses("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),listItemTextClasses$1=listItemTextClasses;function getMenuItemUtilityClass(a){return generateUtilityClass("MuiMenuItem",a)}const menuItemClasses=generateUtilityClasses("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),menuItemClasses$1=menuItemClasses,_excluded$D=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],overridesResolver=(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.dense&&o.dense,_e.divider&&o.divider,!_e.disableGutters&&o.gutters]},useUtilityClasses$v=a=>{const{disabled:o,dense:_e,divider:tt,disableGutters:rt,selected:st,classes:at}=a,s=composeClasses({root:["root",_e&&"dense",o&&"disabled",!rt&&"gutters",tt&&"divider",st&&"selected"]},getMenuItemUtilityClass,at);return _extends({},at,s)},MenuItemRoot=styled$1(ButtonBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver})(({theme:a,ownerState:o})=>_extends({},a.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!o.disableGutters&&{paddingLeft:16,paddingRight:16},o.divider&&{borderBottom:`1px solid ${(a.vars||a).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(a.vars||a).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${menuItemClasses$1.selected}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.selectedOpacity})`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity),[`&.${menuItemClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},[`&.${menuItemClasses$1.selected}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.selectedOpacity})`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity)}},[`&.${menuItemClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${menuItemClasses$1.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},[`& + .${dividerClasses$1.root}`]:{marginTop:a.spacing(1),marginBottom:a.spacing(1)},[`& + .${dividerClasses$1.inset}`]:{marginLeft:52},[`& .${listItemTextClasses$1.root}`]:{marginTop:0,marginBottom:0},[`& .${listItemTextClasses$1.inset}`]:{paddingLeft:36},[`& .${listItemIconClasses$1.root}`]:{minWidth:36}},!o.dense&&{[a.breakpoints.up("sm")]:{minHeight:"auto"}},o.dense&&_extends({minHeight:32,paddingTop:4,paddingBottom:4},a.typography.body2,{[`& .${listItemIconClasses$1.root} svg`]:{fontSize:"1.25rem"}}))),MenuItem=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiMenuItem"}),{autoFocus:rt=!1,component:st="li",dense:at=!1,divider:ut=!1,disableGutters:s=!1,focusVisibleClassName:et,role:ot="menuitem",tabIndex:lt,className:St}=tt,pt=_objectWithoutPropertiesLoose(tt,_excluded$D),gt=reactExports.useContext(ListContext$1),ct=reactExports.useMemo(()=>({dense:at||gt.dense||!1,disableGutters:s}),[gt.dense,at,s]),ht=reactExports.useRef(null);useEnhancedEffect$1(()=>{rt&&ht.current&&ht.current.focus()},[rt]);const it=_extends({},tt,{dense:ct.dense,divider:ut,disableGutters:s}),ft=useUtilityClasses$v(tt),mt=useForkRef(ht,_e);let Tt;return tt.disabled||(Tt=lt!==void 0?lt:-1),jsxRuntimeExports.jsx(ListContext$1.Provider,{value:ct,children:jsxRuntimeExports.jsx(MenuItemRoot,_extends({ref:mt,role:ot,tabIndex:Tt,component:st,focusVisibleClassName:clsx(ft.focusVisible,et),className:clsx(ft.root,St)},pt,{ownerState:it,classes:ft}))})}),MenuItem$1=MenuItem;function isHostComponent(a){return typeof a=="string"}function appendOwnerState(a,o,_e){return a===void 0||isHostComponent(a)?o:_extends({},o,{ownerState:_extends({},o.ownerState,_e)})}const defaultContextValue={disableDefaultClasses:!1},ClassNameConfiguratorContext=reactExports.createContext(defaultContextValue);function useClassNamesOverride(a){const{disableDefaultClasses:o}=reactExports.useContext(ClassNameConfiguratorContext);return _e=>o?"":a(_e)}function extractEventHandlers(a,o=[]){if(a===void 0)return{};const _e={};return Object.keys(a).filter(tt=>tt.match(/^on[A-Z]/)&&typeof a[tt]=="function"&&!o.includes(tt)).forEach(tt=>{_e[tt]=a[tt]}),_e}function resolveComponentProps(a,o,_e){return typeof a=="function"?a(o,_e):a}function omitEventHandlers(a){if(a===void 0)return{};const o={};return Object.keys(a).filter(_e=>!(_e.match(/^on[A-Z]/)&&typeof a[_e]=="function")).forEach(_e=>{o[_e]=a[_e]}),o}function mergeSlotProps(a){const{getSlotProps:o,additionalProps:_e,externalSlotProps:tt,externalForwardedProps:rt,className:st}=a;if(!o){const pt=clsx(rt==null?void 0:rt.className,tt==null?void 0:tt.className,st,_e==null?void 0:_e.className),gt=_extends({},_e==null?void 0:_e.style,rt==null?void 0:rt.style,tt==null?void 0:tt.style),ct=_extends({},_e,rt,tt);return pt.length>0&&(ct.className=pt),Object.keys(gt).length>0&&(ct.style=gt),{props:ct,internalRef:void 0}}const at=extractEventHandlers(_extends({},rt,tt)),ut=omitEventHandlers(tt),s=omitEventHandlers(rt),et=o(at),ot=clsx(et==null?void 0:et.className,_e==null?void 0:_e.className,st,rt==null?void 0:rt.className,tt==null?void 0:tt.className),lt=_extends({},et==null?void 0:et.style,_e==null?void 0:_e.style,rt==null?void 0:rt.style,tt==null?void 0:tt.style),St=_extends({},et,_e,s,ut);return ot.length>0&&(St.className=ot),Object.keys(lt).length>0&&(St.style=lt),{props:St,internalRef:et.ref}}const _excluded$C=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function useSlotProps(a){var o;const{elementType:_e,externalSlotProps:tt,ownerState:rt,skipResolvingSlotProps:st=!1}=a,at=_objectWithoutPropertiesLoose(a,_excluded$C),ut=st?{}:resolveComponentProps(tt,rt),{props:s,internalRef:et}=mergeSlotProps(_extends({},at,{externalSlotProps:ut})),ot=useForkRef(et,ut==null?void 0:ut.ref,(o=a.additionalProps)==null?void 0:o.ref);return appendOwnerState(_e,_extends({},s,{ref:ot}),rt)}function getListUtilityClass(a){return generateUtilityClass("MuiList",a)}generateUtilityClasses("MuiList",["root","padding","dense","subheader"]);const _excluded$B=["children","className","component","dense","disablePadding","subheader"],useUtilityClasses$u=a=>{const{classes:o,disablePadding:_e,dense:tt,subheader:rt}=a;return composeClasses({root:["root",!_e&&"padding",tt&&"dense",rt&&"subheader"]},getListUtilityClass,o)},ListRoot=styled$1("ul",{name:"MuiList",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,!_e.disablePadding&&o.padding,_e.dense&&o.dense,_e.subheader&&o.subheader]}})(({ownerState:a})=>_extends({listStyle:"none",margin:0,padding:0,position:"relative"},!a.disablePadding&&{paddingTop:8,paddingBottom:8},a.subheader&&{paddingTop:0})),List=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiList"}),{children:rt,className:st,component:at="ul",dense:ut=!1,disablePadding:s=!1,subheader:et}=tt,ot=_objectWithoutPropertiesLoose(tt,_excluded$B),lt=reactExports.useMemo(()=>({dense:ut}),[ut]),St=_extends({},tt,{component:at,dense:ut,disablePadding:s}),pt=useUtilityClasses$u(St);return jsxRuntimeExports.jsx(ListContext$1.Provider,{value:lt,children:jsxRuntimeExports.jsxs(ListRoot,_extends({as:at,className:clsx(pt.root,st),ref:_e,ownerState:St},ot,{children:[et,rt]}))})}),List$1=List,_excluded$A=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function nextItem(a,o,_e){return a===o?a.firstChild:o&&o.nextElementSibling?o.nextElementSibling:_e?null:a.firstChild}function previousItem(a,o,_e){return a===o?_e?a.firstChild:a.lastChild:o&&o.previousElementSibling?o.previousElementSibling:_e?null:a.lastChild}function textCriteriaMatches(a,o){if(o===void 0)return!0;let _e=a.innerText;return _e===void 0&&(_e=a.textContent),_e=_e.trim().toLowerCase(),_e.length===0?!1:o.repeating?_e[0]===o.keys[0]:_e.indexOf(o.keys.join(""))===0}function moveFocus(a,o,_e,tt,rt,st){let at=!1,ut=rt(a,o,o?_e:!1);for(;ut;){if(ut===a.firstChild){if(at)return!1;at=!0}const s=tt?!1:ut.disabled||ut.getAttribute("aria-disabled")==="true";if(!ut.hasAttribute("tabindex")||!textCriteriaMatches(ut,st)||s)ut=rt(a,ut,_e);else return ut.focus(),!0}return!1}const MenuList=reactExports.forwardRef(function(o,_e){const{actions:tt,autoFocus:rt=!1,autoFocusItem:st=!1,children:at,className:ut,disabledItemsFocusable:s=!1,disableListWrap:et=!1,onKeyDown:ot,variant:lt="selectedMenu"}=o,St=_objectWithoutPropertiesLoose(o,_excluded$A),pt=reactExports.useRef(null),gt=reactExports.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});useEnhancedEffect$1(()=>{rt&&pt.current.focus()},[rt]),reactExports.useImperativeHandle(tt,()=>({adjustStyleForScrollbar:(mt,Tt)=>{const It=!pt.current.style.width;if(mt.clientHeight<pt.current.clientHeight&&It){const Pt=`${getScrollbarSize(ownerDocument(mt))}px`;pt.current.style[Tt.direction==="rtl"?"paddingLeft":"paddingRight"]=Pt,pt.current.style.width=`calc(100% + ${Pt})`}return pt.current}}),[]);const ct=mt=>{const Tt=pt.current,It=mt.key,Pt=ownerDocument(Tt).activeElement;if(It==="ArrowDown")mt.preventDefault(),moveFocus(Tt,Pt,et,s,nextItem);else if(It==="ArrowUp")mt.preventDefault(),moveFocus(Tt,Pt,et,s,previousItem);else if(It==="Home")mt.preventDefault(),moveFocus(Tt,null,et,s,nextItem);else if(It==="End")mt.preventDefault(),moveFocus(Tt,null,et,s,previousItem);else if(It.length===1){const At=gt.current,Nt=It.toLowerCase(),Ot=performance.now();At.keys.length>0&&(Ot-At.lastTime>500?(At.keys=[],At.repeating=!0,At.previousKeyMatched=!0):At.repeating&&Nt!==At.keys[0]&&(At.repeating=!1)),At.lastTime=Ot,At.keys.push(Nt);const Mt=Pt&&!At.repeating&&textCriteriaMatches(Pt,At);At.previousKeyMatched&&(Mt||moveFocus(Tt,Pt,!1,s,nextItem,At))?mt.preventDefault():At.previousKeyMatched=!1}ot&&ot(mt)},ht=useForkRef(pt,_e);let it=-1;reactExports.Children.forEach(at,(mt,Tt)=>{if(!reactExports.isValidElement(mt)){it===Tt&&(it+=1,it>=at.length&&(it=-1));return}mt.props.disabled||(lt==="selectedMenu"&&mt.props.selected||it===-1)&&(it=Tt),it===Tt&&(mt.props.disabled||mt.props.muiSkipListHighlight||mt.type.muiSkipListHighlight)&&(it+=1,it>=at.length&&(it=-1))});const ft=reactExports.Children.map(at,(mt,Tt)=>{if(Tt===it){const It={};return st&&(It.autoFocus=!0),mt.props.tabIndex===void 0&&lt==="selectedMenu"&&(It.tabIndex=0),reactExports.cloneElement(mt,It)}return mt});return jsxRuntimeExports.jsx(List$1,_extends({role:"menu",ref:ht,className:ut,onKeyDown:ct,tabIndex:rt?0:-1},St,{children:ft}))}),MenuList$1=MenuList,candidatesSelector=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function getTabIndex(a){const o=parseInt(a.getAttribute("tabindex")||"",10);return Number.isNaN(o)?a.contentEditable==="true"||(a.nodeName==="AUDIO"||a.nodeName==="VIDEO"||a.nodeName==="DETAILS")&&a.getAttribute("tabindex")===null?0:a.tabIndex:o}function isNonTabbableRadio(a){if(a.tagName!=="INPUT"||a.type!=="radio"||!a.name)return!1;const o=tt=>a.ownerDocument.querySelector(`input[type="radio"]${tt}`);let _e=o(`[name="${a.name}"]:checked`);return _e||(_e=o(`[name="${a.name}"]`)),_e!==a}function isNodeMatchingSelectorFocusable(a){return!(a.disabled||a.tagName==="INPUT"&&a.type==="hidden"||isNonTabbableRadio(a))}function defaultGetTabbable(a){const o=[],_e=[];return Array.from(a.querySelectorAll(candidatesSelector)).forEach((tt,rt)=>{const st=getTabIndex(tt);st===-1||!isNodeMatchingSelectorFocusable(tt)||(st===0?o.push(tt):_e.push({documentOrder:rt,tabIndex:st,node:tt}))}),_e.sort((tt,rt)=>tt.tabIndex===rt.tabIndex?tt.documentOrder-rt.documentOrder:tt.tabIndex-rt.tabIndex).map(tt=>tt.node).concat(o)}function defaultIsEnabled(){return!0}function FocusTrap(a){const{children:o,disableAutoFocus:_e=!1,disableEnforceFocus:tt=!1,disableRestoreFocus:rt=!1,getTabbable:st=defaultGetTabbable,isEnabled:at=defaultIsEnabled,open:ut}=a,s=reactExports.useRef(!1),et=reactExports.useRef(null),ot=reactExports.useRef(null),lt=reactExports.useRef(null),St=reactExports.useRef(null),pt=reactExports.useRef(!1),gt=reactExports.useRef(null),ct=useForkRef(o.ref,gt),ht=reactExports.useRef(null);reactExports.useEffect(()=>{!ut||!gt.current||(pt.current=!_e)},[_e,ut]),reactExports.useEffect(()=>{if(!ut||!gt.current)return;const mt=ownerDocument(gt.current);return gt.current.contains(mt.activeElement)||(gt.current.hasAttribute("tabIndex")||gt.current.setAttribute("tabIndex","-1"),pt.current&&gt.current.focus()),()=>{rt||(lt.current&&lt.current.focus&&(s.current=!0,lt.current.focus()),lt.current=null)}},[ut]),reactExports.useEffect(()=>{if(!ut||!gt.current)return;const mt=ownerDocument(gt.current),Tt=At=>{ht.current=At,!(tt||!at()||At.key!=="Tab")&&mt.activeElement===gt.current&&At.shiftKey&&(s.current=!0,ot.current&&ot.current.focus())},It=()=>{const At=gt.current;if(At===null)return;if(!mt.hasFocus()||!at()||s.current){s.current=!1;return}if(At.contains(mt.activeElement)||tt&&mt.activeElement!==et.current&&mt.activeElement!==ot.current)return;if(mt.activeElement!==St.current)St.current=null;else if(St.current!==null)return;if(!pt.current)return;let Nt=[];if((mt.activeElement===et.current||mt.activeElement===ot.current)&&(Nt=st(gt.current)),Nt.length>0){var Ot,Mt;const bt=!!((Ot=ht.current)!=null&&Ot.shiftKey&&((Mt=ht.current)==null?void 0:Mt.key)==="Tab"),Wt=Nt[0],zt=Nt[Nt.length-1];typeof Wt!="string"&&typeof zt!="string"&&(bt?zt.focus():Wt.focus())}else At.focus()};mt.addEventListener("focusin",It),mt.addEventListener("keydown",Tt,!0);const Pt=setInterval(()=>{mt.activeElement&&mt.activeElement.tagName==="BODY"&&It()},50);return()=>{clearInterval(Pt),mt.removeEventListener("focusin",It),mt.removeEventListener("keydown",Tt,!0)}},[_e,tt,rt,at,ut,st]);const it=mt=>{lt.current===null&&(lt.current=mt.relatedTarget),pt.current=!0,St.current=mt.target;const Tt=o.props.onFocus;Tt&&Tt(mt)},ft=mt=>{lt.current===null&&(lt.current=mt.relatedTarget),pt.current=!0};return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{tabIndex:ut?0:-1,onFocus:ft,ref:et,"data-testid":"sentinelStart"}),reactExports.cloneElement(o,{ref:ct,onFocus:it}),jsxRuntimeExports.jsx("div",{tabIndex:ut?0:-1,onFocus:ft,ref:ot,"data-testid":"sentinelEnd"})]})}var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(a,o){return a.concat([o+"-"+start,o+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(a,o){return a.concat([o,o+"-"+start,o+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(a){return a?(a.nodeName||"").toLowerCase():null}function getWindow(a){if(a==null)return window;if(a.toString()!=="[object Window]"){var o=a.ownerDocument;return o&&o.defaultView||window}return a}function isElement(a){var o=getWindow(a).Element;return a instanceof o||a instanceof Element}function isHTMLElement$1(a){var o=getWindow(a).HTMLElement;return a instanceof o||a instanceof HTMLElement}function isShadowRoot(a){if(typeof ShadowRoot>"u")return!1;var o=getWindow(a).ShadowRoot;return a instanceof o||a instanceof ShadowRoot}function applyStyles(a){var o=a.state;Object.keys(o.elements).forEach(function(_e){var tt=o.styles[_e]||{},rt=o.attributes[_e]||{},st=o.elements[_e];!isHTMLElement$1(st)||!getNodeName(st)||(Object.assign(st.style,tt),Object.keys(rt).forEach(function(at){var ut=rt[at];ut===!1?st.removeAttribute(at):st.setAttribute(at,ut===!0?"":ut)}))})}function effect$2(a){var o=a.state,_e={popper:{position:o.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(o.elements.popper.style,_e.popper),o.styles=_e,o.elements.arrow&&Object.assign(o.elements.arrow.style,_e.arrow),function(){Object.keys(o.elements).forEach(function(tt){var rt=o.elements[tt],st=o.attributes[tt]||{},at=Object.keys(o.styles.hasOwnProperty(tt)?o.styles[tt]:_e[tt]),ut=at.reduce(function(s,et){return s[et]="",s},{});!isHTMLElement$1(rt)||!getNodeName(rt)||(Object.assign(rt.style,ut),Object.keys(st).forEach(function(s){rt.removeAttribute(s)}))})}}const applyStyles$1={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect:effect$2,requires:["computeStyles"]};function getBasePlacement(a){return a.split("-")[0]}var max=Math.max,min=Math.min,round$1=Math.round;function getUAString(){var a=navigator.userAgentData;return a!=null&&a.brands&&Array.isArray(a.brands)?a.brands.map(function(o){return o.brand+"/"+o.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(a,o,_e){o===void 0&&(o=!1),_e===void 0&&(_e=!1);var tt=a.getBoundingClientRect(),rt=1,st=1;o&&isHTMLElement$1(a)&&(rt=a.offsetWidth>0&&round$1(tt.width)/a.offsetWidth||1,st=a.offsetHeight>0&&round$1(tt.height)/a.offsetHeight||1);var at=isElement(a)?getWindow(a):window,ut=at.visualViewport,s=!isLayoutViewport()&&_e,et=(tt.left+(s&&ut?ut.offsetLeft:0))/rt,ot=(tt.top+(s&&ut?ut.offsetTop:0))/st,lt=tt.width/rt,St=tt.height/st;return{width:lt,height:St,top:ot,right:et+lt,bottom:ot+St,left:et,x:et,y:ot}}function getLayoutRect(a){var o=getBoundingClientRect(a),_e=a.offsetWidth,tt=a.offsetHeight;return Math.abs(o.width-_e)<=1&&(_e=o.width),Math.abs(o.height-tt)<=1&&(tt=o.height),{x:a.offsetLeft,y:a.offsetTop,width:_e,height:tt}}function contains(a,o){var _e=o.getRootNode&&o.getRootNode();if(a.contains(o))return!0;if(_e&&isShadowRoot(_e)){var tt=o;do{if(tt&&a.isSameNode(tt))return!0;tt=tt.parentNode||tt.host}while(tt)}return!1}function getComputedStyle$1(a){return getWindow(a).getComputedStyle(a)}function isTableElement(a){return["table","td","th"].indexOf(getNodeName(a))>=0}function getDocumentElement(a){return((isElement(a)?a.ownerDocument:a.document)||window.document).documentElement}function getParentNode(a){return getNodeName(a)==="html"?a:a.assignedSlot||a.parentNode||(isShadowRoot(a)?a.host:null)||getDocumentElement(a)}function getTrueOffsetParent(a){return!isHTMLElement$1(a)||getComputedStyle$1(a).position==="fixed"?null:a.offsetParent}function getContainingBlock(a){var o=/firefox/i.test(getUAString()),_e=/Trident/i.test(getUAString());if(_e&&isHTMLElement$1(a)){var tt=getComputedStyle$1(a);if(tt.position==="fixed")return null}var rt=getParentNode(a);for(isShadowRoot(rt)&&(rt=rt.host);isHTMLElement$1(rt)&&["html","body"].indexOf(getNodeName(rt))<0;){var st=getComputedStyle$1(rt);if(st.transform!=="none"||st.perspective!=="none"||st.contain==="paint"||["transform","perspective"].indexOf(st.willChange)!==-1||o&&st.willChange==="filter"||o&&st.filter&&st.filter!=="none")return rt;rt=rt.parentNode}return null}function getOffsetParent(a){for(var o=getWindow(a),_e=getTrueOffsetParent(a);_e&&isTableElement(_e)&&getComputedStyle$1(_e).position==="static";)_e=getTrueOffsetParent(_e);return _e&&(getNodeName(_e)==="html"||getNodeName(_e)==="body"&&getComputedStyle$1(_e).position==="static")?o:_e||getContainingBlock(a)||o}function getMainAxisFromPlacement(a){return["top","bottom"].indexOf(a)>=0?"x":"y"}function within(a,o,_e){return max(a,min(o,_e))}function withinMaxClamp(a,o,_e){var tt=within(a,o,_e);return tt>_e?_e:tt}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(a){return Object.assign({},getFreshSideObject(),a)}function expandToHashMap(a,o){return o.reduce(function(_e,tt){return _e[tt]=a,_e},{})}var toPaddingObject=function(o,_e){return o=typeof o=="function"?o(Object.assign({},_e.rects,{placement:_e.placement})):o,mergePaddingObject(typeof o!="number"?o:expandToHashMap(o,basePlacements))};function arrow(a){var o,_e=a.state,tt=a.name,rt=a.options,st=_e.elements.arrow,at=_e.modifiersData.popperOffsets,ut=getBasePlacement(_e.placement),s=getMainAxisFromPlacement(ut),et=[left,right].indexOf(ut)>=0,ot=et?"height":"width";if(!(!st||!at)){var lt=toPaddingObject(rt.padding,_e),St=getLayoutRect(st),pt=s==="y"?top:left,gt=s==="y"?bottom:right,ct=_e.rects.reference[ot]+_e.rects.reference[s]-at[s]-_e.rects.popper[ot],ht=at[s]-_e.rects.reference[s],it=getOffsetParent(st),ft=it?s==="y"?it.clientHeight||0:it.clientWidth||0:0,mt=ct/2-ht/2,Tt=lt[pt],It=ft-St[ot]-lt[gt],Pt=ft/2-St[ot]/2+mt,At=within(Tt,Pt,It),Nt=s;_e.modifiersData[tt]=(o={},o[Nt]=At,o.centerOffset=At-Pt,o)}}function effect$1(a){var o=a.state,_e=a.options,tt=_e.element,rt=tt===void 0?"[data-popper-arrow]":tt;rt!=null&&(typeof rt=="string"&&(rt=o.elements.popper.querySelector(rt),!rt)||contains(o.elements.popper,rt)&&(o.elements.arrow=rt))}const arrow$1={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect$1,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(a){return a.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(a,o){var _e=a.x,tt=a.y,rt=o.devicePixelRatio||1;return{x:round$1(_e*rt)/rt||0,y:round$1(tt*rt)/rt||0}}function mapToStyles(a){var o,_e=a.popper,tt=a.popperRect,rt=a.placement,st=a.variation,at=a.offsets,ut=a.position,s=a.gpuAcceleration,et=a.adaptive,ot=a.roundOffsets,lt=a.isFixed,St=at.x,pt=St===void 0?0:St,gt=at.y,ct=gt===void 0?0:gt,ht=typeof ot=="function"?ot({x:pt,y:ct}):{x:pt,y:ct};pt=ht.x,ct=ht.y;var it=at.hasOwnProperty("x"),ft=at.hasOwnProperty("y"),mt=left,Tt=top,It=window;if(et){var Pt=getOffsetParent(_e),At="clientHeight",Nt="clientWidth";if(Pt===getWindow(_e)&&(Pt=getDocumentElement(_e),getComputedStyle$1(Pt).position!=="static"&&ut==="absolute"&&(At="scrollHeight",Nt="scrollWidth")),Pt=Pt,rt===top||(rt===left||rt===right)&&st===end){Tt=bottom;var Ot=lt&&Pt===It&&It.visualViewport?It.visualViewport.height:Pt[At];ct-=Ot-tt.height,ct*=s?1:-1}if(rt===left||(rt===top||rt===bottom)&&st===end){mt=right;var Mt=lt&&Pt===It&&It.visualViewport?It.visualViewport.width:Pt[Nt];pt-=Mt-tt.width,pt*=s?1:-1}}var bt=Object.assign({position:ut},et&&unsetSides),Wt=ot===!0?roundOffsetsByDPR({x:pt,y:ct},getWindow(_e)):{x:pt,y:ct};if(pt=Wt.x,ct=Wt.y,s){var zt;return Object.assign({},bt,(zt={},zt[Tt]=ft?"0":"",zt[mt]=it?"0":"",zt.transform=(It.devicePixelRatio||1)<=1?"translate("+pt+"px, "+ct+"px)":"translate3d("+pt+"px, "+ct+"px, 0)",zt))}return Object.assign({},bt,(o={},o[Tt]=ft?ct+"px":"",o[mt]=it?pt+"px":"",o.transform="",o))}function computeStyles(a){var o=a.state,_e=a.options,tt=_e.gpuAcceleration,rt=tt===void 0?!0:tt,st=_e.adaptive,at=st===void 0?!0:st,ut=_e.roundOffsets,s=ut===void 0?!0:ut,et={placement:getBasePlacement(o.placement),variation:getVariation(o.placement),popper:o.elements.popper,popperRect:o.rects.popper,gpuAcceleration:rt,isFixed:o.options.strategy==="fixed"};o.modifiersData.popperOffsets!=null&&(o.styles.popper=Object.assign({},o.styles.popper,mapToStyles(Object.assign({},et,{offsets:o.modifiersData.popperOffsets,position:o.options.strategy,adaptive:at,roundOffsets:s})))),o.modifiersData.arrow!=null&&(o.styles.arrow=Object.assign({},o.styles.arrow,mapToStyles(Object.assign({},et,{offsets:o.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:s})))),o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-placement":o.placement})}const computeStyles$1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};var passive={passive:!0};function effect(a){var o=a.state,_e=a.instance,tt=a.options,rt=tt.scroll,st=rt===void 0?!0:rt,at=tt.resize,ut=at===void 0?!0:at,s=getWindow(o.elements.popper),et=[].concat(o.scrollParents.reference,o.scrollParents.popper);return st&&et.forEach(function(ot){ot.addEventListener("scroll",_e.update,passive)}),ut&&s.addEventListener("resize",_e.update,passive),function(){st&&et.forEach(function(ot){ot.removeEventListener("scroll",_e.update,passive)}),ut&&s.removeEventListener("resize",_e.update,passive)}}const eventListeners={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect,data:{}};var hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(a){return a.replace(/left|right|bottom|top/g,function(o){return hash$1[o]})}var hash={start:"end",end:"start"};function getOppositeVariationPlacement(a){return a.replace(/start|end/g,function(o){return hash[o]})}function getWindowScroll(a){var o=getWindow(a),_e=o.pageXOffset,tt=o.pageYOffset;return{scrollLeft:_e,scrollTop:tt}}function getWindowScrollBarX(a){return getBoundingClientRect(getDocumentElement(a)).left+getWindowScroll(a).scrollLeft}function getViewportRect(a,o){var _e=getWindow(a),tt=getDocumentElement(a),rt=_e.visualViewport,st=tt.clientWidth,at=tt.clientHeight,ut=0,s=0;if(rt){st=rt.width,at=rt.height;var et=isLayoutViewport();(et||!et&&o==="fixed")&&(ut=rt.offsetLeft,s=rt.offsetTop)}return{width:st,height:at,x:ut+getWindowScrollBarX(a),y:s}}function getDocumentRect(a){var o,_e=getDocumentElement(a),tt=getWindowScroll(a),rt=(o=a.ownerDocument)==null?void 0:o.body,st=max(_e.scrollWidth,_e.clientWidth,rt?rt.scrollWidth:0,rt?rt.clientWidth:0),at=max(_e.scrollHeight,_e.clientHeight,rt?rt.scrollHeight:0,rt?rt.clientHeight:0),ut=-tt.scrollLeft+getWindowScrollBarX(a),s=-tt.scrollTop;return getComputedStyle$1(rt||_e).direction==="rtl"&&(ut+=max(_e.clientWidth,rt?rt.clientWidth:0)-st),{width:st,height:at,x:ut,y:s}}function isScrollParent(a){var o=getComputedStyle$1(a),_e=o.overflow,tt=o.overflowX,rt=o.overflowY;return/auto|scroll|overlay|hidden/.test(_e+rt+tt)}function getScrollParent(a){return["html","body","#document"].indexOf(getNodeName(a))>=0?a.ownerDocument.body:isHTMLElement$1(a)&&isScrollParent(a)?a:getScrollParent(getParentNode(a))}function listScrollParents(a,o){var _e;o===void 0&&(o=[]);var tt=getScrollParent(a),rt=tt===((_e=a.ownerDocument)==null?void 0:_e.body),st=getWindow(tt),at=rt?[st].concat(st.visualViewport||[],isScrollParent(tt)?tt:[]):tt,ut=o.concat(at);return rt?ut:ut.concat(listScrollParents(getParentNode(at)))}function rectToClientRect(a){return Object.assign({},a,{left:a.x,top:a.y,right:a.x+a.width,bottom:a.y+a.height})}function getInnerBoundingClientRect(a,o){var _e=getBoundingClientRect(a,!1,o==="fixed");return _e.top=_e.top+a.clientTop,_e.left=_e.left+a.clientLeft,_e.bottom=_e.top+a.clientHeight,_e.right=_e.left+a.clientWidth,_e.width=a.clientWidth,_e.height=a.clientHeight,_e.x=_e.left,_e.y=_e.top,_e}function getClientRectFromMixedType(a,o,_e){return o===viewport?rectToClientRect(getViewportRect(a,_e)):isElement(o)?getInnerBoundingClientRect(o,_e):rectToClientRect(getDocumentRect(getDocumentElement(a)))}function getClippingParents(a){var o=listScrollParents(getParentNode(a)),_e=["absolute","fixed"].indexOf(getComputedStyle$1(a).position)>=0,tt=_e&&isHTMLElement$1(a)?getOffsetParent(a):a;return isElement(tt)?o.filter(function(rt){return isElement(rt)&&contains(rt,tt)&&getNodeName(rt)!=="body"}):[]}function getClippingRect(a,o,_e,tt){var rt=o==="clippingParents"?getClippingParents(a):[].concat(o),st=[].concat(rt,[_e]),at=st[0],ut=st.reduce(function(s,et){var ot=getClientRectFromMixedType(a,et,tt);return s.top=max(ot.top,s.top),s.right=min(ot.right,s.right),s.bottom=min(ot.bottom,s.bottom),s.left=max(ot.left,s.left),s},getClientRectFromMixedType(a,at,tt));return ut.width=ut.right-ut.left,ut.height=ut.bottom-ut.top,ut.x=ut.left,ut.y=ut.top,ut}function computeOffsets(a){var o=a.reference,_e=a.element,tt=a.placement,rt=tt?getBasePlacement(tt):null,st=tt?getVariation(tt):null,at=o.x+o.width/2-_e.width/2,ut=o.y+o.height/2-_e.height/2,s;switch(rt){case top:s={x:at,y:o.y-_e.height};break;case bottom:s={x:at,y:o.y+o.height};break;case right:s={x:o.x+o.width,y:ut};break;case left:s={x:o.x-_e.width,y:ut};break;default:s={x:o.x,y:o.y}}var et=rt?getMainAxisFromPlacement(rt):null;if(et!=null){var ot=et==="y"?"height":"width";switch(st){case start:s[et]=s[et]-(o[ot]/2-_e[ot]/2);break;case end:s[et]=s[et]+(o[ot]/2-_e[ot]/2);break}}return s}function detectOverflow(a,o){o===void 0&&(o={});var _e=o,tt=_e.placement,rt=tt===void 0?a.placement:tt,st=_e.strategy,at=st===void 0?a.strategy:st,ut=_e.boundary,s=ut===void 0?clippingParents:ut,et=_e.rootBoundary,ot=et===void 0?viewport:et,lt=_e.elementContext,St=lt===void 0?popper:lt,pt=_e.altBoundary,gt=pt===void 0?!1:pt,ct=_e.padding,ht=ct===void 0?0:ct,it=mergePaddingObject(typeof ht!="number"?ht:expandToHashMap(ht,basePlacements)),ft=St===popper?reference:popper,mt=a.rects.popper,Tt=a.elements[gt?ft:St],It=getClippingRect(isElement(Tt)?Tt:Tt.contextElement||getDocumentElement(a.elements.popper),s,ot,at),Pt=getBoundingClientRect(a.elements.reference),At=computeOffsets({reference:Pt,element:mt,strategy:"absolute",placement:rt}),Nt=rectToClientRect(Object.assign({},mt,At)),Ot=St===popper?Nt:Pt,Mt={top:It.top-Ot.top+it.top,bottom:Ot.bottom-It.bottom+it.bottom,left:It.left-Ot.left+it.left,right:Ot.right-It.right+it.right},bt=a.modifiersData.offset;if(St===popper&&bt){var Wt=bt[rt];Object.keys(Mt).forEach(function(zt){var Bt=[right,bottom].indexOf(zt)>=0?1:-1,rn=[top,bottom].indexOf(zt)>=0?"y":"x";Mt[zt]+=Wt[rn]*Bt})}return Mt}function computeAutoPlacement(a,o){o===void 0&&(o={});var _e=o,tt=_e.placement,rt=_e.boundary,st=_e.rootBoundary,at=_e.padding,ut=_e.flipVariations,s=_e.allowedAutoPlacements,et=s===void 0?placements:s,ot=getVariation(tt),lt=ot?ut?variationPlacements:variationPlacements.filter(function(gt){return getVariation(gt)===ot}):basePlacements,St=lt.filter(function(gt){return et.indexOf(gt)>=0});St.length===0&&(St=lt);var pt=St.reduce(function(gt,ct){return gt[ct]=detectOverflow(a,{placement:ct,boundary:rt,rootBoundary:st,padding:at})[getBasePlacement(ct)],gt},{});return Object.keys(pt).sort(function(gt,ct){return pt[gt]-pt[ct]})}function getExpandedFallbackPlacements(a){if(getBasePlacement(a)===auto)return[];var o=getOppositePlacement(a);return[getOppositeVariationPlacement(a),o,getOppositeVariationPlacement(o)]}function flip(a){var o=a.state,_e=a.options,tt=a.name;if(!o.modifiersData[tt]._skip){for(var rt=_e.mainAxis,st=rt===void 0?!0:rt,at=_e.altAxis,ut=at===void 0?!0:at,s=_e.fallbackPlacements,et=_e.padding,ot=_e.boundary,lt=_e.rootBoundary,St=_e.altBoundary,pt=_e.flipVariations,gt=pt===void 0?!0:pt,ct=_e.allowedAutoPlacements,ht=o.options.placement,it=getBasePlacement(ht),ft=it===ht,mt=s||(ft||!gt?[getOppositePlacement(ht)]:getExpandedFallbackPlacements(ht)),Tt=[ht].concat(mt).reduce(function(yn,pn){return yn.concat(getBasePlacement(pn)===auto?computeAutoPlacement(o,{placement:pn,boundary:ot,rootBoundary:lt,padding:et,flipVariations:gt,allowedAutoPlacements:ct}):pn)},[]),It=o.rects.reference,Pt=o.rects.popper,At=new Map,Nt=!0,Ot=Tt[0],Mt=0;Mt<Tt.length;Mt++){var bt=Tt[Mt],Wt=getBasePlacement(bt),zt=getVariation(bt)===start,Bt=[top,bottom].indexOf(Wt)>=0,rn=Bt?"width":"height",gn=detectOverflow(o,{placement:bt,boundary:ot,rootBoundary:lt,altBoundary:St,padding:et}),tn=Bt?zt?right:left:zt?bottom:top;It[rn]>Pt[rn]&&(tn=getOppositePlacement(tn));var Ht=getOppositePlacement(tn),fn=[];if(st&&fn.push(gn[Wt]<=0),ut&&fn.push(gn[tn]<=0,gn[Ht]<=0),fn.every(function(yn){return yn})){Ot=bt,Nt=!1;break}At.set(bt,fn)}if(Nt)for(var bn=gt?3:1,In=function(pn){var Tn=Tt.find(function(kn){var xn=At.get(kn);if(xn)return xn.slice(0,pn).every(function(Mn){return Mn})});if(Tn)return Ot=Tn,"break"},un=bn;un>0;un--){var mn=In(un);if(mn==="break")break}o.placement!==Ot&&(o.modifiersData[tt]._skip=!0,o.placement=Ot,o.reset=!0)}}const flip$1={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(a,o,_e){return _e===void 0&&(_e={x:0,y:0}),{top:a.top-o.height-_e.y,right:a.right-o.width+_e.x,bottom:a.bottom-o.height+_e.y,left:a.left-o.width-_e.x}}function isAnySideFullyClipped(a){return[top,right,bottom,left].some(function(o){return a[o]>=0})}function hide(a){var o=a.state,_e=a.name,tt=o.rects.reference,rt=o.rects.popper,st=o.modifiersData.preventOverflow,at=detectOverflow(o,{elementContext:"reference"}),ut=detectOverflow(o,{altBoundary:!0}),s=getSideOffsets(at,tt),et=getSideOffsets(ut,rt,st),ot=isAnySideFullyClipped(s),lt=isAnySideFullyClipped(et);o.modifiersData[_e]={referenceClippingOffsets:s,popperEscapeOffsets:et,isReferenceHidden:ot,hasPopperEscaped:lt},o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-reference-hidden":ot,"data-popper-escaped":lt})}const hide$1={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(a,o,_e){var tt=getBasePlacement(a),rt=[left,top].indexOf(tt)>=0?-1:1,st=typeof _e=="function"?_e(Object.assign({},o,{placement:a})):_e,at=st[0],ut=st[1];return at=at||0,ut=(ut||0)*rt,[left,right].indexOf(tt)>=0?{x:ut,y:at}:{x:at,y:ut}}function offset(a){var o=a.state,_e=a.options,tt=a.name,rt=_e.offset,st=rt===void 0?[0,0]:rt,at=placements.reduce(function(ot,lt){return ot[lt]=distanceAndSkiddingToXY(lt,o.rects,st),ot},{}),ut=at[o.placement],s=ut.x,et=ut.y;o.modifiersData.popperOffsets!=null&&(o.modifiersData.popperOffsets.x+=s,o.modifiersData.popperOffsets.y+=et),o.modifiersData[tt]=at}const offset$1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(a){var o=a.state,_e=a.name;o.modifiersData[_e]=computeOffsets({reference:o.rects.reference,element:o.rects.popper,strategy:"absolute",placement:o.placement})}const popperOffsets$1={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(a){return a==="x"?"y":"x"}function preventOverflow(a){var o=a.state,_e=a.options,tt=a.name,rt=_e.mainAxis,st=rt===void 0?!0:rt,at=_e.altAxis,ut=at===void 0?!1:at,s=_e.boundary,et=_e.rootBoundary,ot=_e.altBoundary,lt=_e.padding,St=_e.tether,pt=St===void 0?!0:St,gt=_e.tetherOffset,ct=gt===void 0?0:gt,ht=detectOverflow(o,{boundary:s,rootBoundary:et,padding:lt,altBoundary:ot}),it=getBasePlacement(o.placement),ft=getVariation(o.placement),mt=!ft,Tt=getMainAxisFromPlacement(it),It=getAltAxis(Tt),Pt=o.modifiersData.popperOffsets,At=o.rects.reference,Nt=o.rects.popper,Ot=typeof ct=="function"?ct(Object.assign({},o.rects,{placement:o.placement})):ct,Mt=typeof Ot=="number"?{mainAxis:Ot,altAxis:Ot}:Object.assign({mainAxis:0,altAxis:0},Ot),bt=o.modifiersData.offset?o.modifiersData.offset[o.placement]:null,Wt={x:0,y:0};if(Pt){if(st){var zt,Bt=Tt==="y"?top:left,rn=Tt==="y"?bottom:right,gn=Tt==="y"?"height":"width",tn=Pt[Tt],Ht=tn+ht[Bt],fn=tn-ht[rn],bn=pt?-Nt[gn]/2:0,In=ft===start?At[gn]:Nt[gn],un=ft===start?-Nt[gn]:-At[gn],mn=o.elements.arrow,yn=pt&&mn?getLayoutRect(mn):{width:0,height:0},pn=o.modifiersData["arrow#persistent"]?o.modifiersData["arrow#persistent"].padding:getFreshSideObject(),Tn=pn[Bt],kn=pn[rn],xn=within(0,At[gn],yn[gn]),Mn=mt?At[gn]/2-bn-xn-Tn-Mt.mainAxis:In-xn-Tn-Mt.mainAxis,Dn=mt?-At[gn]/2+bn+xn+kn+Mt.mainAxis:un+xn+kn+Mt.mainAxis,An=o.elements.arrow&&getOffsetParent(o.elements.arrow),Nn=An?Tt==="y"?An.clientTop||0:An.clientLeft||0:0,Un=(zt=bt==null?void 0:bt[Tt])!=null?zt:0,Qn=tn+Mn-Un-Nn,er=tn+Dn-Un,zn=within(pt?min(Ht,Qn):Ht,tn,pt?max(fn,er):fn);Pt[Tt]=zn,Wt[Tt]=zn-tn}if(ut){var lr,cn=Tt==="x"?top:left,Gn=Tt==="x"?bottom:right,Yn=Pt[It],or=It==="y"?"height":"width",Bn=Yn+ht[cn],rr=Yn-ht[Gn],Zn=[top,left].indexOf(it)!==-1,_n=(lr=bt==null?void 0:bt[It])!=null?lr:0,Ln=Zn?Bn:Yn-At[or]-Nt[or]-_n+Mt.altAxis,vn=Zn?Yn+At[or]+Nt[or]-_n-Mt.altAxis:rr,On=pt&&Zn?withinMaxClamp(Ln,Yn,vn):within(pt?Ln:Bn,Yn,pt?vn:rr);Pt[It]=On,Wt[It]=On-Yn}o.modifiersData[tt]=Wt}}const preventOverflow$1={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(a){return{scrollLeft:a.scrollLeft,scrollTop:a.scrollTop}}function getNodeScroll(a){return a===getWindow(a)||!isHTMLElement$1(a)?getWindowScroll(a):getHTMLElementScroll(a)}function isElementScaled(a){var o=a.getBoundingClientRect(),_e=round$1(o.width)/a.offsetWidth||1,tt=round$1(o.height)/a.offsetHeight||1;return _e!==1||tt!==1}function getCompositeRect(a,o,_e){_e===void 0&&(_e=!1);var tt=isHTMLElement$1(o),rt=isHTMLElement$1(o)&&isElementScaled(o),st=getDocumentElement(o),at=getBoundingClientRect(a,rt,_e),ut={scrollLeft:0,scrollTop:0},s={x:0,y:0};return(tt||!tt&&!_e)&&((getNodeName(o)!=="body"||isScrollParent(st))&&(ut=getNodeScroll(o)),isHTMLElement$1(o)?(s=getBoundingClientRect(o,!0),s.x+=o.clientLeft,s.y+=o.clientTop):st&&(s.x=getWindowScrollBarX(st))),{x:at.left+ut.scrollLeft-s.x,y:at.top+ut.scrollTop-s.y,width:at.width,height:at.height}}function order(a){var o=new Map,_e=new Set,tt=[];a.forEach(function(st){o.set(st.name,st)});function rt(st){_e.add(st.name);var at=[].concat(st.requires||[],st.requiresIfExists||[]);at.forEach(function(ut){if(!_e.has(ut)){var s=o.get(ut);s&&rt(s)}}),tt.push(st)}return a.forEach(function(st){_e.has(st.name)||rt(st)}),tt}function orderModifiers(a){var o=order(a);return modifierPhases.reduce(function(_e,tt){return _e.concat(o.filter(function(rt){return rt.phase===tt}))},[])}function debounce(a){var o;return function(){return o||(o=new Promise(function(_e){Promise.resolve().then(function(){o=void 0,_e(a())})})),o}}function mergeByName(a){var o=a.reduce(function(_e,tt){var rt=_e[tt.name];return _e[tt.name]=rt?Object.assign({},rt,tt,{options:Object.assign({},rt.options,tt.options),data:Object.assign({},rt.data,tt.data)}):tt,_e},{});return Object.keys(o).map(function(_e){return o[_e]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var a=arguments.length,o=new Array(a),_e=0;_e<a;_e++)o[_e]=arguments[_e];return!o.some(function(tt){return!(tt&&typeof tt.getBoundingClientRect=="function")})}function popperGenerator(a){a===void 0&&(a={});var o=a,_e=o.defaultModifiers,tt=_e===void 0?[]:_e,rt=o.defaultOptions,st=rt===void 0?DEFAULT_OPTIONS:rt;return function(ut,s,et){et===void 0&&(et=st);var ot={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,st),modifiersData:{},elements:{reference:ut,popper:s},attributes:{},styles:{}},lt=[],St=!1,pt={state:ot,setOptions:function(it){var ft=typeof it=="function"?it(ot.options):it;ct(),ot.options=Object.assign({},st,ot.options,ft),ot.scrollParents={reference:isElement(ut)?listScrollParents(ut):ut.contextElement?listScrollParents(ut.contextElement):[],popper:listScrollParents(s)};var mt=orderModifiers(mergeByName([].concat(tt,ot.options.modifiers)));return ot.orderedModifiers=mt.filter(function(Tt){return Tt.enabled}),gt(),pt.update()},forceUpdate:function(){if(!St){var it=ot.elements,ft=it.reference,mt=it.popper;if(areValidElements(ft,mt)){ot.rects={reference:getCompositeRect(ft,getOffsetParent(mt),ot.options.strategy==="fixed"),popper:getLayoutRect(mt)},ot.reset=!1,ot.placement=ot.options.placement,ot.orderedModifiers.forEach(function(Mt){return ot.modifiersData[Mt.name]=Object.assign({},Mt.data)});for(var Tt=0;Tt<ot.orderedModifiers.length;Tt++){if(ot.reset===!0){ot.reset=!1,Tt=-1;continue}var It=ot.orderedModifiers[Tt],Pt=It.fn,At=It.options,Nt=At===void 0?{}:At,Ot=It.name;typeof Pt=="function"&&(ot=Pt({state:ot,options:Nt,name:Ot,instance:pt})||ot)}}}},update:debounce(function(){return new Promise(function(ht){pt.forceUpdate(),ht(ot)})}),destroy:function(){ct(),St=!0}};if(!areValidElements(ut,s))return pt;pt.setOptions(et).then(function(ht){!St&&et.onFirstUpdate&&et.onFirstUpdate(ht)});function gt(){ot.orderedModifiers.forEach(function(ht){var it=ht.name,ft=ht.options,mt=ft===void 0?{}:ft,Tt=ht.effect;if(typeof Tt=="function"){var It=Tt({state:ot,name:it,instance:pt,options:mt}),Pt=function(){};lt.push(It||Pt)}})}function ct(){lt.forEach(function(ht){return ht()}),lt=[]}return pt}}var defaultModifiers=[eventListeners,popperOffsets$1,computeStyles$1,applyStyles$1,offset$1,flip$1,preventOverflow$1,arrow$1,hide$1],createPopper=popperGenerator({defaultModifiers});function getContainer$1(a){return typeof a=="function"?a():a}const Portal=reactExports.forwardRef(function(o,_e){const{children:tt,container:rt,disablePortal:st=!1}=o,[at,ut]=reactExports.useState(null),s=useForkRef(reactExports.isValidElement(tt)?tt.ref:null,_e);if(useEnhancedEffect$1(()=>{st||ut(getContainer$1(rt)||document.body)},[rt,st]),useEnhancedEffect$1(()=>{if(at&&!st)return setRef(_e,at),()=>{setRef(_e,null)}},[_e,at,st]),st){if(reactExports.isValidElement(tt)){const et={ref:s};return reactExports.cloneElement(tt,et)}return jsxRuntimeExports.jsx(reactExports.Fragment,{children:tt})}return jsxRuntimeExports.jsx(reactExports.Fragment,{children:at&&reactDomExports.createPortal(tt,at)})});function getPopperUtilityClass(a){return generateUtilityClass("MuiPopper",a)}generateUtilityClasses("MuiPopper",["root"]);const _excluded$z=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],_excluded2$3=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function flipPlacement(a,o){if(o==="ltr")return a;switch(a){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return a}}function resolveAnchorEl$1(a){return typeof a=="function"?a():a}function isHTMLElement(a){return a.nodeType!==void 0}const useUtilityClasses$t=()=>composeClasses({root:["root"]},useClassNamesOverride(getPopperUtilityClass)),defaultPopperOptions={},PopperTooltip=reactExports.forwardRef(function(o,_e){var tt;const{anchorEl:rt,children:st,direction:at,disablePortal:ut,modifiers:s,open:et,placement:ot,popperOptions:lt,popperRef:St,slotProps:pt={},slots:gt={},TransitionProps:ct}=o,ht=_objectWithoutPropertiesLoose(o,_excluded$z),it=reactExports.useRef(null),ft=useForkRef(it,_e),mt=reactExports.useRef(null),Tt=useForkRef(mt,St),It=reactExports.useRef(Tt);useEnhancedEffect$1(()=>{It.current=Tt},[Tt]),reactExports.useImperativeHandle(St,()=>mt.current,[]);const Pt=flipPlacement(ot,at),[At,Nt]=reactExports.useState(Pt),[Ot,Mt]=reactExports.useState(resolveAnchorEl$1(rt));reactExports.useEffect(()=>{mt.current&&mt.current.forceUpdate()}),reactExports.useEffect(()=>{rt&&Mt(resolveAnchorEl$1(rt))},[rt]),useEnhancedEffect$1(()=>{if(!Ot||!et)return;const rn=Ht=>{Nt(Ht.placement)};let gn=[{name:"preventOverflow",options:{altBoundary:ut}},{name:"flip",options:{altBoundary:ut}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Ht})=>{rn(Ht)}}];s!=null&&(gn=gn.concat(s)),lt&&lt.modifiers!=null&&(gn=gn.concat(lt.modifiers));const tn=createPopper(Ot,it.current,_extends({placement:Pt},lt,{modifiers:gn}));return It.current(tn),()=>{tn.destroy(),It.current(null)}},[Ot,ut,s,et,lt,Pt]);const bt={placement:At};ct!==null&&(bt.TransitionProps=ct);const Wt=useUtilityClasses$t(),zt=(tt=gt.root)!=null?tt:"div",Bt=useSlotProps({elementType:zt,externalSlotProps:pt.root,externalForwardedProps:ht,additionalProps:{role:"tooltip",ref:ft},ownerState:o,className:Wt.root});return jsxRuntimeExports.jsx(zt,_extends({},Bt,{children:typeof st=="function"?st(bt):st}))}),Popper$2=reactExports.forwardRef(function(o,_e){const{anchorEl:tt,children:rt,container:st,direction:at="ltr",disablePortal:ut=!1,keepMounted:s=!1,modifiers:et,open:ot,placement:lt="bottom",popperOptions:St=defaultPopperOptions,popperRef:pt,style:gt,transition:ct=!1,slotProps:ht={},slots:it={}}=o,ft=_objectWithoutPropertiesLoose(o,_excluded2$3),[mt,Tt]=reactExports.useState(!0),It=()=>{Tt(!1)},Pt=()=>{Tt(!0)};if(!s&&!ot&&(!ct||mt))return null;let At;if(st)At=st;else if(tt){const Mt=resolveAnchorEl$1(tt);At=Mt&&isHTMLElement(Mt)?ownerDocument(Mt).body:ownerDocument(null).body}const Nt=!ot&&s&&(!ct||mt)?"none":void 0,Ot=ct?{in:ot,onEnter:It,onExited:Pt}:void 0;return jsxRuntimeExports.jsx(Portal,{disablePortal:ut,container:At,children:jsxRuntimeExports.jsx(PopperTooltip,_extends({anchorEl:tt,direction:at,disablePortal:ut,modifiers:et,ref:_e,open:ct?!mt:ot,placement:lt,popperOptions:St,popperRef:pt,slotProps:ht,slots:it},ft,{style:_extends({position:"fixed",top:0,left:0,display:Nt},gt),TransitionProps:Ot,children:rt}))})});function isOverflowing(a){const o=ownerDocument(a);return o.body===a?ownerWindow(a).innerWidth>o.documentElement.clientWidth:a.scrollHeight>a.clientHeight}function ariaHidden(a,o){o?a.setAttribute("aria-hidden","true"):a.removeAttribute("aria-hidden")}function getPaddingRight(a){return parseInt(ownerWindow(a).getComputedStyle(a).paddingRight,10)||0}function isAriaHiddenForbiddenOnElement(a){const _e=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(a.tagName)!==-1,tt=a.tagName==="INPUT"&&a.getAttribute("type")==="hidden";return _e||tt}function ariaHiddenSiblings(a,o,_e,tt,rt){const st=[o,_e,...tt];[].forEach.call(a.children,at=>{const ut=st.indexOf(at)===-1,s=!isAriaHiddenForbiddenOnElement(at);ut&&s&&ariaHidden(at,rt)})}function findIndexOf(a,o){let _e=-1;return a.some((tt,rt)=>o(tt)?(_e=rt,!0):!1),_e}function handleContainer(a,o){const _e=[],tt=a.container;if(!o.disableScrollLock){if(isOverflowing(tt)){const at=getScrollbarSize(ownerDocument(tt));_e.push({value:tt.style.paddingRight,property:"padding-right",el:tt}),tt.style.paddingRight=`${getPaddingRight(tt)+at}px`;const ut=ownerDocument(tt).querySelectorAll(".mui-fixed");[].forEach.call(ut,s=>{_e.push({value:s.style.paddingRight,property:"padding-right",el:s}),s.style.paddingRight=`${getPaddingRight(s)+at}px`})}let st;if(tt.parentNode instanceof DocumentFragment)st=ownerDocument(tt).body;else{const at=tt.parentElement,ut=ownerWindow(tt);st=(at==null?void 0:at.nodeName)==="HTML"&&ut.getComputedStyle(at).overflowY==="scroll"?at:tt}_e.push({value:st.style.overflow,property:"overflow",el:st},{value:st.style.overflowX,property:"overflow-x",el:st},{value:st.style.overflowY,property:"overflow-y",el:st}),st.style.overflow="hidden"}return()=>{_e.forEach(({value:st,el:at,property:ut})=>{st?at.style.setProperty(ut,st):at.style.removeProperty(ut)})}}function getHiddenSiblings(a){const o=[];return[].forEach.call(a.children,_e=>{_e.getAttribute("aria-hidden")==="true"&&o.push(_e)}),o}class ModalManager{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(o,_e){let tt=this.modals.indexOf(o);if(tt!==-1)return tt;tt=this.modals.length,this.modals.push(o),o.modalRef&&ariaHidden(o.modalRef,!1);const rt=getHiddenSiblings(_e);ariaHiddenSiblings(_e,o.mount,o.modalRef,rt,!0);const st=findIndexOf(this.containers,at=>at.container===_e);return st!==-1?(this.containers[st].modals.push(o),tt):(this.containers.push({modals:[o],container:_e,restore:null,hiddenSiblings:rt}),tt)}mount(o,_e){const tt=findIndexOf(this.containers,st=>st.modals.indexOf(o)!==-1),rt=this.containers[tt];rt.restore||(rt.restore=handleContainer(rt,_e))}remove(o,_e=!0){const tt=this.modals.indexOf(o);if(tt===-1)return tt;const rt=findIndexOf(this.containers,at=>at.modals.indexOf(o)!==-1),st=this.containers[rt];if(st.modals.splice(st.modals.indexOf(o),1),this.modals.splice(tt,1),st.modals.length===0)st.restore&&st.restore(),o.modalRef&&ariaHidden(o.modalRef,_e),ariaHiddenSiblings(st.container,o.mount,o.modalRef,st.hiddenSiblings,!1),this.containers.splice(rt,1);else{const at=st.modals[st.modals.length-1];at.modalRef&&ariaHidden(at.modalRef,!1)}return tt}isTopModal(o){return this.modals.length>0&&this.modals[this.modals.length-1]===o}}function getContainer(a){return typeof a=="function"?a():a}function getHasTransition(a){return a?a.props.hasOwnProperty("in"):!1}const defaultManager=new ModalManager;function useModal(a){const{container:o,disableEscapeKeyDown:_e=!1,disableScrollLock:tt=!1,manager:rt=defaultManager,closeAfterTransition:st=!1,onTransitionEnter:at,onTransitionExited:ut,children:s,onClose:et,open:ot,rootRef:lt}=a,St=reactExports.useRef({}),pt=reactExports.useRef(null),gt=reactExports.useRef(null),ct=useForkRef(gt,lt),[ht,it]=reactExports.useState(!ot),ft=getHasTransition(s);let mt=!0;(a["aria-hidden"]==="false"||a["aria-hidden"]===!1)&&(mt=!1);const Tt=()=>ownerDocument(pt.current),It=()=>(St.current.modalRef=gt.current,St.current.mount=pt.current,St.current),Pt=()=>{rt.mount(It(),{disableScrollLock:tt}),gt.current&&(gt.current.scrollTop=0)},At=useEventCallback(()=>{const gn=getContainer(o)||Tt().body;rt.add(It(),gn),gt.current&&Pt()}),Nt=reactExports.useCallback(()=>rt.isTopModal(It()),[rt]),Ot=useEventCallback(gn=>{pt.current=gn,gn&&(ot&&Nt()?Pt():gt.current&&ariaHidden(gt.current,mt))}),Mt=reactExports.useCallback(()=>{rt.remove(It(),mt)},[mt,rt]);reactExports.useEffect(()=>()=>{Mt()},[Mt]),reactExports.useEffect(()=>{ot?At():(!ft||!st)&&Mt()},[ot,Mt,ft,st,At]);const bt=gn=>tn=>{var Ht;(Ht=gn.onKeyDown)==null||Ht.call(gn,tn),!(tn.key!=="Escape"||!Nt())&&(_e||(tn.stopPropagation(),et&&et(tn,"escapeKeyDown")))},Wt=gn=>tn=>{var Ht;(Ht=gn.onClick)==null||Ht.call(gn,tn),tn.target===tn.currentTarget&&et&&et(tn,"backdropClick")};return{getRootProps:(gn={})=>{const tn=extractEventHandlers(a);delete tn.onTransitionEnter,delete tn.onTransitionExited;const Ht=_extends({},tn,gn);return _extends({role:"presentation"},Ht,{onKeyDown:bt(Ht),ref:ct})},getBackdropProps:(gn={})=>{const tn=gn;return _extends({"aria-hidden":!0},tn,{onClick:Wt(tn),open:ot})},getTransitionProps:()=>{const gn=()=>{it(!1),at&&at()},tn=()=>{it(!0),ut&&ut(),st&&Mt()};return{onEnter:createChainedFunction(gn,s==null?void 0:s.props.onEnter),onExited:createChainedFunction(tn,s==null?void 0:s.props.onExited)}},rootRef:ct,portalRef:Ot,isTopModal:Nt,exited:ht,hasTransition:ft}}const _excluded$y=["onChange","maxRows","minRows","style","value"];function getStyleValue(a){return parseInt(a,10)||0}const styles$2={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function isEmpty$1(a){return a==null||Object.keys(a).length===0||a.outerHeightStyle===0&&!a.overflow}const TextareaAutosize=reactExports.forwardRef(function(o,_e){const{onChange:tt,maxRows:rt,minRows:st=1,style:at,value:ut}=o,s=_objectWithoutPropertiesLoose(o,_excluded$y),{current:et}=reactExports.useRef(ut!=null),ot=reactExports.useRef(null),lt=useForkRef(_e,ot),St=reactExports.useRef(null),pt=reactExports.useRef(0),[gt,ct]=reactExports.useState({outerHeightStyle:0}),ht=reactExports.useCallback(()=>{const Tt=ot.current,Pt=ownerWindow(Tt).getComputedStyle(Tt);if(Pt.width==="0px")return{outerHeightStyle:0};const At=St.current;At.style.width=Pt.width,At.value=Tt.value||o.placeholder||"x",At.value.slice(-1)===`
`&&(At.value+=" ");const Nt=Pt.boxSizing,Ot=getStyleValue(Pt.paddingBottom)+getStyleValue(Pt.paddingTop),Mt=getStyleValue(Pt.borderBottomWidth)+getStyleValue(Pt.borderTopWidth),bt=At.scrollHeight;At.value="x";const Wt=At.scrollHeight;let zt=bt;st&&(zt=Math.max(Number(st)*Wt,zt)),rt&&(zt=Math.min(Number(rt)*Wt,zt)),zt=Math.max(zt,Wt);const Bt=zt+(Nt==="border-box"?Ot+Mt:0),rn=Math.abs(zt-bt)<=1;return{outerHeightStyle:Bt,overflow:rn}},[rt,st,o.placeholder]),it=(Tt,It)=>{const{outerHeightStyle:Pt,overflow:At}=It;return pt.current<20&&(Pt>0&&Math.abs((Tt.outerHeightStyle||0)-Pt)>1||Tt.overflow!==At)?(pt.current+=1,{overflow:At,outerHeightStyle:Pt}):Tt},ft=reactExports.useCallback(()=>{const Tt=ht();isEmpty$1(Tt)||ct(It=>it(It,Tt))},[ht]);useEnhancedEffect$1(()=>{const Tt=()=>{const bt=ht();isEmpty$1(bt)||reactDomExports.flushSync(()=>{ct(Wt=>it(Wt,bt))})},It=()=>{pt.current=0,Tt()};let Pt;const At=debounce$1(It),Nt=ot.current,Ot=ownerWindow(Nt);Ot.addEventListener("resize",At);let Mt;return typeof ResizeObserver<"u"&&(Mt=new ResizeObserver(It),Mt.observe(Nt)),()=>{At.clear(),cancelAnimationFrame(Pt),Ot.removeEventListener("resize",At),Mt&&Mt.disconnect()}},[ht]),useEnhancedEffect$1(()=>{ft()}),reactExports.useEffect(()=>{pt.current=0},[ut]);const mt=Tt=>{pt.current=0,et||ft(),tt&&tt(Tt)};return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("textarea",_extends({value:ut,onChange:mt,ref:lt,rows:st,style:_extends({height:gt.outerHeightStyle,overflow:gt.overflow?"hidden":void 0},at)},s)),jsxRuntimeExports.jsx("textarea",{"aria-hidden":!0,className:o.className,readOnly:!0,ref:St,tabIndex:-1,style:_extends({},styles$2.shadow,at,{paddingTop:0,paddingBottom:0})})]})}),reflow=a=>a.scrollTop;function getTransitionProps(a,o){var _e,tt;const{timeout:rt,easing:st,style:at={}}=a;return{duration:(_e=at.transitionDuration)!=null?_e:typeof rt=="number"?rt:rt[o.mode]||0,easing:(tt=at.transitionTimingFunction)!=null?tt:typeof st=="object"?st[o.mode]:st,delay:at.transitionDelay}}const _excluded$x=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function getScale(a){return`scale(${a}, ${a**2})`}const styles$1={entering:{opacity:1,transform:getScale(1)},entered:{opacity:1,transform:"none"}},isWebKit154=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Grow=reactExports.forwardRef(function(o,_e){const{addEndListener:tt,appear:rt=!0,children:st,easing:at,in:ut,onEnter:s,onEntered:et,onEntering:ot,onExit:lt,onExited:St,onExiting:pt,style:gt,timeout:ct="auto",TransitionComponent:ht=Transition$1}=o,it=_objectWithoutPropertiesLoose(o,_excluded$x),ft=reactExports.useRef(),mt=reactExports.useRef(),Tt=useTheme(),It=reactExports.useRef(null),Pt=useForkRef(It,st.ref,_e),At=rn=>gn=>{if(rn){const tn=It.current;gn===void 0?rn(tn):rn(tn,gn)}},Nt=At(ot),Ot=At((rn,gn)=>{reflow(rn);const{duration:tn,delay:Ht,easing:fn}=getTransitionProps({style:gt,timeout:ct,easing:at},{mode:"enter"});let bn;ct==="auto"?(bn=Tt.transitions.getAutoHeightDuration(rn.clientHeight),mt.current=bn):bn=tn,rn.style.transition=[Tt.transitions.create("opacity",{duration:bn,delay:Ht}),Tt.transitions.create("transform",{duration:isWebKit154?bn:bn*.666,delay:Ht,easing:fn})].join(","),s&&s(rn,gn)}),Mt=At(et),bt=At(pt),Wt=At(rn=>{const{duration:gn,delay:tn,easing:Ht}=getTransitionProps({style:gt,timeout:ct,easing:at},{mode:"exit"});let fn;ct==="auto"?(fn=Tt.transitions.getAutoHeightDuration(rn.clientHeight),mt.current=fn):fn=gn,rn.style.transition=[Tt.transitions.create("opacity",{duration:fn,delay:tn}),Tt.transitions.create("transform",{duration:isWebKit154?fn:fn*.666,delay:isWebKit154?tn:tn||fn*.333,easing:Ht})].join(","),rn.style.opacity=0,rn.style.transform=getScale(.75),lt&&lt(rn)}),zt=At(St),Bt=rn=>{ct==="auto"&&(ft.current=setTimeout(rn,mt.current||0)),tt&&tt(It.current,rn)};return reactExports.useEffect(()=>()=>{clearTimeout(ft.current)},[]),jsxRuntimeExports.jsx(ht,_extends({appear:rt,in:ut,nodeRef:It,onEnter:Ot,onEntered:Mt,onEntering:Nt,onExit:Wt,onExited:zt,onExiting:bt,addEndListener:Bt,timeout:ct==="auto"?null:ct},it,{children:(rn,gn)=>reactExports.cloneElement(st,_extends({style:_extends({opacity:0,transform:getScale(.75),visibility:rn==="exited"&&!ut?"hidden":void 0},styles$1[rn],gt,st.props.style),ref:Pt},gn))}))});Grow.muiSupportAuto=!0;const Grow$1=Grow,_excluded$w=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],styles={entering:{opacity:1},entered:{opacity:1}},Fade=reactExports.forwardRef(function(o,_e){const tt=useTheme(),rt={enter:tt.transitions.duration.enteringScreen,exit:tt.transitions.duration.leavingScreen},{addEndListener:st,appear:at=!0,children:ut,easing:s,in:et,onEnter:ot,onEntered:lt,onEntering:St,onExit:pt,onExited:gt,onExiting:ct,style:ht,timeout:it=rt,TransitionComponent:ft=Transition$1}=o,mt=_objectWithoutPropertiesLoose(o,_excluded$w),Tt=reactExports.useRef(null),It=useForkRef(Tt,ut.ref,_e),Pt=Bt=>rn=>{if(Bt){const gn=Tt.current;rn===void 0?Bt(gn):Bt(gn,rn)}},At=Pt(St),Nt=Pt((Bt,rn)=>{reflow(Bt);const gn=getTransitionProps({style:ht,timeout:it,easing:s},{mode:"enter"});Bt.style.webkitTransition=tt.transitions.create("opacity",gn),Bt.style.transition=tt.transitions.create("opacity",gn),ot&&ot(Bt,rn)}),Ot=Pt(lt),Mt=Pt(ct),bt=Pt(Bt=>{const rn=getTransitionProps({style:ht,timeout:it,easing:s},{mode:"exit"});Bt.style.webkitTransition=tt.transitions.create("opacity",rn),Bt.style.transition=tt.transitions.create("opacity",rn),pt&&pt(Bt)}),Wt=Pt(gt),zt=Bt=>{st&&st(Tt.current,Bt)};return jsxRuntimeExports.jsx(ft,_extends({appear:at,in:et,nodeRef:Tt,onEnter:Nt,onEntered:Ot,onEntering:At,onExit:bt,onExited:Wt,onExiting:Mt,addEndListener:zt,timeout:it},mt,{children:(Bt,rn)=>reactExports.cloneElement(ut,_extends({style:_extends({opacity:0,visibility:Bt==="exited"&&!et?"hidden":void 0},styles[Bt],ht,ut.props.style),ref:It},rn))}))}),Fade$1=Fade;function getBackdropUtilityClass(a){return generateUtilityClass("MuiBackdrop",a)}generateUtilityClasses("MuiBackdrop",["root","invisible"]);const _excluded$v=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],useUtilityClasses$s=a=>{const{classes:o,invisible:_e}=a;return composeClasses({root:["root",_e&&"invisible"]},getBackdropUtilityClass,o)},BackdropRoot=styled$1("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.invisible&&o.invisible]}})(({ownerState:a})=>_extends({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},a.invisible&&{backgroundColor:"transparent"})),Backdrop=reactExports.forwardRef(function(o,_e){var tt,rt,st;const at=useThemeProps({props:o,name:"MuiBackdrop"}),{children:ut,className:s,component:et="div",components:ot={},componentsProps:lt={},invisible:St=!1,open:pt,slotProps:gt={},slots:ct={},TransitionComponent:ht=Fade$1,transitionDuration:it}=at,ft=_objectWithoutPropertiesLoose(at,_excluded$v),mt=_extends({},at,{component:et,invisible:St}),Tt=useUtilityClasses$s(mt),It=(tt=gt.root)!=null?tt:lt.root;return jsxRuntimeExports.jsx(ht,_extends({in:pt,timeout:it},ft,{children:jsxRuntimeExports.jsx(BackdropRoot,_extends({"aria-hidden":!0},It,{as:(rt=(st=ct.root)!=null?st:ot.Root)!=null?rt:et,className:clsx(Tt.root,s,It==null?void 0:It.className),ownerState:_extends({},mt,It==null?void 0:It.ownerState),classes:Tt,ref:_e,children:ut}))}))}),Backdrop$1=Backdrop;function getModalUtilityClass(a){return generateUtilityClass("MuiModal",a)}generateUtilityClasses("MuiModal",["root","hidden","backdrop"]);const _excluded$u=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],useUtilityClasses$r=a=>{const{open:o,exited:_e,classes:tt}=a;return composeClasses({root:["root",!o&&_e&&"hidden"],backdrop:["backdrop"]},getModalUtilityClass,tt)},ModalRoot=styled$1("div",{name:"MuiModal",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,!_e.open&&_e.exited&&o.hidden]}})(({theme:a,ownerState:o})=>_extends({position:"fixed",zIndex:(a.vars||a).zIndex.modal,right:0,bottom:0,top:0,left:0},!o.open&&o.exited&&{visibility:"hidden"})),ModalBackdrop=styled$1(Backdrop$1,{name:"MuiModal",slot:"Backdrop",overridesResolver:(a,o)=>o.backdrop})({zIndex:-1}),Modal=reactExports.forwardRef(function(o,_e){var tt,rt,st,at,ut,s;const et=useThemeProps({name:"MuiModal",props:o}),{BackdropComponent:ot=ModalBackdrop,BackdropProps:lt,className:St,closeAfterTransition:pt=!1,children:gt,container:ct,component:ht,components:it={},componentsProps:ft={},disableAutoFocus:mt=!1,disableEnforceFocus:Tt=!1,disableEscapeKeyDown:It=!1,disablePortal:Pt=!1,disableRestoreFocus:At=!1,disableScrollLock:Nt=!1,hideBackdrop:Ot=!1,keepMounted:Mt=!1,onBackdropClick:bt,open:Wt,slotProps:zt,slots:Bt}=et,rn=_objectWithoutPropertiesLoose(et,_excluded$u),gn=_extends({},et,{closeAfterTransition:pt,disableAutoFocus:mt,disableEnforceFocus:Tt,disableEscapeKeyDown:It,disablePortal:Pt,disableRestoreFocus:At,disableScrollLock:Nt,hideBackdrop:Ot,keepMounted:Mt}),{getRootProps:tn,getBackdropProps:Ht,getTransitionProps:fn,portalRef:bn,isTopModal:In,exited:un,hasTransition:mn}=useModal(_extends({},gn,{rootRef:_e})),yn=_extends({},gn,{exited:un}),pn=useUtilityClasses$r(yn),Tn={};if(gt.props.tabIndex===void 0&&(Tn.tabIndex="-1"),mn){const{onEnter:Un,onExited:Qn}=fn();Tn.onEnter=Un,Tn.onExited=Qn}const kn=(tt=(rt=Bt==null?void 0:Bt.root)!=null?rt:it.Root)!=null?tt:ModalRoot,xn=(st=(at=Bt==null?void 0:Bt.backdrop)!=null?at:it.Backdrop)!=null?st:ot,Mn=(ut=zt==null?void 0:zt.root)!=null?ut:ft.root,Dn=(s=zt==null?void 0:zt.backdrop)!=null?s:ft.backdrop,An=useSlotProps({elementType:kn,externalSlotProps:Mn,externalForwardedProps:rn,getSlotProps:tn,additionalProps:{ref:_e,as:ht},ownerState:yn,className:clsx(St,Mn==null?void 0:Mn.className,pn==null?void 0:pn.root,!yn.open&&yn.exited&&(pn==null?void 0:pn.hidden))}),Nn=useSlotProps({elementType:xn,externalSlotProps:Dn,additionalProps:lt,getSlotProps:Un=>Ht(_extends({},Un,{onClick:Qn=>{bt&&bt(Qn),Un!=null&&Un.onClick&&Un.onClick(Qn)}})),className:clsx(Dn==null?void 0:Dn.className,lt==null?void 0:lt.className,pn==null?void 0:pn.backdrop),ownerState:yn});return!Mt&&!Wt&&(!mn||un)?null:jsxRuntimeExports.jsx(Portal,{ref:bn,container:ct,disablePortal:Pt,children:jsxRuntimeExports.jsxs(kn,_extends({},An,{children:[!Ot&&ot?jsxRuntimeExports.jsx(xn,_extends({},Nn)):null,jsxRuntimeExports.jsx(FocusTrap,{disableEnforceFocus:Tt,disableAutoFocus:mt,disableRestoreFocus:At,isEnabled:In,open:Wt,children:reactExports.cloneElement(gt,Tn)})]}))})}),Modal$1=Modal,getOverlayAlpha=a=>{let o;return a<1?o=5.11916*a**2:o=4.5*Math.log(a+1)+2,(o/100).toFixed(2)},getOverlayAlpha$1=getOverlayAlpha;function getPaperUtilityClass(a){return generateUtilityClass("MuiPaper",a)}generateUtilityClasses("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const _excluded$t=["className","component","elevation","square","variant"],useUtilityClasses$q=a=>{const{square:o,elevation:_e,variant:tt,classes:rt}=a,st={root:["root",tt,!o&&"rounded",tt==="elevation"&&`elevation${_e}`]};return composeClasses(st,getPaperUtilityClass,rt)},PaperRoot=styled$1("div",{name:"MuiPaper",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],!_e.square&&o.rounded,_e.variant==="elevation"&&o[`elevation${_e.elevation}`]]}})(({theme:a,ownerState:o})=>{var _e;return _extends({backgroundColor:(a.vars||a).palette.background.paper,color:(a.vars||a).palette.text.primary,transition:a.transitions.create("box-shadow")},!o.square&&{borderRadius:a.shape.borderRadius},o.variant==="outlined"&&{border:`1px solid ${(a.vars||a).palette.divider}`},o.variant==="elevation"&&_extends({boxShadow:(a.vars||a).shadows[o.elevation]},!a.vars&&a.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${alpha("#fff",getOverlayAlpha$1(o.elevation))}, ${alpha("#fff",getOverlayAlpha$1(o.elevation))})`},a.vars&&{backgroundImage:(_e=a.vars.overlays)==null?void 0:_e[o.elevation]}))}),Paper=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiPaper"}),{className:rt,component:st="div",elevation:at=1,square:ut=!1,variant:s="elevation"}=tt,et=_objectWithoutPropertiesLoose(tt,_excluded$t),ot=_extends({},tt,{component:st,elevation:at,square:ut,variant:s}),lt=useUtilityClasses$q(ot);return jsxRuntimeExports.jsx(PaperRoot,_extends({as:st,ownerState:ot,className:clsx(lt.root,rt),ref:_e},et))}),Paper$1=Paper;function getPopoverUtilityClass(a){return generateUtilityClass("MuiPopover",a)}generateUtilityClasses("MuiPopover",["root","paper"]);const _excluded$s=["onEntering"],_excluded2$2=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],_excluded3=["slotProps"];function getOffsetTop(a,o){let _e=0;return typeof o=="number"?_e=o:o==="center"?_e=a.height/2:o==="bottom"&&(_e=a.height),_e}function getOffsetLeft(a,o){let _e=0;return typeof o=="number"?_e=o:o==="center"?_e=a.width/2:o==="right"&&(_e=a.width),_e}function getTransformOriginValue(a){return[a.horizontal,a.vertical].map(o=>typeof o=="number"?`${o}px`:o).join(" ")}function resolveAnchorEl(a){return typeof a=="function"?a():a}const useUtilityClasses$p=a=>{const{classes:o}=a;return composeClasses({root:["root"],paper:["paper"]},getPopoverUtilityClass,o)},PopoverRoot=styled$1(Modal$1,{name:"MuiPopover",slot:"Root",overridesResolver:(a,o)=>o.root})({}),PopoverPaper=styled$1(Paper$1,{name:"MuiPopover",slot:"Paper",overridesResolver:(a,o)=>o.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Popover=reactExports.forwardRef(function(o,_e){var tt,rt,st;const at=useThemeProps({props:o,name:"MuiPopover"}),{action:ut,anchorEl:s,anchorOrigin:et={vertical:"top",horizontal:"left"},anchorPosition:ot,anchorReference:lt="anchorEl",children:St,className:pt,container:gt,elevation:ct=8,marginThreshold:ht=16,open:it,PaperProps:ft={},slots:mt,slotProps:Tt,transformOrigin:It={vertical:"top",horizontal:"left"},TransitionComponent:Pt=Grow$1,transitionDuration:At="auto",TransitionProps:{onEntering:Nt}={},disableScrollLock:Ot=!1}=at,Mt=_objectWithoutPropertiesLoose(at.TransitionProps,_excluded$s),bt=_objectWithoutPropertiesLoose(at,_excluded2$2),Wt=(tt=Tt==null?void 0:Tt.paper)!=null?tt:ft,zt=reactExports.useRef(),Bt=useForkRef(zt,Wt.ref),rn=_extends({},at,{anchorOrigin:et,anchorReference:lt,elevation:ct,marginThreshold:ht,externalPaperSlotProps:Wt,transformOrigin:It,TransitionComponent:Pt,transitionDuration:At,TransitionProps:Mt}),gn=useUtilityClasses$p(rn),tn=reactExports.useCallback(()=>{if(lt==="anchorPosition")return ot;const Un=resolveAnchorEl(s),er=(Un&&Un.nodeType===1?Un:ownerDocument(zt.current).body).getBoundingClientRect();return{top:er.top+getOffsetTop(er,et.vertical),left:er.left+getOffsetLeft(er,et.horizontal)}},[s,et.horizontal,et.vertical,ot,lt]),Ht=reactExports.useCallback(Un=>({vertical:getOffsetTop(Un,It.vertical),horizontal:getOffsetLeft(Un,It.horizontal)}),[It.horizontal,It.vertical]),fn=reactExports.useCallback(Un=>{const Qn={width:Un.offsetWidth,height:Un.offsetHeight},er=Ht(Qn);if(lt==="none")return{top:null,left:null,transformOrigin:getTransformOriginValue(er)};const zn=tn();let lr=zn.top-er.vertical,cn=zn.left-er.horizontal;const Gn=lr+Qn.height,Yn=cn+Qn.width,or=ownerWindow(resolveAnchorEl(s)),Bn=or.innerHeight-ht,rr=or.innerWidth-ht;if(ht!==null&&lr<ht){const Zn=lr-ht;lr-=Zn,er.vertical+=Zn}else if(ht!==null&&Gn>Bn){const Zn=Gn-Bn;lr-=Zn,er.vertical+=Zn}if(ht!==null&&cn<ht){const Zn=cn-ht;cn-=Zn,er.horizontal+=Zn}else if(Yn>rr){const Zn=Yn-rr;cn-=Zn,er.horizontal+=Zn}return{top:`${Math.round(lr)}px`,left:`${Math.round(cn)}px`,transformOrigin:getTransformOriginValue(er)}},[s,lt,tn,Ht,ht]),[bn,In]=reactExports.useState(it),un=reactExports.useCallback(()=>{const Un=zt.current;if(!Un)return;const Qn=fn(Un);Qn.top!==null&&(Un.style.top=Qn.top),Qn.left!==null&&(Un.style.left=Qn.left),Un.style.transformOrigin=Qn.transformOrigin,In(!0)},[fn]);reactExports.useEffect(()=>(Ot&&window.addEventListener("scroll",un),()=>window.removeEventListener("scroll",un)),[s,Ot,un]);const mn=(Un,Qn)=>{Nt&&Nt(Un,Qn),un()},yn=()=>{In(!1)};reactExports.useEffect(()=>{it&&un()}),reactExports.useImperativeHandle(ut,()=>it?{updatePosition:()=>{un()}}:null,[it,un]),reactExports.useEffect(()=>{if(!it)return;const Un=debounce$1(()=>{un()}),Qn=ownerWindow(s);return Qn.addEventListener("resize",Un),()=>{Un.clear(),Qn.removeEventListener("resize",Un)}},[s,it,un]);let pn=At;At==="auto"&&!Pt.muiSupportAuto&&(pn=void 0);const Tn=gt||(s?ownerDocument(resolveAnchorEl(s)).body:void 0),kn=(rt=mt==null?void 0:mt.root)!=null?rt:PopoverRoot,xn=(st=mt==null?void 0:mt.paper)!=null?st:PopoverPaper,Mn=useSlotProps({elementType:xn,externalSlotProps:_extends({},Wt,{style:bn?Wt.style:_extends({},Wt.style,{opacity:0})}),additionalProps:{elevation:ct,ref:Bt},ownerState:rn,className:clsx(gn.paper,Wt==null?void 0:Wt.className)}),Dn=useSlotProps({elementType:kn,externalSlotProps:(Tt==null?void 0:Tt.root)||{},externalForwardedProps:bt,additionalProps:{ref:_e,slotProps:{backdrop:{invisible:!0}},container:Tn,open:it},ownerState:rn,className:clsx(gn.root,pt)}),{slotProps:An}=Dn,Nn=_objectWithoutPropertiesLoose(Dn,_excluded3);return jsxRuntimeExports.jsx(kn,_extends({},Nn,!isHostComponent(kn)&&{slotProps:An,disableScrollLock:Ot},{children:jsxRuntimeExports.jsx(Pt,_extends({appear:!0,in:it,onEntering:mn,onExited:yn,timeout:pn},Mt,{children:jsxRuntimeExports.jsx(xn,_extends({},Mn,{children:St}))}))}))}),Popover$1=Popover;function getMenuUtilityClass(a){return generateUtilityClass("MuiMenu",a)}generateUtilityClasses("MuiMenu",["root","paper","list"]);const _excluded$r=["onEntering"],_excluded2$1=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],RTL_ORIGIN={vertical:"top",horizontal:"right"},LTR_ORIGIN={vertical:"top",horizontal:"left"},useUtilityClasses$o=a=>{const{classes:o}=a;return composeClasses({root:["root"],paper:["paper"],list:["list"]},getMenuUtilityClass,o)},MenuRoot=styled$1(Popover$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(a,o)=>o.root})({}),MenuPaper=styled$1(PopoverPaper,{name:"MuiMenu",slot:"Paper",overridesResolver:(a,o)=>o.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),MenuMenuList=styled$1(MenuList$1,{name:"MuiMenu",slot:"List",overridesResolver:(a,o)=>o.list})({outline:0}),Menu=reactExports.forwardRef(function(o,_e){var tt,rt;const st=useThemeProps({props:o,name:"MuiMenu"}),{autoFocus:at=!0,children:ut,className:s,disableAutoFocusItem:et=!1,MenuListProps:ot={},onClose:lt,open:St,PaperProps:pt={},PopoverClasses:gt,transitionDuration:ct="auto",TransitionProps:{onEntering:ht}={},variant:it="selectedMenu",slots:ft={},slotProps:mt={}}=st,Tt=_objectWithoutPropertiesLoose(st.TransitionProps,_excluded$r),It=_objectWithoutPropertiesLoose(st,_excluded2$1),Pt=useTheme(),At=Pt.direction==="rtl",Nt=_extends({},st,{autoFocus:at,disableAutoFocusItem:et,MenuListProps:ot,onEntering:ht,PaperProps:pt,transitionDuration:ct,TransitionProps:Tt,variant:it}),Ot=useUtilityClasses$o(Nt),Mt=at&&!et&&St,bt=reactExports.useRef(null),Wt=(fn,bn)=>{bt.current&&bt.current.adjustStyleForScrollbar(fn,Pt),ht&&ht(fn,bn)},zt=fn=>{fn.key==="Tab"&&(fn.preventDefault(),lt&&lt(fn,"tabKeyDown"))};let Bt=-1;reactExports.Children.map(ut,(fn,bn)=>{reactExports.isValidElement(fn)&&(fn.props.disabled||(it==="selectedMenu"&&fn.props.selected||Bt===-1)&&(Bt=bn))});const rn=(tt=ft.paper)!=null?tt:MenuPaper,gn=(rt=mt.paper)!=null?rt:pt,tn=useSlotProps({elementType:ft.root,externalSlotProps:mt.root,ownerState:Nt,className:[Ot.root,s]}),Ht=useSlotProps({elementType:rn,externalSlotProps:gn,ownerState:Nt,className:Ot.paper});return jsxRuntimeExports.jsx(MenuRoot,_extends({onClose:lt,anchorOrigin:{vertical:"bottom",horizontal:At?"right":"left"},transformOrigin:At?RTL_ORIGIN:LTR_ORIGIN,slots:{paper:rn,root:ft.root},slotProps:{root:tn,paper:Ht},open:St,ref:_e,transitionDuration:ct,TransitionProps:_extends({onEntering:Wt},Tt),ownerState:Nt},It,{classes:gt,children:jsxRuntimeExports.jsx(MenuMenuList,_extends({onKeyDown:zt,actions:bt,autoFocus:at&&(Bt===-1||et),autoFocusItem:Mt,variant:it},ot,{className:clsx(Ot.list,ot.className),children:ut}))}))}),Menu$1=Menu;function getNativeSelectUtilityClasses(a){return generateUtilityClass("MuiNativeSelect",a)}const nativeSelectClasses=generateUtilityClasses("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),nativeSelectClasses$1=nativeSelectClasses,_excluded$q=["className","disabled","error","IconComponent","inputRef","variant"],useUtilityClasses$n=a=>{const{classes:o,variant:_e,disabled:tt,multiple:rt,open:st,error:at}=a,ut={select:["select",_e,tt&&"disabled",rt&&"multiple",at&&"error"],icon:["icon",`icon${capitalize(_e)}`,st&&"iconOpen",tt&&"disabled"]};return composeClasses(ut,getNativeSelectUtilityClasses,o)},nativeSelectSelectStyles=({ownerState:a,theme:o})=>_extends({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":_extends({},o.vars?{backgroundColor:`rgba(${o.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:o.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${nativeSelectClasses$1.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(o.vars||o).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},a.variant==="filled"&&{"&&&":{paddingRight:32}},a.variant==="outlined"&&{borderRadius:(o.vars||o).shape.borderRadius,"&:focus":{borderRadius:(o.vars||o).shape.borderRadius},"&&&":{paddingRight:32}}),NativeSelectSelect=styled$1("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:rootShouldForwardProp,overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.select,o[_e.variant],_e.error&&o.error,{[`&.${nativeSelectClasses$1.multiple}`]:o.multiple}]}})(nativeSelectSelectStyles),nativeSelectIconStyles=({ownerState:a,theme:o})=>_extends({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(o.vars||o).palette.action.active,[`&.${nativeSelectClasses$1.disabled}`]:{color:(o.vars||o).palette.action.disabled}},a.open&&{transform:"rotate(180deg)"},a.variant==="filled"&&{right:7},a.variant==="outlined"&&{right:7}),NativeSelectIcon=styled$1("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.icon,_e.variant&&o[`icon${capitalize(_e.variant)}`],_e.open&&o.iconOpen]}})(nativeSelectIconStyles),NativeSelectInput=reactExports.forwardRef(function(o,_e){const{className:tt,disabled:rt,error:st,IconComponent:at,inputRef:ut,variant:s="standard"}=o,et=_objectWithoutPropertiesLoose(o,_excluded$q),ot=_extends({},o,{disabled:rt,variant:s,error:st}),lt=useUtilityClasses$n(ot);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(NativeSelectSelect,_extends({ownerState:ot,className:clsx(lt.select,tt),disabled:rt,ref:ut||_e},et)),o.multiple?null:jsxRuntimeExports.jsx(NativeSelectIcon,{as:at,ownerState:ot,className:lt.icon})]})}),NativeSelectInput$1=NativeSelectInput;function hasValue(a){return a!=null&&!(Array.isArray(a)&&a.length===0)}function isFilled(a,o=!1){return a&&(hasValue(a.value)&&a.value!==""||o&&hasValue(a.defaultValue)&&a.defaultValue!=="")}function getSelectUtilityClasses(a){return generateUtilityClass("MuiSelect",a)}const selectClasses=generateUtilityClasses("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),selectClasses$1=selectClasses;var _span$1;const _excluded$p=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],SelectSelect=styled$1("div",{name:"MuiSelect",slot:"Select",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[{[`&.${selectClasses$1.select}`]:o.select},{[`&.${selectClasses$1.select}`]:o[_e.variant]},{[`&.${selectClasses$1.error}`]:o.error},{[`&.${selectClasses$1.multiple}`]:o.multiple}]}})(nativeSelectSelectStyles,{[`&.${selectClasses$1.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),SelectIcon=styled$1("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.icon,_e.variant&&o[`icon${capitalize(_e.variant)}`],_e.open&&o.iconOpen]}})(nativeSelectIconStyles),SelectNativeInput=styled$1("input",{shouldForwardProp:a=>slotShouldForwardProp(a)&&a!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(a,o)=>o.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function areEqualValues(a,o){return typeof o=="object"&&o!==null?a===o:String(a)===String(o)}function isEmpty(a){return a==null||typeof a=="string"&&!a.trim()}const useUtilityClasses$m=a=>{const{classes:o,variant:_e,disabled:tt,multiple:rt,open:st,error:at}=a,ut={select:["select",_e,tt&&"disabled",rt&&"multiple",at&&"error"],icon:["icon",`icon${capitalize(_e)}`,st&&"iconOpen",tt&&"disabled"],nativeInput:["nativeInput"]};return composeClasses(ut,getSelectUtilityClasses,o)},SelectInput=reactExports.forwardRef(function(o,_e){var tt;const{"aria-describedby":rt,"aria-label":st,autoFocus:at,autoWidth:ut,children:s,className:et,defaultOpen:ot,defaultValue:lt,disabled:St,displayEmpty:pt,error:gt=!1,IconComponent:ct,inputRef:ht,labelId:it,MenuProps:ft={},multiple:mt,name:Tt,onBlur:It,onChange:Pt,onClose:At,onFocus:Nt,onOpen:Ot,open:Mt,readOnly:bt,renderValue:Wt,SelectDisplayProps:zt={},tabIndex:Bt,value:rn,variant:gn="standard"}=o,tn=_objectWithoutPropertiesLoose(o,_excluded$p),[Ht,fn]=useControlled({controlled:rn,default:lt,name:"Select"}),[bn,In]=useControlled({controlled:Mt,default:ot,name:"Select"}),un=reactExports.useRef(null),mn=reactExports.useRef(null),[yn,pn]=reactExports.useState(null),{current:Tn}=reactExports.useRef(Mt!=null),[kn,xn]=reactExports.useState(),Mn=useForkRef(_e,ht),Dn=reactExports.useCallback(yt=>{mn.current=yt,yt&&pn(yt)},[]),An=yn==null?void 0:yn.parentNode;reactExports.useImperativeHandle(Mn,()=>({focus:()=>{mn.current.focus()},node:un.current,value:Ht}),[Ht]),reactExports.useEffect(()=>{ot&&bn&&yn&&!Tn&&(xn(ut?null:An.clientWidth),mn.current.focus())},[yn,ut]),reactExports.useEffect(()=>{at&&mn.current.focus()},[at]),reactExports.useEffect(()=>{if(!it)return;const yt=ownerDocument(mn.current).getElementById(it);if(yt){const xt=()=>{getSelection().isCollapsed&&mn.current.focus()};return yt.addEventListener("click",xt),()=>{yt.removeEventListener("click",xt)}}},[it]);const Nn=(yt,xt)=>{yt?Ot&&Ot(xt):At&&At(xt),Tn||(xn(ut?null:An.clientWidth),In(yt))},Un=yt=>{yt.button===0&&(yt.preventDefault(),mn.current.focus(),Nn(!0,yt))},Qn=yt=>{Nn(!1,yt)},er=reactExports.Children.toArray(s),zn=yt=>{const xt=er.find(wt=>wt.props.value===yt.target.value);xt!==void 0&&(fn(xt.props.value),Pt&&Pt(yt,xt))},lr=yt=>xt=>{let wt;if(xt.currentTarget.hasAttribute("tabindex")){if(mt){wt=Array.isArray(Ht)?Ht.slice():[];const Lt=Ht.indexOf(yt.props.value);Lt===-1?wt.push(yt.props.value):wt.splice(Lt,1)}else wt=yt.props.value;if(yt.props.onClick&&yt.props.onClick(xt),Ht!==wt&&(fn(wt),Pt)){const Lt=xt.nativeEvent||xt,Et=new Lt.constructor(Lt.type,Lt);Object.defineProperty(Et,"target",{writable:!0,value:{value:wt,name:Tt}}),Pt(Et,yt)}mt||Nn(!1,xt)}},cn=yt=>{bt||[" ","ArrowUp","ArrowDown","Enter"].indexOf(yt.key)!==-1&&(yt.preventDefault(),Nn(!0,yt))},Gn=yn!==null&&bn,Yn=yt=>{!Gn&&It&&(Object.defineProperty(yt,"target",{writable:!0,value:{value:Ht,name:Tt}}),It(yt))};delete tn["aria-invalid"];let or,Bn;const rr=[];let Zn=!1;(isFilled({value:Ht})||pt)&&(Wt?or=Wt(Ht):Zn=!0);const _n=er.map(yt=>{if(!reactExports.isValidElement(yt))return null;let xt;if(mt){if(!Array.isArray(Ht))throw new Error(formatMuiErrorMessage(2));xt=Ht.some(wt=>areEqualValues(wt,yt.props.value)),xt&&Zn&&rr.push(yt.props.children)}else xt=areEqualValues(Ht,yt.props.value),xt&&Zn&&(Bn=yt.props.children);return reactExports.cloneElement(yt,{"aria-selected":xt?"true":"false",onClick:lr(yt),onKeyUp:wt=>{wt.key===" "&&wt.preventDefault(),yt.props.onKeyUp&&yt.props.onKeyUp(wt)},role:"option",selected:xt,value:void 0,"data-value":yt.props.value})});Zn&&(mt?rr.length===0?or=null:or=rr.reduce((yt,xt,wt)=>(yt.push(xt),wt<rr.length-1&&yt.push(", "),yt),[]):or=Bn);let Ln=kn;!ut&&Tn&&yn&&(Ln=An.clientWidth);let vn;typeof Bt<"u"?vn=Bt:vn=St?null:0;const On=zt.id||(Tt?`mui-component-select-${Tt}`:void 0),Kt=_extends({},o,{variant:gn,value:Ht,open:Gn,error:gt}),Rt=useUtilityClasses$m(Kt),nt=_extends({},ft.PaperProps,(tt=ft.slotProps)==null?void 0:tt.paper),Ct=useId();return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(SelectSelect,_extends({ref:Dn,tabIndex:vn,role:"combobox","aria-controls":Ct,"aria-disabled":St?"true":void 0,"aria-expanded":Gn?"true":"false","aria-haspopup":"listbox","aria-label":st,"aria-labelledby":[it,On].filter(Boolean).join(" ")||void 0,"aria-describedby":rt,onKeyDown:cn,onMouseDown:St||bt?null:Un,onBlur:Yn,onFocus:Nt},zt,{ownerState:Kt,className:clsx(zt.className,Rt.select,et),id:On,children:isEmpty(or)?_span$1||(_span$1=jsxRuntimeExports.jsx("span",{className:"notranslate",children:"​"})):or})),jsxRuntimeExports.jsx(SelectNativeInput,_extends({"aria-invalid":gt,value:Array.isArray(Ht)?Ht.join(","):Ht,name:Tt,ref:un,"aria-hidden":!0,onChange:zn,tabIndex:-1,disabled:St,className:Rt.nativeInput,autoFocus:at,ownerState:Kt},tn)),jsxRuntimeExports.jsx(SelectIcon,{as:ct,className:Rt.icon,ownerState:Kt}),jsxRuntimeExports.jsx(Menu$1,_extends({id:`menu-${Tt||""}`,anchorEl:An,open:Gn,onClose:Qn,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},ft,{MenuListProps:_extends({"aria-labelledby":it,role:"listbox","aria-multiselectable":mt?"true":void 0,disableListWrap:!0,id:Ct},ft.MenuListProps),slotProps:_extends({},ft.slotProps,{paper:_extends({},nt,{style:_extends({minWidth:Ln},nt!=null?nt.style:null)})}),children:_n}))]})}),SelectInput$1=SelectInput;function formControlState({props:a,states:o,muiFormControl:_e}){return o.reduce((tt,rt)=>(tt[rt]=a[rt],_e&&typeof a[rt]>"u"&&(tt[rt]=_e[rt]),tt),{})}const FormControlContext=reactExports.createContext(void 0),FormControlContext$1=FormControlContext;function useFormControl(){return reactExports.useContext(FormControlContext$1)}function getSvgIconUtilityClass(a){return generateUtilityClass("MuiSvgIcon",a)}generateUtilityClasses("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _excluded$o=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],useUtilityClasses$l=a=>{const{color:o,fontSize:_e,classes:tt}=a,rt={root:["root",o!=="inherit"&&`color${capitalize(o)}`,`fontSize${capitalize(_e)}`]};return composeClasses(rt,getSvgIconUtilityClass,tt)},SvgIconRoot=styled$1("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.color!=="inherit"&&o[`color${capitalize(_e.color)}`],o[`fontSize${capitalize(_e.fontSize)}`]]}})(({theme:a,ownerState:o})=>{var _e,tt,rt,st,at,ut,s,et,ot,lt,St,pt,gt;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:o.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(_e=a.transitions)==null||(tt=_e.create)==null?void 0:tt.call(_e,"fill",{duration:(rt=a.transitions)==null||(rt=rt.duration)==null?void 0:rt.shorter}),fontSize:{inherit:"inherit",small:((st=a.typography)==null||(at=st.pxToRem)==null?void 0:at.call(st,20))||"1.25rem",medium:((ut=a.typography)==null||(s=ut.pxToRem)==null?void 0:s.call(ut,24))||"1.5rem",large:((et=a.typography)==null||(ot=et.pxToRem)==null?void 0:ot.call(et,35))||"2.1875rem"}[o.fontSize],color:(lt=(St=(a.vars||a).palette)==null||(St=St[o.color])==null?void 0:St.main)!=null?lt:{action:(pt=(a.vars||a).palette)==null||(pt=pt.action)==null?void 0:pt.active,disabled:(gt=(a.vars||a).palette)==null||(gt=gt.action)==null?void 0:gt.disabled,inherit:void 0}[o.color]}}),SvgIcon=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiSvgIcon"}),{children:rt,className:st,color:at="inherit",component:ut="svg",fontSize:s="medium",htmlColor:et,inheritViewBox:ot=!1,titleAccess:lt,viewBox:St="0 0 24 24"}=tt,pt=_objectWithoutPropertiesLoose(tt,_excluded$o),gt=reactExports.isValidElement(rt)&&rt.type==="svg",ct=_extends({},tt,{color:at,component:ut,fontSize:s,instanceFontSize:o.fontSize,inheritViewBox:ot,viewBox:St,hasSvgAsChild:gt}),ht={};ot||(ht.viewBox=St);const it=useUtilityClasses$l(ct);return jsxRuntimeExports.jsxs(SvgIconRoot,_extends({as:ut,className:clsx(it.root,st),focusable:"false",color:et,"aria-hidden":lt?void 0:!0,role:lt?"img":void 0,ref:_e},ht,pt,gt&&rt.props,{ownerState:ct,children:[gt?rt.props.children:rt,lt?jsxRuntimeExports.jsx("title",{children:lt}):null]}))});SvgIcon.muiName="SvgIcon";const SvgIcon$1=SvgIcon;function createSvgIcon(a,o){function _e(tt,rt){return jsxRuntimeExports.jsx(SvgIcon$1,_extends({"data-testid":`${o}Icon`,ref:rt},tt,{children:a}))}return _e.muiName=SvgIcon$1.muiName,reactExports.memo(reactExports.forwardRef(_e))}const ArrowDropDownIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown");function GlobalStyles(a){return jsxRuntimeExports.jsx(GlobalStyles$1,_extends({},a,{defaultTheme:defaultTheme$2,themeId:THEME_ID}))}function getInputBaseUtilityClass(a){return generateUtilityClass("MuiInputBase",a)}const inputBaseClasses=generateUtilityClasses("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),inputBaseClasses$1=inputBaseClasses,_excluded$n=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],rootOverridesResolver=(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.formControl&&o.formControl,_e.startAdornment&&o.adornedStart,_e.endAdornment&&o.adornedEnd,_e.error&&o.error,_e.size==="small"&&o.sizeSmall,_e.multiline&&o.multiline,_e.color&&o[`color${capitalize(_e.color)}`],_e.fullWidth&&o.fullWidth,_e.hiddenLabel&&o.hiddenLabel]},inputOverridesResolver=(a,o)=>{const{ownerState:_e}=a;return[o.input,_e.size==="small"&&o.inputSizeSmall,_e.multiline&&o.inputMultiline,_e.type==="search"&&o.inputTypeSearch,_e.startAdornment&&o.inputAdornedStart,_e.endAdornment&&o.inputAdornedEnd,_e.hiddenLabel&&o.inputHiddenLabel]},useUtilityClasses$k=a=>{const{classes:o,color:_e,disabled:tt,error:rt,endAdornment:st,focused:at,formControl:ut,fullWidth:s,hiddenLabel:et,multiline:ot,readOnly:lt,size:St,startAdornment:pt,type:gt}=a,ct={root:["root",`color${capitalize(_e)}`,tt&&"disabled",rt&&"error",s&&"fullWidth",at&&"focused",ut&&"formControl",St&&St!=="medium"&&`size${capitalize(St)}`,ot&&"multiline",pt&&"adornedStart",st&&"adornedEnd",et&&"hiddenLabel",lt&&"readOnly"],input:["input",tt&&"disabled",gt==="search"&&"inputTypeSearch",ot&&"inputMultiline",St==="small"&&"inputSizeSmall",et&&"inputHiddenLabel",pt&&"inputAdornedStart",st&&"inputAdornedEnd",lt&&"readOnly"]};return composeClasses(ct,getInputBaseUtilityClass,o)},InputBaseRoot=styled$1("div",{name:"MuiInputBase",slot:"Root",overridesResolver:rootOverridesResolver})(({theme:a,ownerState:o})=>_extends({},a.typography.body1,{color:(a.vars||a).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${inputBaseClasses$1.disabled}`]:{color:(a.vars||a).palette.text.disabled,cursor:"default"}},o.multiline&&_extends({padding:"4px 0 5px"},o.size==="small"&&{paddingTop:1}),o.fullWidth&&{width:"100%"})),InputBaseComponent=styled$1("input",{name:"MuiInputBase",slot:"Input",overridesResolver:inputOverridesResolver})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light",tt=_extends({color:"currentColor"},a.vars?{opacity:a.vars.opacity.inputPlaceholder}:{opacity:_e?.42:.5},{transition:a.transitions.create("opacity",{duration:a.transitions.duration.shorter})}),rt={opacity:"0 !important"},st=a.vars?{opacity:a.vars.opacity.inputPlaceholder}:{opacity:_e?.42:.5};return _extends({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":tt,"&::-moz-placeholder":tt,"&:-ms-input-placeholder":tt,"&::-ms-input-placeholder":tt,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${inputBaseClasses$1.formControl} &`]:{"&::-webkit-input-placeholder":rt,"&::-moz-placeholder":rt,"&:-ms-input-placeholder":rt,"&::-ms-input-placeholder":rt,"&:focus::-webkit-input-placeholder":st,"&:focus::-moz-placeholder":st,"&:focus:-ms-input-placeholder":st,"&:focus::-ms-input-placeholder":st},[`&.${inputBaseClasses$1.disabled}`]:{opacity:1,WebkitTextFillColor:(a.vars||a).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},o.size==="small"&&{paddingTop:1},o.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},o.type==="search"&&{MozAppearance:"textfield"})}),inputGlobalStyles=jsxRuntimeExports.jsx(GlobalStyles,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),InputBase=reactExports.forwardRef(function(o,_e){var tt;const rt=useThemeProps({props:o,name:"MuiInputBase"}),{"aria-describedby":st,autoComplete:at,autoFocus:ut,className:s,components:et={},componentsProps:ot={},defaultValue:lt,disabled:St,disableInjectingGlobalStyles:pt,endAdornment:gt,fullWidth:ct=!1,id:ht,inputComponent:it="input",inputProps:ft={},inputRef:mt,maxRows:Tt,minRows:It,multiline:Pt=!1,name:At,onBlur:Nt,onChange:Ot,onClick:Mt,onFocus:bt,onKeyDown:Wt,onKeyUp:zt,placeholder:Bt,readOnly:rn,renderSuffix:gn,rows:tn,slotProps:Ht={},slots:fn={},startAdornment:bn,type:In="text",value:un}=rt,mn=_objectWithoutPropertiesLoose(rt,_excluded$n),yn=ft.value!=null?ft.value:un,{current:pn}=reactExports.useRef(yn!=null),Tn=reactExports.useRef(),kn=reactExports.useCallback(On=>{},[]),xn=useForkRef(Tn,mt,ft.ref,kn),[Mn,Dn]=reactExports.useState(!1),An=useFormControl(),Nn=formControlState({props:rt,muiFormControl:An,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Nn.focused=An?An.focused:Mn,reactExports.useEffect(()=>{!An&&St&&Mn&&(Dn(!1),Nt&&Nt())},[An,St,Mn,Nt]);const Un=An&&An.onFilled,Qn=An&&An.onEmpty,er=reactExports.useCallback(On=>{isFilled(On)?Un&&Un():Qn&&Qn()},[Un,Qn]);useEnhancedEffect$1(()=>{pn&&er({value:yn})},[yn,er,pn]);const zn=On=>{if(Nn.disabled){On.stopPropagation();return}bt&&bt(On),ft.onFocus&&ft.onFocus(On),An&&An.onFocus?An.onFocus(On):Dn(!0)},lr=On=>{Nt&&Nt(On),ft.onBlur&&ft.onBlur(On),An&&An.onBlur?An.onBlur(On):Dn(!1)},cn=(On,...Kt)=>{if(!pn){const Rt=On.target||Tn.current;if(Rt==null)throw new Error(formatMuiErrorMessage(1));er({value:Rt.value})}ft.onChange&&ft.onChange(On,...Kt),Ot&&Ot(On,...Kt)};reactExports.useEffect(()=>{er(Tn.current)},[]);const Gn=On=>{Tn.current&&On.currentTarget===On.target&&Tn.current.focus(),Mt&&Mt(On)};let Yn=it,or=ft;Pt&&Yn==="input"&&(tn?or=_extends({type:void 0,minRows:tn,maxRows:tn},or):or=_extends({type:void 0,maxRows:Tt,minRows:It},or),Yn=TextareaAutosize);const Bn=On=>{er(On.animationName==="mui-auto-fill-cancel"?Tn.current:{value:"x"})};reactExports.useEffect(()=>{An&&An.setAdornedStart(!!bn)},[An,bn]);const rr=_extends({},rt,{color:Nn.color||"primary",disabled:Nn.disabled,endAdornment:gt,error:Nn.error,focused:Nn.focused,formControl:An,fullWidth:ct,hiddenLabel:Nn.hiddenLabel,multiline:Pt,size:Nn.size,startAdornment:bn,type:In}),Zn=useUtilityClasses$k(rr),_n=fn.root||et.Root||InputBaseRoot,Ln=Ht.root||ot.root||{},vn=fn.input||et.Input||InputBaseComponent;return or=_extends({},or,(tt=Ht.input)!=null?tt:ot.input),jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[!pt&&inputGlobalStyles,jsxRuntimeExports.jsxs(_n,_extends({},Ln,!isHostComponent(_n)&&{ownerState:_extends({},rr,Ln.ownerState)},{ref:_e,onClick:Gn},mn,{className:clsx(Zn.root,Ln.className,s,rn&&"MuiInputBase-readOnly"),children:[bn,jsxRuntimeExports.jsx(FormControlContext$1.Provider,{value:null,children:jsxRuntimeExports.jsx(vn,_extends({ownerState:rr,"aria-invalid":Nn.error,"aria-describedby":st,autoComplete:at,autoFocus:ut,defaultValue:lt,disabled:Nn.disabled,id:ht,onAnimationStart:Bn,name:At,placeholder:Bt,readOnly:rn,required:Nn.required,rows:tn,value:yn,onKeyDown:Wt,onKeyUp:zt,type:In},or,!isHostComponent(vn)&&{as:Yn,ownerState:_extends({},rr,or.ownerState)},{ref:xn,className:clsx(Zn.input,or.className,rn&&"MuiInputBase-readOnly"),onBlur:lr,onChange:cn,onFocus:zn}))}),gt,gn?gn(_extends({},Nn,{startAdornment:bn})):null]}))]})}),InputBase$1=InputBase;function getInputUtilityClass(a){return generateUtilityClass("MuiInput",a)}const inputClasses=_extends({},inputBaseClasses$1,generateUtilityClasses("MuiInput",["root","underline","input"])),inputClasses$1=inputClasses,_excluded$m=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],useUtilityClasses$j=a=>{const{classes:o,disableUnderline:_e}=a,rt=composeClasses({root:["root",!_e&&"underline"],input:["input"]},getInputUtilityClass,o);return _extends({},o,rt)},InputRoot=styled$1(InputBaseRoot,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiInput",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[...rootOverridesResolver(a,o),!_e.disableUnderline&&o.underline]}})(({theme:a,ownerState:o})=>{let tt=a.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return a.vars&&(tt=`rgba(${a.vars.palette.common.onBackgroundChannel} / ${a.vars.opacity.inputUnderline})`),_extends({position:"relative"},o.formControl&&{"label + &":{marginTop:16}},!o.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(a.vars||a).palette[o.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${inputClasses$1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${inputClasses$1.error}`]:{"&:before, &:after":{borderBottomColor:(a.vars||a).palette.error.main}},"&:before":{borderBottom:`1px solid ${tt}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:a.transitions.create("border-bottom-color",{duration:a.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${inputClasses$1.disabled}, .${inputClasses$1.error}):before`]:{borderBottom:`2px solid ${(a.vars||a).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${tt}`}},[`&.${inputClasses$1.disabled}:before`]:{borderBottomStyle:"dotted"}})}),InputInput=styled$1(InputBaseComponent,{name:"MuiInput",slot:"Input",overridesResolver:inputOverridesResolver})({}),Input=reactExports.forwardRef(function(o,_e){var tt,rt,st,at;const ut=useThemeProps({props:o,name:"MuiInput"}),{disableUnderline:s,components:et={},componentsProps:ot,fullWidth:lt=!1,inputComponent:St="input",multiline:pt=!1,slotProps:gt,slots:ct={},type:ht="text"}=ut,it=_objectWithoutPropertiesLoose(ut,_excluded$m),ft=useUtilityClasses$j(ut),Tt={root:{ownerState:{disableUnderline:s}}},It=gt??ot?deepmerge(gt??ot,Tt):Tt,Pt=(tt=(rt=ct.root)!=null?rt:et.Root)!=null?tt:InputRoot,At=(st=(at=ct.input)!=null?at:et.Input)!=null?st:InputInput;return jsxRuntimeExports.jsx(InputBase$1,_extends({slots:{root:Pt,input:At},slotProps:It,fullWidth:lt,inputComponent:St,multiline:pt,ref:_e,type:ht},it,{classes:ft}))});Input.muiName="Input";const Input$1=Input;function getFilledInputUtilityClass(a){return generateUtilityClass("MuiFilledInput",a)}const filledInputClasses=_extends({},inputBaseClasses$1,generateUtilityClasses("MuiFilledInput",["root","underline","input"])),filledInputClasses$1=filledInputClasses,_excluded$l=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],useUtilityClasses$i=a=>{const{classes:o,disableUnderline:_e}=a,rt=composeClasses({root:["root",!_e&&"underline"],input:["input"]},getFilledInputUtilityClass,o);return _extends({},o,rt)},FilledInputRoot=styled$1(InputBaseRoot,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[...rootOverridesResolver(a,o),!_e.disableUnderline&&o.underline]}})(({theme:a,ownerState:o})=>{var _e;const tt=a.palette.mode==="light",rt=tt?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",st=tt?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",at=tt?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",ut=tt?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return _extends({position:"relative",backgroundColor:a.vars?a.vars.palette.FilledInput.bg:st,borderTopLeftRadius:(a.vars||a).shape.borderRadius,borderTopRightRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create("background-color",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),"&:hover":{backgroundColor:a.vars?a.vars.palette.FilledInput.hoverBg:at,"@media (hover: none)":{backgroundColor:a.vars?a.vars.palette.FilledInput.bg:st}},[`&.${filledInputClasses$1.focused}`]:{backgroundColor:a.vars?a.vars.palette.FilledInput.bg:st},[`&.${filledInputClasses$1.disabled}`]:{backgroundColor:a.vars?a.vars.palette.FilledInput.disabledBg:ut}},!o.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(_e=(a.vars||a).palette[o.color||"primary"])==null?void 0:_e.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${filledInputClasses$1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${filledInputClasses$1.error}`]:{"&:before, &:after":{borderBottomColor:(a.vars||a).palette.error.main}},"&:before":{borderBottom:`1px solid ${a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / ${a.vars.opacity.inputUnderline})`:rt}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:a.transitions.create("border-bottom-color",{duration:a.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${filledInputClasses$1.disabled}, .${filledInputClasses$1.error}):before`]:{borderBottom:`1px solid ${(a.vars||a).palette.text.primary}`},[`&.${filledInputClasses$1.disabled}:before`]:{borderBottomStyle:"dotted"}},o.startAdornment&&{paddingLeft:12},o.endAdornment&&{paddingRight:12},o.multiline&&_extends({padding:"25px 12px 8px"},o.size==="small"&&{paddingTop:21,paddingBottom:4},o.hiddenLabel&&{paddingTop:16,paddingBottom:17}))}),FilledInputInput=styled$1(InputBaseComponent,{name:"MuiFilledInput",slot:"Input",overridesResolver:inputOverridesResolver})(({theme:a,ownerState:o})=>_extends({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!a.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:a.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:a.palette.mode==="light"?null:"#fff",caretColor:a.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},a.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[a.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},o.size==="small"&&{paddingTop:21,paddingBottom:4},o.hiddenLabel&&{paddingTop:16,paddingBottom:17},o.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},o.startAdornment&&{paddingLeft:0},o.endAdornment&&{paddingRight:0},o.hiddenLabel&&o.size==="small"&&{paddingTop:8,paddingBottom:9})),FilledInput=reactExports.forwardRef(function(o,_e){var tt,rt,st,at;const ut=useThemeProps({props:o,name:"MuiFilledInput"}),{components:s={},componentsProps:et,fullWidth:ot=!1,inputComponent:lt="input",multiline:St=!1,slotProps:pt,slots:gt={},type:ct="text"}=ut,ht=_objectWithoutPropertiesLoose(ut,_excluded$l),it=_extends({},ut,{fullWidth:ot,inputComponent:lt,multiline:St,type:ct}),ft=useUtilityClasses$i(ut),mt={root:{ownerState:it},input:{ownerState:it}},Tt=pt??et?deepmerge(pt??et,mt):mt,It=(tt=(rt=gt.root)!=null?rt:s.Root)!=null?tt:FilledInputRoot,Pt=(st=(at=gt.input)!=null?at:s.Input)!=null?st:FilledInputInput;return jsxRuntimeExports.jsx(InputBase$1,_extends({slots:{root:It,input:Pt},componentsProps:Tt,fullWidth:ot,inputComponent:lt,multiline:St,ref:_e,type:ct},ht,{classes:ft}))});FilledInput.muiName="Input";const FilledInput$1=FilledInput;var _span;const _excluded$k=["children","classes","className","label","notched"],NotchedOutlineRoot$1=styled$1("fieldset")({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),NotchedOutlineLegend=styled$1("legend")(({ownerState:a,theme:o})=>_extends({float:"unset",width:"auto",overflow:"hidden"},!a.withLabel&&{padding:0,lineHeight:"11px",transition:o.transitions.create("width",{duration:150,easing:o.transitions.easing.easeOut})},a.withLabel&&_extends({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:o.transitions.create("max-width",{duration:50,easing:o.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},a.notched&&{maxWidth:"100%",transition:o.transitions.create("max-width",{duration:100,easing:o.transitions.easing.easeOut,delay:50})})));function NotchedOutline(a){const{className:o,label:_e,notched:tt}=a,rt=_objectWithoutPropertiesLoose(a,_excluded$k),st=_e!=null&&_e!=="",at=_extends({},a,{notched:tt,withLabel:st});return jsxRuntimeExports.jsx(NotchedOutlineRoot$1,_extends({"aria-hidden":!0,className:o,ownerState:at},rt,{children:jsxRuntimeExports.jsx(NotchedOutlineLegend,{ownerState:at,children:st?jsxRuntimeExports.jsx("span",{children:_e}):_span||(_span=jsxRuntimeExports.jsx("span",{className:"notranslate",children:"​"}))})}))}function getOutlinedInputUtilityClass(a){return generateUtilityClass("MuiOutlinedInput",a)}const outlinedInputClasses=_extends({},inputBaseClasses$1,generateUtilityClasses("MuiOutlinedInput",["root","notchedOutline","input"])),outlinedInputClasses$1=outlinedInputClasses,_excluded$j=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],useUtilityClasses$h=a=>{const{classes:o}=a,tt=composeClasses({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},getOutlinedInputUtilityClass,o);return _extends({},o,tt)},OutlinedInputRoot=styled$1(InputBaseRoot,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:rootOverridesResolver})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return _extends({position:"relative",borderRadius:(a.vars||a).shape.borderRadius,[`&:hover .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette.text.primary},"@media (hover: none)":{[`&:hover .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:_e}},[`&.${outlinedInputClasses$1.focused} .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette[o.color].main,borderWidth:2},[`&.${outlinedInputClasses$1.error} .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette.error.main},[`&.${outlinedInputClasses$1.disabled} .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette.action.disabled}},o.startAdornment&&{paddingLeft:14},o.endAdornment&&{paddingRight:14},o.multiline&&_extends({padding:"16.5px 14px"},o.size==="small"&&{padding:"8.5px 14px"}))}),NotchedOutlineRoot=styled$1(NotchedOutline,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(a,o)=>o.notchedOutline})(({theme:a})=>{const o=a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:o}}),OutlinedInputInput=styled$1(InputBaseComponent,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:inputOverridesResolver})(({theme:a,ownerState:o})=>_extends({padding:"16.5px 14px"},!a.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:a.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:a.palette.mode==="light"?null:"#fff",caretColor:a.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},a.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[a.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},o.size==="small"&&{padding:"8.5px 14px"},o.multiline&&{padding:0},o.startAdornment&&{paddingLeft:0},o.endAdornment&&{paddingRight:0})),OutlinedInput=reactExports.forwardRef(function(o,_e){var tt,rt,st,at,ut;const s=useThemeProps({props:o,name:"MuiOutlinedInput"}),{components:et={},fullWidth:ot=!1,inputComponent:lt="input",label:St,multiline:pt=!1,notched:gt,slots:ct={},type:ht="text"}=s,it=_objectWithoutPropertiesLoose(s,_excluded$j),ft=useUtilityClasses$h(s),mt=useFormControl(),Tt=formControlState({props:s,muiFormControl:mt,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),It=_extends({},s,{color:Tt.color||"primary",disabled:Tt.disabled,error:Tt.error,focused:Tt.focused,formControl:mt,fullWidth:ot,hiddenLabel:Tt.hiddenLabel,multiline:pt,size:Tt.size,type:ht}),Pt=(tt=(rt=ct.root)!=null?rt:et.Root)!=null?tt:OutlinedInputRoot,At=(st=(at=ct.input)!=null?at:et.Input)!=null?st:OutlinedInputInput;return jsxRuntimeExports.jsx(InputBase$1,_extends({slots:{root:Pt,input:At},renderSuffix:Nt=>jsxRuntimeExports.jsx(NotchedOutlineRoot,{ownerState:It,className:ft.notchedOutline,label:St!=null&&St!==""&&Tt.required?ut||(ut=jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[St," ","*"]})):St,notched:typeof gt<"u"?gt:!!(Nt.startAdornment||Nt.filled||Nt.focused)}),fullWidth:ot,inputComponent:lt,multiline:pt,ref:_e,type:ht},it,{classes:_extends({},ft,{notchedOutline:null})}))});OutlinedInput.muiName="Input";const OutlinedInput$1=OutlinedInput,_excluded$i=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],_excluded2=["root"],useUtilityClasses$g=a=>{const{classes:o}=a;return o},styledRootConfig={name:"MuiSelect",overridesResolver:(a,o)=>o.root,shouldForwardProp:a=>rootShouldForwardProp(a)&&a!=="variant",slot:"Root"},StyledInput=styled$1(Input$1,styledRootConfig)(""),StyledOutlinedInput=styled$1(OutlinedInput$1,styledRootConfig)(""),StyledFilledInput=styled$1(FilledInput$1,styledRootConfig)(""),Select=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({name:"MuiSelect",props:o}),{autoWidth:rt=!1,children:st,classes:at={},className:ut,defaultOpen:s=!1,displayEmpty:et=!1,IconComponent:ot=ArrowDropDownIcon,id:lt,input:St,inputProps:pt,label:gt,labelId:ct,MenuProps:ht,multiple:it=!1,native:ft=!1,onClose:mt,onOpen:Tt,open:It,renderValue:Pt,SelectDisplayProps:At,variant:Nt="outlined"}=tt,Ot=_objectWithoutPropertiesLoose(tt,_excluded$i),Mt=ft?NativeSelectInput$1:SelectInput$1,bt=useFormControl(),Wt=formControlState({props:tt,muiFormControl:bt,states:["variant","error"]}),zt=Wt.variant||Nt,Bt=_extends({},tt,{variant:zt,classes:at}),rn=useUtilityClasses$g(Bt),gn=_objectWithoutPropertiesLoose(rn,_excluded2),tn=St||{standard:jsxRuntimeExports.jsx(StyledInput,{ownerState:Bt}),outlined:jsxRuntimeExports.jsx(StyledOutlinedInput,{label:gt,ownerState:Bt}),filled:jsxRuntimeExports.jsx(StyledFilledInput,{ownerState:Bt})}[zt],Ht=useForkRef(_e,tn.ref);return jsxRuntimeExports.jsx(reactExports.Fragment,{children:reactExports.cloneElement(tn,_extends({inputComponent:Mt,inputProps:_extends({children:st,error:Wt.error,IconComponent:ot,variant:zt,type:void 0,multiple:it},ft?{id:lt}:{autoWidth:rt,defaultOpen:s,displayEmpty:et,labelId:ct,MenuProps:ht,onClose:mt,onOpen:Tt,open:It,renderValue:Pt,SelectDisplayProps:_extends({id:lt},At)},pt,{classes:pt?deepmerge(gn,pt.classes):gn},St?St.props.inputProps:{})},it&&ft&&zt==="outlined"?{notched:!0}:{},{ref:Ht,className:clsx(tn.props.className,ut,rn.root)},!St&&{variant:zt},Ot))})});Select.muiName="Select";const Select$1=Select,Stack=createStack({createStyledComponent:styled$1("div",{name:"MuiStack",slot:"Root",overridesResolver:(a,o)=>o.root}),useThemeProps:a=>useThemeProps({props:a,name:"MuiStack"})}),Stack$1=Stack;function getFormControlLabelUtilityClasses(a){return generateUtilityClass("MuiFormControlLabel",a)}const formControlLabelClasses=generateUtilityClasses("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),formControlLabelClasses$1=formControlLabelClasses,_excluded$h=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],useUtilityClasses$f=a=>{const{classes:o,disabled:_e,labelPlacement:tt,error:rt,required:st}=a,at={root:["root",_e&&"disabled",`labelPlacement${capitalize(tt)}`,rt&&"error",st&&"required"],label:["label",_e&&"disabled"],asterisk:["asterisk",rt&&"error"]};return composeClasses(at,getFormControlLabelUtilityClasses,o)},FormControlLabelRoot=styled$1("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[{[`& .${formControlLabelClasses$1.label}`]:o.label},o.root,o[`labelPlacement${capitalize(_e.labelPlacement)}`]]}})(({theme:a,ownerState:o})=>_extends({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${formControlLabelClasses$1.disabled}`]:{cursor:"default"}},o.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},o.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},o.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${formControlLabelClasses$1.label}`]:{[`&.${formControlLabelClasses$1.disabled}`]:{color:(a.vars||a).palette.text.disabled}}})),AsteriskComponent=styled$1("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(a,o)=>o.asterisk})(({theme:a})=>({[`&.${formControlLabelClasses$1.error}`]:{color:(a.vars||a).palette.error.main}})),FormControlLabel=reactExports.forwardRef(function(o,_e){var tt,rt;const st=useThemeProps({props:o,name:"MuiFormControlLabel"}),{className:at,componentsProps:ut={},control:s,disabled:et,disableTypography:ot,label:lt,labelPlacement:St="end",required:pt,slotProps:gt={}}=st,ct=_objectWithoutPropertiesLoose(st,_excluded$h),ht=useFormControl(),it=(tt=et??s.props.disabled)!=null?tt:ht==null?void 0:ht.disabled,ft=pt??s.props.required,mt={disabled:it,required:ft};["checked","name","onChange","value","inputRef"].forEach(Ot=>{typeof s.props[Ot]>"u"&&typeof st[Ot]<"u"&&(mt[Ot]=st[Ot])});const Tt=formControlState({props:st,muiFormControl:ht,states:["error"]}),It=_extends({},st,{disabled:it,labelPlacement:St,required:ft,error:Tt.error}),Pt=useUtilityClasses$f(It),At=(rt=gt.typography)!=null?rt:ut.typography;let Nt=lt;return Nt!=null&&Nt.type!==Typography$1&&!ot&&(Nt=jsxRuntimeExports.jsx(Typography$1,_extends({component:"span"},At,{className:clsx(Pt.label,At==null?void 0:At.className),children:Nt}))),jsxRuntimeExports.jsxs(FormControlLabelRoot,_extends({className:clsx(Pt.root,at),ownerState:It,ref:_e},ct,{children:[reactExports.cloneElement(s,mt),ft?jsxRuntimeExports.jsxs(Stack$1,{direction:"row",alignItems:"center",children:[Nt,jsxRuntimeExports.jsxs(AsteriskComponent,{ownerState:It,"aria-hidden":!0,className:Pt.asterisk,children:[" ","*"]})]}):Nt]}))}),FormControlLabel$1=FormControlLabel;function getSwitchBaseUtilityClass(a){return generateUtilityClass("PrivateSwitchBase",a)}generateUtilityClasses("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const _excluded$g=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],useUtilityClasses$e=a=>{const{classes:o,checked:_e,disabled:tt,edge:rt}=a,st={root:["root",_e&&"checked",tt&&"disabled",rt&&`edge${capitalize(rt)}`],input:["input"]};return composeClasses(st,getSwitchBaseUtilityClass,o)},SwitchBaseRoot=styled$1(ButtonBase$1)(({ownerState:a})=>_extends({padding:9,borderRadius:"50%"},a.edge==="start"&&{marginLeft:a.size==="small"?-3:-12},a.edge==="end"&&{marginRight:a.size==="small"?-3:-12})),SwitchBaseInput=styled$1("input")({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),SwitchBase=reactExports.forwardRef(function(o,_e){const{autoFocus:tt,checked:rt,checkedIcon:st,className:at,defaultChecked:ut,disabled:s,disableFocusRipple:et=!1,edge:ot=!1,icon:lt,id:St,inputProps:pt,inputRef:gt,name:ct,onBlur:ht,onChange:it,onFocus:ft,readOnly:mt,required:Tt=!1,tabIndex:It,type:Pt,value:At}=o,Nt=_objectWithoutPropertiesLoose(o,_excluded$g),[Ot,Mt]=useControlled({controlled:rt,default:!!ut,name:"SwitchBase",state:"checked"}),bt=useFormControl(),Wt=fn=>{ft&&ft(fn),bt&&bt.onFocus&&bt.onFocus(fn)},zt=fn=>{ht&&ht(fn),bt&&bt.onBlur&&bt.onBlur(fn)},Bt=fn=>{if(fn.nativeEvent.defaultPrevented)return;const bn=fn.target.checked;Mt(bn),it&&it(fn,bn)};let rn=s;bt&&typeof rn>"u"&&(rn=bt.disabled);const gn=Pt==="checkbox"||Pt==="radio",tn=_extends({},o,{checked:Ot,disabled:rn,disableFocusRipple:et,edge:ot}),Ht=useUtilityClasses$e(tn);return jsxRuntimeExports.jsxs(SwitchBaseRoot,_extends({component:"span",className:clsx(Ht.root,at),centerRipple:!0,focusRipple:!et,disabled:rn,tabIndex:null,role:void 0,onFocus:Wt,onBlur:zt,ownerState:tn,ref:_e},Nt,{children:[jsxRuntimeExports.jsx(SwitchBaseInput,_extends({autoFocus:tt,checked:rt,defaultChecked:ut,className:Ht.input,disabled:rn,id:gn?St:void 0,name:ct,onChange:Bt,readOnly:mt,ref:gt,required:Tt,ownerState:tn,tabIndex:It,type:Pt},Pt==="checkbox"&&At===void 0?{}:{value:At},pt)),Ot?st:lt]}))}),SwitchBase$1=SwitchBase;function getFormGroupUtilityClass(a){return generateUtilityClass("MuiFormGroup",a)}generateUtilityClasses("MuiFormGroup",["root","row","error"]);const _excluded$f=["className","row"],useUtilityClasses$d=a=>{const{classes:o,row:_e,error:tt}=a;return composeClasses({root:["root",_e&&"row",tt&&"error"]},getFormGroupUtilityClass,o)},FormGroupRoot=styled$1("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.row&&o.row]}})(({ownerState:a})=>_extends({display:"flex",flexDirection:"column",flexWrap:"wrap"},a.row&&{flexDirection:"row"})),FormGroup=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiFormGroup"}),{className:rt,row:st=!1}=tt,at=_objectWithoutPropertiesLoose(tt,_excluded$f),ut=useFormControl(),s=formControlState({props:tt,muiFormControl:ut,states:["error"]}),et=_extends({},tt,{row:st,error:s.error}),ot=useUtilityClasses$d(et);return jsxRuntimeExports.jsx(FormGroupRoot,_extends({className:clsx(ot.root,rt),ownerState:et,ref:_e},at))}),FormGroup$1=FormGroup;function getUnit(a){return String(a).match(/[\d.\-+]*\s*(.*)/)[1]||""}function toUnitless(a){return parseFloat(a)}const _excluded$e=["theme"];function ThemeProvider(a){let{theme:o}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$e);const tt=o[THEME_ID];return jsxRuntimeExports.jsx(ThemeProvider$1,_extends({},_e,{themeId:tt?THEME_ID:void 0,theme:tt||o}))}const defaultTheme=createTheme(),Box=createBox({themeId:THEME_ID,defaultTheme,defaultClassName:"MuiBox-root",generateClassName:ClassNameGenerator$1.generate}),Box$1=Box;function getIconUtilityClass(a){return generateUtilityClass("MuiIcon",a)}generateUtilityClasses("MuiIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _excluded$d=["baseClassName","className","color","component","fontSize"],useUtilityClasses$c=a=>{const{color:o,fontSize:_e,classes:tt}=a,rt={root:["root",o!=="inherit"&&`color${capitalize(o)}`,`fontSize${capitalize(_e)}`]};return composeClasses(rt,getIconUtilityClass,tt)},IconRoot=styled$1("span",{name:"MuiIcon",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.color!=="inherit"&&o[`color${capitalize(_e.color)}`],o[`fontSize${capitalize(_e.fontSize)}`]]}})(({theme:a,ownerState:o})=>({userSelect:"none",width:"1em",height:"1em",overflow:"hidden",display:"inline-block",textAlign:"center",flexShrink:0,fontSize:{inherit:"inherit",small:a.typography.pxToRem(20),medium:a.typography.pxToRem(24),large:a.typography.pxToRem(36)}[o.fontSize],color:{primary:(a.vars||a).palette.primary.main,secondary:(a.vars||a).palette.secondary.main,info:(a.vars||a).palette.info.main,success:(a.vars||a).palette.success.main,warning:(a.vars||a).palette.warning.main,action:(a.vars||a).palette.action.active,error:(a.vars||a).palette.error.main,disabled:(a.vars||a).palette.action.disabled,inherit:void 0}[o.color]})),Icon=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiIcon"}),{baseClassName:rt="material-icons",className:st,color:at="inherit",component:ut="span",fontSize:s="medium"}=tt,et=_objectWithoutPropertiesLoose(tt,_excluded$d),ot=_extends({},tt,{baseClassName:rt,color:at,component:ut,fontSize:s}),lt=useUtilityClasses$c(ot);return jsxRuntimeExports.jsx(IconRoot,_extends({as:ut,className:clsx(rt,"notranslate",lt.root,st),ownerState:ot,"aria-hidden":!0,ref:_e},et))});Icon.muiName="Icon";const Icon$1=Icon;function getIconButtonUtilityClass(a){return generateUtilityClass("MuiIconButton",a)}const iconButtonClasses=generateUtilityClasses("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),iconButtonClasses$1=iconButtonClasses,_excluded$c=["edge","children","className","color","disabled","disableFocusRipple","size"],useUtilityClasses$b=a=>{const{classes:o,disabled:_e,color:tt,edge:rt,size:st}=a,at={root:["root",_e&&"disabled",tt!=="default"&&`color${capitalize(tt)}`,rt&&`edge${capitalize(rt)}`,`size${capitalize(st)}`]};return composeClasses(at,getIconButtonUtilityClass,o)},IconButtonRoot=styled$1(ButtonBase$1,{name:"MuiIconButton",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.color!=="default"&&o[`color${capitalize(_e.color)}`],_e.edge&&o[`edge${capitalize(_e.edge)}`],o[`size${capitalize(_e.size)}`]]}})(({theme:a,ownerState:o})=>_extends({textAlign:"center",flex:"0 0 auto",fontSize:a.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(a.vars||a).palette.action.active,transition:a.transitions.create("background-color",{duration:a.transitions.duration.shortest})},!o.disableRipple&&{"&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.activeChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette.action.active,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.edge==="start"&&{marginLeft:o.size==="small"?-3:-12},o.edge==="end"&&{marginRight:o.size==="small"?-3:-12}),({theme:a,ownerState:o})=>{var _e;const tt=(_e=(a.vars||a).palette)==null?void 0:_e[o.color];return _extends({},o.color==="inherit"&&{color:"inherit"},o.color!=="inherit"&&o.color!=="default"&&_extends({color:tt==null?void 0:tt.main},!o.disableRipple&&{"&:hover":_extends({},tt&&{backgroundColor:a.vars?`rgba(${tt.mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(tt.main,a.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),o.size==="small"&&{padding:5,fontSize:a.typography.pxToRem(18)},o.size==="large"&&{padding:12,fontSize:a.typography.pxToRem(28)},{[`&.${iconButtonClasses$1.disabled}`]:{backgroundColor:"transparent",color:(a.vars||a).palette.action.disabled}})}),IconButton=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiIconButton"}),{edge:rt=!1,children:st,className:at,color:ut="default",disabled:s=!1,disableFocusRipple:et=!1,size:ot="medium"}=tt,lt=_objectWithoutPropertiesLoose(tt,_excluded$c),St=_extends({},tt,{edge:rt,color:ut,disabled:s,disableFocusRipple:et,size:ot}),pt=useUtilityClasses$b(St);return jsxRuntimeExports.jsx(IconButtonRoot,_extends({className:clsx(pt.root,at),centerRipple:!0,focusRipple:!et,disabled:s,ref:_e,ownerState:St},lt,{children:st}))}),IconButton$1=IconButton,_excluded$b=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],PopperRoot=styled$1(Popper$2,{name:"MuiPopper",slot:"Root",overridesResolver:(a,o)=>o.root})({}),Popper=reactExports.forwardRef(function(o,_e){var tt;const rt=useTheme$3(),st=useThemeProps({props:o,name:"MuiPopper"}),{anchorEl:at,component:ut,components:s,componentsProps:et,container:ot,disablePortal:lt,keepMounted:St,modifiers:pt,open:gt,placement:ct,popperOptions:ht,popperRef:it,transition:ft,slots:mt,slotProps:Tt}=st,It=_objectWithoutPropertiesLoose(st,_excluded$b),Pt=(tt=mt==null?void 0:mt.root)!=null?tt:s==null?void 0:s.Root,At=_extends({anchorEl:at,container:ot,disablePortal:lt,keepMounted:St,modifiers:pt,open:gt,placement:ct,popperOptions:ht,popperRef:it,transition:ft},It);return jsxRuntimeExports.jsx(PopperRoot,_extends({as:ut,direction:rt==null?void 0:rt.direction,slots:{root:Pt},slotProps:Tt??et},At,{ref:_e}))}),Popper$1=Popper;function getTooltipUtilityClass(a){return generateUtilityClass("MuiTooltip",a)}const tooltipClasses=generateUtilityClasses("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),tooltipClasses$1=tooltipClasses,_excluded$a=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function round(a){return Math.round(a*1e5)/1e5}const useUtilityClasses$a=a=>{const{classes:o,disableInteractive:_e,arrow:tt,touch:rt,placement:st}=a,at={popper:["popper",!_e&&"popperInteractive",tt&&"popperArrow"],tooltip:["tooltip",tt&&"tooltipArrow",rt&&"touch",`tooltipPlacement${capitalize(st.split("-")[0])}`],arrow:["arrow"]};return composeClasses(at,getTooltipUtilityClass,o)},TooltipPopper=styled$1(Popper$1,{name:"MuiTooltip",slot:"Popper",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.popper,!_e.disableInteractive&&o.popperInteractive,_e.arrow&&o.popperArrow,!_e.open&&o.popperClose]}})(({theme:a,ownerState:o,open:_e})=>_extends({zIndex:(a.vars||a).zIndex.tooltip,pointerEvents:"none"},!o.disableInteractive&&{pointerEvents:"auto"},!_e&&{pointerEvents:"none"},o.arrow&&{[`&[data-popper-placement*="bottom"] .${tooltipClasses$1.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${tooltipClasses$1.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${tooltipClasses$1.arrow}`]:_extends({},o.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${tooltipClasses$1.arrow}`]:_extends({},o.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),TooltipTooltip=styled$1("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.tooltip,_e.touch&&o.touch,_e.arrow&&o.tooltipArrow,o[`tooltipPlacement${capitalize(_e.placement.split("-")[0])}`]]}})(({theme:a,ownerState:o})=>_extends({backgroundColor:a.vars?a.vars.palette.Tooltip.bg:alpha(a.palette.grey[700],.92),borderRadius:(a.vars||a).shape.borderRadius,color:(a.vars||a).palette.common.white,fontFamily:a.typography.fontFamily,padding:"4px 8px",fontSize:a.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:a.typography.fontWeightMedium},o.arrow&&{position:"relative",margin:0},o.touch&&{padding:"8px 16px",fontSize:a.typography.pxToRem(14),lineHeight:`${round(16/14)}em`,fontWeight:a.typography.fontWeightRegular},{[`.${tooltipClasses$1.popper}[data-popper-placement*="left"] &`]:_extends({transformOrigin:"right center"},o.isRtl?_extends({marginLeft:"14px"},o.touch&&{marginLeft:"24px"}):_extends({marginRight:"14px"},o.touch&&{marginRight:"24px"})),[`.${tooltipClasses$1.popper}[data-popper-placement*="right"] &`]:_extends({transformOrigin:"left center"},o.isRtl?_extends({marginRight:"14px"},o.touch&&{marginRight:"24px"}):_extends({marginLeft:"14px"},o.touch&&{marginLeft:"24px"})),[`.${tooltipClasses$1.popper}[data-popper-placement*="top"] &`]:_extends({transformOrigin:"center bottom",marginBottom:"14px"},o.touch&&{marginBottom:"24px"}),[`.${tooltipClasses$1.popper}[data-popper-placement*="bottom"] &`]:_extends({transformOrigin:"center top",marginTop:"14px"},o.touch&&{marginTop:"24px"})})),TooltipArrow=styled$1("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(a,o)=>o.arrow})(({theme:a})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:a.vars?a.vars.palette.Tooltip.bg:alpha(a.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let hystersisOpen=!1,hystersisTimer=null,cursorPosition={x:0,y:0};function composeEventHandler(a,o){return _e=>{o&&o(_e),a(_e)}}const Tooltip=reactExports.forwardRef(function(o,_e){var tt,rt,st,at,ut,s,et,ot,lt,St,pt,gt,ct,ht,it,ft,mt,Tt,It;const Pt=useThemeProps({props:o,name:"MuiTooltip"}),{arrow:At=!1,children:Nt,components:Ot={},componentsProps:Mt={},describeChild:bt=!1,disableFocusListener:Wt=!1,disableHoverListener:zt=!1,disableInteractive:Bt=!1,disableTouchListener:rn=!1,enterDelay:gn=100,enterNextDelay:tn=0,enterTouchDelay:Ht=700,followCursor:fn=!1,id:bn,leaveDelay:In=0,leaveTouchDelay:un=1500,onClose:mn,onOpen:yn,open:pn,placement:Tn="bottom",PopperComponent:kn,PopperProps:xn={},slotProps:Mn={},slots:Dn={},title:An,TransitionComponent:Nn=Grow$1,TransitionProps:Un}=Pt,Qn=_objectWithoutPropertiesLoose(Pt,_excluded$a),er=reactExports.isValidElement(Nt)?Nt:jsxRuntimeExports.jsx("span",{children:Nt}),zn=useTheme(),lr=zn.direction==="rtl",[cn,Gn]=reactExports.useState(),[Yn,or]=reactExports.useState(null),Bn=reactExports.useRef(!1),rr=Bt||fn,Zn=reactExports.useRef(),_n=reactExports.useRef(),Ln=reactExports.useRef(),vn=reactExports.useRef(),[On,Kt]=useControlled({controlled:pn,default:!1,name:"Tooltip",state:"open"});let Rt=On;const nt=useId(bn),Ct=reactExports.useRef(),yt=reactExports.useCallback(()=>{Ct.current!==void 0&&(document.body.style.WebkitUserSelect=Ct.current,Ct.current=void 0),clearTimeout(vn.current)},[]);reactExports.useEffect(()=>()=>{clearTimeout(Zn.current),clearTimeout(_n.current),clearTimeout(Ln.current),yt()},[yt]);const xt=Hn=>{clearTimeout(hystersisTimer),hystersisOpen=!0,Kt(!0),yn&&!Rt&&yn(Hn)},wt=useEventCallback(Hn=>{clearTimeout(hystersisTimer),hystersisTimer=setTimeout(()=>{hystersisOpen=!1},800+In),Kt(!1),mn&&Rt&&mn(Hn),clearTimeout(Zn.current),Zn.current=setTimeout(()=>{Bn.current=!1},zn.transitions.duration.shortest)}),Lt=Hn=>{Bn.current&&Hn.type!=="touchstart"||(cn&&cn.removeAttribute("title"),clearTimeout(_n.current),clearTimeout(Ln.current),gn||hystersisOpen&&tn?_n.current=setTimeout(()=>{xt(Hn)},hystersisOpen?tn:gn):xt(Hn))},Et=Hn=>{clearTimeout(_n.current),clearTimeout(Ln.current),Ln.current=setTimeout(()=>{wt(Hn)},In)},{isFocusVisibleRef:$t,onBlur:Jt,onFocus:en,ref:qt}=useIsFocusVisible(),[,on]=reactExports.useState(!1),hn=Hn=>{Jt(Hn),$t.current===!1&&(on(!1),Et(Hn))},nn=Hn=>{cn||Gn(Hn.currentTarget),en(Hn),$t.current===!0&&(on(!0),Lt(Hn))},dn=Hn=>{Bn.current=!0;const vr=er.props;vr.onTouchStart&&vr.onTouchStart(Hn)},Sn=Lt,wn=Et,En=Hn=>{dn(Hn),clearTimeout(Ln.current),clearTimeout(Zn.current),yt(),Ct.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",vn.current=setTimeout(()=>{document.body.style.WebkitUserSelect=Ct.current,Lt(Hn)},Ht)},Pn=Hn=>{er.props.onTouchEnd&&er.props.onTouchEnd(Hn),yt(),clearTimeout(Ln.current),Ln.current=setTimeout(()=>{wt(Hn)},un)};reactExports.useEffect(()=>{if(!Rt)return;function Hn(vr){(vr.key==="Escape"||vr.key==="Esc")&&wt(vr)}return document.addEventListener("keydown",Hn),()=>{document.removeEventListener("keydown",Hn)}},[wt,Rt]);const Wn=useForkRef(er.ref,qt,Gn,_e);!An&&An!==0&&(Rt=!1);const ir=reactExports.useRef(),fr=Hn=>{const vr=er.props;vr.onMouseMove&&vr.onMouseMove(Hn),cursorPosition={x:Hn.clientX,y:Hn.clientY},ir.current&&ir.current.update()},gr={},yr=typeof An=="string";bt?(gr.title=!Rt&&yr&&!zt?An:null,gr["aria-describedby"]=Rt?nt:null):(gr["aria-label"]=yr?An:null,gr["aria-labelledby"]=Rt&&!yr?nt:null);const Rr=_extends({},gr,Qn,er.props,{className:clsx(Qn.className,er.props.className),onTouchStart:dn,ref:Wn},fn?{onMouseMove:fr}:{}),kr={};rn||(Rr.onTouchStart=En,Rr.onTouchEnd=Pn),zt||(Rr.onMouseOver=composeEventHandler(Sn,Rr.onMouseOver),Rr.onMouseLeave=composeEventHandler(wn,Rr.onMouseLeave),rr||(kr.onMouseOver=Sn,kr.onMouseLeave=wn)),Wt||(Rr.onFocus=composeEventHandler(nn,Rr.onFocus),Rr.onBlur=composeEventHandler(hn,Rr.onBlur),rr||(kr.onFocus=nn,kr.onBlur=hn));const Qr=reactExports.useMemo(()=>{var Hn;let vr=[{name:"arrow",enabled:!!Yn,options:{element:Yn,padding:4}}];return(Hn=xn.popperOptions)!=null&&Hn.modifiers&&(vr=vr.concat(xn.popperOptions.modifiers)),_extends({},xn.popperOptions,{modifiers:vr})},[Yn,xn]),Yr=_extends({},Pt,{isRtl:lr,arrow:At,disableInteractive:rr,placement:Tn,PopperComponentProp:kn,touch:Bn.current}),Sr=useUtilityClasses$a(Yr),Nr=(tt=(rt=Dn.popper)!=null?rt:Ot.Popper)!=null?tt:TooltipPopper,wr=(st=(at=(ut=Dn.transition)!=null?ut:Ot.Transition)!=null?at:Nn)!=null?st:Grow$1,Ar=(s=(et=Dn.tooltip)!=null?et:Ot.Tooltip)!=null?s:TooltipTooltip,Lr=(ot=(lt=Dn.arrow)!=null?lt:Ot.Arrow)!=null?ot:TooltipArrow,Hr=appendOwnerState(Nr,_extends({},xn,(St=Mn.popper)!=null?St:Mt.popper,{className:clsx(Sr.popper,xn==null?void 0:xn.className,(pt=(gt=Mn.popper)!=null?gt:Mt.popper)==null?void 0:pt.className)}),Yr),na=appendOwnerState(wr,_extends({},Un,(ct=Mn.transition)!=null?ct:Mt.transition),Yr),Vn=appendOwnerState(Ar,_extends({},(ht=Mn.tooltip)!=null?ht:Mt.tooltip,{className:clsx(Sr.tooltip,(it=(ft=Mn.tooltip)!=null?ft:Mt.tooltip)==null?void 0:it.className)}),Yr),ar=appendOwnerState(Lr,_extends({},(mt=Mn.arrow)!=null?mt:Mt.arrow,{className:clsx(Sr.arrow,(Tt=(It=Mn.arrow)!=null?It:Mt.arrow)==null?void 0:Tt.className)}),Yr);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[reactExports.cloneElement(er,Rr),jsxRuntimeExports.jsx(Nr,_extends({as:kn??Popper$1,placement:Tn,anchorEl:fn?{getBoundingClientRect:()=>({top:cursorPosition.y,left:cursorPosition.x,right:cursorPosition.x,bottom:cursorPosition.y,width:0,height:0})}:cn,popperRef:ir,open:cn?Rt:!1,id:nt,transition:!0},kr,Hr,{popperOptions:Qr,children:({TransitionProps:Hn})=>jsxRuntimeExports.jsx(wr,_extends({timeout:zn.transitions.duration.shorter},Hn,na,{children:jsxRuntimeExports.jsxs(Ar,_extends({},Vn,{children:[An,At?jsxRuntimeExports.jsx(Lr,_extends({},ar,{ref:or})):null]}))}))}))]})}),Tooltip$1=Tooltip;function getCircularProgressUtilityClass(a){return generateUtilityClass("MuiCircularProgress",a)}generateUtilityClasses("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const _excluded$9=["className","color","disableShrink","size","style","thickness","value","variant"];let _$2=a=>a,_t$1,_t2$1,_t3$1,_t4$1;const SIZE=44,circularRotateKeyframe=keyframes(_t$1||(_t$1=_$2`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),circularDashKeyframe=keyframes(_t2$1||(_t2$1=_$2`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),useUtilityClasses$9=a=>{const{classes:o,variant:_e,color:tt,disableShrink:rt}=a,st={root:["root",_e,`color${capitalize(tt)}`],svg:["svg"],circle:["circle",`circle${capitalize(_e)}`,rt&&"circleDisableShrink"]};return composeClasses(st,getCircularProgressUtilityClass,o)},CircularProgressRoot=styled$1("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],o[`color${capitalize(_e.color)}`]]}})(({ownerState:a,theme:o})=>_extends({display:"inline-block"},a.variant==="determinate"&&{transition:o.transitions.create("transform")},a.color!=="inherit"&&{color:(o.vars||o).palette[a.color].main}),({ownerState:a})=>a.variant==="indeterminate"&&css(_t3$1||(_t3$1=_$2`
      animation: ${0} 1.4s linear infinite;
    `),circularRotateKeyframe)),CircularProgressSVG=styled$1("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(a,o)=>o.svg})({display:"block"}),CircularProgressCircle=styled$1("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.circle,o[`circle${capitalize(_e.variant)}`],_e.disableShrink&&o.circleDisableShrink]}})(({ownerState:a,theme:o})=>_extends({stroke:"currentColor"},a.variant==="determinate"&&{transition:o.transitions.create("stroke-dashoffset")},a.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:a})=>a.variant==="indeterminate"&&!a.disableShrink&&css(_t4$1||(_t4$1=_$2`
      animation: ${0} 1.4s ease-in-out infinite;
    `),circularDashKeyframe)),CircularProgress=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiCircularProgress"}),{className:rt,color:st="primary",disableShrink:at=!1,size:ut=40,style:s,thickness:et=3.6,value:ot=0,variant:lt="indeterminate"}=tt,St=_objectWithoutPropertiesLoose(tt,_excluded$9),pt=_extends({},tt,{color:st,disableShrink:at,size:ut,thickness:et,value:ot,variant:lt}),gt=useUtilityClasses$9(pt),ct={},ht={},it={};if(lt==="determinate"){const ft=2*Math.PI*((SIZE-et)/2);ct.strokeDasharray=ft.toFixed(3),it["aria-valuenow"]=Math.round(ot),ct.strokeDashoffset=`${((100-ot)/100*ft).toFixed(3)}px`,ht.transform="rotate(-90deg)"}return jsxRuntimeExports.jsx(CircularProgressRoot,_extends({className:clsx(gt.root,rt),style:_extends({width:ut,height:ut},ht,s),ownerState:pt,ref:_e,role:"progressbar"},it,St,{children:jsxRuntimeExports.jsx(CircularProgressSVG,{className:gt.svg,ownerState:pt,viewBox:`${SIZE/2} ${SIZE/2} ${SIZE} ${SIZE}`,children:jsxRuntimeExports.jsx(CircularProgressCircle,{className:gt.circle,style:ct,ownerState:pt,cx:SIZE,cy:SIZE,r:(SIZE-et)/2,fill:"none",strokeWidth:et})})}))}),M=CircularProgress,CancelIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function getChipUtilityClass(a){return generateUtilityClass("MuiChip",a)}const chipClasses=generateUtilityClasses("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),chipClasses$1=chipClasses,_excluded$8=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],useUtilityClasses$8=a=>{const{classes:o,disabled:_e,size:tt,color:rt,iconColor:st,onDelete:at,clickable:ut,variant:s}=a,et={root:["root",s,_e&&"disabled",`size${capitalize(tt)}`,`color${capitalize(rt)}`,ut&&"clickable",ut&&`clickableColor${capitalize(rt)}`,at&&"deletable",at&&`deletableColor${capitalize(rt)}`,`${s}${capitalize(rt)}`],label:["label",`label${capitalize(tt)}`],avatar:["avatar",`avatar${capitalize(tt)}`,`avatarColor${capitalize(rt)}`],icon:["icon",`icon${capitalize(tt)}`,`iconColor${capitalize(st)}`],deleteIcon:["deleteIcon",`deleteIcon${capitalize(tt)}`,`deleteIconColor${capitalize(rt)}`,`deleteIcon${capitalize(s)}Color${capitalize(rt)}`]};return composeClasses(et,getChipUtilityClass,o)},ChipRoot=styled$1("div",{name:"MuiChip",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a,{color:tt,iconColor:rt,clickable:st,onDelete:at,size:ut,variant:s}=_e;return[{[`& .${chipClasses$1.avatar}`]:o.avatar},{[`& .${chipClasses$1.avatar}`]:o[`avatar${capitalize(ut)}`]},{[`& .${chipClasses$1.avatar}`]:o[`avatarColor${capitalize(tt)}`]},{[`& .${chipClasses$1.icon}`]:o.icon},{[`& .${chipClasses$1.icon}`]:o[`icon${capitalize(ut)}`]},{[`& .${chipClasses$1.icon}`]:o[`iconColor${capitalize(rt)}`]},{[`& .${chipClasses$1.deleteIcon}`]:o.deleteIcon},{[`& .${chipClasses$1.deleteIcon}`]:o[`deleteIcon${capitalize(ut)}`]},{[`& .${chipClasses$1.deleteIcon}`]:o[`deleteIconColor${capitalize(tt)}`]},{[`& .${chipClasses$1.deleteIcon}`]:o[`deleteIcon${capitalize(s)}Color${capitalize(tt)}`]},o.root,o[`size${capitalize(ut)}`],o[`color${capitalize(tt)}`],st&&o.clickable,st&&tt!=="default"&&o[`clickableColor${capitalize(tt)})`],at&&o.deletable,at&&tt!=="default"&&o[`deletableColor${capitalize(tt)}`],o[s],o[`${s}${capitalize(tt)}`]]}})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light"?a.palette.grey[700]:a.palette.grey[300];return _extends({maxWidth:"100%",fontFamily:a.typography.fontFamily,fontSize:a.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(a.vars||a).palette.text.primary,backgroundColor:(a.vars||a).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:a.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${chipClasses$1.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${chipClasses$1.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:a.vars?a.vars.palette.Chip.defaultAvatarColor:_e,fontSize:a.typography.pxToRem(12)},[`& .${chipClasses$1.avatarColorPrimary}`]:{color:(a.vars||a).palette.primary.contrastText,backgroundColor:(a.vars||a).palette.primary.dark},[`& .${chipClasses$1.avatarColorSecondary}`]:{color:(a.vars||a).palette.secondary.contrastText,backgroundColor:(a.vars||a).palette.secondary.dark},[`& .${chipClasses$1.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:a.typography.pxToRem(10)},[`& .${chipClasses$1.icon}`]:_extends({marginLeft:5,marginRight:-6},o.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},o.iconColor===o.color&&_extends({color:a.vars?a.vars.palette.Chip.defaultIconColor:_e},o.color!=="default"&&{color:"inherit"})),[`& .${chipClasses$1.deleteIcon}`]:_extends({WebkitTapHighlightColor:"transparent",color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.26)`:alpha(a.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.4)`:alpha(a.palette.text.primary,.4)}},o.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},o.color!=="default"&&{color:a.vars?`rgba(${a.vars.palette[o.color].contrastTextChannel} / 0.7)`:alpha(a.palette[o.color].contrastText,.7),"&:hover, &:active":{color:(a.vars||a).palette[o.color].contrastText}})},o.size==="small"&&{height:24},o.color!=="default"&&{backgroundColor:(a.vars||a).palette[o.color].main,color:(a.vars||a).palette[o.color].contrastText},o.onDelete&&{[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},o.onDelete&&o.color!=="default"&&{[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette[o.color].dark}})},({theme:a,ownerState:o})=>_extends({},o.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity)},[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)},"&:active":{boxShadow:(a.vars||a).shadows[1]}},o.clickable&&o.color!=="default"&&{[`&:hover, &.${chipClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette[o.color].dark}}),({theme:a,ownerState:o})=>_extends({},o.variant==="outlined"&&{backgroundColor:"transparent",border:a.vars?`1px solid ${a.vars.palette.Chip.defaultBorder}`:`1px solid ${a.palette.mode==="light"?a.palette.grey[400]:a.palette.grey[700]}`,[`&.${chipClasses$1.clickable}:hover`]:{backgroundColor:(a.vars||a).palette.action.hover},[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`& .${chipClasses$1.avatar}`]:{marginLeft:4},[`& .${chipClasses$1.avatarSmall}`]:{marginLeft:2},[`& .${chipClasses$1.icon}`]:{marginLeft:4},[`& .${chipClasses$1.iconSmall}`]:{marginLeft:2},[`& .${chipClasses$1.deleteIcon}`]:{marginRight:5},[`& .${chipClasses$1.deleteIconSmall}`]:{marginRight:3}},o.variant==="outlined"&&o.color!=="default"&&{color:(a.vars||a).palette[o.color].main,border:`1px solid ${a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / 0.7)`:alpha(a.palette[o.color].main,.7)}`,[`&.${chipClasses$1.clickable}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette[o.color].main,a.palette.action.hoverOpacity)},[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.focusOpacity})`:alpha(a.palette[o.color].main,a.palette.action.focusOpacity)},[`& .${chipClasses$1.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / 0.7)`:alpha(a.palette[o.color].main,.7),"&:hover, &:active":{color:(a.vars||a).palette[o.color].main}}})),ChipLabel=styled$1("span",{name:"MuiChip",slot:"Label",overridesResolver:(a,o)=>{const{ownerState:_e}=a,{size:tt}=_e;return[o.label,o[`label${capitalize(tt)}`]]}})(({ownerState:a})=>_extends({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},a.variant==="outlined"&&{paddingLeft:11,paddingRight:11},a.size==="small"&&{paddingLeft:8,paddingRight:8},a.size==="small"&&a.variant==="outlined"&&{paddingLeft:7,paddingRight:7}));function isDeleteKeyboardEvent(a){return a.key==="Backspace"||a.key==="Delete"}const Chip=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiChip"}),{avatar:rt,className:st,clickable:at,color:ut="default",component:s,deleteIcon:et,disabled:ot=!1,icon:lt,label:St,onClick:pt,onDelete:gt,onKeyDown:ct,onKeyUp:ht,size:it="medium",variant:ft="filled",tabIndex:mt,skipFocusWhenDisabled:Tt=!1}=tt,It=_objectWithoutPropertiesLoose(tt,_excluded$8),Pt=reactExports.useRef(null),At=useForkRef(Pt,_e),Nt=fn=>{fn.stopPropagation(),gt&&gt(fn)},Ot=fn=>{fn.currentTarget===fn.target&&isDeleteKeyboardEvent(fn)&&fn.preventDefault(),ct&&ct(fn)},Mt=fn=>{fn.currentTarget===fn.target&&(gt&&isDeleteKeyboardEvent(fn)?gt(fn):fn.key==="Escape"&&Pt.current&&Pt.current.blur()),ht&&ht(fn)},bt=at!==!1&&pt?!0:at,Wt=bt||gt?ButtonBase$1:s||"div",zt=_extends({},tt,{component:Wt,disabled:ot,size:it,color:ut,iconColor:reactExports.isValidElement(lt)&&lt.props.color||ut,onDelete:!!gt,clickable:bt,variant:ft}),Bt=useUtilityClasses$8(zt),rn=Wt===ButtonBase$1?_extends({component:s||"div",focusVisibleClassName:Bt.focusVisible},gt&&{disableRipple:!0}):{};let gn=null;gt&&(gn=et&&reactExports.isValidElement(et)?reactExports.cloneElement(et,{className:clsx(et.props.className,Bt.deleteIcon),onClick:Nt}):jsxRuntimeExports.jsx(CancelIcon,{className:clsx(Bt.deleteIcon),onClick:Nt}));let tn=null;rt&&reactExports.isValidElement(rt)&&(tn=reactExports.cloneElement(rt,{className:clsx(Bt.avatar,rt.props.className)}));let Ht=null;return lt&&reactExports.isValidElement(lt)&&(Ht=reactExports.cloneElement(lt,{className:clsx(Bt.icon,lt.props.className)})),jsxRuntimeExports.jsxs(ChipRoot,_extends({as:Wt,className:clsx(Bt.root,st),disabled:bt&&ot?!0:void 0,onClick:pt,onKeyDown:Ot,onKeyUp:Mt,ref:At,tabIndex:Tt&&ot?-1:mt,ownerState:zt},rn,It,{children:[tn||Ht,jsxRuntimeExports.jsx(ChipLabel,{className:clsx(Bt.label),ownerState:zt,children:St}),gn]}))}),Chip$1=Chip;var A$1=function(){return A$1=Object.assign||function(a){for(var o,_e=1,tt=arguments.length;_e<tt;_e++)for(var rt in o=arguments[_e])Object.prototype.hasOwnProperty.call(o,rt)&&(a[rt]=o[rt]);return a},A$1.apply(this,arguments)};function x(a,o){var _e={};for(var tt in a)Object.prototype.hasOwnProperty.call(a,tt)&&o.indexOf(tt)<0&&(_e[tt]=a[tt]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function"){var rt=0;for(tt=Object.getOwnPropertySymbols(a);rt<tt.length;rt++)o.indexOf(tt[rt])<0&&Object.prototype.propertyIsEnumerable.call(a,tt[rt])&&(_e[tt[rt]]=a[tt[rt]])}return _e}var S=function(a){var o=a.children,_e=x(a,["children"]),tt=reactExports.useMemo(function(){var at,ut=React$1.Children.toArray(o);return ut.length<=1?at={xs:12,sx:{height:{xs:"100%"}}}:ut.length<=2?at={xs:12,md:6,sx:{height:{xs:100/ut.length+"%",md:100/Math.ceil(ut.length/2)+"%"}}}:ut.length<=4?at={xs:12,sm:6,sx:{height:{xs:100/ut.length+"%",sm:100/Math.ceil(ut.length/2)+"%"}}}:ut.length<=6?at={xs:6,md:4,sx:{height:{xs:100/Math.ceil(ut.length/2)+"%",md:100/Math.ceil(ut.length/3)+"%"}}}:ut.length<=9?at={xs:6,sm:4,sx:{height:{xs:100/Math.ceil(ut.length/2)+"%",sm:100/Math.ceil(ut.length/3)+"%"}}}:ut.length<=12?at={xs:4,md:3,sx:{height:{xs:100/Math.ceil(ut.length/3)+"%",md:100/Math.ceil(ut.length/4)+"%"}}}:ut.length<=24?at={xs:4,sm:2,sx:{height:{xs:100/Math.ceil(ut.length/3)+"%",sm:100/Math.ceil(ut.length/6)+"%"}}}:ut.length<=42?at={xs:3,sm:2,sx:{height:{xs:100/Math.ceil(ut.length/4)+"%",sm:100/Math.ceil(ut.length/6)+"%"}}}:at={xs:2,lg:1,sx:{height:{xs:100/Math.ceil(ut.length/6)+"%",lg:100/Math.ceil(ut.length/12)+"%"}}},{arrayChildren:ut,responsive:at}},[o]),rt=tt.arrayChildren,st=tt.responsive;return React$1.createElement(u,A$1({container:!0,direction:"row",justifyContent:"space-around",alignItems:"center"},_e),React$1.Children.map(rt,function(at,ut){return React$1.createElement(u,A$1({item:!0,key:ut,display:"flex",justifyContent:"center",alignItems:"center"},st),at)}))},w="default";function C(a){var o=a.id,_e=o===void 0?"media-device-selector":o,tt=a.testid,rt=tt===void 0?"test-media-device-selector":tt,st=a.devices,at=a.selectedDevice,ut=a.setSelectedDevice,s=x(a,["id","testid","devices","selectedDevice","setSelectedDevice"]),et=reactExports.useMemo(function(){return st[w]},[st]),ot=Object.values(st).map(function(lt){return React$1.createElement(MenuItem$1,{key:lt.getId(),value:lt.getId()},lt.getLabel())});return React$1.createElement(Select$1,A$1({id:_e,"data-testid":rt,value:at?at.getId():w,onChange:function(lt){lt.preventDefault(),globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug("".concat("MediaDeviceSelect","|onSelectDevice"),lt.target.value),ut(st[lt.target.value])}},s),!et&&React$1.createElement(MenuItem$1,{key:w,value:w},"Default"),ot)}var I$1=reactExports.createContext({stream:void 0,muted:!1,toggleMuted:function(){}}),z="Audio";function F(a){var o;globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(z+"|Rendering");var _e=a.id,tt=_e===void 0?(o=a.stream)===null||o===void 0?void 0:o.getId():_e,rt=a.autoPlay,st=rt===void 0||rt,at=a.muted,ut=a.stream;a.sinkId;var s=x(a,["id","autoPlay","muted","stream","sinkId"]),et=reactExports.useContext(I$1),ot=et.stream,lt=et.muted,St=lt!==void 0&&lt,pt=reactExports.useMemo(function(){return ut??ot},[ot,ut]),gt=reactExports.useMemo(function(){return at??St},[St,at]),ct=reactExports.useRef(null);return reactExports.useEffect(function(){var ht=ct==null?void 0:ct.current;if(pt&&ht)return globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(z+"|useEffect stream",ht,pt),pt.attachToElement(ht),function(){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(z+"|useEffect stream destroy"),ht.src=""}},[pt]),reactExports.useEffect(function(){var ht=ct==null?void 0:ct.current;ht&&a.sinkId&&ht.setSinkId&&ht.setSinkId(a.sinkId)},[a.sinkId]),React$1.createElement(Box$1,A$1({display:"flex",alignItems:"center",justifyContent:"center"},s),pt&&React$1.createElement(Icon$1,{fontSize:"large"},pt.isRemote?"headset_mic":"mic"),React$1.createElement("audio",{id:tt,ref:ct,autoPlay:st,muted:gt}))}var W="AudioEnableButton";function j$1(a){var o,_e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(W)}),tt=_e.id,rt=tt===void 0?"audio-enable-btn":tt,st=_e.enabledTooltip,at=st===void 0?"Audio enabled, click to disable":st,ut=_e.disabledTooltip,s=ut===void 0?"Audio disabled, click to enable":ut,et=_e.noAudioTooltip,ot=et===void 0?"No Audio":et,lt=_e.tooltipProps,St=lt===void 0?{placement:"left",arrow:!0}:lt,pt=x(_e,["id","enabledTooltip","disabledTooltip","noAudioTooltip","tooltipProps"]),gt=(o=_e["aria-label"])!==null&&o!==void 0?o:"enable or disable audio",ct=reactExports.useReducer(function(mt){return mt+1},0)[1],ht=reactExports.useContext(I$1).stream;reactExports.useEffect(function(){if(ht){var mt=function(Tt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(W+"|onAudioFlowStatusChanged",ht,Tt,ht.isAudioEnabled()),ct()};return ht.on("audioFlowStatusChanged",mt),ht.on("remoteAudioFlowStatusChanged",mt),function(){ht.removeListener("audioFlowStatusChanged",mt),ht.removeListener("remoteAudioFlowStatusChanged",mt)}}},[ht]);var it=function(){ht!=null&&ht.isAudioEnabled()?(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(W+"|stream.disableAudio",ht==null?void 0:ht.isAudioEnabled()),ht==null||ht.disableAudio(!0).catch(function(mt){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(W+"|stream.disableAudio failed",mt)})):(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(W+"|stream.enableAudio",ht==null?void 0:ht.isAudioEnabled()),ht==null||ht.enableAudio(!0).catch(function(mt){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(W+"|stream.enableAudio failed",mt)})),ct()},ft=ht&&ht.hasAudio()?ht.isAudioEnabled()?at:s:ot;return React$1.createElement(Tooltip$1,A$1({title:ft},St),React$1.createElement("span",null,React$1.createElement(IconButton$1,A$1({id:rt,"aria-label":gt},pt,{disabled:_e.disabled||ht&&!ht.hasAudio(),onClick:function(mt){mt.preventDefault(),mt.stopPropagation(),it()},onKeyDown:function(mt){mt.preventDefault(),mt.key!==" "||ht!=null&&ht.isAudioEnabled()||it()},onKeyUp:function(mt){mt.preventDefault(),mt.key===" "&&(ht!=null&&ht.isAudioEnabled())&&it()}}),ht&&ht.hasAudio()&&ht.isAudioEnabled()?React$1.createElement(Icon$1,{fontSize:_e.size},"mic"):React$1.createElement(Icon$1,{fontSize:_e.size},"mic_off"))))}var B="MuteButton";function _$1(a){var o;globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug("".concat(B,"|Rendering"));var _e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(B)}),tt=_e.id,rt=tt===void 0?"mute-btn":tt,st=_e.mutedTooltip,at=st===void 0?"Muted":st,ut=_e.unmutedTooltip,s=ut===void 0?"On":ut,et=_e.noAudioTooltip,ot=et===void 0?"No Audio":et,lt=_e.tooltipProps,St=lt===void 0?{placement:"left",arrow:!0}:lt,pt=x(_e,["id","mutedTooltip","unmutedTooltip","noAudioTooltip","tooltipProps"]),gt=(o=_e["aria-label"])!==null&&o!==void 0?o:"mute",ct=reactExports.useContext(I$1),ht=ct.stream,it=ct.muted,ft=ct.toggleMuted,mt=ht&&ht.hasAudio()?it?at:s:ot,Tt=ht&&ht.hasAudio()?it?React$1.createElement(Icon$1,{fontSize:_e.size},"volume_off"):React$1.createElement(Icon$1,{fontSize:_e.size},"volume_up"):React$1.createElement(Icon$1,{fontSize:_e.size},"volume_off");return React$1.createElement(Tooltip$1,A$1({title:mt},St),React$1.createElement("span",null,React$1.createElement(IconButton$1,A$1({id:rt,"aria-label":gt},pt,{disabled:a.disabled||ht&&!ht.hasAudio(),onClick:function(It){It.preventDefault(),It.stopPropagation(),ft()}}),Tt)))}var q=function(a){var o=reactExports.useState(a),_e=o[0],tt=o[1],rt=reactExports.useCallback(function(){tt(function(st){return!st})},[]);return reactExports.useEffect(function(){tt(a)},[a]),reactExports.useMemo(function(){return{value:_e,setValue:tt,toggle:rt}},[_e,rt])},N$1={border:1,borderColor:"primary.main"},G="Stream";function K(a){var o=a.id,_e=a.children,tt=a.controls,rt=a.detectSpeaking,st=rt!==void 0&&rt,at=a.muted,ut=at!==void 0&&at,s=a.name,et=a.nameColor,ot=et===void 0?void 0:et,lt=a.stream,St=a.sx,pt=x(a,["id","children","controls","detectSpeaking","muted","name","nameColor","stream","sx"]);globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(G+"|Rendering");var gt=q(ut),ct=gt.value,ht=gt.toggle,it=reactExports.useState(!1),ft=it[0],mt=it[1],Tt=reactExports.useRef(null),It=reactExports.useRef(null),Pt=reactExports.useState({height:0,width:0}),At=Pt[0],Nt=Pt[1],Ot=reactExports.useState({height:0,width:0}),Mt=Ot[0],bt=Ot[1];reactExports.useEffect(function(){if(lt&&st){var zt=lt,Bt=function(rn){mt(rn.isSpeaking)};return zt.on("audioAmplitude",Bt),function(){zt.removeListener("audioAmplitude",Bt)}}},[lt,st]),reactExports.useEffect(function(){var zt=Tt.current;if(zt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(G+"|setSize",zt.clientHeight,zt.clientWidth),Nt({height:zt.clientHeight,width:zt.clientWidth});var Bt=new ResizeObserver(function(){Nt({height:zt.clientHeight,width:zt.clientWidth})});return Bt.observe(zt),function(){Bt.disconnect()}}},[Tt]),reactExports.useEffect(function(){var zt=It.current;if(zt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(G+"|setControlsSize",zt.clientHeight,zt.clientWidth),bt({height:zt.clientHeight,width:zt.clientWidth});var Bt=new ResizeObserver(function(){bt({height:zt.clientHeight,width:zt.clientWidth})});return Bt.observe(zt),function(){Bt.disconnect()}}},[It]);var Wt=reactExports.useMemo(function(){return Math.max(Math.ceil(.01*At.width),4)},[At]);return React$1.createElement(I$1.Provider,{value:{stream:lt,muted:ct,toggleMuted:ht}},React$1.createElement(Box$1,A$1({id:o,ref:Tt,sx:A$1(A$1(A$1({minHeight:Mt.height+2*Wt+(s?36:0),minWidth:tt?Math.max(2*Mt.width,40)+Wt:0},St),{position:"relative"}),ft&&N$1),display:"flex",justifyContent:"center",alignItems:"center"},pt),_e,s&&React$1.createElement(Chip$1,{sx:{position:"absolute",top:Wt,left:"50%",transform:"translate(-50%)",opacity:.9},label:s,color:ot}),React$1.createElement(Stack$1,{ref:It,sx:{position:"absolute",float:"right",bottom:Wt,right:Wt,opacity:.9}},tt)))}var Q="Video";function X(a){var o,_e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(Q)}),tt=_e.id,rt=tt===void 0?(o=_e.stream)===null||o===void 0?void 0:o.getId():tt,st=_e.sx,at=_e.style,ut=_e.autoPlay,s=ut===void 0||ut,et=_e.muted,ot=_e.pointer,lt=_e.pointerColor,St=_e.progressColor,pt=_e.stream,gt=_e.sinkId,ct=_e.videoMutedTooltip,ht=ct===void 0?"Video muted":ct,it=x(_e,["id","sx","style","autoPlay","muted","pointer","pointerColor","progressColor","stream","sinkId","videoMutedTooltip"]),ft=reactExports.useContext(I$1),mt=ft.stream,Tt=ft.muted,It=Tt!==void 0&&Tt,Pt=reactExports.useMemo(function(){return pt??mt},[mt,pt]),At=reactExports.useMemo(function(){return et??It},[It,et]),Nt=reactExports.useRef(null),Ot=reactExports.useState(!1),Mt=Ot[0],bt=Ot[1];return reactExports.useEffect(function(){var Wt=Nt==null?void 0:Nt.current;if(Pt&&Wt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Q+"|useEffect stream",Wt,Pt),Pt.attachToElement(Wt);var zt=function(Bt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Q+"|onVideoFlowStatusChanged",Pt,Bt),bt(Bt.muted)};return Pt.on("videoFlowStatusChanged",zt),Pt.on("remoteVideoFlowStatusChanged",zt),function(){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Q+"|useEffect stream destroy"),Wt.src="",Pt.removeListener("audioFlowStatusChanged",zt),Pt.removeListener("remoteAudioFlowStatusChanged",zt)}}},[Pt]),reactExports.useEffect(function(){var Wt=Nt==null?void 0:Nt.current;Wt&&gt&&Wt.setSinkId&&Wt.setSinkId(gt)},[gt]),React$1.createElement(Box$1,A$1({sx:A$1(A$1({},st),{position:"relative"})},it),React$1.createElement("video",{id:rt,ref:Nt,style:at,autoPlay:s,muted:At}),ot&&React$1.createElement(Icon$1,{sx:{position:"absolute",top:ot.top,left:ot.left,transform:"translate(-50%,-50%)",opacity:.9},color:lt},"adjust"),Mt&&React$1.createElement(Tooltip$1,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",opacity:.9},title:ht},React$1.createElement(M,{color:St})))}var Y="VideoEnableButton";function Z(a){var o,_e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(Y)}),tt=_e.id,rt=tt===void 0?"video-enable-btn":tt,st=_e.enabledTooltip,at=st===void 0?"Video enabled, click to disable":st,ut=_e.disabledTooltip,s=ut===void 0?"Video disabled, click to enable":ut,et=_e.noVideoTooltip,ot=et===void 0?"No Video":et,lt=_e.tooltipProps,St=lt===void 0?{placement:"left",arrow:!0}:lt,pt=x(_e,["id","enabledTooltip","disabledTooltip","noVideoTooltip","tooltipProps"]),gt=(o=_e["aria-label"])!==null&&o!==void 0?o:"enable or disable video",ct=reactExports.useReducer(function(ft){return ft+1},0)[1],ht=reactExports.useContext(I$1).stream;reactExports.useEffect(function(){if(ht){var ft=function(mt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Y+"|onVideoFlowStatusChanged",ht,mt,ht.isVideoEnabled()),ct()};return ht.on("videoFlowStatusChanged",ft),ht.on("remoteVideoFlowStatusChanged",ft),function(){ht.removeListener("videoFlowStatusChanged",ft),ht.removeListener("remoteVideoFlowStatusChanged",ft)}}},[ht]);var it=ht&&ht.hasVideo()?ht.isVideoEnabled()?at:s:ot;return React$1.createElement(Tooltip$1,A$1({title:it},St),React$1.createElement("span",null,React$1.createElement(IconButton$1,A$1({id:rt,"aria-label":gt},pt,{disabled:_e.disabled||ht&&!ht.hasVideo(),onClick:function(ft){ft.preventDefault(),ft.stopPropagation(),ht!=null&&ht.isVideoEnabled()?(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Y+"|stream.disableVideo",ht==null?void 0:ht.isVideoEnabled()),ht==null||ht.disableVideo(!0).catch(function(mt){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(Y+"|stream.disableVideo failed",mt)})):(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Y+"|stream.enableVideo",ht==null?void 0:ht.isVideoEnabled()),ht==null||ht.enableVideo(!0).catch(function(mt){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(Y+"|stream.enableVideo failed",mt)})),ct()}}),ht&&ht.hasVideo()&&ht.isVideoEnabled()?React$1.createElement(Icon$1,{fontSize:_e.size},"videocam"):React$1.createElement(Icon$1,{fontSize:_e.size},"videocam_off"))))}var $={components:{ApiRtcMuiReactLibAudioEnableButton:{defaultProps:{"aria-label":"activer ou désactiver l'audio",enabledTooltip:"Audio activé, cliquer pour désactiver",disabledTooltip:"Audio désactivé, cliquer pour activer",noAudioTooltip:"Pas d'audio"}},ApiRtcMuiReactLibMuteButton:{defaultProps:{"aria-label":"activer ou désactiver le son",mutedTooltip:"Son désactivé, cliquer pour activer",unmutedTooltip:"Son activé, cliquer pour désactiver",noAudioTooltip:"Pas d'audio"}},ApiRtcMuiReactLibPublishOptions:{defaultProps:{labelText:"Options de publication",audioAndVideoText:"Audio et Vidéo",audioOnlyText:"Audio seul",videoOnlyText:"Vidéo seule"}},ApiRtcMuiReactLibSnapshotButton:{defaultProps:{"aria-label":"photo",snapshotTooltip:"Prendre une photo"}},ApiRtcMuiReactLibTorchButton:{defaultProps:{"aria-label":"torche",torchOffTooltip:"Eteindre la torche",torchOnTooltip:"Allumer la torche"}},ApiRtcMuiReactLibVideo:{defaultProps:{videoMutedTooltip:"Vidéo coupée"}},ApiRtcMuiReactLibVideoEnableButton:{defaultProps:{"aria-label":"activer ou désactiver la vidéo",enabledTooltip:"Vidéo activée, cliquer pour désactiver",disabledTooltip:"Vidéo désactivée, cliquer pour activer",noVideoTooltip:"Pas de Vidéo"}}}},ee={level:"info",isDebugEnabled:!1,isInfoEnabled:!0,isWarnEnabled:!0};function te(a){switch(a){case"debug":globalThis.apirtcMuiReactLibLogLevel={level:"debug",isDebugEnabled:!0,isInfoEnabled:!0,isWarnEnabled:!0};break;case"info":default:globalThis.apirtcMuiReactLibLogLevel=ee;break;case"warn":globalThis.apirtcMuiReactLibLogLevel={level:"warn",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!0};break;case"error":globalThis.apirtcMuiReactLibLogLevel={level:"error",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!1}}return globalThis.apirtcMuiReactLibLogLevel}globalThis.apirtcMuiReactLibLogLevel=ee,globalThis.setApirtcMuiReactLibLogLevel=te;const c="useCameraStream";function b(a,o={},_e){const[tt,rt]=reactExports.useState(),[st,at]=reactExports.useState(!1);return reactExports.useEffect(()=>{if(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${c}|useEffect`,a,o),a){const ut=a.getUserAgent();at(!0),ut.createStream(o).then(s=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${c}|createStream`,o,s),rt(s)}).catch(s=>{console.error(`${c}|createStream error`,o,s),rt(void 0),_e&&_e(s)}).finally(()=>{at(!1)})}else rt(void 0)},[a,JSON.stringify(o)]),reactExports.useEffect(()=>{const ut=tt;if(ut)return()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${c}|release stream`,ut),ut.release()}},[tt]),{stream:tt,grabbing:st}}const g="useConversation";function d(a,o,_e,tt=!0,rt){const[st,at]=reactExports.useState(),[ut,s]=reactExports.useState(!1),[et,ot]=reactExports.useState(!1),lt=reactExports.useCallback((pt={})=>(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|join`,st,pt),new Promise((gt,ct)=>{st?st.isJoined()?ct(`${g}|join|conversation already joined`):(ot(!0),st.join(pt).then(()=>{s(!0),gt()}).catch(ht=>{ct(ht)}).finally(()=>{ot(!1)})):ct(`${g}|join|conversation not defined`)})),[st]),St=reactExports.useCallback(()=>(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|leave`,st),new Promise((pt,gt)=>{st?st.isJoined()?st.leave().then(()=>{s(!1),pt()}).catch(ct=>{gt(ct)}):gt(`${g}|leave|conversation is not joined`):gt(`${g}|leave|conversation not defined`)})),[st]);return reactExports.useEffect(()=>{if(a&&o){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|getOrCreateConversation`,o,_e,tt);const pt=a.getOrCreateConversation(o,_e);return at(pt),()=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|useEffect cleanup`,o,_e,tt),pt.isJoined()?pt.leave().then(()=>{}).catch(gt=>{globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${g}|useEffect conversation.leave()`,gt)}).finally(()=>{pt.destroy()}):pt.destroy(),at(void 0),s(!1)}}},[a,o,JSON.stringify(_e)]),reactExports.useEffect(()=>{if(st&&tt){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|useEffect`,st,tt,rt);const pt=st,gt=tt;return gt&&(ot(!0),pt.join(rt).then(()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${g}|joined`,pt),s(!0)}).catch(ct=>{globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${g}|useEffect conversation.join() error`,pt,rt,ct)}).finally(()=>{ot(!1)})),()=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|useEffect cleanup`,pt,gt),pt.isJoined()&&pt.leave().then(()=>{s(!1)}).catch(ct=>{globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${g}|useEffect conversation.leave() error`,pt,ct)})}}},[st,tt,JSON.stringify(rt)]),{conversation:st,joining:et,joined:ut,join:lt,leave:St}}function m(a){return a!=null}const E="useConversationStreams";function T(a,o=[],_e){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${E}|hook render|${a==null?void 0:a.getName()}`,o.map(pt=>pt==null?void 0:pt.options));const tt=reactExports.useRef([]),[rt,st]=reactExports.useState(new Array),[at,ut]=reactExports.useState(new Array),s=reactExports.useCallback((pt,gt)=>new Promise((ct,ht)=>{a&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${E}|publish|${a.getName()}`,pt,gt),a.publish(pt,gt).then(it=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${E}|published|${a.getName()}`,it),st(ft=>[...ft,it]),ct(it)}).catch(it=>{ht(it)}))}),[a]),et=reactExports.useCallback((pt,gt)=>new Promise((ct,ht)=>{a&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${E}|replacePublishedStream|${a.getName()}|${pt.getId()} -> ${gt.getId()}`),a.replacePublishedStream(pt,gt).then(it=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${E}|stream replaced|${a.getName()}`,pt,it),st(ft=>{const mt=ft.indexOf(pt);return mt>=0&&ft.splice(mt,1,it),Array.from(ft)}),ct(it)}).catch(it=>{ht(it)}))}),[a]),ot=reactExports.useCallback(pt=>{a&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${E}|unpublish|${a.getName()}`,pt.getId(),pt),a.unpublish(pt),st(gt=>gt.filter(ct=>ct!==pt)))},[a]),lt=reactExports.useCallback(()=>{const pt=Math.max(tt.current.length,o.length);globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${E}|doHandlePublication`,o,JSON.stringify(tt.current.map(ft=>ft==null?void 0:ft.stream.getId())),JSON.stringify(o.map(ft=>ft==null?void 0:ft.stream.getId())),pt);const gt=[...tt.current],ct=o.map(ft=>ft&&ft.options?{stream:ft.stream,options:Object.assign({},ft.options)}:ft);tt.current.length=0,tt.current.push(...ct);const ht=new Set(o.filter(m).map(ft=>ft.stream)),it=(ft,mt)=>{s(mt.stream,mt.options).catch(Tt=>{tt.current.splice(ft,1,null),_e?_e(Tt):globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${E}|publish|error`,Tt)})};for(let ft=0;ft<pt;ft++){const mt=gt[ft],Tt=o[ft];if(mt&&Tt){const It=()=>{ot(mt.stream),it(ft,Tt)};mt.stream===Tt.stream?JSON.stringify(mt.options)!==JSON.stringify(Tt.options)&&It():ht.has(mt.stream)?a&&!a.isPublishedStream(Tt.stream)&&it(ft,Tt):a&&!a.isPublishedStream(Tt.stream)?JSON.stringify(mt.options)===JSON.stringify(Tt.options)?et(mt.stream,Tt.stream).catch(Pt=>{tt.current.splice(ft,1,null),_e?_e(Pt):globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${E}|replacePublishedStream|error`,Pt)}):It():ot(mt.stream)}else mt&&!Tt?ht.has(mt.stream)||ot(mt.stream):!mt&&Tt&&a&&!a.isPublishedStream(Tt.stream)&&it(ft,Tt)}},[a,JSON.stringify(o.map(pt=>(pt==null?void 0:pt.stream.getId())+"-"+JSON.stringify(pt==null?void 0:pt.options))),s,ot,et]),St=pt=>{st(gt=>(gt.forEach(ct=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${E}|unpublish|${pt.getName()}`,ct),pt.unpublish(ct)}),new Array)),tt.current.length=0,ut(gt=>(gt.forEach(ct=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${E}|unsubscribeToStream|${pt.getName()}`,ct),pt.unsubscribeToStream(ct.getId())}),new Array))};return reactExports.useEffect(()=>{if(a){const pt=ht=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${E}|on_streamAdded|${a.getName()}`,ht),ut(it=>[...it,ht])},gt=ht=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${E}|on_streamRemoved|${a.getName()}`,ht),ut(it=>it.filter(ft=>ft!==ht))},ct=ht=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${E}|on_streamListChanged|${a.getName()}`,ht);const it=String(ht.streamId);ht.isRemote===!0&&(ht.listEventType==="added"?a.subscribeToStream(it):ht.listEventType==="removed"&&a.unsubscribeToStream(it))};return a.on("streamAdded",pt),a.on("streamRemoved",gt),a.on("streamListChanged",ct),()=>{a.removeListener("streamListChanged",ct),a.removeListener("streamRemoved",gt),a.removeListener("streamAdded",pt),St(a)}}},[a]),reactExports.useEffect(()=>{if(a){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${E}|useEffect doHandlePublication|${a.getName()}`);const pt=()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${E}|on_joined|${a.getName()}`,o),lt()},gt=()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${E}|on_left|${a.getName()}`),St(a)};return a.on("joined",pt),a.on("left",gt),a.isJoined()&&lt(),()=>{a.removeListener("joined",pt),a.removeListener("left",gt)}}},[lt]),{publishedStreams:rt,subscribedStreams:at,publish:s,unpublish:ot,replacePublishedStream:et}}const y="useSession";function I(a,o,_e){const[tt,rt]=reactExports.useState(),[st,at]=reactExports.useState(!1);reactExports.useEffect(()=>{if(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${y}|useEffect credentials, options`,a,o),a)return ut(a,o).catch(s=>{console.error(`${y}|connection failed`,s),rt(void 0),_e?_e(s):globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${y}|connect|error`,s)}),()=>{rt(void 0),at(!1)}},[JSON.stringify(a),JSON.stringify(o)]),reactExports.useEffect(()=>{if(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${y}|useEffect session`,tt),tt){const s=tt;return()=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${y}|useEffect session cleanup`,s),s.disconnect().then(()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${y}|disconnected`,s)}).catch(et=>{console.error(`${y}|disconnect`,et)})}}},[tt]);const ut=(s,et)=>new Promise((ot,lt)=>{const St=et||{cloudUrl:"https://cloud.apirtc.com"};let pt;if(typeof(gt=s)=="object"&&"username"in gt)St.password=s.password,pt=new apiRTC_minExports.UserAgent({uri:"apirtc:"+s.username});else if(function(ct){return typeof ct=="object"&&"apiKey"in ct}(s))pt=new apiRTC_minExports.UserAgent({uri:`apiKey:${s.apiKey}`});else{if(!function(ct){return typeof ct=="object"&&"token"in ct}(s))return void lt("credentials not recognized");pt=new apiRTC_minExports.UserAgent({uri:`token:${s.token}`})}var gt;at(!0),pt.register(St).then(ct=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${y}|connected`,ct),rt(ct),ot()}).catch(ct=>{lt(ct)}).finally(()=>{at(!1)})});return{session:tt,connecting:st,connect:ut,disconnect:()=>{rt(void 0)}}}const D="useUserMediaDevices",N=a=>{try{const o=localStorage.getItem(a),_e=o?JSON.parse(o):null;return _e?new apiRTC_minExports.MediaDevice(_e.id,_e.type,_e.label):void 0}catch(o){return void console.warn(`${D}|getMediaDeviceFromLocalStorage`,o)}},J=(a,o)=>{try{localStorage.setItem(a,o)}catch{}};function O(a,o){const _e=o+".audioIn",tt=o+".audioOut",rt=o+".videoIn",[st,at]=reactExports.useState(o?N(_e):void 0),[ut,s]=reactExports.useState(o?N(tt):void 0),[et,ot]=reactExports.useState(o?N(rt):void 0),lt=reactExports.useMemo(()=>({audioinput:st?{[st.getId()]:st}:{},audiooutput:ut?{[ut.getId()]:ut}:{},videoinput:et?{[et.getId()]:et}:{}}),[st,ut,et]),[St,pt]=reactExports.useState(lt);return reactExports.useEffect(()=>{if(a){const gt=a.getUserAgent(),ct=()=>{const ht=gt.getUserMediaDevices();if(globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${D}|mediaDeviceChanged`,ht),pt(ht),o){const it=N(_e);it&&at(ht.audioinput[it.getId()]);const ft=N(tt);ft&&s(ht.audiooutput[ft.getId()]);const mt=N(rt);mt&&ot(ht.videoinput[mt.getId()]),globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${D}|userMediaDevices, audioIn, audioOut, videoIn`,ht,it==null?void 0:it.getId(),ft==null?void 0:ft.getId(),mt==null?void 0:mt.getId())}};return gt.on("mediaDeviceChanged",ct),()=>{gt.removeListener("mediaDeviceChanged",ct),pt(lt)}}},[a]),reactExports.useEffect(()=>{st&&o&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${D}|Storing audioIn`,st),J(_e,JSON.stringify({id:st.getId(),type:st.getType(),label:st.getLabel()})))},[st==null?void 0:st.getId()]),reactExports.useEffect(()=>{ut&&o&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${D}|Storing audioOut`,ut),J(tt,JSON.stringify({id:ut.getId(),type:ut.getType(),label:ut.getLabel()})))},[ut==null?void 0:ut.getId()]),reactExports.useEffect(()=>{et&&o&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${D}|Storing videoIn`,et),J(rt,JSON.stringify({id:et.getId(),type:et.getType(),label:et.getLabel()})))},[et==null?void 0:et.getId()]),{userMediaDevices:St,selectedAudioIn:st,setSelectedAudioIn:at,selectedAudioOut:ut,setSelectedAudioOut:s,selectedVideoIn:et,setSelectedVideoIn:ot}}const j={level:"info",isDebugEnabled:!1,isInfoEnabled:!0,isWarnEnabled:!0};function A(a){switch(a){case"debug":globalThis.apirtcReactLibLogLevel={level:"debug",isDebugEnabled:!0,isInfoEnabled:!0,isWarnEnabled:!0};break;case"info":default:globalThis.apirtcReactLibLogLevel=j;break;case"warn":globalThis.apirtcReactLibLogLevel={level:"warn",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!0};break;case"error":globalThis.apirtcReactLibLogLevel={level:"error",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!1}}return globalThis.apirtcReactLibLogLevel}globalThis.apirtcReactLibLogLevel=j,globalThis.setApirtcReactLibLogLevel=A;function getAlertUtilityClass(a){return generateUtilityClass("MuiAlert",a)}const alertClasses=generateUtilityClasses("MuiAlert",["root","action","icon","message","filled","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),alertClasses$1=alertClasses,SuccessOutlinedIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),ReportProblemOutlinedIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),ErrorOutlineIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),InfoOutlinedIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),ClearIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),_excluded$7=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],useUtilityClasses$7=a=>{const{variant:o,color:_e,severity:tt,classes:rt}=a,st={root:["root",`${o}${capitalize(_e||tt)}`,`${o}`],icon:["icon"],message:["message"],action:["action"]};return composeClasses(st,getAlertUtilityClass,rt)},AlertRoot=styled$1(Paper$1,{name:"MuiAlert",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],o[`${_e.variant}${capitalize(_e.color||_e.severity)}`]]}})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light"?darken:lighten,tt=a.palette.mode==="light"?lighten:darken,rt=o.color||o.severity;return _extends({},a.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},rt&&o.variant==="standard"&&{color:a.vars?a.vars.palette.Alert[`${rt}Color`]:_e(a.palette[rt].light,.6),backgroundColor:a.vars?a.vars.palette.Alert[`${rt}StandardBg`]:tt(a.palette[rt].light,.9),[`& .${alertClasses$1.icon}`]:a.vars?{color:a.vars.palette.Alert[`${rt}IconColor`]}:{color:a.palette[rt].main}},rt&&o.variant==="outlined"&&{color:a.vars?a.vars.palette.Alert[`${rt}Color`]:_e(a.palette[rt].light,.6),border:`1px solid ${(a.vars||a).palette[rt].light}`,[`& .${alertClasses$1.icon}`]:a.vars?{color:a.vars.palette.Alert[`${rt}IconColor`]}:{color:a.palette[rt].main}},rt&&o.variant==="filled"&&_extends({fontWeight:a.typography.fontWeightMedium},a.vars?{color:a.vars.palette.Alert[`${rt}FilledColor`],backgroundColor:a.vars.palette.Alert[`${rt}FilledBg`]}:{backgroundColor:a.palette.mode==="dark"?a.palette[rt].dark:a.palette[rt].main,color:a.palette.getContrastText(a.palette[rt].main)}))}),AlertIcon=styled$1("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(a,o)=>o.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),AlertMessage=styled$1("div",{name:"MuiAlert",slot:"Message",overridesResolver:(a,o)=>o.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),AlertAction=styled$1("div",{name:"MuiAlert",slot:"Action",overridesResolver:(a,o)=>o.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),defaultIconMapping={success:jsxRuntimeExports.jsx(SuccessOutlinedIcon,{fontSize:"inherit"}),warning:jsxRuntimeExports.jsx(ReportProblemOutlinedIcon,{fontSize:"inherit"}),error:jsxRuntimeExports.jsx(ErrorOutlineIcon,{fontSize:"inherit"}),info:jsxRuntimeExports.jsx(InfoOutlinedIcon,{fontSize:"inherit"})},Alert=reactExports.forwardRef(function(o,_e){var tt,rt,st,at,ut,s;const et=useThemeProps({props:o,name:"MuiAlert"}),{action:ot,children:lt,className:St,closeText:pt="Close",color:gt,components:ct={},componentsProps:ht={},icon:it,iconMapping:ft=defaultIconMapping,onClose:mt,role:Tt="alert",severity:It="success",slotProps:Pt={},slots:At={},variant:Nt="standard"}=et,Ot=_objectWithoutPropertiesLoose(et,_excluded$7),Mt=_extends({},et,{color:gt,severity:It,variant:Nt}),bt=useUtilityClasses$7(Mt),Wt=(tt=(rt=At.closeButton)!=null?rt:ct.CloseButton)!=null?tt:IconButton$1,zt=(st=(at=At.closeIcon)!=null?at:ct.CloseIcon)!=null?st:ClearIcon,Bt=(ut=Pt.closeButton)!=null?ut:ht.closeButton,rn=(s=Pt.closeIcon)!=null?s:ht.closeIcon;return jsxRuntimeExports.jsxs(AlertRoot,_extends({role:Tt,elevation:0,ownerState:Mt,className:clsx(bt.root,St),ref:_e},Ot,{children:[it!==!1?jsxRuntimeExports.jsx(AlertIcon,{ownerState:Mt,className:bt.icon,children:it||ft[It]||defaultIconMapping[It]}):null,jsxRuntimeExports.jsx(AlertMessage,{ownerState:Mt,className:bt.message,children:lt}),ot!=null?jsxRuntimeExports.jsx(AlertAction,{ownerState:Mt,className:bt.action,children:ot}):null,ot==null&&mt?jsxRuntimeExports.jsx(AlertAction,{ownerState:Mt,className:bt.action,children:jsxRuntimeExports.jsx(Wt,_extends({size:"small","aria-label":pt,title:pt,color:"inherit",onClick:mt},Bt,{children:jsxRuntimeExports.jsx(zt,_extends({fontSize:"small"},rn))}))}):null]}))}),Alert$1=Alert;function getButtonUtilityClass(a){return generateUtilityClass("MuiButton",a)}const buttonClasses=generateUtilityClasses("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),buttonClasses$1=buttonClasses,ButtonGroupContext=reactExports.createContext({}),ButtonGroupContext$1=ButtonGroupContext,ButtonGroupButtonContext=reactExports.createContext(void 0),ButtonGroupButtonContext$1=ButtonGroupButtonContext,_excluded$6=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],useUtilityClasses$6=a=>{const{color:o,disableElevation:_e,fullWidth:tt,size:rt,variant:st,classes:at}=a,ut={root:["root",st,`${st}${capitalize(o)}`,`size${capitalize(rt)}`,`${st}Size${capitalize(rt)}`,o==="inherit"&&"colorInherit",_e&&"disableElevation",tt&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${capitalize(rt)}`],endIcon:["endIcon",`iconSize${capitalize(rt)}`]},s=composeClasses(ut,getButtonUtilityClass,at);return _extends({},at,s)},commonIconStyles=a=>_extends({},a.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},a.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},a.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),ButtonRoot=styled$1(ButtonBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiButton",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],o[`${_e.variant}${capitalize(_e.color)}`],o[`size${capitalize(_e.size)}`],o[`${_e.variant}Size${capitalize(_e.size)}`],_e.color==="inherit"&&o.colorInherit,_e.disableElevation&&o.disableElevation,_e.fullWidth&&o.fullWidth]}})(({theme:a,ownerState:o})=>{var _e,tt;const rt=a.palette.mode==="light"?a.palette.grey[300]:a.palette.grey[800],st=a.palette.mode==="light"?a.palette.grey.A100:a.palette.grey[700];return _extends({},a.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create(["background-color","box-shadow","border-color","color"],{duration:a.transitions.duration.short}),"&:hover":_extends({textDecoration:"none",backgroundColor:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette.text.primary,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},o.variant==="text"&&o.color!=="inherit"&&{backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette[o.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},o.variant==="outlined"&&o.color!=="inherit"&&{border:`1px solid ${(a.vars||a).palette[o.color].main}`,backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette[o.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},o.variant==="contained"&&{backgroundColor:a.vars?a.vars.palette.Button.inheritContainedHoverBg:st,boxShadow:(a.vars||a).shadows[4],"@media (hover: none)":{boxShadow:(a.vars||a).shadows[2],backgroundColor:(a.vars||a).palette.grey[300]}},o.variant==="contained"&&o.color!=="inherit"&&{backgroundColor:(a.vars||a).palette[o.color].dark,"@media (hover: none)":{backgroundColor:(a.vars||a).palette[o.color].main}}),"&:active":_extends({},o.variant==="contained"&&{boxShadow:(a.vars||a).shadows[8]}),[`&.${buttonClasses$1.focusVisible}`]:_extends({},o.variant==="contained"&&{boxShadow:(a.vars||a).shadows[6]}),[`&.${buttonClasses$1.disabled}`]:_extends({color:(a.vars||a).palette.action.disabled},o.variant==="outlined"&&{border:`1px solid ${(a.vars||a).palette.action.disabledBackground}`},o.variant==="contained"&&{color:(a.vars||a).palette.action.disabled,boxShadow:(a.vars||a).shadows[0],backgroundColor:(a.vars||a).palette.action.disabledBackground})},o.variant==="text"&&{padding:"6px 8px"},o.variant==="text"&&o.color!=="inherit"&&{color:(a.vars||a).palette[o.color].main},o.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},o.variant==="outlined"&&o.color!=="inherit"&&{color:(a.vars||a).palette[o.color].main,border:a.vars?`1px solid rgba(${a.vars.palette[o.color].mainChannel} / 0.5)`:`1px solid ${alpha(a.palette[o.color].main,.5)}`},o.variant==="contained"&&{color:a.vars?a.vars.palette.text.primary:(_e=(tt=a.palette).getContrastText)==null?void 0:_e.call(tt,a.palette.grey[300]),backgroundColor:a.vars?a.vars.palette.Button.inheritContainedBg:rt,boxShadow:(a.vars||a).shadows[2]},o.variant==="contained"&&o.color!=="inherit"&&{color:(a.vars||a).palette[o.color].contrastText,backgroundColor:(a.vars||a).palette[o.color].main},o.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},o.size==="small"&&o.variant==="text"&&{padding:"4px 5px",fontSize:a.typography.pxToRem(13)},o.size==="large"&&o.variant==="text"&&{padding:"8px 11px",fontSize:a.typography.pxToRem(15)},o.size==="small"&&o.variant==="outlined"&&{padding:"3px 9px",fontSize:a.typography.pxToRem(13)},o.size==="large"&&o.variant==="outlined"&&{padding:"7px 21px",fontSize:a.typography.pxToRem(15)},o.size==="small"&&o.variant==="contained"&&{padding:"4px 10px",fontSize:a.typography.pxToRem(13)},o.size==="large"&&o.variant==="contained"&&{padding:"8px 22px",fontSize:a.typography.pxToRem(15)},o.fullWidth&&{width:"100%"})},({ownerState:a})=>a.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${buttonClasses$1.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${buttonClasses$1.disabled}`]:{boxShadow:"none"}}),ButtonStartIcon=styled$1("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.startIcon,o[`iconSize${capitalize(_e.size)}`]]}})(({ownerState:a})=>_extends({display:"inherit",marginRight:8,marginLeft:-4},a.size==="small"&&{marginLeft:-2},commonIconStyles(a))),ButtonEndIcon=styled$1("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.endIcon,o[`iconSize${capitalize(_e.size)}`]]}})(({ownerState:a})=>_extends({display:"inherit",marginRight:-4,marginLeft:8},a.size==="small"&&{marginRight:-2},commonIconStyles(a))),Button=reactExports.forwardRef(function(o,_e){const tt=reactExports.useContext(ButtonGroupContext$1),rt=reactExports.useContext(ButtonGroupButtonContext$1),st=resolveProps(tt,o),at=useThemeProps({props:st,name:"MuiButton"}),{children:ut,color:s="primary",component:et="button",className:ot,disabled:lt=!1,disableElevation:St=!1,disableFocusRipple:pt=!1,endIcon:gt,focusVisibleClassName:ct,fullWidth:ht=!1,size:it="medium",startIcon:ft,type:mt,variant:Tt="text"}=at,It=_objectWithoutPropertiesLoose(at,_excluded$6),Pt=_extends({},at,{color:s,component:et,disabled:lt,disableElevation:St,disableFocusRipple:pt,fullWidth:ht,size:it,type:mt,variant:Tt}),At=useUtilityClasses$6(Pt),Nt=ft&&jsxRuntimeExports.jsx(ButtonStartIcon,{className:At.startIcon,ownerState:Pt,children:ft}),Ot=gt&&jsxRuntimeExports.jsx(ButtonEndIcon,{className:At.endIcon,ownerState:Pt,children:gt}),Mt=rt||"";return jsxRuntimeExports.jsxs(ButtonRoot,_extends({ownerState:Pt,className:clsx(tt.className,At.root,ot,Mt),component:et,disabled:lt,focusRipple:!pt,focusVisibleClassName:clsx(At.focusVisible,ct),ref:_e,type:mt},It,{classes:At,children:[Nt,ut,Ot]}))}),Button$1=Button;function getCardUtilityClass(a){return generateUtilityClass("MuiCard",a)}generateUtilityClasses("MuiCard",["root"]);const _excluded$5=["className","raised"],useUtilityClasses$5=a=>{const{classes:o}=a;return composeClasses({root:["root"]},getCardUtilityClass,o)},CardRoot=styled$1(Paper$1,{name:"MuiCard",slot:"Root",overridesResolver:(a,o)=>o.root})(()=>({overflow:"hidden"})),Card=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiCard"}),{className:rt,raised:st=!1}=tt,at=_objectWithoutPropertiesLoose(tt,_excluded$5),ut=_extends({},tt,{raised:st}),s=useUtilityClasses$5(ut);return jsxRuntimeExports.jsx(CardRoot,_extends({className:clsx(s.root,rt),elevation:st?8:void 0,ref:_e,ownerState:ut},at))}),Card$1=Card;function getCardContentUtilityClass(a){return generateUtilityClass("MuiCardContent",a)}generateUtilityClasses("MuiCardContent",["root"]);const _excluded$4=["className","component"],useUtilityClasses$4=a=>{const{classes:o}=a;return composeClasses({root:["root"]},getCardContentUtilityClass,o)},CardContentRoot=styled$1("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(a,o)=>o.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),CardContent=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiCardContent"}),{className:rt,component:st="div"}=tt,at=_objectWithoutPropertiesLoose(tt,_excluded$4),ut=_extends({},tt,{component:st}),s=useUtilityClasses$4(ut);return jsxRuntimeExports.jsx(CardContentRoot,_extends({as:st,className:clsx(s.root,rt),ownerState:ut,ref:_e},at))}),CardContent$1=CardContent,Container=createContainer({createStyledComponent:styled$1("div",{name:"MuiContainer",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[`maxWidth${capitalize(String(_e.maxWidth))}`],_e.fixed&&o.fixed,_e.disableGutters&&o.disableGutters]}}),useThemeProps:a=>useThemeProps({props:a,name:"MuiContainer"})}),Container$1=Container;function getSkeletonUtilityClass(a){return generateUtilityClass("MuiSkeleton",a)}generateUtilityClasses("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const _excluded$3=["animation","className","component","height","style","variant","width"];let _=a=>a,_t,_t2,_t3,_t4;const useUtilityClasses$3=a=>{const{classes:o,variant:_e,animation:tt,hasChildren:rt,width:st,height:at}=a;return composeClasses({root:["root",_e,tt,rt&&"withChildren",rt&&!st&&"fitContent",rt&&!at&&"heightAuto"]},getSkeletonUtilityClass,o)},pulseKeyframe=keyframes(_t||(_t=_`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`)),waveKeyframe=keyframes(_t2||(_t2=_`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`)),SkeletonRoot=styled$1("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],_e.animation!==!1&&o[_e.animation],_e.hasChildren&&o.withChildren,_e.hasChildren&&!_e.width&&o.fitContent,_e.hasChildren&&!_e.height&&o.heightAuto]}})(({theme:a,ownerState:o})=>{const _e=getUnit(a.shape.borderRadius)||"px",tt=toUnitless(a.shape.borderRadius);return _extends({display:"block",backgroundColor:a.vars?a.vars.palette.Skeleton.bg:alpha(a.palette.text.primary,a.palette.mode==="light"?.11:.13),height:"1.2em"},o.variant==="text"&&{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${tt}${_e}/${Math.round(tt/.6*10)/10}${_e}`,"&:empty:before":{content:'"\\00a0"'}},o.variant==="circular"&&{borderRadius:"50%"},o.variant==="rounded"&&{borderRadius:(a.vars||a).shape.borderRadius},o.hasChildren&&{"& > *":{visibility:"hidden"}},o.hasChildren&&!o.width&&{maxWidth:"fit-content"},o.hasChildren&&!o.height&&{height:"auto"})},({ownerState:a})=>a.animation==="pulse"&&css(_t3||(_t3=_`
      animation: ${0} 2s ease-in-out 0.5s infinite;
    `),pulseKeyframe),({ownerState:a,theme:o})=>a.animation==="wave"&&css(_t4||(_t4=_`
      position: relative;
      overflow: hidden;

      /* Fix bug in Safari https://bugs.webkit.org/show_bug.cgi?id=68196 */
      -webkit-mask-image: -webkit-radial-gradient(white, black);

      &::after {
        animation: ${0} 2s linear 0.5s infinite;
        background: linear-gradient(
          90deg,
          transparent,
          ${0},
          transparent
        );
        content: '';
        position: absolute;
        transform: translateX(-100%); /* Avoid flash during server-side hydration */
        bottom: 0;
        left: 0;
        right: 0;
        top: 0;
      }
    `),waveKeyframe,(o.vars||o).palette.action.hover)),Skeleton=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiSkeleton"}),{animation:rt="pulse",className:st,component:at="span",height:ut,style:s,variant:et="text",width:ot}=tt,lt=_objectWithoutPropertiesLoose(tt,_excluded$3),St=_extends({},tt,{animation:rt,component:at,variant:et,hasChildren:!!lt.children}),pt=useUtilityClasses$3(St);return jsxRuntimeExports.jsx(SkeletonRoot,_extends({as:at,ref:_e,className:clsx(pt.root,st),ownerState:St},lt,{style:_extends({width:ot,height:ut},s)}))}),Skeleton$1=Skeleton,StepperContext=reactExports.createContext({}),StepperContext$1=StepperContext,StepContext=reactExports.createContext({}),StepContext$1=StepContext;function getStepUtilityClass(a){return generateUtilityClass("MuiStep",a)}generateUtilityClasses("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const _excluded$2=["active","children","className","component","completed","disabled","expanded","index","last"],useUtilityClasses$2=a=>{const{classes:o,orientation:_e,alternativeLabel:tt,completed:rt}=a;return composeClasses({root:["root",_e,tt&&"alternativeLabel",rt&&"completed"]},getStepUtilityClass,o)},StepRoot=styled$1("div",{name:"MuiStep",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.orientation],_e.alternativeLabel&&o.alternativeLabel,_e.completed&&o.completed]}})(({ownerState:a})=>_extends({},a.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},a.alternativeLabel&&{flex:1,position:"relative"})),Step=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiStep"}),{active:rt,children:st,className:at,component:ut="div",completed:s,disabled:et,expanded:ot=!1,index:lt,last:St}=tt,pt=_objectWithoutPropertiesLoose(tt,_excluded$2),{activeStep:gt,connector:ct,alternativeLabel:ht,orientation:it,nonLinear:ft}=reactExports.useContext(StepperContext$1);let[mt=!1,Tt=!1,It=!1]=[rt,s,et];gt===lt?mt=rt!==void 0?rt:!0:!ft&&gt>lt?Tt=s!==void 0?s:!0:!ft&&gt<lt&&(It=et!==void 0?et:!0);const Pt=reactExports.useMemo(()=>({index:lt,last:St,expanded:ot,icon:lt+1,active:mt,completed:Tt,disabled:It}),[lt,St,ot,mt,Tt,It]),At=_extends({},tt,{active:mt,orientation:it,alternativeLabel:ht,completed:Tt,disabled:It,expanded:ot,component:ut}),Nt=useUtilityClasses$2(At),Ot=jsxRuntimeExports.jsxs(StepRoot,_extends({as:ut,className:clsx(Nt.root,at),ref:_e,ownerState:At},pt,{children:[ct&&ht&&lt!==0?ct:null,st]}));return jsxRuntimeExports.jsx(StepContext$1.Provider,{value:Pt,children:ct&&!ht&&lt!==0?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[ct,Ot]}):Ot})}),Step$1=Step,ErrorPage=({errorType:a})=>{let o="An error occurred";switch(a){case 404:o="Invitation not found";break;case 500:o="Internal server error";break;case 401:o="You're not auhorized to join";break;default:o="An error occurred";break}return jsxRuntimeExports.jsx(Container$1,{maxWidth:"sm",sx:{height:"100vh"},children:jsxRuntimeExports.jsx(Box$1,{sx:{height:"100%"},display:"flex",alignItems:"center",justifyContent:"center",children:jsxRuntimeExports.jsx(Card$1,{children:jsxRuntimeExports.jsx(CardContent$1,{children:jsxRuntimeExports.jsx(Box$1,{children:jsxRuntimeExports.jsx(Typography$1,{variant:"h4",children:o})})})})})})};function getLinkUtilityClass(a){return generateUtilityClass("MuiLink",a)}const linkClasses=generateUtilityClasses("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),linkClasses$1=linkClasses,colorTransformations={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},transformDeprecatedColors=a=>colorTransformations[a]||a,getTextDecoration=({theme:a,ownerState:o})=>{const _e=transformDeprecatedColors(o.color),tt=getPath(a,`palette.${_e}`,!1)||o.color,rt=getPath(a,`palette.${_e}Channel`);return"vars"in a&&rt?`rgba(${rt} / 0.4)`:alpha(tt,.4)},getTextDecoration$1=getTextDecoration,_excluded$1=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],useUtilityClasses$1=a=>{const{classes:o,component:_e,focusVisible:tt,underline:rt}=a,st={root:["root",`underline${capitalize(rt)}`,_e==="button"&&"button",tt&&"focusVisible"]};return composeClasses(st,getLinkUtilityClass,o)},LinkRoot=styled$1(Typography$1,{name:"MuiLink",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[`underline${capitalize(_e.underline)}`],_e.component==="button"&&o.button]}})(({theme:a,ownerState:o})=>_extends({},o.underline==="none"&&{textDecoration:"none"},o.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},o.underline==="always"&&_extends({textDecoration:"underline"},o.color!=="inherit"&&{textDecorationColor:getTextDecoration$1({theme:a,ownerState:o})},{"&:hover":{textDecorationColor:"inherit"}}),o.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${linkClasses$1.focusVisible}`]:{outline:"auto"}})),Link=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiLink"}),{className:rt,color:st="primary",component:at="a",onBlur:ut,onFocus:s,TypographyClasses:et,underline:ot="always",variant:lt="inherit",sx:St}=tt,pt=_objectWithoutPropertiesLoose(tt,_excluded$1),{isFocusVisibleRef:gt,onBlur:ct,onFocus:ht,ref:it}=useIsFocusVisible(),[ft,mt]=reactExports.useState(!1),Tt=useForkRef(_e,it),It=Ot=>{ct(Ot),gt.current===!1&&mt(!1),ut&&ut(Ot)},Pt=Ot=>{ht(Ot),gt.current===!0&&mt(!0),s&&s(Ot)},At=_extends({},tt,{color:st,component:at,focusVisible:ft,underline:ot,variant:lt}),Nt=useUtilityClasses$1(At);return jsxRuntimeExports.jsx(LinkRoot,_extends({color:st,className:clsx(Nt.root,rt),classes:et,component:at,onBlur:It,onFocus:Pt,ref:Tt,ownerState:At,variant:lt,sx:[...Object.keys(colorTransformations).includes(st)?[]:[{color:st}],...Array.isArray(St)?St:[St]]},pt))}),Link$1=Link,CheckBoxOutlineBlankIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),CheckBoxIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),IndeterminateCheckBoxIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function getCheckboxUtilityClass(a){return generateUtilityClass("MuiCheckbox",a)}const checkboxClasses=generateUtilityClasses("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),checkboxClasses$1=checkboxClasses,_excluded=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],useUtilityClasses=a=>{const{classes:o,indeterminate:_e,color:tt,size:rt}=a,st={root:["root",_e&&"indeterminate",`color${capitalize(tt)}`,`size${capitalize(rt)}`]},at=composeClasses(st,getCheckboxUtilityClass,o);return _extends({},o,at)},CheckboxRoot=styled$1(SwitchBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.indeterminate&&o.indeterminate,_e.color!=="default"&&o[`color${capitalize(_e.color)}`]]}})(({theme:a,ownerState:o})=>_extends({color:(a.vars||a).palette.text.secondary},!o.disableRipple&&{"&:hover":{backgroundColor:a.vars?`rgba(${o.color==="default"?a.vars.palette.action.activeChannel:a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(o.color==="default"?a.palette.action.active:a.palette[o.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.color!=="default"&&{[`&.${checkboxClasses$1.checked}, &.${checkboxClasses$1.indeterminate}`]:{color:(a.vars||a).palette[o.color].main},[`&.${checkboxClasses$1.disabled}`]:{color:(a.vars||a).palette.action.disabled}})),defaultCheckedIcon=jsxRuntimeExports.jsx(CheckBoxIcon,{}),defaultIcon=jsxRuntimeExports.jsx(CheckBoxOutlineBlankIcon,{}),defaultIndeterminateIcon=jsxRuntimeExports.jsx(IndeterminateCheckBoxIcon,{}),Checkbox=reactExports.forwardRef(function(o,_e){var tt,rt;const st=useThemeProps({props:o,name:"MuiCheckbox"}),{checkedIcon:at=defaultCheckedIcon,color:ut="primary",icon:s=defaultIcon,indeterminate:et=!1,indeterminateIcon:ot=defaultIndeterminateIcon,inputProps:lt,size:St="medium",className:pt}=st,gt=_objectWithoutPropertiesLoose(st,_excluded),ct=et?ot:s,ht=et?ot:at,it=_extends({},st,{color:ut,indeterminate:et,size:St}),ft=useUtilityClasses(it);return jsxRuntimeExports.jsx(CheckboxRoot,_extends({type:"checkbox",inputProps:_extends({"data-indeterminate":et},lt),icon:reactExports.cloneElement(ct,{fontSize:(tt=ct.props.fontSize)!=null?tt:St}),checkedIcon:reactExports.cloneElement(ht,{fontSize:(rt=ht.props.fontSize)!=null?rt:St}),ownerState:it,ref:_e,className:clsx(ft.root,pt)},gt,{classes:ft}))}),Checkbox$1=Checkbox,OptIn=({id:a,checked:o,labels:_e,link:tt,onChange:rt})=>jsxRuntimeExports.jsx(FormControlLabel$1,{required:!0,control:jsxRuntimeExports.jsx(Checkbox$1,{id:`${a}`,"data-testid":`${a}`,checked:o,onChange:()=>rt(a),inputProps:{"aria-label":_e.aria}}),label:jsxRuntimeExports.jsxs(Typography$1,{variant:"body1",component:"span",children:[_e.prefix,jsxRuntimeExports.jsx(Link$1,{target:"_blank",href:tt,color:"info.main",children:_e.link})]}),sx:{".MuiFormControlLabel-asterisk":{display:"none"}}}),OptInList=({labels:a,optIns:o,onSubmit:_e})=>{const[tt,rt]=reactExports.useState(Object.assign({},...o.map(at=>({[at.id]:!1})))),st=at=>{rt({...tt,[at]:!tt[at]})};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(FormGroup$1,{children:o.map(at=>jsxRuntimeExports.jsx(OptIn,{id:at.id,checked:tt[at.id],onChange:st,labels:at.labels,link:at.link},at.id))}),jsxRuntimeExports.jsx(Box$1,{sx:{display:"flex",justifyContent:"end",mt:1},children:jsxRuntimeExports.jsx(Button$1,{variant:"outlined",disabled:!Object.values(tt).every(at=>at),onClick:_e,children:a.submit})})]})},TextStepper=({activeStep:a,children:o,header:_e,sx:tt={}})=>jsxRuntimeExports.jsxs(Box$1,{sx:{...tt},children:[jsxRuntimeExports.jsxs(Box$1,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[_e,jsxRuntimeExports.jsxs(Typography$1,{sx:{fontWeight:500},children:[a+1,"/",React$1.Children.toArray(o).length]})]}),jsxRuntimeExports.jsx(Box$1,{sx:{padding:"16px 16px 0 16px"},children:React$1.Children.toArray(o)[a]})]}),App$1="",logo=""+new URL("apizee-6b3e8e8d.svg",import.meta.url).href;var base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(a){var o=a.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _e=a.indexOf("=");_e===-1&&(_e=o);var tt=_e===o?0:4-_e%4;return[_e,tt]}function byteLength(a){var o=getLens(a),_e=o[0],tt=o[1];return(_e+tt)*3/4-tt}function _byteLength(a,o,_e){return(o+_e)*3/4-_e}function toByteArray(a){var o,_e=getLens(a),tt=_e[0],rt=_e[1],st=new Arr(_byteLength(a,tt,rt)),at=0,ut=rt>0?tt-4:tt,s;for(s=0;s<ut;s+=4)o=revLookup[a.charCodeAt(s)]<<18|revLookup[a.charCodeAt(s+1)]<<12|revLookup[a.charCodeAt(s+2)]<<6|revLookup[a.charCodeAt(s+3)],st[at++]=o>>16&255,st[at++]=o>>8&255,st[at++]=o&255;return rt===2&&(o=revLookup[a.charCodeAt(s)]<<2|revLookup[a.charCodeAt(s+1)]>>4,st[at++]=o&255),rt===1&&(o=revLookup[a.charCodeAt(s)]<<10|revLookup[a.charCodeAt(s+1)]<<4|revLookup[a.charCodeAt(s+2)]>>2,st[at++]=o>>8&255,st[at++]=o&255),st}function tripletToBase64(a){return lookup[a>>18&63]+lookup[a>>12&63]+lookup[a>>6&63]+lookup[a&63]}function encodeChunk(a,o,_e){for(var tt,rt=[],st=o;st<_e;st+=3)tt=(a[st]<<16&16711680)+(a[st+1]<<8&65280)+(a[st+2]&255),rt.push(tripletToBase64(tt));return rt.join("")}function fromByteArray(a){for(var o,_e=a.length,tt=_e%3,rt=[],st=16383,at=0,ut=_e-tt;at<ut;at+=st)rt.push(encodeChunk(a,at,at+st>ut?ut:at+st));return tt===1?(o=a[_e-1],rt.push(lookup[o>>2]+lookup[o<<4&63]+"==")):tt===2&&(o=(a[_e-2]<<8)+a[_e-1],rt.push(lookup[o>>10]+lookup[o>>4&63]+lookup[o<<2&63]+"=")),rt.join("")}var sha256$1={exports:{}};/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */(function(module){(function(){var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&!0&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(a){return typeof a=="object"&&a.buffer&&a.buffer.constructor===ArrayBuffer});var createOutputMethod=function(a,o){return function(_e){return new Sha256(o,!0).update(_e)[a]()}},createMethod=function(a){var o=createOutputMethod("hex",a);NODE_JS&&(o=nodeWrap(o,a)),o.create=function(){return new Sha256(a)},o.update=function(rt){return o.create().update(rt)};for(var _e=0;_e<OUTPUT_TYPES.length;++_e){var tt=OUTPUT_TYPES[_e];o[tt]=createOutputMethod(tt,a)}return o},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(a){if(typeof a=="string")return crypto.createHash(algorithm).update(a,"utf8").digest("hex");if(a==null)throw new Error(ERROR);return a.constructor===ArrayBuffer&&(a=new Uint8Array(a)),Array.isArray(a)||ArrayBuffer.isView(a)||a.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(a)).digest("hex"):method(a)};return nodeMethod},createHmacOutputMethod=function(a,o){return function(_e,tt){return new HmacSha256(_e,o,!0).update(tt)[a]()}},createHmacMethod=function(a){var o=createHmacOutputMethod("hex",a);o.create=function(rt){return new HmacSha256(rt,a)},o.update=function(rt,st){return o.create(rt).update(st)};for(var _e=0;_e<OUTPUT_TYPES.length;++_e){var tt=OUTPUT_TYPES[_e];o[tt]=createHmacOutputMethod(tt,a)}return o};function Sha256(a,o){o?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=a}Sha256.prototype.update=function(a){if(!this.finalized){var o,_e=typeof a;if(_e!=="string"){if(_e==="object"){if(a===null)throw new Error(ERROR);if(ARRAY_BUFFER&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!Array.isArray(a)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(a)))throw new Error(ERROR)}else throw new Error(ERROR);o=!0}for(var tt,rt=0,st,at=a.length,ut=this.blocks;rt<at;){if(this.hashed&&(this.hashed=!1,ut[0]=this.block,ut[16]=ut[1]=ut[2]=ut[3]=ut[4]=ut[5]=ut[6]=ut[7]=ut[8]=ut[9]=ut[10]=ut[11]=ut[12]=ut[13]=ut[14]=ut[15]=0),o)for(st=this.start;rt<at&&st<64;++rt)ut[st>>2]|=a[rt]<<SHIFT[st++&3];else for(st=this.start;rt<at&&st<64;++rt)tt=a.charCodeAt(rt),tt<128?ut[st>>2]|=tt<<SHIFT[st++&3]:tt<2048?(ut[st>>2]|=(192|tt>>6)<<SHIFT[st++&3],ut[st>>2]|=(128|tt&63)<<SHIFT[st++&3]):tt<55296||tt>=57344?(ut[st>>2]|=(224|tt>>12)<<SHIFT[st++&3],ut[st>>2]|=(128|tt>>6&63)<<SHIFT[st++&3],ut[st>>2]|=(128|tt&63)<<SHIFT[st++&3]):(tt=65536+((tt&1023)<<10|a.charCodeAt(++rt)&1023),ut[st>>2]|=(240|tt>>18)<<SHIFT[st++&3],ut[st>>2]|=(128|tt>>12&63)<<SHIFT[st++&3],ut[st>>2]|=(128|tt>>6&63)<<SHIFT[st++&3],ut[st>>2]|=(128|tt&63)<<SHIFT[st++&3]);this.lastByteIndex=st,this.bytes+=st-this.start,st>=64?(this.block=ut[16],this.start=st-64,this.hash(),this.hashed=!0):this.start=st}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,o=this.lastByteIndex;a[16]=this.block,a[o>>2]|=EXTRA[o&3],this.block=a[16],o>=56&&(this.hashed||this.hash(),a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),a[14]=this.hBytes<<3|this.bytes>>>29,a[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var a=this.h0,o=this.h1,_e=this.h2,tt=this.h3,rt=this.h4,st=this.h5,at=this.h6,ut=this.h7,s=this.blocks,et,ot,lt,St,pt,gt,ct,ht,it,ft,mt;for(et=16;et<64;++et)pt=s[et-15],ot=(pt>>>7|pt<<25)^(pt>>>18|pt<<14)^pt>>>3,pt=s[et-2],lt=(pt>>>17|pt<<15)^(pt>>>19|pt<<13)^pt>>>10,s[et]=s[et-16]+ot+s[et-7]+lt<<0;for(mt=o&_e,et=0;et<64;et+=4)this.first?(this.is224?(ht=300032,pt=s[0]-1413257819,ut=pt-150054599<<0,tt=pt+24177077<<0):(ht=704751109,pt=s[0]-210244248,ut=pt-1521486534<<0,tt=pt+143694565<<0),this.first=!1):(ot=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),lt=(rt>>>6|rt<<26)^(rt>>>11|rt<<21)^(rt>>>25|rt<<7),ht=a&o,St=ht^a&_e^mt,ct=rt&st^~rt&at,pt=ut+lt+ct+K[et]+s[et],gt=ot+St,ut=tt+pt<<0,tt=pt+gt<<0),ot=(tt>>>2|tt<<30)^(tt>>>13|tt<<19)^(tt>>>22|tt<<10),lt=(ut>>>6|ut<<26)^(ut>>>11|ut<<21)^(ut>>>25|ut<<7),it=tt&a,St=it^tt&o^ht,ct=ut&rt^~ut&st,pt=at+lt+ct+K[et+1]+s[et+1],gt=ot+St,at=_e+pt<<0,_e=pt+gt<<0,ot=(_e>>>2|_e<<30)^(_e>>>13|_e<<19)^(_e>>>22|_e<<10),lt=(at>>>6|at<<26)^(at>>>11|at<<21)^(at>>>25|at<<7),ft=_e&tt,St=ft^_e&a^it,ct=at&ut^~at&rt,pt=st+lt+ct+K[et+2]+s[et+2],gt=ot+St,st=o+pt<<0,o=pt+gt<<0,ot=(o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10),lt=(st>>>6|st<<26)^(st>>>11|st<<21)^(st>>>25|st<<7),mt=o&_e,St=mt^o&tt^ft,ct=st&at^~st&ut,pt=rt+lt+ct+K[et+3]+s[et+3],gt=ot+St,rt=a+pt<<0,a=pt+gt<<0;this.h0=this.h0+a<<0,this.h1=this.h1+o<<0,this.h2=this.h2+_e<<0,this.h3=this.h3+tt<<0,this.h4=this.h4+rt<<0,this.h5=this.h5+st<<0,this.h6=this.h6+at<<0,this.h7=this.h7+ut<<0},Sha256.prototype.hex=function(){this.finalize();var a=this.h0,o=this.h1,_e=this.h2,tt=this.h3,rt=this.h4,st=this.h5,at=this.h6,ut=this.h7,s=HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15]+HEX_CHARS[_e>>28&15]+HEX_CHARS[_e>>24&15]+HEX_CHARS[_e>>20&15]+HEX_CHARS[_e>>16&15]+HEX_CHARS[_e>>12&15]+HEX_CHARS[_e>>8&15]+HEX_CHARS[_e>>4&15]+HEX_CHARS[_e&15]+HEX_CHARS[tt>>28&15]+HEX_CHARS[tt>>24&15]+HEX_CHARS[tt>>20&15]+HEX_CHARS[tt>>16&15]+HEX_CHARS[tt>>12&15]+HEX_CHARS[tt>>8&15]+HEX_CHARS[tt>>4&15]+HEX_CHARS[tt&15]+HEX_CHARS[rt>>28&15]+HEX_CHARS[rt>>24&15]+HEX_CHARS[rt>>20&15]+HEX_CHARS[rt>>16&15]+HEX_CHARS[rt>>12&15]+HEX_CHARS[rt>>8&15]+HEX_CHARS[rt>>4&15]+HEX_CHARS[rt&15]+HEX_CHARS[st>>28&15]+HEX_CHARS[st>>24&15]+HEX_CHARS[st>>20&15]+HEX_CHARS[st>>16&15]+HEX_CHARS[st>>12&15]+HEX_CHARS[st>>8&15]+HEX_CHARS[st>>4&15]+HEX_CHARS[st&15]+HEX_CHARS[at>>28&15]+HEX_CHARS[at>>24&15]+HEX_CHARS[at>>20&15]+HEX_CHARS[at>>16&15]+HEX_CHARS[at>>12&15]+HEX_CHARS[at>>8&15]+HEX_CHARS[at>>4&15]+HEX_CHARS[at&15];return this.is224||(s+=HEX_CHARS[ut>>28&15]+HEX_CHARS[ut>>24&15]+HEX_CHARS[ut>>20&15]+HEX_CHARS[ut>>16&15]+HEX_CHARS[ut>>12&15]+HEX_CHARS[ut>>8&15]+HEX_CHARS[ut>>4&15]+HEX_CHARS[ut&15]),s},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var a=this.h0,o=this.h1,_e=this.h2,tt=this.h3,rt=this.h4,st=this.h5,at=this.h6,ut=this.h7,s=[a>>24&255,a>>16&255,a>>8&255,a&255,o>>24&255,o>>16&255,o>>8&255,o&255,_e>>24&255,_e>>16&255,_e>>8&255,_e&255,tt>>24&255,tt>>16&255,tt>>8&255,tt&255,rt>>24&255,rt>>16&255,rt>>8&255,rt&255,st>>24&255,st>>16&255,st>>8&255,st&255,at>>24&255,at>>16&255,at>>8&255,at&255];return this.is224||s.push(ut>>24&255,ut>>16&255,ut>>8&255,ut&255),s},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(this.is224?28:32),o=new DataView(a);return o.setUint32(0,this.h0),o.setUint32(4,this.h1),o.setUint32(8,this.h2),o.setUint32(12,this.h3),o.setUint32(16,this.h4),o.setUint32(20,this.h5),o.setUint32(24,this.h6),this.is224||o.setUint32(28,this.h7),a};function HmacSha256(a,o,_e){var tt,rt=typeof a;if(rt==="string"){var st=[],at=a.length,ut=0,s;for(tt=0;tt<at;++tt)s=a.charCodeAt(tt),s<128?st[ut++]=s:s<2048?(st[ut++]=192|s>>6,st[ut++]=128|s&63):s<55296||s>=57344?(st[ut++]=224|s>>12,st[ut++]=128|s>>6&63,st[ut++]=128|s&63):(s=65536+((s&1023)<<10|a.charCodeAt(++tt)&1023),st[ut++]=240|s>>18,st[ut++]=128|s>>12&63,st[ut++]=128|s>>6&63,st[ut++]=128|s&63);a=st}else if(rt==="object"){if(a===null)throw new Error(ERROR);if(ARRAY_BUFFER&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!Array.isArray(a)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(a)))throw new Error(ERROR)}else throw new Error(ERROR);a.length>64&&(a=new Sha256(o,!0).update(a).array());var et=[],ot=[];for(tt=0;tt<64;++tt){var lt=a[tt]||0;et[tt]=92^lt,ot[tt]=54^lt}Sha256.call(this,o,_e),this.update(ot),this.oKeyPad=et,this.inner=!0,this.sharedMemory=_e}HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var a=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(a),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()})(sha256$1);var sha256Exports=sha256$1.exports;const sha256=getDefaultExportFromCjs(sha256Exports);if(typeof Promise>"u")throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");var loggedPromiseDeprecation=!1;function logPromiseDeprecation(){loggedPromiseDeprecation||(loggedPromiseDeprecation=!0,console.warn("[KEYCLOAK] Usage of legacy style promise methods such as `.error()` and `.success()` has been deprecated and support will be removed in future versions. Use standard style promise methods such as `.then() and `.catch()` instead."))}function Keycloak(a){if(!(this instanceof Keycloak))return new Keycloak(a);for(var o=this,_e,tt=[],rt,st={enable:!0,callbackList:[],interval:5},at=document.getElementsByTagName("script"),ut=0;ut<at.length;ut++)(at[ut].src.indexOf("keycloak.js")!==-1||at[ut].src.indexOf("keycloak.min.js")!==-1)&&at[ut].src.indexOf("version=")!==-1&&(o.iframeVersion=at[ut].src.substring(at[ut].src.indexOf("version=")+8).split("&")[0]);var s=!0,et=In(console.info),ot=In(console.warn);o.init=function(un){o.authenticated=!1,rt=bn();var mn=["default","cordova","cordova-native"];if(un&&mn.indexOf(un.adapter)>-1?_e=tn(un.adapter):un&&typeof un.adapter=="object"?_e=un.adapter:window.Cordova||window.cordova?_e=tn("cordova"):_e=tn(),un){if(typeof un.useNonce<"u"&&(s=un.useNonce),typeof un.checkLoginIframe<"u"&&(st.enable=un.checkLoginIframe),un.checkLoginIframeInterval&&(st.interval=un.checkLoginIframeInterval),un.onLoad==="login-required"&&(o.loginRequired=!0),un.responseMode)if(un.responseMode==="query"||un.responseMode==="fragment")o.responseMode=un.responseMode;else throw"Invalid value for responseMode";if(un.flow){switch(un.flow){case"standard":o.responseType="code";break;case"implicit":o.responseType="id_token token";break;case"hybrid":o.responseType="code id_token token";break;default:throw"Invalid value for flow"}o.flow=un.flow}if(un.timeSkew!=null&&(o.timeSkew=un.timeSkew),un.redirectUri&&(o.redirectUri=un.redirectUri),un.silentCheckSsoRedirectUri&&(o.silentCheckSsoRedirectUri=un.silentCheckSsoRedirectUri),typeof un.silentCheckSsoFallback=="boolean"?o.silentCheckSsoFallback=un.silentCheckSsoFallback:o.silentCheckSsoFallback=!0,un.pkceMethod){if(un.pkceMethod!=="S256")throw"Invalid value for pkceMethod";o.pkceMethod=un.pkceMethod}typeof un.enableLogging=="boolean"?o.enableLogging=un.enableLogging:o.enableLogging=!1,typeof un.scope=="string"&&(o.scope=un.scope),typeof un.messageReceiveTimeout=="number"&&un.messageReceiveTimeout>0?o.messageReceiveTimeout=un.messageReceiveTimeout:o.messageReceiveTimeout=1e4}o.responseMode||(o.responseMode="fragment"),o.responseType||(o.responseType="code",o.flow="standard");var yn=bt(),pn=bt();pn.promise.then(function(){o.onReady&&o.onReady(o.authenticated),yn.setSuccess(o.authenticated)}).catch(function(Dn){yn.setError(Dn)});var Tn=mt();function kn(){var Dn=function(Un){Un||(Nn.prompt="none"),o.login(Nn).then(function(){pn.setSuccess()}).catch(function(Qn){pn.setError(Qn)})},An=function(){var Un=document.createElement("iframe"),Qn=o.createLoginUrl({prompt:"none",redirectUri:o.silentCheckSsoRedirectUri});Un.setAttribute("src",Qn),Un.setAttribute("title","keycloak-silent-check-sso"),Un.style.display="none",document.body.appendChild(Un);var er=function(zn){if(!(zn.origin!==window.location.origin||Un.contentWindow!==zn.source)){var lr=Nt(zn.data);ft(lr,pn),document.body.removeChild(Un),window.removeEventListener("message",er)}};window.addEventListener("message",er)},Nn={};switch(un.onLoad){case"check-sso":st.enable?zt().then(function(){rn().then(function(Un){Un?pn.setSuccess():o.silentCheckSsoRedirectUri?An():Dn(!1)}).catch(function(Un){pn.setError(Un)})}):o.silentCheckSsoRedirectUri?An():Dn(!1);break;case"login-required":Dn(!0);break;default:throw"Invalid value for onLoad"}}function xn(){var Dn=Nt(window.location.href);if(Dn&&window.history.replaceState(window.history.state,null,Dn.newUrl),Dn&&Dn.valid)return zt().then(function(){ft(Dn,pn)}).catch(function(An){pn.setError(An)});un?un.token&&un.refreshToken?(It(un.token,un.refreshToken,un.idToken),st.enable?zt().then(function(){rn().then(function(An){An?(o.onAuthSuccess&&o.onAuthSuccess(),pn.setSuccess(),Bt()):pn.setSuccess()}).catch(function(An){pn.setError(An)})}):o.updateToken(-1).then(function(){o.onAuthSuccess&&o.onAuthSuccess(),pn.setSuccess()}).catch(function(An){o.onAuthError&&o.onAuthError(),un.onLoad?kn():pn.setError(An)})):un.onLoad?kn():pn.setSuccess():pn.setSuccess()}function Mn(){var Dn=bt(),An=function(){(document.readyState==="interactive"||document.readyState==="complete")&&(document.removeEventListener("readystatechange",An),Dn.setSuccess())};return document.addEventListener("readystatechange",An),An(),Dn.promise}return Tn.then(function(){Mn().then(gn).then(xn).catch(function(Dn){yn.setError(Dn)})}),Tn.catch(function(Dn){yn.setError(Dn)}),yn.promise},o.login=function(un){return _e.login(un)};function lt(un){var mn=null,yn=window.crypto||window.msCrypto;if(yn&&yn.getRandomValues&&window.Uint8Array)return mn=new Uint8Array(un),yn.getRandomValues(mn),mn;mn=new Array(un);for(var pn=0;pn<mn.length;pn++)mn[pn]=Math.floor(256*Math.random());return mn}function St(un){return pt(un,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}function pt(un,mn){for(var yn=lt(un),pn=new Array(un),Tn=0;Tn<un;Tn++)pn[Tn]=mn.charCodeAt(yn[Tn]%mn.length);return String.fromCharCode.apply(null,pn)}function gt(un,mn){switch(un){case"S256":var yn=new Uint8Array(sha256.arrayBuffer(mn)),pn=base64Js.fromByteArray(yn).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return pn;default:throw"Invalid value for pkceMethod"}}function ct(un){var mn={id_token:{acr:un}};return JSON.stringify(mn)}o.createLoginUrl=function(un){var mn=At(),yn=At(),pn=_e.redirectUri(un),Tn={state:mn,nonce:yn,redirectUri:encodeURIComponent(pn)};un&&un.prompt&&(Tn.prompt=un.prompt);var kn;un&&un.action=="register"?kn=o.endpoints.register():kn=o.endpoints.authorize();var xn=un&&un.scope||o.scope;xn?xn.indexOf("openid")===-1&&(xn="openid "+xn):xn="openid";var Mn=kn+"?client_id="+encodeURIComponent(o.clientId)+"&redirect_uri="+encodeURIComponent(pn)+"&state="+encodeURIComponent(mn)+"&response_mode="+encodeURIComponent(o.responseMode)+"&response_type="+encodeURIComponent(o.responseType)+"&scope="+encodeURIComponent(xn);if(s&&(Mn=Mn+"&nonce="+encodeURIComponent(yn)),un&&un.prompt&&(Mn+="&prompt="+encodeURIComponent(un.prompt)),un&&un.maxAge&&(Mn+="&max_age="+encodeURIComponent(un.maxAge)),un&&un.loginHint&&(Mn+="&login_hint="+encodeURIComponent(un.loginHint)),un&&un.idpHint&&(Mn+="&kc_idp_hint="+encodeURIComponent(un.idpHint)),un&&un.action&&un.action!="register"&&(Mn+="&kc_action="+encodeURIComponent(un.action)),un&&un.locale&&(Mn+="&ui_locales="+encodeURIComponent(un.locale)),un&&un.acr){var Dn=ct(un.acr);Mn+="&claims="+encodeURIComponent(Dn)}if(o.pkceMethod){var An=St(96);Tn.pkceCodeVerifier=An;var Nn=gt(o.pkceMethod,An);Mn+="&code_challenge="+Nn,Mn+="&code_challenge_method="+o.pkceMethod}return rt.add(Tn),Mn},o.logout=function(un){return _e.logout(un)},o.createLogoutUrl=function(un){var mn=o.endpoints.logout()+"?post_logout_redirect_uri="+encodeURIComponent(_e.redirectUri(un,!1))+"&id_token_hint="+encodeURIComponent(o.idToken);return mn},o.register=function(un){return _e.register(un)},o.createRegisterUrl=function(un){return un||(un={}),un.action="register",o.createLoginUrl(un)},o.createAccountUrl=function(un){var mn=ht(),yn=void 0;return typeof mn<"u"&&(yn=mn+"/account?referrer="+encodeURIComponent(o.clientId)+"&referrer_uri="+encodeURIComponent(_e.redirectUri(un))),yn},o.accountManagement=function(){return _e.accountManagement()},o.hasRealmRole=function(un){var mn=o.realmAccess;return!!mn&&mn.roles.indexOf(un)>=0},o.hasResourceRole=function(un,mn){if(!o.resourceAccess)return!1;var yn=o.resourceAccess[mn||o.clientId];return!!yn&&yn.roles.indexOf(un)>=0},o.loadUserProfile=function(){var un=ht()+"/account",mn=new XMLHttpRequest;mn.open("GET",un,!0),mn.setRequestHeader("Accept","application/json"),mn.setRequestHeader("Authorization","bearer "+o.token);var yn=bt();return mn.onreadystatechange=function(){mn.readyState==4&&(mn.status==200?(o.profile=JSON.parse(mn.responseText),yn.setSuccess(o.profile)):yn.setError())},mn.send(),yn.promise},o.loadUserInfo=function(){var un=o.endpoints.userinfo(),mn=new XMLHttpRequest;mn.open("GET",un,!0),mn.setRequestHeader("Accept","application/json"),mn.setRequestHeader("Authorization","bearer "+o.token);var yn=bt();return mn.onreadystatechange=function(){mn.readyState==4&&(mn.status==200?(o.userInfo=JSON.parse(mn.responseText),yn.setSuccess(o.userInfo)):yn.setError())},mn.send(),yn.promise},o.isTokenExpired=function(un){if(!o.tokenParsed||!o.refreshToken&&o.flow!="implicit")throw"Not authenticated";if(o.timeSkew==null)return et("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var mn=o.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+o.timeSkew;if(un){if(isNaN(un))throw"Invalid minValidity";mn-=un}return mn<0},o.updateToken=function(un){var mn=bt();if(!o.refreshToken)return mn.setError(),mn.promise;un=un||5;var yn=function(){var Tn=!1;if(un==-1?(Tn=!0,et("[KEYCLOAK] Refreshing token: forced refresh")):(!o.tokenParsed||o.isTokenExpired(un))&&(Tn=!0,et("[KEYCLOAK] Refreshing token: token expired")),!Tn)mn.setSuccess(!1);else{var kn="grant_type=refresh_token&refresh_token="+o.refreshToken,xn=o.endpoints.token();if(tt.push(mn),tt.length==1){var Mn=new XMLHttpRequest;Mn.open("POST",xn,!0),Mn.setRequestHeader("Content-type","application/x-www-form-urlencoded"),Mn.withCredentials=!0,kn+="&client_id="+encodeURIComponent(o.clientId);var Dn=new Date().getTime();Mn.onreadystatechange=function(){if(Mn.readyState==4)if(Mn.status==200){et("[KEYCLOAK] Token refreshed"),Dn=(Dn+new Date().getTime())/2;var An=JSON.parse(Mn.responseText);It(An.access_token,An.refresh_token,An.id_token,Dn),o.onAuthRefreshSuccess&&o.onAuthRefreshSuccess();for(var Nn=tt.pop();Nn!=null;Nn=tt.pop())Nn.setSuccess(!0)}else{ot("[KEYCLOAK] Failed to refresh token"),Mn.status==400&&o.clearToken(),o.onAuthRefreshError&&o.onAuthRefreshError();for(var Nn=tt.pop();Nn!=null;Nn=tt.pop())Nn.setError(!0)}},Mn.send(kn)}}};if(st.enable){var pn=rn();pn.then(function(){yn()}).catch(function(Tn){mn.setError(Tn)})}else yn();return mn.promise},o.clearToken=function(){o.token&&(It(null,null,null),o.onAuthLogout&&o.onAuthLogout(),o.loginRequired&&o.login())};function ht(){if(typeof o.authServerUrl<"u")return o.authServerUrl.charAt(o.authServerUrl.length-1)=="/"?o.authServerUrl+"realms/"+encodeURIComponent(o.realm):o.authServerUrl+"/realms/"+encodeURIComponent(o.realm)}function it(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function ft(un,mn){var yn=un.code,pn=un.error,Tn=un.prompt,kn=new Date().getTime();if(un.kc_action_status&&o.onActionUpdate&&o.onActionUpdate(un.kc_action_status),pn){if(Tn!="none"){var xn={error:pn,error_description:un.error_description};o.onAuthError&&o.onAuthError(xn),mn&&mn.setError(xn)}else mn&&mn.setSuccess();return}else o.flow!="standard"&&(un.access_token||un.id_token)&&Nn(un.access_token,null,un.id_token,!0);if(o.flow!="implicit"&&yn){var Mn="code="+yn+"&grant_type=authorization_code",Dn=o.endpoints.token(),An=new XMLHttpRequest;An.open("POST",Dn,!0),An.setRequestHeader("Content-type","application/x-www-form-urlencoded"),Mn+="&client_id="+encodeURIComponent(o.clientId),Mn+="&redirect_uri="+un.redirectUri,un.pkceCodeVerifier&&(Mn+="&code_verifier="+un.pkceCodeVerifier),An.withCredentials=!0,An.onreadystatechange=function(){if(An.readyState==4)if(An.status==200){var Un=JSON.parse(An.responseText);Nn(Un.access_token,Un.refresh_token,Un.id_token,o.flow==="standard"),Bt()}else o.onAuthError&&o.onAuthError(),mn&&mn.setError()},An.send(Mn)}function Nn(Un,Qn,er,zn){kn=(kn+new Date().getTime())/2,It(Un,Qn,er,kn),s&&(o.tokenParsed&&o.tokenParsed.nonce!=un.storedNonce||o.refreshTokenParsed&&o.refreshTokenParsed.nonce!=un.storedNonce||o.idTokenParsed&&o.idTokenParsed.nonce!=un.storedNonce)?(et("[KEYCLOAK] Invalid nonce, clearing token"),o.clearToken(),mn&&mn.setError()):zn&&(o.onAuthSuccess&&o.onAuthSuccess(),mn&&mn.setSuccess())}}function mt(un){var mn=bt(),yn;a?typeof a=="string"&&(yn=a):yn="keycloak.json";function pn(An){An?o.endpoints={authorize:function(){return An.authorization_endpoint},token:function(){return An.token_endpoint},logout:function(){if(!An.end_session_endpoint)throw"Not supported by the OIDC server";return An.end_session_endpoint},checkSessionIframe:function(){if(!An.check_session_iframe)throw"Not supported by the OIDC server";return An.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!An.userinfo_endpoint)throw"Not supported by the OIDC server";return An.userinfo_endpoint}}:o.endpoints={authorize:function(){return ht()+"/protocol/openid-connect/auth"},token:function(){return ht()+"/protocol/openid-connect/token"},logout:function(){return ht()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var Nn=ht()+"/protocol/openid-connect/login-status-iframe.html";return o.iframeVersion&&(Nn=Nn+"?version="+o.iframeVersion),Nn},thirdPartyCookiesIframe:function(){var Nn=ht()+"/protocol/openid-connect/3p-cookies/step1.html";return o.iframeVersion&&(Nn=Nn+"?version="+o.iframeVersion),Nn},register:function(){return ht()+"/protocol/openid-connect/registrations"},userinfo:function(){return ht()+"/protocol/openid-connect/userinfo"}}}if(yn){var Tn=new XMLHttpRequest;Tn.open("GET",yn,!0),Tn.setRequestHeader("Accept","application/json"),Tn.onreadystatechange=function(){if(Tn.readyState==4)if(Tn.status==200||Tt(Tn)){var An=JSON.parse(Tn.responseText);o.authServerUrl=An["auth-server-url"],o.realm=An.realm,o.clientId=An.resource,pn(null),mn.setSuccess()}else mn.setError()},Tn.send()}else{if(!a.clientId)throw"clientId missing";o.clientId=a.clientId;var kn=a.oidcProvider;if(kn)if(typeof kn=="string"){var Dn;kn.charAt(kn.length-1)=="/"?Dn=kn+".well-known/openid-configuration":Dn=kn+"/.well-known/openid-configuration";var Tn=new XMLHttpRequest;Tn.open("GET",Dn,!0),Tn.setRequestHeader("Accept","application/json"),Tn.onreadystatechange=function(){if(Tn.readyState==4)if(Tn.status==200||Tt(Tn)){var Nn=JSON.parse(Tn.responseText);pn(Nn),mn.setSuccess()}else mn.setError()},Tn.send()}else pn(kn),mn.setSuccess();else{if(!a.url){for(var xn=document.getElementsByTagName("script"),Mn=0;Mn<xn.length;Mn++)if(xn[Mn].src.match(/.*keycloak\.js/)){a.url=xn[Mn].src.substr(0,xn[Mn].src.indexOf("/js/keycloak.js"));break}}if(!a.realm)throw"realm missing";o.authServerUrl=a.url,o.realm=a.realm,pn(null),mn.setSuccess()}}return mn.promise}function Tt(un){return un.status==0&&un.responseText&&un.responseURL.startsWith("file:")}function It(un,mn,yn,pn){if(o.tokenTimeoutHandle&&(clearTimeout(o.tokenTimeoutHandle),o.tokenTimeoutHandle=null),mn?(o.refreshToken=mn,o.refreshTokenParsed=Pt(mn)):(delete o.refreshToken,delete o.refreshTokenParsed),yn?(o.idToken=yn,o.idTokenParsed=Pt(yn)):(delete o.idToken,delete o.idTokenParsed),un){if(o.token=un,o.tokenParsed=Pt(un),o.sessionId=o.tokenParsed.session_state,o.authenticated=!0,o.subject=o.tokenParsed.sub,o.realmAccess=o.tokenParsed.realm_access,o.resourceAccess=o.tokenParsed.resource_access,pn&&(o.timeSkew=Math.floor(pn/1e3)-o.tokenParsed.iat),o.timeSkew!=null&&(et("[KEYCLOAK] Estimated time difference between browser and server is "+o.timeSkew+" seconds"),o.onTokenExpired)){var Tn=(o.tokenParsed.exp-new Date().getTime()/1e3+o.timeSkew)*1e3;et("[KEYCLOAK] Token expires in "+Math.round(Tn/1e3)+" s"),Tn<=0?o.onTokenExpired():o.tokenTimeoutHandle=setTimeout(o.onTokenExpired,Tn)}}else delete o.token,delete o.tokenParsed,delete o.subject,delete o.realmAccess,delete o.resourceAccess,o.authenticated=!1}function Pt(un){switch(un=un.split(".")[1],un=un.replace(/-/g,"+"),un=un.replace(/_/g,"/"),un.length%4){case 0:break;case 2:un+="==";break;case 3:un+="=";break;default:throw"Invalid token"}return un=decodeURIComponent(escape(atob(un))),un=JSON.parse(un),un}function At(){var un="0123456789abcdef",mn=pt(36,un).split("");mn[14]="4",mn[19]=un.substr(mn[19]&3|8,1),mn[8]=mn[13]=mn[18]=mn[23]="-";var yn=mn.join("");return yn}function Nt(un){var mn=Ot(un);if(mn){var yn=rt.get(mn.state);return yn&&(mn.valid=!0,mn.redirectUri=yn.redirectUri,mn.storedNonce=yn.nonce,mn.prompt=yn.prompt,mn.pkceCodeVerifier=yn.pkceCodeVerifier),mn}}function Ot(un){var mn;switch(o.flow){case"standard":mn=["code","state","session_state","kc_action_status"];break;case"implicit":mn=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status"];break;case"hybrid":mn=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status"];break}mn.push("error"),mn.push("error_description"),mn.push("error_uri");var yn=un.indexOf("?"),pn=un.indexOf("#"),Tn,kn;if(o.responseMode==="query"&&yn!==-1?(Tn=un.substring(0,yn),kn=Mt(un.substring(yn+1,pn!==-1?pn:un.length),mn),kn.paramsString!==""&&(Tn+="?"+kn.paramsString),pn!==-1&&(Tn+=un.substring(pn))):o.responseMode==="fragment"&&pn!==-1&&(Tn=un.substring(0,pn),kn=Mt(un.substring(pn+1),mn),kn.paramsString!==""&&(Tn+="#"+kn.paramsString)),kn&&kn.oauthParams){if(o.flow==="standard"||o.flow==="hybrid"){if((kn.oauthParams.code||kn.oauthParams.error)&&kn.oauthParams.state)return kn.oauthParams.newUrl=Tn,kn.oauthParams}else if(o.flow==="implicit"&&(kn.oauthParams.access_token||kn.oauthParams.error)&&kn.oauthParams.state)return kn.oauthParams.newUrl=Tn,kn.oauthParams}}function Mt(un,mn){for(var yn=un.split("&"),pn={paramsString:"",oauthParams:{}},Tn=0;Tn<yn.length;Tn++){var kn=yn[Tn].indexOf("="),xn=yn[Tn].slice(0,kn);mn.indexOf(xn)!==-1?pn.oauthParams[xn]=yn[Tn].slice(kn+1):(pn.paramsString!==""&&(pn.paramsString+="&"),pn.paramsString+=yn[Tn])}return pn}function bt(){var un={setSuccess:function(mn){un.resolve(mn)},setError:function(mn){un.reject(mn)}};return un.promise=new Promise(function(mn,yn){un.resolve=mn,un.reject=yn}),un.promise.success=function(mn){return logPromiseDeprecation(),this.then(function(pn){mn(pn)}),this},un.promise.error=function(mn){return logPromiseDeprecation(),this.catch(function(pn){mn(pn)}),this},un}function Wt(un,mn,yn){var pn=null,Tn=new Promise(function(kn,xn){pn=setTimeout(function(){xn({error:yn||"Promise is not settled within timeout of "+mn+"ms"})},mn)});return Promise.race([un,Tn]).finally(function(){clearTimeout(pn)})}function zt(){var un=bt();if(!st.enable||st.iframe)return un.setSuccess(),un.promise;var mn=document.createElement("iframe");st.iframe=mn,mn.onload=function(){var Tn=o.endpoints.authorize();Tn.charAt(0)==="/"?st.iframeOrigin=it():st.iframeOrigin=Tn.substring(0,Tn.indexOf("/",8)),un.setSuccess()};var yn=o.endpoints.checkSessionIframe();mn.setAttribute("src",yn),mn.setAttribute("title","keycloak-session-iframe"),mn.style.display="none",document.body.appendChild(mn);var pn=function(Tn){if(!(Tn.origin!==st.iframeOrigin||st.iframe.contentWindow!==Tn.source)&&(Tn.data=="unchanged"||Tn.data=="changed"||Tn.data=="error")){Tn.data!="unchanged"&&o.clearToken();for(var kn=st.callbackList.splice(0,st.callbackList.length),xn=kn.length-1;xn>=0;--xn){var Mn=kn[xn];Tn.data=="error"?Mn.setError():Mn.setSuccess(Tn.data=="unchanged")}}};return window.addEventListener("message",pn,!1),un.promise}function Bt(){st.enable&&o.token&&setTimeout(function(){rn().then(function(un){un&&Bt()})},st.interval*1e3)}function rn(){var un=bt();if(st.iframe&&st.iframeOrigin){var mn=o.clientId+" "+(o.sessionId?o.sessionId:"");st.callbackList.push(un);var yn=st.iframeOrigin;st.callbackList.length==1&&st.iframe.contentWindow.postMessage(mn,yn)}else un.setSuccess();return un.promise}function gn(){var un=bt();if(st.enable||o.silentCheckSsoRedirectUri){var mn=document.createElement("iframe");mn.setAttribute("src",o.endpoints.thirdPartyCookiesIframe()),mn.setAttribute("title","keycloak-3p-check-iframe"),mn.style.display="none",document.body.appendChild(mn);var yn=function(pn){mn.contentWindow===pn.source&&(pn.data!=="supported"&&pn.data!=="unsupported"||(pn.data==="unsupported"&&(st.enable=!1,o.silentCheckSsoFallback&&(o.silentCheckSsoRedirectUri=!1),ot("[KEYCLOAK] 3rd party cookies aren't supported by this browser. checkLoginIframe and silent check-sso are not available.")),document.body.removeChild(mn),window.removeEventListener("message",yn),un.setSuccess()))};window.addEventListener("message",yn,!1)}else un.setSuccess();return Wt(un.promise,o.messageReceiveTimeout,"Timeout when waiting for 3rd party check iframe message.")}function tn(un){if(!un||un=="default")return{login:function(kn){return window.location.replace(o.createLoginUrl(kn)),bt().promise},logout:function(kn){return window.location.replace(o.createLogoutUrl(kn)),bt().promise},register:function(kn){return window.location.replace(o.createRegisterUrl(kn)),bt().promise},accountManagement:function(){var kn=o.createAccountUrl();if(typeof kn<"u")window.location.href=kn;else throw"Not supported by the OIDC server";return bt().promise},redirectUri:function(kn,xn){return kn&&kn.redirectUri?kn.redirectUri:o.redirectUri?o.redirectUri:location.href}};if(un=="cordova"){st.enable=!1;var mn=function(kn,xn,Mn){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(kn,xn,Mn):window.open(kn,xn,Mn)},yn=function(kn){return kn&&kn.cordovaOptions?Object.keys(kn.cordovaOptions).reduce(function(xn,Mn){return xn[Mn]=kn.cordovaOptions[Mn],xn},{}):{}},pn=function(kn){return Object.keys(kn).reduce(function(xn,Mn){return xn.push(Mn+"="+kn[Mn]),xn},[]).join(",")},Tn=function(kn){var xn=yn(kn);return xn.location="no",kn&&kn.prompt=="none"&&(xn.hidden="yes"),pn(xn)};return{login:function(kn){var xn=bt(),Mn=Tn(kn),Dn=o.createLoginUrl(kn),An=mn(Dn,"_blank",Mn),Nn=!1,Un=!1,Qn=function(){Un=!0,An.close()};return An.addEventListener("loadstart",function(er){if(er.url.indexOf("http://localhost")==0){var zn=Nt(er.url);ft(zn,xn),Qn(),Nn=!0}}),An.addEventListener("loaderror",function(er){if(!Nn)if(er.url.indexOf("http://localhost")==0){var zn=Nt(er.url);ft(zn,xn),Qn(),Nn=!0}else xn.setError(),Qn()}),An.addEventListener("exit",function(er){Un||xn.setError({reason:"closed_by_user"})}),xn.promise},logout:function(kn){var xn=bt(),Mn=o.createLogoutUrl(kn),Dn=mn(Mn,"_blank","location=no,hidden=yes,clearcache=yes"),An;return Dn.addEventListener("loadstart",function(Nn){Nn.url.indexOf("http://localhost")==0&&Dn.close()}),Dn.addEventListener("loaderror",function(Nn){Nn.url.indexOf("http://localhost")==0||(An=!0),Dn.close()}),Dn.addEventListener("exit",function(Nn){An?xn.setError():(o.clearToken(),xn.setSuccess())}),xn.promise},register:function(kn){var xn=bt(),Mn=o.createRegisterUrl(),Dn=Tn(kn),An=mn(Mn,"_blank",Dn);return An.addEventListener("loadstart",function(Nn){if(Nn.url.indexOf("http://localhost")==0){An.close();var Un=Nt(Nn.url);ft(Un,xn)}}),xn.promise},accountManagement:function(){var kn=o.createAccountUrl();if(typeof kn<"u"){var xn=mn(kn,"_blank","location=no");xn.addEventListener("loadstart",function(Mn){Mn.url.indexOf("http://localhost")==0&&xn.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(kn){return"http://localhost"}}}if(un=="cordova-native")return st.enable=!1,{login:function(kn){var xn=bt(),Mn=o.createLoginUrl(kn);return universalLinks.subscribe("keycloak",function(Dn){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var An=Nt(Dn.url);ft(An,xn)}),window.cordova.plugins.browsertab.openUrl(Mn),xn.promise},logout:function(kn){var xn=bt(),Mn=o.createLogoutUrl(kn);return universalLinks.subscribe("keycloak",function(Dn){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),o.clearToken(),xn.setSuccess()}),window.cordova.plugins.browsertab.openUrl(Mn),xn.promise},register:function(kn){var xn=bt(),Mn=o.createRegisterUrl(kn);return universalLinks.subscribe("keycloak",function(Dn){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var An=Nt(Dn.url);ft(An,xn)}),window.cordova.plugins.browsertab.openUrl(Mn),xn.promise},accountManagement:function(){var kn=o.createAccountUrl();if(typeof kn<"u")window.cordova.plugins.browsertab.openUrl(kn);else throw"Not supported by the OIDC server"},redirectUri:function(kn){return kn&&kn.redirectUri?kn.redirectUri:o.redirectUri?o.redirectUri:"http://localhost"}};throw"invalid adapter type: "+un}var Ht=function(){if(!(this instanceof Ht))return new Ht;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");var un=this;function mn(){for(var yn=new Date().getTime(),pn=0;pn<localStorage.length;pn++){var Tn=localStorage.key(pn);if(Tn&&Tn.indexOf("kc-callback-")==0){var kn=localStorage.getItem(Tn);if(kn)try{var xn=JSON.parse(kn).expires;(!xn||xn<yn)&&localStorage.removeItem(Tn)}catch{localStorage.removeItem(Tn)}}}}un.get=function(yn){if(yn){var pn="kc-callback-"+yn,Tn=localStorage.getItem(pn);return Tn&&(localStorage.removeItem(pn),Tn=JSON.parse(Tn)),mn(),Tn}},un.add=function(yn){mn();var pn="kc-callback-"+yn.state;yn.expires=new Date().getTime()+60*60*1e3,localStorage.setItem(pn,JSON.stringify(yn))}},fn=function(){if(!(this instanceof fn))return new fn;var un=this;un.get=function(Tn){if(Tn){var kn=yn("kc-callback-"+Tn);if(pn("kc-callback-"+Tn,"",mn(-100)),kn)return JSON.parse(kn)}},un.add=function(Tn){pn("kc-callback-"+Tn.state,JSON.stringify(Tn),mn(60))},un.removeItem=function(Tn){pn(Tn,"",mn(-100))};var mn=function(Tn){var kn=new Date;return kn.setTime(kn.getTime()+Tn*60*1e3),kn},yn=function(Tn){for(var kn=Tn+"=",xn=document.cookie.split(";"),Mn=0;Mn<xn.length;Mn++){for(var Dn=xn[Mn];Dn.charAt(0)==" ";)Dn=Dn.substring(1);if(Dn.indexOf(kn)==0)return Dn.substring(kn.length,Dn.length)}return""},pn=function(Tn,kn,xn){var Mn=Tn+"="+kn+"; expires="+xn.toUTCString()+"; ";document.cookie=Mn}};function bn(){try{return new Ht}catch{}return new fn}function In(un){return function(){o.enableLogging&&un.apply(console,Array.prototype.slice.call(arguments))}}}function loginKeyCloakJS(){return new Promise((a,o)=>{const _e=new Keycloak({url:"https://idp.apizee.com/auth",realm:"APIZEE-POC-DGPN",clientId:"visio-assisted"});_e.init({onLoad:"login-required",checkLoginIframe:!1}).then(tt=>{tt?(console.log("Keycloak authenticated"),a(_e)):console.log("Keycloak NOT authenticated...")}).catch(tt=>{console.error("Authenticated Failed",tt),o(tt)})})}const ROOM_THEME_OPTIONS={components:{MuiChip:{variants:[{props:{},style:{color:"#F7F7F8",backgroundColor:"#111313",borderRadius:"4px",opacity:"75%",":hover":{backgroundColor:"#1D1F20",opacity:"100%"}}}]},MuiCircularProgress:{variants:[{props:{},style:{color:"#F7F7F8"}}]},MuiIconButton:{variants:[{props:{},style:{padding:4,margin:2,color:"#F7F7F8",backgroundColor:"#111313",borderRadius:"4px",opacity:"75%",":hover":{backgroundColor:"#1D1F20",opacity:"100%"},":disabled":{color:"#7A8085",backgroundColor:"#CACCCE",opacity:"75%"}}}]},MuiSwitch:{styleOverrides:{colorPrimary:{"&.Mui-checked":{color:"#17821A"}},track:{".Mui-checked.Mui-checked + &":{backgroundColor:"#17821A"}}}}}},VIDEO_ROUNDED_CORNERS={borderRadius:"4px",overflow:"hidden"},DEBUG={level:"debug",isDebugEnabled:!0,isInfoEnabled:!0,isWarnEnabled:!0},INFO={level:"info",isDebugEnabled:!1,isInfoEnabled:!0,isWarnEnabled:!0},WARN={level:"warn",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!0},ERROR={level:"error",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!1};function setLogLevel(a){switch(a){case"debug":globalThis.logLevel=DEBUG;break;case"info":globalThis.logLevel=INFO;break;case"warn":globalThis.logLevel=WARN;break;case"error":globalThis.logLevel=ERROR;break;default:globalThis.logLevel=INFO}}function isInstanceOfTakeSnapshot(a){return typeof a!="object"?!1:"takeSnapshot"in a}function isInstanceOfSwitchFacingMode(a){return typeof a!="object"?!1:"switchFacingMode"in a}function isInstanceOfFileShared(a){return typeof a!="object"?!1:"fileShared"in a}function isInstanceOfHangup(a){return typeof a!="object"?!1:"hangUp"in a}const video_sizing={height:"100%",width:"100%"},COMPONENT_NAME="App";function App(a){var wt,Lt;const o=useThemeProps({props:a,name:`${COMPONENT_NAME}`}),{optInCGUPrefixText:_e="I agree to the ",optInCGULinkText:tt="General Terms of Sale",optInCGUAriaLabel:rt="accept-terms-conditions",optInPrivacyPrefixText:st="I agree to the ",optInPrivacyLinkText:at="Privacy Policy",optInPrivacyAriaLabel:ut="accept-privacy-policy",optInButtonText:s="Confirm",backButtonText:et="Back",readyButtonText:ot="Enter",selectDeviceHelperText:lt="Please check what you want to share before entering the room.",hangedUpText:St="The agent hanged up. Bye!"}=o,pt=useParams(),[gt]=useSearchParams(),ct=reactExports.useMemo(()=>gt.get("lL")??globalThis.logLevel.level,[gt]);reactExports.useEffect(()=>{setLogLevel(ct),A(ct),te(ct)},[ct]);const[ht,it]=reactExports.useState(void 0),[ft,mt]=reactExports.useState(!1),[Tt,It]=reactExports.useState(void 0),[Pt,At]=reactExports.useState(),[Nt,Ot]=reactExports.useState(void 0),[Mt,bt]=reactExports.useState(void 0),[Wt,zt]=reactExports.useState(0),Bt=()=>{zt(Et=>Et+1)},rn=()=>{zt(Et=>Et-1)},gn=reactExports.useMemo(()=>Wt>=1,[Wt]),{value:tn,toggle:Ht}=q(!1),[fn,bn]=reactExports.useState(),[In,un]=reactExports.useState(!1),{session:mn,disconnect:yn}=I(ht?{apiKey:ht.apiKey}:void 0,ht?{cloudUrl:ht.cloudUrl?ht.cloudUrl:"https://cloud.apirtc.com",groups:[ht.conversation.name+"-guests"],userData:new apiRTC_minExports.UserData({firstName:ht.user.firstName,lastName:ht.user.lastName})}:void 0),{userMediaDevices:pn,selectedAudioIn:Tn,setSelectedAudioIn:kn,selectedVideoIn:xn,setSelectedVideoIn:Mn}=O(mn,isMobile_1?void 0:"apirtc-web-guest"),Dn=reactExports.useMemo(()=>ht?ht.streams.find(Et=>Et.type==="user-media"):void 0,[ht]),An=reactExports.useMemo(()=>ht?ht.streams.find(Et=>Et.type==="display-media"):void 0,[ht]);reactExports.useEffect(()=>{mn&&ht&&mn.getUserAgent().enableCallStatsMonitoring(ht.callStatsMonitoringInterval!==void 0,{interval:ht.callStatsMonitoringInterval})},[mn,ht]),reactExports.useEffect(()=>{var Et;if(Dn){const $t=(Et=Dn.constraints)==null?void 0:Et.video;$t instanceof Object&&$t.facingMode&&At($t.facingMode)}},[Dn]),reactExports.useEffect(()=>{isMobile_1&&(xn&&Mn(void 0),Pt==="environment"&&rr(!0))},[Pt]);const Nn=reactExports.useMemo(()=>{const Et={...Dn==null?void 0:Dn.constraints};if(Et!=null&&Et.audio&&(Nt===void 0||Nt)){const $t=Et.audio instanceof Object?{...Et.audio}:{};Tn&&($t.deviceId=Tn.id),Et.audio=$t}else Et.audio=!1;if(Et!=null&&Et.video&&(Mt===void 0||Mt)){const $t=Et.video instanceof Object?{...Et.video}:{};xn?($t.deviceId=xn.id,delete $t.facingMode):Pt&&($t.facingMode=Pt,delete $t.deviceId),Et.video=$t}else Et.video=!1;return globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|useMemo new_constraints`,Et),Et},[Dn,Tn,xn,Pt,Nt,Mt]),{stream:Un}=b(gn&&Dn?mn:void 0,{constraints:Nn}),[Qn,er]=reactExports.useState(),{conversation:zn,leave:lr}=d(mn,ht?ht.conversation.name:void 0,ht?ht.conversation.getOrCreateOptions:void 0,!0,ht?ht.conversation.joinOptions:void 0),{publishedStreams:cn,subscribedStreams:Gn}=T(zn,[...Un&&tn?[{stream:Un,options:Dn==null?void 0:Dn.publishOptions}]:[],...Qn?[{stream:Qn}]:[]]),Yn=reactExports.useCallback(Et=>{zn&&zn.sendData(Et).then(()=>{globalThis.logLevel.isDebugEnabled&&console.log(`${COMPONENT_NAME}|conversation sendData`,Et)}).catch($t=>{globalThis.logLevel.isWarnEnabled&&console.warn(`${COMPONENT_NAME}|conversation sendData error`,$t)})},[zn]),or=()=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|shareScreen calls createDisplayMediaStream`),apiRTC_minExports.Stream.createDisplayMediaStream({},!1).then(Et=>{globalThis.logLevel.isInfoEnabled&&console.info(`${COMPONENT_NAME}|createDisplayMediaStream`,Et),er(Et)}).catch(Et=>{console.error(`${COMPONENT_NAME}|createDisplayMediaStream error`,Et)}).finally(()=>{})};reactExports.useEffect(()=>{if(Qn)return Qn.on("stopped",()=>{globalThis.logLevel.isInfoEnabled&&console.log(`${COMPONENT_NAME}|The user has ended sharing the screen`),er(void 0)}),()=>{Qn.release()}},[Qn]);const{value:Bn,setValue:rr,toggle:Zn}=q(!1),_n=reactExports.useMemo(()=>Gn.length===0?!0:Bn,[Gn,Bn]),[Ln,vn]=reactExports.useState({}),On=async(Et,$t)=>fetch(`https://is.dev.apizee.com/invitations/${Et}`,{method:"GET",headers:{Authorization:`Bearer ${$t}`,"Content-Type":"application/json"}}).then(Jt=>Jt.status!==200?null:Jt.json()).catch(Jt=>{console.error(`${COMPONENT_NAME}|getInvitationData`,Jt)});reactExports.useEffect(()=>{const Et=$t=>{it(void 0)};return window.addEventListener("beforeunload",Et),()=>{window.removeEventListener("beforeunload",Et)}},[]),reactExports.useEffect(()=>{if(pt.invitationData)try{const Et=JSON.parse(base64Exports.decode(pt.invitationData));globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|InvitationData`,JSON.stringify(Et)),it(Et)}catch(Et){if(Et instanceof SyntaxError){const $t=pt.invitationData;loginKeyCloakJS().then(Jt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|keycloak.token`,Jt.token),On($t).then(en=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|getInvitationData`,$t,en),it(en)})}).catch(Jt=>{console.error(`${COMPONENT_NAME}|loginKeyCloakJS error`,Jt)})}}},[pt.invitationData]),reactExports.useEffect(()=>{var Et,$t;Ot(!!((Et=ht==null?void 0:ht.streams[0].constraints)!=null&&Et.audio)),bt(!!(($t=ht==null?void 0:ht.streams[0].constraints)!=null&&$t.video))},[ht]),reactExports.useEffect(()=>{const Et=gt.get("i");if(Et)try{const $t=JSON.parse(base64Exports.decode(Et));globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|InvitationData`,JSON.stringify($t)),it($t)}catch($t){if($t instanceof SyntaxError){On(Et).then(Jt=>{globalThis.logLevel.isInfoEnabled&&console.info(`${COMPONENT_NAME}|getInvitationData`,Et,Jt),it(Jt.data)});return}else console.error(`${COMPONENT_NAME}|parsing i search parameter error`,$t),mt(!0)}},[gt]),reactExports.useEffect(()=>{if(mn){const Et=mn.getUserAgent(),$t=new uaParserExports.UAParser;globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|UAParser`,$t.getResult());const Jt=Et.getUserData();Jt.setToSession(),Jt.setProp("systemInfo",JSON.stringify($t.getResult())),Et.setUserData(Jt)}},[mn]),reactExports.useEffect(()=>{if(mn&&Un){const Et=$t=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|onContactData`,$t);const Jt=$t.sender,en=$t.content;isInstanceOfTakeSnapshot(en)?Un.takeSnapshot(en.takeSnapshot).then(qt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|takeSnapshot of`,Un,qt),Jt.sendFile({name:`snapshot_${new Date().toISOString()}.png`,type:"image/png"},qt).on("statusChange",hn=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|statusChange`,hn)})}).catch(qt=>{globalThis.logLevel.isWarnEnabled&&console.warn(`${COMPONENT_NAME}|takeSnapshot error`,qt)}):isInstanceOfSwitchFacingMode(en)&&(globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|SwitchFacingMode`),At(qt=>qt==="user"?"environment":"user"))};return mn.on("contactData",Et),()=>{mn.removeListener("contactData",Et)}}},[mn,Un]),reactExports.useEffect(()=>{if(zn){const Et=$t=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|Conversation onData`,$t);const Jt=$t.content;isInstanceOfFileShared(Jt)?(globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|fileShared`,Jt),fetch(Jt.fileShared.link,{method:"get",mode:"cors",headers:new Headers({Authorization:"Bearer "+Jt.fileShared.jwt})}).then(en=>en.blob()).then(en=>{const qt=window.URL.createObjectURL(en);bn(qt)}).catch(en=>{console.error(`${COMPONENT_NAME}|fetch error`,Jt.fileShared.link,en)})):isInstanceOfHangup(Jt)&&(zn.leave().then().catch(en=>{globalThis.logLevel.isWarnEnabled&&console.warn(`${COMPONENT_NAME}|conversation leave error`,en)}).finally(()=>{yn()}),un(!0))};return zn.on("data",Et),()=>{zn.removeListener("data",Et)}}},[zn,yn]),reactExports.useEffect(()=>{if(zn){const Et=Jt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|pointerSharingEnabled`,Jt)};zn.on("pointerSharingEnabled",Et);const $t=Jt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|pointerLocationChanged`,Jt),vn(en=>({...en,[Jt.source.contactId]:Jt.data})),setTimeout(()=>{vn(en=>(delete en[Jt.source.contactId],{pointer:en}))},3e3)};return zn.on("pointerLocationChanged",$t),zn.enablePointerSharing(!0),()=>{zn.removeListener("pointerSharingEnabled",Et),zn.removeListener("pointerLocationChanged",$t)}}},[zn]);const Kt=reactExports.useCallback((Et,$t)=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|onStreamMouseDown`,Et.getId(),$t),zn&&zn.sendPointerLocation({streamId:Et.getId(),contactId:Et.getContact()?Et.getContact().getId():apiRTC.userAgentInstance.userId},0,0,{top:`${Math.round($t.nativeEvent.offsetY*100/$t.nativeEvent.target.offsetHeight)}%`,left:`${Math.round($t.nativeEvent.offsetX*100/$t.nativeEvent.target.offsetWidth)}%`})},[zn]);reactExports.useEffect(()=>{ht&&fetch(ht.cloudUrl).then(Et=>{Et.status===404?(mt(!0),It(404)):Et.status===401?(mt(!0),It(401)):Et.status===500&&(mt(!0),It(500))}).catch(Et=>{mt(!0)})},[ht]),reactExports.useEffect(()=>{gn&&Yn({type:"timeline-event",event:"opt-in-accepted"})},[Yn,gn]),reactExports.useEffect(()=>{Un&&Yn({type:"timeline-event",event:"camera-stream-grabbed"})},[Yn,Un]),reactExports.useEffect(()=>{tn&&Yn({type:"timeline-event",event:"enter-room"})},[Yn,tn]);const Rt=Et=>{var en,qt;const $t=(en=Et.getContact())==null?void 0:en.getUserData().get("firstName"),Jt=(qt=Et.getContact())==null?void 0:qt.getUserData().get("lastName");if(!(!$t&&!Jt))return`${$t??""} ${Jt??""}`},nt=!_n&&Gn.length<=2?"large":void 0,Ct=Gn.map((Et,$t)=>jsxRuntimeExports.jsx(K,{id:"subscribed-stream-"+$t,sx:{...Et.hasVideo()?video_sizing:{backgroundColor:"grey"}},stream:Et,name:Rt(Et),controls:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(_$1,{size:nt}),jsxRuntimeExports.jsx(j$1,{size:nt,disabled:!0}),jsxRuntimeExports.jsx(Z,{size:nt,disabled:!0})]}),children:Et.hasVideo()?jsxRuntimeExports.jsx(X,{sx:video_sizing,style:{...video_sizing,objectFit:Ln[Et.getContact().getId()]?"fill":"cover",...VIDEO_ROUNDED_CORNERS},pointer:Ln[Et.getContact().getId()],onMouseDown:Jt=>{Kt(Et,Jt)}}):jsxRuntimeExports.jsx(F,{})},$t)),yt=_n&&cn.length<=2?"large":void 0,xt=cn.map((Et,$t)=>jsxRuntimeExports.jsx(K,{id:"published-stream-"+$t,sx:{...Et.hasVideo()?video_sizing:{backgroundColor:"grey"}},stream:Et,muted:!0,controls:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(j$1,{size:yt}),jsxRuntimeExports.jsx(Z,{size:yt})]}),children:Et.hasVideo()?jsxRuntimeExports.jsx(X,{sx:video_sizing,style:{...video_sizing,objectFit:Ln[apiRTC.userAgentInstance.userId]?"fill":"cover",...VIDEO_ROUNDED_CORNERS},pointer:Ln[apiRTC.userAgentInstance.userId],onMouseDown:Jt=>{Kt(Et,Jt)}}):jsxRuntimeExports.jsx(F,{})},$t));return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[!mn&&!ft&&jsxRuntimeExports.jsx(Box$1,{display:"flex",alignItems:"center",justifyContent:"center",sx:{mt:5},children:jsxRuntimeExports.jsx("img",{height:"320px",width:"320px",src:logo,alt:"logo"})}),ft&&jsxRuntimeExports.jsx(ErrorPage,{errorType:Tt}),mn&&!ft&&!tn&&jsxRuntimeExports.jsx(Container$1,{maxWidth:"sm",sx:{height:"100vh"},children:jsxRuntimeExports.jsx(Box$1,{sx:{height:"100%"},display:"flex",alignItems:"center",justifyContent:"center",children:jsxRuntimeExports.jsx(Card$1,{children:jsxRuntimeExports.jsx(CardContent$1,{children:jsxRuntimeExports.jsxs(TextStepper,{activeStep:Wt,header:jsxRuntimeExports.jsx("img",{src:logo,alt:"Apizee Logo",height:24}),children:[jsxRuntimeExports.jsx(Step$1,{children:jsxRuntimeExports.jsx(OptInList,{optIns:[{id:"CGU",labels:{aria:rt,prefix:_e,link:tt},link:navigator.language==="fr"||navigator.language==="fr-FR"?"https://cloud.apizee.com/attachments/b87662d7-3e82-4519-a4db-9fb6ba67b5cc/Apizee-ConditionsGeneralesUtilisation.pdf":"https://cloud.apizee.com/attachments/cb744e03-182b-453e-bbdf-0d89cf42e182/Apizee-TermsOfUse.pdf"},{id:"Privacy",labels:{aria:ut,prefix:st,link:at},link:navigator.language==="fr"||navigator.language==="fr-FR"?"https://cloud.apizee.com/attachments/f87493b0-483e-4723-a3ee-02d59a501b1c/Apizee-PolitiqueConfidentialite.pdf":"https://cloud.apizee.com/attachments/ae61f778-16d1-4dd4-baa1-cd1ba568a0d6/Apizee-PrivacyPolicy.pdf"}],labels:{submit:s},onSubmit:Bt})},"legal"),jsxRuntimeExports.jsxs(Step$1,{children:[Dn&&jsxRuntimeExports.jsxs(Stack$1,{sx:{mt:1},direction:{xs:"column"},alignItems:"center",justifyContent:"center",useFlexGap:!0,flexWrap:"wrap",spacing:1,children:[jsxRuntimeExports.jsx(Box$1,{sx:{width:"100%",paddingTop:"75%",position:"relative","& .MuiBox-root":{position:"absolute",height:"100%",maxWidth:"100%"}},children:Un?jsxRuntimeExports.jsx(K,{sx:{top:0,left:0,bottom:0,right:0,maxWidth:{xs:"100%",sm:"100%"},...!Un.hasVideo()&&{position:"absolute",inset:0,borderRadius:"4px",backgroundColor:"#CACCCE"}},stream:Un,muted:!0,children:Un.hasVideo()?jsxRuntimeExports.jsx(X,{style:{height:"100%",...VIDEO_ROUNDED_CORNERS},"data-testid":"local-video"}):jsxRuntimeExports.jsx(F,{"data-testid":"local-audio"})}):jsxRuntimeExports.jsx(Skeleton$1,{variant:"rectangular",width:"100%",height:"100%",sx:{position:"absolute",top:0,left:0}})}),jsxRuntimeExports.jsxs(Box$1,{sx:{minWidth:"120px",width:"100%",display:"flex"},children:[jsxRuntimeExports.jsx(Button$1,{sx:{minWidth:0,width:"3em",height:"3em",display:"flex",justifyContent:"center",alignItems:"center",border:"solid 1px rgba(0, 0, 0, 0.23)",borderRadius:"4px",boxSizing:"border-box",flexShrink:0,color:"black"},disabled:!((wt=ht==null?void 0:ht.streams[0].constraints)!=null&&wt.audio),onClick:()=>Ot(!Nt),children:jsxRuntimeExports.jsx(Icon$1,{children:Nn.audio?"mic_on":"mic_off"})}),jsxRuntimeExports.jsx(C,{sx:{marginLeft:"0.25em",minWidth:"120px",flexGrow:"1"},id:"audio-in",size:"small",disabled:!Nn.audio,devices:pn.audioinput,selectedDevice:Tn,setSelectedDevice:kn})]}),jsxRuntimeExports.jsxs(Box$1,{sx:{minWidth:"120px",width:"100%",display:"flex"},children:[jsxRuntimeExports.jsx(Button$1,{sx:{minWidth:0,width:"3em",height:"3em",display:"flex",justifyContent:"center",alignItems:"center",border:"solid 1px rgba(0, 0, 0, 0.23)",borderRadius:"4px",boxSizing:"border-box",flexShrink:0,color:"black"},disabled:!((Lt=ht==null?void 0:ht.streams[0].constraints)!=null&&Lt.video),onClick:()=>{bt(!Mt)},children:jsxRuntimeExports.jsx(Icon$1,{children:Nn.video?"videocam_on":"videocam_off"})}),jsxRuntimeExports.jsx(C,{sx:{marginLeft:"0.25em",minWidth:"120px",flexGrow:"1"},id:"video-in",size:"small",disabled:!Nn.video,devices:pn.videoinput,selectedDevice:xn,setSelectedDevice:Mn})]})]}),An&&jsxRuntimeExports.jsx(Box$1,{sx:{display:"flex",justifyContent:"center",mt:1},children:jsxRuntimeExports.jsx(Button$1,{variant:"outlined",color:"primary",onClick:or,children:"share screen"})}),jsxRuntimeExports.jsx(Typography$1,{sx:{mt:1},children:lt}),jsxRuntimeExports.jsxs(Box$1,{sx:{display:"flex",justifyContent:"end",mt:1},children:[jsxRuntimeExports.jsx(Button$1,{onClick:rn,children:et}),jsxRuntimeExports.jsx(Button$1,{variant:"outlined",disabled:An&&!Qn,onClick:Ht,children:ot})]})]},"device-selection")]})})})})}),zn&&tn&&jsxRuntimeExports.jsxs(Box$1,{sx:{position:"relative",height:"99vh",width:"100vw",maxWidth:"100%"},children:[jsxRuntimeExports.jsx(S,{sx:{height:"100%",width:"100%"},children:_n?xt:Ct}),jsxRuntimeExports.jsx(S,{sx:{position:"absolute",bottom:4,left:4,opacity:.9,height:"34%",width:{xs:"50%",sm:"40%",md:"30%",lg:"20%"}},onClick:Zn,children:_n?Ct:xt})]}),fn&&jsxRuntimeExports.jsx("img",{src:fn,alt:"sharedImg"}),In&&jsxRuntimeExports.jsx(Container$1,{maxWidth:"md",children:jsxRuntimeExports.jsx(Alert$1,{severity:"info",children:St})})]})}const index="",frFR={components:{App:{defaultProps:{acceptTitleText:"Documents légaux",optInCGUPrefixText:"J'accepte les ",optInCGULinkText:"Conditions générales d'utilisation",optInCGUAriaLabel:"conditions-générales",optInPrivacyPrefixText:"J'accepte la ",optInPrivacyLinkText:"Politique de confidentialité",optInPrivacyAriaLabel:"politique-confidentialité",optInButtonText:"Confirmer",backButtonText:"Retour",readyButtonText:"Entrer en communication",selectDeviceText:"Sélection de périphériques",selectDeviceHelperText:"Avant d'entrer en communication, vérifiez ce que vous partagerez avec votre interlocuteur.",hangedUpText:"L'agent a raccroché."}}}};setLogLevel("warn");A(globalThis.logLevel.level);te(globalThis.logLevel.level);function getLangFiles(){switch(navigator.language){case"fr":case"fr-FR":return[frFR,$];default:return[]}}document.documentElement.setAttribute("lang",navigator.language.slice(0,2));const theme=createTheme({palette:{mode:"light",primary:{main:"#F76B40",light:"#ba3108",dark:"#f88562"},secondary:{main:"#5b5baf",light:"#8eabc7",dark:"#2e455c"},success:{main:"#0F5712",light:"#17821A",dark:"#0A340B"},info:{main:"#1355AE"},neutral:{main:"rgba(0, 0, 0, 0.23)"}},typography:{button:{textTransform:"none"}},...ROOM_THEME_OPTIONS},...getLangFiles()),container=document.getElementById("root");container&&createRoot(container).render(jsxRuntimeExports.jsx(ThemeProvider,{theme,children:jsxRuntimeExports.jsx(BrowserRouter,{basename:"/web-guest",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(App,{})}),jsxRuntimeExports.jsx(Route,{path:"/:invitationData",element:jsxRuntimeExports.jsx(App,{})})]})})}));
