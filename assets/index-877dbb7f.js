function _mergeNamespaces(a,o){for(var _e=0;_e<o.length;_e++){const tt=o[_e];if(typeof tt!="string"&&!Array.isArray(tt)){for(const at in tt)if(at!=="default"&&!(at in a)){const lt=Object.getOwnPropertyDescriptor(tt,at);lt&&Object.defineProperty(a,at,lt.get?lt:{enumerable:!0,get:()=>tt[at]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const at of document.querySelectorAll('link[rel="modulepreload"]'))tt(at);new MutationObserver(at=>{for(const lt of at)if(lt.type==="childList")for(const it of lt.addedNodes)it.tagName==="LINK"&&it.rel==="modulepreload"&&tt(it)}).observe(document,{childList:!0,subtree:!0});function _e(at){const lt={};return at.integrity&&(lt.integrity=at.integrity),at.referrerPolicy&&(lt.referrerPolicy=at.referrerPolicy),at.crossOrigin==="use-credentials"?lt.credentials="include":at.crossOrigin==="anonymous"?lt.credentials="omit":lt.credentials="same-origin",lt}function tt(at){if(at.ep)return;at.ep=!0;const lt=_e(at);fetch(at.href,lt)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$3=Symbol.for("react.element"),n$3=Symbol.for("react.portal"),p$4=Symbol.for("react.fragment"),q$4=Symbol.for("react.strict_mode"),r$2=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$4=Symbol.for("react.forward_ref"),w$3=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$3=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$3(a){return a===null||typeof a!="object"?null:(a=z$3&&a[z$3]||a["@@iterator"],typeof a=="function"?a:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$2={};function E$1(a,o,_e){this.props=a,this.context=o,this.refs=D$2,this.updater=_e||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(a,o){if(typeof a!="object"&&typeof a!="function"&&a!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,a,o,"setState")};E$1.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};function F$1(){}F$1.prototype=E$1.prototype;function G$1(a,o,_e){this.props=a,this.context=o,this.refs=D$2,this.updater=_e||B$1}var H$2=G$1.prototype=new F$1;H$2.constructor=G$1;C$1(H$2,E$1.prototype);H$2.isPureReactComponent=!0;var I$2=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$2(a,o,_e){var tt,at={},lt=null,it=null;if(o!=null)for(tt in o.ref!==void 0&&(it=o.ref),o.key!==void 0&&(lt=""+o.key),o)J$1.call(o,tt)&&!L$1.hasOwnProperty(tt)&&(at[tt]=o[tt]);var ut=arguments.length-2;if(ut===1)at.children=_e;else if(1<ut){for(var s=Array(ut),et=0;et<ut;et++)s[et]=arguments[et+2];at.children=s}if(a&&a.defaultProps)for(tt in ut=a.defaultProps,ut)at[tt]===void 0&&(at[tt]=ut[tt]);return{$$typeof:l$3,type:a,key:lt,ref:it,props:at,_owner:K$1.current}}function N$3(a,o){return{$$typeof:l$3,type:a.type,key:o,ref:a.ref,props:a.props,_owner:a._owner}}function O$3(a){return typeof a=="object"&&a!==null&&a.$$typeof===l$3}function escape$1(a){var o={"=":"=0",":":"=2"};return"$"+a.replace(/[=:]/g,function(_e){return o[_e]})}var P$1=/\/+/g;function Q$2(a,o){return typeof a=="object"&&a!==null&&a.key!=null?escape$1(""+a.key):o.toString(36)}function R$2(a,o,_e,tt,at){var lt=typeof a;(lt==="undefined"||lt==="boolean")&&(a=null);var it=!1;if(a===null)it=!0;else switch(lt){case"string":case"number":it=!0;break;case"object":switch(a.$$typeof){case l$3:case n$3:it=!0}}if(it)return it=a,at=at(it),a=tt===""?"."+Q$2(it,0):tt,I$2(at)?(_e="",a!=null&&(_e=a.replace(P$1,"$&/")+"/"),R$2(at,o,_e,"",function(et){return et})):at!=null&&(O$3(at)&&(at=N$3(at,_e+(!at.key||it&&it.key===at.key?"":(""+at.key).replace(P$1,"$&/")+"/")+a)),o.push(at)),1;if(it=0,tt=tt===""?".":tt+":",I$2(a))for(var ut=0;ut<a.length;ut++){lt=a[ut];var s=tt+Q$2(lt,ut);it+=R$2(lt,o,_e,s,at)}else if(s=A$3(a),typeof s=="function")for(a=s.call(a),ut=0;!(lt=a.next()).done;)lt=lt.value,s=tt+Q$2(lt,ut++),it+=R$2(lt,o,_e,s,at);else if(lt==="object")throw o=String(a),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return it}function S$2(a,o,_e){if(a==null)return a;var tt=[],at=0;return R$2(a,tt,"","",function(lt){return o.call(_e,lt,at++)}),tt}function T$1(a){if(a._status===-1){var o=a._result;o=o(),o.then(function(_e){(a._status===0||a._status===-1)&&(a._status=1,a._result=_e)},function(_e){(a._status===0||a._status===-1)&&(a._status=2,a._result=_e)}),a._status===-1&&(a._status=0,a._result=o)}if(a._status===1)return a._result.default;throw a._result}var U$2={current:null},V$1={transition:null},W$2={ReactCurrentDispatcher:U$2,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};react_production_min.Children={map:S$2,forEach:function(a,o,_e){S$2(a,function(){o.apply(this,arguments)},_e)},count:function(a){var o=0;return S$2(a,function(){o++}),o},toArray:function(a){return S$2(a,function(o){return o})||[]},only:function(a){if(!O$3(a))throw Error("React.Children.only expected to receive a single React element child.");return a}};react_production_min.Component=E$1;react_production_min.Fragment=p$4;react_production_min.Profiler=r$2;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$4;react_production_min.Suspense=w$3;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.cloneElement=function(a,o,_e){if(a==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+a+".");var tt=C$1({},a.props),at=a.key,lt=a.ref,it=a._owner;if(o!=null){if(o.ref!==void 0&&(lt=o.ref,it=K$1.current),o.key!==void 0&&(at=""+o.key),a.type&&a.type.defaultProps)var ut=a.type.defaultProps;for(s in o)J$1.call(o,s)&&!L$1.hasOwnProperty(s)&&(tt[s]=o[s]===void 0&&ut!==void 0?ut[s]:o[s])}var s=arguments.length-2;if(s===1)tt.children=_e;else if(1<s){ut=Array(s);for(var et=0;et<s;et++)ut[et]=arguments[et+2];tt.children=ut}return{$$typeof:l$3,type:a.type,key:at,ref:lt,props:tt,_owner:it}};react_production_min.createContext=function(a){return a={$$typeof:u$1,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},a.Provider={$$typeof:t$2,_context:a},a.Consumer=a};react_production_min.createElement=M$2;react_production_min.createFactory=function(a){var o=M$2.bind(null,a);return o.type=a,o};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(a){return{$$typeof:v$4,render:a}};react_production_min.isValidElement=O$3;react_production_min.lazy=function(a){return{$$typeof:y$3,_payload:{_status:-1,_result:a},_init:T$1}};react_production_min.memo=function(a,o){return{$$typeof:x$2,type:a,compare:o===void 0?null:o}};react_production_min.startTransition=function(a){var o=V$1.transition;V$1.transition={};try{a()}finally{V$1.transition=o}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(a,o){return U$2.current.useCallback(a,o)};react_production_min.useContext=function(a){return U$2.current.useContext(a)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(a){return U$2.current.useDeferredValue(a)};react_production_min.useEffect=function(a,o){return U$2.current.useEffect(a,o)};react_production_min.useId=function(){return U$2.current.useId()};react_production_min.useImperativeHandle=function(a,o,_e){return U$2.current.useImperativeHandle(a,o,_e)};react_production_min.useInsertionEffect=function(a,o){return U$2.current.useInsertionEffect(a,o)};react_production_min.useLayoutEffect=function(a,o){return U$2.current.useLayoutEffect(a,o)};react_production_min.useMemo=function(a,o){return U$2.current.useMemo(a,o)};react_production_min.useReducer=function(a,o,_e){return U$2.current.useReducer(a,o,_e)};react_production_min.useRef=function(a){return U$2.current.useRef(a)};react_production_min.useState=function(a){return U$2.current.useState(a)};react_production_min.useSyncExternalStore=function(a,o,_e){return U$2.current.useSyncExternalStore(a,o,_e)};react_production_min.useTransition=function(){return U$2.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$2=reactExports,k$3=Symbol.for("react.element"),l$2=Symbol.for("react.fragment"),m$4=Object.prototype.hasOwnProperty,n$2=f$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$3={key:!0,ref:!0,__self:!0,__source:!0};function q$3(a,o,_e){var tt,at={},lt=null,it=null;_e!==void 0&&(lt=""+_e),o.key!==void 0&&(lt=""+o.key),o.ref!==void 0&&(it=o.ref);for(tt in o)m$4.call(o,tt)&&!p$3.hasOwnProperty(tt)&&(at[tt]=o[tt]);if(a&&a.defaultProps)for(tt in o=a.defaultProps,o)at[tt]===void 0&&(at[tt]=o[tt]);return{$$typeof:k$3,type:a,key:lt,ref:it,props:at,_owner:n$2.current}}reactJsxRuntime_production_min.Fragment=l$2;reactJsxRuntime_production_min.jsx=q$3;reactJsxRuntime_production_min.jsxs=q$3;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(a){function o(qt,fn){var Cn=qt.length;qt.push(fn);e:for(;0<Cn;){var Tn=Cn-1>>>1,un=qt[Tn];if(0<at(un,fn))qt[Tn]=fn,qt[Cn]=un,Cn=Tn;else break e}}function _e(qt){return qt.length===0?null:qt[0]}function tt(qt){if(qt.length===0)return null;var fn=qt[0],Cn=qt.pop();if(Cn!==fn){qt[0]=Cn;e:for(var Tn=0,un=qt.length,mn=un>>>1;Tn<mn;){var yn=2*(Tn+1)-1,pn=qt[yn],In=yn+1,kn=qt[In];if(0>at(pn,Cn))In<un&&0>at(kn,pn)?(qt[Tn]=kn,qt[In]=Cn,Tn=In):(qt[Tn]=pn,qt[yn]=Cn,Tn=yn);else if(In<un&&0>at(kn,Cn))qt[Tn]=kn,qt[In]=Cn,Tn=In;else break e}}return fn}function at(qt,fn){var Cn=qt.sortIndex-fn.sortIndex;return Cn!==0?Cn:qt.id-fn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var lt=performance;a.unstable_now=function(){return lt.now()}}else{var it=Date,ut=it.now();a.unstable_now=function(){return it.now()-ut}}var s=[],et=[],ot=1,st=null,Rt=3,ht=!1,bt=!1,ct=!1,mt=typeof setTimeout=="function"?setTimeout:null,rt=typeof clearTimeout=="function"?clearTimeout:null,pt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ft(qt){for(var fn=_e(et);fn!==null;){if(fn.callback===null)tt(et);else if(fn.startTime<=qt)tt(et),fn.sortIndex=fn.expirationTime,o(s,fn);else break;fn=_e(et)}}function St(qt){if(ct=!1,ft(qt),!bt)if(_e(s)!==null)bt=!0,gn(It);else{var fn=_e(et);fn!==null&&nn(St,fn.startTime-qt)}}function It(qt,fn){bt=!1,ct&&(ct=!1,rt(Dt),Dt=-1),ht=!0;var Cn=Rt;try{for(ft(fn),st=_e(s);st!==null&&(!(st.expirationTime>fn)||qt&&!vt());){var Tn=st.callback;if(typeof Tn=="function"){st.callback=null,Rt=st.priorityLevel;var un=Tn(st.expirationTime<=fn);fn=a.unstable_now(),typeof un=="function"?st.callback=un:st===_e(s)&&tt(s),ft(fn)}else tt(s);st=_e(s)}if(st!==null)var mn=!0;else{var yn=_e(et);yn!==null&&nn(St,yn.startTime-fn),mn=!1}return mn}finally{st=null,Rt=Cn,ht=!1}}var xt=!1,At=null,Dt=-1,wt=5,Mt=-1;function vt(){return!(a.unstable_now()-Mt<wt)}function Ft(){if(At!==null){var qt=a.unstable_now();Mt=qt;var fn=!0;try{fn=At(!0,qt)}finally{fn?Ht():(xt=!1,At=null)}}else xt=!1}var Ht;if(typeof pt=="function")Ht=function(){pt(Ft)};else if(typeof MessageChannel<"u"){var Wt=new MessageChannel,tn=Wt.port2;Wt.port1.onmessage=Ft,Ht=function(){tn.postMessage(null)}}else Ht=function(){mt(Ft,0)};function gn(qt){At=qt,xt||(xt=!0,Ht())}function nn(qt,fn){Dt=mt(function(){qt(a.unstable_now())},fn)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(qt){qt.callback=null},a.unstable_continueExecution=function(){bt||ht||(bt=!0,gn(It))},a.unstable_forceFrameRate=function(qt){0>qt||125<qt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):wt=0<qt?Math.floor(1e3/qt):5},a.unstable_getCurrentPriorityLevel=function(){return Rt},a.unstable_getFirstCallbackNode=function(){return _e(s)},a.unstable_next=function(qt){switch(Rt){case 1:case 2:case 3:var fn=3;break;default:fn=Rt}var Cn=Rt;Rt=fn;try{return qt()}finally{Rt=Cn}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(qt,fn){switch(qt){case 1:case 2:case 3:case 4:case 5:break;default:qt=3}var Cn=Rt;Rt=qt;try{return fn()}finally{Rt=Cn}},a.unstable_scheduleCallback=function(qt,fn,Cn){var Tn=a.unstable_now();switch(typeof Cn=="object"&&Cn!==null?(Cn=Cn.delay,Cn=typeof Cn=="number"&&0<Cn?Tn+Cn:Tn):Cn=Tn,qt){case 1:var un=-1;break;case 2:un=250;break;case 5:un=1073741823;break;case 4:un=1e4;break;default:un=5e3}return un=Cn+un,qt={id:ot++,callback:fn,priorityLevel:qt,startTime:Cn,expirationTime:un,sortIndex:-1},Cn>Tn?(qt.sortIndex=Cn,o(et,qt),_e(s)===null&&qt===_e(et)&&(ct?(rt(Dt),Dt=-1):ct=!0,nn(St,Cn-Tn))):(qt.sortIndex=un,o(s,qt),bt||ht||(bt=!0,gn(It))),qt},a.unstable_shouldYield=vt,a.unstable_wrapCallback=function(qt){var fn=Rt;return function(){var Cn=Rt;Rt=fn;try{return qt.apply(this,arguments)}finally{Rt=Cn}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$2(a){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+a,_e=1;_e<arguments.length;_e++)o+="&args[]="+encodeURIComponent(arguments[_e]);return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(a,o){ha(a,o),ha(a+"Capture",o)}function ha(a,o){for(ea[a]=o,a=0;a<o.length;a++)da.add(o[a])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(a){return ja.call(ma,a)?!0:ja.call(la,a)?!1:ka.test(a)?ma[a]=!0:(la[a]=!0,!1)}function pa(a,o,_e,tt){if(_e!==null&&_e.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return tt?!1:_e!==null?!_e.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function qa(a,o,_e,tt){if(o===null||typeof o>"u"||pa(a,o,_e,tt))return!0;if(tt)return!1;if(_e!==null)switch(_e.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function v$3(a,o,_e,tt,at,lt,it){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=tt,this.attributeNamespace=at,this.mustUseProperty=_e,this.propertyName=a,this.type=o,this.sanitizeURL=lt,this.removeEmptyString=it}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){z$2[a]=new v$3(a,0,!1,a,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var o=a[0];z$2[o]=new v$3(o,1,!1,a[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){z$2[a]=new v$3(a,2,!1,a.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){z$2[a]=new v$3(a,2,!1,a,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){z$2[a]=new v$3(a,3,!1,a.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(a){z$2[a]=new v$3(a,3,!0,a,null,!1,!1)});["capture","download"].forEach(function(a){z$2[a]=new v$3(a,4,!1,a,null,!1,!1)});["cols","rows","size","span"].forEach(function(a){z$2[a]=new v$3(a,6,!1,a,null,!1,!1)});["rowSpan","start"].forEach(function(a){z$2[a]=new v$3(a,5,!1,a.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var o=a.replace(ra,sa);z$2[o]=new v$3(o,1,!1,a,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var o=a.replace(ra,sa);z$2[o]=new v$3(o,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var o=a.replace(ra,sa);z$2[o]=new v$3(o,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(a){z$2[a]=new v$3(a,1,!1,a.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$3("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(a){z$2[a]=new v$3(a,1,!1,a.toLowerCase(),null,!0,!0)});function ta(a,o,_e,tt){var at=z$2.hasOwnProperty(o)?z$2[o]:null;(at!==null?at.type!==0:tt||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(qa(o,_e,at,tt)&&(_e=null),tt||at===null?oa(o)&&(_e===null?a.removeAttribute(o):a.setAttribute(o,""+_e)):at.mustUseProperty?a[at.propertyName]=_e===null?at.type===3?!1:"":_e:(o=at.attributeName,tt=at.attributeNamespace,_e===null?a.removeAttribute(o):(at=at.type,_e=at===3||at===4&&_e===!0?"":""+_e,tt?a.setAttributeNS(tt,o,_e):a.setAttribute(o,_e))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(a){return a===null||typeof a!="object"?null:(a=Ja&&a[Ja]||a["@@iterator"],typeof a=="function"?a:null)}var A$2=Object.assign,La;function Ma(a){if(La===void 0)try{throw Error()}catch(_e){var o=_e.stack.trim().match(/\n( *(at )?)/);La=o&&o[1]||""}return`
`+La+a}var Na=!1;function Oa(a,o){if(!a||Na)return"";Na=!0;var _e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(et){var tt=et}Reflect.construct(a,[],o)}else{try{o.call()}catch(et){tt=et}a.call(o.prototype)}else{try{throw Error()}catch(et){tt=et}a()}}catch(et){if(et&&tt&&typeof et.stack=="string"){for(var at=et.stack.split(`
`),lt=tt.stack.split(`
`),it=at.length-1,ut=lt.length-1;1<=it&&0<=ut&&at[it]!==lt[ut];)ut--;for(;1<=it&&0<=ut;it--,ut--)if(at[it]!==lt[ut]){if(it!==1||ut!==1)do if(it--,ut--,0>ut||at[it]!==lt[ut]){var s=`
`+at[it].replace(" at new "," at ");return a.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",a.displayName)),s}while(1<=it&&0<=ut);break}}}finally{Na=!1,Error.prepareStackTrace=_e}return(a=a?a.displayName||a.name:"")?Ma(a):""}function Pa(a){switch(a.tag){case 5:return Ma(a.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return a=Oa(a.type,!1),a;case 11:return a=Oa(a.type.render,!1),a;case 1:return a=Oa(a.type,!0),a;default:return""}}function Qa(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case Ca:return(a.displayName||"Context")+".Consumer";case Ba:return(a._context.displayName||"Context")+".Provider";case Da:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Ga:return o=a.displayName||null,o!==null?o:Qa(a.type)||"Memo";case Ha:o=a._payload,a=a._init;try{return Qa(a(o))}catch{}}return null}function Ra(a){var o=a.type;switch(a.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=o.render,a=a.displayName||a.name||"",o.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(o);case 8:return o===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Sa(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ta(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ua(a){var o=Ta(a)?"checked":"value",_e=Object.getOwnPropertyDescriptor(a.constructor.prototype,o),tt=""+a[o];if(!a.hasOwnProperty(o)&&typeof _e<"u"&&typeof _e.get=="function"&&typeof _e.set=="function"){var at=_e.get,lt=_e.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return at.call(this)},set:function(it){tt=""+it,lt.call(this,it)}}),Object.defineProperty(a,o,{enumerable:_e.enumerable}),{getValue:function(){return tt},setValue:function(it){tt=""+it},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var _e=o.getValue(),tt="";return a&&(tt=Ta(a)?a.checked?"true":"false":a.value),a=tt,a!==_e?(o.setValue(a),!0):!1}function Xa(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Ya(a,o){var _e=o.checked;return A$2({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_e??a._wrapperState.initialChecked})}function Za(a,o){var _e=o.defaultValue==null?"":o.defaultValue,tt=o.checked!=null?o.checked:o.defaultChecked;_e=Sa(o.value!=null?o.value:_e),a._wrapperState={initialChecked:tt,initialValue:_e,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ab(a,o){o=o.checked,o!=null&&ta(a,"checked",o,!1)}function bb(a,o){ab(a,o);var _e=Sa(o.value),tt=o.type;if(_e!=null)tt==="number"?(_e===0&&a.value===""||a.value!=_e)&&(a.value=""+_e):a.value!==""+_e&&(a.value=""+_e);else if(tt==="submit"||tt==="reset"){a.removeAttribute("value");return}o.hasOwnProperty("value")?cb(a,o.type,_e):o.hasOwnProperty("defaultValue")&&cb(a,o.type,Sa(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(a.defaultChecked=!!o.defaultChecked)}function db(a,o,_e){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var tt=o.type;if(!(tt!=="submit"&&tt!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+a._wrapperState.initialValue,_e||o===a.value||(a.value=o),a.defaultValue=o}_e=a.name,_e!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,_e!==""&&(a.name=_e)}function cb(a,o,_e){(o!=="number"||Xa(a.ownerDocument)!==a)&&(_e==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+_e&&(a.defaultValue=""+_e))}var eb=Array.isArray;function fb(a,o,_e,tt){if(a=a.options,o){o={};for(var at=0;at<_e.length;at++)o["$"+_e[at]]=!0;for(_e=0;_e<a.length;_e++)at=o.hasOwnProperty("$"+a[_e].value),a[_e].selected!==at&&(a[_e].selected=at),at&&tt&&(a[_e].defaultSelected=!0)}else{for(_e=""+Sa(_e),o=null,at=0;at<a.length;at++){if(a[at].value===_e){a[at].selected=!0,tt&&(a[at].defaultSelected=!0);return}o!==null||a[at].disabled||(o=a[at])}o!==null&&(o.selected=!0)}}function gb(a,o){if(o.dangerouslySetInnerHTML!=null)throw Error(p$2(91));return A$2({},o,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function hb(a,o){var _e=o.value;if(_e==null){if(_e=o.children,o=o.defaultValue,_e!=null){if(o!=null)throw Error(p$2(92));if(eb(_e)){if(1<_e.length)throw Error(p$2(93));_e=_e[0]}o=_e}o==null&&(o=""),_e=o}a._wrapperState={initialValue:Sa(_e)}}function ib(a,o){var _e=Sa(o.value),tt=Sa(o.defaultValue);_e!=null&&(_e=""+_e,_e!==a.value&&(a.value=_e),o.defaultValue==null&&a.defaultValue!==_e&&(a.defaultValue=_e)),tt!=null&&(a.defaultValue=""+tt)}function jb(a){var o=a.textContent;o===a._wrapperState.initialValue&&o!==""&&o!==null&&(a.value=o)}function kb(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(a,o){return a==null||a==="http://www.w3.org/1999/xhtml"?kb(o):a==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var mb,nb=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,_e,tt,at){MSApp.execUnsafeLocalFunction(function(){return a(o,_e,tt,at)})}:a}(function(a,o){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=o;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=mb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;o.firstChild;)a.appendChild(o.firstChild)}});function ob(a,o){if(o){var _e=a.firstChild;if(_e&&_e===a.lastChild&&_e.nodeType===3){_e.nodeValue=o;return}}a.textContent=o}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(a){qb.forEach(function(o){o=o+a.charAt(0).toUpperCase()+a.substring(1),pb[o]=pb[a]})});function rb(a,o,_e){return o==null||typeof o=="boolean"||o===""?"":_e||typeof o!="number"||o===0||pb.hasOwnProperty(a)&&pb[a]?(""+o).trim():o+"px"}function sb(a,o){a=a.style;for(var _e in o)if(o.hasOwnProperty(_e)){var tt=_e.indexOf("--")===0,at=rb(_e,o[_e],tt);_e==="float"&&(_e="cssFloat"),tt?a.setProperty(_e,at):a[_e]=at}}var tb=A$2({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(a,o){if(o){if(tb[a]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(p$2(137,a));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(p$2(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(p$2(61))}if(o.style!=null&&typeof o.style!="object")throw Error(p$2(62))}}function vb(a,o){if(a.indexOf("-")===-1)return typeof o.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var yb=null,zb=null,Ab=null;function Bb(a){if(a=Cb(a)){if(typeof yb!="function")throw Error(p$2(280));var o=a.stateNode;o&&(o=Db(o),yb(a.stateNode,a.type,o))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,o=Ab;if(Ab=zb=null,Bb(a),o)for(a=0;a<o.length;a++)Bb(o[a])}}function Gb(a,o){return a(o)}function Hb(){}var Ib=!1;function Jb(a,o,_e){if(Ib)return a(o,_e);Ib=!0;try{return Gb(a,o,_e)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(a,o){var _e=a.stateNode;if(_e===null)return null;var tt=Db(_e);if(tt===null)return null;_e=tt[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(tt=!tt.disabled)||(a=a.type,tt=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!tt;break e;default:a=!1}if(a)return null;if(_e&&typeof _e!="function")throw Error(p$2(231,o,typeof _e));return _e}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(a,o,_e,tt,at,lt,it,ut,s){var et=Array.prototype.slice.call(arguments,3);try{o.apply(_e,et)}catch(ot){this.onError(ot)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(a){Ob=!0,Pb=a}};function Tb(a,o,_e,tt,at,lt,it,ut,s){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(a,o,_e,tt,at,lt,it,ut,s){if(Tb.apply(this,arguments),Ob){if(Ob){var et=Pb;Ob=!1,Pb=null}else throw Error(p$2(198));Qb||(Qb=!0,Rb=et)}}function Vb(a){var o=a,_e=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,o.flags&4098&&(_e=o.return),a=o.return;while(a)}return o.tag===3?_e:null}function Wb(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function Xb(a){if(Vb(a)!==a)throw Error(p$2(188))}function Yb(a){var o=a.alternate;if(!o){if(o=Vb(a),o===null)throw Error(p$2(188));return o!==a?null:a}for(var _e=a,tt=o;;){var at=_e.return;if(at===null)break;var lt=at.alternate;if(lt===null){if(tt=at.return,tt!==null){_e=tt;continue}break}if(at.child===lt.child){for(lt=at.child;lt;){if(lt===_e)return Xb(at),a;if(lt===tt)return Xb(at),o;lt=lt.sibling}throw Error(p$2(188))}if(_e.return!==tt.return)_e=at,tt=lt;else{for(var it=!1,ut=at.child;ut;){if(ut===_e){it=!0,_e=at,tt=lt;break}if(ut===tt){it=!0,tt=at,_e=lt;break}ut=ut.sibling}if(!it){for(ut=lt.child;ut;){if(ut===_e){it=!0,_e=lt,tt=at;break}if(ut===tt){it=!0,tt=lt,_e=at;break}ut=ut.sibling}if(!it)throw Error(p$2(189))}}if(_e.alternate!==tt)throw Error(p$2(190))}if(_e.tag!==3)throw Error(p$2(188));return _e.stateNode.current===_e?a:o}function Zb(a){return a=Yb(a),a!==null?$b(a):null}function $b(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var o=$b(a);if(o!==null)return o;a=a.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(a){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,a,void 0,(a.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(a){return a>>>=0,a===0?32:31-(pc(a)/qc|0)|0}var rc=64,sc=4194304;function tc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function uc(a,o){var _e=a.pendingLanes;if(_e===0)return 0;var tt=0,at=a.suspendedLanes,lt=a.pingedLanes,it=_e&268435455;if(it!==0){var ut=it&~at;ut!==0?tt=tc(ut):(lt&=it,lt!==0&&(tt=tc(lt)))}else it=_e&~at,it!==0?tt=tc(it):lt!==0&&(tt=tc(lt));if(tt===0)return 0;if(o!==0&&o!==tt&&!(o&at)&&(at=tt&-tt,lt=o&-o,at>=lt||at===16&&(lt&4194240)!==0))return o;if(tt&4&&(tt|=_e&16),o=a.entangledLanes,o!==0)for(a=a.entanglements,o&=tt;0<o;)_e=31-oc(o),at=1<<_e,tt|=a[_e],o&=~at;return tt}function vc(a,o){switch(a){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(a,o){for(var _e=a.suspendedLanes,tt=a.pingedLanes,at=a.expirationTimes,lt=a.pendingLanes;0<lt;){var it=31-oc(lt),ut=1<<it,s=at[it];s===-1?(!(ut&_e)||ut&tt)&&(at[it]=vc(ut,o)):s<=o&&(a.expiredLanes|=ut),lt&=~ut}}function xc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function yc(){var a=rc;return rc<<=1,!(rc&4194240)&&(rc=64),a}function zc(a){for(var o=[],_e=0;31>_e;_e++)o.push(a);return o}function Ac(a,o,_e){a.pendingLanes|=o,o!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,o=31-oc(o),a[o]=_e}function Bc(a,o){var _e=a.pendingLanes&~o;a.pendingLanes=o,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=o,a.mutableReadLanes&=o,a.entangledLanes&=o,o=a.entanglements;var tt=a.eventTimes;for(a=a.expirationTimes;0<_e;){var at=31-oc(_e),lt=1<<at;o[at]=0,tt[at]=-1,a[at]=-1,_e&=~lt}}function Cc(a,o){var _e=a.entangledLanes|=o;for(a=a.entanglements;_e;){var tt=31-oc(_e),at=1<<tt;at&o|a[tt]&o&&(a[tt]|=o),_e&=~at}}var C=0;function Dc(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(a,o){switch(a){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(o.pointerId)}}function Tc(a,o,_e,tt,at,lt){return a===null||a.nativeEvent!==lt?(a={blockedOn:o,domEventName:_e,eventSystemFlags:tt,nativeEvent:lt,targetContainers:[at]},o!==null&&(o=Cb(o),o!==null&&Fc(o)),a):(a.eventSystemFlags|=tt,o=a.targetContainers,at!==null&&o.indexOf(at)===-1&&o.push(at),a)}function Uc(a,o,_e,tt,at){switch(o){case"focusin":return Lc=Tc(Lc,a,o,_e,tt,at),!0;case"dragenter":return Mc=Tc(Mc,a,o,_e,tt,at),!0;case"mouseover":return Nc=Tc(Nc,a,o,_e,tt,at),!0;case"pointerover":var lt=at.pointerId;return Oc.set(lt,Tc(Oc.get(lt)||null,a,o,_e,tt,at)),!0;case"gotpointercapture":return lt=at.pointerId,Pc.set(lt,Tc(Pc.get(lt)||null,a,o,_e,tt,at)),!0}return!1}function Vc(a){var o=Wc(a.target);if(o!==null){var _e=Vb(o);if(_e!==null){if(o=_e.tag,o===13){if(o=Wb(_e),o!==null){a.blockedOn=o,Ic(a.priority,function(){Gc(_e)});return}}else if(o===3&&_e.stateNode.current.memoizedState.isDehydrated){a.blockedOn=_e.tag===3?_e.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Xc(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var _e=Yc(a.domEventName,a.eventSystemFlags,o[0],a.nativeEvent);if(_e===null){_e=a.nativeEvent;var tt=new _e.constructor(_e.type,_e);wb=tt,_e.target.dispatchEvent(tt),wb=null}else return o=Cb(_e),o!==null&&Fc(o),a.blockedOn=_e,!1;o.shift()}return!0}function Zc(a,o,_e){Xc(a)&&_e.delete(o)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(a,o){a.blockedOn===o&&(a.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(a){function o(at){return ad(at,a)}if(0<Kc.length){ad(Kc[0],a);for(var _e=1;_e<Kc.length;_e++){var tt=Kc[_e];tt.blockedOn===a&&(tt.blockedOn=null)}}for(Lc!==null&&ad(Lc,a),Mc!==null&&ad(Mc,a),Nc!==null&&ad(Nc,a),Oc.forEach(o),Pc.forEach(o),_e=0;_e<Qc.length;_e++)tt=Qc[_e],tt.blockedOn===a&&(tt.blockedOn=null);for(;0<Qc.length&&(_e=Qc[0],_e.blockedOn===null);)Vc(_e),_e.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(a,o,_e,tt){var at=C,lt=cd.transition;cd.transition=null;try{C=1,fd(a,o,_e,tt)}finally{C=at,cd.transition=lt}}function gd(a,o,_e,tt){var at=C,lt=cd.transition;cd.transition=null;try{C=4,fd(a,o,_e,tt)}finally{C=at,cd.transition=lt}}function fd(a,o,_e,tt){if(dd){var at=Yc(a,o,_e,tt);if(at===null)hd(a,o,tt,id,_e),Sc(a,tt);else if(Uc(at,a,o,_e,tt))tt.stopPropagation();else if(Sc(a,tt),o&4&&-1<Rc.indexOf(a)){for(;at!==null;){var lt=Cb(at);if(lt!==null&&Ec(lt),lt=Yc(a,o,_e,tt),lt===null&&hd(a,o,tt,id,_e),lt===at)break;at=lt}at!==null&&tt.stopPropagation()}else hd(a,o,tt,null,_e)}}var id=null;function Yc(a,o,_e,tt){if(id=null,a=xb(tt),a=Wc(a),a!==null)if(o=Vb(a),o===null)a=null;else if(_e=o.tag,_e===13){if(a=Wb(o),a!==null)return a;a=null}else if(_e===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null);return id=a,null}function jd(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var a,o=ld,_e=o.length,tt,at="value"in kd?kd.value:kd.textContent,lt=at.length;for(a=0;a<_e&&o[a]===at[a];a++);var it=_e-a;for(tt=1;tt<=it&&o[_e-tt]===at[lt-tt];tt++);return md=at.slice(a,1<tt?1-tt:void 0)}function od(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function pd(){return!0}function qd(){return!1}function rd(a){function o(_e,tt,at,lt,it){this._reactName=_e,this._targetInst=at,this.type=tt,this.nativeEvent=lt,this.target=it,this.currentTarget=null;for(var ut in a)a.hasOwnProperty(ut)&&(_e=a[ut],this[ut]=_e?_e(lt):lt[ut]);return this.isDefaultPrevented=(lt.defaultPrevented!=null?lt.defaultPrevented:lt.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$2(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _e=this.nativeEvent;_e&&(_e.preventDefault?_e.preventDefault():typeof _e.returnValue!="unknown"&&(_e.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var _e=this.nativeEvent;_e&&(_e.stopPropagation?_e.stopPropagation():typeof _e.cancelBubble!="unknown"&&(_e.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),o}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$2({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$2({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==yd&&(yd&&a.type==="mousemove"?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a),wd)},movementY:function(a){return"movementY"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=A$2({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$2({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$2({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$2({},sd,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$2({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=Od[a])?!!o[a]:!1}function zd(){return Pd}var Qd=A$2({},ud,{key:function(a){if(a.key){var o=Md[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=od(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Nd[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return a.type==="keypress"?od(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?od(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Rd=rd(Qd),Sd=A$2({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$2({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$2({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$2({},Ad,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;function ge(a,o){switch(a){case"keyup":return $d.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ie=!1;function je(a,o){switch(a){case"compositionend":return he(o);case"keypress":return o.which!==32?null:(fe=!0,ee);case"textInput":return a=o.data,a===ee&&fe?null:a;default:return null}}function ke(a,o){if(ie)return a==="compositionend"||!ae&&ge(a,o)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return de&&o.locale!=="ko"?null:o.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!le[a.type]:o==="textarea"}function ne(a,o,_e,tt){Eb(tt),o=oe(o,"onChange"),0<o.length&&(_e=new td("onChange","change",null,_e,tt),a.push({event:_e,listeners:o}))}var pe=null,qe=null;function re(a){se(a,0)}function te(a){var o=ue(a);if(Wa(o))return a}function ve(a,o){if(a==="change")return o}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(a){if(a.propertyName==="value"&&te(qe)){var o=[];ne(o,qe,a,xb(a)),Jb(re,o)}}function Ce(a,o,_e){a==="focusin"?(Ae(),pe=o,qe=_e,pe.attachEvent("onpropertychange",Be)):a==="focusout"&&Ae()}function De(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return te(qe)}function Ee(a,o){if(a==="click")return te(o)}function Fe(a,o){if(a==="input"||a==="change")return te(o)}function Ge(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(a,o){if(He(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var _e=Object.keys(a),tt=Object.keys(o);if(_e.length!==tt.length)return!1;for(tt=0;tt<_e.length;tt++){var at=_e[tt];if(!ja.call(o,at)||!He(a[at],o[at]))return!1}return!0}function Je(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Ke(a,o){var _e=Je(a);a=0;for(var tt;_e;){if(_e.nodeType===3){if(tt=a+_e.textContent.length,a<=o&&tt>=o)return{node:_e,offset:o-a};a=tt}e:{for(;_e;){if(_e.nextSibling){_e=_e.nextSibling;break e}_e=_e.parentNode}_e=void 0}_e=Je(_e)}}function Le(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?Le(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function Me(){for(var a=window,o=Xa();o instanceof a.HTMLIFrameElement;){try{var _e=typeof o.contentWindow.location.href=="string"}catch{_e=!1}if(_e)a=o.contentWindow;else break;o=Xa(a.document)}return o}function Ne(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}function Oe(a){var o=Me(),_e=a.focusedElem,tt=a.selectionRange;if(o!==_e&&_e&&_e.ownerDocument&&Le(_e.ownerDocument.documentElement,_e)){if(tt!==null&&Ne(_e)){if(o=tt.start,a=tt.end,a===void 0&&(a=o),"selectionStart"in _e)_e.selectionStart=o,_e.selectionEnd=Math.min(a,_e.value.length);else if(a=(o=_e.ownerDocument||document)&&o.defaultView||window,a.getSelection){a=a.getSelection();var at=_e.textContent.length,lt=Math.min(tt.start,at);tt=tt.end===void 0?lt:Math.min(tt.end,at),!a.extend&&lt>tt&&(at=tt,tt=lt,lt=at),at=Ke(_e,lt);var it=Ke(_e,tt);at&&it&&(a.rangeCount!==1||a.anchorNode!==at.node||a.anchorOffset!==at.offset||a.focusNode!==it.node||a.focusOffset!==it.offset)&&(o=o.createRange(),o.setStart(at.node,at.offset),a.removeAllRanges(),lt>tt?(a.addRange(o),a.extend(it.node,it.offset)):(o.setEnd(it.node,it.offset),a.addRange(o)))}}for(o=[],a=_e;a=a.parentNode;)a.nodeType===1&&o.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof _e.focus=="function"&&_e.focus(),_e=0;_e<o.length;_e++)a=o[_e],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(a,o,_e){var tt=_e.window===_e?_e.document:_e.nodeType===9?_e:_e.ownerDocument;Te||Qe==null||Qe!==Xa(tt)||(tt=Qe,"selectionStart"in tt&&Ne(tt)?tt={start:tt.selectionStart,end:tt.selectionEnd}:(tt=(tt.ownerDocument&&tt.ownerDocument.defaultView||window).getSelection(),tt={anchorNode:tt.anchorNode,anchorOffset:tt.anchorOffset,focusNode:tt.focusNode,focusOffset:tt.focusOffset}),Se&&Ie(Se,tt)||(Se=tt,tt=oe(Re,"onSelect"),0<tt.length&&(o=new td("onSelect","select",null,o,_e),a.push({event:o,listeners:tt}),o.target=Qe)))}function Ve(a,o){var _e={};return _e[a.toLowerCase()]=o.toLowerCase(),_e["Webkit"+a]="webkit"+o,_e["Moz"+a]="moz"+o,_e}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(a){if(Xe[a])return Xe[a];if(!We[a])return a;var o=We[a],_e;for(_e in o)if(o.hasOwnProperty(_e)&&_e in Ye)return Xe[a]=o[_e];return a}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(a,o){df.set(a,o),fa(o,[a])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(a,o,_e){var tt=a.type||"unknown-event";a.currentTarget=_e,Ub(tt,o,void 0,a),a.currentTarget=null}function se(a,o){o=(o&4)!==0;for(var _e=0;_e<a.length;_e++){var tt=a[_e],at=tt.event;tt=tt.listeners;e:{var lt=void 0;if(o)for(var it=tt.length-1;0<=it;it--){var ut=tt[it],s=ut.instance,et=ut.currentTarget;if(ut=ut.listener,s!==lt&&at.isPropagationStopped())break e;nf(at,ut,et),lt=s}else for(it=0;it<tt.length;it++){if(ut=tt[it],s=ut.instance,et=ut.currentTarget,ut=ut.listener,s!==lt&&at.isPropagationStopped())break e;nf(at,ut,et),lt=s}}}if(Qb)throw a=Rb,Qb=!1,Rb=null,a}function D$1(a,o){var _e=o[of];_e===void 0&&(_e=o[of]=new Set);var tt=a+"__bubble";_e.has(tt)||(pf(o,a,2,!1),_e.add(tt))}function qf(a,o,_e){var tt=0;o&&(tt|=4),pf(_e,a,tt,o)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(a){if(!a[rf]){a[rf]=!0,da.forEach(function(_e){_e!=="selectionchange"&&(mf.has(_e)||qf(_e,!1,a),qf(_e,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[rf]||(o[rf]=!0,qf("selectionchange",!1,o))}}function pf(a,o,_e,tt){switch(jd(o)){case 1:var at=ed;break;case 4:at=gd;break;default:at=fd}_e=at.bind(null,o,_e,a),at=void 0,!Lb||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(at=!0),tt?at!==void 0?a.addEventListener(o,_e,{capture:!0,passive:at}):a.addEventListener(o,_e,!0):at!==void 0?a.addEventListener(o,_e,{passive:at}):a.addEventListener(o,_e,!1)}function hd(a,o,_e,tt,at){var lt=tt;if(!(o&1)&&!(o&2)&&tt!==null)e:for(;;){if(tt===null)return;var it=tt.tag;if(it===3||it===4){var ut=tt.stateNode.containerInfo;if(ut===at||ut.nodeType===8&&ut.parentNode===at)break;if(it===4)for(it=tt.return;it!==null;){var s=it.tag;if((s===3||s===4)&&(s=it.stateNode.containerInfo,s===at||s.nodeType===8&&s.parentNode===at))return;it=it.return}for(;ut!==null;){if(it=Wc(ut),it===null)return;if(s=it.tag,s===5||s===6){tt=lt=it;continue e}ut=ut.parentNode}}tt=tt.return}Jb(function(){var et=lt,ot=xb(_e),st=[];e:{var Rt=df.get(a);if(Rt!==void 0){var ht=td,bt=a;switch(a){case"keypress":if(od(_e)===0)break e;case"keydown":case"keyup":ht=Rd;break;case"focusin":bt="focus",ht=Fd;break;case"focusout":bt="blur",ht=Fd;break;case"beforeblur":case"afterblur":ht=Fd;break;case"click":if(_e.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ht=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ht=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ht=Vd;break;case $e:case af:case bf:ht=Hd;break;case cf:ht=Xd;break;case"scroll":ht=vd;break;case"wheel":ht=Zd;break;case"copy":case"cut":case"paste":ht=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ht=Td}var ct=(o&4)!==0,mt=!ct&&a==="scroll",rt=ct?Rt!==null?Rt+"Capture":null:Rt;ct=[];for(var pt=et,ft;pt!==null;){ft=pt;var St=ft.stateNode;if(ft.tag===5&&St!==null&&(ft=St,rt!==null&&(St=Kb(pt,rt),St!=null&&ct.push(tf(pt,St,ft)))),mt)break;pt=pt.return}0<ct.length&&(Rt=new ht(Rt,bt,null,_e,ot),st.push({event:Rt,listeners:ct}))}}if(!(o&7)){e:{if(Rt=a==="mouseover"||a==="pointerover",ht=a==="mouseout"||a==="pointerout",Rt&&_e!==wb&&(bt=_e.relatedTarget||_e.fromElement)&&(Wc(bt)||bt[uf]))break e;if((ht||Rt)&&(Rt=ot.window===ot?ot:(Rt=ot.ownerDocument)?Rt.defaultView||Rt.parentWindow:window,ht?(bt=_e.relatedTarget||_e.toElement,ht=et,bt=bt?Wc(bt):null,bt!==null&&(mt=Vb(bt),bt!==mt||bt.tag!==5&&bt.tag!==6)&&(bt=null)):(ht=null,bt=et),ht!==bt)){if(ct=Bd,St="onMouseLeave",rt="onMouseEnter",pt="mouse",(a==="pointerout"||a==="pointerover")&&(ct=Td,St="onPointerLeave",rt="onPointerEnter",pt="pointer"),mt=ht==null?Rt:ue(ht),ft=bt==null?Rt:ue(bt),Rt=new ct(St,pt+"leave",ht,_e,ot),Rt.target=mt,Rt.relatedTarget=ft,St=null,Wc(ot)===et&&(ct=new ct(rt,pt+"enter",bt,_e,ot),ct.target=ft,ct.relatedTarget=mt,St=ct),mt=St,ht&&bt)t:{for(ct=ht,rt=bt,pt=0,ft=ct;ft;ft=vf(ft))pt++;for(ft=0,St=rt;St;St=vf(St))ft++;for(;0<pt-ft;)ct=vf(ct),pt--;for(;0<ft-pt;)rt=vf(rt),ft--;for(;pt--;){if(ct===rt||rt!==null&&ct===rt.alternate)break t;ct=vf(ct),rt=vf(rt)}ct=null}else ct=null;ht!==null&&wf(st,Rt,ht,ct,!1),bt!==null&&mt!==null&&wf(st,mt,bt,ct,!0)}}e:{if(Rt=et?ue(et):window,ht=Rt.nodeName&&Rt.nodeName.toLowerCase(),ht==="select"||ht==="input"&&Rt.type==="file")var It=ve;else if(me(Rt))if(we)It=Fe;else{It=De;var xt=Ce}else(ht=Rt.nodeName)&&ht.toLowerCase()==="input"&&(Rt.type==="checkbox"||Rt.type==="radio")&&(It=Ee);if(It&&(It=It(a,et))){ne(st,It,_e,ot);break e}xt&&xt(a,Rt,et),a==="focusout"&&(xt=Rt._wrapperState)&&xt.controlled&&Rt.type==="number"&&cb(Rt,"number",Rt.value)}switch(xt=et?ue(et):window,a){case"focusin":(me(xt)||xt.contentEditable==="true")&&(Qe=xt,Re=et,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(st,_e,ot);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(st,_e,ot)}var At;if(ae)e:{switch(a){case"compositionstart":var Dt="onCompositionStart";break e;case"compositionend":Dt="onCompositionEnd";break e;case"compositionupdate":Dt="onCompositionUpdate";break e}Dt=void 0}else ie?ge(a,_e)&&(Dt="onCompositionEnd"):a==="keydown"&&_e.keyCode===229&&(Dt="onCompositionStart");Dt&&(de&&_e.locale!=="ko"&&(ie||Dt!=="onCompositionStart"?Dt==="onCompositionEnd"&&ie&&(At=nd()):(kd=ot,ld="value"in kd?kd.value:kd.textContent,ie=!0)),xt=oe(et,Dt),0<xt.length&&(Dt=new Ld(Dt,a,null,_e,ot),st.push({event:Dt,listeners:xt}),At?Dt.data=At:(At=he(_e),At!==null&&(Dt.data=At)))),(At=ce?je(a,_e):ke(a,_e))&&(et=oe(et,"onBeforeInput"),0<et.length&&(ot=new Ld("onBeforeInput","beforeinput",null,_e,ot),st.push({event:ot,listeners:et}),ot.data=At))}se(st,o)})}function tf(a,o,_e){return{instance:a,listener:o,currentTarget:_e}}function oe(a,o){for(var _e=o+"Capture",tt=[];a!==null;){var at=a,lt=at.stateNode;at.tag===5&&lt!==null&&(at=lt,lt=Kb(a,_e),lt!=null&&tt.unshift(tf(a,lt,at)),lt=Kb(a,o),lt!=null&&tt.push(tf(a,lt,at))),a=a.return}return tt}function vf(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function wf(a,o,_e,tt,at){for(var lt=o._reactName,it=[];_e!==null&&_e!==tt;){var ut=_e,s=ut.alternate,et=ut.stateNode;if(s!==null&&s===tt)break;ut.tag===5&&et!==null&&(ut=et,at?(s=Kb(_e,lt),s!=null&&it.unshift(tf(_e,s,ut))):at||(s=Kb(_e,lt),s!=null&&it.push(tf(_e,s,ut)))),_e=_e.return}it.length!==0&&a.push({event:o,listeners:it})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(a){return(typeof a=="string"?a:""+a).replace(xf,`
`).replace(yf,"")}function Af(a,o,_e){if(o=zf(o),zf(a)!==o&&_e)throw Error(p$2(425))}function Bf(){}var Cf=null,Df=null;function Ef(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(a){return Hf.resolve(null).then(a).catch(If)}:Ff;function If(a){setTimeout(function(){throw a})}function Kf(a,o){var _e=o,tt=0;do{var at=_e.nextSibling;if(a.removeChild(_e),at&&at.nodeType===8)if(_e=at.data,_e==="/$"){if(tt===0){a.removeChild(at),bd(o);return}tt--}else _e!=="$"&&_e!=="$?"&&_e!=="$!"||tt++;_e=at}while(_e);bd(o)}function Lf(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return a}function Mf(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var _e=a.data;if(_e==="$"||_e==="$!"||_e==="$?"){if(o===0)return a;o--}else _e==="/$"&&o++}a=a.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(a){var o=a[Of];if(o)return o;for(var _e=a.parentNode;_e;){if(o=_e[uf]||_e[Of]){if(_e=o.alternate,o.child!==null||_e!==null&&_e.child!==null)for(a=Mf(a);a!==null;){if(_e=a[Of])return _e;a=Mf(a)}return o}a=_e,_e=a.parentNode}return null}function Cb(a){return a=a[Of]||a[uf],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ue(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(p$2(33))}function Db(a){return a[Pf]||null}var Sf=[],Tf=-1;function Uf(a){return{current:a}}function E(a){0>Tf||(a.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(a,o){Tf++,Sf[Tf]=a.current,a.current=o}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(a,o){var _e=a.type.contextTypes;if(!_e)return Vf;var tt=a.stateNode;if(tt&&tt.__reactInternalMemoizedUnmaskedChildContext===o)return tt.__reactInternalMemoizedMaskedChildContext;var at={},lt;for(lt in _e)at[lt]=o[lt];return tt&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=o,a.__reactInternalMemoizedMaskedChildContext=at),at}function Zf(a){return a=a.childContextTypes,a!=null}function $f(){E(Wf),E(H$1)}function ag(a,o,_e){if(H$1.current!==Vf)throw Error(p$2(168));G(H$1,o),G(Wf,_e)}function bg(a,o,_e){var tt=a.stateNode;if(o=o.childContextTypes,typeof tt.getChildContext!="function")return _e;tt=tt.getChildContext();for(var at in tt)if(!(at in o))throw Error(p$2(108,Ra(a)||"Unknown",at));return A$2({},_e,tt)}function cg(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G(H$1,a),G(Wf,Wf.current),!0}function dg(a,o,_e){var tt=a.stateNode;if(!tt)throw Error(p$2(169));_e?(a=bg(a,o,Xf),tt.__reactInternalMemoizedMergedChildContext=a,E(Wf),E(H$1),G(H$1,a)):E(Wf),G(Wf,_e)}var eg=null,fg=!1,gg=!1;function hg(a){eg===null?eg=[a]:eg.push(a)}function ig(a){fg=!0,hg(a)}function jg(){if(!gg&&eg!==null){gg=!0;var a=0,o=C;try{var _e=eg;for(C=1;a<_e.length;a++){var tt=_e[a];do tt=tt(!0);while(tt!==null)}eg=null,fg=!1}catch(at){throw eg!==null&&(eg=eg.slice(a+1)),ac(fc,jg),at}finally{C=o,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(a,o){kg[lg++]=ng,kg[lg++]=mg,mg=a,ng=o}function ug(a,o,_e){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=a;var tt=rg;a=sg;var at=32-oc(tt)-1;tt&=~(1<<at),_e+=1;var lt=32-oc(o)+at;if(30<lt){var it=at-at%5;lt=(tt&(1<<it)-1).toString(32),tt>>=it,at-=it,rg=1<<32-oc(o)+at|_e<<at|tt,sg=lt+a}else rg=1<<lt|_e<<at|tt,sg=a}function vg(a){a.return!==null&&(tg(a,1),ug(a,1,0))}function wg(a){for(;a===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;a===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(a,o){var _e=Bg(5,null,null,0);_e.elementType="DELETED",_e.stateNode=o,_e.return=a,o=a.deletions,o===null?(a.deletions=[_e],a.flags|=16):o.push(_e)}function Cg(a,o){switch(a.tag){case 5:var _e=a.type;return o=o.nodeType!==1||_e.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(a.stateNode=o,xg=a,yg=Lf(o.firstChild),!0):!1;case 6:return o=a.pendingProps===""||o.nodeType!==3?null:o,o!==null?(a.stateNode=o,xg=a,yg=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(_e=qg!==null?{id:rg,overflow:sg}:null,a.memoizedState={dehydrated:o,treeContext:_e,retryLane:1073741824},_e=Bg(18,null,null,0),_e.stateNode=o,_e.return=a,a.child=_e,xg=a,yg=null,!0):!1;default:return!1}}function Dg(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Eg(a){if(I$1){var o=yg;if(o){var _e=o;if(!Cg(a,o)){if(Dg(a))throw Error(p$2(418));o=Lf(_e.nextSibling);var tt=xg;o&&Cg(a,o)?Ag(tt,_e):(a.flags=a.flags&-4097|2,I$1=!1,xg=a)}}else{if(Dg(a))throw Error(p$2(418));a.flags=a.flags&-4097|2,I$1=!1,xg=a}}}function Fg(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;xg=a}function Gg(a){if(a!==xg)return!1;if(!I$1)return Fg(a),I$1=!0,!1;var o;if((o=a.tag!==3)&&!(o=a.tag!==5)&&(o=a.type,o=o!=="head"&&o!=="body"&&!Ef(a.type,a.memoizedProps)),o&&(o=yg)){if(Dg(a))throw Hg(),Error(p$2(418));for(;o;)Ag(a,o),o=Lf(o.nextSibling)}if(Fg(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(p$2(317));e:{for(a=a.nextSibling,o=0;a;){if(a.nodeType===8){var _e=a.data;if(_e==="/$"){if(o===0){yg=Lf(a.nextSibling);break e}o--}else _e!=="$"&&_e!=="$!"&&_e!=="$?"||o++}a=a.nextSibling}yg=null}}else yg=xg?Lf(a.stateNode.nextSibling):null;return!0}function Hg(){for(var a=yg;a;)a=Lf(a.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(a){zg===null?zg=[a]:zg.push(a)}var Kg=ua.ReactCurrentBatchConfig;function Lg(a,o){if(a&&a.defaultProps){o=A$2({},o),a=a.defaultProps;for(var _e in a)o[_e]===void 0&&(o[_e]=a[_e]);return o}return o}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(a){var o=Mg.current;E(Mg),a._currentValue=o}function Sg(a,o,_e){for(;a!==null;){var tt=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,tt!==null&&(tt.childLanes|=o)):tt!==null&&(tt.childLanes&o)!==o&&(tt.childLanes|=o),a===_e)break;a=a.return}}function Tg(a,o){Ng=a,Pg=Og=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&o&&(Ug=!0),a.firstContext=null)}function Vg(a){var o=a._currentValue;if(Pg!==a)if(a={context:a,memoizedValue:o,next:null},Og===null){if(Ng===null)throw Error(p$2(308));Og=a,Ng.dependencies={lanes:0,firstContext:a}}else Og=Og.next=a;return o}var Wg=null;function Xg(a){Wg===null?Wg=[a]:Wg.push(a)}function Yg(a,o,_e,tt){var at=o.interleaved;return at===null?(_e.next=_e,Xg(o)):(_e.next=at.next,at.next=_e),o.interleaved=_e,Zg(a,tt)}function Zg(a,o){a.lanes|=o;var _e=a.alternate;for(_e!==null&&(_e.lanes|=o),_e=a,a=a.return;a!==null;)a.childLanes|=o,_e=a.alternate,_e!==null&&(_e.childLanes|=o),_e=a,a=a.return;return _e.tag===3?_e.stateNode:null}var $g=!1;function ah(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ch(a,o){return{eventTime:a,lane:o,tag:0,payload:null,callback:null,next:null}}function dh(a,o,_e){var tt=a.updateQueue;if(tt===null)return null;if(tt=tt.shared,K&2){var at=tt.pending;return at===null?o.next=o:(o.next=at.next,at.next=o),tt.pending=o,Zg(a,_e)}return at=tt.interleaved,at===null?(o.next=o,Xg(tt)):(o.next=at.next,at.next=o),tt.interleaved=o,Zg(a,_e)}function eh(a,o,_e){if(o=o.updateQueue,o!==null&&(o=o.shared,(_e&4194240)!==0)){var tt=o.lanes;tt&=a.pendingLanes,_e|=tt,o.lanes=_e,Cc(a,_e)}}function fh(a,o){var _e=a.updateQueue,tt=a.alternate;if(tt!==null&&(tt=tt.updateQueue,_e===tt)){var at=null,lt=null;if(_e=_e.firstBaseUpdate,_e!==null){do{var it={eventTime:_e.eventTime,lane:_e.lane,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null};lt===null?at=lt=it:lt=lt.next=it,_e=_e.next}while(_e!==null);lt===null?at=lt=o:lt=lt.next=o}else at=lt=o;_e={baseState:tt.baseState,firstBaseUpdate:at,lastBaseUpdate:lt,shared:tt.shared,effects:tt.effects},a.updateQueue=_e;return}a=_e.lastBaseUpdate,a===null?_e.firstBaseUpdate=o:a.next=o,_e.lastBaseUpdate=o}function gh(a,o,_e,tt){var at=a.updateQueue;$g=!1;var lt=at.firstBaseUpdate,it=at.lastBaseUpdate,ut=at.shared.pending;if(ut!==null){at.shared.pending=null;var s=ut,et=s.next;s.next=null,it===null?lt=et:it.next=et,it=s;var ot=a.alternate;ot!==null&&(ot=ot.updateQueue,ut=ot.lastBaseUpdate,ut!==it&&(ut===null?ot.firstBaseUpdate=et:ut.next=et,ot.lastBaseUpdate=s))}if(lt!==null){var st=at.baseState;it=0,ot=et=s=null,ut=lt;do{var Rt=ut.lane,ht=ut.eventTime;if((tt&Rt)===Rt){ot!==null&&(ot=ot.next={eventTime:ht,lane:0,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null});e:{var bt=a,ct=ut;switch(Rt=o,ht=_e,ct.tag){case 1:if(bt=ct.payload,typeof bt=="function"){st=bt.call(ht,st,Rt);break e}st=bt;break e;case 3:bt.flags=bt.flags&-65537|128;case 0:if(bt=ct.payload,Rt=typeof bt=="function"?bt.call(ht,st,Rt):bt,Rt==null)break e;st=A$2({},st,Rt);break e;case 2:$g=!0}}ut.callback!==null&&ut.lane!==0&&(a.flags|=64,Rt=at.effects,Rt===null?at.effects=[ut]:Rt.push(ut))}else ht={eventTime:ht,lane:Rt,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null},ot===null?(et=ot=ht,s=st):ot=ot.next=ht,it|=Rt;if(ut=ut.next,ut===null){if(ut=at.shared.pending,ut===null)break;Rt=ut,ut=Rt.next,Rt.next=null,at.lastBaseUpdate=Rt,at.shared.pending=null}}while(1);if(ot===null&&(s=st),at.baseState=s,at.firstBaseUpdate=et,at.lastBaseUpdate=ot,o=at.shared.interleaved,o!==null){at=o;do it|=at.lane,at=at.next;while(at!==o)}else lt===null&&(at.shared.lanes=0);hh|=it,a.lanes=it,a.memoizedState=st}}function ih(a,o,_e){if(a=o.effects,o.effects=null,a!==null)for(o=0;o<a.length;o++){var tt=a[o],at=tt.callback;if(at!==null){if(tt.callback=null,tt=_e,typeof at!="function")throw Error(p$2(191,at));at.call(tt)}}}var jh=new aa.Component().refs;function kh(a,o,_e,tt){o=a.memoizedState,_e=_e(tt,o),_e=_e==null?o:A$2({},o,_e),a.memoizedState=_e,a.lanes===0&&(a.updateQueue.baseState=_e)}var nh={isMounted:function(a){return(a=a._reactInternals)?Vb(a)===a:!1},enqueueSetState:function(a,o,_e){a=a._reactInternals;var tt=L(),at=lh(a),lt=ch(tt,at);lt.payload=o,_e!=null&&(lt.callback=_e),o=dh(a,lt,at),o!==null&&(mh(o,a,at,tt),eh(o,a,at))},enqueueReplaceState:function(a,o,_e){a=a._reactInternals;var tt=L(),at=lh(a),lt=ch(tt,at);lt.tag=1,lt.payload=o,_e!=null&&(lt.callback=_e),o=dh(a,lt,at),o!==null&&(mh(o,a,at,tt),eh(o,a,at))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var _e=L(),tt=lh(a),at=ch(_e,tt);at.tag=2,o!=null&&(at.callback=o),o=dh(a,at,tt),o!==null&&(mh(o,a,tt,_e),eh(o,a,tt))}};function oh(a,o,_e,tt,at,lt,it){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(tt,lt,it):o.prototype&&o.prototype.isPureReactComponent?!Ie(_e,tt)||!Ie(at,lt):!0}function ph(a,o,_e){var tt=!1,at=Vf,lt=o.contextType;return typeof lt=="object"&&lt!==null?lt=Vg(lt):(at=Zf(o)?Xf:H$1.current,tt=o.contextTypes,lt=(tt=tt!=null)?Yf(a,at):Vf),o=new o(_e,lt),a.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=nh,a.stateNode=o,o._reactInternals=a,tt&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=at,a.__reactInternalMemoizedMaskedChildContext=lt),o}function qh(a,o,_e,tt){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(_e,tt),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(_e,tt),o.state!==a&&nh.enqueueReplaceState(o,o.state,null)}function rh(a,o,_e,tt){var at=a.stateNode;at.props=_e,at.state=a.memoizedState,at.refs=jh,ah(a);var lt=o.contextType;typeof lt=="object"&&lt!==null?at.context=Vg(lt):(lt=Zf(o)?Xf:H$1.current,at.context=Yf(a,lt)),at.state=a.memoizedState,lt=o.getDerivedStateFromProps,typeof lt=="function"&&(kh(a,o,lt,_e),at.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof at.getSnapshotBeforeUpdate=="function"||typeof at.UNSAFE_componentWillMount!="function"&&typeof at.componentWillMount!="function"||(o=at.state,typeof at.componentWillMount=="function"&&at.componentWillMount(),typeof at.UNSAFE_componentWillMount=="function"&&at.UNSAFE_componentWillMount(),o!==at.state&&nh.enqueueReplaceState(at,at.state,null),gh(a,_e,at,tt),at.state=a.memoizedState),typeof at.componentDidMount=="function"&&(a.flags|=4194308)}function sh(a,o,_e){if(a=_e.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(_e._owner){if(_e=_e._owner,_e){if(_e.tag!==1)throw Error(p$2(309));var tt=_e.stateNode}if(!tt)throw Error(p$2(147,a));var at=tt,lt=""+a;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===lt?o.ref:(o=function(it){var ut=at.refs;ut===jh&&(ut=at.refs={}),it===null?delete ut[lt]:ut[lt]=it},o._stringRef=lt,o)}if(typeof a!="string")throw Error(p$2(284));if(!_e._owner)throw Error(p$2(290,a))}return a}function th(a,o){throw a=Object.prototype.toString.call(o),Error(p$2(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a))}function uh(a){var o=a._init;return o(a._payload)}function vh(a){function o(rt,pt){if(a){var ft=rt.deletions;ft===null?(rt.deletions=[pt],rt.flags|=16):ft.push(pt)}}function _e(rt,pt){if(!a)return null;for(;pt!==null;)o(rt,pt),pt=pt.sibling;return null}function tt(rt,pt){for(rt=new Map;pt!==null;)pt.key!==null?rt.set(pt.key,pt):rt.set(pt.index,pt),pt=pt.sibling;return rt}function at(rt,pt){return rt=wh(rt,pt),rt.index=0,rt.sibling=null,rt}function lt(rt,pt,ft){return rt.index=ft,a?(ft=rt.alternate,ft!==null?(ft=ft.index,ft<pt?(rt.flags|=2,pt):ft):(rt.flags|=2,pt)):(rt.flags|=1048576,pt)}function it(rt){return a&&rt.alternate===null&&(rt.flags|=2),rt}function ut(rt,pt,ft,St){return pt===null||pt.tag!==6?(pt=xh(ft,rt.mode,St),pt.return=rt,pt):(pt=at(pt,ft),pt.return=rt,pt)}function s(rt,pt,ft,St){var It=ft.type;return It===ya?ot(rt,pt,ft.props.children,St,ft.key):pt!==null&&(pt.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Ha&&uh(It)===pt.type)?(St=at(pt,ft.props),St.ref=sh(rt,pt,ft),St.return=rt,St):(St=yh(ft.type,ft.key,ft.props,null,rt.mode,St),St.ref=sh(rt,pt,ft),St.return=rt,St)}function et(rt,pt,ft,St){return pt===null||pt.tag!==4||pt.stateNode.containerInfo!==ft.containerInfo||pt.stateNode.implementation!==ft.implementation?(pt=zh(ft,rt.mode,St),pt.return=rt,pt):(pt=at(pt,ft.children||[]),pt.return=rt,pt)}function ot(rt,pt,ft,St,It){return pt===null||pt.tag!==7?(pt=Ah(ft,rt.mode,St,It),pt.return=rt,pt):(pt=at(pt,ft),pt.return=rt,pt)}function st(rt,pt,ft){if(typeof pt=="string"&&pt!==""||typeof pt=="number")return pt=xh(""+pt,rt.mode,ft),pt.return=rt,pt;if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case va:return ft=yh(pt.type,pt.key,pt.props,null,rt.mode,ft),ft.ref=sh(rt,null,pt),ft.return=rt,ft;case wa:return pt=zh(pt,rt.mode,ft),pt.return=rt,pt;case Ha:var St=pt._init;return st(rt,St(pt._payload),ft)}if(eb(pt)||Ka(pt))return pt=Ah(pt,rt.mode,ft,null),pt.return=rt,pt;th(rt,pt)}return null}function Rt(rt,pt,ft,St){var It=pt!==null?pt.key:null;if(typeof ft=="string"&&ft!==""||typeof ft=="number")return It!==null?null:ut(rt,pt,""+ft,St);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case va:return ft.key===It?s(rt,pt,ft,St):null;case wa:return ft.key===It?et(rt,pt,ft,St):null;case Ha:return It=ft._init,Rt(rt,pt,It(ft._payload),St)}if(eb(ft)||Ka(ft))return It!==null?null:ot(rt,pt,ft,St,null);th(rt,ft)}return null}function ht(rt,pt,ft,St,It){if(typeof St=="string"&&St!==""||typeof St=="number")return rt=rt.get(ft)||null,ut(pt,rt,""+St,It);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case va:return rt=rt.get(St.key===null?ft:St.key)||null,s(pt,rt,St,It);case wa:return rt=rt.get(St.key===null?ft:St.key)||null,et(pt,rt,St,It);case Ha:var xt=St._init;return ht(rt,pt,ft,xt(St._payload),It)}if(eb(St)||Ka(St))return rt=rt.get(ft)||null,ot(pt,rt,St,It,null);th(pt,St)}return null}function bt(rt,pt,ft,St){for(var It=null,xt=null,At=pt,Dt=pt=0,wt=null;At!==null&&Dt<ft.length;Dt++){At.index>Dt?(wt=At,At=null):wt=At.sibling;var Mt=Rt(rt,At,ft[Dt],St);if(Mt===null){At===null&&(At=wt);break}a&&At&&Mt.alternate===null&&o(rt,At),pt=lt(Mt,pt,Dt),xt===null?It=Mt:xt.sibling=Mt,xt=Mt,At=wt}if(Dt===ft.length)return _e(rt,At),I$1&&tg(rt,Dt),It;if(At===null){for(;Dt<ft.length;Dt++)At=st(rt,ft[Dt],St),At!==null&&(pt=lt(At,pt,Dt),xt===null?It=At:xt.sibling=At,xt=At);return I$1&&tg(rt,Dt),It}for(At=tt(rt,At);Dt<ft.length;Dt++)wt=ht(At,rt,Dt,ft[Dt],St),wt!==null&&(a&&wt.alternate!==null&&At.delete(wt.key===null?Dt:wt.key),pt=lt(wt,pt,Dt),xt===null?It=wt:xt.sibling=wt,xt=wt);return a&&At.forEach(function(vt){return o(rt,vt)}),I$1&&tg(rt,Dt),It}function ct(rt,pt,ft,St){var It=Ka(ft);if(typeof It!="function")throw Error(p$2(150));if(ft=It.call(ft),ft==null)throw Error(p$2(151));for(var xt=It=null,At=pt,Dt=pt=0,wt=null,Mt=ft.next();At!==null&&!Mt.done;Dt++,Mt=ft.next()){At.index>Dt?(wt=At,At=null):wt=At.sibling;var vt=Rt(rt,At,Mt.value,St);if(vt===null){At===null&&(At=wt);break}a&&At&&vt.alternate===null&&o(rt,At),pt=lt(vt,pt,Dt),xt===null?It=vt:xt.sibling=vt,xt=vt,At=wt}if(Mt.done)return _e(rt,At),I$1&&tg(rt,Dt),It;if(At===null){for(;!Mt.done;Dt++,Mt=ft.next())Mt=st(rt,Mt.value,St),Mt!==null&&(pt=lt(Mt,pt,Dt),xt===null?It=Mt:xt.sibling=Mt,xt=Mt);return I$1&&tg(rt,Dt),It}for(At=tt(rt,At);!Mt.done;Dt++,Mt=ft.next())Mt=ht(At,rt,Dt,Mt.value,St),Mt!==null&&(a&&Mt.alternate!==null&&At.delete(Mt.key===null?Dt:Mt.key),pt=lt(Mt,pt,Dt),xt===null?It=Mt:xt.sibling=Mt,xt=Mt);return a&&At.forEach(function(Ft){return o(rt,Ft)}),I$1&&tg(rt,Dt),It}function mt(rt,pt,ft,St){if(typeof ft=="object"&&ft!==null&&ft.type===ya&&ft.key===null&&(ft=ft.props.children),typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case va:e:{for(var It=ft.key,xt=pt;xt!==null;){if(xt.key===It){if(It=ft.type,It===ya){if(xt.tag===7){_e(rt,xt.sibling),pt=at(xt,ft.props.children),pt.return=rt,rt=pt;break e}}else if(xt.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Ha&&uh(It)===xt.type){_e(rt,xt.sibling),pt=at(xt,ft.props),pt.ref=sh(rt,xt,ft),pt.return=rt,rt=pt;break e}_e(rt,xt);break}else o(rt,xt);xt=xt.sibling}ft.type===ya?(pt=Ah(ft.props.children,rt.mode,St,ft.key),pt.return=rt,rt=pt):(St=yh(ft.type,ft.key,ft.props,null,rt.mode,St),St.ref=sh(rt,pt,ft),St.return=rt,rt=St)}return it(rt);case wa:e:{for(xt=ft.key;pt!==null;){if(pt.key===xt)if(pt.tag===4&&pt.stateNode.containerInfo===ft.containerInfo&&pt.stateNode.implementation===ft.implementation){_e(rt,pt.sibling),pt=at(pt,ft.children||[]),pt.return=rt,rt=pt;break e}else{_e(rt,pt);break}else o(rt,pt);pt=pt.sibling}pt=zh(ft,rt.mode,St),pt.return=rt,rt=pt}return it(rt);case Ha:return xt=ft._init,mt(rt,pt,xt(ft._payload),St)}if(eb(ft))return bt(rt,pt,ft,St);if(Ka(ft))return ct(rt,pt,ft,St);th(rt,ft)}return typeof ft=="string"&&ft!==""||typeof ft=="number"?(ft=""+ft,pt!==null&&pt.tag===6?(_e(rt,pt.sibling),pt=at(pt,ft),pt.return=rt,rt=pt):(_e(rt,pt),pt=xh(ft,rt.mode,St),pt.return=rt,rt=pt),it(rt)):_e(rt,pt)}return mt}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(a){if(a===Dh)throw Error(p$2(174));return a}function Ih(a,o){switch(G(Gh,o),G(Fh,a),G(Eh,Dh),a=o.nodeType,a){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:lb(null,"");break;default:a=a===8?o.parentNode:o,o=a.namespaceURI||null,a=a.tagName,o=lb(o,a)}E(Eh),G(Eh,o)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh(a){Hh(Gh.current);var o=Hh(Eh.current),_e=lb(o,a.type);o!==_e&&(G(Fh,a),G(Eh,_e))}function Lh(a){Fh.current===a&&(E(Eh),E(Fh))}var M$1=Uf(0);function Mh(a){for(var o=a;o!==null;){if(o.tag===13){var _e=o.memoizedState;if(_e!==null&&(_e=_e.dehydrated,_e===null||_e.data==="$?"||_e.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Nh=[];function Oh(){for(var a=0;a<Nh.length;a++)Nh[a]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N$2=null,O$2=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q$1(){throw Error(p$2(321))}function Wh(a,o){if(o===null)return!1;for(var _e=0;_e<o.length&&_e<a.length;_e++)if(!He(a[_e],o[_e]))return!1;return!0}function Xh(a,o,_e,tt,at,lt){if(Rh=lt,N$2=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ph.current=a===null||a.memoizedState===null?Yh:Zh,a=_e(tt,at),Th){lt=0;do{if(Th=!1,Uh=0,25<=lt)throw Error(p$2(301));lt+=1,P=O$2=null,o.updateQueue=null,Ph.current=$h,a=_e(tt,at)}while(Th)}if(Ph.current=ai,o=O$2!==null&&O$2.next!==null,Rh=0,P=O$2=N$2=null,Sh=!1,o)throw Error(p$2(300));return a}function bi(){var a=Uh!==0;return Uh=0,a}function ci(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N$2.memoizedState=P=a:P=P.next=a,P}function di(){if(O$2===null){var a=N$2.alternate;a=a!==null?a.memoizedState:null}else a=O$2.next;var o=P===null?N$2.memoizedState:P.next;if(o!==null)P=o,O$2=a;else{if(a===null)throw Error(p$2(310));O$2=a,a={memoizedState:O$2.memoizedState,baseState:O$2.baseState,baseQueue:O$2.baseQueue,queue:O$2.queue,next:null},P===null?N$2.memoizedState=P=a:P=P.next=a}return P}function ei(a,o){return typeof o=="function"?o(a):o}function fi(a){var o=di(),_e=o.queue;if(_e===null)throw Error(p$2(311));_e.lastRenderedReducer=a;var tt=O$2,at=tt.baseQueue,lt=_e.pending;if(lt!==null){if(at!==null){var it=at.next;at.next=lt.next,lt.next=it}tt.baseQueue=at=lt,_e.pending=null}if(at!==null){lt=at.next,tt=tt.baseState;var ut=it=null,s=null,et=lt;do{var ot=et.lane;if((Rh&ot)===ot)s!==null&&(s=s.next={lane:0,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),tt=et.hasEagerState?et.eagerState:a(tt,et.action);else{var st={lane:ot,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null};s===null?(ut=s=st,it=tt):s=s.next=st,N$2.lanes|=ot,hh|=ot}et=et.next}while(et!==null&&et!==lt);s===null?it=tt:s.next=ut,He(tt,o.memoizedState)||(Ug=!0),o.memoizedState=tt,o.baseState=it,o.baseQueue=s,_e.lastRenderedState=tt}if(a=_e.interleaved,a!==null){at=a;do lt=at.lane,N$2.lanes|=lt,hh|=lt,at=at.next;while(at!==a)}else at===null&&(_e.lanes=0);return[o.memoizedState,_e.dispatch]}function gi(a){var o=di(),_e=o.queue;if(_e===null)throw Error(p$2(311));_e.lastRenderedReducer=a;var tt=_e.dispatch,at=_e.pending,lt=o.memoizedState;if(at!==null){_e.pending=null;var it=at=at.next;do lt=a(lt,it.action),it=it.next;while(it!==at);He(lt,o.memoizedState)||(Ug=!0),o.memoizedState=lt,o.baseQueue===null&&(o.baseState=lt),_e.lastRenderedState=lt}return[lt,tt]}function hi(){}function ii(a,o){var _e=N$2,tt=di(),at=o(),lt=!He(tt.memoizedState,at);if(lt&&(tt.memoizedState=at,Ug=!0),tt=tt.queue,ji(ki.bind(null,_e,tt,a),[a]),tt.getSnapshot!==o||lt||P!==null&&P.memoizedState.tag&1){if(_e.flags|=2048,li(9,mi.bind(null,_e,tt,at,o),void 0,null),R$1===null)throw Error(p$2(349));Rh&30||ni(_e,o,at)}return at}function ni(a,o,_e){a.flags|=16384,a={getSnapshot:o,value:_e},o=N$2.updateQueue,o===null?(o={lastEffect:null,stores:null},N$2.updateQueue=o,o.stores=[a]):(_e=o.stores,_e===null?o.stores=[a]:_e.push(a))}function mi(a,o,_e,tt){o.value=_e,o.getSnapshot=tt,oi(o)&&pi(a)}function ki(a,o,_e){return _e(function(){oi(o)&&pi(a)})}function oi(a){var o=a.getSnapshot;a=a.value;try{var _e=o();return!He(a,_e)}catch{return!0}}function pi(a){var o=Zg(a,1);o!==null&&mh(o,a,1,-1)}function qi(a){var o=ci();return typeof a=="function"&&(a=a()),o.memoizedState=o.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:a},o.queue=a,a=a.dispatch=ri.bind(null,N$2,a),[o.memoizedState,a]}function li(a,o,_e,tt){return a={tag:a,create:o,destroy:_e,deps:tt,next:null},o=N$2.updateQueue,o===null?(o={lastEffect:null,stores:null},N$2.updateQueue=o,o.lastEffect=a.next=a):(_e=o.lastEffect,_e===null?o.lastEffect=a.next=a:(tt=_e.next,_e.next=a,a.next=tt,o.lastEffect=a)),a}function si(){return di().memoizedState}function ti(a,o,_e,tt){var at=ci();N$2.flags|=a,at.memoizedState=li(1|o,_e,void 0,tt===void 0?null:tt)}function ui(a,o,_e,tt){var at=di();tt=tt===void 0?null:tt;var lt=void 0;if(O$2!==null){var it=O$2.memoizedState;if(lt=it.destroy,tt!==null&&Wh(tt,it.deps)){at.memoizedState=li(o,_e,lt,tt);return}}N$2.flags|=a,at.memoizedState=li(1|o,_e,lt,tt)}function vi(a,o){return ti(8390656,8,a,o)}function ji(a,o){return ui(2048,8,a,o)}function wi(a,o){return ui(4,2,a,o)}function xi(a,o){return ui(4,4,a,o)}function yi(a,o){if(typeof o=="function")return a=a(),o(a),function(){o(null)};if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function zi(a,o,_e){return _e=_e!=null?_e.concat([a]):null,ui(4,4,yi.bind(null,o,a),_e)}function Ai(){}function Bi(a,o){var _e=di();o=o===void 0?null:o;var tt=_e.memoizedState;return tt!==null&&o!==null&&Wh(o,tt[1])?tt[0]:(_e.memoizedState=[a,o],a)}function Ci(a,o){var _e=di();o=o===void 0?null:o;var tt=_e.memoizedState;return tt!==null&&o!==null&&Wh(o,tt[1])?tt[0]:(a=a(),_e.memoizedState=[a,o],a)}function Di(a,o,_e){return Rh&21?(He(_e,o)||(_e=yc(),N$2.lanes|=_e,hh|=_e,a.baseState=!0),o):(a.baseState&&(a.baseState=!1,Ug=!0),a.memoizedState=_e)}function Ei(a,o){var _e=C;C=_e!==0&&4>_e?_e:4,a(!0);var tt=Qh.transition;Qh.transition={};try{a(!1),o()}finally{C=_e,Qh.transition=tt}}function Fi(){return di().memoizedState}function Gi(a,o,_e){var tt=lh(a);if(_e={lane:tt,action:_e,hasEagerState:!1,eagerState:null,next:null},Hi(a))Ii(o,_e);else if(_e=Yg(a,o,_e,tt),_e!==null){var at=L();mh(_e,a,tt,at),Ji(_e,o,tt)}}function ri(a,o,_e){var tt=lh(a),at={lane:tt,action:_e,hasEagerState:!1,eagerState:null,next:null};if(Hi(a))Ii(o,at);else{var lt=a.alternate;if(a.lanes===0&&(lt===null||lt.lanes===0)&&(lt=o.lastRenderedReducer,lt!==null))try{var it=o.lastRenderedState,ut=lt(it,_e);if(at.hasEagerState=!0,at.eagerState=ut,He(ut,it)){var s=o.interleaved;s===null?(at.next=at,Xg(o)):(at.next=s.next,s.next=at),o.interleaved=at;return}}catch{}finally{}_e=Yg(a,o,at,tt),_e!==null&&(at=L(),mh(_e,a,tt,at),Ji(_e,o,tt))}}function Hi(a){var o=a.alternate;return a===N$2||o!==null&&o===N$2}function Ii(a,o){Th=Sh=!0;var _e=a.pending;_e===null?o.next=o:(o.next=_e.next,_e.next=o),a.pending=o}function Ji(a,o,_e){if(_e&4194240){var tt=o.lanes;tt&=a.pendingLanes,_e|=tt,o.lanes=_e,Cc(a,_e)}}var ai={readContext:Vg,useCallback:Q$1,useContext:Q$1,useEffect:Q$1,useImperativeHandle:Q$1,useInsertionEffect:Q$1,useLayoutEffect:Q$1,useMemo:Q$1,useReducer:Q$1,useRef:Q$1,useState:Q$1,useDebugValue:Q$1,useDeferredValue:Q$1,useTransition:Q$1,useMutableSource:Q$1,useSyncExternalStore:Q$1,useId:Q$1,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(a,o){return ci().memoizedState=[a,o===void 0?null:o],a},useContext:Vg,useEffect:vi,useImperativeHandle:function(a,o,_e){return _e=_e!=null?_e.concat([a]):null,ti(4194308,4,yi.bind(null,o,a),_e)},useLayoutEffect:function(a,o){return ti(4194308,4,a,o)},useInsertionEffect:function(a,o){return ti(4,2,a,o)},useMemo:function(a,o){var _e=ci();return o=o===void 0?null:o,a=a(),_e.memoizedState=[a,o],a},useReducer:function(a,o,_e){var tt=ci();return o=_e!==void 0?_e(o):o,tt.memoizedState=tt.baseState=o,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:o},tt.queue=a,a=a.dispatch=Gi.bind(null,N$2,a),[tt.memoizedState,a]},useRef:function(a){var o=ci();return a={current:a},o.memoizedState=a},useState:qi,useDebugValue:Ai,useDeferredValue:function(a){return ci().memoizedState=a},useTransition:function(){var a=qi(!1),o=a[0];return a=Ei.bind(null,a[1]),ci().memoizedState=a,[o,a]},useMutableSource:function(){},useSyncExternalStore:function(a,o,_e){var tt=N$2,at=ci();if(I$1){if(_e===void 0)throw Error(p$2(407));_e=_e()}else{if(_e=o(),R$1===null)throw Error(p$2(349));Rh&30||ni(tt,o,_e)}at.memoizedState=_e;var lt={value:_e,getSnapshot:o};return at.queue=lt,vi(ki.bind(null,tt,lt,a),[a]),tt.flags|=2048,li(9,mi.bind(null,tt,lt,_e,o),void 0,null),_e},useId:function(){var a=ci(),o=R$1.identifierPrefix;if(I$1){var _e=sg,tt=rg;_e=(tt&~(1<<32-oc(tt)-1)).toString(32)+_e,o=":"+o+"R"+_e,_e=Uh++,0<_e&&(o+="H"+_e.toString(32)),o+=":"}else _e=Vh++,o=":"+o+"r"+_e.toString(32)+":";return a.memoizedState=o},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(a){var o=di();return Di(o,O$2.memoizedState,a)},useTransition:function(){var a=fi(ei)[0],o=di().memoizedState;return[a,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(a){var o=di();return O$2===null?o.memoizedState=a:Di(o,O$2.memoizedState,a)},useTransition:function(){var a=gi(ei)[0],o=di().memoizedState;return[a,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(a,o){try{var _e="",tt=o;do _e+=Pa(tt),tt=tt.return;while(tt);var at=_e}catch(lt){at=`
Error generating stack: `+lt.message+`
`+lt.stack}return{value:a,source:o,stack:at,digest:null}}function Li(a,o,_e){return{value:a,source:null,stack:_e??null,digest:o??null}}function Mi(a,o){try{console.error(o.value)}catch(_e){setTimeout(function(){throw _e})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(a,o,_e){_e=ch(-1,_e),_e.tag=3,_e.payload={element:null};var tt=o.value;return _e.callback=function(){Pi||(Pi=!0,Qi=tt),Mi(a,o)},_e}function Ri(a,o,_e){_e=ch(-1,_e),_e.tag=3;var tt=a.type.getDerivedStateFromError;if(typeof tt=="function"){var at=o.value;_e.payload=function(){return tt(at)},_e.callback=function(){Mi(a,o)}}var lt=a.stateNode;return lt!==null&&typeof lt.componentDidCatch=="function"&&(_e.callback=function(){Mi(a,o),typeof tt!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var it=o.stack;this.componentDidCatch(o.value,{componentStack:it!==null?it:""})}),_e}function Ti(a,o,_e){var tt=a.pingCache;if(tt===null){tt=a.pingCache=new Ni;var at=new Set;tt.set(o,at)}else at=tt.get(o),at===void 0&&(at=new Set,tt.set(o,at));at.has(_e)||(at.add(_e),a=Ui.bind(null,a,o,_e),o.then(a,a))}function Vi(a){do{var o;if((o=a.tag===13)&&(o=a.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return a;a=a.return}while(a!==null);return null}function Wi(a,o,_e,tt,at){return a.mode&1?(a.flags|=65536,a.lanes=at,a):(a===o?a.flags|=65536:(a.flags|=128,_e.flags|=131072,_e.flags&=-52805,_e.tag===1&&(_e.alternate===null?_e.tag=17:(o=ch(-1,1),o.tag=2,dh(_e,o,1))),_e.lanes|=1),a)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(a,o,_e,tt){o.child=a===null?Ch(o,null,_e,tt):Bh(o,a.child,_e,tt)}function Zi(a,o,_e,tt,at){_e=_e.render;var lt=o.ref;return Tg(o,at),tt=Xh(a,o,_e,tt,lt,at),_e=bi(),a!==null&&!Ug?(o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~at,$i(a,o,at)):(I$1&&_e&&vg(o),o.flags|=1,Yi(a,o,tt,at),o.child)}function aj(a,o,_e,tt,at){if(a===null){var lt=_e.type;return typeof lt=="function"&&!bj(lt)&&lt.defaultProps===void 0&&_e.compare===null&&_e.defaultProps===void 0?(o.tag=15,o.type=lt,cj(a,o,lt,tt,at)):(a=yh(_e.type,null,tt,o,o.mode,at),a.ref=o.ref,a.return=o,o.child=a)}if(lt=a.child,!(a.lanes&at)){var it=lt.memoizedProps;if(_e=_e.compare,_e=_e!==null?_e:Ie,_e(it,tt)&&a.ref===o.ref)return $i(a,o,at)}return o.flags|=1,a=wh(lt,tt),a.ref=o.ref,a.return=o,o.child=a}function cj(a,o,_e,tt,at){if(a!==null){var lt=a.memoizedProps;if(Ie(lt,tt)&&a.ref===o.ref)if(Ug=!1,o.pendingProps=tt=lt,(a.lanes&at)!==0)a.flags&131072&&(Ug=!0);else return o.lanes=a.lanes,$i(a,o,at)}return dj(a,o,_e,tt,at)}function ej(a,o,_e){var tt=o.pendingProps,at=tt.children,lt=a!==null?a.memoizedState:null;if(tt.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=_e;else{if(!(_e&1073741824))return a=lt!==null?lt.baseLanes|_e:_e,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:a,cachePool:null,transitions:null},o.updateQueue=null,G(fj,gj),gj|=a,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt=lt!==null?lt.baseLanes:_e,G(fj,gj),gj|=tt}else lt!==null?(tt=lt.baseLanes|_e,o.memoizedState=null):tt=_e,G(fj,gj),gj|=tt;return Yi(a,o,at,_e),o.child}function hj(a,o){var _e=o.ref;(a===null&&_e!==null||a!==null&&a.ref!==_e)&&(o.flags|=512,o.flags|=2097152)}function dj(a,o,_e,tt,at){var lt=Zf(_e)?Xf:H$1.current;return lt=Yf(o,lt),Tg(o,at),_e=Xh(a,o,_e,tt,lt,at),tt=bi(),a!==null&&!Ug?(o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~at,$i(a,o,at)):(I$1&&tt&&vg(o),o.flags|=1,Yi(a,o,_e,at),o.child)}function ij(a,o,_e,tt,at){if(Zf(_e)){var lt=!0;cg(o)}else lt=!1;if(Tg(o,at),o.stateNode===null)jj(a,o),ph(o,_e,tt),rh(o,_e,tt,at),tt=!0;else if(a===null){var it=o.stateNode,ut=o.memoizedProps;it.props=ut;var s=it.context,et=_e.contextType;typeof et=="object"&&et!==null?et=Vg(et):(et=Zf(_e)?Xf:H$1.current,et=Yf(o,et));var ot=_e.getDerivedStateFromProps,st=typeof ot=="function"||typeof it.getSnapshotBeforeUpdate=="function";st||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(ut!==tt||s!==et)&&qh(o,it,tt,et),$g=!1;var Rt=o.memoizedState;it.state=Rt,gh(o,tt,it,at),s=o.memoizedState,ut!==tt||Rt!==s||Wf.current||$g?(typeof ot=="function"&&(kh(o,_e,ot,tt),s=o.memoizedState),(ut=$g||oh(o,_e,ut,tt,Rt,s,et))?(st||typeof it.UNSAFE_componentWillMount!="function"&&typeof it.componentWillMount!="function"||(typeof it.componentWillMount=="function"&&it.componentWillMount(),typeof it.UNSAFE_componentWillMount=="function"&&it.UNSAFE_componentWillMount()),typeof it.componentDidMount=="function"&&(o.flags|=4194308)):(typeof it.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=tt,o.memoizedState=s),it.props=tt,it.state=s,it.context=et,tt=ut):(typeof it.componentDidMount=="function"&&(o.flags|=4194308),tt=!1)}else{it=o.stateNode,bh(a,o),ut=o.memoizedProps,et=o.type===o.elementType?ut:Lg(o.type,ut),it.props=et,st=o.pendingProps,Rt=it.context,s=_e.contextType,typeof s=="object"&&s!==null?s=Vg(s):(s=Zf(_e)?Xf:H$1.current,s=Yf(o,s));var ht=_e.getDerivedStateFromProps;(ot=typeof ht=="function"||typeof it.getSnapshotBeforeUpdate=="function")||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(ut!==st||Rt!==s)&&qh(o,it,tt,s),$g=!1,Rt=o.memoizedState,it.state=Rt,gh(o,tt,it,at);var bt=o.memoizedState;ut!==st||Rt!==bt||Wf.current||$g?(typeof ht=="function"&&(kh(o,_e,ht,tt),bt=o.memoizedState),(et=$g||oh(o,_e,et,tt,Rt,bt,s)||!1)?(ot||typeof it.UNSAFE_componentWillUpdate!="function"&&typeof it.componentWillUpdate!="function"||(typeof it.componentWillUpdate=="function"&&it.componentWillUpdate(tt,bt,s),typeof it.UNSAFE_componentWillUpdate=="function"&&it.UNSAFE_componentWillUpdate(tt,bt,s)),typeof it.componentDidUpdate=="function"&&(o.flags|=4),typeof it.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof it.componentDidUpdate!="function"||ut===a.memoizedProps&&Rt===a.memoizedState||(o.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||ut===a.memoizedProps&&Rt===a.memoizedState||(o.flags|=1024),o.memoizedProps=tt,o.memoizedState=bt),it.props=tt,it.state=bt,it.context=s,tt=et):(typeof it.componentDidUpdate!="function"||ut===a.memoizedProps&&Rt===a.memoizedState||(o.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||ut===a.memoizedProps&&Rt===a.memoizedState||(o.flags|=1024),tt=!1)}return kj(a,o,_e,tt,lt,at)}function kj(a,o,_e,tt,at,lt){hj(a,o);var it=(o.flags&128)!==0;if(!tt&&!it)return at&&dg(o,_e,!1),$i(a,o,lt);tt=o.stateNode,Xi.current=o;var ut=it&&typeof _e.getDerivedStateFromError!="function"?null:tt.render();return o.flags|=1,a!==null&&it?(o.child=Bh(o,a.child,null,lt),o.child=Bh(o,null,ut,lt)):Yi(a,o,ut,lt),o.memoizedState=tt.state,at&&dg(o,_e,!0),o.child}function lj(a){var o=a.stateNode;o.pendingContext?ag(a,o.pendingContext,o.pendingContext!==o.context):o.context&&ag(a,o.context,!1),Ih(a,o.containerInfo)}function mj(a,o,_e,tt,at){return Ig(),Jg(at),o.flags|=256,Yi(a,o,_e,tt),o.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(a){return{baseLanes:a,cachePool:null,transitions:null}}function pj(a,o,_e){var tt=o.pendingProps,at=M$1.current,lt=!1,it=(o.flags&128)!==0,ut;if((ut=it)||(ut=a!==null&&a.memoizedState===null?!1:(at&2)!==0),ut?(lt=!0,o.flags&=-129):(a===null||a.memoizedState!==null)&&(at|=1),G(M$1,at&1),a===null)return Eg(o),a=o.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(o.mode&1?a.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(it=tt.children,a=tt.fallback,lt?(tt=o.mode,lt=o.child,it={mode:"hidden",children:it},!(tt&1)&&lt!==null?(lt.childLanes=0,lt.pendingProps=it):lt=qj(it,tt,0,null),a=Ah(a,tt,_e,null),lt.return=o,a.return=o,lt.sibling=a,o.child=lt,o.child.memoizedState=oj(_e),o.memoizedState=nj,a):rj(o,it));if(at=a.memoizedState,at!==null&&(ut=at.dehydrated,ut!==null))return sj(a,o,it,tt,ut,at,_e);if(lt){lt=tt.fallback,it=o.mode,at=a.child,ut=at.sibling;var s={mode:"hidden",children:tt.children};return!(it&1)&&o.child!==at?(tt=o.child,tt.childLanes=0,tt.pendingProps=s,o.deletions=null):(tt=wh(at,s),tt.subtreeFlags=at.subtreeFlags&14680064),ut!==null?lt=wh(ut,lt):(lt=Ah(lt,it,_e,null),lt.flags|=2),lt.return=o,tt.return=o,tt.sibling=lt,o.child=tt,tt=lt,lt=o.child,it=a.child.memoizedState,it=it===null?oj(_e):{baseLanes:it.baseLanes|_e,cachePool:null,transitions:it.transitions},lt.memoizedState=it,lt.childLanes=a.childLanes&~_e,o.memoizedState=nj,tt}return lt=a.child,a=lt.sibling,tt=wh(lt,{mode:"visible",children:tt.children}),!(o.mode&1)&&(tt.lanes=_e),tt.return=o,tt.sibling=null,a!==null&&(_e=o.deletions,_e===null?(o.deletions=[a],o.flags|=16):_e.push(a)),o.child=tt,o.memoizedState=null,tt}function rj(a,o){return o=qj({mode:"visible",children:o},a.mode,0,null),o.return=a,a.child=o}function tj(a,o,_e,tt){return tt!==null&&Jg(tt),Bh(o,a.child,null,_e),a=rj(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function sj(a,o,_e,tt,at,lt,it){if(_e)return o.flags&256?(o.flags&=-257,tt=Li(Error(p$2(422))),tj(a,o,it,tt)):o.memoizedState!==null?(o.child=a.child,o.flags|=128,null):(lt=tt.fallback,at=o.mode,tt=qj({mode:"visible",children:tt.children},at,0,null),lt=Ah(lt,at,it,null),lt.flags|=2,tt.return=o,lt.return=o,tt.sibling=lt,o.child=tt,o.mode&1&&Bh(o,a.child,null,it),o.child.memoizedState=oj(it),o.memoizedState=nj,lt);if(!(o.mode&1))return tj(a,o,it,null);if(at.data==="$!"){if(tt=at.nextSibling&&at.nextSibling.dataset,tt)var ut=tt.dgst;return tt=ut,lt=Error(p$2(419)),tt=Li(lt,tt,void 0),tj(a,o,it,tt)}if(ut=(it&a.childLanes)!==0,Ug||ut){if(tt=R$1,tt!==null){switch(it&-it){case 4:at=2;break;case 16:at=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:at=32;break;case 536870912:at=268435456;break;default:at=0}at=at&(tt.suspendedLanes|it)?0:at,at!==0&&at!==lt.retryLane&&(lt.retryLane=at,Zg(a,at),mh(tt,a,at,-1))}return uj(),tt=Li(Error(p$2(421))),tj(a,o,it,tt)}return at.data==="$?"?(o.flags|=128,o.child=a.child,o=vj.bind(null,a),at._reactRetry=o,null):(a=lt.treeContext,yg=Lf(at.nextSibling),xg=o,I$1=!0,zg=null,a!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=a.id,sg=a.overflow,qg=o),o=rj(o,tt.children),o.flags|=4096,o)}function wj(a,o,_e){a.lanes|=o;var tt=a.alternate;tt!==null&&(tt.lanes|=o),Sg(a.return,o,_e)}function xj(a,o,_e,tt,at){var lt=a.memoizedState;lt===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:tt,tail:_e,tailMode:at}:(lt.isBackwards=o,lt.rendering=null,lt.renderingStartTime=0,lt.last=tt,lt.tail=_e,lt.tailMode=at)}function yj(a,o,_e){var tt=o.pendingProps,at=tt.revealOrder,lt=tt.tail;if(Yi(a,o,tt.children,_e),tt=M$1.current,tt&2)tt=tt&1|2,o.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&wj(a,_e,o);else if(a.tag===19)wj(a,_e,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}tt&=1}if(G(M$1,tt),!(o.mode&1))o.memoizedState=null;else switch(at){case"forwards":for(_e=o.child,at=null;_e!==null;)a=_e.alternate,a!==null&&Mh(a)===null&&(at=_e),_e=_e.sibling;_e=at,_e===null?(at=o.child,o.child=null):(at=_e.sibling,_e.sibling=null),xj(o,!1,at,_e,lt);break;case"backwards":for(_e=null,at=o.child,o.child=null;at!==null;){if(a=at.alternate,a!==null&&Mh(a)===null){o.child=at;break}a=at.sibling,at.sibling=_e,_e=at,at=a}xj(o,!0,_e,null,lt);break;case"together":xj(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function jj(a,o){!(o.mode&1)&&a!==null&&(a.alternate=null,o.alternate=null,o.flags|=2)}function $i(a,o,_e){if(a!==null&&(o.dependencies=a.dependencies),hh|=o.lanes,!(_e&o.childLanes))return null;if(a!==null&&o.child!==a.child)throw Error(p$2(153));if(o.child!==null){for(a=o.child,_e=wh(a,a.pendingProps),o.child=_e,_e.return=o;a.sibling!==null;)a=a.sibling,_e=_e.sibling=wh(a,a.pendingProps),_e.return=o;_e.sibling=null}return o.child}function zj(a,o,_e){switch(o.tag){case 3:lj(o),Ig();break;case 5:Kh(o);break;case 1:Zf(o.type)&&cg(o);break;case 4:Ih(o,o.stateNode.containerInfo);break;case 10:var tt=o.type._context,at=o.memoizedProps.value;G(Mg,tt._currentValue),tt._currentValue=at;break;case 13:if(tt=o.memoizedState,tt!==null)return tt.dehydrated!==null?(G(M$1,M$1.current&1),o.flags|=128,null):_e&o.child.childLanes?pj(a,o,_e):(G(M$1,M$1.current&1),a=$i(a,o,_e),a!==null?a.sibling:null);G(M$1,M$1.current&1);break;case 19:if(tt=(_e&o.childLanes)!==0,a.flags&128){if(tt)return yj(a,o,_e);o.flags|=128}if(at=o.memoizedState,at!==null&&(at.rendering=null,at.tail=null,at.lastEffect=null),G(M$1,M$1.current),tt)break;return null;case 22:case 23:return o.lanes=0,ej(a,o,_e)}return $i(a,o,_e)}var Aj,Bj,Cj,Dj;Aj=function(a,o){for(var _e=o.child;_e!==null;){if(_e.tag===5||_e.tag===6)a.appendChild(_e.stateNode);else if(_e.tag!==4&&_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===o)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===o)return;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}};Bj=function(){};Cj=function(a,o,_e,tt){var at=a.memoizedProps;if(at!==tt){a=o.stateNode,Hh(Eh.current);var lt=null;switch(_e){case"input":at=Ya(a,at),tt=Ya(a,tt),lt=[];break;case"select":at=A$2({},at,{value:void 0}),tt=A$2({},tt,{value:void 0}),lt=[];break;case"textarea":at=gb(a,at),tt=gb(a,tt),lt=[];break;default:typeof at.onClick!="function"&&typeof tt.onClick=="function"&&(a.onclick=Bf)}ub(_e,tt);var it;_e=null;for(et in at)if(!tt.hasOwnProperty(et)&&at.hasOwnProperty(et)&&at[et]!=null)if(et==="style"){var ut=at[et];for(it in ut)ut.hasOwnProperty(it)&&(_e||(_e={}),_e[it]="")}else et!=="dangerouslySetInnerHTML"&&et!=="children"&&et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&et!=="autoFocus"&&(ea.hasOwnProperty(et)?lt||(lt=[]):(lt=lt||[]).push(et,null));for(et in tt){var s=tt[et];if(ut=at!=null?at[et]:void 0,tt.hasOwnProperty(et)&&s!==ut&&(s!=null||ut!=null))if(et==="style")if(ut){for(it in ut)!ut.hasOwnProperty(it)||s&&s.hasOwnProperty(it)||(_e||(_e={}),_e[it]="");for(it in s)s.hasOwnProperty(it)&&ut[it]!==s[it]&&(_e||(_e={}),_e[it]=s[it])}else _e||(lt||(lt=[]),lt.push(et,_e)),_e=s;else et==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,ut=ut?ut.__html:void 0,s!=null&&ut!==s&&(lt=lt||[]).push(et,s)):et==="children"?typeof s!="string"&&typeof s!="number"||(lt=lt||[]).push(et,""+s):et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&(ea.hasOwnProperty(et)?(s!=null&&et==="onScroll"&&D$1("scroll",a),lt||ut===s||(lt=[])):(lt=lt||[]).push(et,s))}_e&&(lt=lt||[]).push("style",_e);var et=lt;(o.updateQueue=et)&&(o.flags|=4)}};Dj=function(a,o,_e,tt){_e!==tt&&(o.flags|=4)};function Ej(a,o){if(!I$1)switch(a.tailMode){case"hidden":o=a.tail;for(var _e=null;o!==null;)o.alternate!==null&&(_e=o),o=o.sibling;_e===null?a.tail=null:_e.sibling=null;break;case"collapsed":_e=a.tail;for(var tt=null;_e!==null;)_e.alternate!==null&&(tt=_e),_e=_e.sibling;tt===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:tt.sibling=null}}function S$1(a){var o=a.alternate!==null&&a.alternate.child===a.child,_e=0,tt=0;if(o)for(var at=a.child;at!==null;)_e|=at.lanes|at.childLanes,tt|=at.subtreeFlags&14680064,tt|=at.flags&14680064,at.return=a,at=at.sibling;else for(at=a.child;at!==null;)_e|=at.lanes|at.childLanes,tt|=at.subtreeFlags,tt|=at.flags,at.return=a,at=at.sibling;return a.subtreeFlags|=tt,a.childLanes=_e,o}function Fj(a,o,_e){var tt=o.pendingProps;switch(wg(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(o),null;case 1:return Zf(o.type)&&$f(),S$1(o),null;case 3:return tt=o.stateNode,Jh(),E(Wf),E(H$1),Oh(),tt.pendingContext&&(tt.context=tt.pendingContext,tt.pendingContext=null),(a===null||a.child===null)&&(Gg(o)?o.flags|=4:a===null||a.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(a,o),S$1(o),null;case 5:Lh(o);var at=Hh(Gh.current);if(_e=o.type,a!==null&&o.stateNode!=null)Cj(a,o,_e,tt,at),a.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!tt){if(o.stateNode===null)throw Error(p$2(166));return S$1(o),null}if(a=Hh(Eh.current),Gg(o)){tt=o.stateNode,_e=o.type;var lt=o.memoizedProps;switch(tt[Of]=o,tt[Pf]=lt,a=(o.mode&1)!==0,_e){case"dialog":D$1("cancel",tt),D$1("close",tt);break;case"iframe":case"object":case"embed":D$1("load",tt);break;case"video":case"audio":for(at=0;at<lf.length;at++)D$1(lf[at],tt);break;case"source":D$1("error",tt);break;case"img":case"image":case"link":D$1("error",tt),D$1("load",tt);break;case"details":D$1("toggle",tt);break;case"input":Za(tt,lt),D$1("invalid",tt);break;case"select":tt._wrapperState={wasMultiple:!!lt.multiple},D$1("invalid",tt);break;case"textarea":hb(tt,lt),D$1("invalid",tt)}ub(_e,lt),at=null;for(var it in lt)if(lt.hasOwnProperty(it)){var ut=lt[it];it==="children"?typeof ut=="string"?tt.textContent!==ut&&(lt.suppressHydrationWarning!==!0&&Af(tt.textContent,ut,a),at=["children",ut]):typeof ut=="number"&&tt.textContent!==""+ut&&(lt.suppressHydrationWarning!==!0&&Af(tt.textContent,ut,a),at=["children",""+ut]):ea.hasOwnProperty(it)&&ut!=null&&it==="onScroll"&&D$1("scroll",tt)}switch(_e){case"input":Va(tt),db(tt,lt,!0);break;case"textarea":Va(tt),jb(tt);break;case"select":case"option":break;default:typeof lt.onClick=="function"&&(tt.onclick=Bf)}tt=at,o.updateQueue=tt,tt!==null&&(o.flags|=4)}else{it=at.nodeType===9?at:at.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=kb(_e)),a==="http://www.w3.org/1999/xhtml"?_e==="script"?(a=it.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof tt.is=="string"?a=it.createElement(_e,{is:tt.is}):(a=it.createElement(_e),_e==="select"&&(it=a,tt.multiple?it.multiple=!0:tt.size&&(it.size=tt.size))):a=it.createElementNS(a,_e),a[Of]=o,a[Pf]=tt,Aj(a,o,!1,!1),o.stateNode=a;e:{switch(it=vb(_e,tt),_e){case"dialog":D$1("cancel",a),D$1("close",a),at=tt;break;case"iframe":case"object":case"embed":D$1("load",a),at=tt;break;case"video":case"audio":for(at=0;at<lf.length;at++)D$1(lf[at],a);at=tt;break;case"source":D$1("error",a),at=tt;break;case"img":case"image":case"link":D$1("error",a),D$1("load",a),at=tt;break;case"details":D$1("toggle",a),at=tt;break;case"input":Za(a,tt),at=Ya(a,tt),D$1("invalid",a);break;case"option":at=tt;break;case"select":a._wrapperState={wasMultiple:!!tt.multiple},at=A$2({},tt,{value:void 0}),D$1("invalid",a);break;case"textarea":hb(a,tt),at=gb(a,tt),D$1("invalid",a);break;default:at=tt}ub(_e,at),ut=at;for(lt in ut)if(ut.hasOwnProperty(lt)){var s=ut[lt];lt==="style"?sb(a,s):lt==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,s!=null&&nb(a,s)):lt==="children"?typeof s=="string"?(_e!=="textarea"||s!=="")&&ob(a,s):typeof s=="number"&&ob(a,""+s):lt!=="suppressContentEditableWarning"&&lt!=="suppressHydrationWarning"&&lt!=="autoFocus"&&(ea.hasOwnProperty(lt)?s!=null&&lt==="onScroll"&&D$1("scroll",a):s!=null&&ta(a,lt,s,it))}switch(_e){case"input":Va(a),db(a,tt,!1);break;case"textarea":Va(a),jb(a);break;case"option":tt.value!=null&&a.setAttribute("value",""+Sa(tt.value));break;case"select":a.multiple=!!tt.multiple,lt=tt.value,lt!=null?fb(a,!!tt.multiple,lt,!1):tt.defaultValue!=null&&fb(a,!!tt.multiple,tt.defaultValue,!0);break;default:typeof at.onClick=="function"&&(a.onclick=Bf)}switch(_e){case"button":case"input":case"select":case"textarea":tt=!!tt.autoFocus;break e;case"img":tt=!0;break e;default:tt=!1}}tt&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return S$1(o),null;case 6:if(a&&o.stateNode!=null)Dj(a,o,a.memoizedProps,tt);else{if(typeof tt!="string"&&o.stateNode===null)throw Error(p$2(166));if(_e=Hh(Gh.current),Hh(Eh.current),Gg(o)){if(tt=o.stateNode,_e=o.memoizedProps,tt[Of]=o,(lt=tt.nodeValue!==_e)&&(a=xg,a!==null))switch(a.tag){case 3:Af(tt.nodeValue,_e,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Af(tt.nodeValue,_e,(a.mode&1)!==0)}lt&&(o.flags|=4)}else tt=(_e.nodeType===9?_e:_e.ownerDocument).createTextNode(tt),tt[Of]=o,o.stateNode=tt}return S$1(o),null;case 13:if(E(M$1),tt=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&o.mode&1&&!(o.flags&128))Hg(),Ig(),o.flags|=98560,lt=!1;else if(lt=Gg(o),tt!==null&&tt.dehydrated!==null){if(a===null){if(!lt)throw Error(p$2(318));if(lt=o.memoizedState,lt=lt!==null?lt.dehydrated:null,!lt)throw Error(p$2(317));lt[Of]=o}else Ig(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;S$1(o),lt=!1}else zg!==null&&(Gj(zg),zg=null),lt=!0;if(!lt)return o.flags&65536?o:null}return o.flags&128?(o.lanes=_e,o):(tt=tt!==null,tt!==(a!==null&&a.memoizedState!==null)&&tt&&(o.child.flags|=8192,o.mode&1&&(a===null||M$1.current&1?T===0&&(T=3):uj())),o.updateQueue!==null&&(o.flags|=4),S$1(o),null);case 4:return Jh(),Bj(a,o),a===null&&sf(o.stateNode.containerInfo),S$1(o),null;case 10:return Rg(o.type._context),S$1(o),null;case 17:return Zf(o.type)&&$f(),S$1(o),null;case 19:if(E(M$1),lt=o.memoizedState,lt===null)return S$1(o),null;if(tt=(o.flags&128)!==0,it=lt.rendering,it===null)if(tt)Ej(lt,!1);else{if(T!==0||a!==null&&a.flags&128)for(a=o.child;a!==null;){if(it=Mh(a),it!==null){for(o.flags|=128,Ej(lt,!1),tt=it.updateQueue,tt!==null&&(o.updateQueue=tt,o.flags|=4),o.subtreeFlags=0,tt=_e,_e=o.child;_e!==null;)lt=_e,a=tt,lt.flags&=14680066,it=lt.alternate,it===null?(lt.childLanes=0,lt.lanes=a,lt.child=null,lt.subtreeFlags=0,lt.memoizedProps=null,lt.memoizedState=null,lt.updateQueue=null,lt.dependencies=null,lt.stateNode=null):(lt.childLanes=it.childLanes,lt.lanes=it.lanes,lt.child=it.child,lt.subtreeFlags=0,lt.deletions=null,lt.memoizedProps=it.memoizedProps,lt.memoizedState=it.memoizedState,lt.updateQueue=it.updateQueue,lt.type=it.type,a=it.dependencies,lt.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),_e=_e.sibling;return G(M$1,M$1.current&1|2),o.child}a=a.sibling}lt.tail!==null&&B()>Hj&&(o.flags|=128,tt=!0,Ej(lt,!1),o.lanes=4194304)}else{if(!tt)if(a=Mh(it),a!==null){if(o.flags|=128,tt=!0,_e=a.updateQueue,_e!==null&&(o.updateQueue=_e,o.flags|=4),Ej(lt,!0),lt.tail===null&&lt.tailMode==="hidden"&&!it.alternate&&!I$1)return S$1(o),null}else 2*B()-lt.renderingStartTime>Hj&&_e!==1073741824&&(o.flags|=128,tt=!0,Ej(lt,!1),o.lanes=4194304);lt.isBackwards?(it.sibling=o.child,o.child=it):(_e=lt.last,_e!==null?_e.sibling=it:o.child=it,lt.last=it)}return lt.tail!==null?(o=lt.tail,lt.rendering=o,lt.tail=o.sibling,lt.renderingStartTime=B(),o.sibling=null,_e=M$1.current,G(M$1,tt?_e&1|2:_e&1),o):(S$1(o),null);case 22:case 23:return Ij(),tt=o.memoizedState!==null,a!==null&&a.memoizedState!==null!==tt&&(o.flags|=8192),tt&&o.mode&1?gj&1073741824&&(S$1(o),o.subtreeFlags&6&&(o.flags|=8192)):S$1(o),null;case 24:return null;case 25:return null}throw Error(p$2(156,o.tag))}function Jj(a,o){switch(wg(o),o.tag){case 1:return Zf(o.type)&&$f(),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return Jh(),E(Wf),E(H$1),Oh(),a=o.flags,a&65536&&!(a&128)?(o.flags=a&-65537|128,o):null;case 5:return Lh(o),null;case 13:if(E(M$1),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(p$2(340));Ig()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return E(M$1),null;case 4:return Jh(),null;case 10:return Rg(o.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U$1=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Mj(a,o){var _e=a.ref;if(_e!==null)if(typeof _e=="function")try{_e(null)}catch(tt){W$1(a,o,tt)}else _e.current=null}function Nj(a,o,_e){try{_e()}catch(tt){W$1(a,o,tt)}}var Oj=!1;function Pj(a,o){if(Cf=dd,a=Me(),Ne(a)){if("selectionStart"in a)var _e={start:a.selectionStart,end:a.selectionEnd};else e:{_e=(_e=a.ownerDocument)&&_e.defaultView||window;var tt=_e.getSelection&&_e.getSelection();if(tt&&tt.rangeCount!==0){_e=tt.anchorNode;var at=tt.anchorOffset,lt=tt.focusNode;tt=tt.focusOffset;try{_e.nodeType,lt.nodeType}catch{_e=null;break e}var it=0,ut=-1,s=-1,et=0,ot=0,st=a,Rt=null;t:for(;;){for(var ht;st!==_e||at!==0&&st.nodeType!==3||(ut=it+at),st!==lt||tt!==0&&st.nodeType!==3||(s=it+tt),st.nodeType===3&&(it+=st.nodeValue.length),(ht=st.firstChild)!==null;)Rt=st,st=ht;for(;;){if(st===a)break t;if(Rt===_e&&++et===at&&(ut=it),Rt===lt&&++ot===tt&&(s=it),(ht=st.nextSibling)!==null)break;st=Rt,Rt=st.parentNode}st=ht}_e=ut===-1||s===-1?null:{start:ut,end:s}}else _e=null}_e=_e||{start:0,end:0}}else _e=null;for(Df={focusedElem:a,selectionRange:_e},dd=!1,V=o;V!==null;)if(o=V,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,V=a;else for(;V!==null;){o=V;try{var bt=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(bt!==null){var ct=bt.memoizedProps,mt=bt.memoizedState,rt=o.stateNode,pt=rt.getSnapshotBeforeUpdate(o.elementType===o.type?ct:Lg(o.type,ct),mt);rt.__reactInternalSnapshotBeforeUpdate=pt}break;case 3:var ft=o.stateNode.containerInfo;ft.nodeType===1?ft.textContent="":ft.nodeType===9&&ft.documentElement&&ft.removeChild(ft.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$2(163))}}catch(St){W$1(o,o.return,St)}if(a=o.sibling,a!==null){a.return=o.return,V=a;break}V=o.return}return bt=Oj,Oj=!1,bt}function Qj(a,o,_e){var tt=o.updateQueue;if(tt=tt!==null?tt.lastEffect:null,tt!==null){var at=tt=tt.next;do{if((at.tag&a)===a){var lt=at.destroy;at.destroy=void 0,lt!==void 0&&Nj(o,_e,lt)}at=at.next}while(at!==tt)}}function Rj(a,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var _e=o=o.next;do{if((_e.tag&a)===a){var tt=_e.create;_e.destroy=tt()}_e=_e.next}while(_e!==o)}}function Sj(a){var o=a.ref;if(o!==null){var _e=a.stateNode;switch(a.tag){case 5:a=_e;break;default:a=_e}typeof o=="function"?o(a):o.current=a}}function Tj(a){var o=a.alternate;o!==null&&(a.alternate=null,Tj(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&(delete o[Of],delete o[Pf],delete o[of],delete o[Qf],delete o[Rf])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Uj(a){return a.tag===5||a.tag===3||a.tag===4}function Vj(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Uj(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Wj(a,o,_e){var tt=a.tag;if(tt===5||tt===6)a=a.stateNode,o?_e.nodeType===8?_e.parentNode.insertBefore(a,o):_e.insertBefore(a,o):(_e.nodeType===8?(o=_e.parentNode,o.insertBefore(a,_e)):(o=_e,o.appendChild(a)),_e=_e._reactRootContainer,_e!=null||o.onclick!==null||(o.onclick=Bf));else if(tt!==4&&(a=a.child,a!==null))for(Wj(a,o,_e),a=a.sibling;a!==null;)Wj(a,o,_e),a=a.sibling}function Xj(a,o,_e){var tt=a.tag;if(tt===5||tt===6)a=a.stateNode,o?_e.insertBefore(a,o):_e.appendChild(a);else if(tt!==4&&(a=a.child,a!==null))for(Xj(a,o,_e),a=a.sibling;a!==null;)Xj(a,o,_e),a=a.sibling}var X$1=null,Yj=!1;function Zj(a,o,_e){for(_e=_e.child;_e!==null;)ak(a,o,_e),_e=_e.sibling}function ak(a,o,_e){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,_e)}catch{}switch(_e.tag){case 5:U$1||Mj(_e,o);case 6:var tt=X$1,at=Yj;X$1=null,Zj(a,o,_e),X$1=tt,Yj=at,X$1!==null&&(Yj?(a=X$1,_e=_e.stateNode,a.nodeType===8?a.parentNode.removeChild(_e):a.removeChild(_e)):X$1.removeChild(_e.stateNode));break;case 18:X$1!==null&&(Yj?(a=X$1,_e=_e.stateNode,a.nodeType===8?Kf(a.parentNode,_e):a.nodeType===1&&Kf(a,_e),bd(a)):Kf(X$1,_e.stateNode));break;case 4:tt=X$1,at=Yj,X$1=_e.stateNode.containerInfo,Yj=!0,Zj(a,o,_e),X$1=tt,Yj=at;break;case 0:case 11:case 14:case 15:if(!U$1&&(tt=_e.updateQueue,tt!==null&&(tt=tt.lastEffect,tt!==null))){at=tt=tt.next;do{var lt=at,it=lt.destroy;lt=lt.tag,it!==void 0&&(lt&2||lt&4)&&Nj(_e,o,it),at=at.next}while(at!==tt)}Zj(a,o,_e);break;case 1:if(!U$1&&(Mj(_e,o),tt=_e.stateNode,typeof tt.componentWillUnmount=="function"))try{tt.props=_e.memoizedProps,tt.state=_e.memoizedState,tt.componentWillUnmount()}catch(ut){W$1(_e,o,ut)}Zj(a,o,_e);break;case 21:Zj(a,o,_e);break;case 22:_e.mode&1?(U$1=(tt=U$1)||_e.memoizedState!==null,Zj(a,o,_e),U$1=tt):Zj(a,o,_e);break;default:Zj(a,o,_e)}}function bk(a){var o=a.updateQueue;if(o!==null){a.updateQueue=null;var _e=a.stateNode;_e===null&&(_e=a.stateNode=new Lj),o.forEach(function(tt){var at=ck.bind(null,a,tt);_e.has(tt)||(_e.add(tt),tt.then(at,at))})}}function dk(a,o){var _e=o.deletions;if(_e!==null)for(var tt=0;tt<_e.length;tt++){var at=_e[tt];try{var lt=a,it=o,ut=it;e:for(;ut!==null;){switch(ut.tag){case 5:X$1=ut.stateNode,Yj=!1;break e;case 3:X$1=ut.stateNode.containerInfo,Yj=!0;break e;case 4:X$1=ut.stateNode.containerInfo,Yj=!0;break e}ut=ut.return}if(X$1===null)throw Error(p$2(160));ak(lt,it,at),X$1=null,Yj=!1;var s=at.alternate;s!==null&&(s.return=null),at.return=null}catch(et){W$1(at,o,et)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)ek(o,a),o=o.sibling}function ek(a,o){var _e=a.alternate,tt=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(dk(o,a),fk(a),tt&4){try{Qj(3,a,a.return),Rj(3,a)}catch(ct){W$1(a,a.return,ct)}try{Qj(5,a,a.return)}catch(ct){W$1(a,a.return,ct)}}break;case 1:dk(o,a),fk(a),tt&512&&_e!==null&&Mj(_e,_e.return);break;case 5:if(dk(o,a),fk(a),tt&512&&_e!==null&&Mj(_e,_e.return),a.flags&32){var at=a.stateNode;try{ob(at,"")}catch(ct){W$1(a,a.return,ct)}}if(tt&4&&(at=a.stateNode,at!=null)){var lt=a.memoizedProps,it=_e!==null?_e.memoizedProps:lt,ut=a.type,s=a.updateQueue;if(a.updateQueue=null,s!==null)try{ut==="input"&&lt.type==="radio"&&lt.name!=null&&ab(at,lt),vb(ut,it);var et=vb(ut,lt);for(it=0;it<s.length;it+=2){var ot=s[it],st=s[it+1];ot==="style"?sb(at,st):ot==="dangerouslySetInnerHTML"?nb(at,st):ot==="children"?ob(at,st):ta(at,ot,st,et)}switch(ut){case"input":bb(at,lt);break;case"textarea":ib(at,lt);break;case"select":var Rt=at._wrapperState.wasMultiple;at._wrapperState.wasMultiple=!!lt.multiple;var ht=lt.value;ht!=null?fb(at,!!lt.multiple,ht,!1):Rt!==!!lt.multiple&&(lt.defaultValue!=null?fb(at,!!lt.multiple,lt.defaultValue,!0):fb(at,!!lt.multiple,lt.multiple?[]:"",!1))}at[Pf]=lt}catch(ct){W$1(a,a.return,ct)}}break;case 6:if(dk(o,a),fk(a),tt&4){if(a.stateNode===null)throw Error(p$2(162));at=a.stateNode,lt=a.memoizedProps;try{at.nodeValue=lt}catch(ct){W$1(a,a.return,ct)}}break;case 3:if(dk(o,a),fk(a),tt&4&&_e!==null&&_e.memoizedState.isDehydrated)try{bd(o.containerInfo)}catch(ct){W$1(a,a.return,ct)}break;case 4:dk(o,a),fk(a);break;case 13:dk(o,a),fk(a),at=a.child,at.flags&8192&&(lt=at.memoizedState!==null,at.stateNode.isHidden=lt,!lt||at.alternate!==null&&at.alternate.memoizedState!==null||(gk=B())),tt&4&&bk(a);break;case 22:if(ot=_e!==null&&_e.memoizedState!==null,a.mode&1?(U$1=(et=U$1)||ot,dk(o,a),U$1=et):dk(o,a),fk(a),tt&8192){if(et=a.memoizedState!==null,(a.stateNode.isHidden=et)&&!ot&&a.mode&1)for(V=a,ot=a.child;ot!==null;){for(st=V=ot;V!==null;){switch(Rt=V,ht=Rt.child,Rt.tag){case 0:case 11:case 14:case 15:Qj(4,Rt,Rt.return);break;case 1:Mj(Rt,Rt.return);var bt=Rt.stateNode;if(typeof bt.componentWillUnmount=="function"){tt=Rt,_e=Rt.return;try{o=tt,bt.props=o.memoizedProps,bt.state=o.memoizedState,bt.componentWillUnmount()}catch(ct){W$1(tt,_e,ct)}}break;case 5:Mj(Rt,Rt.return);break;case 22:if(Rt.memoizedState!==null){hk(st);continue}}ht!==null?(ht.return=Rt,V=ht):hk(st)}ot=ot.sibling}e:for(ot=null,st=a;;){if(st.tag===5){if(ot===null){ot=st;try{at=st.stateNode,et?(lt=at.style,typeof lt.setProperty=="function"?lt.setProperty("display","none","important"):lt.display="none"):(ut=st.stateNode,s=st.memoizedProps.style,it=s!=null&&s.hasOwnProperty("display")?s.display:null,ut.style.display=rb("display",it))}catch(ct){W$1(a,a.return,ct)}}}else if(st.tag===6){if(ot===null)try{st.stateNode.nodeValue=et?"":st.memoizedProps}catch(ct){W$1(a,a.return,ct)}}else if((st.tag!==22&&st.tag!==23||st.memoizedState===null||st===a)&&st.child!==null){st.child.return=st,st=st.child;continue}if(st===a)break e;for(;st.sibling===null;){if(st.return===null||st.return===a)break e;ot===st&&(ot=null),st=st.return}ot===st&&(ot=null),st.sibling.return=st.return,st=st.sibling}}break;case 19:dk(o,a),fk(a),tt&4&&bk(a);break;case 21:break;default:dk(o,a),fk(a)}}function fk(a){var o=a.flags;if(o&2){try{e:{for(var _e=a.return;_e!==null;){if(Uj(_e)){var tt=_e;break e}_e=_e.return}throw Error(p$2(160))}switch(tt.tag){case 5:var at=tt.stateNode;tt.flags&32&&(ob(at,""),tt.flags&=-33);var lt=Vj(a);Xj(a,lt,at);break;case 3:case 4:var it=tt.stateNode.containerInfo,ut=Vj(a);Wj(a,ut,it);break;default:throw Error(p$2(161))}}catch(s){W$1(a,a.return,s)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function ik(a,o,_e){V=a,jk(a)}function jk(a,o,_e){for(var tt=(a.mode&1)!==0;V!==null;){var at=V,lt=at.child;if(at.tag===22&&tt){var it=at.memoizedState!==null||Kj;if(!it){var ut=at.alternate,s=ut!==null&&ut.memoizedState!==null||U$1;ut=Kj;var et=U$1;if(Kj=it,(U$1=s)&&!et)for(V=at;V!==null;)it=V,s=it.child,it.tag===22&&it.memoizedState!==null?kk(at):s!==null?(s.return=it,V=s):kk(at);for(;lt!==null;)V=lt,jk(lt),lt=lt.sibling;V=at,Kj=ut,U$1=et}lk(a)}else at.subtreeFlags&8772&&lt!==null?(lt.return=at,V=lt):lk(a)}}function lk(a){for(;V!==null;){var o=V;if(o.flags&8772){var _e=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:U$1||Rj(5,o);break;case 1:var tt=o.stateNode;if(o.flags&4&&!U$1)if(_e===null)tt.componentDidMount();else{var at=o.elementType===o.type?_e.memoizedProps:Lg(o.type,_e.memoizedProps);tt.componentDidUpdate(at,_e.memoizedState,tt.__reactInternalSnapshotBeforeUpdate)}var lt=o.updateQueue;lt!==null&&ih(o,lt,tt);break;case 3:var it=o.updateQueue;if(it!==null){if(_e=null,o.child!==null)switch(o.child.tag){case 5:_e=o.child.stateNode;break;case 1:_e=o.child.stateNode}ih(o,it,_e)}break;case 5:var ut=o.stateNode;if(_e===null&&o.flags&4){_e=ut;var s=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&_e.focus();break;case"img":s.src&&(_e.src=s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var et=o.alternate;if(et!==null){var ot=et.memoizedState;if(ot!==null){var st=ot.dehydrated;st!==null&&bd(st)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$2(163))}U$1||o.flags&512&&Sj(o)}catch(Rt){W$1(o,o.return,Rt)}}if(o===a){V=null;break}if(_e=o.sibling,_e!==null){_e.return=o.return,V=_e;break}V=o.return}}function hk(a){for(;V!==null;){var o=V;if(o===a){V=null;break}var _e=o.sibling;if(_e!==null){_e.return=o.return,V=_e;break}V=o.return}}function kk(a){for(;V!==null;){var o=V;try{switch(o.tag){case 0:case 11:case 15:var _e=o.return;try{Rj(4,o)}catch(s){W$1(o,_e,s)}break;case 1:var tt=o.stateNode;if(typeof tt.componentDidMount=="function"){var at=o.return;try{tt.componentDidMount()}catch(s){W$1(o,at,s)}}var lt=o.return;try{Sj(o)}catch(s){W$1(o,lt,s)}break;case 5:var it=o.return;try{Sj(o)}catch(s){W$1(o,it,s)}}}catch(s){W$1(o,o.return,s)}if(o===a){V=null;break}var ut=o.sibling;if(ut!==null){ut.return=o.return,V=ut;break}V=o.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R$1=null,Y$1=null,Z$1=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K&6?B():Bk!==-1?Bk:Bk=B()}function lh(a){return a.mode&1?K&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(a=C,a!==0||(a=window.event,a=a===void 0?16:jd(a.type)),a):1}function mh(a,o,_e,tt){if(50<zk)throw zk=0,Ak=null,Error(p$2(185));Ac(a,_e,tt),(!(K&2)||a!==R$1)&&(a===R$1&&(!(K&2)&&(rk|=_e),T===4&&Dk(a,Z$1)),Ek(a,tt),_e===1&&K===0&&!(o.mode&1)&&(Hj=B()+500,fg&&jg()))}function Ek(a,o){var _e=a.callbackNode;wc(a,o);var tt=uc(a,a===R$1?Z$1:0);if(tt===0)_e!==null&&bc(_e),a.callbackNode=null,a.callbackPriority=0;else if(o=tt&-tt,a.callbackPriority!==o){if(_e!=null&&bc(_e),o===1)a.tag===0?ig(Fk.bind(null,a)):hg(Fk.bind(null,a)),Jf(function(){!(K&6)&&jg()}),_e=null;else{switch(Dc(tt)){case 1:_e=fc;break;case 4:_e=gc;break;case 16:_e=hc;break;case 536870912:_e=jc;break;default:_e=hc}_e=Gk(_e,Hk.bind(null,a))}a.callbackPriority=o,a.callbackNode=_e}}function Hk(a,o){if(Bk=-1,Ck=0,K&6)throw Error(p$2(327));var _e=a.callbackNode;if(Ik()&&a.callbackNode!==_e)return null;var tt=uc(a,a===R$1?Z$1:0);if(tt===0)return null;if(tt&30||tt&a.expiredLanes||o)o=Jk(a,tt);else{o=tt;var at=K;K|=2;var lt=Kk();(R$1!==a||Z$1!==o)&&(vk=null,Hj=B()+500,Lk(a,o));do try{Mk();break}catch(ut){Nk(a,ut)}while(1);Qg(),nk.current=lt,K=at,Y$1!==null?o=0:(R$1=null,Z$1=0,o=T)}if(o!==0){if(o===2&&(at=xc(a),at!==0&&(tt=at,o=Ok(a,at))),o===1)throw _e=qk,Lk(a,0),Dk(a,tt),Ek(a,B()),_e;if(o===6)Dk(a,tt);else{if(at=a.current.alternate,!(tt&30)&&!Pk(at)&&(o=Jk(a,tt),o===2&&(lt=xc(a),lt!==0&&(tt=lt,o=Ok(a,lt))),o===1))throw _e=qk,Lk(a,0),Dk(a,tt),Ek(a,B()),_e;switch(a.finishedWork=at,a.finishedLanes=tt,o){case 0:case 1:throw Error(p$2(345));case 2:Qk(a,uk,vk);break;case 3:if(Dk(a,tt),(tt&130023424)===tt&&(o=gk+500-B(),10<o)){if(uc(a,0)!==0)break;if(at=a.suspendedLanes,(at&tt)!==tt){L(),a.pingedLanes|=a.suspendedLanes&at;break}a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),o);break}Qk(a,uk,vk);break;case 4:if(Dk(a,tt),(tt&4194240)===tt)break;for(o=a.eventTimes,at=-1;0<tt;){var it=31-oc(tt);lt=1<<it,it=o[it],it>at&&(at=it),tt&=~lt}if(tt=at,tt=B()-tt,tt=(120>tt?120:480>tt?480:1080>tt?1080:1920>tt?1920:3e3>tt?3e3:4320>tt?4320:1960*mk(tt/1960))-tt,10<tt){a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),tt);break}Qk(a,uk,vk);break;case 5:Qk(a,uk,vk);break;default:throw Error(p$2(329))}}}return Ek(a,B()),a.callbackNode===_e?Hk.bind(null,a):null}function Ok(a,o){var _e=tk;return a.current.memoizedState.isDehydrated&&(Lk(a,o).flags|=256),a=Jk(a,o),a!==2&&(o=uk,uk=_e,o!==null&&Gj(o)),a}function Gj(a){uk===null?uk=a:uk.push.apply(uk,a)}function Pk(a){for(var o=a;;){if(o.flags&16384){var _e=o.updateQueue;if(_e!==null&&(_e=_e.stores,_e!==null))for(var tt=0;tt<_e.length;tt++){var at=_e[tt],lt=at.getSnapshot;at=at.value;try{if(!He(lt(),at))return!1}catch{return!1}}}if(_e=o.child,o.subtreeFlags&16384&&_e!==null)_e.return=o,o=_e;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Dk(a,o){for(o&=~sk,o&=~rk,a.suspendedLanes|=o,a.pingedLanes&=~o,a=a.expirationTimes;0<o;){var _e=31-oc(o),tt=1<<_e;a[_e]=-1,o&=~tt}}function Fk(a){if(K&6)throw Error(p$2(327));Ik();var o=uc(a,0);if(!(o&1))return Ek(a,B()),null;var _e=Jk(a,o);if(a.tag!==0&&_e===2){var tt=xc(a);tt!==0&&(o=tt,_e=Ok(a,tt))}if(_e===1)throw _e=qk,Lk(a,0),Dk(a,o),Ek(a,B()),_e;if(_e===6)throw Error(p$2(345));return a.finishedWork=a.current.alternate,a.finishedLanes=o,Qk(a,uk,vk),Ek(a,B()),null}function Rk(a,o){var _e=K;K|=1;try{return a(o)}finally{K=_e,K===0&&(Hj=B()+500,fg&&jg())}}function Sk(a){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var o=K;K|=1;var _e=pk.transition,tt=C;try{if(pk.transition=null,C=1,a)return a()}finally{C=tt,pk.transition=_e,K=o,!(K&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(a,o){a.finishedWork=null,a.finishedLanes=0;var _e=a.timeoutHandle;if(_e!==-1&&(a.timeoutHandle=-1,Gf(_e)),Y$1!==null)for(_e=Y$1.return;_e!==null;){var tt=_e;switch(wg(tt),tt.tag){case 1:tt=tt.type.childContextTypes,tt!=null&&$f();break;case 3:Jh(),E(Wf),E(H$1),Oh();break;case 5:Lh(tt);break;case 4:Jh();break;case 13:E(M$1);break;case 19:E(M$1);break;case 10:Rg(tt.type._context);break;case 22:case 23:Ij()}_e=_e.return}if(R$1=a,Y$1=a=wh(a.current,null),Z$1=gj=o,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(o=0;o<Wg.length;o++)if(_e=Wg[o],tt=_e.interleaved,tt!==null){_e.interleaved=null;var at=tt.next,lt=_e.pending;if(lt!==null){var it=lt.next;lt.next=at,tt.next=it}_e.pending=tt}Wg=null}return a}function Nk(a,o){do{var _e=Y$1;try{if(Qg(),Ph.current=ai,Sh){for(var tt=N$2.memoizedState;tt!==null;){var at=tt.queue;at!==null&&(at.pending=null),tt=tt.next}Sh=!1}if(Rh=0,P=O$2=N$2=null,Th=!1,Uh=0,ok.current=null,_e===null||_e.return===null){T=1,qk=o,Y$1=null;break}e:{var lt=a,it=_e.return,ut=_e,s=o;if(o=Z$1,ut.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){var et=s,ot=ut,st=ot.tag;if(!(ot.mode&1)&&(st===0||st===11||st===15)){var Rt=ot.alternate;Rt?(ot.updateQueue=Rt.updateQueue,ot.memoizedState=Rt.memoizedState,ot.lanes=Rt.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var ht=Vi(it);if(ht!==null){ht.flags&=-257,Wi(ht,it,ut,lt,o),ht.mode&1&&Ti(lt,et,o),o=ht,s=et;var bt=o.updateQueue;if(bt===null){var ct=new Set;ct.add(s),o.updateQueue=ct}else bt.add(s);break e}else{if(!(o&1)){Ti(lt,et,o),uj();break e}s=Error(p$2(426))}}else if(I$1&&ut.mode&1){var mt=Vi(it);if(mt!==null){!(mt.flags&65536)&&(mt.flags|=256),Wi(mt,it,ut,lt,o),Jg(Ki(s,ut));break e}}lt=s=Ki(s,ut),T!==4&&(T=2),tk===null?tk=[lt]:tk.push(lt),lt=it;do{switch(lt.tag){case 3:lt.flags|=65536,o&=-o,lt.lanes|=o;var rt=Oi(lt,s,o);fh(lt,rt);break e;case 1:ut=s;var pt=lt.type,ft=lt.stateNode;if(!(lt.flags&128)&&(typeof pt.getDerivedStateFromError=="function"||ft!==null&&typeof ft.componentDidCatch=="function"&&(Si===null||!Si.has(ft)))){lt.flags|=65536,o&=-o,lt.lanes|=o;var St=Ri(lt,ut,o);fh(lt,St);break e}}lt=lt.return}while(lt!==null)}Tk(_e)}catch(It){o=It,Y$1===_e&&_e!==null&&(Y$1=_e=_e.return);continue}break}while(1)}function Kk(){var a=nk.current;return nk.current=ai,a===null?ai:a}function uj(){(T===0||T===3||T===2)&&(T=4),R$1===null||!(hh&268435455)&&!(rk&268435455)||Dk(R$1,Z$1)}function Jk(a,o){var _e=K;K|=2;var tt=Kk();(R$1!==a||Z$1!==o)&&(vk=null,Lk(a,o));do try{Uk();break}catch(at){Nk(a,at)}while(1);if(Qg(),K=_e,nk.current=tt,Y$1!==null)throw Error(p$2(261));return R$1=null,Z$1=0,T}function Uk(){for(;Y$1!==null;)Vk(Y$1)}function Mk(){for(;Y$1!==null&&!cc();)Vk(Y$1)}function Vk(a){var o=Wk(a.alternate,a,gj);a.memoizedProps=a.pendingProps,o===null?Tk(a):Y$1=o,ok.current=null}function Tk(a){var o=a;do{var _e=o.alternate;if(a=o.return,o.flags&32768){if(_e=Jj(_e,o),_e!==null){_e.flags&=32767,Y$1=_e;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{T=6,Y$1=null;return}}else if(_e=Fj(_e,o,gj),_e!==null){Y$1=_e;return}if(o=o.sibling,o!==null){Y$1=o;return}Y$1=o=a}while(o!==null);T===0&&(T=5)}function Qk(a,o,_e){var tt=C,at=pk.transition;try{pk.transition=null,C=1,Xk(a,o,_e,tt)}finally{pk.transition=at,C=tt}return null}function Xk(a,o,_e,tt){do Ik();while(xk!==null);if(K&6)throw Error(p$2(327));_e=a.finishedWork;var at=a.finishedLanes;if(_e===null)return null;if(a.finishedWork=null,a.finishedLanes=0,_e===a.current)throw Error(p$2(177));a.callbackNode=null,a.callbackPriority=0;var lt=_e.lanes|_e.childLanes;if(Bc(a,lt),a===R$1&&(Y$1=R$1=null,Z$1=0),!(_e.subtreeFlags&2064)&&!(_e.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),lt=(_e.flags&15990)!==0,_e.subtreeFlags&15990||lt){lt=pk.transition,pk.transition=null;var it=C;C=1;var ut=K;K|=4,ok.current=null,Pj(a,_e),ek(_e,a),Oe(Df),dd=!!Cf,Df=Cf=null,a.current=_e,ik(_e),dc(),K=ut,C=it,pk.transition=lt}else a.current=_e;if(wk&&(wk=!1,xk=a,yk=at),lt=a.pendingLanes,lt===0&&(Si=null),mc(_e.stateNode),Ek(a,B()),o!==null)for(tt=a.onRecoverableError,_e=0;_e<o.length;_e++)at=o[_e],tt(at.value,{componentStack:at.stack,digest:at.digest});if(Pi)throw Pi=!1,a=Qi,Qi=null,a;return yk&1&&a.tag!==0&&Ik(),lt=a.pendingLanes,lt&1?a===Ak?zk++:(zk=0,Ak=a):zk=0,jg(),null}function Ik(){if(xk!==null){var a=Dc(yk),o=pk.transition,_e=C;try{if(pk.transition=null,C=16>a?16:a,xk===null)var tt=!1;else{if(a=xk,xk=null,yk=0,K&6)throw Error(p$2(331));var at=K;for(K|=4,V=a.current;V!==null;){var lt=V,it=lt.child;if(V.flags&16){var ut=lt.deletions;if(ut!==null){for(var s=0;s<ut.length;s++){var et=ut[s];for(V=et;V!==null;){var ot=V;switch(ot.tag){case 0:case 11:case 15:Qj(8,ot,lt)}var st=ot.child;if(st!==null)st.return=ot,V=st;else for(;V!==null;){ot=V;var Rt=ot.sibling,ht=ot.return;if(Tj(ot),ot===et){V=null;break}if(Rt!==null){Rt.return=ht,V=Rt;break}V=ht}}}var bt=lt.alternate;if(bt!==null){var ct=bt.child;if(ct!==null){bt.child=null;do{var mt=ct.sibling;ct.sibling=null,ct=mt}while(ct!==null)}}V=lt}}if(lt.subtreeFlags&2064&&it!==null)it.return=lt,V=it;else e:for(;V!==null;){if(lt=V,lt.flags&2048)switch(lt.tag){case 0:case 11:case 15:Qj(9,lt,lt.return)}var rt=lt.sibling;if(rt!==null){rt.return=lt.return,V=rt;break e}V=lt.return}}var pt=a.current;for(V=pt;V!==null;){it=V;var ft=it.child;if(it.subtreeFlags&2064&&ft!==null)ft.return=it,V=ft;else e:for(it=pt;V!==null;){if(ut=V,ut.flags&2048)try{switch(ut.tag){case 0:case 11:case 15:Rj(9,ut)}}catch(It){W$1(ut,ut.return,It)}if(ut===it){V=null;break e}var St=ut.sibling;if(St!==null){St.return=ut.return,V=St;break e}V=ut.return}}if(K=at,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,a)}catch{}tt=!0}return tt}finally{C=_e,pk.transition=o}}return!1}function Yk(a,o,_e){o=Ki(_e,o),o=Oi(a,o,1),a=dh(a,o,1),o=L(),a!==null&&(Ac(a,1,o),Ek(a,o))}function W$1(a,o,_e){if(a.tag===3)Yk(a,a,_e);else for(;o!==null;){if(o.tag===3){Yk(o,a,_e);break}else if(o.tag===1){var tt=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof tt.componentDidCatch=="function"&&(Si===null||!Si.has(tt))){a=Ki(_e,a),a=Ri(o,a,1),o=dh(o,a,1),a=L(),o!==null&&(Ac(o,1,a),Ek(o,a));break}}o=o.return}}function Ui(a,o,_e){var tt=a.pingCache;tt!==null&&tt.delete(o),o=L(),a.pingedLanes|=a.suspendedLanes&_e,R$1===a&&(Z$1&_e)===_e&&(T===4||T===3&&(Z$1&130023424)===Z$1&&500>B()-gk?Lk(a,0):sk|=_e),Ek(a,o)}function Zk(a,o){o===0&&(a.mode&1?(o=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):o=1);var _e=L();a=Zg(a,o),a!==null&&(Ac(a,o,_e),Ek(a,_e))}function vj(a){var o=a.memoizedState,_e=0;o!==null&&(_e=o.retryLane),Zk(a,_e)}function ck(a,o){var _e=0;switch(a.tag){case 13:var tt=a.stateNode,at=a.memoizedState;at!==null&&(_e=at.retryLane);break;case 19:tt=a.stateNode;break;default:throw Error(p$2(314))}tt!==null&&tt.delete(o),Zk(a,_e)}var Wk;Wk=function(a,o,_e){if(a!==null)if(a.memoizedProps!==o.pendingProps||Wf.current)Ug=!0;else{if(!(a.lanes&_e)&&!(o.flags&128))return Ug=!1,zj(a,o,_e);Ug=!!(a.flags&131072)}else Ug=!1,I$1&&o.flags&1048576&&ug(o,ng,o.index);switch(o.lanes=0,o.tag){case 2:var tt=o.type;jj(a,o),a=o.pendingProps;var at=Yf(o,H$1.current);Tg(o,_e),at=Xh(null,o,tt,a,at,_e);var lt=bi();return o.flags|=1,typeof at=="object"&&at!==null&&typeof at.render=="function"&&at.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Zf(tt)?(lt=!0,cg(o)):lt=!1,o.memoizedState=at.state!==null&&at.state!==void 0?at.state:null,ah(o),at.updater=nh,o.stateNode=at,at._reactInternals=o,rh(o,tt,a,_e),o=kj(null,o,tt,!0,lt,_e)):(o.tag=0,I$1&&lt&&vg(o),Yi(null,o,at,_e),o=o.child),o;case 16:tt=o.elementType;e:{switch(jj(a,o),a=o.pendingProps,at=tt._init,tt=at(tt._payload),o.type=tt,at=o.tag=$k(tt),a=Lg(tt,a),at){case 0:o=dj(null,o,tt,a,_e);break e;case 1:o=ij(null,o,tt,a,_e);break e;case 11:o=Zi(null,o,tt,a,_e);break e;case 14:o=aj(null,o,tt,Lg(tt.type,a),_e);break e}throw Error(p$2(306,tt,""))}return o;case 0:return tt=o.type,at=o.pendingProps,at=o.elementType===tt?at:Lg(tt,at),dj(a,o,tt,at,_e);case 1:return tt=o.type,at=o.pendingProps,at=o.elementType===tt?at:Lg(tt,at),ij(a,o,tt,at,_e);case 3:e:{if(lj(o),a===null)throw Error(p$2(387));tt=o.pendingProps,lt=o.memoizedState,at=lt.element,bh(a,o),gh(o,tt,null,_e);var it=o.memoizedState;if(tt=it.element,lt.isDehydrated)if(lt={element:tt,isDehydrated:!1,cache:it.cache,pendingSuspenseBoundaries:it.pendingSuspenseBoundaries,transitions:it.transitions},o.updateQueue.baseState=lt,o.memoizedState=lt,o.flags&256){at=Ki(Error(p$2(423)),o),o=mj(a,o,tt,_e,at);break e}else if(tt!==at){at=Ki(Error(p$2(424)),o),o=mj(a,o,tt,_e,at);break e}else for(yg=Lf(o.stateNode.containerInfo.firstChild),xg=o,I$1=!0,zg=null,_e=Ch(o,null,tt,_e),o.child=_e;_e;)_e.flags=_e.flags&-3|4096,_e=_e.sibling;else{if(Ig(),tt===at){o=$i(a,o,_e);break e}Yi(a,o,tt,_e)}o=o.child}return o;case 5:return Kh(o),a===null&&Eg(o),tt=o.type,at=o.pendingProps,lt=a!==null?a.memoizedProps:null,it=at.children,Ef(tt,at)?it=null:lt!==null&&Ef(tt,lt)&&(o.flags|=32),hj(a,o),Yi(a,o,it,_e),o.child;case 6:return a===null&&Eg(o),null;case 13:return pj(a,o,_e);case 4:return Ih(o,o.stateNode.containerInfo),tt=o.pendingProps,a===null?o.child=Bh(o,null,tt,_e):Yi(a,o,tt,_e),o.child;case 11:return tt=o.type,at=o.pendingProps,at=o.elementType===tt?at:Lg(tt,at),Zi(a,o,tt,at,_e);case 7:return Yi(a,o,o.pendingProps,_e),o.child;case 8:return Yi(a,o,o.pendingProps.children,_e),o.child;case 12:return Yi(a,o,o.pendingProps.children,_e),o.child;case 10:e:{if(tt=o.type._context,at=o.pendingProps,lt=o.memoizedProps,it=at.value,G(Mg,tt._currentValue),tt._currentValue=it,lt!==null)if(He(lt.value,it)){if(lt.children===at.children&&!Wf.current){o=$i(a,o,_e);break e}}else for(lt=o.child,lt!==null&&(lt.return=o);lt!==null;){var ut=lt.dependencies;if(ut!==null){it=lt.child;for(var s=ut.firstContext;s!==null;){if(s.context===tt){if(lt.tag===1){s=ch(-1,_e&-_e),s.tag=2;var et=lt.updateQueue;if(et!==null){et=et.shared;var ot=et.pending;ot===null?s.next=s:(s.next=ot.next,ot.next=s),et.pending=s}}lt.lanes|=_e,s=lt.alternate,s!==null&&(s.lanes|=_e),Sg(lt.return,_e,o),ut.lanes|=_e;break}s=s.next}}else if(lt.tag===10)it=lt.type===o.type?null:lt.child;else if(lt.tag===18){if(it=lt.return,it===null)throw Error(p$2(341));it.lanes|=_e,ut=it.alternate,ut!==null&&(ut.lanes|=_e),Sg(it,_e,o),it=lt.sibling}else it=lt.child;if(it!==null)it.return=lt;else for(it=lt;it!==null;){if(it===o){it=null;break}if(lt=it.sibling,lt!==null){lt.return=it.return,it=lt;break}it=it.return}lt=it}Yi(a,o,at.children,_e),o=o.child}return o;case 9:return at=o.type,tt=o.pendingProps.children,Tg(o,_e),at=Vg(at),tt=tt(at),o.flags|=1,Yi(a,o,tt,_e),o.child;case 14:return tt=o.type,at=Lg(tt,o.pendingProps),at=Lg(tt.type,at),aj(a,o,tt,at,_e);case 15:return cj(a,o,o.type,o.pendingProps,_e);case 17:return tt=o.type,at=o.pendingProps,at=o.elementType===tt?at:Lg(tt,at),jj(a,o),o.tag=1,Zf(tt)?(a=!0,cg(o)):a=!1,Tg(o,_e),ph(o,tt,at),rh(o,tt,at,_e),kj(null,o,tt,!0,a,_e);case 19:return yj(a,o,_e);case 22:return ej(a,o,_e)}throw Error(p$2(156,o.tag))};function Gk(a,o){return ac(a,o)}function al(a,o,_e,tt){this.tag=a,this.key=_e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=tt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(a,o,_e,tt){return new al(a,o,_e,tt)}function bj(a){return a=a.prototype,!(!a||!a.isReactComponent)}function $k(a){if(typeof a=="function")return bj(a)?1:0;if(a!=null){if(a=a.$$typeof,a===Da)return 11;if(a===Ga)return 14}return 2}function wh(a,o){var _e=a.alternate;return _e===null?(_e=Bg(a.tag,o,a.key,a.mode),_e.elementType=a.elementType,_e.type=a.type,_e.stateNode=a.stateNode,_e.alternate=a,a.alternate=_e):(_e.pendingProps=o,_e.type=a.type,_e.flags=0,_e.subtreeFlags=0,_e.deletions=null),_e.flags=a.flags&14680064,_e.childLanes=a.childLanes,_e.lanes=a.lanes,_e.child=a.child,_e.memoizedProps=a.memoizedProps,_e.memoizedState=a.memoizedState,_e.updateQueue=a.updateQueue,o=a.dependencies,_e.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},_e.sibling=a.sibling,_e.index=a.index,_e.ref=a.ref,_e}function yh(a,o,_e,tt,at,lt){var it=2;if(tt=a,typeof a=="function")bj(a)&&(it=1);else if(typeof a=="string")it=5;else e:switch(a){case ya:return Ah(_e.children,at,lt,o);case za:it=8,at|=8;break;case Aa:return a=Bg(12,_e,o,at|2),a.elementType=Aa,a.lanes=lt,a;case Ea:return a=Bg(13,_e,o,at),a.elementType=Ea,a.lanes=lt,a;case Fa:return a=Bg(19,_e,o,at),a.elementType=Fa,a.lanes=lt,a;case Ia:return qj(_e,at,lt,o);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case Ba:it=10;break e;case Ca:it=9;break e;case Da:it=11;break e;case Ga:it=14;break e;case Ha:it=16,tt=null;break e}throw Error(p$2(130,a==null?a:typeof a,""))}return o=Bg(it,_e,o,at),o.elementType=a,o.type=tt,o.lanes=lt,o}function Ah(a,o,_e,tt){return a=Bg(7,a,tt,o),a.lanes=_e,a}function qj(a,o,_e,tt){return a=Bg(22,a,tt,o),a.elementType=Ia,a.lanes=_e,a.stateNode={isHidden:!1},a}function xh(a,o,_e){return a=Bg(6,a,null,o),a.lanes=_e,a}function zh(a,o,_e){return o=Bg(4,a.children!==null?a.children:[],a.key,o),o.lanes=_e,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}function bl(a,o,_e,tt,at){this.tag=o,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=tt,this.onRecoverableError=at,this.mutableSourceEagerHydrationData=null}function cl(a,o,_e,tt,at,lt,it,ut,s){return a=new bl(a,o,_e,ut,s),o===1?(o=1,lt===!0&&(o|=8)):o=0,lt=Bg(3,null,null,o),a.current=lt,lt.stateNode=a,lt.memoizedState={element:tt,isDehydrated:_e,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(lt),a}function dl(a,o,_e){var tt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:tt==null?null:""+tt,children:a,containerInfo:o,implementation:_e}}function el(a){if(!a)return Vf;a=a._reactInternals;e:{if(Vb(a)!==a||a.tag!==1)throw Error(p$2(170));var o=a;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Zf(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(p$2(171))}if(a.tag===1){var _e=a.type;if(Zf(_e))return bg(a,_e,o)}return o}function fl(a,o,_e,tt,at,lt,it,ut,s){return a=cl(_e,tt,!0,a,at,lt,it,ut,s),a.context=el(null),_e=a.current,tt=L(),at=lh(_e),lt=ch(tt,at),lt.callback=o??null,dh(_e,lt,at),a.current.lanes=at,Ac(a,at,tt),Ek(a,tt),a}function gl(a,o,_e,tt){var at=o.current,lt=L(),it=lh(at);return _e=el(_e),o.context===null?o.context=_e:o.pendingContext=_e,o=ch(lt,it),o.payload={element:a},tt=tt===void 0?null:tt,tt!==null&&(o.callback=tt),a=dh(at,o,it),a!==null&&(mh(a,at,it,lt),eh(a,at,it)),it}function hl(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function il(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var _e=a.retryLane;a.retryLane=_e!==0&&_e<o?_e:o}}function jl(a,o){il(a,o),(a=a.alternate)&&il(a,o)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(a){console.error(a)};function ml(a){this._internalRoot=a}nl.prototype.render=ml.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(p$2(409));gl(a,o,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;Sk(function(){gl(null,a,null,null)}),o[uf]=null}};function nl(a){this._internalRoot=a}nl.prototype.unstable_scheduleHydration=function(a){if(a){var o=Hc();a={blockedOn:null,target:a,priority:o};for(var _e=0;_e<Qc.length&&o!==0&&o<Qc[_e].priority;_e++);Qc.splice(_e,0,a),_e===0&&Vc(a)}};function ol(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function pl(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(a,o,_e,tt,at){if(at){if(typeof tt=="function"){var lt=tt;tt=function(){var et=hl(it);lt.call(et)}}var it=fl(o,tt,a,0,null,!1,!1,"",ql);return a._reactRootContainer=it,a[uf]=it.current,sf(a.nodeType===8?a.parentNode:a),Sk(),it}for(;at=a.lastChild;)a.removeChild(at);if(typeof tt=="function"){var ut=tt;tt=function(){var et=hl(s);ut.call(et)}}var s=cl(a,0,!1,null,null,!1,!1,"",ql);return a._reactRootContainer=s,a[uf]=s.current,sf(a.nodeType===8?a.parentNode:a),Sk(function(){gl(o,s,_e,tt)}),s}function sl(a,o,_e,tt,at){var lt=_e._reactRootContainer;if(lt){var it=lt;if(typeof at=="function"){var ut=at;at=function(){var s=hl(it);ut.call(s)}}gl(o,it,a,at)}else it=rl(_e,o,a,at,tt);return hl(it)}Ec=function(a){switch(a.tag){case 3:var o=a.stateNode;if(o.current.memoizedState.isDehydrated){var _e=tc(o.pendingLanes);_e!==0&&(Cc(o,_e|1),Ek(o,B()),!(K&6)&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var tt=Zg(a,1);if(tt!==null){var at=L();mh(tt,a,1,at)}}),jl(a,1)}};Fc=function(a){if(a.tag===13){var o=Zg(a,134217728);if(o!==null){var _e=L();mh(o,a,134217728,_e)}jl(a,134217728)}};Gc=function(a){if(a.tag===13){var o=lh(a),_e=Zg(a,o);if(_e!==null){var tt=L();mh(_e,a,o,tt)}jl(a,o)}};Hc=function(){return C};Ic=function(a,o){var _e=C;try{return C=a,o()}finally{C=_e}};yb=function(a,o,_e){switch(o){case"input":if(bb(a,_e),o=_e.name,_e.type==="radio"&&o!=null){for(_e=a;_e.parentNode;)_e=_e.parentNode;for(_e=_e.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<_e.length;o++){var tt=_e[o];if(tt!==a&&tt.form===a.form){var at=Db(tt);if(!at)throw Error(p$2(90));Wa(tt),bb(tt,at)}}}break;case"textarea":ib(a,_e);break;case"select":o=_e.value,o!=null&&fb(a,!!_e.multiple,o,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Zb(a),a===null?null:a.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(a,o){var _e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(o))throw Error(p$2(200));return dl(a,o,null,_e)};reactDom_production_min.createRoot=function(a,o){if(!ol(a))throw Error(p$2(299));var _e=!1,tt="",at=ll;return o!=null&&(o.unstable_strictMode===!0&&(_e=!0),o.identifierPrefix!==void 0&&(tt=o.identifierPrefix),o.onRecoverableError!==void 0&&(at=o.onRecoverableError)),o=cl(a,1,!1,null,null,_e,!1,tt,at),a[uf]=o.current,sf(a.nodeType===8?a.parentNode:a),new ml(o)};reactDom_production_min.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(p$2(188)):(a=Object.keys(a).join(","),Error(p$2(268,a)));return a=Zb(o),a=a===null?null:a.stateNode,a};reactDom_production_min.flushSync=function(a){return Sk(a)};reactDom_production_min.hydrate=function(a,o,_e){if(!pl(o))throw Error(p$2(200));return sl(null,a,o,!0,_e)};reactDom_production_min.hydrateRoot=function(a,o,_e){if(!ol(a))throw Error(p$2(405));var tt=_e!=null&&_e.hydratedSources||null,at=!1,lt="",it=ll;if(_e!=null&&(_e.unstable_strictMode===!0&&(at=!0),_e.identifierPrefix!==void 0&&(lt=_e.identifierPrefix),_e.onRecoverableError!==void 0&&(it=_e.onRecoverableError)),o=fl(o,null,a,1,_e??null,at,!1,lt,it),a[uf]=o.current,sf(a),tt)for(a=0;a<tt.length;a++)_e=tt[a],at=_e._getVersion,at=at(_e._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[_e,at]:o.mutableSourceEagerHydrationData.push(_e,at);return new nl(o)};reactDom_production_min.render=function(a,o,_e){if(!pl(o))throw Error(p$2(200));return sl(null,a,o,!1,_e)};reactDom_production_min.unmountComponentAtNode=function(a){if(!pl(a))throw Error(p$2(40));return a._reactRootContainer?(Sk(function(){sl(null,null,a,!1,function(){a._reactRootContainer=null,a[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(a,o,_e,tt){if(!pl(_e))throw Error(p$2(200));if(a==null||a._reactInternals===void 0)throw Error(p$2(38));return sl(a,o,_e,!1,tt)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(a){console.error(a)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs(reactDomExports);var createRoot,m$3=reactDomExports;createRoot=m$3.createRoot,m$3.hydrateRoot;/**
 * @remix-run/router v1.5.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var tt in _e)Object.prototype.hasOwnProperty.call(_e,tt)&&(a[tt]=_e[tt])}return a},_extends$2.apply(this,arguments)}var Action;(function(a){a.Pop="POP",a.Push="PUSH",a.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(a){a===void 0&&(a={});function o(tt,at){let{pathname:lt,search:it,hash:ut}=tt.location;return createLocation("",{pathname:lt,search:it,hash:ut},at.state&&at.state.usr||null,at.state&&at.state.key||"default")}function _e(tt,at){return typeof at=="string"?at:createPath(at)}return getUrlBasedHistory(o,_e,null,a)}function invariant(a,o){if(a===!1||a===null||typeof a>"u")throw new Error(o)}function warning(a,o){if(!a){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(a,o){return{usr:a.state,key:a.key,idx:o}}function createLocation(a,o,_e,tt){return _e===void 0&&(_e=null),_extends$2({pathname:typeof a=="string"?a:a.pathname,search:"",hash:""},typeof o=="string"?parsePath(o):o,{state:_e,key:o&&o.key||tt||createKey()})}function createPath(a){let{pathname:o="/",search:_e="",hash:tt=""}=a;return _e&&_e!=="?"&&(o+=_e.charAt(0)==="?"?_e:"?"+_e),tt&&tt!=="#"&&(o+=tt.charAt(0)==="#"?tt:"#"+tt),o}function parsePath(a){let o={};if(a){let _e=a.indexOf("#");_e>=0&&(o.hash=a.substr(_e),a=a.substr(0,_e));let tt=a.indexOf("?");tt>=0&&(o.search=a.substr(tt),a=a.substr(0,tt)),a&&(o.pathname=a)}return o}function getUrlBasedHistory(a,o,_e,tt){tt===void 0&&(tt={});let{window:at=document.defaultView,v5Compat:lt=!1}=tt,it=at.history,ut=Action.Pop,s=null,et=ot();et==null&&(et=0,it.replaceState(_extends$2({},it.state,{idx:et}),""));function ot(){return(it.state||{idx:null}).idx}function st(){ut=Action.Pop;let mt=ot(),rt=mt==null?null:mt-et;et=mt,s&&s({action:ut,location:ct.location,delta:rt})}function Rt(mt,rt){ut=Action.Push;let pt=createLocation(ct.location,mt,rt);_e&&_e(pt,mt),et=ot()+1;let ft=getHistoryState(pt,et),St=ct.createHref(pt);try{it.pushState(ft,"",St)}catch{at.location.assign(St)}lt&&s&&s({action:ut,location:ct.location,delta:1})}function ht(mt,rt){ut=Action.Replace;let pt=createLocation(ct.location,mt,rt);_e&&_e(pt,mt),et=ot();let ft=getHistoryState(pt,et),St=ct.createHref(pt);it.replaceState(ft,"",St),lt&&s&&s({action:ut,location:ct.location,delta:0})}function bt(mt){let rt=at.location.origin!=="null"?at.location.origin:at.location.href,pt=typeof mt=="string"?mt:createPath(mt);return invariant(rt,"No window.location.(origin|href) available to create URL for href: "+pt),new URL(pt,rt)}let ct={get action(){return ut},get location(){return a(at,it)},listen(mt){if(s)throw new Error("A history only accepts one active listener");return at.addEventListener(PopStateEventType,st),s=mt,()=>{at.removeEventListener(PopStateEventType,st),s=null}},createHref(mt){return o(at,mt)},createURL:bt,encodeLocation(mt){let rt=bt(mt);return{pathname:rt.pathname,search:rt.search,hash:rt.hash}},push:Rt,replace:ht,go(mt){return it.go(mt)}};return ct}var ResultType;(function(a){a.data="data",a.deferred="deferred",a.redirect="redirect",a.error="error"})(ResultType||(ResultType={}));function matchRoutes(a,o,_e){_e===void 0&&(_e="/");let tt=typeof o=="string"?parsePath(o):o,at=stripBasename(tt.pathname||"/",_e);if(at==null)return null;let lt=flattenRoutes(a);rankRouteBranches(lt);let it=null;for(let ut=0;it==null&&ut<lt.length;++ut)it=matchRouteBranch(lt[ut],safelyDecodeURI(at));return it}function flattenRoutes(a,o,_e,tt){o===void 0&&(o=[]),_e===void 0&&(_e=[]),tt===void 0&&(tt="");let at=(lt,it,ut)=>{let s={relativePath:ut===void 0?lt.path||"":ut,caseSensitive:lt.caseSensitive===!0,childrenIndex:it,route:lt};s.relativePath.startsWith("/")&&(invariant(s.relativePath.startsWith(tt),'Absolute route path "'+s.relativePath+'" nested under path '+('"'+tt+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),s.relativePath=s.relativePath.slice(tt.length));let et=joinPaths([tt,s.relativePath]),ot=_e.concat(s);lt.children&&lt.children.length>0&&(invariant(lt.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+et+'".')),flattenRoutes(lt.children,o,ot,et)),!(lt.path==null&&!lt.index)&&o.push({path:et,score:computeScore(et,lt.index),routesMeta:ot})};return a.forEach((lt,it)=>{var ut;if(lt.path===""||!((ut=lt.path)!=null&&ut.includes("?")))at(lt,it);else for(let s of explodeOptionalSegments(lt.path))at(lt,it,s)}),o}function explodeOptionalSegments(a){let o=a.split("/");if(o.length===0)return[];let[_e,...tt]=o,at=_e.endsWith("?"),lt=_e.replace(/\?$/,"");if(tt.length===0)return at?[lt,""]:[lt];let it=explodeOptionalSegments(tt.join("/")),ut=[];return ut.push(...it.map(s=>s===""?lt:[lt,s].join("/"))),at&&ut.push(...it),ut.map(s=>a.startsWith("/")&&s===""?"/":s)}function rankRouteBranches(a){a.sort((o,_e)=>o.score!==_e.score?_e.score-o.score:compareIndexes(o.routesMeta.map(tt=>tt.childrenIndex),_e.routesMeta.map(tt=>tt.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=a=>a==="*";function computeScore(a,o){let _e=a.split("/"),tt=_e.length;return _e.some(isSplat)&&(tt+=splatPenalty),o&&(tt+=indexRouteValue),_e.filter(at=>!isSplat(at)).reduce((at,lt)=>at+(paramRe.test(lt)?dynamicSegmentValue:lt===""?emptySegmentValue:staticSegmentValue),tt)}function compareIndexes(a,o){return a.length===o.length&&a.slice(0,-1).every((tt,at)=>tt===o[at])?a[a.length-1]-o[o.length-1]:0}function matchRouteBranch(a,o){let{routesMeta:_e}=a,tt={},at="/",lt=[];for(let it=0;it<_e.length;++it){let ut=_e[it],s=it===_e.length-1,et=at==="/"?o:o.slice(at.length)||"/",ot=matchPath({path:ut.relativePath,caseSensitive:ut.caseSensitive,end:s},et);if(!ot)return null;Object.assign(tt,ot.params);let st=ut.route;lt.push({params:tt,pathname:joinPaths([at,ot.pathname]),pathnameBase:normalizePathname(joinPaths([at,ot.pathnameBase])),route:st}),ot.pathnameBase!=="/"&&(at=joinPaths([at,ot.pathnameBase]))}return lt}function matchPath(a,o){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[_e,tt]=compilePath(a.path,a.caseSensitive,a.end),at=o.match(_e);if(!at)return null;let lt=at[0],it=lt.replace(/(.)\/+$/,"$1"),ut=at.slice(1);return{params:tt.reduce((et,ot,st)=>{if(ot==="*"){let Rt=ut[st]||"";it=lt.slice(0,lt.length-Rt.length).replace(/(.)\/+$/,"$1")}return et[ot]=safelyDecodeURIComponent(ut[st]||"",ot),et},{}),pathname:lt,pathnameBase:it,pattern:a}}function compilePath(a,o,_e){o===void 0&&(o=!1),_e===void 0&&(_e=!0),warning(a==="*"||!a.endsWith("*")||a.endsWith("/*"),'Route path "'+a+'" will be treated as if it were '+('"'+a.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+a.replace(/\*$/,"/*")+'".'));let tt=[],at="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(it,ut)=>(tt.push(ut),"/([^\\/]+)"));return a.endsWith("*")?(tt.push("*"),at+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):_e?at+="\\/*$":a!==""&&a!=="/"&&(at+="(?:(?=\\/|$))"),[new RegExp(at,o?void 0:"i"),tt]}function safelyDecodeURI(a){try{return decodeURI(a)}catch(o){return warning(!1,'The URL path "'+a+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),a}}function safelyDecodeURIComponent(a,o){try{return decodeURIComponent(a)}catch(_e){return warning(!1,'The value for the URL param "'+o+'" will not be decoded because'+(' the string "'+a+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+_e+").")),a}}function stripBasename(a,o){if(o==="/")return a;if(!a.toLowerCase().startsWith(o.toLowerCase()))return null;let _e=o.endsWith("/")?o.length-1:o.length,tt=a.charAt(_e);return tt&&tt!=="/"?null:a.slice(_e)||"/"}function resolvePath(a,o){o===void 0&&(o="/");let{pathname:_e,search:tt="",hash:at=""}=typeof a=="string"?parsePath(a):a;return{pathname:_e?_e.startsWith("/")?_e:resolvePathname(_e,o):o,search:normalizeSearch(tt),hash:normalizeHash(at)}}function resolvePathname(a,o){let _e=o.replace(/\/+$/,"").split("/");return a.split("/").forEach(at=>{at===".."?_e.length>1&&_e.pop():at!=="."&&_e.push(at)}),_e.length>1?_e.join("/"):"/"}function getInvalidPathError(a,o,_e,tt){return"Cannot include a '"+a+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(tt)+"].  Please separate it out to the ")+("`to."+_e+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(a){return a.filter((o,_e)=>_e===0||o.route.path&&o.route.path.length>0)}function resolveTo(a,o,_e,tt){tt===void 0&&(tt=!1);let at;typeof a=="string"?at=parsePath(a):(at=_extends$2({},a),invariant(!at.pathname||!at.pathname.includes("?"),getInvalidPathError("?","pathname","search",at)),invariant(!at.pathname||!at.pathname.includes("#"),getInvalidPathError("#","pathname","hash",at)),invariant(!at.search||!at.search.includes("#"),getInvalidPathError("#","search","hash",at)));let lt=a===""||at.pathname==="",it=lt?"/":at.pathname,ut;if(tt||it==null)ut=_e;else{let st=o.length-1;if(it.startsWith("..")){let Rt=it.split("/");for(;Rt[0]==="..";)Rt.shift(),st-=1;at.pathname=Rt.join("/")}ut=st>=0?o[st]:"/"}let s=resolvePath(at,ut),et=it&&it!=="/"&&it.endsWith("/"),ot=(lt||it===".")&&_e.endsWith("/");return!s.pathname.endsWith("/")&&(et||ot)&&(s.pathname+="/"),s}const joinPaths=a=>a.join("/").replace(/\/\/+/g,"/"),normalizePathname=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,normalizeHash=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function isRouteErrorResponse(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function isPolyfill(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}const is=typeof Object.is=="function"?Object.is:isPolyfill,{useState,useEffect,useLayoutEffect,useDebugValue}=React$1;function useSyncExternalStore$2(a,o,_e){const tt=o(),[{inst:at},lt]=useState({inst:{value:tt,getSnapshot:o}});return useLayoutEffect(()=>{at.value=tt,at.getSnapshot=o,checkIfSnapshotChanged(at)&&lt({inst:at})},[a,tt,o]),useEffect(()=>(checkIfSnapshotChanged(at)&&lt({inst:at}),a(()=>{checkIfSnapshotChanged(at)&&lt({inst:at})})),[a]),useDebugValue(tt),tt}function checkIfSnapshotChanged(a){const o=a.getSnapshot,_e=a.value;try{const tt=o();return!is(_e,tt)}catch{return!0}}function useSyncExternalStore$1(a,o,_e){return o()}const canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isServerEnvironment=!canUseDOM,shim=isServerEnvironment?useSyncExternalStore$1:useSyncExternalStore$2;"useSyncExternalStore"in React$1&&(a=>a.useSyncExternalStore)(React$1);const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[]}),RouteErrorContext=reactExports.createContext(null);function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var tt in _e)Object.prototype.hasOwnProperty.call(_e,tt)&&(a[tt]=_e[tt])}return a},_extends$1.apply(this,arguments)}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useNavigate(){useInRouterContext()||invariant(!1);let{basename:a,navigator:o}=reactExports.useContext(NavigationContext),{matches:_e}=reactExports.useContext(RouteContext),{pathname:tt}=useLocation(),at=JSON.stringify(getPathContributingMatches(_e).map(ut=>ut.pathnameBase)),lt=reactExports.useRef(!1);return reactExports.useEffect(()=>{lt.current=!0}),reactExports.useCallback(function(ut,s){if(s===void 0&&(s={}),!lt.current)return;if(typeof ut=="number"){o.go(ut);return}let et=resolveTo(ut,JSON.parse(at),tt,s.relative==="path");a!=="/"&&(et.pathname=et.pathname==="/"?a:joinPaths([a,et.pathname])),(s.replace?o.replace:o.push)(et,s.state,s)},[a,o,at,tt])}function useParams(){let{matches:a}=reactExports.useContext(RouteContext),o=a[a.length-1];return o?o.params:{}}function useRoutes(a,o){useInRouterContext()||invariant(!1);let{navigator:_e}=reactExports.useContext(NavigationContext),tt=reactExports.useContext(DataRouterStateContext),{matches:at}=reactExports.useContext(RouteContext),lt=at[at.length-1],it=lt?lt.params:{};lt&&lt.pathname;let ut=lt?lt.pathnameBase:"/";lt&&lt.route;let s=useLocation(),et;if(o){var ot;let ct=typeof o=="string"?parsePath(o):o;ut==="/"||(ot=ct.pathname)!=null&&ot.startsWith(ut)||invariant(!1),et=ct}else et=s;let st=et.pathname||"/",Rt=ut==="/"?st:st.slice(ut.length)||"/",ht=matchRoutes(a,{pathname:Rt}),bt=_renderMatches(ht&&ht.map(ct=>Object.assign({},ct,{params:Object.assign({},it,ct.params),pathname:joinPaths([ut,_e.encodeLocation?_e.encodeLocation(ct.pathname).pathname:ct.pathname]),pathnameBase:ct.pathnameBase==="/"?ut:joinPaths([ut,_e.encodeLocation?_e.encodeLocation(ct.pathnameBase).pathname:ct.pathnameBase])})),at,tt||void 0);return o&&bt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},et),navigationType:Action.Pop}},bt):bt}function DefaultErrorComponent(){let a=useRouteError(),o=isRouteErrorResponse(a)?a.status+" "+a.statusText:a instanceof Error?a.message:JSON.stringify(a),_e=a instanceof Error?a.stack:null,at={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},lt=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},o),_e?reactExports.createElement("pre",{style:at},_e):null,lt)}class RenderErrorBoundary extends reactExports.Component{constructor(o){super(o),this.state={location:o.location,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,_e){return _e.location!==o.location?{error:o.error,location:o.location}:{error:o.error||_e.error,location:_e.location}}componentDidCatch(o,_e){console.error("React Router caught the following error during render",o,_e)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(a){let{routeContext:o,match:_e,children:tt}=a,at=reactExports.useContext(DataRouterContext);return at&&at.static&&at.staticContext&&(_e.route.errorElement||_e.route.ErrorBoundary)&&(at.staticContext._deepestRenderedBoundaryId=_e.route.id),reactExports.createElement(RouteContext.Provider,{value:o},tt)}function _renderMatches(a,o,_e){if(o===void 0&&(o=[]),a==null)if(_e!=null&&_e.errors)a=_e.matches;else return null;let tt=a,at=_e==null?void 0:_e.errors;if(at!=null){let lt=tt.findIndex(it=>it.route.id&&(at==null?void 0:at[it.route.id]));lt>=0||invariant(!1),tt=tt.slice(0,Math.min(tt.length,lt+1))}return tt.reduceRight((lt,it,ut)=>{let s=it.route.id?at==null?void 0:at[it.route.id]:null,et=null;_e&&(it.route.ErrorBoundary?et=reactExports.createElement(it.route.ErrorBoundary,null):it.route.errorElement?et=it.route.errorElement:et=reactExports.createElement(DefaultErrorComponent,null));let ot=o.concat(tt.slice(0,ut+1)),st=()=>{let Rt=lt;return s?Rt=et:it.route.Component?Rt=reactExports.createElement(it.route.Component,null):it.route.element&&(Rt=it.route.element),reactExports.createElement(RenderedRoute,{match:it,routeContext:{outlet:lt,matches:ot},children:Rt})};return _e&&(it.route.ErrorBoundary||it.route.errorElement||ut===0)?reactExports.createElement(RenderErrorBoundary,{location:_e.location,component:et,error:s,children:st(),routeContext:{outlet:null,matches:ot}}):st()},null)}var DataRouterHook$1;(function(a){a.UseBlocker="useBlocker",a.UseRevalidator="useRevalidator"})(DataRouterHook$1||(DataRouterHook$1={}));var DataRouterStateHook$1;(function(a){a.UseBlocker="useBlocker",a.UseLoaderData="useLoaderData",a.UseActionData="useActionData",a.UseRouteError="useRouteError",a.UseNavigation="useNavigation",a.UseRouteLoaderData="useRouteLoaderData",a.UseMatches="useMatches",a.UseRevalidator="useRevalidator"})(DataRouterStateHook$1||(DataRouterStateHook$1={}));function useDataRouterState(a){let o=reactExports.useContext(DataRouterStateContext);return o||invariant(!1),o}function useRouteContext(a){let o=reactExports.useContext(RouteContext);return o||invariant(!1),o}function useCurrentRouteId(a){let o=useRouteContext(),_e=o.matches[o.matches.length-1];return _e.route.id||invariant(!1),_e.route.id}function useRouteError(){var a;let o=reactExports.useContext(RouteErrorContext),_e=useDataRouterState(DataRouterStateHook$1.UseRouteError),tt=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return o||((a=_e.errors)==null?void 0:a[tt])}function Route(a){invariant(!1)}function Router(a){let{basename:o="/",children:_e=null,location:tt,navigationType:at=Action.Pop,navigator:lt,static:it=!1}=a;useInRouterContext()&&invariant(!1);let ut=o.replace(/^\/*/,"/"),s=reactExports.useMemo(()=>({basename:ut,navigator:lt,static:it}),[ut,lt,it]);typeof tt=="string"&&(tt=parsePath(tt));let{pathname:et="/",search:ot="",hash:st="",state:Rt=null,key:ht="default"}=tt,bt=reactExports.useMemo(()=>{let ct=stripBasename(et,ut);return ct==null?null:{location:{pathname:ct,search:ot,hash:st,state:Rt,key:ht},navigationType:at}},[ut,et,ot,st,Rt,ht,at]);return bt==null?null:reactExports.createElement(NavigationContext.Provider,{value:s},reactExports.createElement(LocationContext.Provider,{children:_e,value:bt}))}function Routes(a){let{children:o,location:_e}=a,tt=reactExports.useContext(DataRouterContext),at=tt&&!o?tt.router.routes:createRoutesFromChildren(o);return useRoutes(at,_e)}var AwaitRenderStatus;(function(a){a[a.pending=0]="pending",a[a.success=1]="success",a[a.error=2]="error"})(AwaitRenderStatus||(AwaitRenderStatus={}));new Promise(()=>{});function createRoutesFromChildren(a,o){o===void 0&&(o=[]);let _e=[];return reactExports.Children.forEach(a,(tt,at)=>{if(!reactExports.isValidElement(tt))return;let lt=[...o,at];if(tt.type===reactExports.Fragment){_e.push.apply(_e,createRoutesFromChildren(tt.props.children,lt));return}tt.type!==Route&&invariant(!1),!tt.props.index||!tt.props.children||invariant(!1);let it={id:tt.props.id||lt.join("-"),caseSensitive:tt.props.caseSensitive,element:tt.props.element,Component:tt.props.Component,index:tt.props.index,path:tt.props.path,loader:tt.props.loader,action:tt.props.action,errorElement:tt.props.errorElement,ErrorBoundary:tt.props.ErrorBoundary,hasErrorBoundary:tt.props.ErrorBoundary!=null||tt.props.errorElement!=null,shouldRevalidate:tt.props.shouldRevalidate,handle:tt.props.handle,lazy:tt.props.lazy};tt.props.children&&(it.children=createRoutesFromChildren(tt.props.children,lt)),_e.push(it)}),_e}/**
 * React Router DOM v6.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function createSearchParams(a){return a===void 0&&(a=""),new URLSearchParams(typeof a=="string"||Array.isArray(a)||a instanceof URLSearchParams?a:Object.keys(a).reduce((o,_e)=>{let tt=a[_e];return o.concat(Array.isArray(tt)?tt.map(at=>[_e,at]):[[_e,tt]])},[]))}function getSearchParamsForLocation(a,o){let _e=createSearchParams(a);if(o)for(let tt of o.keys())_e.has(tt)||o.getAll(tt).forEach(at=>{_e.append(tt,at)});return _e}function BrowserRouter(a){let{basename:o,children:_e,window:tt}=a,at=reactExports.useRef();at.current==null&&(at.current=createBrowserHistory({window:tt,v5Compat:!0}));let lt=at.current,[it,ut]=reactExports.useState({action:lt.action,location:lt.location});return reactExports.useLayoutEffect(()=>lt.listen(ut),[lt]),reactExports.createElement(Router,{basename:o,children:_e,location:it.location,navigationType:it.action,navigator:lt})}var DataRouterHook;(function(a){a.UseScrollRestoration="useScrollRestoration",a.UseSubmitImpl="useSubmitImpl",a.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(a){a.UseFetchers="useFetchers",a.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useSearchParams(a){let o=reactExports.useRef(createSearchParams(a)),_e=reactExports.useRef(!1),tt=useLocation(),at=reactExports.useMemo(()=>getSearchParamsForLocation(tt.search,_e.current?null:o.current),[tt.search]),lt=useNavigate(),it=reactExports.useCallback((ut,s)=>{const et=createSearchParams(typeof ut=="function"?ut(at):ut);_e.current=!0,lt("?"+et,s)},[lt,at]);return[at,it]}var uaParser={exports:{}};(function(a,o){(function(_e,tt){var at="1.0.35",lt="",it="?",ut="function",s="undefined",et="object",ot="string",st="major",Rt="model",ht="name",bt="type",ct="vendor",mt="version",rt="architecture",pt="console",ft="mobile",St="tablet",It="smarttv",xt="wearable",At="embedded",Dt=350,wt="Amazon",Mt="Apple",vt="ASUS",Ft="BlackBerry",Ht="Browser",Wt="Chrome",tn="Edge",gn="Firefox",nn="Google",qt="Huawei",fn="LG",Cn="Microsoft",Tn="Motorola",un="Opera",mn="Samsung",yn="Sharp",pn="Sony",In="Xiaomi",kn="Zebra",Mn="Facebook",xn="Chromium OS",Pn="Mac OS",On=function(Nn,Wn){var vn={};for(var Rn in Nn)Wn[Rn]&&Wn[Rn].length%2===0?vn[Rn]=Wn[Rn].concat(Nn[Rn]):vn[Rn]=Nn[Rn];return vn},Dn=function(Nn){for(var Wn={},vn=0;vn<Nn.length;vn++)Wn[Nn[vn].toUpperCase()]=Nn[vn];return Wn},Fn=function(Nn,Wn){return typeof Nn===ot?dr(Wn).indexOf(dr(Nn))!==-1:!1},dr=function(Nn){return Nn.toLowerCase()},ir=function(Nn){return typeof Nn===ot?Nn.replace(/[^\d\.]/g,lt).split(".")[0]:tt},Xn=function(Nn,Wn){if(typeof Nn===ot)return Nn=Nn.replace(/^\s\s*/,lt),typeof Wn===s?Nn:Nn.substring(0,Dt)},tr=function(Nn,Wn){for(var vn=0,Rn,Gt,Tt,nt,Ct,yt;vn<Wn.length&&!Ct;){var Pt=Wn[vn],Et=Wn[vn+1];for(Rn=Gt=0;Rn<Pt.length&&!Ct&&Pt[Rn];)if(Ct=Pt[Rn++].exec(Nn),Ct)for(Tt=0;Tt<Et.length;Tt++)yt=Ct[++Gt],nt=Et[Tt],typeof nt===et&&nt.length>0?nt.length===2?typeof nt[1]==ut?this[nt[0]]=nt[1].call(this,yt):this[nt[0]]=nt[1]:nt.length===3?typeof nt[1]===ut&&!(nt[1].exec&&nt[1].test)?this[nt[0]]=yt?nt[1].call(this,yt,nt[2]):tt:this[nt[0]]=yt?yt.replace(nt[1],nt[2]):tt:nt.length===4&&(this[nt[0]]=yt?nt[3].call(this,yt.replace(nt[1],nt[2])):tt):this[nt]=yt||tt;vn+=2}},cn=function(Nn,Wn){for(var vn in Wn)if(typeof Wn[vn]===et&&Wn[vn].length>0){for(var Rn=0;Rn<Wn[vn].length;Rn++)if(Fn(Wn[vn][Rn],Nn))return vn===it?tt:vn}else if(Fn(Wn[vn],Nn))return vn===it?tt:vn;return Nn},Jn={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Qn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},sr={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[mt,[ht,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[mt,[ht,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[ht,mt],[/opios[\/ ]+([\w\.]+)/i],[mt,[ht,un+" Mini"]],[/\bopr\/([\w\.]+)/i],[mt,[ht,un]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[ht,mt],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[mt,[ht,"UC"+Ht]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[mt,[ht,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[mt,[ht,"WeChat"]],[/konqueror\/([\w\.]+)/i],[mt,[ht,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[mt,[ht,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[mt,[ht,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[ht,/(.+)/,"$1 Secure "+Ht],mt],[/\bfocus\/([\w\.]+)/i],[mt,[ht,gn+" Focus"]],[/\bopt\/([\w\.]+)/i],[mt,[ht,un+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[mt,[ht,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[mt,[ht,"Dolphin"]],[/coast\/([\w\.]+)/i],[mt,[ht,un+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[mt,[ht,"MIUI "+Ht]],[/fxios\/([-\w\.]+)/i],[mt,[ht,gn]],[/\bqihu|(qi?ho?o?|360)browser/i],[[ht,"360 "+Ht]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[ht,/(.+)/,"$1 "+Ht],mt],[/(comodo_dragon)\/([\w\.]+)/i],[[ht,/_/g," "],mt],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[ht,mt],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[ht],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[ht,Mn],mt],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[ht,mt],[/\bgsa\/([\w\.]+) .*safari\//i],[mt,[ht,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[mt,[ht,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[mt,[ht,Wt+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[ht,Wt+" WebView"],mt],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[mt,[ht,"Android "+Ht]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[ht,mt],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[mt,[ht,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[mt,ht],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[ht,[mt,cn,Jn]],[/(webkit|khtml)\/([\w\.]+)/i],[ht,mt],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[ht,"Netscape"],mt],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[mt,[ht,gn+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[ht,mt],[/(cobalt)\/([\w\.]+)/i],[ht,[mt,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[rt,"amd64"]],[/(ia32(?=;))/i],[[rt,dr]],[/((?:i[346]|x)86)[;\)]/i],[[rt,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[rt,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[rt,"armhf"]],[/windows (ce|mobile); ppc;/i],[[rt,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[rt,/ower/,lt,dr]],[/(sun4\w)[;\)]/i],[[rt,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[rt,dr]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[Rt,[ct,mn],[bt,St]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[Rt,[ct,mn],[bt,ft]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[Rt,[ct,Mt],[bt,ft]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[Rt,[ct,Mt],[bt,St]],[/(macintosh);/i],[Rt,[ct,Mt]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[Rt,[ct,yn],[bt,ft]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[Rt,[ct,qt],[bt,St]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[Rt,[ct,qt],[bt,ft]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[Rt,/_/g," "],[ct,In],[bt,ft]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[Rt,/_/g," "],[ct,In],[bt,St]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[Rt,[ct,"OPPO"],[bt,ft]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[Rt,[ct,"Vivo"],[bt,ft]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[Rt,[ct,"Realme"],[bt,ft]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[Rt,[ct,Tn],[bt,ft]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[Rt,[ct,Tn],[bt,St]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[Rt,[ct,fn],[bt,St]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[Rt,[ct,fn],[bt,ft]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[Rt,[ct,"Lenovo"],[bt,St]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[Rt,/_/g," "],[ct,"Nokia"],[bt,ft]],[/(pixel c)\b/i],[Rt,[ct,nn],[bt,St]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[Rt,[ct,nn],[bt,ft]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[Rt,[ct,pn],[bt,ft]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[Rt,"Xperia Tablet"],[ct,pn],[bt,St]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[Rt,[ct,"OnePlus"],[bt,ft]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[Rt,[ct,wt],[bt,St]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[Rt,/(.+)/g,"Fire Phone $1"],[ct,wt],[bt,ft]],[/(playbook);[-\w\),; ]+(rim)/i],[Rt,ct,[bt,St]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[Rt,[ct,Ft],[bt,ft]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[Rt,[ct,vt],[bt,St]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[Rt,[ct,vt],[bt,ft]],[/(nexus 9)/i],[Rt,[ct,"HTC"],[bt,St]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[ct,[Rt,/_/g," "],[bt,ft]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[Rt,[ct,"Acer"],[bt,St]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[Rt,[ct,"Meizu"],[bt,ft]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[ct,Rt,[bt,ft]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[ct,Rt,[bt,St]],[/(surface duo)/i],[Rt,[ct,Cn],[bt,St]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[Rt,[ct,"Fairphone"],[bt,ft]],[/(u304aa)/i],[Rt,[ct,"AT&T"],[bt,ft]],[/\bsie-(\w*)/i],[Rt,[ct,"Siemens"],[bt,ft]],[/\b(rct\w+) b/i],[Rt,[ct,"RCA"],[bt,St]],[/\b(venue[\d ]{2,7}) b/i],[Rt,[ct,"Dell"],[bt,St]],[/\b(q(?:mv|ta)\w+) b/i],[Rt,[ct,"Verizon"],[bt,St]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[Rt,[ct,"Barnes & Noble"],[bt,St]],[/\b(tm\d{3}\w+) b/i],[Rt,[ct,"NuVision"],[bt,St]],[/\b(k88) b/i],[Rt,[ct,"ZTE"],[bt,St]],[/\b(nx\d{3}j) b/i],[Rt,[ct,"ZTE"],[bt,ft]],[/\b(gen\d{3}) b.+49h/i],[Rt,[ct,"Swiss"],[bt,ft]],[/\b(zur\d{3}) b/i],[Rt,[ct,"Swiss"],[bt,St]],[/\b((zeki)?tb.*\b) b/i],[Rt,[ct,"Zeki"],[bt,St]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[ct,"Dragon Touch"],Rt,[bt,St]],[/\b(ns-?\w{0,9}) b/i],[Rt,[ct,"Insignia"],[bt,St]],[/\b((nxa|next)-?\w{0,9}) b/i],[Rt,[ct,"NextBook"],[bt,St]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[ct,"Voice"],Rt,[bt,ft]],[/\b(lvtel\-)?(v1[12]) b/i],[[ct,"LvTel"],Rt,[bt,ft]],[/\b(ph-1) /i],[Rt,[ct,"Essential"],[bt,ft]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[Rt,[ct,"Envizen"],[bt,St]],[/\b(trio[-\w\. ]+) b/i],[Rt,[ct,"MachSpeed"],[bt,St]],[/\btu_(1491) b/i],[Rt,[ct,"Rotor"],[bt,St]],[/(shield[\w ]+) b/i],[Rt,[ct,"Nvidia"],[bt,St]],[/(sprint) (\w+)/i],[ct,Rt,[bt,ft]],[/(kin\.[onetw]{3})/i],[[Rt,/\./g," "],[ct,Cn],[bt,ft]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[Rt,[ct,kn],[bt,St]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[Rt,[ct,kn],[bt,ft]],[/smart-tv.+(samsung)/i],[ct,[bt,It]],[/hbbtv.+maple;(\d+)/i],[[Rt,/^/,"SmartTV"],[ct,mn],[bt,It]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[ct,fn],[bt,It]],[/(apple) ?tv/i],[ct,[Rt,Mt+" TV"],[bt,It]],[/crkey/i],[[Rt,Wt+"cast"],[ct,nn],[bt,It]],[/droid.+aft(\w)( bui|\))/i],[Rt,[ct,wt],[bt,It]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[Rt,[ct,yn],[bt,It]],[/(bravia[\w ]+)( bui|\))/i],[Rt,[ct,pn],[bt,It]],[/(mitv-\w{5}) bui/i],[Rt,[ct,In],[bt,It]],[/Hbbtv.*(technisat) (.*);/i],[ct,Rt,[bt,It]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[ct,Xn],[Rt,Xn],[bt,It]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[bt,It]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[ct,Rt,[bt,pt]],[/droid.+; (shield) bui/i],[Rt,[ct,"Nvidia"],[bt,pt]],[/(playstation [345portablevi]+)/i],[Rt,[ct,pn],[bt,pt]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[Rt,[ct,Cn],[bt,pt]],[/((pebble))app/i],[ct,Rt,[bt,xt]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[Rt,[ct,Mt],[bt,xt]],[/droid.+; (glass) \d/i],[Rt,[ct,nn],[bt,xt]],[/droid.+; (wt63?0{2,3})\)/i],[Rt,[ct,kn],[bt,xt]],[/(quest( 2| pro)?)/i],[Rt,[ct,Mn],[bt,xt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[ct,[bt,At]],[/(aeobc)\b/i],[Rt,[ct,wt],[bt,At]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[Rt,[bt,ft]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[Rt,[bt,St]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[bt,St]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[bt,ft]],[/(android[-\w\. ]{0,9});.+buil/i],[Rt,[ct,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[mt,[ht,tn+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[mt,[ht,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[ht,mt],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[mt,ht]],os:[[/microsoft (windows) (vista|xp)/i],[ht,mt],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[ht,[mt,cn,Qn]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[ht,"Windows"],[mt,cn,Qn]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[mt,/_/g,"."],[ht,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[ht,Pn],[mt,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[mt,ht],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[ht,mt],[/\(bb(10);/i],[mt,[ht,Ft]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[mt,[ht,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[mt,[ht,gn+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[mt,[ht,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[mt,[ht,"watchOS"]],[/crkey\/([\d\.]+)/i],[mt,[ht,Wt+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[ht,xn],mt],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[ht,mt],[/(sunos) ?([\w\.\d]*)/i],[[ht,"Solaris"],mt],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[ht,mt]]},Bn=function(Nn,Wn){if(typeof Nn===et&&(Wn=Nn,Nn=tt),!(this instanceof Bn))return new Bn(Nn,Wn).getResult();var vn=typeof _e!==s&&_e.navigator?_e.navigator:tt,Rn=Nn||(vn&&vn.userAgent?vn.userAgent:lt),Gt=vn&&vn.userAgentData?vn.userAgentData:tt,Tt=Wn?On(sr,Wn):sr,nt=vn&&vn.userAgent==Rn;return this.getBrowser=function(){var Ct={};return Ct[ht]=tt,Ct[mt]=tt,tr.call(Ct,Rn,Tt.browser),Ct[st]=ir(Ct[mt]),nt&&vn&&vn.brave&&typeof vn.brave.isBrave==ut&&(Ct[ht]="Brave"),Ct},this.getCPU=function(){var Ct={};return Ct[rt]=tt,tr.call(Ct,Rn,Tt.cpu),Ct},this.getDevice=function(){var Ct={};return Ct[ct]=tt,Ct[Rt]=tt,Ct[bt]=tt,tr.call(Ct,Rn,Tt.device),nt&&!Ct[bt]&&Gt&&Gt.mobile&&(Ct[bt]=ft),nt&&Ct[Rt]=="Macintosh"&&vn&&typeof vn.standalone!==s&&vn.maxTouchPoints&&vn.maxTouchPoints>2&&(Ct[Rt]="iPad",Ct[bt]=St),Ct},this.getEngine=function(){var Ct={};return Ct[ht]=tt,Ct[mt]=tt,tr.call(Ct,Rn,Tt.engine),Ct},this.getOS=function(){var Ct={};return Ct[ht]=tt,Ct[mt]=tt,tr.call(Ct,Rn,Tt.os),nt&&!Ct[ht]&&Gt&&Gt.platform!="Unknown"&&(Ct[ht]=Gt.platform.replace(/chrome os/i,xn).replace(/macos/i,Pn)),Ct},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Rn},this.setUA=function(Ct){return Rn=typeof Ct===ot&&Ct.length>Dt?Xn(Ct,Dt):Ct,this},this.setUA(Rn),this};Bn.VERSION=at,Bn.BROWSER=Dn([ht,mt,st]),Bn.CPU=Dn([rt]),Bn.DEVICE=Dn([Rt,ct,bt,pt,ft,It,St,xt,At]),Bn.ENGINE=Bn.OS=Dn([ht,mt]),a.exports&&(o=a.exports=Bn),o.UAParser=Bn;var rr=typeof _e!==s&&(_e.jQuery||_e.Zepto);if(rr&&!rr.ua){var nr=new Bn;rr.ua=nr.getResult(),rr.ua.get=function(){return nr.getUA()},rr.ua.set=function(Nn){nr.setUA(Nn);var Wn=nr.getResult();for(var vn in Wn)rr.ua[vn]=Wn[vn]}}})(typeof window=="object"?window:commonjsGlobal)})(uaParser,uaParser.exports);var uaParserExports=uaParser.exports,base64={exports:{}};/*! https://mths.be/base64 v1.0.0 by @mathias | MIT license */base64.exports;(function(a,o){(function(_e){var tt=o,at=a&&a.exports==tt&&a,lt=typeof commonjsGlobal=="object"&&commonjsGlobal;(lt.global===lt||lt.window===lt)&&(_e=lt);var it=function(bt){this.message=bt};it.prototype=new Error,it.prototype.name="InvalidCharacterError";var ut=function(bt){throw new it(bt)},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",et=/[\t\n\f\r ]/g,ot=function(bt){bt=String(bt).replace(et,"");var ct=bt.length;ct%4==0&&(bt=bt.replace(/==?$/,""),ct=bt.length),(ct%4==1||/[^+a-zA-Z0-9/]/.test(bt))&&ut("Invalid character: the string to be decoded is not correctly encoded.");for(var mt=0,rt,pt,ft="",St=-1;++St<ct;)pt=s.indexOf(bt.charAt(St)),rt=mt%4?rt*64+pt:pt,mt++%4&&(ft+=String.fromCharCode(255&rt>>(-2*mt&6)));return ft},st=function(bt){bt=String(bt),/[^\0-\xFF]/.test(bt)&&ut("The string to be encoded contains characters outside of the Latin1 range.");for(var ct=bt.length%3,mt="",rt=-1,pt,ft,St,It,xt=bt.length-ct;++rt<xt;)pt=bt.charCodeAt(rt)<<16,ft=bt.charCodeAt(++rt)<<8,St=bt.charCodeAt(++rt),It=pt+ft+St,mt+=s.charAt(It>>18&63)+s.charAt(It>>12&63)+s.charAt(It>>6&63)+s.charAt(It&63);return ct==2?(pt=bt.charCodeAt(rt)<<8,ft=bt.charCodeAt(++rt),It=pt+ft,mt+=s.charAt(It>>10)+s.charAt(It>>4&63)+s.charAt(It<<2&63)+"="):ct==1&&(It=bt.charCodeAt(rt),mt+=s.charAt(It>>2)+s.charAt(It<<4&63)+"=="),mt},Rt={encode:st,decode:ot,version:"1.0.0"};if(tt&&!tt.nodeType)if(at)at.exports=Rt;else for(var ht in Rt)Rt.hasOwnProperty(ht)&&(tt[ht]=Rt[ht]);else _e.base64=Rt})(commonjsGlobal)})(base64,base64.exports);var base64Exports=base64.exports;function commonjsRequire(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var apiRTC_min={exports:{}};(function(a,o){(function(tt){a.exports=tt()})(function(){return function(){function tt(at,lt,it){function ut(ot,st){if(!lt[ot]){if(!at[ot]){var Rt=typeof commonjsRequire=="function"&&commonjsRequire;if(!st&&Rt)return Rt(ot,!0);if(s)return s(ot,!0);var ht=new Error("Cannot find module '"+ot+"'");throw ht.code="MODULE_NOT_FOUND",ht}var bt=lt[ot]={exports:{}};at[ot][0].call(bt.exports,function(ct){return ut(at[ot][1][ct]||ct)},bt,bt.exports,tt,at,lt,it)}return lt[ot].exports}for(var s=typeof commonjsRequire=="function"&&commonjsRequire,et=0;et<it.length;et++)ut(it[et]);return ut}return tt}()({1:[function(tt,at,lt){var it=(0,tt("./adapter_factory.js").adapterFactory)({window});at.exports=it},{"./adapter_factory.js":2}],2:[function(tt,at,lt){function it(ht){if(ht&&ht.__esModule)return ht;var bt={};if(ht!=null)for(var ct in ht)Object.prototype.hasOwnProperty.call(ht,ct)&&(bt[ct]=ht[ct]);return bt.default=ht,bt}Object.defineProperty(lt,"__esModule",{value:!0}),lt.adapterFactory=function(){var ht=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).window,bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},ct=ut.log,mt=ut.detectBrowser(ht),rt={browserDetails:mt,commonShim:Rt,extractVersion:ut.extractVersion,disableLog:ut.disableLog,disableWarnings:ut.disableWarnings};switch(mt.browser){case"chrome":if(!s||!s.shimPeerConnection||!bt.shimChrome)return ct("Chrome shim is not included in this adapter release."),rt;ct("adapter.js shimming chrome."),rt.browserShim=s,s.shimGetUserMedia(ht),s.shimMediaStream(ht),s.shimPeerConnection(ht),s.shimOnTrack(ht),s.shimAddTrackRemoveTrack(ht),s.shimGetSendersWithDtmf(ht),s.shimGetStats(ht),s.shimSenderReceiverGetStats(ht),s.fixNegotiationNeeded(ht),Rt.shimRTCIceCandidate(ht),Rt.shimConnectionState(ht),Rt.shimMaxMessageSize(ht),Rt.shimSendThrowTypeError(ht),Rt.removeAllowExtmapMixed(ht);break;case"firefox":if(!ot||!ot.shimPeerConnection||!bt.shimFirefox)return ct("Firefox shim is not included in this adapter release."),rt;ct("adapter.js shimming firefox."),rt.browserShim=ot,ot.shimGetUserMedia(ht),ot.shimPeerConnection(ht),ot.shimOnTrack(ht),ot.shimRemoveStream(ht),ot.shimSenderGetStats(ht),ot.shimReceiverGetStats(ht),ot.shimRTCDataChannel(ht),Rt.shimRTCIceCandidate(ht),Rt.shimConnectionState(ht),Rt.shimMaxMessageSize(ht),Rt.shimSendThrowTypeError(ht);break;case"edge":if(!et||!et.shimPeerConnection||!bt.shimEdge)return ct("MS edge shim is not included in this adapter release."),rt;ct("adapter.js shimming edge."),rt.browserShim=et,et.shimGetUserMedia(ht),et.shimGetDisplayMedia(ht),et.shimPeerConnection(ht),et.shimReplaceTrack(ht),Rt.shimMaxMessageSize(ht),Rt.shimSendThrowTypeError(ht);break;case"safari":if(!st||!bt.shimSafari)return ct("Safari shim is not included in this adapter release."),rt;ct("adapter.js shimming safari."),rt.browserShim=st,st.shimRTCIceServerUrls(ht),st.shimCreateOfferLegacy(ht),st.shimCallbacksAPI(ht),st.shimLocalStreamsAPI(ht),st.shimRemoteStreamsAPI(ht),st.shimTrackEventTransceiver(ht),st.shimGetUserMedia(ht),Rt.shimRTCIceCandidate(ht),Rt.shimMaxMessageSize(ht),Rt.shimSendThrowTypeError(ht),Rt.removeAllowExtmapMixed(ht);break;default:ct("Unsupported browser!")}return rt};var ut=it(tt("./utils")),s=it(tt("./chrome/chrome_shim")),et=it(tt("./edge/edge_shim")),ot=it(tt("./firefox/firefox_shim")),st=it(tt("./safari/safari_shim")),Rt=it(tt("./common_shim"))},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(tt,at,lt){function it(st){st.RTCPeerConnection.prototype.getLocalStreams=function(){var mt=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(rt){return mt._shimmedLocalStreams[rt][0]})};var Rt=st.RTCPeerConnection.prototype.addTrack;st.RTCPeerConnection.prototype.addTrack=function(mt,rt){if(!rt)return Rt.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var pt=Rt.apply(this,arguments);return this._shimmedLocalStreams[rt.id]?this._shimmedLocalStreams[rt.id].indexOf(pt)===-1&&this._shimmedLocalStreams[rt.id].push(pt):this._shimmedLocalStreams[rt.id]=[rt,pt],pt};var ht=st.RTCPeerConnection.prototype.addStream;st.RTCPeerConnection.prototype.addStream=function(mt){var rt=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},mt.getTracks().forEach(function(St){if(rt.getSenders().find(function(It){return It.track===St}))throw new DOMException("Track already exists.","InvalidAccessError")});var pt=this.getSenders();ht.apply(this,arguments);var ft=this.getSenders().filter(function(St){return pt.indexOf(St)===-1});this._shimmedLocalStreams[mt.id]=[mt].concat(ft)};var bt=st.RTCPeerConnection.prototype.removeStream;st.RTCPeerConnection.prototype.removeStream=function(mt){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[mt.id],bt.apply(this,arguments)};var ct=st.RTCPeerConnection.prototype.removeTrack;st.RTCPeerConnection.prototype.removeTrack=function(mt){var rt=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},mt&&Object.keys(this._shimmedLocalStreams).forEach(function(pt){var ft=rt._shimmedLocalStreams[pt].indexOf(mt);ft!==-1&&rt._shimmedLocalStreams[pt].splice(ft,1),rt._shimmedLocalStreams[pt].length===1&&delete rt._shimmedLocalStreams[pt]}),ct.apply(this,arguments)}}Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=lt.shimGetUserMedia=void 0;var ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(st){return typeof st}:function(st){return st&&typeof Symbol=="function"&&st.constructor===Symbol&&st!==Symbol.prototype?"symbol":typeof st},s=tt("./getusermedia");Object.defineProperty(lt,"shimGetUserMedia",{enumerable:!0,get:function(){return s.shimGetUserMedia}});var et=tt("./getdisplaymedia");Object.defineProperty(lt,"shimGetDisplayMedia",{enumerable:!0,get:function(){return et.shimGetDisplayMedia}}),lt.shimMediaStream=function(st){st.MediaStream=st.MediaStream||st.webkitMediaStream},lt.shimOnTrack=function(st){if((st===void 0?"undefined":ut(st))!=="object"||!st.RTCPeerConnection||"ontrack"in st.RTCPeerConnection.prototype)ot.wrapPeerConnectionEvent(st,"track",function(ht){return ht.transceiver||Object.defineProperty(ht,"transceiver",{value:{receiver:ht.receiver}}),ht});else{Object.defineProperty(st.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(ht){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=ht)},enumerable:!0,configurable:!0});var Rt=st.RTCPeerConnection.prototype.setRemoteDescription;st.RTCPeerConnection.prototype.setRemoteDescription=function(){var ht=this;return this._ontrackpoly||(this._ontrackpoly=function(bt){bt.stream.addEventListener("addtrack",function(ct){var mt=void 0;mt=st.RTCPeerConnection.prototype.getReceivers?ht.getReceivers().find(function(pt){return pt.track&&pt.track.id===ct.track.id}):{track:ct.track};var rt=new Event("track");rt.track=ct.track,rt.receiver=mt,rt.transceiver={receiver:mt},rt.streams=[bt.stream],ht.dispatchEvent(rt)}),bt.stream.getTracks().forEach(function(ct){var mt=void 0;mt=st.RTCPeerConnection.prototype.getReceivers?ht.getReceivers().find(function(pt){return pt.track&&pt.track.id===ct.id}):{track:ct};var rt=new Event("track");rt.track=ct,rt.receiver=mt,rt.transceiver={receiver:mt},rt.streams=[bt.stream],ht.dispatchEvent(rt)})},this.addEventListener("addstream",this._ontrackpoly)),Rt.apply(this,arguments)}}},lt.shimGetSendersWithDtmf=function(st){if((st===void 0?"undefined":ut(st))==="object"&&st.RTCPeerConnection&&!("getSenders"in st.RTCPeerConnection.prototype)&&"createDTMFSender"in st.RTCPeerConnection.prototype){var Rt=function(pt,ft){return{track:ft,get dtmf(){return this._dtmf===void 0&&(ft.kind==="audio"?this._dtmf=pt.createDTMFSender(ft):this._dtmf=null),this._dtmf},_pc:pt}};if(!st.RTCPeerConnection.prototype.getSenders){st.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var ht=st.RTCPeerConnection.prototype.addTrack;st.RTCPeerConnection.prototype.addTrack=function(pt,ft){var St=ht.apply(this,arguments);return St||(St=Rt(this,pt),this._senders.push(St)),St};var bt=st.RTCPeerConnection.prototype.removeTrack;st.RTCPeerConnection.prototype.removeTrack=function(pt){bt.apply(this,arguments);var ft=this._senders.indexOf(pt);ft!==-1&&this._senders.splice(ft,1)}}var ct=st.RTCPeerConnection.prototype.addStream;st.RTCPeerConnection.prototype.addStream=function(pt){var ft=this;this._senders=this._senders||[],ct.apply(this,[pt]),pt.getTracks().forEach(function(St){ft._senders.push(Rt(ft,St))})};var mt=st.RTCPeerConnection.prototype.removeStream;st.RTCPeerConnection.prototype.removeStream=function(pt){var ft=this;this._senders=this._senders||[],mt.apply(this,[pt]),pt.getTracks().forEach(function(St){var It=ft._senders.find(function(xt){return xt.track===St});It&&ft._senders.splice(ft._senders.indexOf(It),1)})}}else if((st===void 0?"undefined":ut(st))==="object"&&st.RTCPeerConnection&&"getSenders"in st.RTCPeerConnection.prototype&&"createDTMFSender"in st.RTCPeerConnection.prototype&&st.RTCRtpSender&&!("dtmf"in st.RTCRtpSender.prototype)){var rt=st.RTCPeerConnection.prototype.getSenders;st.RTCPeerConnection.prototype.getSenders=function(){var pt=this,ft=rt.apply(this,[]);return ft.forEach(function(St){return St._pc=pt}),ft},Object.defineProperty(st.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},lt.shimGetStats=function(st){if(st.RTCPeerConnection){var Rt=st.RTCPeerConnection.prototype.getStats;st.RTCPeerConnection.prototype.getStats=function(ht,bt,ct){var mt=this,rt=arguments;if(arguments.length>0&&typeof ht=="function")return Rt.apply(this,arguments);if(Rt.length===0&&(arguments.length===0||typeof arguments[0]!="function"))return Rt.apply(this,[]);var pt=function(It){var xt={};return It.result().forEach(function(At){var Dt={id:At.id,timestamp:At.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[At.type]||At.type};At.names().forEach(function(wt){Dt[wt]=At.stat(wt)}),xt[Dt.id]=Dt}),xt},ft=function(It){return new Map(Object.keys(It).map(function(xt){return[xt,It[xt]]}))};if(arguments.length>=2){var St=function(It){rt[1](ft(pt(It)))};return Rt.apply(this,[St,arguments[0]])}return new Promise(function(It,xt){Rt.apply(mt,[function(At){It(ft(pt(At)))},xt])}).then(bt,ct)}}},lt.shimSenderReceiverGetStats=function(st){if((st===void 0?"undefined":ut(st))==="object"&&st.RTCPeerConnection&&st.RTCRtpSender&&st.RTCRtpReceiver){if(!("getStats"in st.RTCRtpSender.prototype)){var Rt=st.RTCPeerConnection.prototype.getSenders;Rt&&(st.RTCPeerConnection.prototype.getSenders=function(){var mt=this,rt=Rt.apply(this,[]);return rt.forEach(function(pt){return pt._pc=mt}),rt});var ht=st.RTCPeerConnection.prototype.addTrack;ht&&(st.RTCPeerConnection.prototype.addTrack=function(){var mt=ht.apply(this,arguments);return mt._pc=this,mt}),st.RTCRtpSender.prototype.getStats=function(){var mt=this;return this._pc.getStats().then(function(rt){return ot.filterStats(rt,mt.track,!0)})}}if(!("getStats"in st.RTCRtpReceiver.prototype)){var bt=st.RTCPeerConnection.prototype.getReceivers;bt&&(st.RTCPeerConnection.prototype.getReceivers=function(){var mt=this,rt=bt.apply(this,[]);return rt.forEach(function(pt){return pt._pc=mt}),rt}),ot.wrapPeerConnectionEvent(st,"track",function(mt){return mt.receiver._pc=mt.srcElement,mt}),st.RTCRtpReceiver.prototype.getStats=function(){var mt=this;return this._pc.getStats().then(function(rt){return ot.filterStats(rt,mt.track,!1)})}}if("getStats"in st.RTCRtpSender.prototype&&"getStats"in st.RTCRtpReceiver.prototype){var ct=st.RTCPeerConnection.prototype.getStats;st.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof st.MediaStreamTrack){var mt=arguments[0],rt=void 0,pt=void 0,ft=void 0;return this.getSenders().forEach(function(St){St.track===mt&&(rt?ft=!0:rt=St)}),this.getReceivers().forEach(function(St){return St.track===mt&&(pt?ft=!0:pt=St),St.track===mt}),ft||rt&&pt?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):rt?rt.getStats():pt?pt.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return ct.apply(this,arguments)}}}},lt.shimAddTrackRemoveTrackWithNative=it,lt.shimAddTrackRemoveTrack=function(st){function Rt(St,It){var xt=It.sdp;return Object.keys(St._reverseStreams||[]).forEach(function(At){var Dt=St._reverseStreams[At],wt=St._streams[Dt.id];xt=xt.replace(new RegExp(wt.id,"g"),Dt.id)}),new RTCSessionDescription({type:It.type,sdp:xt})}function ht(St,It){var xt=It.sdp;return Object.keys(St._reverseStreams||[]).forEach(function(At){var Dt=St._reverseStreams[At],wt=St._streams[Dt.id];xt=xt.replace(new RegExp(Dt.id,"g"),wt.id)}),new RTCSessionDescription({type:It.type,sdp:xt})}if(st.RTCPeerConnection){var bt=ot.detectBrowser(st);if(st.RTCPeerConnection.prototype.addTrack&&bt.version>=65)return it(st);var ct=st.RTCPeerConnection.prototype.getLocalStreams;st.RTCPeerConnection.prototype.getLocalStreams=function(){var St=this,It=ct.apply(this);return this._reverseStreams=this._reverseStreams||{},It.map(function(xt){return St._reverseStreams[xt.id]})};var mt=st.RTCPeerConnection.prototype.addStream;st.RTCPeerConnection.prototype.addStream=function(St){var It=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},St.getTracks().forEach(function(At){if(It.getSenders().find(function(Dt){return Dt.track===At}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[St.id]){var xt=new st.MediaStream(St.getTracks());this._streams[St.id]=xt,this._reverseStreams[xt.id]=St,St=xt}mt.apply(this,[St])};var rt=st.RTCPeerConnection.prototype.removeStream;st.RTCPeerConnection.prototype.removeStream=function(St){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},rt.apply(this,[this._streams[St.id]||St]),delete this._reverseStreams[this._streams[St.id]?this._streams[St.id].id:St.id],delete this._streams[St.id]},st.RTCPeerConnection.prototype.addTrack=function(St,It){var xt=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var At=[].slice.call(arguments,1);if(At.length!==1||!At[0].getTracks().find(function(Mt){return Mt===St}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(Mt){return Mt.track===St}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var Dt=this._streams[It.id];if(Dt)Dt.addTrack(St),Promise.resolve().then(function(){xt.dispatchEvent(new Event("negotiationneeded"))});else{var wt=new st.MediaStream([St]);this._streams[It.id]=wt,this._reverseStreams[wt.id]=It,this.addStream(wt)}return this.getSenders().find(function(Mt){return Mt.track===St})},["createOffer","createAnswer"].forEach(function(St){var It=st.RTCPeerConnection.prototype[St];st.RTCPeerConnection.prototype[St]=function(){var xt=this,At=arguments;return arguments.length&&typeof arguments[0]=="function"?It.apply(this,[function(Dt){var wt=Rt(xt,Dt);At[0].apply(null,[wt])},function(Dt){At[1]&&At[1].apply(null,Dt)},arguments[2]]):It.apply(this,arguments).then(function(Dt){return Rt(xt,Dt)})}});var pt=st.RTCPeerConnection.prototype.setLocalDescription;st.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=ht(this,arguments[0]),pt.apply(this,arguments)):pt.apply(this,arguments)};var ft=Object.getOwnPropertyDescriptor(st.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(st.RTCPeerConnection.prototype,"localDescription",{get:function(){var St=ft.get.apply(this);return St.type===""?St:Rt(this,St)}}),st.RTCPeerConnection.prototype.removeTrack=function(St){var It=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!St._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(St._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var xt=void 0;Object.keys(this._streams).forEach(function(At){It._streams[At].getTracks().find(function(Dt){return St.track===Dt})&&(xt=It._streams[At])}),xt&&(xt.getTracks().length===1?this.removeStream(this._reverseStreams[xt.id]):xt.removeTrack(St.track),this.dispatchEvent(new Event("negotiationneeded")))}}},lt.shimPeerConnection=function(st){if(!st.RTCPeerConnection&&st.webkitRTCPeerConnection&&(st.RTCPeerConnection=st.webkitRTCPeerConnection),st.RTCPeerConnection){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(ht){var bt=st.RTCPeerConnection.prototype[ht];st.RTCPeerConnection.prototype[ht]=function(){return arguments[0]=new(ht==="addIceCandidate"?st.RTCIceCandidate:st.RTCSessionDescription)(arguments[0]),bt.apply(this,arguments)}});var Rt=st.RTCPeerConnection.prototype.addIceCandidate;st.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?Rt.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},lt.fixNegotiationNeeded=function(st){ot.wrapPeerConnectionEvent(st,"negotiationneeded",function(Rt){if(Rt.target.signalingState==="stable")return Rt})};var ot=function(st){if(st&&st.__esModule)return st;var Rt={};if(st!=null)for(var ht in st)Object.prototype.hasOwnProperty.call(st,ht)&&(Rt[ht]=st[ht]);return Rt.default=st,Rt}(tt("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=function(it,ut){it.navigator.mediaDevices&&"getDisplayMedia"in it.navigator.mediaDevices||it.navigator.mediaDevices&&(typeof ut=="function"?it.navigator.mediaDevices.getDisplayMedia=function(s){return ut(s).then(function(et){var ot=s.video&&s.video.width,st=s.video&&s.video.height,Rt=s.video&&s.video.frameRate;return s.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:et,maxFrameRate:Rt||3}},ot&&(s.video.mandatory.maxWidth=ot),st&&(s.video.mandatory.maxHeight=st),it.navigator.mediaDevices.getUserMedia(s)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],5:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0});var it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et};lt.shimGetUserMedia=function(et){var ot=et&&et.navigator;if(ot.mediaDevices){var st=ut.detectBrowser(et),Rt=function(mt){if((mt===void 0?"undefined":it(mt))!=="object"||mt.mandatory||mt.optional)return mt;var rt={};return Object.keys(mt).forEach(function(pt){if(pt!=="require"&&pt!=="advanced"&&pt!=="mediaSource"){var ft=it(mt[pt])==="object"?mt[pt]:{ideal:mt[pt]};ft.exact!==void 0&&typeof ft.exact=="number"&&(ft.min=ft.max=ft.exact);var St=function(xt,At){return xt?xt+At.charAt(0).toUpperCase()+At.slice(1):At==="deviceId"?"sourceId":At};if(ft.ideal!==void 0){rt.optional=rt.optional||[];var It={};typeof ft.ideal=="number"?(It[St("min",pt)]=ft.ideal,rt.optional.push(It),(It={})[St("max",pt)]=ft.ideal,rt.optional.push(It)):(It[St("",pt)]=ft.ideal,rt.optional.push(It))}ft.exact!==void 0&&typeof ft.exact!="number"?(rt.mandatory=rt.mandatory||{},rt.mandatory[St("",pt)]=ft.exact):["min","max"].forEach(function(xt){ft[xt]!==void 0&&(rt.mandatory=rt.mandatory||{},rt.mandatory[St(xt,pt)]=ft[xt])})}}),mt.advanced&&(rt.optional=(rt.optional||[]).concat(mt.advanced)),rt},ht=function(mt,rt){if(st.version>=61)return rt(mt);if((mt=JSON.parse(JSON.stringify(mt)))&&it(mt.audio)==="object"){var pt=function(xt,At,Dt){At in xt&&!(Dt in xt)&&(xt[Dt]=xt[At],delete xt[At])};pt((mt=JSON.parse(JSON.stringify(mt))).audio,"autoGainControl","googAutoGainControl"),pt(mt.audio,"noiseSuppression","googNoiseSuppression"),mt.audio=Rt(mt.audio)}if(mt&&it(mt.video)==="object"){var ft=mt.video.facingMode;ft=ft&&((ft===void 0?"undefined":it(ft))==="object"?ft:{ideal:ft});var St=st.version<66;if(ft&&(ft.exact==="user"||ft.exact==="environment"||ft.ideal==="user"||ft.ideal==="environment")&&(!ot.mediaDevices.getSupportedConstraints||!ot.mediaDevices.getSupportedConstraints().facingMode||St)){delete mt.video.facingMode;var It=void 0;if(ft.exact==="environment"||ft.ideal==="environment"?It=["back","rear"]:ft.exact!=="user"&&ft.ideal!=="user"||(It=["front"]),It)return ot.mediaDevices.enumerateDevices().then(function(xt){var At=(xt=xt.filter(function(Dt){return Dt.kind==="videoinput"})).find(function(Dt){return It.some(function(wt){return Dt.label.toLowerCase().includes(wt)})});return!At&&xt.length&&It.includes("back")&&(At=xt[xt.length-1]),At&&(mt.video.deviceId=ft.exact?{exact:At.deviceId}:{ideal:At.deviceId}),mt.video=Rt(mt.video),s("chrome: "+JSON.stringify(mt)),rt(mt)})}mt.video=Rt(mt.video)}return s("chrome: "+JSON.stringify(mt)),rt(mt)},bt=function(mt){return st.version>=64?mt:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[mt.name]||mt.name,message:mt.message,constraint:mt.constraint||mt.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(ot.getUserMedia=(function(mt,rt,pt){ht(mt,function(ft){ot.webkitGetUserMedia(ft,rt,function(St){pt&&pt(bt(St))})})}).bind(ot),ot.mediaDevices.getUserMedia){var ct=ot.mediaDevices.getUserMedia.bind(ot.mediaDevices);ot.mediaDevices.getUserMedia=function(mt){return ht(mt,function(rt){return ct(rt).then(function(pt){if(rt.audio&&!pt.getAudioTracks().length||rt.video&&!pt.getVideoTracks().length)throw pt.getTracks().forEach(function(ft){ft.stop()}),new DOMException("","NotFoundError");return pt},function(pt){return Promise.reject(bt(pt))})})}}}};var ut=function(et){if(et&&et.__esModule)return et;var ot={};if(et!=null)for(var st in et)Object.prototype.hasOwnProperty.call(et,st)&&(ot[st]=et[st]);return ot.default=et,ot}(tt("../utils.js")),s=ut.log},{"../utils.js":15}],6:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0});var it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et};lt.shimRTCIceCandidate=function(et){if(et.RTCIceCandidate&&!(et.RTCIceCandidate&&"foundation"in et.RTCIceCandidate.prototype)){var ot=et.RTCIceCandidate;et.RTCIceCandidate=function(st){if((st===void 0?"undefined":it(st))==="object"&&st.candidate&&st.candidate.indexOf("a=")===0&&((st=JSON.parse(JSON.stringify(st))).candidate=st.candidate.substr(2)),st.candidate&&st.candidate.length){var Rt=new ot(st),ht=ut.default.parseCandidate(st.candidate),bt=Object.assign(Rt,ht);return bt.toJSON=function(){return{candidate:bt.candidate,sdpMid:bt.sdpMid,sdpMLineIndex:bt.sdpMLineIndex,usernameFragment:bt.usernameFragment}},bt}return new ot(st)},et.RTCIceCandidate.prototype=ot.prototype,s.wrapPeerConnectionEvent(et,"icecandidate",function(st){return st.candidate&&Object.defineProperty(st,"candidate",{value:new et.RTCIceCandidate(st.candidate),writable:"false"}),st})}},lt.shimMaxMessageSize=function(et){if(!et.RTCSctpTransport&&et.RTCPeerConnection){var ot=s.detectBrowser(et);"sctp"in et.RTCPeerConnection.prototype||Object.defineProperty(et.RTCPeerConnection.prototype,"sctp",{get:function(){return this._sctp===void 0?null:this._sctp}});var st=function(mt){if(!mt||!mt.sdp)return!1;var rt=ut.default.splitSections(mt.sdp);return rt.shift(),rt.some(function(pt){var ft=ut.default.parseMLine(pt);return ft&&ft.kind==="application"&&ft.protocol.indexOf("SCTP")!==-1})},Rt=function(mt){var rt=mt.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(rt===null||rt.length<2)return-1;var pt=parseInt(rt[1],10);return pt!==pt?-1:pt},ht=function(mt){var rt=65536;return ot.browser==="firefox"&&(rt=ot.version<57?mt===-1?16384:2147483637:ot.version<60?ot.version===57?65535:65536:2147483637),rt},bt=function(mt,rt){var pt=65536;ot.browser==="firefox"&&ot.version===57&&(pt=65535);var ft=ut.default.matchPrefix(mt.sdp,"a=max-message-size:");return ft.length>0?pt=parseInt(ft[0].substr(19),10):ot.browser==="firefox"&&rt!==-1&&(pt=2147483637),pt},ct=et.RTCPeerConnection.prototype.setRemoteDescription;et.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,st(arguments[0])){var mt=Rt(arguments[0]),rt=ht(mt),pt=bt(arguments[0],mt),ft=void 0;ft=rt===0&&pt===0?Number.POSITIVE_INFINITY:rt===0||pt===0?Math.max(rt,pt):Math.min(rt,pt);var St={};Object.defineProperty(St,"maxMessageSize",{get:function(){return ft}}),this._sctp=St}return ct.apply(this,arguments)}}},lt.shimSendThrowTypeError=function(et){function ot(Rt,ht){var bt=Rt.send;Rt.send=function(){var ct=arguments[0],mt=ct.length||ct.size||ct.byteLength;if(Rt.readyState==="open"&&ht.sctp&&mt>ht.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+ht.sctp.maxMessageSize+" bytes)");return bt.apply(Rt,arguments)}}if(et.RTCPeerConnection&&"createDataChannel"in et.RTCPeerConnection.prototype){var st=et.RTCPeerConnection.prototype.createDataChannel;et.RTCPeerConnection.prototype.createDataChannel=function(){var Rt=st.apply(this,arguments);return ot(Rt,this),Rt},s.wrapPeerConnectionEvent(et,"datachannel",function(Rt){return ot(Rt.channel,Rt.target),Rt})}},lt.shimConnectionState=function(et){if(et.RTCPeerConnection&&!("connectionState"in et.RTCPeerConnection.prototype)){var ot=et.RTCPeerConnection.prototype;Object.defineProperty(ot,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(ot,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(st){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),st&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=st)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(st){var Rt=ot[st];ot[st]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(ht){var bt=ht.target;if(bt._lastConnectionState!==bt.connectionState){bt._lastConnectionState=bt.connectionState;var ct=new Event("connectionstatechange",ht);bt.dispatchEvent(ct)}return ht},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),Rt.apply(this,arguments)}})}},lt.removeAllowExtmapMixed=function(et){if(et.RTCPeerConnection){var ot=s.detectBrowser(et);if(!(ot.browser==="chrome"&&ot.version>=71||ot.browser==="safari"&&ot.version>=605)){var st=et.RTCPeerConnection.prototype.setRemoteDescription;et.RTCPeerConnection.prototype.setRemoteDescription=function(Rt){return Rt&&Rt.sdp&&Rt.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1&&(Rt.sdp=Rt.sdp.split(`
`).filter(function(ht){return ht.trim()!=="a=extmap-allow-mixed"}).join(`
`)),st.apply(this,arguments)}}}};var ut=function(et){return et&&et.__esModule?et:{default:et}}(tt("sdp")),s=function(et){if(et&&et.__esModule)return et;var ot={};if(et!=null)for(var st in et)Object.prototype.hasOwnProperty.call(et,st)&&(ot[st]=et[st]);return ot.default=et,ot}(tt("./utils"))},{"./utils":15,sdp:17}],7:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=lt.shimGetUserMedia=void 0;var it=tt("./getusermedia");Object.defineProperty(lt,"shimGetUserMedia",{enumerable:!0,get:function(){return it.shimGetUserMedia}});var ut=tt("./getdisplaymedia");Object.defineProperty(lt,"shimGetDisplayMedia",{enumerable:!0,get:function(){return ut.shimGetDisplayMedia}}),lt.shimPeerConnection=function(st){var Rt=s.detectBrowser(st);if(st.RTCIceGatherer&&(st.RTCIceCandidate||(st.RTCIceCandidate=function(ct){return ct}),st.RTCSessionDescription||(st.RTCSessionDescription=function(ct){return ct}),Rt.version<15025)){var ht=Object.getOwnPropertyDescriptor(st.MediaStreamTrack.prototype,"enabled");Object.defineProperty(st.MediaStreamTrack.prototype,"enabled",{set:function(ct){ht.set.call(this,ct);var mt=new Event("enabled");mt.enabled=ct,this.dispatchEvent(mt)}})}!st.RTCRtpSender||"dtmf"in st.RTCRtpSender.prototype||Object.defineProperty(st.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new st.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),st.RTCDtmfSender&&!st.RTCDTMFSender&&(st.RTCDTMFSender=st.RTCDtmfSender);var bt=(0,ot.default)(st,Rt.version);st.RTCPeerConnection=function(ct){return ct&&ct.iceServers&&(ct.iceServers=(0,et.filterIceServers)(ct.iceServers,Rt.version),s.log("ICE servers after filtering:",ct.iceServers)),new bt(ct)},st.RTCPeerConnection.prototype=bt.prototype},lt.shimReplaceTrack=function(st){!st.RTCRtpSender||"replaceTrack"in st.RTCRtpSender.prototype||(st.RTCRtpSender.prototype.replaceTrack=st.RTCRtpSender.prototype.setTrack)};var s=function(st){if(st&&st.__esModule)return st;var Rt={};if(st!=null)for(var ht in st)Object.prototype.hasOwnProperty.call(st,ht)&&(Rt[ht]=st[ht]);return Rt.default=st,Rt}(tt("../utils")),et=tt("./filtericeservers"),ot=function(st){return st&&st.__esModule?st:{default:st}}(tt("rtcpeerconnection-shim"))},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.filterIceServers=function(ut,s){var et=!1;return(ut=JSON.parse(JSON.stringify(ut))).filter(function(ot){if(ot&&(ot.urls||ot.url)){var st=ot.urls||ot.url;ot.url&&!ot.urls&&it.deprecated("RTCIceServer.url","RTCIceServer.urls");var Rt=typeof st=="string";return Rt&&(st=[st]),st=st.filter(function(ht){if(ht.indexOf("stun:")===0)return!1;var bt=ht.startsWith("turn")&&!ht.startsWith("turn:[")&&ht.includes("transport=udp");return bt&&!et?(et=!0,!0):bt&&!et}),delete ot.url,ot.urls=Rt?st[0]:st,!!st.length}})};var it=function(ut){if(ut&&ut.__esModule)return ut;var s={};if(ut!=null)for(var et in ut)Object.prototype.hasOwnProperty.call(ut,et)&&(s[et]=ut[et]);return s.default=ut,s}(tt("../utils"))},{"../utils":15}],9:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=function(it){"getDisplayMedia"in it.navigator&&it.navigator.mediaDevices&&(it.navigator.mediaDevices&&"getDisplayMedia"in it.navigator.mediaDevices||(it.navigator.mediaDevices.getDisplayMedia=it.navigator.getDisplayMedia.bind(it.navigator)))}},{}],10:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetUserMedia=function(it){var ut=it&&it.navigator,s=function(ot){return{name:{PermissionDeniedError:"NotAllowedError"}[ot.name]||ot.name,message:ot.message,constraint:ot.constraint,toString:function(){return this.name}}},et=ut.mediaDevices.getUserMedia.bind(ut.mediaDevices);ut.mediaDevices.getUserMedia=function(ot){return et(ot).catch(function(st){return Promise.reject(s(st))})}}},{}],11:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=lt.shimGetUserMedia=void 0;var it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ot){return typeof ot}:function(ot){return ot&&typeof Symbol=="function"&&ot.constructor===Symbol&&ot!==Symbol.prototype?"symbol":typeof ot},ut=tt("./getusermedia");Object.defineProperty(lt,"shimGetUserMedia",{enumerable:!0,get:function(){return ut.shimGetUserMedia}});var s=tt("./getdisplaymedia");Object.defineProperty(lt,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}}),lt.shimOnTrack=function(ot){(ot===void 0?"undefined":it(ot))==="object"&&ot.RTCTrackEvent&&"receiver"in ot.RTCTrackEvent.prototype&&!("transceiver"in ot.RTCTrackEvent.prototype)&&Object.defineProperty(ot.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},lt.shimPeerConnection=function(ot){var st=et.detectBrowser(ot);if((ot===void 0?"undefined":it(ot))==="object"&&(ot.RTCPeerConnection||ot.mozRTCPeerConnection)){!ot.RTCPeerConnection&&ot.mozRTCPeerConnection&&(ot.RTCPeerConnection=ot.mozRTCPeerConnection),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(ct){var mt=ot.RTCPeerConnection.prototype[ct];ot.RTCPeerConnection.prototype[ct]=function(){return arguments[0]=new(ct==="addIceCandidate"?ot.RTCIceCandidate:ot.RTCSessionDescription)(arguments[0]),mt.apply(this,arguments)}});var Rt=ot.RTCPeerConnection.prototype.addIceCandidate;ot.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?Rt.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var ht={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},bt=ot.RTCPeerConnection.prototype.getStats;ot.RTCPeerConnection.prototype.getStats=function(ct,mt,rt){return bt.apply(this,[ct||null]).then(function(pt){if(st.version<53&&!mt)try{pt.forEach(function(ft){ft.type=ht[ft.type]||ft.type})}catch(ft){if(ft.name!=="TypeError")throw ft;pt.forEach(function(St,It){pt.set(It,Object.assign({},St,{type:ht[St.type]||St.type}))})}return pt}).then(mt,rt)}}},lt.shimSenderGetStats=function(ot){if((ot===void 0?"undefined":it(ot))==="object"&&ot.RTCPeerConnection&&ot.RTCRtpSender&&!(ot.RTCRtpSender&&"getStats"in ot.RTCRtpSender.prototype)){var st=ot.RTCPeerConnection.prototype.getSenders;st&&(ot.RTCPeerConnection.prototype.getSenders=function(){var ht=this,bt=st.apply(this,[]);return bt.forEach(function(ct){return ct._pc=ht}),bt});var Rt=ot.RTCPeerConnection.prototype.addTrack;Rt&&(ot.RTCPeerConnection.prototype.addTrack=function(){var ht=Rt.apply(this,arguments);return ht._pc=this,ht}),ot.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},lt.shimReceiverGetStats=function(ot){if((ot===void 0?"undefined":it(ot))==="object"&&ot.RTCPeerConnection&&ot.RTCRtpSender&&!(ot.RTCRtpSender&&"getStats"in ot.RTCRtpReceiver.prototype)){var st=ot.RTCPeerConnection.prototype.getReceivers;st&&(ot.RTCPeerConnection.prototype.getReceivers=function(){var Rt=this,ht=st.apply(this,[]);return ht.forEach(function(bt){return bt._pc=Rt}),ht}),et.wrapPeerConnectionEvent(ot,"track",function(Rt){return Rt.receiver._pc=Rt.srcElement,Rt}),ot.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},lt.shimRemoveStream=function(ot){!ot.RTCPeerConnection||"removeStream"in ot.RTCPeerConnection.prototype||(ot.RTCPeerConnection.prototype.removeStream=function(st){var Rt=this;et.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(ht){ht.track&&st.getTracks().includes(ht.track)&&Rt.removeTrack(ht)})})},lt.shimRTCDataChannel=function(ot){ot.DataChannel&&!ot.RTCDataChannel&&(ot.RTCDataChannel=ot.DataChannel)};var et=function(ot){if(ot&&ot.__esModule)return ot;var st={};if(ot!=null)for(var Rt in ot)Object.prototype.hasOwnProperty.call(ot,Rt)&&(st[Rt]=ot[Rt]);return st.default=ot,st}(tt("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=function(it,ut){it.navigator.mediaDevices&&"getDisplayMedia"in it.navigator.mediaDevices||it.navigator.mediaDevices&&(it.navigator.mediaDevices.getDisplayMedia=function(s){if(!s||!s.video){var et=new DOMException("getDisplayMedia without video constraints is undefined");return et.name="NotFoundError",et.code=8,Promise.reject(et)}return s.video===!0?s.video={mediaSource:ut}:s.video.mediaSource=ut,it.navigator.mediaDevices.getUserMedia(s)})}},{}],13:[function(tt,at,lt){Object.defineProperty(lt,"__esModule",{value:!0});var it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s};lt.shimGetUserMedia=function(s){var et=ut.detectBrowser(s),ot=s&&s.navigator,st=s&&s.MediaStreamTrack;if(ot.getUserMedia=function(mt,rt,pt){ut.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),ot.mediaDevices.getUserMedia(mt).then(rt,pt)},!(et.version>55&&"autoGainControl"in ot.mediaDevices.getSupportedConstraints())){var Rt=function(mt,rt,pt){rt in mt&&!(pt in mt)&&(mt[pt]=mt[rt],delete mt[rt])},ht=ot.mediaDevices.getUserMedia.bind(ot.mediaDevices);if(ot.mediaDevices.getUserMedia=function(mt){return(mt===void 0?"undefined":it(mt))==="object"&&it(mt.audio)==="object"&&(mt=JSON.parse(JSON.stringify(mt)),Rt(mt.audio,"autoGainControl","mozAutoGainControl"),Rt(mt.audio,"noiseSuppression","mozNoiseSuppression")),ht(mt)},st&&st.prototype.getSettings){var bt=st.prototype.getSettings;st.prototype.getSettings=function(){var mt=bt.apply(this,arguments);return Rt(mt,"mozAutoGainControl","autoGainControl"),Rt(mt,"mozNoiseSuppression","noiseSuppression"),mt}}if(st&&st.prototype.applyConstraints){var ct=st.prototype.applyConstraints;st.prototype.applyConstraints=function(mt){return this.kind==="audio"&&(mt===void 0?"undefined":it(mt))==="object"&&(mt=JSON.parse(JSON.stringify(mt)),Rt(mt,"autoGainControl","mozAutoGainControl"),Rt(mt,"noiseSuppression","mozNoiseSuppression")),ct.apply(this,[mt])}}}};var ut=function(s){if(s&&s.__esModule)return s;var et={};if(s!=null)for(var ot in s)Object.prototype.hasOwnProperty.call(s,ot)&&(et[ot]=s[ot]);return et.default=s,et}(tt("../utils"))},{"../utils":15}],14:[function(tt,at,lt){function it(et){return et&&et.video!==void 0?Object.assign({},et,{video:s.compactObject(et.video)}):et}Object.defineProperty(lt,"__esModule",{value:!0});var ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et};lt.shimLocalStreamsAPI=function(et){if((et===void 0?"undefined":ut(et))==="object"&&et.RTCPeerConnection){if("getLocalStreams"in et.RTCPeerConnection.prototype||(et.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in et.RTCPeerConnection.prototype)){var ot=et.RTCPeerConnection.prototype.addTrack;et.RTCPeerConnection.prototype.addStream=function(st){var Rt=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(st)||this._localStreams.push(st),st.getTracks().forEach(function(ht){return ot.call(Rt,ht,st)})},et.RTCPeerConnection.prototype.addTrack=function(st,Rt){return Rt&&(this._localStreams?this._localStreams.includes(Rt)||this._localStreams.push(Rt):this._localStreams=[Rt]),ot.call(this,st,Rt)}}"removeStream"in et.RTCPeerConnection.prototype||(et.RTCPeerConnection.prototype.removeStream=function(st){var Rt=this;this._localStreams||(this._localStreams=[]);var ht=this._localStreams.indexOf(st);if(ht!==-1){this._localStreams.splice(ht,1);var bt=st.getTracks();this.getSenders().forEach(function(ct){bt.includes(ct.track)&&Rt.removeTrack(ct)})}})}},lt.shimRemoteStreamsAPI=function(et){if((et===void 0?"undefined":ut(et))==="object"&&et.RTCPeerConnection&&("getRemoteStreams"in et.RTCPeerConnection.prototype||(et.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in et.RTCPeerConnection.prototype))){Object.defineProperty(et.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(st){var Rt=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=st),this.addEventListener("track",this._onaddstreampoly=function(ht){ht.streams.forEach(function(bt){if(Rt._remoteStreams||(Rt._remoteStreams=[]),!Rt._remoteStreams.includes(bt)){Rt._remoteStreams.push(bt);var ct=new Event("addstream");ct.stream=bt,Rt.dispatchEvent(ct)}})})}});var ot=et.RTCPeerConnection.prototype.setRemoteDescription;et.RTCPeerConnection.prototype.setRemoteDescription=function(){var st=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(Rt){Rt.streams.forEach(function(ht){if(st._remoteStreams||(st._remoteStreams=[]),!(st._remoteStreams.indexOf(ht)>=0)){st._remoteStreams.push(ht);var bt=new Event("addstream");bt.stream=ht,st.dispatchEvent(bt)}})}),ot.apply(st,arguments)}}},lt.shimCallbacksAPI=function(et){if((et===void 0?"undefined":ut(et))==="object"&&et.RTCPeerConnection){var ot=et.RTCPeerConnection.prototype,st=ot.createOffer,Rt=ot.createAnswer,ht=ot.setLocalDescription,bt=ot.setRemoteDescription,ct=ot.addIceCandidate;ot.createOffer=function(rt,pt){var ft=arguments.length>=2?arguments[2]:arguments[0],St=st.apply(this,[ft]);return pt?(St.then(rt,pt),Promise.resolve()):St},ot.createAnswer=function(rt,pt){var ft=arguments.length>=2?arguments[2]:arguments[0],St=Rt.apply(this,[ft]);return pt?(St.then(rt,pt),Promise.resolve()):St};var mt=function(rt,pt,ft){var St=ht.apply(this,[rt]);return ft?(St.then(pt,ft),Promise.resolve()):St};ot.setLocalDescription=mt,mt=function(rt,pt,ft){var St=bt.apply(this,[rt]);return ft?(St.then(pt,ft),Promise.resolve()):St},ot.setRemoteDescription=mt,mt=function(rt,pt,ft){var St=ct.apply(this,[rt]);return ft?(St.then(pt,ft),Promise.resolve()):St},ot.addIceCandidate=mt}},lt.shimGetUserMedia=function(et){var ot=et&&et.navigator;if(ot.mediaDevices&&ot.mediaDevices.getUserMedia){var st=ot.mediaDevices,Rt=st.getUserMedia.bind(st);ot.mediaDevices.getUserMedia=function(ht){return Rt(it(ht))}}!ot.getUserMedia&&ot.mediaDevices&&ot.mediaDevices.getUserMedia&&(ot.getUserMedia=(function(ht,bt,ct){ot.mediaDevices.getUserMedia(ht).then(bt,ct)}).bind(ot))},lt.shimConstraints=it,lt.shimRTCIceServerUrls=function(et){var ot=et.RTCPeerConnection;et.RTCPeerConnection=function(st,Rt){if(st&&st.iceServers){for(var ht=[],bt=0;bt<st.iceServers.length;bt++){var ct=st.iceServers[bt];!ct.hasOwnProperty("urls")&&ct.hasOwnProperty("url")?(s.deprecated("RTCIceServer.url","RTCIceServer.urls"),(ct=JSON.parse(JSON.stringify(ct))).urls=ct.url,delete ct.url,ht.push(ct)):ht.push(st.iceServers[bt])}st.iceServers=ht}return new ot(st,Rt)},et.RTCPeerConnection.prototype=ot.prototype,"generateCertificate"in et.RTCPeerConnection&&Object.defineProperty(et.RTCPeerConnection,"generateCertificate",{get:function(){return ot.generateCertificate}})},lt.shimTrackEventTransceiver=function(et){(et===void 0?"undefined":ut(et))==="object"&&et.RTCPeerConnection&&"receiver"in et.RTCTrackEvent.prototype&&!et.RTCTransceiver&&Object.defineProperty(et.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},lt.shimCreateOfferLegacy=function(et){var ot=et.RTCPeerConnection.prototype.createOffer;et.RTCPeerConnection.prototype.createOffer=function(st){if(st){st.offerToReceiveAudio!==void 0&&(st.offerToReceiveAudio=!!st.offerToReceiveAudio);var Rt=this.getTransceivers().find(function(bt){return bt.receiver.track.kind==="audio"});st.offerToReceiveAudio===!1&&Rt?Rt.direction==="sendrecv"?Rt.setDirection?Rt.setDirection("sendonly"):Rt.direction="sendonly":Rt.direction==="recvonly"&&(Rt.setDirection?Rt.setDirection("inactive"):Rt.direction="inactive"):st.offerToReceiveAudio!==!0||Rt||this.addTransceiver("audio"),st.offerToReceiveVideo!==void 0&&(st.offerToReceiveVideo=!!st.offerToReceiveVideo);var ht=this.getTransceivers().find(function(bt){return bt.receiver.track.kind==="video"});st.offerToReceiveVideo===!1&&ht?ht.direction==="sendrecv"?ht.setDirection?ht.setDirection("sendonly"):ht.direction="sendonly":ht.direction==="recvonly"&&(ht.setDirection?ht.setDirection("inactive"):ht.direction="inactive"):st.offerToReceiveVideo!==!0||ht||this.addTransceiver("video")}return ot.apply(this,arguments)}};var s=function(et){if(et&&et.__esModule)return et;var ot={};if(et!=null)for(var st in et)Object.prototype.hasOwnProperty.call(et,st)&&(ot[st]=et[st]);return ot.default=et,ot}(tt("../utils"))},{"../utils":15}],15:[function(tt,at,lt){function it(ht,bt,ct){return bt in ht?Object.defineProperty(ht,bt,{value:ct,enumerable:!0,configurable:!0,writable:!0}):ht[bt]=ct,ht}function ut(ht,bt,ct){var mt=ht.match(bt);return mt&&mt.length>=ct&&parseInt(mt[ct],10)}function s(ht){return(ht===void 0?"undefined":ot(ht))!=="object"?ht:Object.keys(ht).reduce(function(bt,ct){var mt=ot(ht[ct])==="object",rt=mt?s(ht[ct]):ht[ct],pt=mt&&!Object.keys(rt).length;return rt===void 0||pt?bt:Object.assign(bt,it({},ct,rt))},{})}function et(ht,bt,ct){bt&&!ct.has(bt.id)&&(ct.set(bt.id,bt),Object.keys(bt).forEach(function(mt){mt.endsWith("Id")?et(ht,ht.get(bt[mt]),ct):mt.endsWith("Ids")&&bt[mt].forEach(function(rt){et(ht,ht.get(rt),ct)})}))}Object.defineProperty(lt,"__esModule",{value:!0});var ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ht){return typeof ht}:function(ht){return ht&&typeof Symbol=="function"&&ht.constructor===Symbol&&ht!==Symbol.prototype?"symbol":typeof ht};lt.extractVersion=ut,lt.wrapPeerConnectionEvent=function(ht,bt,ct){if(ht.RTCPeerConnection){var mt=ht.RTCPeerConnection.prototype,rt=mt.addEventListener;mt.addEventListener=function(ft,St){if(ft!==bt)return rt.apply(this,arguments);var It=function(xt){var At=ct(xt);At&&St(At)};return this._eventMap=this._eventMap||{},this._eventMap[St]=It,rt.apply(this,[ft,It])};var pt=mt.removeEventListener;mt.removeEventListener=function(ft,St){if(ft!==bt||!this._eventMap||!this._eventMap[St])return pt.apply(this,arguments);var It=this._eventMap[St];return delete this._eventMap[St],pt.apply(this,[ft,It])},Object.defineProperty(mt,"on"+bt,{get:function(){return this["_on"+bt]},set:function(ft){this["_on"+bt]&&(this.removeEventListener(bt,this["_on"+bt]),delete this["_on"+bt]),ft&&this.addEventListener(bt,this["_on"+bt]=ft)},enumerable:!0,configurable:!0})}},lt.disableLog=function(ht){return typeof ht!="boolean"?new Error("Argument type: "+(ht===void 0?"undefined":ot(ht))+". Please use a boolean."):(st=ht,ht?"adapter.js logging disabled":"adapter.js logging enabled")},lt.disableWarnings=function(ht){return typeof ht!="boolean"?new Error("Argument type: "+(ht===void 0?"undefined":ot(ht))+". Please use a boolean."):(Rt=!ht,"adapter.js deprecation warnings "+(ht?"disabled":"enabled"))},lt.log=function(){if((typeof window>"u"?"undefined":ot(window))==="object"){if(st)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}},lt.deprecated=function(ht,bt){Rt&&console.warn(ht+" is deprecated, please use "+bt+" instead.")},lt.detectBrowser=function(ht){var bt=ht.navigator,ct={browser:null,version:null};if(ht===void 0||!ht.navigator)return ct.browser="Not a browser.",ct;if(bt.mozGetUserMedia)ct.browser="firefox",ct.version=ut(bt.userAgent,/Firefox\/(\d+)\./,1);else if(bt.webkitGetUserMedia||ht.isSecureContext===!1&&ht.webkitRTCPeerConnection&&!ht.RTCIceGatherer)ct.browser="chrome",ct.version=ut(bt.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(bt.mediaDevices&&bt.userAgent.match(/Edge\/(\d+).(\d+)$/))ct.browser="edge",ct.version=ut(bt.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!ht.RTCPeerConnection||!bt.userAgent.match(/AppleWebKit\/(\d+)\./))return ct.browser="Not a supported browser.",ct;ct.browser="safari",ct.version=ut(bt.userAgent,/AppleWebKit\/(\d+)\./,1)}return ct},lt.compactObject=s,lt.walkStats=et,lt.filterStats=function(ht,bt,ct){var mt=ct?"outbound-rtp":"inbound-rtp",rt=new Map;if(bt===null)return rt;var pt=[];return ht.forEach(function(ft){ft.type==="track"&&ft.trackIdentifier===bt.id&&pt.push(ft)}),pt.forEach(function(ft){ht.forEach(function(St){St.type===mt&&St.trackId===ft.id&&et(ht,St,rt)})}),rt};var st=!0,Rt=!0},{}],16:[function(tt,at,lt){function it(bt){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[bt.type]||bt.type}function ut(bt,ct,mt,rt,pt){var ft=ht.writeRtpDescription(bt.kind,ct);if(ft+=ht.writeIceParameters(bt.iceGatherer.getLocalParameters()),ft+=ht.writeDtlsParameters(bt.dtlsTransport.getLocalParameters(),mt==="offer"?"actpass":pt||"active"),ft+="a=mid:"+bt.mid+`\r
`,bt.rtpSender&&bt.rtpReceiver?ft+=`a=sendrecv\r
`:bt.rtpSender?ft+=`a=sendonly\r
`:bt.rtpReceiver?ft+=`a=recvonly\r
`:ft+=`a=inactive\r
`,bt.rtpSender){var St=bt.rtpSender._initialTrackId||bt.rtpSender.track.id;bt.rtpSender._initialTrackId=St;var It="msid:"+(rt?rt.id:"-")+" "+St+`\r
`;ft+="a="+It,ft+="a=ssrc:"+bt.sendEncodingParameters[0].ssrc+" "+It,bt.sendEncodingParameters[0].rtx&&(ft+="a=ssrc:"+bt.sendEncodingParameters[0].rtx.ssrc+" "+It,ft+="a=ssrc-group:FID "+bt.sendEncodingParameters[0].ssrc+" "+bt.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return ft+="a=ssrc:"+bt.sendEncodingParameters[0].ssrc+" cname:"+ht.localCName+`\r
`,bt.rtpSender&&bt.sendEncodingParameters[0].rtx&&(ft+="a=ssrc:"+bt.sendEncodingParameters[0].rtx.ssrc+" cname:"+ht.localCName+`\r
`),ft}function s(bt,ct){var mt=!1;return(bt=JSON.parse(JSON.stringify(bt))).filter(function(rt){if(rt&&(rt.urls||rt.url)){var pt=rt.urls||rt.url;rt.url&&!rt.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var ft=typeof pt=="string";return ft&&(pt=[pt]),pt=pt.filter(function(St){return St.indexOf("turn:")===0&&St.indexOf("transport=udp")!==-1&&St.indexOf("turn:[")===-1&&!mt?(mt=!0,!0):St.indexOf("stun:")===0&&ct>=14393&&St.indexOf("?transport=udp")===-1}),delete rt.url,rt.urls=ft?pt[0]:pt,!!pt.length}})}function et(bt,ct){var mt={codecs:[],headerExtensions:[],fecMechanisms:[]},rt=function(ft,St){ft=parseInt(ft,10);for(var It=0;It<St.length;It++)if(St[It].payloadType===ft||St[It].preferredPayloadType===ft)return St[It]},pt=function(ft,St,It,xt){var At=rt(ft.parameters.apt,It),Dt=rt(St.parameters.apt,xt);return At&&Dt&&At.name.toLowerCase()===Dt.name.toLowerCase()};return bt.codecs.forEach(function(ft){for(var St=0;St<ct.codecs.length;St++){var It=ct.codecs[St];if(ft.name.toLowerCase()===It.name.toLowerCase()&&ft.clockRate===It.clockRate){if(ft.name.toLowerCase()==="rtx"&&ft.parameters&&It.parameters.apt&&!pt(ft,It,bt.codecs,ct.codecs))continue;(It=JSON.parse(JSON.stringify(It))).numChannels=Math.min(ft.numChannels,It.numChannels),mt.codecs.push(It),It.rtcpFeedback=It.rtcpFeedback.filter(function(xt){for(var At=0;At<ft.rtcpFeedback.length;At++)if(ft.rtcpFeedback[At].type===xt.type&&ft.rtcpFeedback[At].parameter===xt.parameter)return!0;return!1});break}}}),bt.headerExtensions.forEach(function(ft){for(var St=0;St<ct.headerExtensions.length;St++){var It=ct.headerExtensions[St];if(ft.uri===It.uri){mt.headerExtensions.push(It);break}}}),mt}function ot(bt,ct,mt){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[ct][bt].indexOf(mt)!==-1}function st(bt,ct){var mt=bt.getRemoteCandidates().find(function(rt){return ct.foundation===rt.foundation&&ct.ip===rt.ip&&ct.port===rt.port&&ct.priority===rt.priority&&ct.protocol===rt.protocol&&ct.type===rt.type});return mt||bt.addRemoteCandidate(ct),!mt}function Rt(bt,ct){var mt=new Error(ct);return mt.name=bt,mt.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[bt],mt}var ht=tt("sdp");at.exports=function(bt,ct){function mt(It,xt){xt.addTrack(It),xt.dispatchEvent(new bt.MediaStreamTrackEvent("addtrack",{track:It}))}function rt(It,xt){xt.removeTrack(It),xt.dispatchEvent(new bt.MediaStreamTrackEvent("removetrack",{track:It}))}function pt(It,xt,At,Dt){var wt=new Event("track");wt.track=xt,wt.receiver=At,wt.transceiver={receiver:At},wt.streams=Dt,bt.setTimeout(function(){It._dispatchEvent("track",wt)})}var ft=function(It){var xt=this,At=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(wt){xt[wt]=At[wt].bind(At)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",It=JSON.parse(JSON.stringify(It||{})),this.usingBundle=It.bundlePolicy==="max-bundle",It.rtcpMuxPolicy==="negotiate")throw Rt("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(It.rtcpMuxPolicy||(It.rtcpMuxPolicy="require"),It.iceTransportPolicy){case"all":case"relay":break;default:It.iceTransportPolicy="all"}switch(It.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:It.bundlePolicy="balanced"}if(It.iceServers=s(It.iceServers||[],ct),this._iceGatherers=[],It.iceCandidatePoolSize)for(var Dt=It.iceCandidatePoolSize;Dt>0;Dt--)this._iceGatherers.push(new bt.RTCIceGatherer({iceServers:It.iceServers,gatherPolicy:It.iceTransportPolicy}));else It.iceCandidatePoolSize=0;this._config=It,this.transceivers=[],this._sdpSessionId=ht.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(ft.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(ft.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),ft.prototype.onicecandidate=null,ft.prototype.onaddstream=null,ft.prototype.ontrack=null,ft.prototype.onremovestream=null,ft.prototype.onsignalingstatechange=null,ft.prototype.oniceconnectionstatechange=null,ft.prototype.onconnectionstatechange=null,ft.prototype.onicegatheringstatechange=null,ft.prototype.onnegotiationneeded=null,ft.prototype.ondatachannel=null,ft.prototype._dispatchEvent=function(It,xt){this._isClosed||(this.dispatchEvent(xt),typeof this["on"+It]=="function"&&this["on"+It](xt))},ft.prototype._emitGatheringStateChange=function(){var It=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",It)},ft.prototype.getConfiguration=function(){return this._config},ft.prototype.getLocalStreams=function(){return this.localStreams},ft.prototype.getRemoteStreams=function(){return this.remoteStreams},ft.prototype._createTransceiver=function(It,xt){var At=this.transceivers.length>0,Dt={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:It,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&At)Dt.iceTransport=this.transceivers[0].iceTransport,Dt.dtlsTransport=this.transceivers[0].dtlsTransport;else{var wt=this._createIceAndDtlsTransports();Dt.iceTransport=wt.iceTransport,Dt.dtlsTransport=wt.dtlsTransport}return xt||this.transceivers.push(Dt),Dt},ft.prototype.addTrack=function(It,xt){if(this._isClosed)throw Rt("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(wt){return wt.track===It}))throw Rt("InvalidAccessError","Track already exists.");for(var At,Dt=0;Dt<this.transceivers.length;Dt++)this.transceivers[Dt].track||this.transceivers[Dt].kind!==It.kind||(At=this.transceivers[Dt]);return At||(At=this._createTransceiver(It.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(xt)===-1&&this.localStreams.push(xt),At.track=It,At.stream=xt,At.rtpSender=new bt.RTCRtpSender(It,At.dtlsTransport),At.rtpSender},ft.prototype.addStream=function(It){var xt=this;if(ct>=15025)It.getTracks().forEach(function(Dt){xt.addTrack(Dt,It)});else{var At=It.clone();It.getTracks().forEach(function(Dt,wt){var Mt=At.getTracks()[wt];Dt.addEventListener("enabled",function(vt){Mt.enabled=vt.enabled})}),At.getTracks().forEach(function(Dt){xt.addTrack(Dt,At)})}},ft.prototype.removeTrack=function(It){if(this._isClosed)throw Rt("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(It instanceof bt.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var xt=this.transceivers.find(function(Dt){return Dt.rtpSender===It});if(!xt)throw Rt("InvalidAccessError","Sender was not created by this connection.");var At=xt.stream;xt.rtpSender.stop(),xt.rtpSender=null,xt.track=null,xt.stream=null,this.transceivers.map(function(Dt){return Dt.stream}).indexOf(At)===-1&&this.localStreams.indexOf(At)>-1&&this.localStreams.splice(this.localStreams.indexOf(At),1),this._maybeFireNegotiationNeeded()},ft.prototype.removeStream=function(It){var xt=this;It.getTracks().forEach(function(At){var Dt=xt.getSenders().find(function(wt){return wt.track===At});Dt&&xt.removeTrack(Dt)})},ft.prototype.getSenders=function(){return this.transceivers.filter(function(It){return!!It.rtpSender}).map(function(It){return It.rtpSender})},ft.prototype.getReceivers=function(){return this.transceivers.filter(function(It){return!!It.rtpReceiver}).map(function(It){return It.rtpReceiver})},ft.prototype._createIceGatherer=function(It,xt){var At=this;if(xt&&It>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var Dt=new bt.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(Dt,"state",{value:"new",writable:!0}),this.transceivers[It].bufferedCandidateEvents=[],this.transceivers[It].bufferCandidates=function(wt){var Mt=!wt.candidate||Object.keys(wt.candidate).length===0;Dt.state=Mt?"completed":"gathering",At.transceivers[It].bufferedCandidateEvents!==null&&At.transceivers[It].bufferedCandidateEvents.push(wt)},Dt.addEventListener("localcandidate",this.transceivers[It].bufferCandidates),Dt},ft.prototype._gather=function(It,xt){var At=this,Dt=this.transceivers[xt].iceGatherer;if(!Dt.onlocalcandidate){var wt=this.transceivers[xt].bufferedCandidateEvents;this.transceivers[xt].bufferedCandidateEvents=null,Dt.removeEventListener("localcandidate",this.transceivers[xt].bufferCandidates),Dt.onlocalcandidate=function(Mt){if(!(At.usingBundle&&xt>0)){var vt=new Event("icecandidate");vt.candidate={sdpMid:It,sdpMLineIndex:xt};var Ft=Mt.candidate,Ht=!Ft||Object.keys(Ft).length===0;if(Ht)Dt.state!=="new"&&Dt.state!=="gathering"||(Dt.state="completed");else{Dt.state==="new"&&(Dt.state="gathering"),Ft.component=1,Ft.ufrag=Dt.getLocalParameters().usernameFragment;var Wt=ht.writeCandidate(Ft);vt.candidate=Object.assign(vt.candidate,ht.parseCandidate(Wt)),vt.candidate.candidate=Wt,vt.candidate.toJSON=function(){return{candidate:vt.candidate.candidate,sdpMid:vt.candidate.sdpMid,sdpMLineIndex:vt.candidate.sdpMLineIndex,usernameFragment:vt.candidate.usernameFragment}}}var tn=ht.getMediaSections(At._localDescription.sdp);tn[vt.candidate.sdpMLineIndex]+=Ht?`a=end-of-candidates\r
`:"a="+vt.candidate.candidate+`\r
`,At._localDescription.sdp=ht.getDescription(At._localDescription.sdp)+tn.join("");var gn=At.transceivers.every(function(nn){return nn.iceGatherer&&nn.iceGatherer.state==="completed"});At.iceGatheringState!=="gathering"&&(At.iceGatheringState="gathering",At._emitGatheringStateChange()),Ht||At._dispatchEvent("icecandidate",vt),gn&&(At._dispatchEvent("icecandidate",new Event("icecandidate")),At.iceGatheringState="complete",At._emitGatheringStateChange())}},bt.setTimeout(function(){wt.forEach(function(Mt){Dt.onlocalcandidate(Mt)})},0)}},ft.prototype._createIceAndDtlsTransports=function(){var It=this,xt=new bt.RTCIceTransport(null);xt.onicestatechange=function(){It._updateIceConnectionState(),It._updateConnectionState()};var At=new bt.RTCDtlsTransport(xt);return At.ondtlsstatechange=function(){It._updateConnectionState()},At.onerror=function(){Object.defineProperty(At,"state",{value:"failed",writable:!0}),It._updateConnectionState()},{iceTransport:xt,dtlsTransport:At}},ft.prototype._disposeIceAndDtlsTransports=function(It){var xt=this.transceivers[It].iceGatherer;xt&&(delete xt.onlocalcandidate,delete this.transceivers[It].iceGatherer);var At=this.transceivers[It].iceTransport;At&&(delete At.onicestatechange,delete this.transceivers[It].iceTransport);var Dt=this.transceivers[It].dtlsTransport;Dt&&(delete Dt.ondtlsstatechange,delete Dt.onerror,delete this.transceivers[It].dtlsTransport)},ft.prototype._transceive=function(It,xt,At){var Dt=et(It.localCapabilities,It.remoteCapabilities);xt&&It.rtpSender&&(Dt.encodings=It.sendEncodingParameters,Dt.rtcp={cname:ht.localCName,compound:It.rtcpParameters.compound},It.recvEncodingParameters.length&&(Dt.rtcp.ssrc=It.recvEncodingParameters[0].ssrc),It.rtpSender.send(Dt)),At&&It.rtpReceiver&&Dt.codecs.length>0&&(It.kind==="video"&&It.recvEncodingParameters&&ct<15019&&It.recvEncodingParameters.forEach(function(wt){delete wt.rtx}),It.recvEncodingParameters.length?Dt.encodings=It.recvEncodingParameters:Dt.encodings=[{}],Dt.rtcp={compound:It.rtcpParameters.compound},It.rtcpParameters.cname&&(Dt.rtcp.cname=It.rtcpParameters.cname),It.sendEncodingParameters.length&&(Dt.rtcp.ssrc=It.sendEncodingParameters[0].ssrc),It.rtpReceiver.receive(Dt))},ft.prototype.setLocalDescription=function(It){var xt=this;if(["offer","answer"].indexOf(It.type)===-1)return Promise.reject(Rt("TypeError",'Unsupported type "'+It.type+'"'));if(!ot("setLocalDescription",It.type,xt.signalingState)||xt._isClosed)return Promise.reject(Rt("InvalidStateError","Can not set local "+It.type+" in state "+xt.signalingState));var At,Dt;if(It.type==="offer")At=ht.splitSections(It.sdp),Dt=At.shift(),At.forEach(function(Mt,vt){var Ft=ht.parseRtpParameters(Mt);xt.transceivers[vt].localCapabilities=Ft}),xt.transceivers.forEach(function(Mt,vt){xt._gather(Mt.mid,vt)});else if(It.type==="answer"){At=ht.splitSections(xt._remoteDescription.sdp),Dt=At.shift();var wt=ht.matchPrefix(Dt,"a=ice-lite").length>0;At.forEach(function(Mt,vt){var Ft=xt.transceivers[vt],Ht=Ft.iceGatherer,Wt=Ft.iceTransport,tn=Ft.dtlsTransport,gn=Ft.localCapabilities,nn=Ft.remoteCapabilities;if(!(ht.isRejected(Mt)&&ht.matchPrefix(Mt,"a=bundle-only").length===0)&&!Ft.rejected){var qt=ht.getIceParameters(Mt,Dt),fn=ht.getDtlsParameters(Mt,Dt);wt&&(fn.role="server"),xt.usingBundle&&vt!==0||(xt._gather(Ft.mid,vt),Wt.state==="new"&&Wt.start(Ht,qt,wt?"controlling":"controlled"),tn.state==="new"&&tn.start(fn));var Cn=et(gn,nn);xt._transceive(Ft,Cn.codecs.length>0,!1)}})}return xt._localDescription={type:It.type,sdp:It.sdp},It.type==="offer"?xt._updateSignalingState("have-local-offer"):xt._updateSignalingState("stable"),Promise.resolve()},ft.prototype.setRemoteDescription=function(It){var xt=this;if(["offer","answer"].indexOf(It.type)===-1)return Promise.reject(Rt("TypeError",'Unsupported type "'+It.type+'"'));if(!ot("setRemoteDescription",It.type,xt.signalingState)||xt._isClosed)return Promise.reject(Rt("InvalidStateError","Can not set remote "+It.type+" in state "+xt.signalingState));var At={};xt.remoteStreams.forEach(function(Wt){At[Wt.id]=Wt});var Dt=[],wt=ht.splitSections(It.sdp),Mt=wt.shift(),vt=ht.matchPrefix(Mt,"a=ice-lite").length>0,Ft=ht.matchPrefix(Mt,"a=group:BUNDLE ").length>0;xt.usingBundle=Ft;var Ht=ht.matchPrefix(Mt,"a=ice-options:")[0];return xt.canTrickleIceCandidates=!!Ht&&Ht.substr(14).split(" ").indexOf("trickle")>=0,wt.forEach(function(Wt,tn){var gn=ht.splitLines(Wt),nn=ht.getKind(Wt),qt=ht.isRejected(Wt)&&ht.matchPrefix(Wt,"a=bundle-only").length===0,fn=gn[0].substr(2).split(" ")[2],Cn=ht.getDirection(Wt,Mt),Tn=ht.parseMsid(Wt),un=ht.getMid(Wt)||ht.generateIdentifier();if(qt||nn==="application"&&(fn==="DTLS/SCTP"||fn==="UDP/DTLS/SCTP"))xt.transceivers[tn]={mid:un,kind:nn,protocol:fn,rejected:!0};else{!qt&&xt.transceivers[tn]&&xt.transceivers[tn].rejected&&(xt.transceivers[tn]=xt._createTransceiver(nn,!0));var mn,yn,pn,In,kn,Mn,xn,Pn,On,Dn,Fn,dr=ht.parseRtpParameters(Wt);qt||(Dn=ht.getIceParameters(Wt,Mt),(Fn=ht.getDtlsParameters(Wt,Mt)).role="client"),xn=ht.parseRtpEncodingParameters(Wt);var ir=ht.parseRtcpParameters(Wt),Xn=ht.matchPrefix(Wt,"a=end-of-candidates",Mt).length>0,tr=ht.matchPrefix(Wt,"a=candidate:").map(function(Qn){return ht.parseCandidate(Qn)}).filter(function(Qn){return Qn.component===1});if((It.type==="offer"||It.type==="answer")&&!qt&&Ft&&tn>0&&xt.transceivers[tn]&&(xt._disposeIceAndDtlsTransports(tn),xt.transceivers[tn].iceGatherer=xt.transceivers[0].iceGatherer,xt.transceivers[tn].iceTransport=xt.transceivers[0].iceTransport,xt.transceivers[tn].dtlsTransport=xt.transceivers[0].dtlsTransport,xt.transceivers[tn].rtpSender&&xt.transceivers[tn].rtpSender.setTransport(xt.transceivers[0].dtlsTransport),xt.transceivers[tn].rtpReceiver&&xt.transceivers[tn].rtpReceiver.setTransport(xt.transceivers[0].dtlsTransport)),It.type!=="offer"||qt)It.type!=="answer"||qt||(yn=(mn=xt.transceivers[tn]).iceGatherer,pn=mn.iceTransport,In=mn.dtlsTransport,kn=mn.rtpReceiver,Mn=mn.sendEncodingParameters,Pn=mn.localCapabilities,xt.transceivers[tn].recvEncodingParameters=xn,xt.transceivers[tn].remoteCapabilities=dr,xt.transceivers[tn].rtcpParameters=ir,tr.length&&pn.state==="new"&&(!vt&&!Xn||Ft&&tn!==0?tr.forEach(function(Qn){st(mn.iceTransport,Qn)}):pn.setRemoteCandidates(tr)),Ft&&tn!==0||(pn.state==="new"&&pn.start(yn,Dn,"controlling"),In.state==="new"&&In.start(Fn)),!et(mn.localCapabilities,mn.remoteCapabilities).codecs.filter(function(Qn){return Qn.name.toLowerCase()==="rtx"}).length&&mn.sendEncodingParameters[0].rtx&&delete mn.sendEncodingParameters[0].rtx,xt._transceive(mn,Cn==="sendrecv"||Cn==="recvonly",Cn==="sendrecv"||Cn==="sendonly"),!kn||Cn!=="sendrecv"&&Cn!=="sendonly"?delete mn.rtpReceiver:(On=kn.track,Tn?(At[Tn.stream]||(At[Tn.stream]=new bt.MediaStream),mt(On,At[Tn.stream]),Dt.push([On,kn,At[Tn.stream]])):(At.default||(At.default=new bt.MediaStream),mt(On,At.default),Dt.push([On,kn,At.default]))));else{(mn=xt.transceivers[tn]||xt._createTransceiver(nn)).mid=un,mn.iceGatherer||(mn.iceGatherer=xt._createIceGatherer(tn,Ft)),tr.length&&mn.iceTransport.state==="new"&&(!Xn||Ft&&tn!==0?tr.forEach(function(Qn){st(mn.iceTransport,Qn)}):mn.iceTransport.setRemoteCandidates(tr)),Pn=bt.RTCRtpReceiver.getCapabilities(nn),ct<15019&&(Pn.codecs=Pn.codecs.filter(function(Qn){return Qn.name!=="rtx"})),Mn=mn.sendEncodingParameters||[{ssrc:1001*(2*tn+2)}];var cn=!1;if(Cn==="sendrecv"||Cn==="sendonly"){if(cn=!mn.rtpReceiver,kn=mn.rtpReceiver||new bt.RTCRtpReceiver(mn.dtlsTransport,nn),cn){var Jn;On=kn.track,Tn&&Tn.stream==="-"||(Tn?(At[Tn.stream]||(At[Tn.stream]=new bt.MediaStream,Object.defineProperty(At[Tn.stream],"id",{get:function(){return Tn.stream}})),Object.defineProperty(On,"id",{get:function(){return Tn.track}}),Jn=At[Tn.stream]):(At.default||(At.default=new bt.MediaStream),Jn=At.default)),Jn&&(mt(On,Jn),mn.associatedRemoteMediaStreams.push(Jn)),Dt.push([On,kn,Jn])}}else mn.rtpReceiver&&mn.rtpReceiver.track&&(mn.associatedRemoteMediaStreams.forEach(function(Qn){var sr=Qn.getTracks().find(function(Bn){return Bn.id===mn.rtpReceiver.track.id});sr&&rt(sr,Qn)}),mn.associatedRemoteMediaStreams=[]);mn.localCapabilities=Pn,mn.remoteCapabilities=dr,mn.rtpReceiver=kn,mn.rtcpParameters=ir,mn.sendEncodingParameters=Mn,mn.recvEncodingParameters=xn,xt._transceive(xt.transceivers[tn],!1,cn)}}}),xt._dtlsRole===void 0&&(xt._dtlsRole=It.type==="offer"?"active":"passive"),xt._remoteDescription={type:It.type,sdp:It.sdp},It.type==="offer"?xt._updateSignalingState("have-remote-offer"):xt._updateSignalingState("stable"),Object.keys(At).forEach(function(Wt){var tn=At[Wt];if(tn.getTracks().length){if(xt.remoteStreams.indexOf(tn)===-1){xt.remoteStreams.push(tn);var gn=new Event("addstream");gn.stream=tn,bt.setTimeout(function(){xt._dispatchEvent("addstream",gn)})}Dt.forEach(function(nn){var qt=nn[0],fn=nn[1];tn.id===nn[2].id&&pt(xt,qt,fn,[tn])})}}),Dt.forEach(function(Wt){Wt[2]||pt(xt,Wt[0],Wt[1],[])}),bt.setTimeout(function(){xt&&xt.transceivers&&xt.transceivers.forEach(function(Wt){Wt.iceTransport&&Wt.iceTransport.state==="new"&&Wt.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),Wt.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},ft.prototype.close=function(){this.transceivers.forEach(function(It){It.iceTransport&&It.iceTransport.stop(),It.dtlsTransport&&It.dtlsTransport.stop(),It.rtpSender&&It.rtpSender.stop(),It.rtpReceiver&&It.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},ft.prototype._updateSignalingState=function(It){this.signalingState=It;var xt=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",xt)},ft.prototype._maybeFireNegotiationNeeded=function(){var It=this;this.signalingState==="stable"&&this.needNegotiation!==!0&&(this.needNegotiation=!0,bt.setTimeout(function(){if(It.needNegotiation){It.needNegotiation=!1;var xt=new Event("negotiationneeded");It._dispatchEvent("negotiationneeded",xt)}},0))},ft.prototype._updateIceConnectionState=function(){var It,xt={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(Dt){Dt.iceTransport&&!Dt.rejected&&xt[Dt.iceTransport.state]++}),It="new",xt.failed>0?It="failed":xt.checking>0?It="checking":xt.disconnected>0?It="disconnected":xt.new>0?It="new":xt.connected>0?It="connected":xt.completed>0&&(It="completed"),It!==this.iceConnectionState){this.iceConnectionState=It;var At=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",At)}},ft.prototype._updateConnectionState=function(){var It,xt={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(Dt){Dt.iceTransport&&Dt.dtlsTransport&&!Dt.rejected&&(xt[Dt.iceTransport.state]++,xt[Dt.dtlsTransport.state]++)}),xt.connected+=xt.completed,It="new",xt.failed>0?It="failed":xt.connecting>0?It="connecting":xt.disconnected>0?It="disconnected":xt.new>0?It="new":xt.connected>0&&(It="connected"),It!==this.connectionState){this.connectionState=It;var At=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",At)}},ft.prototype.createOffer=function(){var It=this;if(It._isClosed)return Promise.reject(Rt("InvalidStateError","Can not call createOffer after close"));var xt=It.transceivers.filter(function(vt){return vt.kind==="audio"}).length,At=It.transceivers.filter(function(vt){return vt.kind==="video"}).length,Dt=arguments[0];if(Dt){if(Dt.mandatory||Dt.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");Dt.offerToReceiveAudio!==void 0&&(xt=Dt.offerToReceiveAudio===!0?1:Dt.offerToReceiveAudio===!1?0:Dt.offerToReceiveAudio),Dt.offerToReceiveVideo!==void 0&&(At=Dt.offerToReceiveVideo===!0?1:Dt.offerToReceiveVideo===!1?0:Dt.offerToReceiveVideo)}for(It.transceivers.forEach(function(vt){vt.kind==="audio"?--xt<0&&(vt.wantReceive=!1):vt.kind==="video"&&--At<0&&(vt.wantReceive=!1)});xt>0||At>0;)xt>0&&(It._createTransceiver("audio"),xt--),At>0&&(It._createTransceiver("video"),At--);var wt=ht.writeSessionBoilerplate(It._sdpSessionId,It._sdpSessionVersion++);It.transceivers.forEach(function(vt,Ft){var Ht=vt.track,Wt=vt.kind,tn=vt.mid||ht.generateIdentifier();vt.mid=tn,vt.iceGatherer||(vt.iceGatherer=It._createIceGatherer(Ft,It.usingBundle));var gn=bt.RTCRtpSender.getCapabilities(Wt);ct<15019&&(gn.codecs=gn.codecs.filter(function(qt){return qt.name!=="rtx"})),gn.codecs.forEach(function(qt){qt.name==="H264"&&qt.parameters["level-asymmetry-allowed"]===void 0&&(qt.parameters["level-asymmetry-allowed"]="1"),vt.remoteCapabilities&&vt.remoteCapabilities.codecs&&vt.remoteCapabilities.codecs.forEach(function(fn){qt.name.toLowerCase()===fn.name.toLowerCase()&&qt.clockRate===fn.clockRate&&(qt.preferredPayloadType=fn.payloadType)})}),gn.headerExtensions.forEach(function(qt){(vt.remoteCapabilities&&vt.remoteCapabilities.headerExtensions||[]).forEach(function(fn){qt.uri===fn.uri&&(qt.id=fn.id)})});var nn=vt.sendEncodingParameters||[{ssrc:1001*(2*Ft+1)}];Ht&&ct>=15019&&Wt==="video"&&!nn[0].rtx&&(nn[0].rtx={ssrc:nn[0].ssrc+1}),vt.wantReceive&&(vt.rtpReceiver=new bt.RTCRtpReceiver(vt.dtlsTransport,Wt)),vt.localCapabilities=gn,vt.sendEncodingParameters=nn}),It._config.bundlePolicy!=="max-compat"&&(wt+="a=group:BUNDLE "+It.transceivers.map(function(vt){return vt.mid}).join(" ")+`\r
`),wt+=`a=ice-options:trickle\r
`,It.transceivers.forEach(function(vt,Ft){wt+=ut(vt,vt.localCapabilities,"offer",vt.stream,It._dtlsRole),wt+=`a=rtcp-rsize\r
`,!vt.iceGatherer||It.iceGatheringState==="new"||Ft!==0&&It.usingBundle||(vt.iceGatherer.getLocalCandidates().forEach(function(Ht){Ht.component=1,wt+="a="+ht.writeCandidate(Ht)+`\r
`}),vt.iceGatherer.state==="completed"&&(wt+=`a=end-of-candidates\r
`))});var Mt=new bt.RTCSessionDescription({type:"offer",sdp:wt});return Promise.resolve(Mt)},ft.prototype.createAnswer=function(){var It=this;if(It._isClosed)return Promise.reject(Rt("InvalidStateError","Can not call createAnswer after close"));if(It.signalingState!=="have-remote-offer"&&It.signalingState!=="have-local-pranswer")return Promise.reject(Rt("InvalidStateError","Can not call createAnswer in signalingState "+It.signalingState));var xt=ht.writeSessionBoilerplate(It._sdpSessionId,It._sdpSessionVersion++);It.usingBundle&&(xt+="a=group:BUNDLE "+It.transceivers.map(function(wt){return wt.mid}).join(" ")+`\r
`),xt+=`a=ice-options:trickle\r
`;var At=ht.getMediaSections(It._remoteDescription.sdp).length;It.transceivers.forEach(function(wt,Mt){if(!(Mt+1>At)){if(wt.rejected)return wt.kind==="application"?wt.protocol==="DTLS/SCTP"?xt+=`m=application 0 DTLS/SCTP 5000\r
`:xt+="m=application 0 "+wt.protocol+` webrtc-datachannel\r
`:wt.kind==="audio"?xt+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:wt.kind==="video"&&(xt+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),void(xt+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+wt.mid+`\r
`);if(wt.stream){var vt;wt.kind==="audio"?vt=wt.stream.getAudioTracks()[0]:wt.kind==="video"&&(vt=wt.stream.getVideoTracks()[0]),vt&&ct>=15019&&wt.kind==="video"&&!wt.sendEncodingParameters[0].rtx&&(wt.sendEncodingParameters[0].rtx={ssrc:wt.sendEncodingParameters[0].ssrc+1})}var Ft=et(wt.localCapabilities,wt.remoteCapabilities);!Ft.codecs.filter(function(Ht){return Ht.name.toLowerCase()==="rtx"}).length&&wt.sendEncodingParameters[0].rtx&&delete wt.sendEncodingParameters[0].rtx,xt+=ut(wt,Ft,"answer",wt.stream,It._dtlsRole),wt.rtcpParameters&&wt.rtcpParameters.reducedSize&&(xt+=`a=rtcp-rsize\r
`)}});var Dt=new bt.RTCSessionDescription({type:"answer",sdp:xt});return Promise.resolve(Dt)},ft.prototype.addIceCandidate=function(It){var xt,At=this;return It&&It.sdpMLineIndex===void 0&&!It.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(Dt,wt){if(!At._remoteDescription)return wt(Rt("InvalidStateError","Can not add ICE candidate without a remote description"));if(It&&It.candidate!==""){var Mt=It.sdpMLineIndex;if(It.sdpMid){for(var vt=0;vt<At.transceivers.length;vt++)if(At.transceivers[vt].mid===It.sdpMid){Mt=vt;break}}var Ft=At.transceivers[Mt];if(!Ft)return wt(Rt("OperationError","Can not add ICE candidate"));if(Ft.rejected)return Dt();var Ht=Object.keys(It.candidate).length>0?ht.parseCandidate(It.candidate):{};if(Ht.protocol==="tcp"&&(Ht.port===0||Ht.port===9)||Ht.component&&Ht.component!==1)return Dt();if((Mt===0||Mt>0&&Ft.iceTransport!==At.transceivers[0].iceTransport)&&!st(Ft.iceTransport,Ht))return wt(Rt("OperationError","Can not add ICE candidate"));var Wt=It.candidate.trim();Wt.indexOf("a=")===0&&(Wt=Wt.substr(2)),(xt=ht.getMediaSections(At._remoteDescription.sdp))[Mt]+="a="+(Ht.type?Wt:"end-of-candidates")+`\r
`,At._remoteDescription.sdp=ht.getDescription(At._remoteDescription.sdp)+xt.join("")}else for(var tn=0;tn<At.transceivers.length&&(At.transceivers[tn].rejected||(At.transceivers[tn].iceTransport.addRemoteCandidate({}),xt=ht.getMediaSections(At._remoteDescription.sdp),xt[tn]+=`a=end-of-candidates\r
`,At._remoteDescription.sdp=ht.getDescription(At._remoteDescription.sdp)+xt.join(""),!At.usingBundle));tn++);Dt()})},ft.prototype.getStats=function(It){if(It&&It instanceof bt.MediaStreamTrack){var xt=null;if(this.transceivers.forEach(function(Dt){Dt.rtpSender&&Dt.rtpSender.track===It?xt=Dt.rtpSender:Dt.rtpReceiver&&Dt.rtpReceiver.track===It&&(xt=Dt.rtpReceiver)}),!xt)throw Rt("InvalidAccessError","Invalid selector.");return xt.getStats()}var At=[];return this.transceivers.forEach(function(Dt){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(wt){Dt[wt]&&At.push(Dt[wt].getStats())})}),Promise.all(At).then(function(Dt){var wt=new Map;return Dt.forEach(function(Mt){Mt.forEach(function(vt){wt.set(vt.id,vt)})}),wt})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(It){var xt=bt[It];if(xt&&xt.prototype&&xt.prototype.getStats){var At=xt.prototype.getStats;xt.prototype.getStats=function(){return At.apply(this).then(function(Dt){var wt=new Map;return Object.keys(Dt).forEach(function(Mt){Dt[Mt].type=it(Dt[Mt]),wt.set(Mt,Dt[Mt])}),wt})}}});var St=["createOffer","createAnswer"];return St.forEach(function(It){var xt=ft.prototype[It];ft.prototype[It]=function(){var At=arguments;return typeof At[0]=="function"||typeof At[1]=="function"?xt.apply(this,[arguments[2]]).then(function(Dt){typeof At[0]=="function"&&At[0].apply(null,[Dt])},function(Dt){typeof At[1]=="function"&&At[1].apply(null,[Dt])}):xt.apply(this,arguments)}}),(St=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(It){var xt=ft.prototype[It];ft.prototype[It]=function(){var At=arguments;return typeof At[1]=="function"||typeof At[2]=="function"?xt.apply(this,arguments).then(function(){typeof At[1]=="function"&&At[1].apply(null)},function(Dt){typeof At[2]=="function"&&At[2].apply(null,[Dt])}):xt.apply(this,arguments)}}),["getStats"].forEach(function(It){var xt=ft.prototype[It];ft.prototype[It]=function(){var At=arguments;return typeof At[1]=="function"?xt.apply(this,arguments).then(function(){typeof At[1]=="function"&&At[1].apply(null)}):xt.apply(this,arguments)}}),ft}},{sdp:17}],17:[function(tt,at,lt){var it={};it.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},it.localCName=it.generateIdentifier(),it.splitLines=function(ut){return ut.trim().split(`
`).map(function(s){return s.trim()})},it.splitSections=function(ut){return ut.split(`
m=`).map(function(s,et){return(et>0?"m="+s:s).trim()+`\r
`})},it.getDescription=function(ut){var s=it.splitSections(ut);return s&&s[0]},it.getMediaSections=function(ut){var s=it.splitSections(ut);return s.shift(),s},it.matchPrefix=function(ut,s){return it.splitLines(ut).filter(function(et){return et.indexOf(s)===0})},it.parseCandidate=function(ut){for(var s,et={foundation:(s=ut.indexOf("a=candidate:")===0?ut.substring(12).split(" "):ut.substring(10).split(" "))[0],component:parseInt(s[1],10),protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]},ot=8;ot<s.length;ot+=2)switch(s[ot]){case"raddr":et.relatedAddress=s[ot+1];break;case"rport":et.relatedPort=parseInt(s[ot+1],10);break;case"tcptype":et.tcpType=s[ot+1];break;case"ufrag":et.ufrag=s[ot+1],et.usernameFragment=s[ot+1];break;default:et[s[ot]]=s[ot+1]}return et},it.writeCandidate=function(ut){var s=[];s.push(ut.foundation),s.push(ut.component),s.push(ut.protocol.toUpperCase()),s.push(ut.priority),s.push(ut.address||ut.ip),s.push(ut.port);var et=ut.type;return s.push("typ"),s.push(et),et!=="host"&&ut.relatedAddress&&ut.relatedPort&&(s.push("raddr"),s.push(ut.relatedAddress),s.push("rport"),s.push(ut.relatedPort)),ut.tcpType&&ut.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(ut.tcpType)),(ut.usernameFragment||ut.ufrag)&&(s.push("ufrag"),s.push(ut.usernameFragment||ut.ufrag)),"candidate:"+s.join(" ")},it.parseIceOptions=function(ut){return ut.substr(14).split(" ")},it.parseRtpMap=function(ut){var s=ut.substr(9).split(" "),et={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),et.name=s[0],et.clockRate=parseInt(s[1],10),et.channels=s.length===3?parseInt(s[2],10):1,et.numChannels=et.channels,et},it.writeRtpMap=function(ut){var s=ut.payloadType;ut.preferredPayloadType!==void 0&&(s=ut.preferredPayloadType);var et=ut.channels||ut.numChannels||1;return"a=rtpmap:"+s+" "+ut.name+"/"+ut.clockRate+(et!==1?"/"+et:"")+`\r
`},it.parseExtmap=function(ut){var s=ut.substr(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1]}},it.writeExtmap=function(ut){return"a=extmap:"+(ut.id||ut.preferredId)+(ut.direction&&ut.direction!=="sendrecv"?"/"+ut.direction:"")+" "+ut.uri+`\r
`},it.parseFmtp=function(ut){for(var s,et={},ot=ut.substr(ut.indexOf(" ")+1).split(";"),st=0;st<ot.length;st++)et[(s=ot[st].trim().split("="))[0].trim()]=s[1];return et},it.writeFmtp=function(ut){var s="",et=ut.payloadType;if(ut.preferredPayloadType!==void 0&&(et=ut.preferredPayloadType),ut.parameters&&Object.keys(ut.parameters).length){var ot=[];Object.keys(ut.parameters).forEach(function(st){ut.parameters[st]?ot.push(st+"="+ut.parameters[st]):ot.push(st)}),s+="a=fmtp:"+et+" "+ot.join(";")+`\r
`}return s},it.parseRtcpFb=function(ut){var s=ut.substr(ut.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},it.writeRtcpFb=function(ut){var s="",et=ut.payloadType;return ut.preferredPayloadType!==void 0&&(et=ut.preferredPayloadType),ut.rtcpFeedback&&ut.rtcpFeedback.length&&ut.rtcpFeedback.forEach(function(ot){s+="a=rtcp-fb:"+et+" "+ot.type+(ot.parameter&&ot.parameter.length?" "+ot.parameter:"")+`\r
`}),s},it.parseSsrcMedia=function(ut){var s=ut.indexOf(" "),et={ssrc:parseInt(ut.substr(7,s-7),10)},ot=ut.indexOf(":",s);return ot>-1?(et.attribute=ut.substr(s+1,ot-s-1),et.value=ut.substr(ot+1)):et.attribute=ut.substr(s+1),et},it.parseSsrcGroup=function(ut){var s=ut.substr(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(function(et){return parseInt(et,10)})}},it.getMid=function(ut){var s=it.matchPrefix(ut,"a=mid:")[0];if(s)return s.substr(6)},it.parseFingerprint=function(ut){var s=ut.substr(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1]}},it.getDtlsParameters=function(ut,s){return{role:"auto",fingerprints:it.matchPrefix(ut+s,"a=fingerprint:").map(it.parseFingerprint)}},it.writeDtlsParameters=function(ut,s){var et="a=setup:"+s+`\r
`;return ut.fingerprints.forEach(function(ot){et+="a=fingerprint:"+ot.algorithm+" "+ot.value+`\r
`}),et},it.getIceParameters=function(ut,s){var et=it.splitLines(ut);return{usernameFragment:(et=et.concat(it.splitLines(s))).filter(function(ot){return ot.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:et.filter(function(ot){return ot.indexOf("a=ice-pwd:")===0})[0].substr(10)}},it.writeIceParameters=function(ut){return"a=ice-ufrag:"+ut.usernameFragment+`\r
a=ice-pwd:`+ut.password+`\r
`},it.parseRtpParameters=function(ut){for(var s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},et=it.splitLines(ut)[0].split(" "),ot=3;ot<et.length;ot++){var st=et[ot],Rt=it.matchPrefix(ut,"a=rtpmap:"+st+" ")[0];if(Rt){var ht=it.parseRtpMap(Rt),bt=it.matchPrefix(ut,"a=fmtp:"+st+" ");switch(ht.parameters=bt.length?it.parseFmtp(bt[0]):{},ht.rtcpFeedback=it.matchPrefix(ut,"a=rtcp-fb:"+st+" ").map(it.parseRtcpFb),s.codecs.push(ht),ht.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(ht.name.toUpperCase())}}}return it.matchPrefix(ut,"a=extmap:").forEach(function(ct){s.headerExtensions.push(it.parseExtmap(ct))}),s},it.writeRtpDescription=function(ut,s){var et="";et+="m="+ut+" ",et+=s.codecs.length>0?"9":"0",et+=" UDP/TLS/RTP/SAVPF ",et+=s.codecs.map(function(st){return st.preferredPayloadType!==void 0?st.preferredPayloadType:st.payloadType}).join(" ")+`\r
`,et+=`c=IN IP4 0.0.0.0\r
`,et+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(function(st){et+=it.writeRtpMap(st),et+=it.writeFmtp(st),et+=it.writeRtcpFb(st)});var ot=0;return s.codecs.forEach(function(st){st.maxptime>ot&&(ot=st.maxptime)}),ot>0&&(et+="a=maxptime:"+ot+`\r
`),et+=`a=rtcp-mux\r
`,s.headerExtensions&&s.headerExtensions.forEach(function(st){et+=it.writeExtmap(st)}),et},it.parseRtpEncodingParameters=function(ut){var s,et=[],ot=it.parseRtpParameters(ut),st=ot.fecMechanisms.indexOf("RED")!==-1,Rt=ot.fecMechanisms.indexOf("ULPFEC")!==-1,ht=it.matchPrefix(ut,"a=ssrc:").map(function(rt){return it.parseSsrcMedia(rt)}).filter(function(rt){return rt.attribute==="cname"}),bt=ht.length>0&&ht[0].ssrc,ct=it.matchPrefix(ut,"a=ssrc-group:FID").map(function(rt){return rt.substr(17).split(" ").map(function(pt){return parseInt(pt,10)})});ct.length>0&&ct[0].length>1&&ct[0][0]===bt&&(s=ct[0][1]),ot.codecs.forEach(function(rt){if(rt.name.toUpperCase()==="RTX"&&rt.parameters.apt){var pt={ssrc:bt,codecPayloadType:parseInt(rt.parameters.apt,10)};bt&&s&&(pt.rtx={ssrc:s}),et.push(pt),st&&((pt=JSON.parse(JSON.stringify(pt))).fec={ssrc:bt,mechanism:Rt?"red+ulpfec":"red"},et.push(pt))}}),et.length===0&&bt&&et.push({ssrc:bt});var mt=it.matchPrefix(ut,"b=");return mt.length&&(mt=mt[0].indexOf("b=TIAS:")===0?parseInt(mt[0].substr(7),10):mt[0].indexOf("b=AS:")===0?1e3*parseInt(mt[0].substr(5),10)*.95-16e3:void 0,et.forEach(function(rt){rt.maxBitrate=mt})),et},it.parseRtcpParameters=function(ut){var s={},et=it.matchPrefix(ut,"a=ssrc:").map(function(Rt){return it.parseSsrcMedia(Rt)}).filter(function(Rt){return Rt.attribute==="cname"})[0];et&&(s.cname=et.value,s.ssrc=et.ssrc);var ot=it.matchPrefix(ut,"a=rtcp-rsize");s.reducedSize=ot.length>0,s.compound=ot.length===0;var st=it.matchPrefix(ut,"a=rtcp-mux");return s.mux=st.length>0,s},it.parseMsid=function(ut){var s,et=it.matchPrefix(ut,"a=msid:");if(et.length===1)return s=et[0].substr(7).split(" "),{stream:s[0],track:s[1]};var ot=it.matchPrefix(ut,"a=ssrc:").map(function(st){return it.parseSsrcMedia(st)}).filter(function(st){return st.attribute==="msid"});return ot.length>0?(s=ot[0].value.split(" "),{stream:s[0],track:s[1]}):void 0},it.generateSessionId=function(){return Math.random().toString().substr(2,21)},it.writeSessionBoilerplate=function(ut,s,et){var ot,st=s!==void 0?s:2;return ot=ut||it.generateSessionId(),`v=0\r
o=`+(et||"thisisadapterortc")+" "+ot+" "+st+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},it.writeMediaSection=function(ut,s,et,ot){var st=it.writeRtpDescription(ut.kind,s);if(st+=it.writeIceParameters(ut.iceGatherer.getLocalParameters()),st+=it.writeDtlsParameters(ut.dtlsTransport.getLocalParameters(),et==="offer"?"actpass":"active"),st+="a=mid:"+ut.mid+`\r
`,ut.direction?st+="a="+ut.direction+`\r
`:ut.rtpSender&&ut.rtpReceiver?st+=`a=sendrecv\r
`:ut.rtpSender?st+=`a=sendonly\r
`:ut.rtpReceiver?st+=`a=recvonly\r
`:st+=`a=inactive\r
`,ut.rtpSender){var Rt="msid:"+ot.id+" "+ut.rtpSender.track.id+`\r
`;st+="a="+Rt,st+="a=ssrc:"+ut.sendEncodingParameters[0].ssrc+" "+Rt,ut.sendEncodingParameters[0].rtx&&(st+="a=ssrc:"+ut.sendEncodingParameters[0].rtx.ssrc+" "+Rt,st+="a=ssrc-group:FID "+ut.sendEncodingParameters[0].ssrc+" "+ut.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return st+="a=ssrc:"+ut.sendEncodingParameters[0].ssrc+" cname:"+it.localCName+`\r
`,ut.rtpSender&&ut.sendEncodingParameters[0].rtx&&(st+="a=ssrc:"+ut.sendEncodingParameters[0].rtx.ssrc+" cname:"+it.localCName+`\r
`),st},it.getDirection=function(ut,s){for(var et=it.splitLines(ut),ot=0;ot<et.length;ot++)switch(et[ot]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return et[ot].substr(2)}return s?it.getDirection(s):"sendrecv"},it.getKind=function(ut){return it.splitLines(ut)[0].split(" ")[0].substr(2)},it.isRejected=function(ut){return ut.split(" ",2)[1]==="0"},it.parseMLine=function(ut){var s=it.splitLines(ut)[0].substr(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},it.parseOLine=function(ut){var s=it.matchPrefix(ut,"o=")[0].substr(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},it.isValidSDP=function(ut){if(typeof ut!="string"||ut.length===0)return!1;for(var s=it.splitLines(ut),et=0;et<s.length;et++)if(s[et].length<2||s[et].charAt(1)!=="=")return!1;return!0},typeof at=="object"&&(at.exports=it)},{}]},{},[1])(1)}),function(tt){function at(Mt){if(typeof Mt!="string"&&(Mt=String(Mt)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(Mt))throw new TypeError("Invalid character in header field name");return Mt.toLowerCase()}function lt(Mt){return typeof Mt!="string"&&(Mt=String(Mt)),Mt}function it(Mt){var vt={next:function(){var Ft=Mt.shift();return{done:Ft===void 0,value:Ft}}};return St.iterable&&(vt[Symbol.iterator]=function(){return vt}),vt}function ut(Mt){this.map={},Mt instanceof ut?Mt.forEach(function(vt,Ft){this.append(Ft,vt)},this):Array.isArray(Mt)?Mt.forEach(function(vt){this.append(vt[0],vt[1])},this):Mt&&Object.getOwnPropertyNames(Mt).forEach(function(vt){this.append(vt,Mt[vt])},this)}function s(Mt){if(Mt.bodyUsed)return Promise.reject(new TypeError("Already read"));Mt.bodyUsed=!0}function et(Mt){return new Promise(function(vt,Ft){Mt.onload=function(){vt(Mt.result)},Mt.onerror=function(){Ft(Mt.error)}})}function ot(Mt){var vt=new FileReader,Ft=et(vt);return vt.readAsArrayBuffer(Mt),Ft}function st(Mt){var vt=new FileReader,Ft=et(vt);return vt.readAsText(Mt),Ft}function Rt(Mt){for(var vt=new Uint8Array(Mt),Ft=new Array(vt.length),Ht=0;Ht<vt.length;Ht++)Ft[Ht]=String.fromCharCode(vt[Ht]);return Ft.join("")}function ht(Mt){if(Mt.slice)return Mt.slice(0);var vt=new Uint8Array(Mt.byteLength);return vt.set(new Uint8Array(Mt)),vt.buffer}function bt(){return this.bodyUsed=!1,this._initBody=function(Mt){if(this._bodyInit=Mt,Mt)if(typeof Mt=="string")this._bodyText=Mt;else if(St.blob&&Blob.prototype.isPrototypeOf(Mt))this._bodyBlob=Mt;else if(St.formData&&FormData.prototype.isPrototypeOf(Mt))this._bodyFormData=Mt;else if(St.searchParams&&URLSearchParams.prototype.isPrototypeOf(Mt))this._bodyText=Mt.toString();else if(St.arrayBuffer&&St.blob&&xt(Mt))this._bodyArrayBuffer=ht(Mt.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!St.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(Mt)&&!At(Mt))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=ht(Mt)}else this._bodyText="";this.headers.get("content-type")||(typeof Mt=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):St.searchParams&&URLSearchParams.prototype.isPrototypeOf(Mt)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},St.blob&&(this.blob=function(){var Mt=s(this);if(Mt)return Mt;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?s(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ot)}),this.text=function(){var Mt=s(this);if(Mt)return Mt;if(this._bodyBlob)return st(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(Rt(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},St.formData&&(this.formData=function(){return this.text().then(rt)}),this.json=function(){return this.text().then(JSON.parse)},this}function ct(Mt){var vt=Mt.toUpperCase();return Dt.indexOf(vt)>-1?vt:Mt}function mt(Mt,vt){var Ft=(vt=vt||{}).body;if(Mt instanceof mt){if(Mt.bodyUsed)throw new TypeError("Already read");this.url=Mt.url,this.credentials=Mt.credentials,vt.headers||(this.headers=new ut(Mt.headers)),this.method=Mt.method,this.mode=Mt.mode,Ft||Mt._bodyInit==null||(Ft=Mt._bodyInit,Mt.bodyUsed=!0)}else this.url=String(Mt);if(this.credentials=vt.credentials||this.credentials||"omit",!vt.headers&&this.headers||(this.headers=new ut(vt.headers)),this.method=ct(vt.method||this.method||"GET"),this.mode=vt.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Ft)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Ft)}function rt(Mt){var vt=new FormData;return Mt.trim().split("&").forEach(function(Ft){if(Ft){var Ht=Ft.split("="),Wt=Ht.shift().replace(/\+/g," "),tn=Ht.join("=").replace(/\+/g," ");vt.append(decodeURIComponent(Wt),decodeURIComponent(tn))}}),vt}function pt(Mt){var vt=new ut;return Mt.split(/\r?\n/).forEach(function(Ft){var Ht=Ft.split(":"),Wt=Ht.shift().trim();if(Wt){var tn=Ht.join(":").trim();vt.append(Wt,tn)}}),vt}function ft(Mt,vt){vt||(vt={}),this.type="default",this.status="status"in vt?vt.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in vt?vt.statusText:"OK",this.headers=new ut(vt.headers),this.url=vt.url||"",this._initBody(Mt)}if(!tt.fetch){var St={searchParams:"URLSearchParams"in tt,iterable:"Symbol"in tt&&"iterator"in Symbol,blob:"FileReader"in tt&&"Blob"in tt&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in tt,arrayBuffer:"ArrayBuffer"in tt};if(St.arrayBuffer)var It=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],xt=function(Mt){return Mt&&DataView.prototype.isPrototypeOf(Mt)},At=ArrayBuffer.isView||function(Mt){return Mt&&It.indexOf(Object.prototype.toString.call(Mt))>-1};ut.prototype.append=function(Mt,vt){Mt=at(Mt),vt=lt(vt);var Ft=this.map[Mt];this.map[Mt]=Ft?Ft+","+vt:vt},ut.prototype.delete=function(Mt){delete this.map[at(Mt)]},ut.prototype.get=function(Mt){return Mt=at(Mt),this.has(Mt)?this.map[Mt]:null},ut.prototype.has=function(Mt){return this.map.hasOwnProperty(at(Mt))},ut.prototype.set=function(Mt,vt){this.map[at(Mt)]=lt(vt)},ut.prototype.forEach=function(Mt,vt){for(var Ft in this.map)this.map.hasOwnProperty(Ft)&&Mt.call(vt,this.map[Ft],Ft,this)},ut.prototype.keys=function(){var Mt=[];return this.forEach(function(vt,Ft){Mt.push(Ft)}),it(Mt)},ut.prototype.values=function(){var Mt=[];return this.forEach(function(vt){Mt.push(vt)}),it(Mt)},ut.prototype.entries=function(){var Mt=[];return this.forEach(function(vt,Ft){Mt.push([Ft,vt])}),it(Mt)},St.iterable&&(ut.prototype[Symbol.iterator]=ut.prototype.entries);var Dt=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];mt.prototype.clone=function(){return new mt(this,{body:this._bodyInit})},bt.call(mt.prototype),bt.call(ft.prototype),ft.prototype.clone=function(){return new ft(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new ut(this.headers),url:this.url})},ft.error=function(){var Mt=new ft(null,{status:0,statusText:""});return Mt.type="error",Mt};var wt=[301,302,303,307,308];ft.redirect=function(Mt,vt){if(wt.indexOf(vt)===-1)throw new RangeError("Invalid status code");return new ft(null,{status:vt,headers:{location:Mt}})},tt.Headers=ut,tt.Request=mt,tt.Response=ft,tt.fetch=function(Mt,vt){return new Promise(function(Ft,Ht){var Wt=new mt(Mt,vt),tn=new XMLHttpRequest;tn.onload=function(){var gn={status:tn.status,statusText:tn.statusText,headers:pt(tn.getAllResponseHeaders()||"")};gn.url="responseURL"in tn?tn.responseURL:gn.headers.get("X-Request-URL");var nn="response"in tn?tn.response:tn.responseText;Ft(new ft(nn,gn))},tn.onerror=function(){Ht(new TypeError("Network request failed"))},tn.ontimeout=function(){Ht(new TypeError("Network request failed"))},tn.open(Wt.method,Wt.url,!0),Wt.credentials==="include"&&(tn.withCredentials=!0),"responseType"in tn&&St.blob&&(tn.responseType="blob"),Wt.headers.forEach(function(gn,nn){tn.setRequestHeader(nn,gn)}),tn.send(Wt._bodyInit===void 0?null:Wt._bodyInit)})},tt.fetch.polyfill=!0}}(typeof self<"u"?self:commonjsGlobal);var _e={};_e=function(){function tt(bt,ct){var mt,rt,pt,ft=[],St=(bt=bt.push?bt:[bt]).length,It=St;for(mt=function(xt,At){At.length&&ft.push(xt),--It||ct(ft)};St--;)rt=bt[St],(pt=st[rt])?mt(rt,pt):(Rt[rt]=Rt[rt]||[]).push(mt)}function at(bt,ct){if(bt){var mt=Rt[bt];if(st[bt]=ct,mt)for(;mt.length;)mt[0](bt,ct),mt.splice(0,1)}}function lt(bt,ct){bt.call&&(bt={success:bt}),ct.length?(bt.error||et)(ct):(bt.success||et)(bt)}function it(bt,ct,mt,rt){var pt,ft,St=document,It=mt.async,xt=(mt.numRetries||0)+1,At=mt.before||et,Dt=bt.replace(/^(css|img)!/,""),wt=mt.reqdelay||0;rt=rt||0,/(^css!|\.css$)/.test(bt)?(pt=!0,(ft=St.createElement("link")).rel="stylesheet",ft.href=Dt):/(^img!|\.(png|gif|jpg|svg)$)/.test(bt)?(ft=St.createElement("img")).src=Dt:((ft=St.createElement("script")).src=bt,ft.async=It===void 0||It),ft.onload=ft.onerror=ft.onbeforeload=function(Mt){var vt=Mt.type[0];if(pt&&"hideFocus"in ft)try{ft.sheet.cssText.length||(vt="e")}catch{vt="e"}if(vt=="e"&&(rt+=1)<xt)return ht=wt*rt,setTimeout(function(){it(bt,ct,mt,rt)},ht),void(mt.retrycb&&mt.retrycb(rt,ht));ct(bt,vt,Mt.defaultPrevented)},At(bt,ft)!==!1&&St.head.appendChild(ft)}function ut(bt,ct,mt){var rt,pt,ft=(bt=bt.push?bt:[bt]).length,St=ft,It=[];for(rt=function(xt,At,Dt){if(At=="e"&&It.push(xt),At=="b"){if(!Dt)return;It.push(xt)}--ft||ct(It)},pt=0;pt<St;pt++)it(bt[pt],rt,mt)}function s(bt,ct,mt){var rt,pt;ct&&ct.trim&&(rt=ct),ut(bt,function(ft){lt(pt,ft),at(rt,ft)},pt=(rt?mt:ct)||{})}var et=function(){},ot={},st={},Rt={},ht=0;return s.ready=function(bt,ct){return tt(bt,function(mt){lt(ct,mt)}),s},s.done=function(bt){at(bt,[])},s.reset=function(){ot={},st={},Rt={}},s.isDefined=function(bt){return bt in ot},s}(),function(tt,at){var lt={};lt.load=function(it,ut,s){if(typeof _e!==void 0&&typeof apiRTC_React>"u"){var et={async:!0,numRetries:ut.extJsLoadingRetryNb||100,reqdelay:ut.extJsLoadingRetryDelay||200,success:function(){tt.rtcio=io,s.success()},error:function(ot){console.error("socket.io loading error"),s.error()},retrycb:function(ot,st){console.warn("socket.io loading retry :"+ot+" ,delay before retry :"+st),s.retrycb()}};ut.socketioUrl!==void 0?_e([ut.socketioUrl],"socketio",et):_e([it+"://"+ut.ccsServer+"/socket.io/v3/socket.io.js"],"socketio",et)}else console.log("Else loadjs io"),tt.rtcio=io,s.success()},tt.apiRTC_sioLoader=lt}(window);/*! For license information please see apiRTC-srcTmp.js.LICENSE.txt */(function(tt,at){a.exports=at()})(self,()=>(()=>{var tt={8364:function(it,ut,s){var et,ot=this&&this.__extends||(et=function(xt,At){return(et=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(Dt,wt){Dt.__proto__=wt}:function(Dt,wt){for(var Mt in wt)Object.prototype.hasOwnProperty.call(wt,Mt)&&(Dt[Mt]=wt[Mt])}))(xt,At)},function(xt,At){if(typeof At!="function"&&At!==null)throw new TypeError("Class extends value "+String(At)+" is not a constructor or null");function Dt(){this.constructor=xt}et(xt,At),xt.prototype=At===null?Object.create(At):(Dt.prototype=At.prototype,new Dt)}),st=(Object.defineProperty(ut,"__esModule",{value:!0}),s(2043)),Rt=s(7987),ht=st.getLogger("CloudAPI"),bt=(Rt.reg(st),Rt.apply(ht,{format:function(xt,At,Dt){return"".concat(Dt," - [").concat(xt,"] ").concat(At," : ")}}),ht.setDefaultLevel("error"),ht.setLevel("error"),"https://cloud.apizee.com"),ct="/api/v2/media/upload",mt="/api/v2/conversation/{convId}/media",rt="/api/v2/conferences",pt={updateWebconfTags:{fetchRetryCount:3,fetchRetryDelay:500}},ft=null,St=function(){function xt(){if(this.cloudUrl=bt,this.JWTApzToken="",this.fetchRetries=100,this.fetchRetryDelay=200,ft!==null)return ht.debug("Cannot construct multiple CloudAPI, this is a singleton."),ft;ft=this}return xt.get=function(){return ft=ft===null?new xt:ft},xt.prototype.setLogLevel=function(At){ht.setLevel(At)},xt.prototype.getLogLevel=function(){var At="";switch(ht.getLevel()){case 0:At="trace";break;case 1:At="debug";break;case 2:At="info";break;case 3:At="warn";break;case 4:At="error";break;case 5:At="silent"}return At},xt.prototype.setCloudURL=function(At){ht.debug("setCloudURL :",At),this.cloudUrl=At},xt.prototype.setJWTApzToken=function(At){this.JWTApzToken=At},xt.prototype.setFetchRetries=function(At){ht.debug("setFetchRetries :",At),At!=null&&(this.fetchRetries=At)},xt.prototype.setFetchRetryDelay=function(At){ht.log("setFetchRetryDelay :",At),At!=null&&(this.fetchRetryDelay=At)},xt.prototype.request=function(At,Dt,wt,Mt,vt,Ft){vt===void 0&&(vt={}),Ft===void 0&&(Ft={});var Ht=At.indexOf(this.cloudUrl)===-1?this.cloudUrl+At:At,Wt=null;return new Promise(function(tn,gn){var nn,qt=new XMLHttpRequest;if(Ft.hasOwnProperty("withCredentials")&&(qt.withCredentials=Ft.withCredentials),qt.onreadystatechange=function(yn){if(qt.readyState===XMLHttpRequest.DONE)if(ht.debug("request onreadystatechange status :",qt.status),200<=qt.status&&qt.status<300)if(qt.responseText){var pn=null;try{pn=JSON.parse(qt.responseText)}catch{pn=qt.responseText}tn(pn)}else tn("No_responseTest");else{if(pn={status:qt.status,text:qt.statusText},qt.responseText)try{pn.response=JSON.parse(qt.responseText)}catch{pn.responseText=qt.responseText}gn(pn)}},qt.onprogress=function(yn){typeof Mt=="function"&&Mt(yn)},qt.onerror=function(yn){gn(yn)},wt==="GET")0<Object.keys(Dt).length&&(nn=new URLSearchParams(Dt),ht.debug("johann",nn,nn.toString,Dt),Ht+="?"+nn.toString());else{Wt=new FormData;for(var fn=0,Cn=Object.keys(Dt);fn<Cn.length;fn++){var Tn=Cn[fn];Wt.append(Tn,Dt[Tn])}}if(qt.open(wt,Ht,!0),vt!=null)for(var un=0,mn=Object.keys(vt);un<mn.length;un++)Tn=mn[un],qt.setRequestHeader(Tn,vt[Tn]);qt.send(Wt)})},xt.prototype.get=function(At,Dt,wt,Mt){return wt===void 0&&(wt={}),Mt===void 0&&(Mt={}),ht.log("Send HTTP request : GET ".concat(At)),this.request(At,Dt,"GET",null,wt,Mt)},xt.prototype.post=function(At,Dt,wt,Mt){return ht.log("Send HTTP request : POST ".concat(At)),this.request(At,Dt,"POST",wt,Mt)},xt.prototype.put=function(At,Dt,wt,Mt){return ht.log("Send HTTP request : PUT ".concat(At)),(Dt=Dt!==null&&typeof Dt=="object"?Dt:{})._method="PUT",this.request(At,Dt,"POST",wt,Mt)},xt.prototype.delete=function(At,Dt,wt){return ht.log("Send HTTP request : DELETE ".concat(At)),(Dt=Dt!==null&&typeof Dt=="object"?Dt:{})._method="DELETE",this.request(At,Dt,"POST",null,wt)},xt.prototype.cloudRequest=function(At,Dt,wt,Mt){var vt=this;return Mt===void 0&&(Mt={}),new Promise(function(Ft,Ht){ht.trace(wt+" cloudRequest to "+ft.cloudUrl,Dt);var Wt={method:wt.toUpperCase()},tn=ft.cloudUrl+At;if(Wt.method==="GET")0<Object.keys(Dt).length&&(tn+="?"+new URLSearchParams(Dt).toString());else{for(var gn=new FormData,nn=0,qt=Object.keys(Dt);nn<qt.length;nn++){var fn=qt[nn];gn.append(fn,Dt[fn])}Wt.body=gn}Mt.hasOwnProperty("bearerToken")?Wt.headers={Authorization:"Bearer "+Mt.bearerToken}:vt.JWTApzToken!==""&&(Wt.headers={Authorization:"Bearer "+vt.JWTApzToken}),Mt.hasOwnProperty("fetchRetryCount")?Wt.retries=Mt.fetchRetryCount:Wt.retries=vt.fetchRetries,Mt.hasOwnProperty("fetchRetryDelay")?Wt.retryDelay=Mt.fetchRetryDelay:Wt.retryDelay=vt.fetchRetryDelay,function(Cn,Tn){ht.log("fetchRetry");var un=3,mn=1e3,yn=[];if(Tn&&Tn.retries&&(un=Tn.retries),Tn&&Tn.retryDelay&&(mn=Tn.retryDelay),Tn&&Tn.retryOn){if(!(Tn.retryOn instanceof Array))throw{name:"ArgumentError",message:"retryOn property expects an array"};yn=Tn.retryOn}return new Promise(function(pn,In){function kn(xn){var Pn,On;ht.log("wrappedFetch n:",xn),window.fetch!==void 0?fetch(Cn,Tn).then(function(Dn){yn.indexOf(Dn.status)===-1?pn(Dn):0<xn?Mn(xn):In(Dn)}).catch(function(Dn){0<xn?Mn(xn):In(Dn)}):(ht.debug("Cannot use fetch in this browser, using XHR"),Pn=St.get(),On={},Tn.body&&Tn.body.forEach(function(Dn,Fn){return On[Fn]=Dn}),Pn.request(Cn,On,Tn.method,null,Tn.headers).then(function(Dn){pn({gettype:"cloudApiNoFetch",response:Dn})}).catch(function(Dn){ht.error("error :",Dn),In(Dn)}))}function Mn(xn){ht.error("retry n:",xn);var Pn=un-xn+1;ht.error("retry number is :",Pn),setTimeout(function(){kn(--xn)},mn*Pn)}kn(un)})}(tn,Wt).then(function(Cn){if(Cn.gettype==="cloudApiNoFetch")return Ft(Cn.response);Cn.json().then(function(Tn){var un;if(Cn.status<200||299<Cn.status)return un="cloudRequest - response status Code: "+Cn.status,ht.warn(un),un=new It(un,13,Cn.status,Tn),Ht(un);Ft(Tn)}).catch(function(Tn){return ht.error("json err :",Tn),Ht(new It("cloudRequest - json() Error: "+Tn.text,0,Cn.status,{}))})}).catch(function(Cn){return ht.error("Fetch Error :",Cn),Ht(new It("cloudRequest - Fetch Error: "+Cn.text,13,Cn.status,Cn.response))})})},xt.prototype.cloudFetchMedia=function(At){var Dt=this;return new Promise(function(wt,Mt){var vt={};Dt.JWTApzToken!==""&&(vt={Authorization:"Bearer "+Dt.JWTApzToken}),fetch(At,{headers:vt}).then(function(Ft){return Ft.blob()}).then(function(Ft){wt(Ft)}).catch(function(Ft){Mt(Ft)})})},xt.prototype.authentication=function(At,Dt,wt){return ht.debug("authentication to "+ft.cloudUrl),At={username:At,password:Dt},wt!==void 0&&wt!==""&&(At.captcha_token=wt),this.cloudRequest("/api/v3/authenticate",At,"POST")},xt.prototype.getConnectedUserInformation=function(At){return ht.debug("getConnectedUserInformation to "+ft.cloudUrl),this.cloudRequest("/api/v2/users/me",{},"GET",{bearerToken:At})},xt.prototype.getUserProfile=function(At,Dt,wt){return ht.debug("getUserProfile to "+ft.cloudUrl),typeof At!="string"||typeof Dt!="string"?Promise.reject("wrongArguments"):(At={apiKey:At},this.cloudRequest("/api/v3/users/{userId}/profile".replace("{userId}",Dt),At,"GET",{bearerToken:wt}))},xt.prototype.getSiteAgents=function(At,Dt,wt){return wt===void 0&&(wt={}),ht.debug("getSiteAgents to "+ft.cloudUrl),typeof At!="string"||typeof Dt!="string"?Promise.reject("wrongArguments"):(At={apiKey:At},wt.useAcd&&(At.useAcd=1),wt.usePresence&&(At.usePresence=1),wt.convId&&(At.convId=wt.convId),this.cloudRequest("/api/v2/sites/{siteKey}/agents".replace("{siteKey}",Dt),At,"GET"))},xt.prototype.getEnterpriseInformation=function(At,Dt){return At===void 0&&(At={}),ht.debug("getEnterpriseInformation to "+ft.cloudUrl),this.cloudRequest("/api/v3/enterpriseInformation",At,"GET",{bearerToken:Dt})},xt.prototype.getPreferredCCS=function(At){return ht.debug("getPreferredCCS to "+ft.cloudUrl),this.cloudRequest("/api/v2/preferredCCS",{apiKey:At},"GET")},xt.prototype.checkUserToken=function(At){return ht.debug("checkUserToken to "+ft.cloudUrl),this.cloudRequest("/api/v2/checkToken",{},"GET",{bearerToken:At})},xt.prototype.invalidateUserToken=function(At){return ht.debug("invalidateUserToken to "+ft.cloudUrl),this.cloudRequest("/api/v2/invalidateToken",{},"POST",{bearerToken:At})},xt.prototype.uploadFile=function(At,Dt,wt){ht.debug("uploadMedia to "+ft.cloudUrl);var Mt={file:At};if(wt!=null)for(var vt=0,Ft=Object.keys(wt);vt<Ft.length;vt++){var Ht=Ft[vt];Mt[Ht]=wt[Ht]}return this.cloudRequest(ct,Mt,"POST",{bearerToken:Dt})},xt.prototype.uploadSnapshot=function(At,Dt,wt){wt===void 0&&(wt={}),ht.debug("uploadSnapshot to "+ft.cloudUrl);for(var Mt={dataUri:1,file:At},vt=0,Ft=Object.keys(wt);vt<Ft.length;vt++){var Ht=Ft[vt];Mt[Ht]=wt[Ht]}return this.cloudRequest(ct,Mt,"POST",{bearerToken:Dt})},xt.prototype.getEnterpriseUserList=function(At,Dt){return ht.debug("getEnterpriseUserList to "+ft.cloudUrl),this.cloudRequest("/api/v2/enterprises/{enterpriseId}/users".replace("{enterpriseId}",At),{json:!0},"GET",{bearerToken:Dt})},xt.prototype.getEnterpriseTagList=function(At,Dt,wt){return wt===void 0&&(wt={}),ht.debug("getEnterpriseTagList to "+ft.cloudUrl),wt.hasOwnProperty("webconfId")&&wt.webconfId,this.cloudRequest("/api/v2/enterprises/{enterpriseId}/tags".replace("{enterpriseId}",At),{},"GET",{bearerToken:Dt})},xt.prototype.updateWebconfTags=function(At,Dt,wt,Mt){return ht.debug("updateWebconfTags to "+ft.cloudUrl),wt={_method:"PUT",tags:wt.join(",")},function(vt,Ft){if(vt!==null&&typeof vt=="object"||(vt={}),pt.hasOwnProperty(Ft))for(var Ht=pt[Ft],Wt=0,tn=["fetchRetryCount","fetchRetryDelay"];Wt<tn.length;Wt++){var gn=tn[Wt];Ht.hasOwnProperty(gn)&&(vt[gn]=Ht[gn])}}(Mt={bearerToken:Mt},"updateWebconfTags"),this.cloudRequest("/api/enterprises/{enterpriseId}/conferences/{conferenceId}".replace("{enterpriseId}",At).replace("{conferenceId}",Dt),wt,"POST",Mt)},xt.prototype.getConferenceList=function(At){return ht.debug("getConferenceList to "+ft.cloudUrl),this.cloudRequest(rt,{},"GET",{bearerToken:At})},xt.prototype.getOrCreateConversation=function(At,Dt,wt){return wt===void 0&&(wt={}),ht.debug("getOrCreateConversation to "+ft.cloudUrl),At===null||typeof At!="object"||typeof Dt!="string"?Promise.reject("wrongArguments"):(At={name:At._getTechnicalName(),type:At.getType(),apiKey:Dt},Dt={},wt.hasOwnProperty("token")&&wt.token&&(Dt.bearerToken=wt.token),wt.hasOwnProperty("active")&&typeof wt.active=="boolean"&&(At.active=1),this.cloudRequest("/api/v2/conversation",At,"POST",Dt))},xt.prototype.createConference=function(At,Dt,wt){return wt===void 0&&(wt={}),ht.debug("createConference to "+ft.cloudUrl),Dt={name:Dt},wt.hasOwnProperty("password")&&(Dt.password=wt.password),this.cloudRequest(rt,Dt,"POST",{bearerToken:At})},xt.prototype.checkConferenceAccess=function(At,Dt,wt){var Mt;return wt===void 0&&(wt={}),ht.debug("checkConferenceAccess for "+At+" to "+ft.cloudUrl),typeof Dt!="string"?Promise.reject("wrongArguments"):(Dt={apiKey:Dt},wt.convId&&(Dt.conv_id=wt.convId),wt.hasOwnProperty("password")&&(Dt.password=wt.password),Mt={},wt.hasOwnProperty("session")&&typeof wt.session.getToken=="function"&&wt.session.getToken()!==null&&(Mt.bearerToken=wt.session.getToken()),this.cloudRequest("/api/v2/conferences/{roomname}/checkAccess".replace("{roomname}",At),Dt,"POST",Mt))},xt.prototype.getWebconf=function(At,Dt){Dt===void 0&&(Dt={}),ht.debug("getWebconf for "+At+" to "+ft.cloudUrl);var wt={};return Dt.hasOwnProperty("token")&&Dt.token&&(wt.bearerToken=Dt.token),this.cloudRequest("/api/v2/conferences/{roomname}".replace("{roomname}",At),{},"GET",wt)},xt.prototype.getWebconfConversation=function(At,Dt,wt){var Mt;return wt===void 0&&(wt={}),ht.debug("getWebconfConversation for "+At+" to "+ft.cloudUrl),typeof Dt!="string"?Promise.reject("wrongArguments"):(Dt={apiKey:Dt},Mt={},wt.hasOwnProperty("token")&&wt.token&&(Mt.bearerToken=wt.token),this.cloudRequest("/api/v2/conferences/{roomname}/conversation".replace("{roomname}",At),Dt,"GET",Mt))},xt.prototype.updateConferencePresence=function(At,Dt,wt){ht.trace("updateConferencePresence for "+At.getName()+" to "+ft.cloudUrl),wt={ccid:Dt.getId(),name:Dt.getUserAgent().getUsername(),instanceId:At.getInstanceId(),apiKey:wt};var Mt={};return Dt.getToken()!==null&&(Mt.bearerToken=Dt.getToken()),this.cloudRequest("/api/v2/conferences/{roomname}/updatePresence".replace("{roomname}",At._getTechnicalName()),wt,"POST",Mt)},xt.prototype.closeConferenceInstance=function(At,Dt){ht.debug("closeConferenceInstance for "+At.getName()+" to "+ft.cloudUrl);var wt={instanceId:At.getInstanceId()};return this.cloudRequest("/api/v2/conferences/{roomname}/closeInstance".replace("{roomname}",At._getTechnicalName()),wt,"POST",{bearerToken:Dt.getToken()})},xt.prototype.getConversationMediaList=function(At,Dt,wt){var Mt;return wt===void 0&&(wt={}),ht.debug("getConversationMediaList for "+At+" to "+ft.cloudUrl),At&&typeof Dt=="string"?(Dt={apiKey:Dt},Mt={},wt.hasOwnProperty("token")&&wt.token&&(Mt.bearerToken=wt.token),wt.hasOwnProperty("offset")&&(Dt.offset=wt.offset),wt.hasOwnProperty("limit")&&(Dt.limit=wt.limit),this.cloudRequest(mt.replace("{convId}",At.toString()),Dt,"GET",Mt)):Promise.reject("wrongArguments")},xt.prototype.pushConversationMedia=function(At,Dt,wt,Mt){return Mt===void 0&&(Mt={}),ht.debug("pushConversationMedia for "+At+" to "+ft.cloudUrl),At&&Dt&&typeof wt=="string"?(Dt={media:Dt,apiKey:wt},wt={},Mt.hasOwnProperty("token")&&Mt.token&&(wt.bearerToken=Mt.token),Mt.hasOwnProperty("metadata")&&Mt.metadata&&(Dt.metadata=Mt.metadata),Mt.hasOwnProperty("asFile")&&Mt.asFile&&(Dt.asFile=Mt.asFile),Mt.hasOwnProperty("filename")&&Mt.filename&&(Dt.filename=Mt.filename),Mt.overwrite===!0&&(Dt.overwrite=1),typeof Mt.ttl=="number"&&0<Mt.ttl&&(Dt.ttl=Mt.ttl),this.cloudRequest(mt.replace("{convId}",At.toString()),Dt,"POST",wt)):Promise.reject("wrongArguments")},xt.prototype.setConversationData=function(At,Dt,wt,Mt){return Mt===void 0&&(Mt={}),ht.debug("setConversationData for "+At+" to "+ft.cloudUrl),At&&typeof Dt=="string"&&typeof wt=="string"?(Dt={data:Dt,apiKey:wt},wt={},Mt.hasOwnProperty("token")&&Mt.token&&(wt.bearerToken=Mt.token),this.cloudRequest("/api/v2/conversation/{convId}/data".replace("{convId}",At.toString()),Dt,"POST",wt)):Promise.reject("wrongArguments")},xt.prototype.getSessionHistory=function(At,Dt,wt){wt===void 0&&(wt={}),ht.debug("getSessionHistory to "+ft.cloudUrl);var Mt={sessionId:At};if(wt!=null)for(var vt=0,Ft=Object.keys(wt);vt<Ft.length;vt++){var Ht=Ft[vt];Mt[Ht]=wt[Ht]}return this.cloudRequest("/api/v2/messages",Mt,"GET",{bearerToken:Dt})},xt.prototype.getWebSession=function(At,Dt,wt){return ht.debug("getSessionHistory to "+ft.cloudUrl),typeof wt!="string"?Promise.reject("wrongArguments"):(Dt={destId:Dt.getId(),apiKey:wt},wt={},At.getToken()!==null?wt.bearerToken=At.getToken():Dt.userId=At.getId(),this.cloudRequest("/api/v2/webSession",Dt,"GET",wt))},xt.prototype.saveNewMessage=function(At,Dt,wt,Mt,vt,Ft){return ht.debug("saveNewMessage to "+ft.cloudUrl),vt={uuid:vt,destId:wt,message:Mt,sessionId:At,userId:Dt.getId(),apiKey:Ft},wt={},Dt.getToken()!==null&&(wt.bearerToken=Dt.getToken()),this.cloudRequest("/api/v2/messages",vt,"POST",wt)},xt.prototype.saveGroupChatMessage=function(At,Dt,wt,Mt,vt,Ft){return Ft===void 0&&(Ft={}),ht.debug("saveGroupChatMessage to "+ft.cloudUrl),wt={apiKey:wt,message:Mt,ccid:Dt.getId(),name:Dt.getUserAgent().getUsername(),parent_conv_id:At.getCloudConversationId(),uuid:vt,htmlEnable:Ft.metadata&&Ft.metadata.htmlEnable||!1},Mt={},Ft.token!==void 0&&Ft.token!==null?Mt.bearerToken=Ft.token:Dt.getToken()!==null?Mt.bearerToken=Dt.getToken():wt.userId=Dt.getId(),this.cloudRequest("/api/v2/groupChatMessages",wt,"POST",Mt)},xt.prototype.loadGroupChatMessages=function(At,Dt,wt){wt===void 0&&(wt=""),ht.debug("loadGroupChatMessages to "+ft.cloudUrl),At={parent_conv_id:At.getCloudConversationId()};var Mt={};return Mt.bearerToken=wt!==""?wt:Dt.getToken(),this.cloudRequest("/api/v2/groupChatMessages",At,"GET",Mt)},xt}(),It=(ut.default=St,function(xt){function At(Dt,wt,Mt,vt){return(Dt=xt.call(this,Dt)||this).name=Dt.constructor.name,Dt.code=wt,Dt.httpCode=Mt,Dt.cloudResponse=vt,Dt}return ot(At,xt),At}(Error))},128:(it,ut,s)=>{s.d(ut,{_:()=>st}),s(2564);var et=s(1549).Y.get("ApiCCDataClient"),ot=apiCC.myWebRTC_Event,st=function(Rt){this.sendData=function(ht,bt,ct){et.info("Call sending data function .... to :"+ht+" message :",bt);var mt,rt,pt=Rt.channel.getNewCSeq(),ft=null;return mt={type:"dataMessage",senderId:Rt.apiCCId,dstRoomId:ht,data:bt,cSeq:pt},rt=JSON.stringify(mt),et.log("C->S: "+rt),ct!==void 0?(et.log("Ack management activated"),ft=setTimeout(function(){ct({reason:"timeoutReached",cSeq:pt}),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[pt]},Rt.messageTimeOutTimer),et.log("timeOutId: "+ft),Rt.messageTimeOutTable[pt]=ft,Rt.channel.socket.emit("dataMessage",rt,function(St){et.log("callback on dataMessage"),et.log("callback reason :"+St.reason),et.log("cSeq :"+St.cSeq),ct(St),apiCC.session.messageTimeOutTable[pt]!==void 0?(et.log("clearing timeOutId: "+apiCC.session.messageTimeOutTable[pt]),clearTimeout(apiCC.session.messageTimeOutTable[pt]),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[pt]):et.warn("messageTimeOutTable was already deleted : timeout may have been reached before Ack")})):(et.log("Ack management not activated"),Rt.channel.socket.emit("dataMessage",rt)),pt},this.sendDataToGroup=function(ht,bt){et.info("[ApiCCDataClient] sendDataToGroup - "+ht);var ct,mt=Rt.getConnectedUsersList(ht);for(ct=0;ct<mt.length;ct++)Rt.apiCCId!=mt[ct].userId&&this.sendData(mt[ct].userId,bt)},this.receiveData=function(ht){et.info("receiveData :"+ht.data),ot.createReceiveDataEvent(ht.senderId,ht.dstRoomId,ht.data)}}},6844:(it,ut,s)=>{s.d(ut,{U:()=>bt}),s(9554),s(1539),s(4747),s(2564),s(2526),s(1817),s(2165),s(6992),s(8783),s(3948);var et=s(1549),ot=s(4708),st=s(940);function Rt(ct){return Rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(mt){return typeof mt}:function(mt){return mt&&typeof Symbol=="function"&&mt.constructor===Symbol&&mt!==Symbol.prototype?"symbol":typeof mt},Rt(ct)}var ht=et.Y.get("ApiCCIMClient"),bt=function(ct,mt){this.convTable=[],this.myWebRTC_Event=apiCC.myWebRTC_Event,this.nickname=ct.nickname,this.photoURL=null,this.userDataSetted=!1,this.myWebRTC_Stack=new st.S(ct.channel.socket),this.findIMIdWithDestID=function(rt){var pt,ft=this.convTable.length;for(ht.log("findIMIdWithDestID = "+rt),pt=0;pt<ft;pt+=1)if(ht.log("this.convTable[i].dest_roomId = "+this.convTable[pt].dest_roomId),this.convTable[pt].dest_roomId==rt)return this.convTable[pt].IMId;return ht.log("Conversation IMId not found"),0},this.addInConvTable=function(rt){ht.debug("addInConvTable");var pt,ft=this.convTable.length;for(pt=0;pt<ft;pt+=1)if(ht.log("this.convTable[i].dest_roomId = "+this.convTable[pt].dest_roomId),this.convTable[pt].dest_roomId==rt.dest_roomId)return void(this.convTable[pt].IMId=rt.IMId);ht.log("Conversation not found in the table, adding .."),this.convTable.push(rt)},this.sendMessage=function(rt,pt,ft,St){ht.info("Call sending message function .... from :"+this.nickname+" message :"+pt);var It,xt=this.findIMIdWithDestID(rt),At=null,Dt=null,wt=null,Mt=ct.channel.getNewCSeq();return xt===0?ht.log("Creation of a new IM conversation"):ht.log("Message is for existing conversation with ID : "+xt),ht.log("IMConvId :"+xt),At={type:"IMMessage",IMId:xt,senderId:ct.apiCCId,nickname:this.nickname,photoURL:this.photoURL,dstRoomId:rt,data:pt,cSeq:Mt,convData:St},ct.getConnectedUserIdsList().forEach(function(vt){vt.userId==rt&&vt.hasOwnProperty("userData")&&vt.userData!==null&&Rt(vt.userData.hasOwnProperty("isChatbot"))&&vt.userData.isChatbot&&(At.pubSub="BotConnector")}),It=JSON.stringify(At),Dt=document.createElement("message"),ht.log("C->S: "+It),ft!==void 0?(ht.log("Ack management activated"),wt=setTimeout(function(){ft({reason:"timeoutReached",cSeq:Mt}),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[Mt]},ct.messageTimeOutTimer),ht.log("timeOutId: "+wt),ct.messageTimeOutTable[Mt]=wt,ct.channel.socket.emit("IMMessage",It,function(vt){ht.log("callback on IMMessage"),ht.log("data :",vt),ht.log("callback reason :"+vt.reason),ht.log("callback convId :"+vt.convId),ht.log("cSeq :"+vt.cSeq),ft(vt),apiCC.session.messageTimeOutTable[Mt]!==void 0?(ht.log("clearing timeOutId: "+apiCC.session.messageTimeOutTable[Mt]),clearTimeout(apiCC.session.messageTimeOutTable[Mt]),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[Mt]):ht.warn("messageTimeOutTable was already deleted : timeout may have been reached before Ack")})):(ht.log("Ack management not activated"),ct.channel.socket.emit("IMMessage",It)),this.conversation!==null&&(Dt.innerHTML="<b>me :</b> "+St+"<br>",this.conversation.appendChild(Dt),this.conversation.scrollTop=this.conversation.scrollHeight),Mt},this.newConversationCreated=function(rt){ht.debug("newConversationCreated :"+rt),ht.log("msg.dstRoomId :"+rt.dstRoomId),ht.log("msg.IMId :"+rt.IMId);var pt={dest_roomId:rt.dstRoomId,IMId:rt.IMId};this.addInConvTable(pt)},this.receiveMessage=function(rt){ht.info("Call receiveMessage message :"+rt);var pt,ft=null;pt={dest_roomId:rt.senderId,IMId:rt.IMId},this.addInConvTable(pt),this.conversation!==null&&((ft=document.createElement("message")).innerHTML="<b>"+rt.nickname+":</b> "+rt.data+"<br>",this.conversation.appendChild(ft),this.conversation.scrollTop=this.conversation.scrollHeight),this.myWebRTC_Event.createReceiveIMMessageEvent(rt.senderId,rt.nickname,rt.photoURL,rt.data,rt.UUCSeq,rt.IMId)},this.createGroupChat=function(rt,pt){var ft,St;ht.info("createGroupChat with contacts : "+rt+","+pt),ft={type:"createGroupChat",nickname:this.nickname,photoURL:this.photoURL,contactId1:rt,contactId2:pt},St=JSON.stringify(ft),ht.log("C->S: "+St),ct.channel.socket.emit("createGroupChat",St)},this.groupChatCreation=function(rt){ht.debug("groupChatCreation"),this.myWebRTC_Event.createGroupChatCreationEvent(rt.status,rt.groupChatId,rt.contactId1,rt.invitationSendedToInitialDestId,rt.contactId2,rt.invitationSendedToNewContactId)},this.joinGroupChat=function(rt){var pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ht.debug("joinGroupChat : "+rt);var ft=null,St=null;ft={type:"joinGroupChat",groupChatId:rt},pt.convId&&(ft.data={},ft.data.cloudConvId=pt.convId),St=JSON.stringify(ft),ht.log("C->S: "+St),ct.channel.socket.emit("joinGroupChat",St)},this.groupChatInvitation=function(rt){ht.debug("groupChatInvitation"),this.myWebRTC_Event.createGroupChatInvitationEvent(rt.groupChatId,rt.senderId,rt.senderNickname,rt.senderPhotoURL,rt.contactList)},this.answerToGroupChatInvitation=function(rt,pt){var ft,St;ht.debug("answerToGroupChatInvitation: "+rt+" : "+pt),pt===!0||pt===!1?(ft={type:"groupChatInvitationAnswer",groupChatId:rt,senderId:ct.apiCCId,nickname:this.nickname,photoURL:this.photoURL,accept:pt},St=JSON.stringify(ft),ht.log("C->S: "+St),ct.channel.socket.emit("groupChatInvitationAnswer",St)):ht.log("accept value is not correct")},this.groupChatMemberUpdate=function(rt){ht.info("groupChatMemberUpdate"),this.myWebRTC_Event.createGroupChatMemberUpdateEvent(rt.groupChatId,rt.contactList,rt.status)},this.addUserInGroupChat=function(rt,pt){var ft,St;ht.debug("addUser : "+pt+"in Group Chat with Id :"+rt),ft={type:"addUserInGroupChat",groupChatId:rt,nickname:this.nickname,photoURL:this.photoURL,contactId:pt},St=JSON.stringify(ft),ht.log("C->S: "+St),ct.channel.socket.emit("addUserInGroupChat",St)},this.addUserInGroupChatAnswer=function(rt){ht.info("addUserInGroupChatAnswer"),this.myWebRTC_Event.createAddUserInGroupChatEvent(rt.invitationSended,rt.groupChatId,rt.contactId)},this.leaveGroupChat=function(rt){var pt,ft;ht.info("Leave Group Chat with Id :"+rt),pt={type:"leaveGroupChat",groupChatId:rt,nickname:this.nickname,photoURL:this.photoURL},ft=JSON.stringify(pt),ht.log("C->S: "+ft),ct.channel.socket.emit("leaveGroupChat",ft)},this.sendMessageToGroupChat=function(rt,pt,ft){var St=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};ht.info("Call sending message to Group Chat .... from :"+this.nickname+" message :"+pt);var It=null,xt=null,At=apiCC.session.channel.getNewCSeq();It={type:"groupChatMessage",groupChatId:rt,senderId:ct.apiCCId,nickname:this.nickname,cSeq:At,data:pt},(0,ot.Ym)(St,"metadata","object")&&(It.metadata=St.metadata),xt=JSON.stringify(It),ft!==null&&typeof ft=="function"?(apiCC.session.messageTimeOutTable[At]=setTimeout(function(){ft({reason:"timeoutReached",cSeq:At}),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[At]},apiCC.session.messageTimeOutTimer),ht.log("C->S: "+xt),ct.channel.socket.emit("groupChatMessage",xt,function(Dt){clearTimeout(apiCC.session.messageTimeOutTable[Dt.cSeq]),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[Dt.cSeq],ft(Dt)})):(ht.log("C->S: "+xt),ct.channel.socket.emit("groupChatMessage",xt))},this.receiveGroupChatMessage=function(rt){ht.info("receiveGroupChatMessage"),this.myWebRTC_Event.createReceiveGroupChatMessageEvent(rt.groupChatId,rt.senderId,rt.nickname,rt.data,rt.metadata)},this.getConversationHistory=function(rt){var pt,ft;ht.debug("getConversationHistory"),pt={type:"getConversationHistory",convId:rt},ft=JSON.stringify(pt),ht.log("C->S: "+ft),ct.channel.socket.emit("getConversationHistory",ft)},this.receiveConversationHistory=function(rt){ht.debug("receiveConversationHistory"),ht.log("msg.convId :"+rt.convId);var pt,ft=0,St=[],It=null;if(rt.convHistory!==null)for(ht.log("msg.convHistory.length :"+rt.convHistory.length),ft=rt.convHistory.length,St=[],pt=0;pt<ft;pt+=1)It=JSON.parse(rt.convHistory[pt]),St.push(It);this.myWebRTC_Event.createReceiveConversationHistoryEvent(rt.convId,St,rt.status)},this.setUserData=function(rt){var pt,ft;ht.info("setUserData"),this.photoURL=rt.photoURL,ct.photoURL=rt.photoURL,ht.log("photoURL :"+this.photoURL),pt={type:"setUserData",nickname:this.nickname,photoURL:this.photoURL},ft=JSON.stringify(pt),ht.log("C->S: "+ft),ct.channel.socket.emit("setUserData",ft),this.userDataSetted=!0},this.getUserData=function(rt){var pt,ft;ht.info("getUserData"),pt={type:"getUserData",contactId:rt},ft=JSON.stringify(pt),ht.log("C->S: "+ft),ct.channel.socket.emit("getUserData",ft)},this.receiveUserDataAnswer=function(rt){ht.info("receiveUserDataAnswer"),this.myWebRTC_Event.createUserDataAnswerEvent(rt.userFound,rt.contactId,rt.nickname,rt.photoURL)},this.receiveFetchUserDataAnswer=function(rt){ht.info("receiveFetchUserDataAnswer"),this.myWebRTC_Event.createFetchUserDataAnswerEvent(rt)},this.initialize=function(rt){var pt,ft;this.conversation=document.getElementById(rt),this.conversation===null&&(ht.log("conversationElementId Div Name is not correct : INCORRECT_DIV_NAME_CONVERSATION"),ht.log("conversationElementId is null")),pt={type:"registerIM",username:this.nickname},ft=JSON.stringify(pt),ht.log("C->S: "+ft),ct.channel.socket.emit("registerIM",ft)},this.initialize(mt)}},9213:(it,ut,s)=>{s.d(ut,{X:()=>Rt}),s(2564),s(2526),s(1817),s(1539);var et=s(1549),ot=s(4708),st=et.Y.get("ApiCCPointerSharingClient"),Rt=function ht(bt){this.roomTable={},this.getRoomIds=function(){var ct=[],mt=null;for(mt in this.roomTable)ct.push(mt);return ct},this.roomExists=function(ct){return this.roomTable.hasOwnProperty(ct)},this.roomActive=function(ct){return this.roomTable.hasOwnProperty(ct)&&this.roomTable[ct].state===ht.STATE_ACTIVE},this.joinRoom=function(ct,mt){var rt=this;st.info("ApiCCPointerSharingClient::joinRoom()"),(0,ot.Ym)(mt,"object")||(mt={}),(0,ot.ki)(mt,"success","function")||(mt.success=function(){}),(0,ot.ki)(mt,"failure","function")||(mt.failure=function(){}),this.roomTable.hasOwnProperty(ct)?mt.failure("room already joined",ct):(this.roomTable[ct]={roomId:ct,state:ht.STATE_JOINING,joinRoomCallbacks:mt},this.roomTable[ct].joinRoomTimeoutId=setTimeout(function(){delete rt.roomTable[ct],mt.failure("timeout",ct)},15e3),apiCC.session.roomMgr.joinRoom(ct,"pointerSharing"))},this.leaveRoom=function(ct){this.roomTable.hasOwnProperty(ct)&&delete this.roomTable[ct],apiCC.session.roomMgr.leaveRoom(ct,"pointerSharing")},this.inviteInRoom=function(ct,mt,rt){st.info("ApiCCPointerSharingClient::inviteInRoom()"),apiCC.session.roomMgr.inviteInRoom(ct,mt,"pointerSharing",rt)},this.sendPointerLocation=function(ct,mt,rt,pt,ft){var St;return!(!this.roomTable.hasOwnProperty(ct)||this.roomTable[ct].state!==ht.STATE_ACTIVE||(St={type:"pointerLocation",source:mt,x:rt,y:pt},(0,ot.Ym)(ft,"object")&&(St.data=ft),apiCC.session.roomMgr.sendMessageToRoom(ct,"pointerSharing",St),0))},this.processMessageRoomJoin=function(ct){this.roomTable.hasOwnProperty(ct.roomId)&&this.roomTable[ct.roomId].state===ht.STATE_JOINING&&(clearTimeout(this.roomTable[ct.roomId].joinRoomTimeoutId),delete this.roomTable[ct.roomId].joinRoomTimeoutId,this.roomTable[ct.roomId].state=ht.STATE_ACTIVE,this.roomTable[ct.roomId].joinRoomCallbacks.success(ct.roomId),delete this.roomTable[ct.roomId].joinRoomCallbacks)},this.stop=function(){for(var ct=this.getRoomIds(),mt=ct.length;--mt>=0;)this.leaveRoom(ct[mt])}};Rt.STATE_IDLE=Symbol("idle"),Rt.STATE_JOINING=Symbol("joining"),Rt.STATE_ACTIVE=Symbol("active"),Rt.STATE_ERROR=Symbol("error")},3720:(it,ut,s)=>{s.d(ut,{K:()=>xt}),s(1058),s(8309),s(3710),s(1539),s(9714),s(2564),s(9554),s(4747),s(2772),s(561),s(6699),s(2479),s(2707),s(9601),s(2526),s(1817),s(2165),s(6992),s(8783),s(3948);var et=s(1549),ot=et.Y.get("RoomManager"),st=function(At,Dt){ot.debug("RoomManager"),this.myWebRTC_Event=apiCC.myWebRTC_Event,this.createRoom=function(wt){var Mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ot.info("RoomManager:createRoom with roomType : "+wt);var vt={type:"createRoom",roomType:wt,nickname:At.nickname,photoURL:At.photoURL};Mt.convId&&(vt.data||(vt.data={}),vt.data.cloudConvId=Mt.convId),Mt.webconf===!0&&(vt.data||(vt.data={}),vt.data.webconf=!0);var Ft=JSON.stringify(vt);ot.log("C->S: "+Ft),At.channel.socket.emit("createRoom",Ft)},this.roomCreation=function(wt){ot.info("RoomManager:roomCreation"),this.myWebRTC_Event.createRoomCreationEvent(wt.status,wt.roomId,wt.roomType),Dt(wt)},this.roomJoin=function(wt){ot.info("RoomManager:roomJoin"),this.myWebRTC_Event.createRoomJoinedEvent(wt.status,wt.roomId,wt.roomType),Dt(wt)},this.inviteInRoom=function(wt,Mt,vt,Ft){var Ht=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};ot.info("RoomManager:inviteInRoom with roomType:",vt);var Wt={type:"inviteInRoom",roomId:wt,contactId:Mt,roomType:vt,nickname:At.nickname,photoURL:At.photoURL,context:Ft};Ht.convId&&(Wt.data||(Wt.data={}),Wt.data.cloudConvId=Ht.convId),Ht.webconf===!0&&(Wt.data||(Wt.data={}),Wt.data.webconf=!0);var tn=JSON.stringify(Wt);ot.log("C->S: "+tn),At.channel.socket.emit("inviteInRoom",tn)},this.inviteInRoomStatus=function(wt){ot.info("inviteInRoomStatus"),Dt(wt)},this.roomInvitation=function(wt){ot.info("roomInvitation",wt);var Mt={};wt.data&&(wt.data.cloudConvId&&(Mt.cloudConvId=wt.data.cloudConvId),wt.data.webconf===!0&&(Mt.webconf=!0)),this.myWebRTC_Event.createRoomInvitationEvent(wt.roomId,wt.senderId,wt.senderNickname,wt.senderPhotoURL,wt.contactList,wt.roomType,Mt),Dt(wt)},this.requestContactListInRoom=function(wt){ot.info("requestContactListInRoom :"+wt);var Mt={type:"requestContactListInRoom",roomId:wt},vt=JSON.stringify(Mt);At.channel.socket.emit("requestContactListInRoom",vt)},this.onContactListInRoom=function(wt){ot.info("onContactListInRoom :"+wt),this.myWebRTC_Event.createContactListInRoomEvent(wt.roomId,wt.contactList,wt.roomType),Dt(wt)},this.answerToRoomInvitation=function(wt,Mt,vt){if(ot.info("answerToRoomInvitation:",wt,Mt),Mt===!0||Mt===!1){var Ft={type:"roomInvitationAnswer",roomId:wt,senderId:At.apiCCId,nickname:At.nickname,photoURL:At.photoURL,accept:Mt,roomType:vt},Ht=JSON.stringify(Ft);ot.log("C->S: "+Ht),At.channel.socket.emit("roomInvitationAnswer",Ht)}else ot.log("accept value is not correct")},this.roomMemberUpdate=function(wt){ot.info("roomMemberUpdate"),this.myWebRTC_Event.createRoomMemberUpdateEvent(wt.roomId,wt.contactList,wt.status,wt.roomType),Dt(wt)},this.sendMessageToRoom=function(wt,Mt,vt){ot.info("Call sending message to Room .... from :"+At.apiCCId+" message :"+vt);var Ft={type:"roomMessage",roomId:wt,senderId:At.apiCCId,nickname:At.nickname,roomType:Mt,data:vt},Ht=JSON.stringify(Ft);ot.log("C->S: "+Ht),At.channel.socket.emit("roomMessage",Ht)},this.receiveRoomMessage=function(wt){ot.info("receiveRoomMessage"),this.myWebRTC_Event.createReceiveRoomMessageEvent(wt.roomId,wt.senderId,wt.nickname,wt.data,wt.roomType),Dt(wt)},this.joinRoom=function(wt,Mt){var vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ot.info("Join Room with Id:",wt);var Ft={type:"joinRoom",roomId:wt,nickname:At.nickname,photoURL:At.photoURL,roomType:Mt};vt.convId&&(Ft.data||(Ft.data={}),Ft.data.cloudConvId=vt.convId),vt.webconf===!0&&(Ft.data||(Ft.data={}),Ft.data.webconf=!0);var Ht=JSON.stringify(Ft);ot.log("C->S: "+Ht),At.channel.socket.emit("joinRoom",Ht)},this.leaveRoom=function(wt,Mt){ot.info("Leave Room with Id:",wt);var vt={type:"leaveRoom",roomId:wt,nickname:At.nickname,photoURL:At.photoURL,roomType:Mt},Ft=JSON.stringify(vt);ot.log("C->S: "+Ft),At.channel.socket.emit("leaveRoom",Ft)}},Rt=(s(2023),s(7042),s(1038),s(4916),s(9753),s(8765)),ht=s(5945);function bt(At,Dt){(Dt==null||Dt>At.length)&&(Dt=At.length);for(var wt=0,Mt=new Array(Dt);wt<Dt;wt++)Mt[wt]=At[wt];return Mt}var ct=et.Y.get("ApiCC_Channel"),mt=function(At){ct.debug("ApiCC_Channel"),this.channelReady=!1,this.socket=null,this.channelId=At.apiCCId,this.myWebRTC_Event=new Rt.K,this.channelHasBeenDisconnected=!1,this.cSeq=0,this.updatePresenceGroupIsNeeded=!1,this.oldPresenceGroup=null,this.newPresenceGroup=null,this.updateSubscribeToPresenceGroupIsNeeded=!1,this.oldSubscribeToPresenceGroup=null,this.newSubscribeToPresenceGroup=null,this.initialize=function(){ct.info("ApiCC_Channel::initialize()"),this.openChannel()},this.getNewCSeq=function(){return this.cSeq=this.cSeq+1,this.cSeq},this.openChannel=function(){var Dt,wt,Mt,vt="",Ft=null,Ht=null,Wt=null,tn=null;ct.debug("openChannel channelId :"+this.channelId),ct.debug("session.apiKey :"+At.apiKey),ct.log("session.sessionId :"+At.sessionId),At.xhrPolling=!0,ct.log("CCSserver used : "+At.ccsServer),wt=At.appId!==void 0?"&appId="+At.appId:"",Mt=At.siteId!==void 0?"&siteId="+At.siteId:"",At.userData!==void 0&&(ct.log("Defined userData : ",At.userData),Ft=JSON.stringify(At.userData),ct.log("stringUserData.length :"+Ft.length),Ft.length<=1e3?vt="&userData="+encodeURIComponent(Ft):ct.warn("userData length is too long :"+Ft.length+" .Need to be <= 500")),At.presenceGroup!==void 0&&(ct.log("Defined presenceGroup : "+At.presenceGroup),Ht=JSON.stringify(At.presenceGroup),ct.log("stringPresenceGroup.length :"+Ht.length),Ht.length<=750?vt+="&presenceGroup="+encodeURIComponent(Ht):ct.warn("presenceGroup length is too long :"+Ht.length+" .Need to be <= 750")),At.subscribeToPresenceGroup!==void 0&&(ct.log("Defined subscribeToPresenceGroup : "+At.subscribeToPresenceGroup),Wt=JSON.stringify(At.subscribeToPresenceGroup),ct.log("stringsubscribeToPresenceGroup.length :"+Wt.length),Wt.length<=750?vt+="&subscribeToPresenceGroup="+encodeURIComponent(Wt):ct.warn("subscribeToPresenceGroup length is too long :"+Wt.length+" .Need to be <= 750")),At.token!==void 0&&(ct.log("Defined token : "+At.token),vt+="&token="+At.token),At.conversationSpace!==void 0&&At.conversationSpace!==null&&(ct.log("Defined conversationSpace : "+At.conversationSpace),vt+="&conversationSpace="+At.conversationSpace),typeof apiRTC_React>"u"&&(ct.log("ApplicationUUID : "+window.location.hostname),vt+="&applicationUUID="+window.location.hostname),vt+="&apiLibType=apiRTC_JS",ct.log("requestOptions on connect :"+vt),ct.log("session.ccsServer :"+At.ccsServer),Dt="?channelId="+this.channelId+"&apiKey="+At.apiKey+"&apiVersion="+apiCC.version+"&apiCCSessionId="+At.apiCCSessionId+"&sessionId="+At.sessionId+wt+Mt+vt,tn=typeof apiRTC_React<"u"?"https":window.location.protocol==="http:"?"http":"https",ht.ag.name!=="iOS"&&ht.ag.name!=="Android"||(ct.log(ht.ag.name+" detected forcing protocol to https"),tn="https"),ct.info("CCS Connect, socket url is : "+tn+"://"+At.ccsServer+"/"+Dt),this.ccsConnectionRetryNb=At.ccsConnectionRetryNb,this.ccsConnectionRetryDelay=At.ccsConnectionRetryDelay,this.socket=window.rtcio.connect(tn+"://"+At.ccsServer+"/"+Dt,{forceNew:!0,multiplex:!1,withCredentials:!0,reconnectionAttempts:this.ccsConnectionRetryNb,reconnectionDelay:this.ccsConnectionRetryDelay}),this.socket.on("connect",this.callback(this,"onChannelOpened")).on("connect_error",this.callback(this,"onChannelConnectError")).on("message",this.callbackWithParams(this,"onChannelMessage")).on("disconnect",this.callback(this,"onChannelDisconnect")),this.socket.io.on("error",this.callback(this,"onChannelError")).on("reconnect",this.callback(this,"onChannelReconnect")).on("reconnect_attempt",this.callback(this,"onChannelReconnectAttempt")).on("reconnect_error",this.callback(this,"onChannelReconnectError")).on("reconnect_failed",this.callback(this,"onChannelReconnect_failed"))},this.onWhiteBoardDisconnection=function(){ct.info("onWhiteBoardDisconnection"),apiCC.session.closeWhiteBoardClient("NETWORK_DISCONNECTION")},this.onChannelDisconnect=function(Dt){ct.info("onChannelDisconnect");var wt=Date();ct.debug("date :"+wt),apiCC.session.connectedUsersList.splice(0,apiCC.session.connectedUsersList.length),this.myWebRTC_Event.createChannelEvent("onChannelDisconnect",Dt),this.channelHasBeenDisconnected=!0,apiCC.myApiCCWhiteBoardClient!==null&&(ct.log("apiCC.myApiCCWhiteBoardClient.roomId :"+apiCC.myApiCCWhiteBoardClient.roomId),apiCC.myApiCCWhiteBoardClient.roomId!==null?(ct.log("Disconnection with an ongoing whiteboard"),ct.error("Whiteboard disconnectionTimer is set to:",apiCC.myApiCCWhiteBoardClient.disconnectionTimer),apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId=setTimeout(this.callback(this,"onWhiteBoardDisconnection"),apiCC.myApiCCWhiteBoardClient.disconnectionTimer)):ct.log("Disconnection without an ongoing whiteboard")),apiCC.session.JWTApzTokentimeOutId!==-1&&clearTimeout(apiCC.session.JWTApzTokentimeOutId)},this.onChannelReconnect_failed=function(){ct.info("onChannelReconnect_failed"),this.myWebRTC_Event.createChannelEvent("onChannelReconnect_failed")},this.onChannelReconnect=function(Dt){ct.error("onChannelReconnect",Dt);var wt,Mt=null,vt=0,Ft=[],Ht=null,Wt=null,tn=null,gn=!1,nn=0,qt=null,fn=null;if(At.conversationSpace!==null&&At.conversationSpace!==void 0?(ct.debug("conversationSpace is set :",At.conversationSpace),At.joinConversationSpace(At.conversationSpace)):ct.debug("no conversationSpace defined"),At.userData!==void 0&&At.userData!==null&&(ct.debug("sending userData :",At.userData),At.setUserData(At.userData,!0)),At.presenceGroup!==null?(ct.debug("presenceGroup is set :",At.presenceGroup),At.sendPresenceGroupManagementCommand("join",At.presenceGroup)):ct.debug("no presenceGroup defined"),At.subscribeToPresenceGroup!==null?(ct.debug("subscribeToPresenceGroup is set :",At.subscribeToPresenceGroup),At.sendPresenceGroupManagementCommand("subscribe",At.subscribeToPresenceGroup)):ct.debug("no subscribeToPresenceGroup defined"),apiCC.session.apiCCIMClient!==null?apiCC.session.apiCCIMClient.userDataSetted===!0?(Mt={photoURL:apiCC.session.apiCCIMClient.photoURL},apiCC.session.apiCCIMClient.setUserData(Mt)):ct.log("apiCC.session.apiCCIMClient.userDataSetted !== true"):ct.log("apiCC.session.apiCCIMClient === null"),apiCC.session.apiCCWebRTCClient!==null){if(apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.length>0)for(gn=!0,wt=0;wt<apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.length;wt+=1)Ht={destId:(fn=apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable[wt]).remoteId,convId:fn.userMediaId,callType:fn.callType,roomId:fn.roomId,data:fn.data,meshPublish:!0},Ft.push(Ht);if((vt=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length)!==0){for(ct.log("Reconnecting with calls ongoing"),wt=0;wt<vt;wt+=1)apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[wt]!==null&&apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[wt]!==void 0?(fn=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[wt],ct.debug("call.iceState =",fn.iceState),fn.data!==null?fn.data.type!=="publish"&&fn.data.type!=="subscribe"?(ct.log("Call is P2P, updating media"),fn.updateMediaWithRetryManagement(!0),Ht={destId:fn.remoteId,convId:fn.callId,callType:fn.callType,roomId:fn.dest_roomId,data:fn.data},Ft.push(Ht)):(ct.log("Call is in an MCU session"),Ht={destId:fn.remoteId,convId:fn.callId,callType:fn.callType,roomId:fn.dest_roomId,data:fn.data},Ft.push(Ht)):(ct.log("Call is P2P, updating media - no data"),fn.updateMediaWithRetryManagement(!0),Ht={destId:fn.remoteId,convId:fn.callId,callType:fn.callType,roomId:fn.dest_roomId,data:fn.data},Ft.push(Ht))):ct.log("call no more exist");gn=!0}else ct.log("Reconnecting without calls ongoing");for(var Cn=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs,Tn=0;Tn<Cn.length;Tn+=1){ct.log("Reconnecting with an ongoing sessionMCU");var un=[];un.push(Cn[Tn].roomName),apiCC.session.sendPresenceGroupManagementCommand("join",un),apiCC.session.sendPresenceGroupManagementCommand("subscribe",un)}}if(apiCC.myApiCCWhiteBoardClient!==null&&(apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId!==0&&(ct.debug("clearing whiteBoardDisconnectionTimeoutId"),clearTimeout(apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId),apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId=0),ct.log("apiCC.myApiCCWhiteBoardClient.roomId :"+apiCC.myApiCCWhiteBoardClient.roomId),apiCC.myApiCCWhiteBoardClient.roomId!==null?(ct.log("Reconnection with an ongoing whiteboard"),nn=apiCC.myApiCCWhiteBoardClient.roomId,gn=!0,ct.debug("Reconnection , sending request to get most recent whiteboard data"),apiCC.myApiCCWhiteBoardClient.paperSheetId=0,apiCC.myApiCCWhiteBoardClient.drawingId=0,apiCC.myApiCCWhiteBoardClient.sendDataToRoom({tool:"void",needCatchUp:"*||-1"})):ct.log("Reconnecting without an ongoing whiteboard")),apiCC.session.apiCCPointerSharingClient!==null&&(qt=apiCC.session.apiCCPointerSharingClient.getRoomIds()).length>0&&(gn=!0),gn===!0){ct.log("Sending reconnectContext to CCS"),Wt={type:"reconnectContext",callList:Ft,whiteBoardRoomId:nn},qt!==null&&qt.length>0&&(Wt.pointerSharingRoomIds=qt);var mn=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs;if(mn.length>0){Wt.updateSession=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.createJoinSessionMessage(null),Wt.updateSession.type="updateSession",Wt.updateSessions=[];var yn,pn=function(Mn,xn){var Pn=typeof Symbol<"u"&&Mn[Symbol.iterator]||Mn["@@iterator"];if(!Pn){if(Array.isArray(Mn)||(Pn=function(Xn,tr){if(Xn){if(typeof Xn=="string")return bt(Xn,tr);var cn=Object.prototype.toString.call(Xn).slice(8,-1);return cn==="Object"&&Xn.constructor&&(cn=Xn.constructor.name),cn==="Map"||cn==="Set"?Array.from(Xn):cn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(cn)?bt(Xn,tr):void 0}}(Mn))||xn&&Mn&&typeof Mn.length=="number"){Pn&&(Mn=Pn);var On=0,Dn=function(){};return{s:Dn,n:function(){return On>=Mn.length?{done:!0}:{done:!1,value:Mn[On++]}},e:function(Xn){throw Xn},f:Dn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Fn,dr=!0,ir=!1;return{s:function(){Pn=Pn.call(Mn)},n:function(){var Xn=Pn.next();return dr=Xn.done,Xn},e:function(Xn){ir=!0,Fn=Xn},f:function(){try{dr||Pn.return==null||Pn.return()}finally{if(ir)throw Fn}}}}(mn);try{for(pn.s();!(yn=pn.n()).done;){var In=yn.value,kn=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.createJoinSessionMessage(null,{sessionMCU:In});kn.type="updateSession",Wt.updateSessions.push(kn)}}catch(Mn){pn.e(Mn)}finally{pn.f()}}tn=JSON.stringify(Wt),ct.log("C->S: "+tn),apiCC.session.channel.socket.emit("reconnectContext",tn)}Ft.splice(0,Ft.length),this.myWebRTC_Event.createChannelEvent("onChannelReconnect",Dt)},this.onChannelReconnecting=function(Dt){ct.info("onChannelReconnecting",Dt);var wt=Date();ct.debug("date :"+wt),this.myWebRTC_Event.createChannelEvent("onChannelReconnecting",Dt)},this.onChannelOpened=function(){ct.info("Channel opened"),ct.log("this.channelId :"+this.channelId),this.channelReady=!0,this.channelHasBeenDisconnected===!1?At.onChannelOpened():(ct.log("onChannelOpened after a disconnection, no change on session"),this.channelHasBeenDisconnected=!1,At.ApiDBActivated!==!1&&At.ApiDBActivated!==void 0&&At.ApiDBActivated!==null&&(ct.log("apiDB initialisation"),apiDB.init(At.channel.socket))),this.updatePresenceGroupIsNeeded===!0&&(ct.log("Updating presence group"),At.leavePresenceGroup(this.oldPresenceGroup),At.joinPresenceGroup(this.newPresenceGroup)),this.updateSubscribeToPresenceGroupIsNeeded===!0&&(ct.log("Updating subscribe to presence group"),At.unsubscribePresenceGroup(this.oldSubscribeToPresenceGroup),At.subscribePresenceGroup(this.newSubscribeToPresenceGroup)),this.myWebRTC_Event.createChannelEvent("onChannelOpened")},this.onChannelMessage=function(Dt,wt){var Mt,vt=null,Ft=null;try{vt=JSON.parse(Dt)}catch{return}(Mt=vt.type==="checkCallStatus"||vt.type==="apiRTCDataMessage"&&vt.data&&["activeSpeaker","stopSpeaking"].indexOf(vt.data.type)>=0)||ct.info("onChannelMessage S->C: "+Dt),vt.type==="IMMessage"&&(ct.log("IMMessage convId :"+vt.IMId),Ft=vt.IMId),wt!==void 0&&(ct.trace("ack on message reception"),ct.trace("convId :"+Ft),wt({reason:"ack",convId:Ft})),At.processSignalingMessage(vt,{quiet:Mt})},this.onChannelConnectError=function(Dt){ct.error("onChannelConnectError :",Dt.message),this.myWebRTC_Event.createChannelEvent("onChannelConnectError",Dt),this.checkIfConnectionAttemptNeedToBeStopped(Dt)},this.onChannelReconnectError=function(Dt){ct.log("onChannelReconnectError :",Dt.message),this.myWebRTC_Event.createChannelEvent("onChannelReconnectError",Dt),this.checkIfConnectionAttemptNeedToBeStopped(Dt)},this.onChannelReconnectAttempt=function(Dt){ct.log("onChannelReconnectAttempt :",Dt),this.myWebRTC_Event.createChannelEvent("onChannelReconnectAttempt",Dt),this.onChannelReconnecting(Dt)},this.onChannelError=function(Dt){ct.error("Channel error :",Dt.message),this.checkIfConnectionAttemptNeedToBeStopped(Dt),this.myWebRTC_Event.createChannelEvent("onChannelError",Dt)},this.checkIfConnectionAttemptNeedToBeStopped=function(Dt){ct.debug("checkIfConnectionAttemptNeedToBeStopped"),(Dt.message==="not authorized"||Dt.message.includes("access token failure:")||Dt.message.includes("DISABLED_ENTERPRISE")||Dt.message.includes("An account is needed")||Dt.message.includes("ApiRTC update is needed")||Dt.message.includes("applicationUUID is not authorized"))&&(ct.error("Stopping connection attempts"),this.socket.disconnect())},this.callback=function(Dt,wt){return this.closureHandler=function(Mt){return Dt[wt](Mt)},this.closureHandler},this.callbackWithParams=function(Dt,wt){return this.closureHandler=function(Mt,vt,Ft){return Dt[wt](Mt,vt,Ft)},this.closureHandler}},rt=s(4708),pt=s(940);function ft(At){return ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Dt){return typeof Dt}:function(Dt){return Dt&&typeof Symbol=="function"&&Dt.constructor===Symbol&&Dt!==Symbol.prototype?"symbol":typeof Dt},ft(At)}var St=et.Y.get("ApiCCSession"),It=apiCC.myWebRTC_Event,xt=function(At){var Dt=this;if(this.apiCCId=null,this.apiCCSessionId=apiCC.randomString(22),this.apiKey=null,this.nickname=null,this.photoURL=null,this.apiCCWebRTCClient=null,this.apiCCIMClient=null,this.apiCCDataClient=null,this.apiCCIDSessionStorage=null,this.apiKeySessionStorage=null,this.apiCCIdPersistenceTimeout=5e3,this.channel=null,this.recordActivated=At.recordActivated,this.sessionId=null,this.apiCCPointerSharingClient=null,this.apiCCWhiteBoardClient=null,this.ccsServer=At.ccsServer,this.userData=At.userData,this.apiDBActivated=!0,At.ApiDBActivated=!0,this.webRTCPluginActivated=At.webRTCPluginActivated,this.token=At.token,this.JWTApzToken=null,this.JWTApzTokenRefreshTimer=396e5,this.JWTApzTokentimeOutId=-1,this.conversationSpace=At.conversationSpace,this.tryAudioCallAfterUserMediaError=At.tryAudioCallAfterUserMediaError,this.deactivateReloadOnCancel=At.deactivateReloadOnCancel,this.connectedUsersList=[],this.messageTimeOutTable=[],this.ccsConnectionRetryNb=At.ccsConnectionRetryNb,this.ccsConnectionRetryDelay=At.ccsConnectionRetryDelay,this.sequentialMessagesStorage={},this.cloudIsSecured=At.cloudIsSecured,At.messageTimeOutTimer!==void 0?this.messageTimeOutTimer=At.messageTimeOutTimer:this.messageTimeOutTimer=1e4,St.log("messageTimeOutTimer set to : "+this.messageTimeOutTimer),At.presenceGroup!==void 0?this.presenceGroup=At.presenceGroup:this.presenceGroup=["default"],At.subscribeToPresenceGroup!==void 0?this.subscribeToPresenceGroup=At.subscribeToPresenceGroup:this.subscribeToPresenceGroup=["default"],this.presenceGroupAddedByApiRTC=[],this.subscribeToPresenceGroupAddedByApiRTC=[],this.remoteAccessInvitation=null,this.isDeviceWebRTCCompliant=function(){return apiCC.isWebRTCCompliant()},this.isDeviceDTLSCompliant=function(){var vt=ht.E2.getBrowser(),Ft=parseInt(vt.version,10);return!(vt.name==="Chrome"&&Ft<44&&(St.log("isDeviceDTLSCompliant FALSE : Chrome V < 44"),1))},this.userData===void 0||this.userData===null?(this.userData={},this.userData.webRtcCompliant=apiCC.webRTCCompliant,this.userData.dtlsCompliant=this.isDeviceDTLSCompliant()):this.userData.webRtcCompliant===void 0||this.userData.webRtcCompliant===null?(this.userData.webRtcCompliant=apiCC.webRTCCompliant,this.userData.dtlsCompliant=this.isDeviceDTLSCompliant()):St.log("userData webRtcCompliant set to :",this.userData.webRtcCompliant),this.userData.osName=ht.BF,this.userData.osVersion=ht.MM,this.userData.browser=ht.Xh,this.userData.deviceType=ht.vO,this.userData.deviceVendor=ht.Cm,this.userData.deviceModel=ht.Ak,this.userData.browser_version=ht.dc,this.userData.browser_major_version=ht.PR,this.userData.apiRTCVersion=apiCC.version,this.userData.cpuArchitecture=ht.Ne,this.userData.engineName=ht.AA,this.userData.engineVersion=ht.TI,apiRTC.userAgentInstance!==void 0&&(this.userData.remoteAccessUserSupport=apiRTC.userAgentInstance.getCapabilities().remoteAccessUser),ht.BF==="Android"&&typeof cordova<"u"&&(this.userData.platform="Android"),typeof apiRTC_React<"u"&&(this.userData.react=!0),this.roomManagerEventHandler=function(vt){if(St.debug("roomManagerEventHandler, roomId :"+vt.roomId+", type :"+vt.type+", roomType :"+vt.roomType),vt.roomType==="whiteBoard"){if(apiCC.myApiCCWhiteBoardClient===null||apiCC.myApiCCWhiteBoardClient===void 0)return void St.log("No whiteBoard created, leaving msg processing");vt.type==="roomCreation"&&(St.log("whiteBoard : roomCreation"),apiCC.myApiCCWhiteBoardClient.roomId=vt.roomId,apiCC.myApiCCWhiteBoardClient.paperSheetId++,apiCC.myApiCCWhiteBoardClient.drawingId=0,apiCC.myApiCCWhiteBoardClient.sendDataToRoom({tool:"void",needCatchUp:"*||-1"})),vt.type==="roomInvitation"&&(St.log("whiteBoard : roomInvitation"),apiCC.myApiCCWhiteBoardClient.roomId=vt.roomId),vt.type==="roomMessage"&&apiCC.myApiCCWhiteBoardClient.messageProcessing(vt.data),vt.type==="roomJoin"&&(St.log("whiteBoard : roomJoin"),apiCC.myApiCCWhiteBoardClient.roomJoined=!0,apiCC.myApiCCWhiteBoardClient.roomId=vt.roomId)}else vt.roomType==="pointerSharing"?apiCC.session.apiCCPointerSharingClient&&vt.type==="roomJoin"&&apiCC.session.apiCCPointerSharingClient.processMessageRoomJoin(vt):vt.roomType==="coBrowsing"?vt.type==="roomMessage"&&St.log("coBrowsing : roomMessage :"+vt):St.log("roomManagerEventHandler for msg.roomType :"+vt.roomType)},this.callback=function(vt,Ft){return this.closureHandler=function(Ht){return vt[Ft](Ht)},this.closureHandler},this.roomMgr=new st(this,this.callback(this,"roomManagerEventHandler")),At.xhrPolling===!0?this.xhrPolling=!0:this.xhrPolling=!1,this.getSessionStorage=function(vt){var Ft=sessionStorage.getItem(vt);if(Ft===null)return null;try{var Ht=JSON.parse(Ft),Wt=new Date(Ht.expiresAt);return new Date>=Wt?(sessionStorage.removeItem(vt),null):Ht.value}catch{St.error("Something went wrong when parsing JSON from session storage values")}},this.generateApiCCID=function(){St.debug("apiCCId is not defined by user, checking if apiCCId exist in sessionStorage"),typeof apiRTC_React>"u"&&(this.apiCCIDSessionStorage=this.getSessionStorage("apiCCId"),this.apiKeySessionStorage=this.getSessionStorage("apiKey")),this.apiCCIDSessionStorage!==null?(St.log("apiCCId exist in sessionStorage : "+this.apiCCIDSessionStorage),this.apiKeySessionStorage!==null?(St.log("apiKey exist in sessionStorage : "+this.apiKeySessionStorage),this.apiKeySessionStorage===this.apiKey?(St.log("apiKey is the same, keeping apiCCId"),this.apiCCId=this.apiCCIDSessionStorage):(St.log("apiKey is not the same, generating an  apiCCId"),this.apiCCId=Math.floor(1000001*Math.random()).toString(),St.log("Creation of new ApiRTC session with Id : "+this.apiCCId))):this.apiCCId=this.apiCCIDSessionStorage):(St.log(" No apiCCId found on sessionStorage : generating an apiCCId"),this.apiCCId=String(1e5+Math.floor(9e5*Math.random())),St.log("Creation of new ApiRTC session with Id : "+this.apiCCId))},this.getNumericIdFromAlpha=function(vt){St.log("getNumericIdFromAlpha new : "+vt);var Ft,Ht=0;if(vt.length===0)return Ht;for(Ft=0;Ft<vt.length;Ft++)Ht=(Ht<<5)-Ht+vt.charCodeAt(Ft),Ht&=Ht;return St.log("getNumericIdFromAlpha returned value: "+(Ht>>>0)),Ht>>>0},At.appId!==void 0&&(this.appId=At.appId),At.siteId!==void 0&&(this.siteId=At.siteId),At.apiKey===void 0)return St.error('Error : Initialisation parameters: "apikey" for session creation is not defined'),null;if(St.log("Session creation with apiKey : "+At.apiKey),St.log("Session creation with apiCCId : "+At.apiCCId),this.apiKey=At.apiKey,At.onReady===void 0&&typeof apiRTC_React>"u")return St.error('Error : Initialisation parameters: "onReady" for session creation is not defined'),null;if(apiCC.addEventListener("sessionReady",At.onReady),typeof apiRTC_React>"u"&&(this.sessionId=this.getSessionStorage("sessionId")),At.apiCCId===void 0||At.apiCCId===""||At.apiCCId===null)this.generateApiCCID();else if(St.log("Session creation with apiCCId defined by user : "+At.apiCCId),St.debug("params.idConversionActivated : "+At.idConversionActivated),At.idConversionActivated===void 0||At.idConversionActivated===!0)if((0,rt._C)(At.apiCCId))this.apiCCId=At.apiCCId.toString();else{St.log("Converting this Id in a numeric one");var wt=this.getNumericIdFromAlpha(At.apiCCId);wt+="",St.log("Numeric Id is : "+wt),(0,rt._C)(wt)?(St.warn("Id has been converted to a numeric one"),this.apiCCId=wt.toString()):(St.warn("Error : Defined apiCCId :"+At.apiCCId+" is not numeric. ApiCCID is generated"),this.generateApiCCID())}else St.log("String id convertion is deactivated"),this.apiCCId=At.apiCCId.toString();function Mt(vt){return vt instanceof Array?(St.log("data instanceof Array"),!0):(St.log("data not instanceof Array"),!1)}At.apiCCIdPersistenceTimeout!==null&&typeof At.apiCCIdPersistenceTimeout=="number"&&At.apiCCIdPersistenceTimeout>=0&&(this.apiCCIdPersistenceTimeout=At.apiCCIdPersistenceTimeout),this.channel!==null&&(St.log("this.channel is defined"),delete this.channel),this.channel=new mt(this),this.channel.initialize(),At.nickname!==null&&At.nickname!==void 0?(St.log("Nickname is defined :"+At.nickname),this.nickname=At.nickname):(St.log("Nickname is not defined, setting to apiCCId value :"+this.apiCCId),this.nickname=this.apiCCId),At.photoURL!==null&&At.photoURL!==void 0?(St.log("photoURL is defined :"+At.photoURL),this.photoURL=At.photoURL):(St.log("photoURL is not defined"),this.photoURL=null),this.reOpenChannel=function(vt,Ft){St.info("reOpenChannel"),this.apiCCId=vt.toString(),this.apiKey=Ft,this.channel.socket!==void 0&&this.channel.socket!==null&&this.channel.socket.disconnect(),this.channel.channelReady=!1,this.channel.socket=null,this.channel.channelId=this.apiCCId,this.channel.initialize(),this.apiCCWebRTCClient!==null&&this.apiCCWebRTCClient.webRTCClient!==null&&(this.apiCCWebRTCClient.webRTCClient.socket=this.channel.socket)},this.onChannelOpened=function(){St.debug("ApiCCSession onChannelOpened"),At.ApiDBActivated!==!1&&At.ApiDBActivated!==void 0&&At.ApiDBActivated!==null&&(St.log("apiDB initialisation"),apiDB.init(this.channel.socket)),It.createSessionReadyEvent(apiCC.session.apiCCId)},this.createWebRTCClient=function(vt){St.debug("createWebRTCClient");var Ft={};this.apiCCWebRTCClient=new apiCC.ApiCCWebRTCClient(this),apiCC.session.apiCCWebRTCClient.webRTCClient.setGumConfigWithDevicePresent(),Ft.audioDevicePresent=apiCC.mediaDeviceMgr.audioDevicePresent,Ft.videoDevicePresent=apiCC.mediaDeviceMgr.videoDevicePresent,apiCC.session.setUserData(Ft),setTimeout(function(){It.createWebRTCClientCreatedEvent()});var Ht=apiCC.getUserMediaStreamIds(),Wt=Ht.length;for(St.debug("listing accessToLocalMedia "+Wt);--Wt>=0;)if(apiCC.getUserMediaStream(Ht[Wt]).accessToLocalMedia()){St.debug("setting accessToLocalMedia to true"),this.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0;break}return this.apiCCWebRTCClient},this.createPointerSharingClient=function(){return this.apiCCPointerSharingClient===null&&(this.apiCCPointerSharingClient=new apiCC.ApiCCPointerSharingClient(this)),this.apiCCPointerSharingClient},this.closePointerSharingClient=function(){this.apiCCPointerSharingClient!==null&&this.apiCCPointerSharingClient instanceof apiCC.ApiCCPointerSharingClient&&(this.apiCCPointerSharingClient.stop(),this.apiCCPointerSharingClient=null)},this.createWhiteBoard=function(vt,Ft,Ht,Wt){return St.info("createWhiteBoard"),this.apiCCWhiteBoardClient=apiCC.createWhiteBoard(vt,Ft,Ht,Wt),this.apiCCWhiteBoardClient},this.closeWhiteBoardClient=function(vt){St.info("closeWhiteBoardClient"),apiCC.closeWhiteBoardClient(vt)},this.createIMClient=function(vt){return St.debug("createIMClient"),this.apiCCIMClient=new apiCC.ApiCCIMClient(this,vt),this.apiCCIMClient},this.createDataClient=function(){return St.info("createDataClient"),this.apiCCDataClient=new apiCC.ApiCCDataClient(this),this.apiCCDataClient},this.updatingQuery=function(vt){St.debug("updatingQuery");var Ft=null,Ht=null,Wt=null;return Ft=(0,rt.dD)(vt),this.userData!==void 0?(Ht=JSON.stringify(this.userData),Wt=encodeURIComponent(Ht),Ft.userData=Wt,(0,rt.Wc)(Ft)):vt},this.setUserData=function(vt,Ft){St.debug("setUserData in session :",vt);var Ht,Wt,tn,gn=[],nn=this.userData;if(this.userData!==void 0){if(this.userData=(0,rt.S6)(this.userData,vt),St.debug("this.userData :",this.userData),St.debug("actualUserData :",nn),St.debug("forceSendData :",Ft),Ft!==!0&&JSON.stringify(this.userData)===JSON.stringify(nn))return void St.debug("userData is not changed, leaving userData processing")}else this.userData=vt;for(Ht={type:"setUserData",userData:vt},Wt=JSON.stringify(Ht),St.log("C->S: "+Wt),this.channel.socket.emit("setUserData",Wt),St.log("socket.io 1.X : socket.io.opts.query :"+this.channel.socket.io.opts.query),this.channel.socket.io.opts.query=this.updatingQuery(this.channel.socket.io.opts.query),St.log("socket.io 1.X : after update : socket.io.opts.query :"+this.channel.socket.io.opts.query),tn=0;tn<this.connectedUsersList.length;tn+=1)this.apiCCId===this.connectedUsersList[tn].userId&&(this.connectedUsersList[tn].userData=this.userData,gn[0]=this.apiCCId,It.createConnectedUsersListUpdateEvent(this.connectedUsersList[tn].group,gn,"userDataUpdate","userDataUpdate"))},this.sendPresenceGroupManagementCommand=function(vt,Ft){if(St.debug("sendPresenceGroupManagementCommand :"+vt+" for group : "+Ft),Mt(Ft)===!0){var Ht,Wt,tn,gn=Ft.length;if(vt==="unsubscribe")for(tn=0;tn<gn;tn+=1)this.removeGroupDataFromConnectedUsersList(Ft[tn]);gn!==1||Ft[0]!=="deactivated"?(Ht={type:"presenceGroupManagement",command:vt,group:Ft},Wt=JSON.stringify(Ht),St.log("C->S: "+Wt),this.channel.socket.emit("presenceGroupManagement",Wt)):St.debug("leaving sendPresenceGroupManagementCommand for group deactivated")}else St.error("group parameter value is not correct, need to be a JSON array")},this.sendConversationSpaceCommand=function(vt,Ft){var Ht,Wt;St.debug("sendConversationSpaceCommand :"+vt+" for conversationSpace : "+Ft),Ht={type:"conversationSpaceManagement",command:vt,conversationSpace:Ft},Wt=JSON.stringify(Ht),St.log("C->S: "+Wt),this.channel.socket.emit("conversationSpaceManagement",Wt)},this.joinPresenceGroup=function(vt,Ft){var Ht=this;Ft||((Ft={}).doneByApiRTC=!1),St.debug("joinPresenceGroup :"+vt),Mt(vt)===!0?(this.sendPresenceGroupManagementCommand("join",vt),vt.forEach(function(Wt){var tn=Ht.presenceGroupAddedByApiRTC.indexOf(Wt);Ht.presenceGroup.indexOf(Wt)===-1&&(Ht.presenceGroup.push(Wt),Ft.doneByApiRTC&&tn===-1&&Ht.presenceGroupAddedByApiRTC.push(Wt)),Ft.doneByApiRTC===!1&&tn!==-1&&Ht.presenceGroupAddedByApiRTC.splice(tn,1)})):St.log("group parameter value is not correct, need to be a JSON array"),St.debug("this.presenceGroup :"+this.presenceGroup)},this.leavePresenceGroup=function(vt,Ft){var Ht=this;Ft||((Ft={}).doneByApiRTC=!1),St.debug("leavePresenceGroup :"+vt),Mt(vt)===!0?vt.forEach(function(Wt){var tn=Ht.presenceGroupAddedByApiRTC.indexOf(Wt);if(Ft.doneByApiRTC===!1||Ft.doneByApiRTC===!0&&tn!==-1){var gn=Ht.presenceGroup.indexOf(Wt);gn!==-1&&Ht.presenceGroup.splice(gn,1),Ht.sendPresenceGroupManagementCommand("leave",[Wt])}tn!==-1&&Ht.presenceGroupAddedByApiRTC.splice(tn,1)}):St.log("group parameter value is not correct, need to be a JSON array"),St.debug("this.presenceGroup :"+this.presenceGroup)},this.subscribePresenceGroup=function(vt,Ft){var Ht=this;Ft||((Ft={}).doneByApiRTC=!1),St.debug("subscribePresenceGroup :"+vt),Mt(vt)===!0?(this.sendPresenceGroupManagementCommand("subscribe",vt),vt.forEach(function(Wt){var tn=Ht.subscribeToPresenceGroupAddedByApiRTC.indexOf(Wt);Ht.subscribeToPresenceGroup.indexOf(Wt)===-1&&(Ht.subscribeToPresenceGroup.push(Wt),Ft.doneByApiRTC&&Ht.subscribeToPresenceGroupAddedByApiRTC.indexOf(Wt)===-1&&Ht.subscribeToPresenceGroupAddedByApiRTC.push(Wt)),Ft.doneByApiRTC===!1&&tn!==-1&&Ht.subscribeToPresenceGroupAddedByApiRTC.splice(tn,1)})):St.log("group parameter value is not correct, need to be a JSON array"),St.debug("this.subscribeToPresenceGroup :"+this.subscribeToPresenceGroup)},this.unsubscribePresenceGroup=function(vt,Ft){var Ht=this;Ft||((Ft={}).doneByApiRTC=!1),St.debug("unsubscribePresenceGroup :"+vt),Mt(vt)===!0?vt.forEach(function(Wt){var tn=Ht.subscribeToPresenceGroupAddedByApiRTC.indexOf(Wt);if(Ft.doneByApiRTC===!1||Ft.doneByApiRTC===!0&&tn!==-1){var gn=Ht.subscribeToPresenceGroup.indexOf(Wt);gn!==-1&&Ht.subscribeToPresenceGroup.splice(gn,1),Ht.sendPresenceGroupManagementCommand("unsubscribe",[Wt])}tn!==-1&&Ht.subscribeToPresenceGroupAddedByApiRTC.splice(tn,1)}):St.log("group parameter value is not correct, need to be a JSON array"),St.debug("this.subscribeToPresenceGroup :"+this.subscribeToPresenceGroup)},this.joinConversationSpace=function(vt){St.info("joinConversationSpace :"+vt),this.sendConversationSpaceCommand("join",vt),this.conversationSpace=vt},this.leaveConversationSpace=function(vt){St.info("leaveConversationSpace :"+vt),vt!=null&&this.conversationSpace===vt?(this.sendConversationSpaceCommand("leave",vt),this.conversationSpace=null):St.debug("socket is not in the conversationSpace, we request to leave")},this.subscribeToCloudEvent=function(vt,Ft){this.sendCloudEventsCommand("subscribe",vt,Ft)},this.unsubscribeToCloudEvent=function(vt,Ft){this.sendCloudEventsCommand("unsubscribe",vt,Ft)},this.sendCloudEventsCommand=function(vt,Ft,Ht){if(["subscribe","unsubscribe"].includes(vt))if(Ft&&typeof Ft=="string"){if(Ht){if(ft(Ht)!=="object")return void St.error("wrong headers format");for(var Wt=0,tn=Object.values(Ht);Wt<tn.length;Wt++){var gn=tn[Wt];if(!gn||typeof gn!="string")return void St.error("wrong headers format")}}var nn={type:"cloudEvents",command:vt,topic:Ft};Ht&&(nn.headers=Ht);var qt=JSON.stringify(nn);St.log("C->S:",qt),this.channel.socket.emit("cloudEvents",qt)}else St.error("wrong topic format");else St.error("wrong command")},this.getConversationList=function(vt){St.info("getConversationList request");var Ft,Ht;Ht=vt!==void 0?{type:"getConversationList",lastConversationNb:vt}:{type:"getConversationList",lastConversationNb:50},Ft=JSON.stringify(Ht),St.log("C->S: "+Ft),this.channel.socket.emit("getConversationList",Ft)},this.receiveConversationListAnswer=function(vt){St.info("receiveConversationListAnswer"),St.log("msg.convList.length :"+vt.convList.length);var Ft,Ht=vt.convList.length,Wt=[],tn=null;for(Ft=0;Ft<Ht;Ft+=1)St.log("i ="+Ft),tn=JSON.parse(vt.convList[Ft]),Wt.push(tn);It.createReceiveConversationListAnswerEvent(Wt)},this.getContactOccurrencesFromConversationList=function(vt){St.info("getContactOccurrencesFromConversationList request");var Ft,Ht;Ht=vt!==void 0?{type:"getContactOccurrencesFromConversationList",lastConversationNb:vt}:{type:"getContactOccurrencesFromConversationList",lastConversationNb:50},Ft=JSON.stringify(Ht),St.log("C->S: "+Ft),this.channel.socket.emit("getContactOccurrencesFromConversationList",Ft)},this.receiveContactOccurrencesFromConversationListAnswer=function(vt){St.info("receiveContactOccurrencesFromConversationListAnswer"),St.log("msg.contactOccurrencesTable.length :"+vt.contactOccurrencesTable.length),It.createReceiveContactOccurrencesFromConversationListAnswerEvent(vt.contactOccurrencesTable)},this.getConversationDetailReport=function(vt){var Ft,Ht;St.info("getConversationDetailReport for convId :"+vt),Ft={type:"getConversationDetailReport",convId:vt},Ht=JSON.stringify(Ft),St.log("C->S: "+Ht),this.channel.socket.emit("getConversationDetailReport",Ht)},this.receiveConversationDetailReportAnswer=function(vt){St.info("receiveConversationDetailReportAnswer"),St.log("msg.CDR :"+vt.CDR),It.createReceiveConversationDetailReportAnswerEvent(vt.CDR)},this.manageConnectedUsersList=function(vt,Ft,Ht,Wt){St.debug("manageConnectedUsersList");var tn,gn,nn,qt=!1,fn=0,Cn=!1,Tn="unset";for(St.trace("manageConnectedUsersList.length :"+vt.length),St.trace("this.connectedUsersList.length :"+this.connectedUsersList.length),St.log("state :"+Ft),St.log("group :"+Ht),nn=0;nn<vt.length;nn+=1)vt[nn].group=Ht;if(Ft==="online")for(St.log("state : online"),tn=0;tn<vt.length;tn+=1){if(St.log("msgConnectedUsersListWithStatus  :"+tn),qt=!1,this.connectedUsersList.length===0){St.log("this.connectedUsersList is empty"),this.connectedUsersList=vt,St.log("this.connectedUsersList[0].group :"+this.connectedUsersList[0].group),It.createConnectedUsersListUpdateEvent(Ht,Wt,Ft,"newConnectionState");break}for(gn=0;gn<this.connectedUsersList.length;gn+=1)if(Cn=!1,vt[tn].userId===this.connectedUsersList[gn].userId&&vt[tn].group===this.connectedUsersList[gn].group){qt=!0,JSON.stringify(this.connectedUsersList[gn].userData)!==JSON.stringify(vt[tn].userData)&&(St.log("userData is updated"),this.connectedUsersList[gn].userData=vt[tn].userData,Cn=!0,Tn="userDataUpdate"),this.connectedUsersList[gn].callState!==vt[tn].callState&&(St.log("callState is updated"),this.connectedUsersList[gn].callState=vt[tn].callState,Cn=!0,Tn="callState"),Cn===!0&&It.createConnectedUsersListUpdateEvent(Ht,Wt,Ft,Tn);break}if(qt===!1){St.log("Adding user in connectedUsersList :"+vt[tn].userId),this.connectedUsersList.push(vt[tn]);var un=[];un[0]=vt[tn].userId,It.createConnectedUsersListUpdateEvent(Ht,un,Ft,"newConnectionState")}}else for(St.log("state : offline"),tn=0;tn<vt.length;tn+=1)for(St.log("msgConnectedUsersListWithStatus  :"+tn),fn=this.connectedUsersList.length,gn=0;gn<fn;gn+=1)if(vt[tn].userId===this.connectedUsersList[gn].userId&&vt[tn].group===this.connectedUsersList[gn].group){St.log("Removing user in connectedUsersList :"+vt[tn].userId),St.log("... in group :"+vt[tn].group),this.connectedUsersList.splice(gn,1),It.createConnectedUsersListUpdateEvent(Ht,Wt,Ft,"newConnectionState");break}},this.removeGroupDataFromConnectedUsersList=function(vt){St.debug("removeGroupDataFromConnectedUsersList for group :",vt);var Ft,Ht=this.connectedUsersList.length,Wt=[],tn=0;for(St.debug("this.connectedUsersList.length :",this.connectedUsersList.length),Ft=0;Ft<Ht;Ft+=1)St.debug("this.connectedUsersList[j].group :",this.connectedUsersList[Ft-tn].group),St.debug("group :",vt),this.connectedUsersList[Ft-tn].group===vt&&(St.log("Removing user in connectedUsersList :"+this.connectedUsersList[Ft-tn].userId),Wt[0]=this.connectedUsersList[Ft-tn].userId,this.connectedUsersList.splice(Ft-tn,1),tn+=1,It.createConnectedUsersListUpdateEvent(vt,Wt,"offline","newConnectionState"))},this.getConnectedUsersList=function(vt){vt!==void 0?St.log("getConnectedUsersList for group : "+vt):St.log("getConnectedUsersList : complete users list");var Ft,Ht=[];if(vt==null)return this.connectedUsersList;for(St.log("filtering list for group : "+vt),Ft=0;Ft<this.connectedUsersList.length;Ft+=1)this.connectedUsersList[Ft].group===vt&&Ht.push(this.connectedUsersList[Ft]);return Ht},this.isClientWebRtcCompliant=function(vt){var Ft,Ht,Wt=null,tn=null;if(vt!==void 0)for(Ft=this.getConnectedUsersList(),Ht=0;Ht<Ft.length;Ht++)Ft[Ht].userId===vt&&(tn=Ft[Ht].userData)!=null&&tn.webRtcCompliant!==void 0&&(Wt=tn.webRtcCompliant);return Wt},this.isClientDTLSCompliant=function(vt){var Ft,Ht,Wt=!0,tn=null;if(vt!==void 0)for(Ft=this.getConnectedUsersList(),Ht=0;Ht<Ft.length;Ht++)Ft[Ht].userId===vt&&(tn=Ft[Ht].userData,St.log("userData :",tn),tn!=null&&tn.dtlsCompliant!==void 0&&(Wt=tn.dtlsCompliant));return Wt},this.getConnectedUserIdsList=function(vt){St.info("getConnectedUserIdsList, group :",vt);var Ft,Ht,Wt=[],tn=!1,gn={},nn=[];if(vt!==void 0?St.log("getConnectedUserIdsList for group : "+vt):St.log("getConnectedUserIdsList : complete users list"),vt==null)nn=JSON.parse(JSON.stringify(this.connectedUsersList));else for(Ft=0;Ft<this.connectedUsersList.length;Ft+=1)this.connectedUsersList[Ft].group===vt&&nn.push(this.connectedUsersList[Ft]);for(Ft=0;Ft<nn.length;Ft+=1){for(tn=!1,Ht=0;Ht<Wt.length;Ht++)if(Wt[Ht].userId===nn[Ft].userId){tn=!0;break}tn===!1&&((gn={}).userId=nn[Ft].userId,gn.callState=nn[Ft].callState,gn.userData=nn[Ft].userData,Wt.push(gn))}return Wt},this.getGroupsFromConnectedUsersList=function(vt){St.info("getGroupsFroConnectedUsersList");var Ft,Ht=[],Wt=!1;for(Ft=0;Ft<this.connectedUsersList.length;Ft+=1)this.connectedUsersList[Ft].userId===vt&&(St.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[Ft].group)),Wt=!0,Ht.push(this.connectedUsersList[Ft].group));return Wt===!0?JSON.stringify(Ht):"User_Not_Found"},this.getConnectedUserInfo=function(vt,Ft){St.info("getConnectedUserInfo"),St.log("getConnectedUserInfo userId :",vt),St.log("getConnectedUserInfo infoType :",Ft);var Ht,Wt=null,tn=null;switch(Ft){case"all":for(St.log("all"),Ht=0;Ht<this.connectedUsersList.length;Ht+=1)if(this.connectedUsersList[Ht].userId===vt)return St.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[Ht])),Wt=this.getGroupsFromConnectedUsersList(vt),(tn=JSON.parse(JSON.stringify(this.connectedUsersList[Ht]))).groups=Wt,delete tn.group,JSON.stringify(tn);break;case"callState":for(St.log("callState"),Ht=0;Ht<this.connectedUsersList.length;Ht+=1)if(this.connectedUsersList[Ht].userId===vt)return St.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[Ht].callState)),this.connectedUsersList[Ht].callState;break;case"userData":for(St.log("userData"),Ht=0;Ht<this.connectedUsersList.length;Ht+=1)if(this.connectedUsersList[Ht].userId===vt)return St.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[Ht].userData)),JSON.stringify(this.connectedUsersList[Ht].userData);break;case"groups":return St.log("groups"),this.getGroupsFromConnectedUsersList(vt);default:St.log("infoType not defined switch case : "+Ft)}return"User_Not_Found"},this.isConnectedUser=function(vt){St.info("isConnectedUser");var Ft,Ht=!1;for(Ft=0;Ft<this.connectedUsersList.length;Ft+=1)if(St.log(JSON.stringify(this.connectedUsersList[Ft])),this.connectedUsersList[Ft].userId===vt)return Ht=!0,St.log("isConnected :"+Ht),Ht;return St.log("isConnected :"+Ht),Ht},this.displayConnectedUsersList=function(){var vt;for(St.debug("displayConnectedUsersList"),vt=0;vt<this.connectedUsersList.length;vt+=1)St.log("User :"+this.connectedUsersList[vt].userId+" on group :"+this.connectedUsersList[vt].group)},this.updatePresence=function(vt){try{St.debug("updatePresence : ",JSON.stringify(vt))}catch(Ft){St.debug(Ft)}St.log("updatePresence for group :"+vt.group),this.manageConnectedUsersList(vt.connectedUsersListWithStatus,vt.state,vt.group,vt.connectedUsersList),It.createUpdatePresenceEvent(vt.connectedUsersList,vt.state,vt.connectedUsersListWithStatus)},this.processCloudEventOccurred=function(vt){St.debug("processCloudEventOccurred",vt),It.createCloudEventOccurredEvent(vt.event.type,vt.event.target)},this.updateUserStatus=function(vt){St.info("updateUserStatus"+vt),It.createUpdateUserStatusEvent(vt)},this.sendDebugCommand=function(vt,Ft,Ht){St.info("sendDebugCommand :"+vt),new pt.S(this.channel.socket).sendDebugCommand("getClientSocketsInfo",Ft,Ht)},this.processSignalingMessage=function(vt){var Ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ht=null,Wt=null,tn=!1,gn=null,nn=null,qt=!1,fn=null;if(vt.type==="invite")this.apiCCWebRTCClient?(St.log("this.webRTCPluginActivated =",this.webRTCPluginActivated),(ht.Xh==="IE"||ht.Xh==="Safari"&&ht.PR<11)&&this.webRTCPluginActivated===!0?(St.log("managing call with WebRTC Plugin"),apiCC.manageWebRTCPlugin(function(){St.log("manageWebRTCPlugin cb on Invite"),apiCC.session.apiCCWebRTCClient.webRTCClient.processInvite(vt)},function(){St.log("actionOnInstallationNeeded"),St.log("sending bye to be done"),new pt.S(apiCC.session.channel.socket).sendBye(vt.callId,vt.calleeId,vt.roomId,vt.callerId,"WebRTC_Plugin_Installation_needed",vt.data)})):(St.log("managing call with browser"),this.apiCCWebRTCClient.webRTCClient.processInvite(vt))):St.warn("WebRTCClient is not created");else if(vt.type==="200OK")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.process200OK(vt):St.warn("WebRTCClient is not created");else if(vt.type==="candidate")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processCandidate(vt):St.warn("WebRTCClient is not created");else if(vt.type==="bye")this.apiCCWebRTCClient?(St.log("bye message from:"+vt.clientId+" for callId : "+vt.callId),this.apiCCWebRTCClient.webRTCClient.onRemoteHangup(vt.callId,vt.clientId,vt.roomId,vt.reason,vt.confId,vt.data)):St.warn("WebRTCClient is not created");else if(vt.type==="update")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processUpdate(vt):St.warn("WebRTCClient is not created");else if(vt.type==="200update")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.process200Update(vt):St.warn("WebRTCClient is not created");else if(vt.type==="newConversationCreated")this.apiCCIMClient?this.apiCCIMClient.newConversationCreated(vt):St.warn("IMClient is not created");else if(vt.type==="IMMessage")this.apiCCIMClient?this.apiCCIMClient.receiveMessage(vt):St.warn("IMClient is not created");else if(vt.type==="groupChatCreation")this.apiCCIMClient?this.apiCCIMClient.groupChatCreation(vt):St.warn("IMClient is not created");else if(vt.type==="groupChatInvitation")this.apiCCIMClient?this.apiCCIMClient.groupChatInvitation(vt):St.warn("IMClient is not created");else if(vt.type==="groupChatMemberUpdate")this.apiCCIMClient?this.apiCCIMClient.groupChatMemberUpdate(vt):St.warn("IMClient is not created");else if(vt.type==="addUserInGroupChatAnswer")this.apiCCIMClient?this.apiCCIMClient.addUserInGroupChatAnswer(vt):St.warn("IMClient is not created");else if(vt.type==="groupChatMessage")this.apiCCIMClient?this.apiCCIMClient.receiveGroupChatMessage(vt):St.warn("IMClient is not created");else if(vt.type==="conversationHistoryAnswer")this.apiCCIMClient?this.apiCCIMClient.receiveConversationHistory(vt):St.warn("IMClient is not created");else if(vt.type==="getUserDataAnswer")this.apiCCIMClient?this.apiCCIMClient.receiveUserDataAnswer(vt):St.warn("IMClient is not created");else if(vt.type==="fetchUserDataAnswer")this.apiCCIMClient?this.apiCCIMClient.receiveFetchUserDataAnswer(vt):St.warn("IMClient is not created");else if(vt.type==="dataMessage")this.apiCCDataClient?this.apiCCDataClient.receiveData(vt):St.warn("DataClient is not created");else if(vt.type==="dataAck")this.apiCCWebRTCClient.webRTCClient.processDataAck(vt);else if(vt.type==="dataEndAck")this.apiCCWebRTCClient.webRTCClient.processDataEndAck(vt);else if(vt.type==="updateVideoQuality")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processUpdateVideoQuality(vt.callId,vt.profile);else if(vt.type==="apiRTCDataMessage")if(Ft.quiet||St.debug("apiRTCDataMessage:",vt),(0,rt.Ym)(vt.data,"object"))if(vt.data.type==="joinSessionAnswer")if(this.apiCCWebRTCClient){var Cn={roomName:vt.data.roomId};(0,rt.ki)(vt.data,"convId","string")&&(Cn.convId=vt.data.convId),(0,rt.ki)(vt.data,["data","mode"],"string")&&(Cn.data={mode:vt.data.data.mode}),(0,rt.ki)(vt.data,["data","transition"],"string")&&vt.data.data.transition==="mesh2janus"?this.apiCCWebRTCClient.webRTCClient.MCUClient.changeSessionMode(Cn,"mesh2janus"):this.apiCCWebRTCClient.webRTCClient.MCUClient.updateSessionAnswer(Cn,{createSession:!0})}else St.warn("WebRTCClient is not created");else if(vt.data.type==="slowLink"){if(this.apiCCWebRTCClient){var Tn={};vt.data.advice&&(Tn.advice=vt.data.advice),this.apiCCWebRTCClient.webRTCClient.processSlowLink(vt.data.callId,Tn)}}else if(vt.data.type==="videoQualityChanged")It.createVideoQualityChangedEvent(vt.data.callId,vt.data.roomId,vt.data.hint,vt.data.profile);else if(vt.data.type==="distantIceError")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processDistantIceError(vt.data);else if(vt.data.type==="streamTrackChanged")this.apiCCWebRTCClient&&vt.data.hasOwnProperty("mline")&&vt.data.hasOwnProperty("muted")&&this.apiCCWebRTCClient.webRTCClient.processStreamTrackMuteChanged(vt.data.callId,vt.data.mline,vt.data.muted);else if(vt.data.type==="streamTrackStatusChanged")this.apiCCWebRTCClient&&vt.data.hasOwnProperty("mline")&&vt.data.hasOwnProperty("change")&&vt.data.hasOwnProperty(vt.data.change)&&this.apiCCWebRTCClient.webRTCClient.processStreamTrackStatusChanged(vt.data.callId,vt.data.mline,vt.data[vt.data.change]);else if(vt.data.type==="configureEncodings")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processConfigureEncodings(vt.data);else if(vt.data.type==="activeSpeaker")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processAudioAmplitude(vt.data,!0);else if(vt.data.type==="stopSpeaking")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processAudioAmplitude(vt.data,!1);else if(vt.data.type==="updateStream")this.apiCCWebRTCClient&&vt.data.callId&&vt.data.mline&&vt.data.direction&&this.apiCCWebRTCClient.webRTCClient.processUpdateStream(vt.data.callId,vt.data.mline,vt.data.direction);else if(vt.data.type==="startRecording"){if(this.apiCCWebRTCClient)if(vt.data.callId==="COMPOSITE")this.apiCCWebRTCClient.webRTCClient.MCUClient.startCompositeRecording(vt.data.mediaType,vt.data.customIdInFilename,vt.data.convId,vt.data.data);else{for(fn=this.apiCCWebRTCClient.webRTCClient.callsTable.length;--fn>=0;)if(this.apiCCWebRTCClient.webRTCClient.callsTable[fn].callId===vt.data.callId){qt=!0;break}qt?this.apiCCWebRTCClient.webRTCClient.MCUClient.startRecording(vt.data.mediaType,vt.data.customIdInFilename,vt.data.convId,vt.data.callId,vt.data.data):St.info("cannot start recording (call not found)")}}else if(vt.data.type==="startStreaming"){if(this.apiCCWebRTCClient){for(fn=this.apiCCWebRTCClient.webRTCClient.callsTable.length;--fn>=0;)if(this.apiCCWebRTCClient.webRTCClient.callsTable[fn].callId===vt.data.callId){qt=!0;break}qt?this.apiCCWebRTCClient.webRTCClient.MCUClient.startStreaming(vt.data.service,vt.data.server,vt.data.streamKey,vt.data.callId):St.info("cannot start streaming (call not found)")}}else if(vt.data.type==="startCallStatsMonitoring"){if(this.apiCCWebRTCClient){for(St.debug("startCallStatsMonitoring",vt.data.callId),fn=this.apiCCWebRTCClient.webRTCClient.callsTable.length;--fn>=0;)if(this.apiCCWebRTCClient.webRTCClient.callsTable[fn].callId===vt.data.callId){Wt=this.apiCCWebRTCClient.webRTCClient.callsTable[fn];break}Wt?["chrome","firefox"].indexOf(rt.wL.type)>=0?Wt.csmIntervalId?St.debug("call stats monitoring already started"):Wt.csmIntervalId=setInterval(Wt.callback(Wt,"csmHandler"),Wt.csmIntervalMs):St.debug("call stats are only supported on chrome and firefox"):St.debug("no such call")}}else vt.data.type==="callOrder"?(St.log("callOrder received"),this.apiCCWebRTCClient?(this.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector=vt.senderId,Ht=this.apiCCWebRTCClient.webRTCClient.callWithNumber(vt.data.caller,!0,{MCUType:"MCU-Callee",confId:vt.data.confId,convId:vt.data.convId},gn),this.apiCCWebRTCClient.webRTCClient.myWebRTC_Event.createIncomingCallEvent(this.clientId,vt.data.caller,vt.data.caller,Ht,!1,1,!1,"video",!0,"web","media")):St.warn("WebRTCClient is not created")):vt.data.type==="subscribeOrder"?(St.log("subscribeOrder received"),this.apiCCWebRTCClient?(this.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector=vt.senderId,vt.data.data.subscribeOrder=!0,(nn=[]).push(vt.data.stream),this.apiCCWebRTCClient.webRTCClient.MCUClient.subscribeToStreams(nn,"VIDEO",vt.data.data,gn,{noStreamCheck:!0})):St.warn("WebRTCClient is not created")):vt.data.type==="distantCallEstablished"?this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processDistantCallEstablished(vt.data):vt.data.type==="simulcastFeedChanged"?this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processSimulcastFeedChanged(vt.data):St.log("msg.data.type is not managed :"+vt.data.type);else St.log("msg.data === undefined");else if(vt.type==="conversationListAnswer")this.receiveConversationListAnswer(vt);else if(vt.type==="contactOccurrencesFromConversationListAnswer")this.receiveContactOccurrencesFromConversationListAnswer(vt);else if(vt.type==="conversationDetailReport")this.receiveConversationDetailReportAnswer(vt);else if(vt.type==="updatePresence")St.log("updatePresence"),this.updatePresence(vt);else if(vt.type==="updateUserStatus")St.log("updateUserStatus"),this.updateUserStatus(vt);else if(vt.type==="receiveMCUSessionId")St.log("receiveMCUSessionId"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.receiveSessionId(vt):St.warn("WebRTCClient is not created");else if(vt.type==="joinSessionAnswer")St.log("joinSessionAnswer"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.joinSessionAnswer(vt):St.warn("WebRTCClient is not created");else if(vt.type==="updateSessionAnswer")St.log("updateSessionAnswer"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.updateSessionAnswer(vt,{updateCalls:!0}):St.warn("WebRTCClient is not created");else if(vt.type==="availableStreams")this.apiCCWebRTCClient?(St.log("message availableStreams received"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.newAvailableStream(vt.msg,"regular",function(mn,yn,pn){It.createMCUAvailableStreamEvent([yn],mn)}):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(vt.type==="availableReplay")this.apiCCWebRTCClient?(St.log("message availableReplay received"),this.apiCCWebRTCClient?(tn=this.apiCCWebRTCClient.webRTCClient.MCUClient.newAvailableReplay(vt.msg),It.createMCUAvailableReplayEvent(vt.msg,tn)):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(vt.type==="availableComposite")this.apiCCWebRTCClient?(St.log("message availableComposite received"),this.apiCCWebRTCClient?(tn=this.apiCCWebRTCClient.webRTCClient.MCUClient.newAvailableStream(vt.msg,"composite"),It.createMCUAvailableCompositeEvent(vt.msg,tn)):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(vt.type==="onRemoveStream")this.apiCCWebRTCClient?(St.log("message onRemoveStream received:",vt),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.removeMCUStream(vt.callId,vt.msg.id,vt.msg.reason):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(vt.type==="availableStreamsUpdate")this.apiCCWebRTCClient?(St.log("message availableStreamsUpdate received"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.updateAvailableStream(vt.msg,"regular",function(mn,yn,pn,In){It.createMCUAvailableStreamUpdateEvent([yn],mn)}):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(vt.type==="checkCallStatus")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processCheckCallStatus(vt):St.warn("WebRTCClient is not created");else if(vt.type==="MCUSessionInvitation")St.log("MCUSessionInvitation"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.receiveSessionInvitation(vt):St.warn("WebRTCClient is not created");else if(vt.type==="MCUSessionInvitationToGroupChat")St.log("MCUSessionInvitationToGroupChat"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.receiveSessionInvitation(vt):St.warn("WebRTCClient is not created");else if(vt.type==="participantEjected")St.log("participantEjected"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.participantEjected(vt):St.warn("WebRTCClient is not created");else if(vt.type==="recordingStarted")St.log("recordingStarted"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.recordingStarted(vt):St.warn("WebRTCClient is not created");else if(vt.type==="recordingStopped")St.log("recordingStopped"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.recordingStopped(vt):St.warn("WebRTCClient is not created");else if(vt.type==="recordingStreamAvailable")St.log("recordingStreamAvailable"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.recordingStreamAvailable(vt):St.warn("WebRTCClient is not created");else if(vt.type==="streamingStarted")St.log("streamingStarted"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.streamingStarted(vt):St.warn("WebRTCClient is not created");else if(vt.type==="streamingStopped")St.log("streamingStopped"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.streamingStopped(vt):St.warn("WebRTCClient is not created");else if(vt.type==="sessionId")St.log("sessionId :"+vt.sessionId),this.sessionId=vt.sessionId,vt.JWTApzToken!==void 0&&this.handleJWTApzToken(vt.JWTApzToken);else if(vt.type==="JWTTokenRefreshAnswer")St.log("JWTTokenRefreshAnswer"),vt.JWTApzToken!==void 0&&this.handleJWTApzToken(vt.JWTApzToken);else if(vt.type==="roomCreation")St.log("roomCreation"),this.roomMgr.roomCreation(vt);else if(vt.type==="roomJoin")St.log("roomJoined"),this.roomMgr.roomJoin(vt);else if(vt.type==="inviteInRoomStatus")St.log("inviteInRoomStatus"),this.roomMgr.inviteInRoomStatus(vt);else if(vt.type==="contactListInRoom")St.log("contactListInRoom"),this.roomMgr.onContactListInRoom(vt);else if(vt.type==="roomInvitation")St.log("roomInvitation"),this.roomMgr.roomInvitation(vt);else if(vt.type==="roomMessage")St.log("roomMessage"),this.roomMgr.receiveRoomMessage(vt);else if(vt.type==="roomMemberUpdate")St.log("roomMemberUpdate"),this.roomMgr.roomMemberUpdate(vt);else if(vt.type==="agentReconnect"){var un=this.apiCCWebRTCClient.webRTCClient.findCallWithCallId(vt.callId);un!=null&&un.getUserMediaOnCall()}else vt.type==="sequence"?(St.log("Sequential message"),this.handleSequentialMessage(vt)):vt.type==="Ack"?St.log("Ack received"):vt.type==="receipt"?this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processReceipt(vt):vt.type==="error"?(St.log("error received"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processError(vt):It.createErrorEvent(vt.errorInfo,vt.errorCode,vt.callId,vt.roomId,null,null,vt.convId)):vt.type==="enterpriseConfig"?(St.log("enterpriseConfig received"),this.handleEnterpriseConfigMessage(vt)):vt.type==="AIEMessage"?(St.log("AIEMessage received"),this.handleAIEMessage(vt)):vt.type==="cloudEventOccurred"?this.processCloudEventOccurred(vt):St.log("Error : No type for this message")},this.handleSequentialMessage=function(vt){if(vt.id!==void 0&&vt.packetNum!==void 0&&vt.totalPacketsNum!==void 0&&vt.data!==void 0){St.debug("Handle sequential message packet "+vt.packetNum+"/"+vt.totalPacketsNum,vt);var Ft=[];if(Dt.sequentialMessagesStorage[vt.id]!==void 0&&(Ft=Dt.sequentialMessagesStorage[vt.id]),Ft.push(vt),Dt.sequentialMessagesStorage[vt.id]=Ft,Ft.length===vt.totalPacketsNum){Ft.sort(function(tn,gn){return tn.packetNum-gn.packetNum});var Ht="";Ft.forEach(function(tn){Ht+=tn.data}),delete Dt.sequentialMessagesStorage[vt.id];var Wt=null;try{Wt=JSON.parse(Ht)}catch(tn){return void St.error("Error : can't parse sequential message JSON :",tn)}if(!Wt)return void St.error("Error : can't restore sequential message, it's null");St.debug("Restored sequential message :",Ht),Dt.processSignalingMessage(Wt)}}else St.error("Error : sequential message is inconsistent :",vt)},this.handleEnterpriseConfigMessage=function(vt){if(St.debug("handleEnterpriseConfigMessage :",vt),(0,rt.ki)(vt,"sentry","boolean")&&vt.sentry===!0){var Ft;Ft=window!==void 0&&window.location!==void 0&&window.location.protocol!==void 0&&window.location.protocol!=="https:"?"http":"https",apiCC.loadSentry(apiCC.initApiKey,Ft)}if((0,rt.ki)(vt,"customJson","string")&&vt.customJson!=="")try{St.debug("customJson :",vt.customJson),vt.customJson=JSON.parse(vt.customJson)}catch(Ht){St.error(Ht)}if((0,rt.ki)(vt,"iceServers","string")&&vt.iceServers!=="")try{St.debug("iceServers :",vt.iceServers),vt.iceServers=JSON.parse(vt.iceServers),Dt.apiCCWebRTCClient.setPcConfig(vt.iceServers)}catch(Ht){St.error(Ht)}(0,rt.ki)(vt,"logLevel","string")&&vt.logLevel!==""&&!isNaN(parseInt(vt.logLevel))&&apiRTC.setLogLevel(parseInt(vt.logLevel)),(0,rt.ki)(vt,"ccs","object")&&(Dt.ccsInfo=Object.assign({},vt.ccs))},this.handleAIEMessage=function(vt){switch(St.debug("handleAIEMessage :",vt),vt.detail){case"modelLoaded":if(apiCC!==void 0&&vt.userMediaStreamId!==void 0){var Ft=apiCC.getUserMediaStream(vt.userMediaStreamId).mediaFilterManager;for(var Ht in Ft.filters)Ft.filters[Ht]!==void 0&&Ft.filters[Ht].streamAIE!==null&&Ft.filters[Ht].streamAIE.modelLoaded(vt)}break;case"unknownModelName":St.error("Unknown model name :",vt.modelName);break;case"loadModelError":St.error("Error while loading model :",vt.info);break;default:St.debug("Unknown detail :",vt.detail)}},this.handleJWTApzToken=function(vt){St.debug("handleJWTApzToken :",vt),Dt.JWTApzToken=vt,Dt.cloudIsSecured===!0?(St.debug("Setting JWTApzToken on cloudAPI"),apiCC.CloudApi.setJWTApzToken(Dt.JWTApzToken)):St.debug("JWTApzToken is not set on cloudAPI"),Dt.JWTApzTokentimeOutId!==-1&&clearTimeout(Dt.JWTApzTokentimeOutId),Dt.JWTApzTokentimeOutId=setTimeout(function(){var Ft=JSON.stringify({type:"JWTTokenRefreshRequest"});St.log("C->S: "+Ft),apiCC.session.channel.socket.emit("JWTTokenRefreshRequest",Ft)},Dt.JWTApzTokenRefreshTimer)},this.fetchUserData=function(vt){var Ft,Ht;St.debug("fetchUserData"),Ft={type:"fetchUserData",id:vt.id,apiKey:vt.apiKey,timeout:vt.timeout},Ht=JSON.stringify(Ft),St.log("C->S: "+Ht),this.channel.socket.emit("fetchUserData",Ht)}}},7323:(it,ut,s)=>{s.d(ut,{q:()=>Ut}),s(4363),s(9653),s(3710),s(1539),s(9714),s(561),s(2564),s(4812),s(8309),s(9753),s(9554),s(4747),s(8674),s(7042),s(1038),s(8783),s(4916),s(2526),s(1817),s(2165),s(6992),s(3948);var et=s(1549),ot=s(5945),st=s(4708);function Rt(Ot,Bt){for(var Qt=0;Qt<Bt.length;Qt++){var en=Bt[Qt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Ot,en.key,en)}}s(2479),s(9070),s(8304),s(489),s(2419),s(8011);var ht=function(){function Ot(){(function(en,Jt){if(!(en instanceof Jt))throw new TypeError("Cannot call a class as a function")})(this,Ot)}var Bt,Qt;return Bt=Ot,(Qt=[{key:"applyFilter",value:function(en,Jt){}},{key:"release",value:function(){}}])&&Rt(Bt.prototype,Qt),Object.defineProperty(Bt,"prototype",{writable:!1}),Ot}();function bt(Ot,Bt){return function(Qt){if(Array.isArray(Qt))return Qt}(Ot)||function(Qt,en){var Jt=Qt==null?null:typeof Symbol<"u"&&Qt[Symbol.iterator]||Qt["@@iterator"];if(Jt!=null){var an,hn,rn=[],dn=!0,Sn=!1;try{for(Jt=Jt.call(Qt);!(dn=(an=Jt.next()).done)&&(rn.push(an.value),!en||rn.length!==en);dn=!0);}catch(wn){Sn=!0,hn=wn}finally{try{dn||Jt.return==null||Jt.return()}finally{if(Sn)throw hn}}return rn}}(Ot,Bt)||function(Qt,en){if(Qt){if(typeof Qt=="string")return ct(Qt,en);var Jt=Object.prototype.toString.call(Qt).slice(8,-1);return Jt==="Object"&&Qt.constructor&&(Jt=Qt.constructor.name),Jt==="Map"||Jt==="Set"?Array.from(Qt):Jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Jt)?ct(Qt,en):void 0}}(Ot,Bt)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ct(Ot,Bt){(Bt==null||Bt>Ot.length)&&(Bt=Ot.length);for(var Qt=0,en=new Array(Bt);Qt<Bt;Qt++)en[Qt]=Ot[Qt];return en}function mt(Ot,Bt){for(var Qt=0;Qt<Bt.length;Qt++){var en=Bt[Qt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Ot,en.key,en)}}function rt(Ot,Bt){var Qt;return Qt=(Ot/=255)<.09804?.01894124847001224*Ot:Ot<.2?.5695370733621028*(Ot-.09804)+.001857:Ot<.298?1.292329661362709*(Ot-.2)+.05993:Ot<.4?1.5339348764221266*(Ot-.298)+.1866:Ot<.498?1.5697674418604652*(Ot-.4)+.343:Ot<.6?1.570223617104747*(Ot-.498)+.4969:Ot<.698?1.536107711138311*(Ot-.6)+.657:Ot<.8?1.2995292271479013*(Ot-.698)+.8076:Ot<.898?.5868013055895552*(Ot-.8)+.9401:.023568065908199296*(Ot-.898)+.9976,255*Math.pow(Qt,Bt)}function pt(Ot,Bt){return 255*Math.pow(Ot/255,Bt)}s(9575),s(9743),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(7327);var ft=function(){function Ot(en,Jt,an){(function(hn,rn){if(!(hn instanceof rn))throw new TypeError("Cannot call a class as a function")})(this,Ot),this.image=en,this.width=Jt,this.height=an,this.length=this.width*this.height}var Bt,Qt;return Bt=Ot,Qt=[{key:"mean",value:function(){var en=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Jt=0,an=0,hn=0;if(en)for(var rn=0;rn<this.length;rn++)Jt+=Math.pow(this.image.data[4*rn+0],2)/(255*this.length),an+=Math.pow(this.image.data[4*rn+1],2)/(255*this.length),hn+=Math.pow(this.image.data[4*rn+2],2)/(255*this.length);else for(var dn=0;dn<this.length;dn++)Jt+=this.image.data[4*dn+0]/this.length,an+=this.image.data[4*dn+1]/this.length,hn+=this.image.data[4*dn+2]/this.length;return[Jt,an,hn]}},{key:"mad",value:function(){var en=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Jt=this.mean(en),an=bt(Jt,3),hn=an[0],rn=an[1],dn=an[2],Sn=0,wn=0,An=0;if(en)for(var _n=0;_n<this.length;_n++)Sn+=Math.abs(Math.pow(this.image.data[4*_n+0],2)/255-hn)/this.length,wn+=Math.abs(Math.pow(this.image.data[4*_n+1],2)/255-rn)/this.length,An+=Math.abs(Math.pow(this.image.data[4*_n+2],2)/255-dn)/this.length;else for(var jn=0;jn<this.length;jn++)Sn+=Math.abs(this.image.data[4*jn+0]-hn)/this.length,wn+=Math.abs(this.image.data[4*jn+1]-rn)/this.length,An+=Math.abs(this.image.data[4*jn+2]-dn)/this.length;return[Sn,wn,An]}},{key:"std",value:function(){var en=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Jt=this.mean(en),an=bt(Jt,3),hn=an[0],rn=an[1],dn=an[2],Sn=0,wn=0,An=0;if(en)for(var _n=0;_n<this.length;_n++)Sn+=Math.pow(Math.pow(this.image.data[4*_n+0],2)/255-hn,2)/this.length,wn+=Math.pow(Math.pow(this.image.data[4*_n+1],2)/255-rn,2)/this.length,An+=Math.pow(Math.pow(this.image.data[4*_n+2],2)/255-dn,2)/this.length;else for(var jn=0;jn<this.length;jn++)Sn+=Math.pow(this.image.data[4*jn+0]-hn,2)/this.length,wn+=Math.pow(this.image.data[4*jn+1]-rn,2)/this.length,An+=Math.pow(this.image.data[4*jn+2]-dn,2)/this.length;return[Sn=Math.sqrt(Sn),wn=Math.sqrt(wn),An=Math.sqrt(An)]}},{key:"blur",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:5,Jt=new OffscreenCanvas(this.width,this.height),an=Jt.getContext("2d");Jt.width=this.width,Jt.height=this.height,an.putImageData(this.image,0,0),an.filter="blur("+en+"px)",an.drawImage(Jt,0,0);var hn=an.getImageData(0,0,this.width,this.height);return hn}},{key:"threshold",value:function(en,Jt,an){var hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,rn=arguments.length>4&&arguments[4]!==void 0&&arguments[4],dn=new ImageData(this.image.data,this.width,this.height),Sn=0;if(rn){var wn=Sn;Sn=hn,hn=wn}for(var An=0;An<this.length;An++)this.image.data[4*An+0]<en?dn.data[4*An+0]=Sn:dn.data[4*An+0]=hn,this.image.data[4*An+1]<Jt?dn.data[4*An+1]=Sn:dn.data[4*An+1]=hn,this.image.data[4*An+2]<an?dn.data[4*An+2]=Sn:dn.data[4*An+2]=hn;return dn}},{key:"powerFilter",value:function(en){var Jt=new Uint8ClampedArray(4*this.length);if(en===1)return this.image;for(var an=0;an<this.length;an++)Jt[4*an+0]=pt(this.image.data[4*an+0],en),Jt[4*an+1]=pt(this.image.data[4*an+1],en),Jt[4*an+2]=pt(this.image.data[4*an+2],en),Jt[4*an+3]=255;return new ImageData(Jt,this.width,this.height)}},{key:"sigmoidFilter",value:function(en){for(var Jt=new Uint8ClampedArray(4*this.length),an=0;an<this.length;an++)Jt[4*an+0]=rt(this.image.data[4*an+0],en),Jt[4*an+1]=rt(this.image.data[4*an+1],en),Jt[4*an+2]=rt(this.image.data[4*an+2],en),Jt[4*an+3]=255;return new ImageData(Jt,this.width,this.height)}},{key:"weightedSum",value:function(en,Jt){for(var an=new Uint8ClampedArray(4*this.length),hn=0;hn<this.length;hn++)an[4*hn+0]=Jt*this.image.data[4*hn+0]+(1-Jt)*en.data[4*hn+0],an[4*hn+1]=Jt*this.image.data[4*hn+1]+(1-Jt)*en.data[4*hn+1],an[4*hn+2]=Jt*this.image.data[4*hn+2]+(1-Jt)*en.data[4*hn+2],an[4*hn+3]=255;return new ImageData(an,this.width,this.height)}},{key:"weightedSumMask",value:function(en,Jt){for(var an=new Uint8ClampedArray(4*this.length),hn=0;hn<this.length;hn++){var rn=Jt.data[4*hn]/255;an[4*hn+0]=rn*this.image.data[4*hn+0]+(1-rn)*en.data[4*hn+0],an[4*hn+1]=rn*this.image.data[4*hn+1]+(1-rn)*en.data[4*hn+1],an[4*hn+2]=rn*this.image.data[4*hn+2]+(1-rn)*en.data[4*hn+2],an[4*hn+3]=255}return new ImageData(an,this.width,this.height)}}],Qt&&mt(Bt.prototype,Qt),Object.defineProperty(Bt,"prototype",{writable:!1}),Ot}();function St(Ot,Bt){if(!(Ot instanceof Bt))throw new TypeError("Cannot call a class as a function")}function It(Ot,Bt){for(var Qt=0;Qt<Bt.length;Qt++){var en=Bt[Qt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Ot,en.key,en)}}var xt=function(){function Ot(){var en=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],Jt=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],an=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;St(this,Ot),this.blurMask=en,this.smoothBorder=Jt,this.blurFactor=an,this.smoothingFactor=hn,this.maskImage=null,this.net=null}var Bt,Qt;return Bt=Ot,Qt=[{key:"loadModel",value:function(){var en=this;return new Promise(function(Jt,an){bodyPix.load({architecture:"MobileNetV1",outputStride:16,multiplier:.75,quantBytes:2}).then(function(hn){en.net=hn,Jt()})})}},{key:"computeMask",value:function(en){var Jt=this;return new Promise(function(an,hn){Jt.net.segmentPerson(en).then(function(rn){Jt.width=rn.width,Jt.height=rn.height,Jt.length=Jt.width*Jt.height;for(var dn=new Uint8ClampedArray(4*Jt.length),Sn=0;Sn<Jt.length;Sn++){var wn=255*rn.data[Sn];dn[4*Sn+0]=wn,dn[4*Sn+1]=wn,dn[4*Sn+2]=wn,dn[4*Sn+3]=255}var An=document.createElement("canvas"),_n=An.getContext("2d");An.width=Jt.width,An.height=Jt.height;var jn=new ImageData(dn,Jt.width,Jt.height);if(_n.putImageData(jn,0,0),Jt.blurMask&&(_n.filter="blur("+Jt.blurFactor+"px)"),_n.drawImage(An,0,0,Jt.width,Jt.height),Jt.maskImage=_n.getImageData(0,0,Jt.width,Jt.height),Jt.blurMask)if(Jt.smoothBorder){if(Jt.smoothingFactor!==-1){var ar=new ft(Jt.maskImage,Jt.width,Jt.height);Jt.maskImage=ar.sigmoidFilter(Jt.smoothingFactor)}}else{var fr=new ft(Jt.maskImage,Jt.width,Jt.height);Jt.maskImage=fr.threshold(40,40,40,255,!1)}an(Jt.maskImage)})})}},{key:"applyTransparency",value:function(en){var Jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Jt===null&&(Jt=this.maskImage);for(var an=new Uint8ClampedArray(en.width*en.height*4),hn=0;hn<en.width*en.height;hn++)an[4*hn+0]=en.data[4*hn+0],an[4*hn+1]=en.data[4*hn+1],an[4*hn+2]=en.data[4*hn+2],an[4*hn+3]=Jt.data[4*hn];var rn=new ImageData(an,en.width,en.height);return rn}},{key:"superposeImages",value:function(en,Jt,an){var hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;hn===null&&(hn=this.maskImage);var rn=new ft(Jt,en.width,en.height),dn=rn.weightedSumMask(an,hn);return dn}},{key:"setBackground",value:function(en,Jt){var an=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.superposeImages(en,en,Jt,an)}},{key:"blurBackground",value:function(en){var Jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,an=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,hn=new ft(en,en.width,en.height),rn=hn.blur(Jt);return this.setBackground(en,rn,an)}}],Qt&&It(Bt.prototype,Qt),Object.defineProperty(Bt,"prototype",{writable:!1}),Ot}();function At(Ot,Bt){if(!(Ot instanceof Bt))throw new TypeError("Cannot call a class as a function")}function Dt(Ot,Bt){for(var Qt=0;Qt<Bt.length;Qt++){var en=Bt[Qt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Ot,en.key,en)}}var wt=et.Y.get("StreamSegmentation"),Mt=apiCC.myWebRTC_Event,vt=function(){function Ot(en){var Jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:480,an=arguments.length>2&&arguments[2]!==void 0?arguments[2]:360,hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;At(this,Ot),this.mediaStream=en,this.backgroundMode="none",this.backgroundBlurFactor=10,this.canvasWidth=Jt,this.canvasHeight=an,this.length=this.canvasWidth*this.canvasHeight,this.userMediaStreamId=hn;for(var rn=new Uint8ClampedArray(4*this.length),dn=0;dn<4*this.length;dn++)rn[dn]=255;this.backgroundImage=new ImageData(rn,this.canvasWidth,this.canvasHeight);var Sn=!0,wn=!0,An=5,_n=-1;this.backSub=new xt(Sn,wn,An,_n),this.modelLoaded=!1,this.maskStreamLaunched=!1,this.backgroundSubtractionActivated=!1}var Bt,Qt;return Bt=Ot,Qt=[{key:"setBackgroundMode",value:function(en){this.backgroundMode=en}},{key:"setBackgroundImage",value:function(en){this.backgroundImage=en}},{key:"setBackgroundBlurFactor",value:function(en){this.backgroundBlurFactor=en}},{key:"loadModel",value:function(){wt.debug("Loading model");var en=this;return new Promise(function(Jt,an){en.backSub.loadModel().then(function(hn){en.modelLoaded=!0,wt.debug("Model loaded"),Jt()})})}},{key:"getMaskStream",value:function(){var en=document.createElement("video");en.srcObject=this.mediaStream;var Jt=document.createElement("canvas"),an=Jt.getContext("2d");Jt.width=this.canvasWidth,Jt.height=this.canvasHeight;var hn=document.createElement("canvas"),rn=hn.getContext("2d");hn.width=this.canvasWidth,hn.height=this.canvasHeight;var dn=this;en.addEventListener("loadeddata",function(){en.play(),requestAnimationFrame(Cr),dn.modelLoaded?jn=!0:dn.loadModel().then(function(gr){jn=!0})});for(var Sn=!0,wn=new Uint8ClampedArray(4*this.length),An=0;An<4*this.length;An++)wn[An]=255;var _n=new ImageData(wn,this.canvasWidth,this.canvasHeight);rn.putImageData(_n,0,0);var jn=!1,ar=0,fr=!0;function Cr(){an.drawImage(en,0,0,Jt.width,Jt.height);var gr=an.getImageData(0,0,Jt.width,Jt.height);if(dn.modelLoaded&&Sn&&jn&&(fr||dn.backgroundMode!=="none")){fr&&(fr=!1);var Er=new Date;Sn=!1,dn.backSub.computeMask(gr).then(function(Nr){Sn=!0,1/((new Date-Er)/1e3)<1&&++ar>=10&&(jn=!1,wt.error("The segmentation process cannot be handled"),Mt.createBackgroundSubstractionStopComputeTimeEvent(dn.userMediaStreamId))})}dn.modelLoaded&&dn.backSub.maskImage!==null&&jn?rn.putImageData(dn.backSub.maskImage,0,0):rn.putImageData(_n,0,0),dn.continueMaskComputation?requestAnimationFrame(Cr):(wt.debug("Mask computation stoped"),dn.continueMaskComputation=!0)}return this.continueMaskComputation=!0,this.maskMediaStream=hn.captureStream(),this.maskStreamLaunched=!0,this.maskMediaStream}},{key:"activateBackgroundSubtraction",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(en!==null&&this.setBackgroundMode(en),this.backgroundSubtractionActivated)return this.processedMediaStream;this.maskStreamLaunched||this.getMaskStream();var Jt=document.createElement("video");Jt.srcObject=this.mediaStream;var an=document.createElement("video");an.srcObject=this.maskMediaStream;var hn=document.createElement("canvas"),rn=hn.getContext("2d");hn.width=this.canvasWidth,hn.height=this.canvasHeight;var dn=document.createElement("canvas"),Sn=dn.getContext("2d");dn.width=this.canvasWidth,dn.height=this.canvasHeight,this.continueBackgroundSubtraction=!0;var wn=this;function An(){rn.drawImage(Jt,0,0,hn.width,hn.height);var _n=rn.getImageData(0,0,hn.width,hn.height);if(wn.backgroundMode==="none")Sn.putImageData(_n,0,0);else{rn.drawImage(an,0,0,hn.width,hn.height);var jn=rn.getImageData(0,0,hn.width,hn.height),ar=null;switch(wn.backgroundMode){case"image":ar=wn.backSub.setBackground(_n,wn.backgroundImage,jn);break;case"blur":default:ar=wn.backSub.blurBackground(_n,wn.backgroundBlurFactor,jn);break;case"transparent":ar=wn.backSub.applyTransparency(_n,jn)}Sn.putImageData(ar,0,0)}wn.continueBackgroundSubtraction?requestAnimationFrame(An):(wt.debug("Mask application stoped"),wn.continueBackgroundSubtraction=!0)}return Jt.addEventListener("loadeddata",function(){Jt.play(),an.play(),requestAnimationFrame(An)}),this.processedMediaStream=dn.captureStream(30),this.backgroundSubtractionActivated=!0,this.processedMediaStream}},{key:"deactivateBackgroundSubtraction",value:function(){this.setBackgroundMode("none"),this.processedMediaStream=this.mediaStream,this.backgroundSubtractionActivated=!1,this.continueBackgroundSubtraction=!1,this.maskMediaStream=null,this.maskStreamLaunched=!1,this.continueMaskComputation=!1}}],Qt&&Dt(Bt.prototype,Qt),Object.defineProperty(Bt,"prototype",{writable:!1}),Ot}();function Ft(Ot){return Ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Bt){return typeof Bt}:function(Bt){return Bt&&typeof Symbol=="function"&&Bt.constructor===Symbol&&Bt!==Symbol.prototype?"symbol":typeof Bt},Ft(Ot)}function Ht(Ot,Bt){for(var Qt=0;Qt<Bt.length;Qt++){var en=Bt[Qt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Ot,en.key,en)}}function Wt(Ot,Bt){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Qt,en){return Qt.__proto__=en,Qt},Wt(Ot,Bt)}function tn(Ot,Bt){if(Bt&&(Ft(Bt)==="object"||typeof Bt=="function"))return Bt;if(Bt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Qt){if(Qt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Qt}(Ot)}function gn(Ot){return gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Bt){return Bt.__proto__||Object.getPrototypeOf(Bt)},gn(Ot)}var nn=et.Y.get("OldMediaFilterBackgroundSubtraction"),qt=function(Ot){(function(rn,dn){if(typeof dn!="function"&&dn!==null)throw new TypeError("Super expression must either be null or a function");rn.prototype=Object.create(dn&&dn.prototype,{constructor:{value:rn,writable:!0,configurable:!0}}),Object.defineProperty(rn,"prototype",{writable:!1}),dn&&Wt(rn,dn)})(hn,Ot);var Bt,Qt,en,Jt,an=(en=hn,Jt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var rn,dn=gn(en);if(Jt){var Sn=gn(this).constructor;rn=Reflect.construct(dn,arguments,Sn)}else rn=dn.apply(this,arguments);return tn(this,rn)});function hn(){var rn;return function(dn,Sn){if(!(dn instanceof Sn))throw new TypeError("Cannot call a class as a function")}(this,hn),(rn=an.call(this)).streamSegmentation=null,rn.userMediaStreamId=null,rn}return Bt=hn,(Qt=[{key:"applyFilter",value:function(rn,dn){var Sn=this;nn.debug("Apply filter with descriptor:",dn);var wn=rn.getAudioTracks();wn.length>0&&wn.forEach(function(jn){rn.removeTrack(jn)});var An=rn.getVideoTracks();if(An.length===0)return Promise.reject("MediaStream has no video tracks");var _n=An[0].getSettings();return dn.options!==void 0&&dn.options.userMediaStreamId!==void 0&&(this.userMediaStreamId=dn.options.userMediaStreamId),this.streamSegmentation=new vt(rn,_n.width,_n.height,this.userMediaStreamId),this.loadTensorflow().then(function(jn){return Sn.loadTensorflowModel()}).then(function(jn){return new Promise(function(ar,fr){nn.debug("Model loading..."),Sn.streamSegmentation.loadModel().then(function(Cr){nn.debug("Model loaded");var gr=null;dn.options!==void 0&&dn.options.backgroundMode!==void 0&&(dn.options.backgroundMode==="image"&&dn.options.image instanceof ImageData&&Sn.streamSegmentation.setBackgroundImage(dn.options.image),gr=dn.options.backgroundMode);var Er=Sn.streamSegmentation.activateBackgroundSubtraction(gr);wn.forEach(function(Nr){Er.addTrack(Nr)}),ar(Er)})})}).catch(function(jn){return Promise.reject(jn)})}},{key:"release",value:function(){this.streamSegmentation.deactivateBackgroundSubtraction(),this.streamSegmentation=null}},{key:"loadTensorflow",value:function(){return nn.debug("Tensorflow script loading..."),new Promise(function(rn,dn){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){nn.debug("Tensorflow script loaded"),rn()},error:function(wn){dn("Resources loading failed, depsNotFound: "+wn)},retrycb:function(wn,An){nn.warn("Tensorflow loading retry :"+wn+" ,delay before retry :"+An)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.2"],"tensorflow",Sn)})}},{key:"loadTensorflowModel",value:function(){return nn.debug("Tensorflow model script loading..."),new Promise(function(rn,dn){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){nn.debug("Tensorflow model script loaded"),rn()},error:function(wn){dn("Resources loading failed, depsNotFound: "+wn)},retrycb:function(wn,An){nn.warn("Tensorflow model loading retry :"+wn+" ,delay before retry :"+An)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.0"],"tensorflow-model",Sn)})}}])&&Ht(Bt.prototype,Qt),Object.defineProperty(Bt,"prototype",{writable:!1}),hn}(ht);function fn(Ot,Bt){var Qt=typeof Symbol<"u"&&Ot[Symbol.iterator]||Ot["@@iterator"];if(!Qt){if(Array.isArray(Ot)||(Qt=function(dn,Sn){if(dn){if(typeof dn=="string")return Cn(dn,Sn);var wn=Object.prototype.toString.call(dn).slice(8,-1);return wn==="Object"&&dn.constructor&&(wn=dn.constructor.name),wn==="Map"||wn==="Set"?Array.from(dn):wn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(wn)?Cn(dn,Sn):void 0}}(Ot))||Bt&&Ot&&typeof Ot.length=="number"){Qt&&(Ot=Qt);var en=0,Jt=function(){};return{s:Jt,n:function(){return en>=Ot.length?{done:!0}:{done:!1,value:Ot[en++]}},e:function(dn){throw dn},f:Jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var an,hn=!0,rn=!1;return{s:function(){Qt=Qt.call(Ot)},n:function(){var dn=Qt.next();return hn=dn.done,dn},e:function(dn){rn=!0,an=dn},f:function(){try{hn||Qt.return==null||Qt.return()}finally{if(rn)throw an}}}}function Cn(Ot,Bt){(Bt==null||Bt>Ot.length)&&(Bt=Ot.length);for(var Qt=0,en=new Array(Bt);Qt<Bt;Qt++)en[Qt]=Ot[Qt];return en}function Tn(Ot){return(Ot[2]-Ot[0])*(Ot[3]-Ot[1])}function un(Ot,Bt){var Qt=Ot[0],en=Ot[1],Jt=Ot[2],an=Ot[3],hn=Bt[0],rn=Bt[1],dn=Bt[2],Sn=Bt[3],wn=Tn([Math.max(Qt,hn),Math.max(en,rn),Math.min(Jt,dn),Math.min(an,Sn)]);return wn/(Tn(Ot)+Tn(Bt)-wn)}function mn(Ot){var Bt,Qt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.2,en=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,Jt=Ot.yolo,an={yolo:[]},hn=fn(Jt);try{for(hn.s();!(Bt=hn.n()).done;){var rn=Bt.value,dn=rn.objectness;if(dn>Qt)if(en!==null){var Sn,wn=rn.bounding_box,An=Tn(wn),_n=0,jn=null,ar=0,fr=fn(Jt);try{for(fr.s();!(Sn=fr.n()).done;){var Cr=Sn.value,gr=Cr.bounding_box,Er=un(wn,gr);Er!==1&&Er>_n&&(_n=Er,jn=Cr,ar=Tn(Cr.bounding_box))}}catch(Nr){fr.e(Nr)}finally{fr.f()}(jn===null||_n<en||ar<An)&&an.yolo.push(rn)}else an.yolo.push(rn)}}catch(Nr){hn.e(Nr)}finally{hn.f()}return an}function yn(Ot,Bt){var Qt,en=Ot.yolo,Jt={yolo:[]},an=fn(Bt.yolo);try{for(an.s();!(Qt=an.n()).done;){var hn,rn=Qt.value,dn=rn.class,Sn=rn.bounding_box,wn=rn.objectness,An=wn,_n=fn(en);try{for(_n.s();!(hn=_n.n()).done;){var jn=hn.value;if(jn.class===dn){var ar=un(jn.bounding_box,Sn);ar>0&&(An=wn+.75*(1-wn)*ar*jn.objectness)}}}catch(Cr){_n.e(Cr)}finally{_n.f()}var fr={class:dn,objectness:An,bounding_box:Sn};Jt.yolo.push(fr)}}catch(Cr){an.e(Cr)}finally{an.f()}return Jt}function pn(Ot,Bt){return function(Qt){if(Array.isArray(Qt))return Qt}(Ot)||function(Qt,en){var Jt=Qt==null?null:typeof Symbol<"u"&&Qt[Symbol.iterator]||Qt["@@iterator"];if(Jt!=null){var an,hn,rn=[],dn=!0,Sn=!1;try{for(Jt=Jt.call(Qt);!(dn=(an=Jt.next()).done)&&(rn.push(an.value),!en||rn.length!==en);dn=!0);}catch(wn){Sn=!0,hn=wn}finally{try{dn||Jt.return==null||Jt.return()}finally{if(Sn)throw hn}}return rn}}(Ot,Bt)||function(Qt,en){if(Qt){if(typeof Qt=="string")return In(Qt,en);var Jt=Object.prototype.toString.call(Qt).slice(8,-1);return Jt==="Object"&&Qt.constructor&&(Jt=Qt.constructor.name),Jt==="Map"||Jt==="Set"?Array.from(Qt):Jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Jt)?In(Qt,en):void 0}}(Ot,Bt)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function In(Ot,Bt){(Bt==null||Bt>Ot.length)&&(Bt=Ot.length);for(var Qt=0,en=new Array(Bt);Qt<Bt;Qt++)en[Qt]=Ot[Qt];return en}function kn(Ot,Bt){for(var Qt=0;Qt<Bt.length;Qt++){var en=Bt[Qt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Ot,en.key,en)}}s(3123),s(4723),s(2472),s(6699),s(2023),s(9720),s(9600),s(2707),s(1058);var Mn=et.Y.get("StreamAIE"),xn=apiCC.myWebRTC_Event,Pn=function(){function Ot(en,Jt){(function(hn,rn){if(!(hn instanceof rn))throw new TypeError("Cannot call a class as a function")})(this,Ot),this.mediaStream=en,this.descriptorOptions=Jt,this.modelName=Jt.modelName,this.maxBoxes=Jt.maxBoxes||null,this.scoreThresh=Jt.scoreThresh||null,this.forceReload=Jt.forceReload||!1,this.classFilter=this.descriptorOptions.classFilter||"all",this.drawingConfig=this.descriptorOptions.drawingConfig||{},this.userMediaStreamId=Jt.userMediaStreamId,this.clientId=Jt.clientId;var an=this.mediaStream.getVideoTracks();an.length===0&&(this.mediaSettings=null),this.mediaSettings=an[0].getSettings(),this.canvasWidth=this.mediaSettings.width||480,this.canvasHeight=this.mediaSettings.height||480,this.length=this.canvasWidth*this.canvasHeight,this.snapshot=!1,this.log=!1,this.minSnapshotPeriod=0,this.memoryTime=0,this.lastAnnotations={yolo:[]},this.lastRawAnnotations={yolo:[]},this.objectDetectionActivated=!1,this.drawAnnotationsBool=!1,this.aieUrl=null,this.token=null,this.loadedModel=null,this.promises=[],this.isReleased=!1,this.resinzingSize=416,this.callId=null}var Bt,Qt;return Bt=Ot,Qt=[{key:"activateLogs",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.memoryTime=en,this.log=!0}},{key:"stopLogs",value:function(){this.log=!1,this.memoryTime=0}},{key:"activateSnapshots",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.snapshot=!0,this.minSnapshotPeriod=en}},{key:"stopSnapshots",value:function(){this.snapshot=!1,this.minSnapshotPeriod=0}},{key:"activateAnnotations",value:function(){this.lastAnnotations={yolo:[]},this.drawAnnotationsBool=!0,this.getAnnotations()}},{key:"stopAnnotations",value:function(){this.drawAnnotationsBool=!1}},{key:"getAnnotations",value:function(){var en=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],Jt=document.createElement("video");Jt.srcObject=this.mediaStream;var an=document.createElement("canvas"),hn=an.getContext("2d");an.width=this.canvasWidth,an.height=this.canvasHeight;var rn=document.createElement("canvas"),dn=rn.getContext("2d");rn.width=this.canvasWidth,rn.height=this.canvasHeight;var Sn=this;function wn(Sr,Dr){for(var wr=Sr.split(","),Or=wr[0].match(/:(.*?);/)[1],Ur=atob(wr[1]),Hr=Ur.length,na=new Uint8Array(Hr);Hr--;)na[Hr]=Ur.charCodeAt(Hr);return new File([na],Dr,{type:Or})}Jt.addEventListener("loadeddata",function(){Jt.play(),requestAnimationFrame(function(){Qr(Sn.aieUrl,Sn.token,Sn.loadedModel)})});var An=!0,_n={},jn=null,ar=new Date;function fr(Sr,Dr,wr){var Or=wn(an.toDataURL("image/jpeg")),Ur={pipelineCallId:Sn.getOrCreatePipeline(),file:Or,transferType:"plugin",pluginName:"httpPost",pluginData:{url:Sr,headers:{Authorization:"Token "+Dr},formData:{file:"$DATA",angled:1,model:wr,size:Sn.resinzingSize}}};apiCC.session.apiCCWebRTCClient.webRTCClient.pushData(null,Ur,null,{success:function(Hr){var na=(new Date-jn)/1e3,Vn=1/na;return Mn.debug("Computation time:",na,"s ,FPS:",Vn),Qr(Sr,Dr,wr),Hr.data.error!==void 0?Mn.error("http post error :",Hr.data.error):Hr.data.result===void 0?Mn.error("An error occured when trying to annotate a snapshot"):void Cr(Hr.data)},failure:function(Hr,na,Vn){Mn.error("## pushData:failure",na,Vn,Hr)}})}function Cr(Sr){var Dr=Sr.result;Sn.isReleased||(Sn.lastRawAnnotations=Dr,Dr.yolo!==void 0&&Er(Dr),Dr.ocr===void 0&&Dr.codes===void 0||gr(Dr))}function gr(Sr){Sn.lastAnnotations={ocr:Sr.ocr,codes:Sr.codes};var Dr="";if(Sr.ocr.length>1){Dr+="Words found : ";for(var wr=0;wr<Sr.ocr.length;wr++)Dr=Dr+Sr.ocr[wr].text+", "}if(Sr.codes.length>1){Dr+="Codes found : ";for(var Or=0;Or<Sr.codes.length;Or++)Dr=Dr+Sr.codes[Or].code+", "}Nr(Dr),qr()}function Er(Sr){Sr.yolo.length>0&&(en&&(Sr=yn(Sn.lastRawAnnotations,Sr)),Sn.scoreThresh!==null&&(Sr=mn(Sr,Sn.scoreThresh)));for(var Dr={yolo:[]},wr={},Or=Sn.classFilter.split(", "),Ur=0;Ur<Sr.yolo.length;Ur++){var Hr=Sr.yolo[Ur];(Sn.classFilter==="all"||Or.includes(Hr.class))&&(Hr.class in wr||(wr[Hr.class]=0),wr[Hr.class]+=1,Dr.yolo.push(Hr))}if(Sr=Dr,Sn.lastAnnotations=Sr,Sn.log||Sn.snapshot){for(var na=new Date,Vn=[],zn=0,Yn=Object.entries(wr);zn<Yn.length;zn++){var Rr=pn(Yn[zn],2),Hn=Rr[0],jr=Rr[1];Vn.push(jr+" "+Hn+"(s) detected."),(!(Hn in _n)||na-_n[Hn]>1e3*Sn.memoryTime)&&(_n[Hn]=na)}var xr=Vn.sort().join(" ");xr!==""&&(Nr(xr),qr())}}function Nr(Sr){Sn.log&&xn.createAIELogEvent(Sn.userMediaStreamId,Sr)}function qr(){if(Sn.snapshot){var Sr=new Date,Dr=hn.getImageData(0,0,an.width,an.height);if(Sr-ar>1e3*Sn.minSnapshotPeriod){dn.putImageData(Dr,0,0),Sn.drawAnnotations(Sn.lastAnnotations,dn,Sn.drawingConfig);var wr=rn.toDataURL("image/png"),Or=new Image;Or.src=wr,xn.createAIESnapshotEvent(Sn.userMediaStreamId,Or),ar=Sr}}}function Qr(Sr,Dr,wr){hn.drawImage(Jt,0,0,an.width,an.height),(An||Sn.drawAnnotationsBool)&&(An&&(An=!1),jn=new Date,fr(Sr,Dr,wr))}}},{key:"getOrCreatePipeline",value:function(){if(this.callId!==null)return this.callId;var en=this;return this.callId=apiCC.session.apiCCWebRTCClient.webRTCClient.pushData(null,{transferType:"pipeline"},null,{failure:function(Jt){Jt==="dataChannelClosed"?(Mn.debug("dataChannelClosed : no activity on dataChannel timeout"),en.callId=null):Mn.error("dataChannel failure",Jt)}}),this.callId}},{key:"drawAnnotations",value:function(en,Jt){var an=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},hn=an.color||"#ED5131",rn=an.textColor||"#FFFFFF",dn=an.colorMap||null,Sn=Object.prototype.hasOwnProperty.call(an,Sn)?an.lineWidth:3,wn=an.font||"15px Arial";if(en.yolo!==void 0&&en.yolo.length>0)for(var An=0;An<en.yolo.length;An++){var _n=en.yolo[An],jn=_n.bounding_box,ar=jn[0],fr=jn[1],Cr=jn[2],gr=jn[3];this.modelName==="mask_augmented_refined"&&(Cr-=ar,gr-=fr);var Er=hn;dn!==null&&_n.class in dn&&(Er=dn[_n.class]),Jt.lineWidth=Sn,Jt.strokeStyle=Er,Jt.strokeRect(ar,fr,Cr,gr),Jt.font=wn;var Nr=parseInt(wn,10),qr=_n.class,Qr=Jt.measureText(qr).width;Jt.fillStyle=Er,Jt.fillRect(ar-Sn/2,fr-Math.round(4*Nr/3),Qr+Nr+Sn,Math.round(4*Nr/3)),Jt.fillStyle=rn,Jt.fillText(qr,ar+Math.round(Nr/2)-Sn/2,fr-Math.round(Nr/2))}if(en.ocr!==void 0&&en.ocr.length>0){wn=an.font||"25px Arial";for(var Sr=0;Sr<en.ocr.length;Sr++){var Dr=en.ocr[Sr],wr=Dr.bounding_box,Or=wr[0],Ur=wr[1],Hr=wr[2],na=wr[3];this.modelName==="mask_augmented_refined"&&(Hr-=Or,na-=Ur),Jt.lineWidth=Sn,Jt.strokeStyle=hn,Jt.strokeRect(Or,Ur,Hr,na),Jt.font=wn;var Vn=parseInt(wn,10),zn=Dr.text,Yn=Jt.measureText(zn).width;Jt.fillStyle=hn,Jt.fillRect(Or-Sn/2,Ur-Math.round(4*Vn/3),Yn+Vn+Sn,Math.round(4*Vn/3)),Jt.fillStyle=rn,Jt.fillText(zn,Or+Math.round(Vn/2)-Sn/2,Ur-Math.round(Vn/2))}}if(en.codes!==void 0&&en.codes.length>0){wn=an.font||"25px Arial";for(var Rr=0;Rr<en.codes.length;Rr++){var Hn=en.codes[Rr],jr=Hn.bounding_box,xr=jr[0],Ir=jr[1],$n=jr[2],pr=jr[3];this.modelName==="mask_augmented_refined"&&($n-=xr,pr-=Ir),Jt.lineWidth=Sn,Jt.strokeStyle=hn,Jt.strokeRect(xr,Ir,$n,pr),Jt.font=wn;var _r=parseInt(wn,10),yr=Hn.code,Jr=Jt.measureText(yr).width;Jt.fillStyle=hn,Jt.fillRect(xr-Sn/2,Ir-Math.round(4*_r/3),Jr+_r+Sn,Math.round(4*_r/3)),Jt.fillStyle=rn,Jt.fillText(yr,xr+Math.round(_r/2)-Sn/2,Ir-Math.round(_r/2))}}}},{key:"activateObjectDetection",value:function(){if(this.objectDetectionActivated)return this.processedMediaStream;var en=document.createElement("video");en.srcObject=this.mediaStream;var Jt=document.createElement("canvas"),an=Jt.getContext("2d");Jt.width=this.canvasWidth,Jt.height=this.canvasHeight;var hn=document.createElement("canvas"),rn=hn.getContext("2d");hn.width=this.canvasWidth,hn.height=this.canvasHeight;var dn=this;function Sn(){an.drawImage(en,0,0,Jt.width,Jt.height);var wn=an.getImageData(0,0,Jt.width,Jt.height);rn.putImageData(wn,0,0),dn.drawAnnotationsBool&&dn.drawAnnotations(dn.lastAnnotations,rn,dn.drawingConfig),requestAnimationFrame(Sn)}return en.addEventListener("loadeddata",function(){en.play(),requestAnimationFrame(Sn)}),this.processedMediaStream=hn.captureStream(),this.objectDetectionActivated=!0,this.processedMediaStream}},{key:"loadModel",value:function(){var en=this;return new Promise(function(Jt,an){Mn.debug("loading model");var hn={modelName:en.modelName,maxBoxes:en.maxBoxes,scoreThresh:en.scoreThresh,forceReload:en.forceReload};en.sendMessage(hn,"AIELoadModel",Jt,an)})}},{key:"sendMessage",value:function(en,Jt,an,hn){var rn=setTimeout(hn,5e3);this.promises.push({timeout:rn,resolve:an}),en.timeout=rn,this.sendMessageToCCS(en,Jt)}},{key:"sendMessageToCCS",value:function(en,Jt){if(en.userMediaStreamId=this.userMediaStreamId,en.clientId=this.clientId,en.data={pubSub:"AieConnector"},en.type=Jt,apiCC!==void 0){var an=apiCC.session.apiCCWebRTCClient.webRTCClient.socket;try{var hn=JSON.stringify(en);an.emit(Jt,hn)}catch(rn){Mn.error("JSON Stringify error : ",rn)}}}},{key:"modelLoaded",value:function(en){Mn.debug("Loaded model name :",en.modelName),this.aieUrl=en.url,this.loadedModel=en.modelName,this.token=en.token;var Jt=this.activateObjectDetection();this.promises.forEach(function(an){en.timeout===an.timeout&&(clearTimeout(an.timeout),an.resolve(Jt))})}},{key:"release",value:function(){this.isReleased=!0,this.stopLogs(),this.stopSnapshots(),this.stopAnnotations(),this.sendMessageToCCS({},"AIELogout")}}],Qt&&kn(Bt.prototype,Qt),Object.defineProperty(Bt,"prototype",{writable:!1}),Ot}();function On(Ot){return On=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Bt){return typeof Bt}:function(Bt){return Bt&&typeof Symbol=="function"&&Bt.constructor===Symbol&&Bt!==Symbol.prototype?"symbol":typeof Bt},On(Ot)}function Dn(Ot,Bt){for(var Qt=0;Qt<Bt.length;Qt++){var en=Bt[Qt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Ot,en.key,en)}}function Fn(Ot,Bt){return Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Qt,en){return Qt.__proto__=en,Qt},Fn(Ot,Bt)}function dr(Ot,Bt){if(Bt&&(On(Bt)==="object"||typeof Bt=="function"))return Bt;if(Bt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Qt){if(Qt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Qt}(Ot)}function ir(Ot){return ir=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Bt){return Bt.__proto__||Object.getPrototypeOf(Bt)},ir(Ot)}var Xn=et.Y.get("MediaFilterAIE"),tr=function(Ot){(function(rn,dn){if(typeof dn!="function"&&dn!==null)throw new TypeError("Super expression must either be null or a function");rn.prototype=Object.create(dn&&dn.prototype,{constructor:{value:rn,writable:!0,configurable:!0}}),Object.defineProperty(rn,"prototype",{writable:!1}),dn&&Fn(rn,dn)})(hn,Ot);var Bt,Qt,en,Jt,an=(en=hn,Jt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var rn,dn=ir(en);if(Jt){var Sn=ir(this).constructor;rn=Reflect.construct(dn,arguments,Sn)}else rn=dn.apply(this,arguments);return dr(this,rn)});function hn(){var rn;return function(dn,Sn){if(!(dn instanceof Sn))throw new TypeError("Cannot call a class as a function")}(this,hn),(rn=an.call(this)).userMediaStreamId=null,rn.streamAIE=null,rn}return Bt=hn,(Qt=[{key:"applyFilter",value:function(rn,dn){var Sn=this;return new Promise(function(wn,An){if(Xn.debug("Apply filter with descriptor :",dn),dn.options===void 0&&An("Filter options object required"),dn.options.modelName===void 0)An("modelName options required");else{var _n=rn.getAudioTracks();_n.length>0&&_n.forEach(function(jn){rn.removeTrack(jn)}),Sn.streamAIE=new Pn(rn,dn.options),Sn.streamAIE.loadModel().then(function(jn){_n.forEach(function(ar){jn.addTrack(ar)}),wn(jn)}).catch(function(jn){An(jn)})}})}},{key:"release",value:function(){this.streamAIE.release()}}])&&Dn(Bt.prototype,Qt),Object.defineProperty(Bt,"prototype",{writable:!1}),hn}(ht);function cn(Ot){return cn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Bt){return typeof Bt}:function(Bt){return Bt&&typeof Symbol=="function"&&Bt.constructor===Symbol&&Bt!==Symbol.prototype?"symbol":typeof Bt},cn(Ot)}function Jn(Ot,Bt){for(var Qt=0;Qt<Bt.length;Qt++){var en=Bt[Qt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Ot,en.key,en)}}function Qn(Ot,Bt){return Qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Qt,en){return Qt.__proto__=en,Qt},Qn(Ot,Bt)}function sr(Ot,Bt){if(Bt&&(cn(Bt)==="object"||typeof Bt=="function"))return Bt;if(Bt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Qt){if(Qt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Qt}(Ot)}function Bn(Ot){return Bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Bt){return Bt.__proto__||Object.getPrototypeOf(Bt)},Bn(Ot)}var rr=et.Y.get("MediaFilterBackgroundSubstraction"),nr=function(Ot){(function(rn,dn){if(typeof dn!="function"&&dn!==null)throw new TypeError("Super expression must either be null or a function");rn.prototype=Object.create(dn&&dn.prototype,{constructor:{value:rn,writable:!0,configurable:!0}}),Object.defineProperty(rn,"prototype",{writable:!1}),dn&&Qn(rn,dn)})(hn,Ot);var Bt,Qt,en,Jt,an=(en=hn,Jt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var rn,dn=Bn(en);if(Jt){var Sn=Bn(this).constructor;rn=Reflect.construct(dn,arguments,Sn)}else rn=dn.apply(this,arguments);return sr(this,rn)});function hn(){var rn;return function(dn,Sn){if(!(dn instanceof Sn))throw new TypeError("Cannot call a class as a function")}(this,hn),(rn=an.call(this)).mediaStream=null,rn.mediaStreamSettings=null,rn.processedMediaStream=null,rn.net=null,rn.lossRatio=null,rn.processBackground=!1,rn.bgImageData=null,rn.videoElement=document.createElement("video"),rn.canvas=document.createElement("canvas"),rn.canvasContext=rn.canvas.getContext("2d"),rn}return Bt=hn,(Qt=[{key:"applyFilter",value:function(rn,dn){var Sn=this;return new Promise(function(wn,An){var _n=rn.getAudioTracks();_n.length>0&&_n.forEach(function(jn){rn.removeTrack(jn)}),Sn.loadTensorflow().then(function(){Sn.loadTensorflowModel().then(function(){Sn.videoElement.srcObject=rn;var jn=Sn;Sn.videoElement.addEventListener("loadeddata",function(){jn.videoElement.play(),jn.mediaStream=rn,jn.descriptors=dn,jn.processedMediaStream=jn.canvas.captureStream(),jn.mediaStreamSettings=jn.mediaStream.getVideoTracks()[0].getSettings(),jn.videoElement.height=240,jn.lossRatio=jn.mediaStreamSettings.height/jn.videoElement.height,jn.videoElement.width=jn.videoElement.height*jn.mediaStreamSettings.aspectRatio,jn.videoElement.onplaying=function(){jn.canvas.height=jn.videoElement.videoHeight,jn.canvas.width=jn.videoElement.videoWidth},jn.loadBodyPix().then(function(){_n.forEach(function(ar){jn.processedMediaStream.addTrack(ar)}),wn(jn.processedMediaStream)}).catch(function(ar){rr.error(ar)})})}).catch(function(jn){rr.error(jn)})}).catch(function(jn){rr.error(jn)})})}},{key:"loadTensorflow",value:function(){return rr.debug("Tensorflow script loading..."),new Promise(function(rn,dn){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){rr.debug("Tensorflow script loaded"),rn()},error:function(wn){dn("Resources loading failed, depsNotFound: "+wn)},retrycb:function(wn,An){rr.warn("Tensorflow loading retry :"+wn+" ,delay before retry :"+An)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.2"],"tensorflow",Sn)})}},{key:"loadTensorflowModel",value:function(){return rr.debug("Tensorflow model script loading..."),new Promise(function(rn,dn){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){rr.debug("Tensorflow model script loaded"),rn()},error:function(wn){dn("Resources loading failed, depsNotFound: "+wn)},retrycb:function(wn,An){rr.warn("Tensorflow model loading retry :"+wn+" ,delay before retry :"+An)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.0"],"tensorflow-model",Sn)})}},{key:"loadBodyPix",value:function(){var rn=this;return new Promise(function(dn,Sn){bodyPix.load({multiplier:.75,stride:32,quantBytes:4}).then(function(wn){rn.net=wn,rn.perform(),dn()}).catch(function(wn){return Sn(wn)})})}},{key:"perform",value:function(){if(this.descriptors.options!==void 0&&this.descriptors.options.backgroundMode!==void 0)switch(this.processBackground=!0,this.descriptors.options.backgroundMode){case"blur":rr.warn("This method is deprecated, please use Stream#blur method now."),this.videoElement.height=this.mediaStreamSettings.height,this.videoElement.width=this.mediaStreamSettings.width,this.canvas.height=this.videoElement.height,this.canvas.width=this.videoElement.width,this.blurBackground();break;case"transparent":this.noBackground();break;case"image":this.descriptors.options.image!==void 0?(this.resizeImageData(this.descriptors.options.image),this.imageBackground()):rr.error("image option is required when creating the filter");break;default:rr.debug("The backgroundMode : ",this.descriptors.options.backgroundMode," is not implemented. Refer to documentation for accepted values."),this.blurBackground()}else rr.error("backgroundMode option is required")}},{key:"blurBackground",value:function(){var rn=this;this.net.segmentPerson(this.videoElement).then(function(dn){rn.blurBackground(),bodyPix.drawBokehEffect(rn.canvas,rn.videoElement,dn,9,2,!1)})}},{key:"noBackground",value:function(){var rn=this;this.net.segmentPerson(this.videoElement).then(function(dn){rn.canvasContext.drawImage(rn.videoElement,0,0,rn.videoElement.width,rn.videoElement.height);for(var Sn=rn.canvasContext.getImageData(0,0,rn.videoElement.width,rn.videoElement.height),wn=Sn.data,An=0;An<wn.length;An+=4)dn.data[An/4]===0&&(wn[An+3]=0);var _n=rn.scaleImageData(Sn,rn.lossRatio);rn.canvasContext.imageSmoothingEnabled=!0,rn.canvasContext.putImageData(_n,0,0),rn.processBackground&&rn.noBackground()})}},{key:"imageBackground",value:function(){var rn=this;this.net.segmentPerson(this.videoElement).then(function(dn){rn.canvasContext.putImageData(rn.bgImageData,0,0,0,0,rn.videoElement.width,rn.videoElement.height);var Sn=rn.canvasContext.getImageData(0,0,rn.videoElement.width,rn.videoElement.height);rn.canvasContext.drawImage(rn.videoElement,0,0,rn.videoElement.width,rn.videoElement.height);for(var wn=rn.canvasContext.getImageData(0,0,rn.videoElement.width,rn.videoElement.height),An=wn.data,_n=0;_n<An.length;_n+=4)dn.data[_n/4]===0&&(An[_n]=Sn.data[_n],An[_n+1]=Sn.data[_n+1],An[_n+2]=Sn.data[_n+2],An[_n+3]=Sn.data[_n+3]);var jn=rn.scaleImageData(wn,rn.lossRatio);rn.canvasContext.imageSmoothingEnabled=!0,rn.canvasContext.putImageData(jn,0,0),rn.processBackground&&rn.imageBackground()})}},{key:"resizeImageData",value:function(rn){var dn=this.videoElement.width/rn.width,Sn=this.videoElement.height/rn.height;this.bgImageData=dn>=Sn?this.scaleImageData(rn,dn):this.scaleImageData(rn,Sn)}},{key:"noBackgroundWithFullResolution",value:function(){var rn=this;this.net.segmentPerson(this.videoElement).then(function(dn){rn.canvasContext.drawImage(rn.videoElement,0,0,rn.canvas.width,rn.canvas.height);for(var Sn=rn.canvasContext.getImageData(0,0,rn.canvas.width,rn.canvas.height),wn=new Uint8ClampedArray(4*dn.width*dn.height),An=0;An<wn.length;An+=4)dn.data[An/4]!==0&&(wn[An+3]=255);var _n=new ImageData(wn,dn.width,dn.height);_n=rn.scaleImageData(_n,rn.lossRatio);for(var jn=0;jn<Sn.data.length;jn+=4)_n.data[jn+3]===0&&(Sn.data[jn+3]=0);rn.canvasContext.imageSmoothingEnabled=!0,rn.canvasContext.putImageData(Sn,0,0),rn.processBackground&&rn.noBackgroundWithFullResolution()})}},{key:"scaleImageData",value:function(rn,dn){var Sn=document.createElement("canvas");Sn.width=rn.width,Sn.height=rn.height,Sn.getContext("2d").putImageData(rn,0,0);var wn=document.createElement("canvas");wn.width=this.canvas.width,wn.height=this.canvas.height;var An=wn.getContext("2d");return An.scale(dn,dn),An.drawImage(Sn,0,0),An.getImageData(0,0,wn.width,wn.height)}},{key:"release",value:function(){this.processedMediaStream=this.mediaStream,this.processBackground=!1}}])&&Jn(Bt.prototype,Qt),Object.defineProperty(Bt,"prototype",{writable:!1}),hn}(ht);function Nn(Ot,Bt){for(var Qt=0;Qt<Bt.length;Qt++){var en=Bt[Qt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Ot,en.key,en)}}var Wn=et.Y.get("MediaFilterManager"),vn=apiCC.myWebRTC_Event,Rn={oldBackgroundSubtraction:qt,AIEFilter:tr,backgroundSubtraction:nr},Gt=function(){function Ot(en,Jt,an){(function(hn,rn){if(!(hn instanceof rn))throw new TypeError("Cannot call a class as a function")})(this,Ot),this.mediaStream=en,this.descriptors=Jt,this.userMediaStreamId=an,this.filters={}}var Bt,Qt;return Bt=Ot,(Qt=[{key:"getOrCreateFilter",value:function(en){if(this.filters[en.type]!==void 0)return this.filters[en.type];var Jt=Rn[en.type];if(Jt===void 0)return Wn.error("Unknown filter type: "+en.type),null;var an=new Jt;return this.filters[an]=an,an}},{key:"applyFilters",value:function(){var en=this;if(Wn.info("Apply filters",this.descriptors),!Array.isArray(this.descriptors)||this.descriptors.length===0)return Wn.error("No filter can be applied, filter descriptors have wrong format, it should be an array and contain at least one element",this.descriptors),Promise.reject(this.mediaStream);var Jt=Promise.resolve(this.mediaStream);return this.descriptors.forEach(function(an){var hn=en.getOrCreateFilter(an);hn!==null?(an.options!==void 0&&(an.options.userMediaStreamId=en.userMediaStreamId,an.options.clientId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId),Jt=Jt.then(function(rn){return hn.applyFilter(rn,an)})):Wn.error("Filter "+an.type+" will be skipped. No implemented filter has this type")}),Wn.info("Filters attached"),document.addEventListener("visibilitychange",function(){en.createBackgroundSubstractionStopVisibilityChangeEvent(en.userMediaStreamId)}),Jt.catch(function(an){return Wn.error(an)}),Jt}},{key:"createBackgroundSubstractionStopVisibilityChangeEvent",value:function(en){document.hidden&&vn.createBackgroundSubstractionStopVisibilityChangeEvent(en)}},{key:"release",value:function(){Object.values(this.filters).forEach(function(en){en.release()}),document.removeEventListener("visibilitychange",this.createBackgroundSubstractionStopVisibilityChangeEvent),this.filters=null,this.mediaStream=null}}])&&Nn(Bt.prototype,Qt),Object.defineProperty(Bt,"prototype",{writable:!1}),Ot}();function Tt(Ot){return Tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Bt){return typeof Bt}:function(Bt){return Bt&&typeof Symbol=="function"&&Bt.constructor===Symbol&&Bt!==Symbol.prototype?"symbol":typeof Bt},Tt(Ot)}function nt(Ot,Bt){var Qt=typeof Symbol<"u"&&Ot[Symbol.iterator]||Ot["@@iterator"];if(!Qt){if(Array.isArray(Ot)||(Qt=function(dn,Sn){if(dn){if(typeof dn=="string")return Ct(dn,Sn);var wn=Object.prototype.toString.call(dn).slice(8,-1);return wn==="Object"&&dn.constructor&&(wn=dn.constructor.name),wn==="Map"||wn==="Set"?Array.from(dn):wn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(wn)?Ct(dn,Sn):void 0}}(Ot))||Bt&&Ot&&typeof Ot.length=="number"){Qt&&(Ot=Qt);var en=0,Jt=function(){};return{s:Jt,n:function(){return en>=Ot.length?{done:!0}:{done:!1,value:Ot[en++]}},e:function(dn){throw dn},f:Jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var an,hn=!0,rn=!1;return{s:function(){Qt=Qt.call(Ot)},n:function(){var dn=Qt.next();return hn=dn.done,dn},e:function(dn){rn=!0,an=dn},f:function(){try{hn||Qt.return==null||Qt.return()}finally{if(rn)throw an}}}}function Ct(Ot,Bt){(Bt==null||Bt>Ot.length)&&(Bt=Ot.length);for(var Qt=0,en=new Array(Bt);Qt<Bt;Qt++)en[Qt]=Ot[Qt];return en}var yt=et.Y.get("ApiCCUserMediaStream"),Pt=apiCC.myWebRTC_Event,Et="getUserMediaAccessAllowed",Ut=function(){Number.MAX_SAFE_INTEGER!==void 0?this.userMediaStreamId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():this.userMediaStreamId=Math.floor(1000001*Math.random()).toString(),ot.Xh==="Edge"&&ot.PR>=15&&apiRTC.browserDetails.type!=="chrome"?this.gum_config={audio:!0,video:!0}:ot.Xh==="Chrome"&&ot.PR<49||ot.Xh==="Firefox"&&ot.PR<50?this.gum_config={audio:{mandatory:{},optional:[]},video:{mandatory:{},optional:[]}}:this.gum_config={audio:{},video:{}},this.inputs={},this.callbacks={},this.callType=null,this.audio=!1,this.audioDeviceLabel=null,this.audioMuted=!1,this.audioSilent=!1,this.video=!1,this.videoDeviceLabel=null,this.videoMuted=!1,this.videoSilent=!1,this.stream=null,this.streamStolen=!1,this.notifyUserMediaSuccess=!0,this.notifyUserMediaStop=!0,apiCC.session!==null&&apiCC.session!==void 0?this.tryAudioCallAfterUserMediaError=apiCC.session.tryAudioCallAfterUserMediaError:this.tryAudioCallAfterUserMediaError=!1,this.callInfoList=[],this.iOSMediaSelectionWorkAroundApplied=!1,this.getUserMediaTimeoutId=null,st.wL.type==="chrome"&&st.wL.version>=72&&st.wL.version<=73?this.displayMediaStreamConstraints={video:!0,audio:!1}:this.displayMediaStreamConstraints={video:!0,audio:!0},this.forceExtensionOnChrome=!1,this.filters=null,this.mediaFilterManager=null,this.videoSettings=!1,this.getVideoTrack=function(){if(!this.stream||typeof this.stream.getVideoTracks!="function")return null;var Ot=this.stream.getVideoTracks();return Ot&&Ot.length===1?Ot[0]:null},this.release=function(){var Ot=0,Bt=null,Qt=null,en=null;if(yt.debug("[ApiCCUserMediaStream] release; userMediaStreamId: "+this.userMediaStreamId),this.mediaFilterManager!==null&&(this.mediaFilterManager.release(),this.mediaFilterManager=null),apiCC.audioProcessor.stopAudioNodeCtx(this.nodeCtx),this.stream!==null){if(this.streamStolen!==!0)if(typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0)cordova!==void 0&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0&&(yt.debug("[ApiCCUserMediaStream] release on iosrtc cordova"),this.stream.onended=null);else if(ot.Xh==="Chrome"&&ot.PR<45||ot.Xh==="Firefox"&&ot.PR<44||ot.Xh==="Opera"&&ot.PR<34||ot.Xh==="Chromium"&&ot.PR<44||ot.Xh==="Chrome WebView"&&ot.PR<45)this.stream.onended=null,this.stream.stop();else for(this.stream.onended=null,Ot=(Bt=this.stream.getTracks()).length;--Ot>=0;)Bt[Ot].onended=null,Bt[Ot].stop();this.stream=null,this.streamStolen=!1,this.notifyUserMediaStop===!0&&((en=this.getOwnerCallInfo())!==null&&(Qt=en.callId),Pt.createUserMediaStopEvent(Qt,this.callType,this.userMediaStreamId)),this.callbacks.release(this)}},this.getUserMedia=function(){var Ot=this;if(yt.debug("[ApiCCUserMediaStream] getUserMedia; userMediaStreamId: "+this.userMediaStreamId),this.stream===null)try{if(this.callType==="media")this.gum_config=apiCC.setAudioSourceIdInConstraint(this.inputs.audioSourceId,this.gum_config),this.gum_config=apiCC.setVideoSourceIdInConstraint(this.inputs.videoSourceId,this.gum_config),this.gum_config=apiCC.setVideoFacingModeInConstraint(this.inputs.facingMode,this.gum_config);else if(this.callType==="audio")this.gum_config=apiCC.setAudioSourceIdInConstraint(this.inputs.audioSourceId,this.gum_config),this.gum_config.video=!1;else{if(this.callType!=="videoOnly")return function(Bt){for(var Qt=apiCC.userMediaStreamTable.length;--Qt>=0;)if(apiCC.userMediaStreamTable[Qt].userMediaStreamId===Bt){apiCC.userMediaStreamTable.splice(Qt,1);break}}(this.userMediaStreamId),void setTimeout(this.callbacks.failure.bind(this,this,"wrong type"));this.gum_config.audio=!1,this.gum_config=apiCC.setVideoSourceIdInConstraint(this.inputs.videoSourceId,this.gum_config),this.gum_config=apiCC.setVideoFacingModeInConstraint(this.inputs.facingMode,this.gum_config)}apiCC.checkConstraintDependingOnDevice(this.gum_config),ot.Xh==="IE"&&ot.dc>8?apiCC.getUserMediaWithCB(this.gum_config,this.callback(this,"onUserMediaSuccess"),this.callback(this,"onUserMediaError")):(ot.Xh==="Chrome"&&this.isUserMediaAccessAllowed()===!0&&(this.getUserMediaTimeoutId=setTimeout(function(){Ot.onUserMediaError("timeout")},1e4)),apiCC.getUserMedia(this.gum_config).then(this.callback(this,"onUserMediaSuccess")).catch(this.callback(this,"onUserMediaError")))}catch(Bt){yt.error("getUserMedia() failed. Is this a WebRTC capable browser?"),yt.log("getUserMedia failed with exception: "+Bt.message)}},this.listenForMuteEvents=function(){var Ot,Bt=this,Qt=function(hn){var rn=null,dn=null;hn.onmute=function(Sn){yt.debug("mute event :",hn),hn.kind==="audio"&&rn===null?rn=setTimeout(function(){Bt.audioSilent=!0,rn=null,Bt.notifyMLineMuted(hn.kind,!0,"muted")},2520):hn.kind==="video"&&dn===null&&(dn=setTimeout(function(){Bt.videoSilent=!0,dn=null,Bt.notifyMLineMuted(hn.kind,!0,"muted")},2520))},hn.onunmute=function(Sn){yt.debug(hn.kind+" unmute event"),hn.kind==="audio"&&rn!==null?(clearTimeout(rn),rn=null):hn.kind==="video"&&dn!==null?(clearTimeout(dn),dn=null):(hn.kind==="audio"?Bt.audioSilent=!1:hn.kind==="video"&&(Bt.videoSilent=!1),Bt.notifyMLineMuted(hn.kind,!1,"muted"))},hn.onended=function(Sn){yt.debug(hn.kind+" ended event"),hn.kind==="audio"&&rn!==null?(clearTimeout(rn),rn=null):hn.kind==="video"&&(dn!==null&&(clearTimeout(dn),dn=null),Bt.callType!=="screenSharing"&&Bt.callType!=="screenSharingWithAudio"||Bt.stopScreenSharing())}},en=nt(this.stream.getVideoTracks());try{for(en.s();!(Ot=en.n()).done;)Qt(Ot.value)}catch(hn){en.e(hn)}finally{en.f()}var Jt,an=nt(this.stream.getAudioTracks());try{for(an.s();!(Jt=an.n()).done;)Qt(Jt.value)}catch(hn){an.e(hn)}finally{an.f()}this.callType!=="screenSharing"&&this.callType!=="screenSharingWithAudio"||(this.stream.onended=this.callback(this,"stopScreenSharing"))},this.onUserMediaSuccess=function(Ot){var Bt=this;this.applyFiltersIfNeeded(Ot).then(function(Qt){var en=null,Jt=null,an=!1,hn=Bt.getOwnerCallInfo(),rn=Bt.getCall(hn);yt.info("[ApiCCUserMediaStream] onUserMediaSuccess; userMediaStreamId: "+Bt.userMediaStreamId),Bt.getUserMediaTimeoutId!==null&&(clearTimeout(Bt.getUserMediaTimeoutId),Bt.getUserMediaTimeoutId=null),rn&&(yt.debug("call exist"),Jt=rn.callee?rn.callerId:rn.calleeId,an=rn.restarted),Bt.updateMediaProperties(Qt),Bt.stream=Qt,ot.Xh==="Chrome"&&Bt.setUserMediaAccessAllowed(!0),Bt.notifyUserMediaSuccess===!0&&(hn&&(en=hn.callId),Pt.createUserMediaSuccessEvent(en!==null,Bt.audio,Bt.audioDeviceLabel,Bt.video,Bt.videoDeviceLabel,Bt.callType,en,Qt,Jt,an,Bt.userMediaStreamId)),Bt.listenForMuteEvents(),yt.debug("Starting a new getMediaDevices after userMediaSuccess"),apiCC.mediaDeviceMgr.getMediaDevices("updatedAfterGetUserMediaSuccess"),Bt.callbacks.success(Bt)})},this.updateMediaProperties=function(Ot){var Bt=!1,Qt="Unknown",en="Unknown",Jt=!1,an="Unknown";Ot.getAudioTracks().length>0&&(Bt=!0,Ot.getAudioTracks()[0].label&&(Qt=Ot.getAudioTracks()[0].label,en=Ot.getAudioTracks()[0].id,apiCC.audioProcessor.listenToAudio(Ot,this)),Ot.getAudioTracks()[0].enabled===!1&&(this.audioMuted=!0),Ot.getAudioTracks()[0].muted===!1&&(this.audioSilent=!0)),Ot.getVideoTracks().length>0&&(Jt=!0,Ot.getVideoTracks()[0].label&&(an=Ot.getVideoTracks()[0].label),Ot.getVideoTracks()[0].enabled===!1&&(this.videoMuted=!0),Ot.getVideoTracks()[0].muted===!1&&(this.videoSilent=!0)),this.audio=Bt,this.audioDeviceLabel=Qt,this.audioDeviceId=en,this.video=Jt,this.videoDeviceLabel=an},this.manageFailure=function(Ot){var Bt={};Tt(Ot)==="object"?(Bt.message=Ot.message,Bt.code=Ot.code,Bt.name=Ot.name):Bt=Ot,this.callbacks.failure(this,Bt)},this.onUserMediaError=function(Ot){var Bt=function(an){for(var hn=apiCC.userMediaStreamTable.length;--hn>=0;)if(apiCC.userMediaStreamTable[hn].userMediaStreamId===an){apiCC.userMediaStreamTable.splice(hn,1);break}},Qt=null,en=this.getOwnerCallInfo();if(yt.info("[ApiCCUserMediaStream] onUserMediaError; userMediaStreamId: "+this.userMediaStreamId+", error: "+Ot),this.getUserMediaTimeoutId!==null&&(Ot!=="timeout"&&clearTimeout(this.getUserMediaTimeoutId),this.getUserMediaTimeoutId=null),ot.$6!=="electron"&&ot.Xh==="Chrome"&&ot.PR>47&&window.location.protocol!=="https:"&&yt.error("HTTPS is now mandatory to use getUserMedia()"),en!==null&&(Qt=en.callId),this.callType==="media"&&ot.ag.name==="iOS"&&ot.Xh==="Mobile Safari"&&this.iOSMediaSelectionWorkAroundApplied===!1||Pt.createUserMediaErrorEvent(Qt!==null,this.callType,Ot,this.userMediaStreamId,Qt,this.tryAudioCallAfterUserMediaError,this.gum_config),Ot!=="timeout"&&this.callType==="media")if(ot.ag.name==="iOS"&&ot.Xh==="Mobile Safari"&&this.iOSMediaSelectionWorkAroundApplied===!1){yt.warn("try mediaDevice selection workaround on iOS / Mobile Safari - after MediaError"),this.iOSMediaSelectionWorkAroundApplied=!0,this.gum_config.video={};var Jt=apiCC.getMediaDeviceLabelFromDeviceid(this.inputs.videoSourceId);yt.log("getMediaDeviceLabelFromDeviceid :",Jt),Jt==="Caméra arrière"||Jt==="Back Camera"?(yt.log("Setting FacingMode to environment :",Jt),this.gum_config=apiCC.setVideoFacingModeInConstraint("environment",this.gum_config)):(yt.log("Setting FacingMode to user :",Jt),this.gum_config=apiCC.setVideoFacingModeInConstraint("user",this.gum_config)),this.inputs.videoSourceId=null,this.getUserMedia()}else this.tryAudioCallAfterUserMediaError===!0?(yt.warn("try AudioCall after UserMediaError is activated"),this.tryAudioCallAfterUserMediaError=!1,this.gum_config.video!==!1?(yt.debug("[ApiCCUserMediaStream] Trying to getUserMedia with audioOnly"),this.inputs.videoSourceId=null,this.gum_config.video=!1,this.getUserMedia()):(Bt(this.userMediaStreamId),this.manageFailure(Ot))):(Bt(this.userMediaStreamId),this.manageFailure(Ot));else Bt(this.userMediaStreamId),this.manageFailure(Ot)},this.getDisplayMediaProcess=function(){var Ot=this;yt.debug("using getDisplayMedia with browser :",ot.Xh),yt.debug("displayMediaStreamConstraints :",this.displayMediaStreamConstraints),Tt(this.displayMediaStreamConstraints)==="object"&&Array.isArray(this.displayMediaStreamConstraints)!==!0||(yt.warn("Defined displayMediaStreamConstraints format is not correct, reinitialization ..."),st.wL.type==="chrome"&&st.wL.version>=72&&st.wL.version<=73?this.displayMediaStreamConstraints={video:!0,audio:!1}:this.displayMediaStreamConstraints={video:!0,audio:!0},yt.debug("displayMediaStreamConstraints :",this.displayMediaStreamConstraints)),navigator.getDisplayMedia?(yt.debug("navigator.getDisplayMedia defined"),navigator.getDisplayMedia(this.displayMediaStreamConstraints).then(function(Bt){yt.debug("getDisplayMedia stream available"),Ot.onUserMediaSuccess(Bt)}).catch(function(Bt){yt.debug("getDisplayMedia error :",Bt),Ot.onUserMediaError(Bt)})):navigator.mediaDevices.getDisplayMedia?(yt.debug("navigator.mediaDevices.getDisplayMedia defined"),navigator.mediaDevices.getDisplayMedia(this.displayMediaStreamConstraints).then(function(Bt){yt.debug("getDisplayMedia stream available"),Ot.onUserMediaSuccess(Bt)}).catch(function(Bt){yt.debug("getDisplayMedia error :",Bt),Ot.onUserMediaError(Bt)})):(yt.debug("getDisplayMedia not available"),Pt.createDesktopCaptureEvent("Browser_Not_Compatible"))},this.getScreenMedia=function(){if(yt.debug("[ApiCCUserMediaStream] getScreenMedia; userMediaStreamId: "+this.userMediaStreamId),this.stream===null)if(ot.Xh==="Chrome"||ot.Xh==="Firefox"&&ot.PR>=52)if(ot.Xh==="Chrome")if(yt.log("shareScreen on Chrome"),ot.PR>=72&&this.forceExtensionOnChrome===!1)this.getDisplayMediaProcess();else{if(yt.debug("this.captureSourceType :",this.captureSourceType),apiCC.apiRTCExtensionInstalled===!1)return apiCC.waitingShareScreenUserMediaStreamId=this.userMediaStreamId,function(Ot){yt.debug("[ApiCCUserMediaStream] moveUserMediaEntryInWaitingScreen: "+Ot);for(var Bt=apiCC.userMediaStreamTable.length;--Bt>=0;)if(apiCC.userMediaStreamTable[Bt].userMediaStreamId===Ot){apiCC.waitingShareScreenUserMediaStream=apiCC.userMediaStreamTable.splice(Bt,1);break}}(this.userMediaStreamId),void apiCC.manageNotInstalledExtension("getScreenMedia","getScreenMedia",this.captureSourceType);this.captureSourceType!==void 0&&this.captureSourceType!==null||(this.captureSourceType=["screen","window","tab"]),Array.isArray(this.captureSourceType)===!1&&(yt.warn("Defined captureSourceType format is not correct, reinitialization ..."),this.captureSourceType=["screen","window","tab"],yt.debug("this.captureSourceType :",this.captureSourceType)),window.postMessage({command:"getDesktopId",callNumber:this.userMediaStreamId,remoteId:"getScreenMedia",captureSourceType:this.captureSourceType,browser_major_version:ot.PR},"*")}else yt.log("shareScreen on Firefox"),ot.PR>=67?this.getDisplayMediaProcess():(this.captureSourceType!==void 0&&this.captureSourceType!==null||(this.captureSourceType="screen"),typeof this.captureSourceType=="string"&&(yt.warn("Defined captureSourceType format is not correct, reinitialization ..."),this.captureSourceType="screen",yt.debug("this.captureSourceType :",this.captureSourceType)),this.registerScreenMedia(this.captureSourceType));else this.getDisplayMediaProcess()},this.registerScreenMedia=function(Ot,Bt){var Qt=null,en=this.getOwnerCallInfo(),Jt=this.getCall(en),an=null;if(yt.debug("[ApiCCUserMediaStream] registerScreenMedia; userMediaStreamId: "+this.userMediaStreamId),Bt==="mediaError")Jt!==null?(an=Jt.callee===!0?Jt.callerId:Jt.calleeId,Jt.callType==="screenSharing"||Jt.callType==="screenSharingWithAudio"?apiCC.session.apiCCWebRTCClient.webRTCClient.removeCallFromTableWithCallIdandRemoteId(Jt.callId,an,"Media_Error"):yt.log("switch video / screen : call is not removed"),window.location.protocol!=="https:"&&yt.log("Please connect to your web page using 'HTTPS'. This is mandatory for desktop capture"),Pt.createDesktopCaptureEvent("UserMediaError",Jt.callId,an)):(yt.log("Call not found on message EventListener"),Pt.createDesktopCaptureEvent("UserMediaError")),function(hn){for(var rn=apiCC.userMediaStreamTable.length;--rn>=0;)if(apiCC.userMediaStreamTable[rn].userMediaStreamId===hn){apiCC.userMediaStreamTable.splice(rn,1);break}}(this.userMediaStreamId),this.callbacks.failure(this,"UserMediaError");else try{if(ot.Xh==="Chrome")yt.log("desktopId: "+Bt),Qt={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:Bt}}};else{if(yt.log("captureSourceType: "+Ot),Ot!=="screen"&&Ot!=="window"&&Ot!=="application")return void yt.error("captureSourceType value is not correct");Qt={video:{mediaSource:Ot}}}ot.Xh==="IE"&&ot.dc>8?apiCC.getUserMediaWithCB(Qt,this.callback(this,"onUserMediaSuccess"),this.callback(this,"onUserMediaError")):apiCC.getUserMedia(Qt).then(this.callback(this,"onUserMediaSuccess")).catch(this.callback(this,"onUserMediaError"))}catch(hn){yt.error("getUserMedia() failed. Is this a WebRTC capable browser?"),yt.log("getUserMedia failed with exception: "+hn.message)}},this.stopScreenSharing=function(){yt.debug("[ApiCCUserMediaStream] stopScreenSharing; userMediaStreamId: "+this.userMediaStreamId);var Ot=!0;if(apiRTC.session.remoteAccessInvitation!==null&&this.userMediaStreamId===apiRTC.session.remoteAccessInvitation.screenSharingStreamId&&(yt.debug("this is a remote access screenSharing, need to stop remote access"),apiRTC.session.remoteAccessInvitation.stop(!0,{code:"SCREEN_SHARING_STOP"})),apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var Bt=this.callInfoList.length;--Bt>=0;)this.callInfoList[Bt].owner===!0&&(Ot=!1),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(this.callInfoList[Bt].callId);Ot===!0&&this.release()},this.getCall=function(Ot){var Bt=null;return Ot&&apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient&&(Ot.flavor==="call"?Bt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Ot.callId):Ot.flavor==="userMedia"&&(Bt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Ot.callId))),Bt},this.getOwnerCallInfo=function(){for(var Ot=this.callInfoList.length;--Ot>=0;)if(this.callInfoList[Ot].owner===!0)return this.callInfoList[Ot];return null},this.getCallInfo=function(Ot){for(var Bt=this.callInfoList.length;--Bt>=0;)if(this.callInfoList[Bt].callId===Ot)return this.callInfoList[Bt];return null},this.containsCallInfo=function(Ot){for(var Bt=!1,Qt=this.callInfoList.length;--Qt>=0;)if(this.callInfoList[Qt].callId===Ot){Bt=!0;break}return Bt},this.addCallInfo=function(Ot,Bt,Qt){return Ot!==null&&typeof Ot=="string"&&(Bt!=="call"&&Bt!=="userMedia"&&(Bt="call"),Qt!==null&&typeof Qt=="boolean"||(Qt=!1),!this.containsCallInfo(Ot))&&(this.callInfoList.push({callId:Ot,flavor:Bt,owner:Qt}),!0)},this.removeCallInfo=function(Ot){for(var Bt=!1,Qt=this.callInfoList.length;--Qt>=0;)if(this.callInfoList[Qt].callId===Ot){this.callInfoList.splice(Qt,1),Bt=!0;break}return Bt},this.accessToLocalMedia=function(){return this.callType!=="screenSharing"&&this.callType!=="screenSharingWithAudio"&&this.callType!=="data"&&this.stream!==null},this.muteAudioOnStreams=function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return yt.debug("[ApiCCUserMediaStream] muteAudioOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getAudioTracks().forEach(function(Bt){Bt.enabled=!1}),Ot==="enabled"?this.audioMuted=!0:Ot==="muted"&&(this.audioSilent=!0),this.notifyMLineMuted("audio",!0,Ot),{type:"audio",muted:!0}},this.unMuteAudioOnStreams=function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return yt.debug("[ApiCCUserMediaStream] unMuteAudioOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getAudioTracks().forEach(function(Bt){Bt.enabled=!0}),Ot==="enabled"?this.audioMuted=!1:Ot==="muted"&&(this.audioSilent=!1),this.notifyMLineMuted("audio",!1,Ot),{type:"audio",muted:!1}},this.muteVideoOnStreams=function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return yt.debug("[ApiCCUserMediaStream] muteVideoOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getVideoTracks().forEach(function(Bt){Bt.enabled=!1}),Ot==="enabled"?this.videoMuted=!0:Ot==="muted"&&(this.videoSilent=!0),this.notifyMLineMuted("video",!0,Ot),{type:"video",muted:!0}},this.unMuteVideoOnStreams=function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return yt.debug("[ApiCCUserMediaStream] unMuteVideoOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getVideoTracks().forEach(function(Bt){Bt.enabled=!0}),Ot==="enabled"?this.videoMuted=!1:Ot==="muted"&&(this.videoSilent=!1),this.notifyMLineMuted("video",!1,Ot),{type:"video",muted:!1}},this.removeVideoTrackOnStreams=function(){var Ot;return yt.debug("[ApiCCUserMediaStream] removeVideoTrackOnStreams; userMediaStreamId: "+this.userMediaStreamId),(Ot=this.stream.getVideoTracks()).length>0&&this.stream.removeTrack(Ot[0]),this.video=!1,{type:"video",present:!1}},this.notifyMLineMuted=function(Ot,Bt,Qt){var en,Jt,an=!0;if(apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var hn=this.callInfoList.length;--hn>=0;)this.callInfoList[hn].flavor==="call"?(en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callInfoList[hn].callId),this.notifyMLineMutedCall(Ot,Bt,Qt,en,null)):this.callInfoList[hn].flavor==="userMedia"&&(Jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(this.callInfoList[hn].callId),this.notifyMLineMutedCall(Ot,Bt,Qt,null,Jt)),this.callInfoList[hn].owner===!0&&(an=!1);an===!0&&this.notifyMLineMutedCall(Ot,Bt,Qt,null,null)},this.notifyMLineMutedCall=function(Ot,Bt,Qt,en,Jt){yt.debug("notifyMLineMutedCall; mline: "+Ot+", muted: "+Bt);var an=[];Qt==="enabled"?an=[Ot+"IsMuted"]:Qt==="muted"&&(an=[Ot+"IsSilent"]);var hn={available:this.audio,deviceLabel:this.audioDeviceLabel,active:!0,muted:this.audioMuted,silent:this.audioSilent},rn={available:this.video,deviceLabel:this.videoDeviceLabel,active:!0,muted:this.videoMuted,silent:this.videoSilent},dn=null;en?(Ot==="audio"?en.isLocalAudioMuted=Bt:Ot==="video"&&(en.isLocalVideoMuted=Bt),en.belongsToRoom()?(dn={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:en.callId,roomId:en.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,mline:Ot},en.data.mesh&&(dn.mesh=en.data.mesh),Qt==="muted"?(dn.change="silent",dn.silent=Bt,en.myWebRTC_Stack.sendInfo("streamTrackStatusChanged",dn)):Qt==="enabled"&&(dn.muted=Bt,en.myWebRTC_Stack.sendInfo("streamTrackChanged",dn))):(dn={callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,calleeId:en.callee?en.callerId:en.calleeId,callId:en.callId,mline:Ot},Qt==="muted"?(dn.type="streamTrackStatusChanged",dn.change="silent",dn.silent=Bt):Qt==="enabled"&&(dn.type="streamTrackChanged",dn.muted=Bt),en.myWebRTC_Stack.sendDataMessage(apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,dn)),hn.active=en.localCallProfile.audioActive,rn.active=en.localCallProfile.videoActive,Pt.createLocalStreamUpdatedEvent(an,hn,rn,!0,en.callType,en.callId,this.stream,this.userMediaStreamId,"userAction")):Jt?(dn={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Jt.userMediaId,roomId:Jt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,mline:Ot},Qt==="muted"?(dn.change="silent",dn.silent=Bt,Jt.myWebRTC_Stack.sendInfo("streamTrackStatusChanged",dn)):Qt==="enabled"&&(dn.muted=Bt,Jt.myWebRTC_Stack.sendInfo("streamTrackChanged",dn)),Jt.audioSdpDirection==="inactive"&&(hn.active=!1),Jt.videoSdpDirection==="inactive"&&(rn.active=!1),Pt.createLocalStreamUpdatedEvent(an,hn,rn,!0,Jt.callType,Jt.userMediaId,this.stream,this.userMediaStreamId,"userAction")):Pt.createLocalStreamUpdatedEvent(an,hn,rn,!1,null,null,this.stream,this.userMediaStreamId,"userAction")},this.notifyActiveSpeaker=function(Ot){var Bt,Qt,en=!0;if(apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var Jt=this.callInfoList.length;--Jt>=0;)this.callInfoList[Jt].flavor==="call"?(Bt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callInfoList[Jt].callId),this.notifyActiveSpeakerCall(Ot,Bt,null)):this.callInfoList[Jt].flavor==="userMedia"&&(Qt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(this.callInfoList[Jt].callId),this.notifyActiveSpeakerCall(Ot,null,Qt)),this.callInfoList[Jt].owner===!0&&(en=!1);en===!0&&this.notifyActiveSpeakerCall(Ot,null,null)},this.notifyActiveSpeakerCall=function(Ot,Bt,Qt){var en=null;Bt?(Bt.belongsToRoom()?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Bt.callId,roomId:Bt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Ot,streamID:this.userMediaStreamId}},Bt.data.mesh&&(en.mesh=Bt.data.mesh),Bt.myWebRTC_Stack.sendInfo("activeSpeaker",en)):(en={type:"activeSpeaker",callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,calleeId:Bt.callee?Bt.callerId:Bt.calleeId,callId:Bt.callId,descriptor:{audioAmplitude:Ot,streamID:this.userMediaStreamId}},Bt.myWebRTC_Stack.sendDataMessage(apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,en)),Pt.createAudioAmplitudeEvent(Ot,!0,Bt.callId,this.userMediaStreamId)):Qt?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Qt.userMediaId,roomId:Qt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Ot,streamID:this.userMediaStreamId}},Qt.myWebRTC_Stack.sendInfo("activeSpeaker",en),Pt.createAudioAmplitudeEvent(Ot,!0,Qt.userMediaId,this.userMediaStreamId)):Pt.createAudioAmplitudeEvent(Ot,!0,null,this.userMediaStreamId)},this.notifyNotActiveSpeaker=function(Ot){var Bt,Qt,en=!0;if(apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var Jt=this.callInfoList.length;--Jt>=0;)this.callInfoList[Jt].flavor==="call"?(Bt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callInfoList[Jt].callId),this.notifyNotActiveSpeakerCall(Ot,Bt,null)):this.callInfoList[Jt].flavor==="userMedia"&&(Qt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(this.callInfoList[Jt].callId),this.notifyNotActiveSpeakerCall(Ot,null,Qt)),this.callInfoList[Jt].owner===!0&&(en=!1);en===!0&&this.notifyNotActiveSpeakerCall(Ot,null,null)},this.notifyNotActiveSpeakerCall=function(Ot,Bt,Qt){var en=null;Bt?(Bt.belongsToRoom()?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Bt.callId,roomId:Bt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Ot,streamID:this.userMediaStreamId}},Bt.data.mesh&&(en.mesh=Bt.data.mesh),Bt.myWebRTC_Stack.sendInfo("stopSpeaking",en)):(en={type:"stopSpeaking",callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,calleeId:Bt.callee?Bt.callerId:Bt.calleeId,callId:Bt.callId,descriptor:{audioAmplitude:Ot,streamID:this.userMediaStreamId}},Bt.myWebRTC_Stack.sendDataMessage(apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,en)),Pt.createAudioAmplitudeEvent(Ot,!1,Bt.callId,this.userMediaStreamId)):Qt?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Qt.userMediaId,roomId:Qt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Ot,streamID:this.userMediaStreamId}},Qt.myWebRTC_Stack.sendInfo("stopSpeaking",en),Pt.createAudioAmplitudeEvent(Ot,!1,Qt.userMediaId,this.userMediaStreamId)):Pt.createAudioAmplitudeEvent(Ot,!1,null,this.userMediaStreamId)},this.callback=function(Ot,Bt){return this.closureHandler=function(Qt,en){return Ot[Bt](Qt,en)},this.closureHandler},this.isUserMediaAccessAllowed=function(){return localStorage!==null&&(typeof localStorage>"u"?"undefined":Tt(localStorage))==="object"&&typeof localStorage.getItem=="function"?localStorage.getItem(Et)==="true":null},this.setUserMediaAccessAllowed=function(Ot){return localStorage!==null&&(typeof localStorage>"u"?"undefined":Tt(localStorage))==="object"&&typeof localStorage.setItem=="function"?(localStorage.setItem(Et,Ot?"true":"false"),!!Ot):null},this.applyFiltersIfNeeded=function(Ot){return this.filters===null?Promise.resolve(Ot):(this.mediaFilterManager=new Gt(Ot,this.filters,this.userMediaStreamId),this.mediaFilterManager.applyFilters())},this.getVideoSettings=function(){if(this.videoSettings!==!1)return this.videoSettings;var Ot=this.getVideoTrack();if(!Ot||typeof Ot.getSettings!="function")return this.videoSettings=null,this.videoSettings;var Bt=Ot.getSettings();return Bt?(this.videoSettings={},Object.prototype.hasOwnProperty.call(Bt,"width")&&(this.videoSettings.width=Bt.width),Object.prototype.hasOwnProperty.call(Bt,"height")&&(this.videoSettings.height=Bt.height),Object.prototype.hasOwnProperty.call(Bt,"frameRate")&&(this.videoSettings.frameRate=Bt.frameRate),this.videoSettings):(this.videoSettings=null,this.videoSettings)},this.isSimulcastCompliant=function(){return!!this.getVideoSettings()},this.getSimulcastProfile=function(){var Ot=this.getVideoSettings();if(!Ot)return null;var Bt={substream:{high:{active:!0,selectable:!0},medium:{active:!0,selectable:!0},low:{active:!0,selectable:!0}},temporal:{high:{active:!0,selectable:!0},medium:{active:!0,selectable:!0},low:{active:!0,selectable:!0}}};return st.wL.type==="chrome"&&((Ot.width<1280||Ot.height<720)&&(Bt.substream.low.selectable=!1),Bt.temporal.high.active=!1,Bt.temporal.high.selectable=!1),Bt}}},1192:(it,ut,s)=>{s.d(ut,{D:()=>Rn}),s(3710),s(1539),s(9714),s(2772),s(8674);var et=s(1549),ot=(s(4916),s(5306),s(2564),s(4812),s(561),s(5735),s(3753),s(4603),s(6755),s(9554),s(4747),s(6992),s(8783),s(3948),s(9601),s(8309),s(8264),s(9575),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(7042),s(7941),s(2526),s(1817),s(2165),s(5945)),st=s(4708),Rt=s(940);function ht(Gt){return ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Tt){return typeof Tt}:function(Tt){return Tt&&typeof Symbol=="function"&&Tt.constructor===Symbol&&Tt!==Symbol.prototype?"symbol":typeof Tt},ht(Gt)}function bt(){this.sdp={original:null,global:[],mlines:[]},this.mlines=[]}function ct(Gt){var Tt=new bt,nt=Gt.split(`\r
`),Ct=0,yt=null,Pt=null,Et=null,Ut=null;for(Tt.sdp.original=Gt;Ct<nt.length;)if((yt=nt[Ct]).length!==0)if(Et!==null)if(yt.match(/^m=/))Pt=null,Et=null;else if(yt.match(/^a=/)){if(Pt.push(yt),!(Ut=yt.match(/^a=([\w-]+):(\d+) (.+)$/))||Ut[1]!=="rtpmap"&&Ut[1]!=="rtcp-fb"&&Ut[1]!=="fmtp"){if(Ut=yt.match(/^a=mid:(\w+)$/))Et.mid=Ut[1];else if(yt==="a=sendrecv")Et.direction="sendrecv";else if(yt==="a=recvonly")Et.direction="recvonly";else if(yt==="a=sendonly")Et.direction="sendonly";else if(yt==="a=inactive")Et.direction="inactive";else if(Ut=yt.match(/^a=ssrc-group:SIM (.+)$/)){var Ot=Ut[1].split(" ");Et.ssrc_groups.sim.push(Ot.slice())}else if(Ut=yt.match(/^a=ssrc-group:FID (.+)$/)){var Bt=Ut[1].split(" ");Et.ssrc_groups.fid.push(Bt.slice())}else if(Ut=yt.match(/^a=ssrc:(\d+) (.+)$/)){var Qt=Et.ssrcs.find(function(Sn){return Sn.original===Ut[1]});Qt||(Qt={original:Ut[1],ssrc:Ut[1],content:{}},Et.ssrcs.push(Qt));var en=Ut[2].match(/^(\w+):(.+)$/);if(!en)throw new Error("cannot parse ssrc parameters (regex failure): "+Ut[2]);if(en[1]==="cname")Qt.content.cname=en[2];else if(en[1]==="msid")Qt.content.msid=en[2];else if(en[1]==="mslabel")Qt.content.mslabel=en[2];else{if(en[1]!=="label")throw new Error("cannot parse ssrc parameters (wrong attribute): "+en[1]);Qt.content.label=en[2]}}}else if(Ut[1]==="rtpmap")Et.codecs[Ut[2]].codec=Ut[3].split("/")[0].toLowerCase(),Et.codecs[Ut[2]].rtpmap=Ut[3];else if(Ut[1]==="rtcp-fb")Et.codecs[Ut[2]]["rtcp-fb"]||(Et.codecs[Ut[2]]["rtcp-fb"]=[]),Et.codecs[Ut[2]]["rtcp-fb"].push(Ut[3]);else if(Ut[1]==="fmtp"){Et.codecs[Ut[2]].fmtp=[];for(var Jt=Ut[3].split(";"),an=0;an<Jt.length;an+=1){var hn=Jt[an].split("=");hn.length===2&&Et.codecs[Ut[2]].fmtp.push(hn)}}Ct+=1}else if(yt.match(/^b=/)){if(Pt.push(yt),Ut=yt.match(/^b=AS:(\d+)$/)){Et.bandwidth=parseInt(Ut[1],10),Ct+=1;continue}Ct+=1}else Pt.push(yt),Ct+=1;else{if(Ut=yt.match(/^m=([a-z]+) (\d+) ([A-Z/]+) ([0-9 ]+)$/)){Pt=[],Tt.sdp.mlines.push(Pt),Pt.push(yt),Et={type:Ut[1],port:parseInt(Ut[2],10),proto:Ut[3],payload_types:[],direction:"sendrecv",mid:Ut[1],bandwidth:0,codecs:{},ssrc_groups:{sim:[],fid:[]},ssrcs:[]};for(var rn=Ut[4].split(" "),dn=0;dn<rn.length;dn+=1)Et.payload_types.push(rn[dn]),Et.codecs[rn[dn]]={};Tt.mlines.push(Et),Ct+=1;continue}Tt.sdp.global.push(yt),Ct+=1}else Ct+=1;for(Tt.unifiedPlan=!0,Ct=Tt.mlines.length;--Ct>=0;)Tt.mlines[Ct].type!=="audio"||Tt.audio?Tt.mlines[Ct].type!=="video"||Tt.video||(Tt.video=Tt.mlines[Ct]):Tt.audio=Tt.mlines[Ct],Tt.unifiedPlan===!0&&Tt.mlines[Ct].mid!==String(Ct)&&(Tt.unifiedPlan=!1);return Tt.isAudioActive=mt.bind(null,Tt,"audio"),Tt.isVideoActive=mt.bind(null,Tt,"video"),Tt}function mt(Gt,Tt){return!(Tt!=="audio"&&Tt!=="video"||Gt===null||ht(Gt)!=="object"||!Object.prototype.hasOwnProperty.call(Gt,Tt)||Gt[Tt]===null||ht(Gt[Tt])!=="object"||Gt[Tt].direction!=="sendrecv"&&Gt[Tt].direction!=="sendonly"&&Gt[Tt].direction!=="recvonly")}s(3123),s(4765),s(4723),s(9600),s(1058),s(9826),bt.prototype.mungeForSimulcasting=function(){if(this.simulcasting!==!0){this.simulcasting=!0;for(var Gt=0;Gt<this.mlines.length;Gt+=1){var Tt=this.mlines[Gt];if(Tt.type==="video"){var nt=Tt.ssrcs[0].content.cname,Ct=Tt.ssrcs[0].content.msid,yt=Tt.ssrcs[0].content.mslabel,Pt=Tt.ssrcs[0].content.label,Et=[];Et.push(Tt.ssrcs[0].ssrc);for(var Ut=2;--Ut>=0;){var Ot=Math.floor(4294967295*Math.random());Tt.ssrcs.push({original:Ot,ssrc:Ot,content:{cname:nt,msid:Ct,mslabel:yt,label:Pt}});var Bt=Math.floor(4294967295*Math.random());Tt.ssrcs.push({original:Bt,ssrc:Bt,content:{cname:nt,msid:Ct,mslabel:yt,label:Pt}}),Tt.ssrc_groups.fid.push([Ot,Bt]),Et.push(Ot)}Tt.ssrc_groups.sim.push(Et)}}}},bt.prototype.generate=function(){for(var Gt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Tt=[],nt=0;nt<this.sdp.global.length;nt+=1){var Ct=this.sdp.global[nt],yt=Ct.match(/^a=group:BUNDLE([\w ]+)$/);if(yt){Tt.push("a=group:BUNDLE");for(var Pt=0;Pt<this.mlines.length;Pt+=1)this.mlines[Pt].direction==="inactive"&&Gt.stripInactiveMLines===!0||(Tt.push(" "),Tt.push(this.mlines[Pt].mid));Tt.push(`\r
`)}else Tt.push(Ct),Tt.push(`\r
`)}for(var Et=0;Et<this.sdp.mlines.length;Et+=1){var Ut=this.mlines[Et];if(Ut.direction!=="inactive"||Gt.stripInactiveMLines!==!0)for(var Ot=!1,Bt=this.sdp.mlines[Et],Qt=0;Qt<Bt.length;Qt+=1){var en=Bt[Qt];if(en.match(/^m=/))Tt.push("m="),Tt.push(Ut.type),Tt.push(" "),Tt.push(Ut.port),Tt.push(" "),Tt.push(Ut.proto),Tt.push(" "),Tt.push(Ut.payload_types.join(" ")),Tt.push(`\r
`);else if(en.match(/^a=/)){var Jt=en.match(/^a=([\w-]+):(\d+) (.+)$/);if(Jt&&(Jt[1]==="rtpmap"||Jt[1]==="rtcp-fb"||Jt[1]==="fmtp")){if(Jt[1]==="rtpmap"){var an=Jt[2];if(Ut.codecs[an]){Tt.push("a=rtpmap:"),Tt.push(an),Tt.push(" "),Tt.push(Ut.codecs[an].rtpmap),Tt.push(`\r
`);var hn=Ut.codecs[an]["rtcp-fb"];if(hn)for(var rn=0;rn<hn.length;rn+=1)Tt.push("a=rtcp-fb:"),Tt.push(an),Tt.push(" "),Tt.push(hn[rn]),Tt.push(`\r
`);var dn=Ut.codecs[an].fmtp;if(dn){for(var Sn=[],wn=0;wn<dn.length;wn+=1)Sn.push(dn[wn].join("="));Sn.length>0&&(Tt.push("a=fmtp:"),Tt.push(an),Tt.push(" "),Tt.push(Sn.join(";")),Tt.push(`\r
`))}continue}continue}if(Jt[1]==="rtcp-fb"||Jt[1]==="fmtp")continue;throw new Error("internal error")}if(en.match(/^a=mid:(\w+)$/))Tt.push("a=mid:"),Tt.push(Ut.mid),Tt.push(`\r
`),Ut.bandwidth>0&&(Tt.push("b=AS:"),Tt.push(Ut.bandwidth),Tt.push(`\r
`),Tt.push("b=TIAS:"),Tt.push(Ut.bandwidth),Tt.push("000"),Tt.push(`\r
`));else if(en!=="a=sendrecv"&&en!=="a=recvonly"&&en!=="a=sendonly"&&en!=="a=inactive"){if(!en.match(/^a=ssrc-group:SIM (.+)$/)){if(!en.match(/^a=ssrc-group:FID (.+)$/)){if(en.match(/^a=ssrc:(\d+) (.+)$/)){if(Ot)continue;Ot=!0;for(var An=0;An<Ut.ssrc_groups.sim.length;An+=1)Tt.push("a=ssrc-group:SIM "),Tt.push(Ut.ssrc_groups.sim[An].join(" ")),Tt.push(`\r
`);for(var _n=0;_n<Ut.ssrc_groups.fid.length;_n+=1)Tt.push("a=ssrc-group:FID "),Tt.push(Ut.ssrc_groups.fid[_n].join(" ")),Tt.push(`\r
`);for(var jn=function(fr){var Cr=Ut.ssrcs[fr];["cname","msid","mslabel","label"].forEach(function(gr){Object.prototype.hasOwnProperty.call(Cr.content,gr)&&(Tt.push("a=ssrc:"),Tt.push(Cr.ssrc),Tt.push(" "),Tt.push(gr),Tt.push(":"),Tt.push(Cr.content[gr]),Tt.push(`\r
`))})},ar=0;ar<Ut.ssrcs.length;ar+=1)jn(ar);continue}Tt.push(en),Tt.push(`\r
`);continue}}}else Tt.push("a="),Tt.push(Ut.direction),Tt.push(`\r
`)}else{if(en.match(/^b=/))continue;Tt.push(en),Tt.push(`\r
`)}}}return Tt.join("")};var rt=et.Y.get("SDPManager"),pt=function(){rt.debug("SDPManager"),this.getSDPLines=function(Gt){rt.debug("SDPManager::getSDPLines");var Tt,nt=Gt.split(`\r
`);for(Tt=0;Tt<nt.length;Tt+=1)rt.log("sdpLines[i] : "+nt[Tt]);return nt},this.getAudioMediaDescriptionPart=function(Gt){rt.debug("SDPManager::getAudioMediaDescriptionPart");var Tt=Gt.split("m=audio"),nt=null;return Tt[1]!==void 0&&Tt[1]!==null?(nt=Tt[1].split("m=video"),rt.log("SDP audio part : "+nt[0]),nt[0]):null},this.getVideoMediaDescriptionPart=function(Gt){rt.debug("SDPManager::getVideoMediaDescriptionPart");var Tt,nt=Gt.split("m=video");for(Tt=0;Tt<nt.length;Tt+=1)rt.log("sdpMediaPart[i] : "+nt[Tt]);return nt[1]},this.searchMediaDescriptionForRecvOnly=function(Gt){return rt.debug("searchMediaDescriptionForRecvOnly"),Gt.search("a=recvonly")!==-1?(rt.log("recvonly found in media description"),!0):(rt.log("recvonly not found in media description"),!1)},this.searchSDPForRecvOnly=function(Gt){return Gt!==void 0?(rt.log("sdpPart !== undefined"),this.searchMediaDescriptionForRecvOnly(Gt)):(rt.log("recvonly not found in SDP"),!1)},this.searchMediaDescriptionForSendOnly=function(Gt){return rt.debug("searchMediaDescriptionForSendOnly"),Gt.search("a=sendonly")!==-1?(rt.log("sendonly found in media description"),!0):(rt.log("sendonly not found in media description"),!1)},this.searchSDPForSendOnly=function(Gt){return Gt!==void 0?(rt.log("sdpPart !== undefined"),this.searchMediaDescriptionForSendOnly(Gt)):(rt.log("sendonly not found in SDP"),!1)},this.searchMediaDescriptionForInactive=function(Gt){return rt.debug("searchMediaDescriptionForInactive"),Gt.search("a=inactive")!==-1?(rt.log("inactive found in media description"),!0):(rt.log("inactive not found in media description"),!1)},this.searchSDPForInactive=function(Gt){return Gt!==void 0?(rt.log("sdpPart !== undefined"),this.searchMediaDescriptionForInactive(Gt)):(rt.log("inactive not found in SDP"),!1)},this.stripAudioMediaDescriptionFromSDP=function(Gt){rt.debug("SDPManager::stripAudioMediaDescriptionFromSDP");var Tt=this.createGuideline(Gt);return Tt.audio?(Tt.audio.direction="inactive",Tt.generate({stripInactiveMLines:!0})):Gt},this.stripVideoMediaDescriptionFromSDP=function(Gt){rt.debug("SDPManager::stripVideoMediaDescriptionFromSDP");var Tt=this.createGuideline(Gt);return Tt.video?(Tt.video.direction="inactive",Tt.generate({stripInactiveMLines:!0})):Gt},this.setAudioBandwidth=function(Gt,Tt){return rt.info("SDPManager::setAudioBandwidth",Tt),Tt?Gt=Gt.replace(/a=mid:audio\r\n/g,`a=mid:audio\r
b=AS:`+Tt+`\r
`):(rt.warn("No maxAudioBW !"),Gt)},this.setVideoBandwidth=function(Gt,Tt){if(rt.info("SDPManager::setVideoBandwidth",Tt),!Tt)return rt.warn("No maxVideoBW !"),Gt;for(var nt=[],Ct=Gt.split(`\r
`),yt=0,Pt=null,Et=null;yt<Ct.length;)if((Pt=Ct[yt]).length!==0)if(Et!==null)Pt.match(/^m=/)?Et=null:Pt.match(/^a=mid:(\w+)$/)?(nt.push(Pt),nt.push(`\r
`),nt.push("b=AS:"),nt.push(Tt),nt.push(`\r
`),nt.push("b=TIAS:"),nt.push(Tt),nt.push("000"),nt.push(`\r
`),yt+=1):(Pt.match(/^b=([A-Z]+):(\w+)$/)||(nt.push(Pt),nt.push(`\r
`)),yt+=1);else{var Ut=Pt.match(/^m=([a-z]+)(.+)$/);if(Ut&&Ut[1]==="video"){Et="video",nt.push(Pt),nt.push(`\r
`),yt+=1;continue}nt.push(Pt),nt.push(`\r
`),yt+=1}else yt+=1;return nt.join("")},this.setDataBandwidth=function(Gt,Tt){return rt.info("SDPManager::setDataBandwidth",Tt),Tt?Gt=Gt.replace(/a=mid:data\r\n/g,`a=mid:data\r
b=AS:`+Tt+`\r
`):(rt.warn("No maxDataBW !"),Gt)},this.setSendOnlyForAudio=function(Gt){rt.debug("SDPManager::setSendOnlyForAudio");var Tt=this.createGuideline(Gt);return(0,st.ki)(Tt,"audio","object")&&(Tt.audio.direction="sendonly"),Tt.generate()},this.setSendOnlyForVideo=function(Gt){rt.debug("SDPManager::setSendOnlyForVideo");var Tt=this.createGuideline(Gt);return(0,st.ki)(Tt,"video","object")&&(Tt.video.direction="sendonly"),Tt.generate()},this.setSendOnly=function(Gt){rt.debug("SDPManager::setSendOnly : global");var Tt=this.createGuideline(Gt);return(0,st.ki)(Tt,"audio","object")&&(Tt.audio.direction="sendonly"),(0,st.ki)(Tt,"video","object")&&(Tt.video.direction="sendonly"),Tt.generate()},this.setRecvOnlyForAudio=function(Gt){rt.debug("SDPManager::setRecvOnlyForAudio");var Tt=this.createGuideline(Gt);return Tt.audio&&Tt.audio.direction!=="inactive"&&(Tt.audio.direction="recvonly"),Tt.generate()},this.setRecvOnlyForVideo=function(Gt){rt.debug("SDPManager::setRecvOnlyForVideo");var Tt=this.createGuideline(Gt);return Tt.video&&Tt.video.direction!=="inactive"&&(Tt.video.direction="recvonly"),Tt.generate()},this.setRecvOnly=function(Gt){rt.debug("SDPManager::setRecvOnly : global");var Tt=this.createGuideline(Gt);return Tt.audio&&Tt.audio.direction!=="inactive"&&(Tt.audio.direction="recvonly"),Tt.video&&Tt.video.direction!=="inactive"&&(Tt.video.direction="recvonly"),Tt.generate()},this.updateSDPcodecs=function(Gt,Tt,nt,Ct){var yt,Pt,Et,Ut,Ot,Bt,Qt,en,Jt=!1,an=new RegExp(`\r
$`),hn=!1,rn=null,dn="",Sn="",wn="",An="",_n="",jn="",ar="",fr="";if(rt.log(`updateSDPcodecs():
	sdpType = `+Tt+`
	mediaType = `+nt+`
	availableCodecSet = `+Ct+`
`),Ct=="")return Gt;for(Et=(Et=RTCSessionDescription&&Gt instanceof RTCSessionDescription?Gt.sdp:window.SessionDescription&&Gt instanceof SessionDescription?Gt.toSdp():Gt).split(`\r
m=`),an.test(Et[Et.length-2])===!1&&(Et[Et.length-2]=Et[Et.length-2]+`\r
`,hn=!0),yt=0;yt<Et.length;yt++)if(Et[yt].indexOf(nt)===0){for(rn=Et[yt].split(`\r
`)[0].split(" "),Pt=3;Pt<rn.length;Pt++)if(Ut=!0,isNaN(rn[Pt])===!1){switch(Sn="a=rtpmap:"+rn[Pt]+" ",(Ot=Et[yt].indexOf(Sn))!==-1&&(Bt=Et[yt].indexOf(`\r
`,Ot)),rn[Pt]){case 0:dn="PCMU/8000";break;case 8:dn="PCMA/8000";break;case 9:dn="G722/8000";break;case 13:dn="CN/8000";break;case 18:dn="G729/8000";break;default:Ot!==-1&&(dn=Et[yt].substring(Ot+Sn.length,Bt))}dn!=""&&Ct.indexOf(dn)!==-1?rt.log("PT("+rn[Pt]+"): "+dn+` FOUND in availableCodecSet.
`):(Ut=!1,rt.log("PT("+rn[Pt]+"): "+dn+` NOT FOUND in availableCodecSet.
`)),Ut||(wn=Sn+`.*\r
`,An="a=fmtp:"+rn[Pt]+` .*\r
`,ar="a=rtcp-fb:"+rn[Pt]+` .*\r
`,_n=" "+rn[Pt]+" ",jn=" "+rn[Pt]+"\r",Et[yt]=Et[yt].replace(new RegExp(wn,"g"),""),Et[yt]=Et[yt].replace(new RegExp(An,"g"),""),Et[yt]=Et[yt].replace(new RegExp(ar,"g"),""),(en=(Qt=Et[yt].split(`
`))[0].split("RTP"))[1]=en[1].replace(_n," "),en[1]=en[1].replace(jn,"\r"),Qt[0]=en.join("RTP"),Et[yt]=Qt.join(`
`),nt==="video"&&(ar="a=rtcp-fb:"+rn[Pt]+` .*\r
`,Et[yt]=Et[yt].replace(new RegExp(ar,"g"),""),dn!=""&&dn.substr(0,4)==="rtx/"&&(fr=`a=ssrc-group:FID .*\r
`,Et[yt]=Et[yt].replace(new RegExp(fr,"g"),""),(Qt=Et[yt].split(`\r
a=`)).splice(Qt.length-8,4),Et[yt]=Qt.join(`\r
a=`))),Jt=!0)}break}return hn&&(Et[Et.length-2]=Et[Et.length-2].substr(0,Et[Et.length-2].length-2)),Et=Et.join(`\r
m=`),Jt===!0?(rt.log("updateSDPcodecs(), SDP has been updated."),RTCSessionDescription&&Gt instanceof RTCSessionDescription?new RTCSessionDescription({type:Tt,sdp:Et}):window.SessionDescription&&Gt instanceof SessionDescription?new SessionDescription(Et):Et):(rt.log("updateSDPcodecs(), SDP has not been updated."),Gt)},this.preferOpus=function(Gt){var Tt,nt=Gt.split(`\r
`),Ct=0,yt=null;for(Tt=0;Tt<nt.length;Tt+=1)if(nt[Tt].search("m=audio")!==-1){Ct=Tt;break}if(Ct===0)return Gt;for(Tt=0;Tt<nt.length;Tt+=1)if(nt[Tt].search("opus/48000")!==-1){(yt=this.extractSdp(nt[Tt],/:(\d+) opus\/48000/i))&&(nt[Ct]=this.setDefaultCodec(nt[Ct],yt));break}return(nt=this.removeCN(nt,Ct)).join(`\r
`)},this.removeCN=function(Gt,Tt){var nt=0,Ct=Gt[Tt].split(" "),yt=null,Pt=0;for(nt=Gt.length-1;nt>=0;nt--)(yt=this.extractSdp(Gt[nt],/a=rtpmap:(\d+) CN\/\d+/i))&&((Pt=Ct.indexOf(yt))!==-1&&Ct.splice(Pt,1),Gt.splice(nt,1));return Gt[Tt]=Ct.join(" "),Gt},this.extractSdp=function(Gt,Tt){var nt=Gt.match(Tt);return nt&&nt.length==2?nt[1]:null},this.setDefaultCodec=function(Gt,Tt){var nt=0,Ct=Gt.split(" "),yt=Ct.slice(0,3);for(yt.push(Tt),nt=3;nt<Ct.length;nt++)Ct[nt]!==Tt&&yt.push(Ct[nt]);return yt.join(" ")},this.findLineInRange=function(Gt,Tt,nt,Ct,yt){var Pt,Et=nt!==-1?nt:Gt.length;for(Pt=Tt;Pt<Et;++Pt)if(Gt[Pt].indexOf(Ct)===0&&(!yt||Gt[Pt].toLowerCase().indexOf(yt.toLowerCase())!==-1))return Pt;return null},this.findLine=function(Gt,Tt,nt){return this.findLineInRange(Gt,0,-1,Tt,nt)},this.getCodecPayloadType=function(Gt,Tt){var nt=this.findLine(Gt,"a=rtpmap",Tt);return nt?this.getCodecPayloadTypeFromLine(Gt[nt]):null},this.getCodecPayloadTypeFromLine=function(Gt){var Tt=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),nt=Gt.match(Tt);return nt&&nt.length===2?nt[1]:null},this.findFmtpLine=function(Gt,Tt){var nt=this.getCodecPayloadType(Gt,Tt);return nt?this.findLine(Gt,"a=fmtp:"+nt.toString()):null},this.writeFmtpLine=function(Gt){if(!Gt.hasOwnProperty("pt")||!Gt.hasOwnProperty("params"))return null;var Tt=Gt.pt,nt=Gt.params,Ct=[],yt=0,Pt=null;for(Pt in nt)Ct[yt]=Pt+"="+nt[Pt],++yt;return yt===0?null:"a=fmtp:"+Tt.toString()+" "+Ct.join("; ")},this.setCodecParam=function(Gt,Tt,nt,Ct){var yt=Gt.split(`\r
`),Pt=this.findFmtpLine(yt,Tt),Et={},Ut=null,Ot=null;if(Pt===null){if((Ot=this.findLine(yt,"a=rtpmap",Tt))===null)return Gt;Ut=this.getCodecPayloadTypeFromLine(yt[Ot]),Et.pt=Ut.toString(),Et.params={},Et.params[nt]=Ct,yt.splice(Ot+1,0,this.writeFmtpLine(Et))}else(Et=function(Bt){var Qt,en={},Jt=Bt.indexOf(" "),an=Bt.substring(Jt+1).split("; "),hn=new RegExp("a=fmtp:(\\d+)"),rn=Bt.match(hn),dn={},Sn=null;if(!rn||rn.length!==2)return null;for(en.pt=rn[1],Qt=0;Qt<an.length;++Qt)(Sn=an[Qt].split("=")).length===2&&(dn[Sn[0]]=Sn[1]);return en.params=dn,en}(yt[Pt])).params[nt]=Ct,yt[Pt]=this.writeFmtpLine(Et);return yt.join(`\r
`)},this.maybePreferCodec=function(Gt,Tt,nt){var Ct,yt,Pt=Tt+" codec",Et=null;return nt?(rt.log("Prefer "+Pt+": "+nt),Et=Gt.split(`\r
`),(Ct=this.findLine(Et,"m=",Tt))===null?(rt.log("mLineIndex === null"),Gt):((yt=this.getCodecPayloadType(Et,nt))&&(Et[Ct]=this.setDefaultCodec(Et[Ct],yt)),Gt=Et.join(`\r
`))):(rt.log("No preference on "+Pt+"."),Gt)},this.createGuideline=ct};function ft(Gt,Tt){(Tt==null||Tt>Gt.length)&&(Tt=Gt.length);for(var nt=0,Ct=new Array(Tt);nt<Tt;nt++)Ct[nt]=Gt[nt];return Ct}function St(Gt,Tt){for(var nt=0;nt<Tt.length;nt++){var Ct=Tt[nt];Ct.enumerable=Ct.enumerable||!1,Ct.configurable=!0,"value"in Ct&&(Ct.writable=!0),Object.defineProperty(Gt,Ct.key,Ct)}}function It(){return!0}function xt(Gt){return Gt===null}function At(Gt){return Gt!==null}s(9753),s(1038),s(4553),s(9070);var Dt=function(){function Gt(){(function(Ct,yt){if(!(Ct instanceof yt))throw new TypeError("Cannot call a class as a function")})(this,Gt),this._callbacks=[],this._timeout=null,this._err=null,this._data=null,this._interrupted=null,this._fulfilled=!1}var Tt,nt;return Tt=Gt,nt=[{key:"err",get:function(){if(!this._fulfilled)throw new Error("not fulfilled yet");return this._err}},{key:"data",get:function(){if(!this._fulfilled)throw new Error("not fulfilled yet");return this._data}},{key:"interrupted",get:function(){if(!this._fulfilled)throw new Error("not fulfilled yet");return this._interrupted}},{key:"fulfilled",get:function(){return this._fulfilled}},{key:"_fulfill",value:function(Ct,yt,Pt){this._err=Ct,this._data=yt,this._interrupted=Pt,this._fulfilled=!0;var Et=this._callbacks.slice();this.clear();var Ut,Ot=function(Jt,an){var hn=typeof Symbol<"u"&&Jt[Symbol.iterator]||Jt["@@iterator"];if(!hn){if(Array.isArray(Jt)||(hn=function(_n,jn){if(_n){if(typeof _n=="string")return ft(_n,jn);var ar=Object.prototype.toString.call(_n).slice(8,-1);return ar==="Object"&&_n.constructor&&(ar=_n.constructor.name),ar==="Map"||ar==="Set"?Array.from(_n):ar==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ar)?ft(_n,jn):void 0}}(Jt))||an&&Jt&&typeof Jt.length=="number"){hn&&(Jt=hn);var rn=0,dn=function(){};return{s:dn,n:function(){return rn>=Jt.length?{done:!0}:{done:!1,value:Jt[rn++]}},e:function(_n){throw _n},f:dn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Sn,wn=!0,An=!1;return{s:function(){hn=hn.call(Jt)},n:function(){var _n=hn.next();return wn=_n.done,_n},e:function(_n){An=!0,Sn=_n},f:function(){try{wn||hn.return==null||hn.return()}finally{if(An)throw Sn}}}}(Et);try{for(Ot.s();!(Ut=Ot.n()).done;){var Bt=Ut.value,Qt=Bt.match,en=Bt.callback;Qt(this._err)&&en(this._err,this._data,this._interrupted)}}catch(Jt){Ot.e(Jt)}finally{Ot.f()}}},{key:"clear",value:function(){this.clearTimeout(),this.removeCallback()}},{key:"setTimeout",value:function(Ct){function yt(Pt,Et,Ut){return Ct.apply(this,arguments)}return yt.toString=function(){return Ct.toString()},yt}(function(Ct,yt,Pt){var Et=this;this.clearTimeout(),this._timeout=setTimeout(yt===null?function(){Et._fulfill(null,Pt,!0)}:function(){Et._fulfill(typeof yt=="string"?new Error(yt):yt,void 0,!0)},Ct)})},{key:"clearTimeout",value:function(Ct){function yt(){return Ct.apply(this,arguments)}return yt.toString=function(){return Ct.toString()},yt}(function(){this._timeout!==null&&(clearTimeout(this._timeout),this._timeout=null)})},{key:"onFulfillment",value:function(Ct){this._callbacks.push({match:It,callback:Ct})}},{key:"onSuccess",value:function(Ct){this._callbacks.push({match:xt,callback:Ct})}},{key:"onFailure",value:function(Ct){this._callbacks.push({match:At,callback:Ct})}},{key:"removeCallback",value:function(Ct){if(typeof Ct=="function"){var yt=this._callbacks.findIndex(function(Pt){return Pt.callback===Ct});yt>=0&&this._callbacks.splice(yt,1)}else this._callbacks.splice(0,this._callbacks.length)}},{key:"fulfill",value:function(Ct,yt){Ct===null?this._fulfill(null,yt,!1):this._fulfill(typeof Ct=="string"?new Error(Ct):Ct,void 0,!1)}}],nt&&St(Tt.prototype,nt),Object.defineProperty(Tt,"prototype",{writable:!1}),Gt}(),wt=(s(1249),s(7327),s(3843),function(Gt,Tt,nt,Ct,yt,Pt,Et,Ut){this.rawStats={},this.rawStats.connectedPair=[],this.rawStats.audio_send=[],this.rawStats.audio_recv=[],this.rawStats.video_send=[],this.rawStats.video_recv=[],this.instantRTT=0,this.moyRttCP=[0,0,0,0,0,0,0,0,0,0],this.moyRttAS=[0,0,0,0,0,0,0,0,0,0],this.moyRttVS=[0,0,0,0,0,0,0,0,0,0],this.tauxPacketLossAS=[0],this.oldLostAS=this.oldSentAS=0,this.oldLostVS=this.oldLostVS=0,this.cptTaux=0,this.tauxPacketLossVS=[0],this.oldBandwidthAS=0,this.oldBandwidthVS=0,this.oldBandwidthAR=0,this.oldBandwidthVR=0,this.bandwidthAS=[0,0,0,0,0,0,0,0,0,0],this.bandwidthAR=[0,0,0,0,0,0,0,0,0,0],this.bandwidthVS=[0,0,0,0,0,0,0,0,0,0],this.bandwidthVR=[0,0,0,0,0,0,0,0,0,0],this.qosIn=0,this.qosInAverage=0,this.qosInAverageCount=0,this.qosAudioIn=0,this.qosAudioInAverage=0,this.qosAudioInAverageCount=0,this.qosVideoIn=0,this.qosVideoInAverage=0,this.qosVideoInAverageCount=0,this.qosOut=0,this.qosOutAverage=0,this.qosOutAverageCount=0,this.qosAudioOut=0,this.qosAudioOutAverage=0,this.qosAudioOutAverageCount=0,this.qosVideoOut=0,this.qosVideoOutAverage=0,this.qosVideoOutAverageCount=0,this.onQosChange=Tt,this.onQosAudioChange=nt,this.onQosVideoChange=Ct,this.cpt=0,this.cptRes=5,this.cptDb=60,this.saveStatsFlag=!0,this.tabQosIn=[],this.tabQosAudioIn=[],this.tabQosVideoIn=[],this.tabQosOut=[],this.tabQosAudioOut=[],this.tabQosVideoOut=[],this.tabTimestamp=[],this.tabDelay=[],this.tabJitterBufferAudio=[],this.tabJitterBufferVideo=[],this.tabAudioRtt=[],this.tabVideoRtt=[],this.tabAudioBW=[],this.tabVideoBW=[],this.clientId=Et,this.callId=yt,this.apiKey=Pt,this.socket=Ut,this.interval=Gt,this.insertStats=function(Ot,Bt,Qt,en){var Jt,an,hn,rn=null;for(this.cpt=this.cpt+this.interval,Jt=0;Jt<Ot.length;++Jt){var dn=Ot[Jt];switch(dn.type){case"googCandidatePair":for(rn=dn.names(),hn=0;hn<rn.length;++hn)if(rn[hn]=="googActiveConnection"&&dn.stat(rn[hn])=="true")for(an=0;an<rn.length;++an)rn[an]=="bytesSent"&&dn.stat(rn[an])!==void 0&&(this.rawStats.connectedPair.bytesSent=dn.stat(rn[an])),rn[an]=="bytesReceived"&&dn.stat(rn[an])!==void 0&&(this.rawStats.connectedPair.bytesReceived=dn.stat(rn[an])),rn[an]=="googRtt"&&dn.stat(rn[an])!==void 0&&(this.rawStats.connectedPair.googRtt=dn.stat(rn[an]));break;case"ssrc":for(rn=dn.names(),hn=0;hn<rn.length;++hn){if(rn[hn]=="audioOutputLevel")for(an=0;an<rn.length;++an)rn[an]=="packetsLost"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_recv.packetsLost=dn.stat(rn[an])),rn[an]=="googDecodingPLC"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_recv.googDecodingPLC=dn.stat(rn[an])),rn[an]=="googJitterReceived"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_recv.googJitterReceived=dn.stat(rn[an])),rn[an]=="googJitterBufferMs"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_recv.googJitterBufferMs=dn.stat(rn[an])),rn[an]=="googCurrentDelayMs"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_recv.googCurrentDelayMs=dn.stat(rn[an])),rn[an]=="bytesReceived"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_recv.bytesReceived=dn.stat(rn[an]));if(rn[hn]=="audioInputLevel")for(an=0;an<rn.length;++an)rn[an]=="googRtt"&&dn.stat(rn[an])!==void 0&&dn.stat(rn[an])!=-1&&(this.rawStats.audio_send.googRtt=dn.stat(rn[an])),rn[an]=="packetsLost"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_send.packetsLost=dn.stat(rn[an])),rn[an]=="packetsSent"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_send.packetsSent=dn.stat(rn[an])),rn[an]=="bytesSent"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_send.bytesSent=dn.stat(rn[an])),rn[an]=="googJitterReceived"&&dn.stat(rn[an])!==void 0&&(this.rawStats.audio_send.googJitterReceived=dn.stat(rn[an]));if(rn[hn]=="googFrameHeightReceived")for(an=0;an<rn.length;++an)rn[an]=="googFrameHeightReceived"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_recv.FrameHeight=dn.stat(rn[an])),rn[an]=="googFrameWidthReceived"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_recv.FrameWidth=dn.stat(rn[an])),rn[an]=="googCurrentDelayMs"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_recv.delay=dn.stat(rn[an])),rn[an]=="packetsLost"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_recv.packetsLost=dn.stat(rn[an])),rn[an]=="googNacksSent"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_recv.googNacksSent=dn.stat(rn[an])),rn[an]=="googJitterBufferMs"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_recv.googJitterBufferMs=dn.stat(rn[an])),rn[an]=="bytesReceived"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_recv.bytesReceived=dn.stat(rn[an])),rn[an]=="googFrameRateReceived"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_recv.googFrameRateReceived=dn.stat(rn[an]));if(rn[hn]=="googFrameHeightSent")for(an=0;an<rn.length;++an)rn[an]=="googFrameHeightSent"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_send.FrameHeight=dn.stat(rn[an])),rn[an]=="googFrameWidthSent"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_send.FrameWidth=dn.stat(rn[an])),rn[an]=="packetsLost"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_send.packetsLost=dn.stat(rn[an])),rn[an]=="googNacksReceived"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_send.googNacksReceived=dn.stat(rn[an])),rn[an]=="googRtt"&&dn.stat(rn[an])!==void 0&&dn.stat(rn[an])!=-1&&(this.rawStats.video_send.googRtt=dn.stat(rn[an])),rn[an]=="packetsSent"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_send.packetsSent=dn.stat(rn[an])),rn[an]=="bytesSent"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_send.bytesSent=dn.stat(rn[an])),rn[an]=="googEncodeUsagePercent"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_send.googEncodeUsagePercent=dn.stat(rn[an])),rn[an]=="googCpuLimitedResolution"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_send.googCpuLimitedResolution=dn.stat(rn[an])),rn[an]=="googBandwidthLimitedResolution"&&dn.stat(rn[an])!==void 0&&(this.rawStats.video_send.googBandwidthLimitedResolution=dn.stat(rn[an]))}}}this.computeStats(Bt,Qt,en),this.cpt%this.cptRes==0&&this.saveStatsLocal(),this.cpt%this.cptDb==0&&this.saveStatsToDb(!1)},this.saveStatsLocal=function(){if(this.saveStatsFlag){var Ot=Date.now();this.tabTimestamp.push(Ot),this.tabQosIn.push(this.qosIn),this.tabQosAudioIn.push(this.qosAudioIn),this.qosVideoIn!==0&&this.tabQosVideoIn.push(this.qosVideoIn),this.tabQosOut.push(this.qosOut),this.tabQosAudioOut.push(this.qosAudioOut),this.qosVideoOut!==0&&this.tabQosVideoOut.push(this.qosVideoOut),this.tabJitterBufferAudio.push(this.rawStats.audio_recv.googJitterBufferMs),this.rawStats.video_recv.googJitterBufferMs!==void 0&&this.tabJitterBufferVideo.push(this.rawStats.video_recv.googJitterBufferMs),this.rawStats.video_send.googRtt!==void 0&&this.tabVideoRtt.push(this.rawStats.video_send.googRtt),this.tabAudioRtt.push(this.rawStats.audio_send.googRtt),this.bandwidthAS!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthAS)/1024),this.bandwidthVS!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthVS)/1024),this.bandwidthAR!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthAR)/1024),this.bandwidthVR!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthVR)/1024)}},this.saveStatsToDb=function(Ot){},this.saveStatsToDb=function(Ot){this.saveStatsFlag=Ot},this.computeStats=function(Ot,Bt,Qt){var en=0;this.rawStats.connectedPair.googRtt!==-1&&this.rawStats.connectedPair.googRtt!==0&&this.rawStats.connectedPair.googRtt!==void 0&&this.add(this.rawStats.connectedPair.googRtt,this.moyRttCP),this.rawStats.video_send.googRtt!==-1&&this.rawStats.video_send.googRtt!==0&&this.rawStats.video_send.googRtt!==void 0&&(this.add(this.rawStats.video_send.googRtt,this.moyRttVS),this.instantRTT=this.rawStats.video_send.googRtt),this.rawStats.audio_send.googRtt!==-1&&this.rawStats.audio_send.googRtt!==0&&this.rawStats.audio_send.googRtt!==void 0&&this.add(this.rawStats.audio_send.googRtt,this.moyRttAS),this.rawStats.audio_send.packetsLost!==-1&&this.rawStats.audio_send.packetsLost!==void 0&&this.rawStats.audio_send.packetsSent!==-1&&this.rawStats.audio_send.packetsSent!==0&&this.rawStats.audio_send.packetsSent!==void 0&&(en=100*(this.rawStats.audio_send.packetsLost-this.oldLostAS)/(this.rawStats.audio_send.packetsSent-this.oldSentAS),this.oldLostAS=this.rawStats.audio_send.packetsLost,this.oldSentAS=this.rawStats.audio_send.packetsSent,this.add(en,this.tauxPacketLossAS)),this.rawStats.video_send.packetsLost!==-1&&this.rawStats.video_send.packetsLost!==void 0&&this.rawStats.video_send.packetsSent!==-1&&this.rawStats.video_send.packetsSent!==0&&this.rawStats.video_send.packetsSent!==void 0&&(en=100*(this.rawStats.video_send.packetsLost-this.oldLostVS)/(this.rawStats.video_send.packetsSent-this.oldSentVS),this.oldLostVS=this.rawStats.video_send.packetsLost,this.oldSentVS=this.rawStats.video_send.packetsSent,this.add(en,this.tauxPacketLossVS)),this.rawStats.audio_recv.bytesReceived!==-1&&this.rawStats.audio_recv.bytesReceived!==void 0&&(this.oldBandwidthAR===void 0&&(this.oldBandwidthAR=0),this.add((this.rawStats.audio_recv.bytesReceived-this.oldBandwidthAR)/this.interval,this.bandwidthAR),this.oldBandwidthAR=this.rawStats.audio_recv.bytesReceived),this.rawStats.video_recv.bytesReceived!==-1&&this.rawStats.video_recv.bytesReceived!==void 0&&(this.oldBandwidthVR===void 0&&(this.oldBandwidthVR=0),this.add((this.rawStats.video_recv.bytesReceived-this.oldBandwidthVR)/this.interval,this.bandwidthVR),this.oldBandwidthVR=this.rawStats.video_recv.bytesReceived),this.rawStats.audio_send.bytesSent!==-1&&this.rawStats.audio_send.bytesSent!==void 0&&(this.oldBandwidthAS===void 0&&(this.oldBandwidthAS=0),this.add((this.rawStats.audio_send.bytesSent-this.oldBandwidthAS)/this.interval,this.bandwidthAS),this.oldBandwidthAS=this.rawStats.audio_send.bytesSent),this.rawStats.video_send.bytesSent!==-1&&this.rawStats.video_send.bytesSent!==void 0&&(this.oldBandwidthVS===void 0&&(this.oldBandwidthVS=0),this.add((this.rawStats.video_send.bytesSent-this.oldBandwidthVS)/this.interval,this.bandwidthVS),this.oldBandwidthVS=this.rawStats.video_send.bytesSent);var Jt=0,an=0,hn=0,rn=0,dn=0,Sn=0,wn=0,An=0,_n=0,jn=0,ar=this.getCodecs(Bt),fr=8*this.Average(this.bandwidthAS)/1024;if(fr<5?Jt=1:fr>=5&&fr<10?Jt=2:fr>=10&&(Jt=3),ar!==null&&ar[1]){var Cr=8*this.Average(this.bandwidthVS)/1024;Cr<240?rn=1:Cr>=240&&Cr<330?rn=2:Cr>=330&&(rn=3)}this.rawStats.audio_recv.googJitterBufferMs<60?an=3:this.rawStats.audio_recv.googJitterBufferMs>=60&&this.rawStats.audio_recv.googJitterBufferMs<100?an=2:this.rawStats.audio_recv.googJitterBufferMs>=100&&(an=1),this.rawStats.audio_recv.googCurrentDelayMs<100?hn=3:this.rawStats.audio_recv.googCurrentDelayMs>=100&&this.rawStats.audio_recv.googCurrentDelayMs<200?hn=2:this.rawStats.audio_recv.googCurrentDelayMs>=200&&(hn=1),ar!==null&&ar[1]&&(this.rawStats.video_recv.googJitterBufferMs<100?dn=3:this.rawStats.video_recv.googJitterBufferMs>=100&&this.rawStats.video_recv.googJitterBufferMs<200?dn=2:this.rawStats.video_recv.googJitterBufferMs>=200&&(dn=1));var gr=!1,Er=!1,Nr=!1;ar!==null&&ar[1]?(Math.ceil((Jt+2*rn+dn+an+hn)/6)!=this.qosIn&&(gr=!0),this.qosIn=Math.ceil((Jt+2*rn+dn+an+hn)/6),this.qosInAverage=(this.qosInAverage*this.qosInAverageCount+this.qosIn)/(this.qosInAverageCount+1),this.qosInAverageCount++,Math.ceil((Jt+an+hn)/3)!=this.qosAudioIn&&(Er=!0),this.qosAudioIn=Math.ceil((Jt+an+hn)/3),this.qosAudioInAverage=(this.qosAudioInAverage*this.qosAudioInAverageCount+this.qosAudioIn)/(this.qosAudioInAverageCount+1),this.qosAudioInAverageCount++,Math.ceil((2*rn+dn)/3)!=this.qosVideoIn&&(Nr=!0),this.qosVideoIn=Math.ceil((2*rn+dn)/3),this.qosVideoInAverage=(this.qosVideoInAverage*this.qosVideoInAverageCount+this.qosVideoIn)/(this.qosVideoInAverageCount+1),this.qosVideoInAverageCount++):(Math.ceil((Jt+an+hn)/3)!=this.qosOut&&(gr=!0),this.qosIn=Math.ceil((Jt+an+hn)/3),this.qosInAverage=(this.qosInAverage*this.qosInAverageCount+this.qosIn)/(this.qosInAverageCount+1),this.qosInAverageCount++,Math.ceil((Jt+an+hn)/3)!=this.qosAudioIn&&(Er=!0),this.qosAudioIn=Math.ceil((Jt+an+hn)/3),this.qosAudioInAverage=(this.qosAudioInAverage*this.qosAudioInAverageCount+this.qosAudioIn)/(this.qosAudioInAverageCount+1),this.qosAudioInAverageCount++),this.RttAverage(this.moyRttAS)<80?wn=3:this.RttAverage(this.moyRttAS)>=80&&this.RttAverage(this.moyRttAS)<150?wn=2:this.RttAverage(this.moyRttAS)>=150&&(wn=1),this.tauxPacketLossAS<=5?Sn=3:this.tauxPacketLossAS>5&&this.tauxPacketLossAS<10?Sn=2:this.tauxPacketLossAS>=10&&(Sn=1),this.rawStats.audio_recv.googJitterReceived<80?An=3:this.rawStats.audio_recv.googJitterReceived>=80&&this.rawStats.audio_recv.googJitterReceived<150?An=2:this.rawStats.audio_recv.googJitterReceived>=150&&(An=1),ar!==null&&ar[1]&&(this.tauxPacketLossVS<=5?_n=3:this.tauxPacketLossVS>5&&this.tauxPacketLossVS<10?_n=2:this.tauxPacketLossVS>=10&&(_n=1),this.RttAverage(this.moyRttVS)<80?jn=3:this.RttAverage(this.moyRttVS)>=80&&this.RttAverage(this.moyRttVS)<150?jn=2:this.RttAverage(this.moyRttVS)>=150&&(jn=1)),ar!==null&&ar[1]?(Math.ceil((wn+2*Sn+An+2*_n+jn)/7)!=this.qosOut&&(gr=!0),this.qosOut=Math.ceil((wn+2*Sn+An+2*_n+jn)/7),this.qosOutAverage=(this.qosOutAverage*this.qosOutAverageCount+this.qosOut)/(this.qosOutAverageCount+1),this.qosOutAverageCount++,Math.ceil((wn+2*Sn+An)/4)!=this.qosAudioOut&&(Er=!0),this.qosAudioOut=Math.ceil((wn+2*Sn+An)/4),this.qosAudioOutAverage=(this.qosAudioOutAverage*this.qosAudioOutAverageCount+this.qosAudioOut)/(this.qosAudioOutAverageCount+1),this.qosAudioOutAverageCount++,Math.ceil((2*_n+jn)/3)!=this.qosVideoOut&&(Nr=!0),this.qosVideoOut=Math.ceil((2*_n+jn)/3),this.qosVideoOutAverage=(this.qosVideoOutAverage*this.qosVideoOutAverageCount+this.qosVideoOut)/(this.qosVideoOutAverageCount+1),this.qosVideoOutAverageCount++):(Math.ceil((wn+2*Sn+An)/4)!=this.qosOut&&(gr=!0),this.qosOut=Math.ceil((wn+2*Sn+An)/4),this.qosOutAverage=(this.qosOutAverage*this.qosOutAverageCount+this.qosOut)/(this.qosOutAverageCount+1),this.qosOutAverageCount++,Math.ceil((wn+2*Sn+An)/4)!=this.qosAudioOut&&(Er=!0),this.qosAudioOut=Math.ceil((wn+2*Sn+An)/4),this.qosAudioOutAverage=(this.qosAudioOutAverage*this.qosAudioOutAverageCount+this.qosAudioOut)/(this.qosAudioOutAverageCount+1),this.qosAudioOutAverageCount++),gr&&this.onQosChange(this.qosIn,this.qosOut),Er&&this.onQosAudioChange(this.qosAudioIn,this.qosAudioOut),Nr&&this.onQosVideoChange(this.qosVideoIn,this.qosVideoOut)},this.getCodecs=function(Ot){var Bt=!1,Qt=!1,en=null,Jt=null;if(Ot!=null&&Ot.sdp!==void 0){for(var an=Ot.sdp.split(`
`),hn=0;hn<an.length;hn++)an[hn].indexOf("a=mid:audio")!=-1&&(Bt=!0),an[hn].indexOf("a=mid:video")!=-1&&(Qt=!0),Bt&&an[hn].indexOf("a=rtpmap:")!=-1&&(en=an[hn],Bt=!1),Qt&&an[hn].indexOf("a=rtpmap:")!=-1&&(Jt=an[hn],Qt=!1);return[en,Jt]}return null},this.getQosScore=function(){return[this.qosIn,this.qosOut,this.qosAudioIn,this.qosAudioOut,this.qosVideoIn,this.qosVideoOut]},this.getStat=function(Ot){switch(Ot){case"AudioOutBandwidth":return 8*this.Average(this.bandwidthAS)/1024;case"VideoOutBandwidth":return 8*this.Average(this.bandwidthVS)/1024;case"AudioInBandwidth":return 8*this.Average(this.bandwidthAR)/1024;case"VideoInBandwidth":return 8*this.Average(this.bandwidthVR)/1024;case"AudioInJitterReceived":return this.rawStats.audio_recv.googJitterReceived;case"AudioInJitterBufferMs":return this.rawStats.audio_recv.googJitterBufferMs;case"AudioInDelay":return this.rawStats.audio_recv.googCurrentDelayMs;case"AudioOutLossRate":return this.tauxPacketLossAS;case"AudioOutRtt":return this.RttAverage(this.moyRttAS);case"AudioOutJitterReceived":return this.rawStats.audio_send.googJitterReceived;case"VideoInJitterBufferMs":return this.rawStats.video_recv.googJitterBufferMs;case"VideoOutLossRate":return this.tauxPacketLossVS;case"VideoOutRtt":return this.RttAverage(this.moyRttVS)}},this.getAllStats=function(){for(var Ot={AudioRecv:{},AudioSend:{},VideoRecv:{},VideoSend:{}},Bt={AudioRecv:"audio_recv",VideoRecv:"video_recv",AudioSend:"audio_send",VideoSend:"video_send"},Qt=Object.keys(Bt),en=0;en<Qt.length;en++)for(var Jt=Object.keys(this.rawStats[Bt[Qt[en]]]),an=0;an<Jt.length;an++)Ot[Qt[en]][Jt[an]]=this.rawStats[Bt[Qt[en]]][Jt[an]];return Ot.AudioRecv.bandwidth=8*this.Average(this.bandwidthAR)/1024,Ot.VideoRecv.bandwidth=8*this.Average(this.bandwidthVR)/1024,Ot.AudioSend.bandwidth=8*this.Average(this.bandwidthAS)/1024,Ot.VideoSend.bandwidth=8*this.Average(this.bandwidthVS)/1024,Ot.AudioRecv.jitterReceived=this.rawStats.audio_recv.googJitterReceived,Ot.AudioRecv.jitterBufferMs=this.rawStats.audio_recv.googJitterBufferMs,Ot.VideoRecv.jitterBufferMs=this.rawStats.video_recv.googJitterBufferMs,Ot.AudioRecv.delay=this.rawStats.audio_recv.googCurrentDelayMs,Ot.AudioSend.rtt=this.RttAverage(this.moyRttAS),Ot.VideoSend.moyRtt=this.RttAverage(this.moyRttVS),Ot.VideoSend.rtt=this.instantRTT,Ot.VideoSend.FrameHeight=this.rawStats.video_send.FrameHeight,Ot.VideoSend.FrameWidth=this.rawStats.video_send.FrameWidth,Ot.AudioSend.packetLostRatio=this.tauxPacketLossAS[this.tauxPacketLossAS.length-1],Ot.VideoSend.packetLostRatio=this.tauxPacketLossVS[this.tauxPacketLossVS.length-1],Ot.VideoSend.googEncodeUsagePercent=this.rawStats.video_send.googEncodeUsagePercent,Ot.VideoSend.googCpuLimitedResolution=this.rawStats.video_send.googCpuLimitedResolution,Ot.VideoSend.googBandwidthLimitedResolution=this.rawStats.video_send.googBandwidthLimitedResolution,delete Ot.AudioRecv.googCurrentDelayMs,delete Ot.AudioRecv.googJitterReceived,delete Ot.AudioRecv.googJitterBufferMs,delete Ot.VideoRecv.googJitterBufferMs,delete Ot.AudioSend.googRtt,delete Ot.VideoSend.googRtt,Ot},this.displayComputedStats=function(){console.log("Audio IN JitterReceived:"+this.rawStats.audio_recv.googJitterReceived+" jitterbufferMs:"+this.rawStats.audio_recv.googJitterBufferMs+" delay:"+this.rawStats.audio_recv.googCurrentDelayMs+" bandwidth :"+8*this.Average(this.bandwidthAS)/1024+" kBits/s"),console.log("Audio OUT  lossRate:"+this.tauxPacketLossAS+" rtt:"+this.RttAverage(this.moyRttAS)+" googJitterReceived:"+this.rawStats.audio_recv.googJitterReceived),console.log("Video IN jitter buffer ms:"+this.rawStats.video_recv.googJitterBufferMs+" bandwidth:"+8*this.Average(this.bandwidthVS)/1024+" kBits/s"),console.log("Video OUT loss rate:"+this.tauxPacketLossVS+" rtt:"+this.RttAverage(this.moyRttVS))},this.RttAverage=function(Ot){for(var Bt=0,Qt=0,en=0;en<Ot.length;++en)Ot[en]!==0&&Ot[en]!==-1&&Ot[en]!==void 0&&(Bt+=parseInt(Ot[en],10),Qt++);return parseInt(Bt/Qt,10)},this.Average=function(Ot){for(var Bt=0,Qt=0,en=0;en<Ot.length;++en)Ot[en]!=-1&&Ot[en]!==void 0&&(Bt+=parseInt(Ot[en],10),Qt++);return parseInt(Bt/Qt,10)},this.add=function(Ot,Bt){Bt.pop(),Bt.unshift(Ot)},this.displayTab=function(Ot){for(var Bt in Ot)console.log(Bt+" = "+Ot[Bt])}}),Mt=et.Y.get("DataChannelFileSender"),vt=apiCC.myWebRTC_Event,Ft=1<<17,Ht=function(Gt){this.call=Gt,this.sendChunkNb=0,this.send=function(Tt,nt,Ct){var yt=12e3,Pt={},Et=null,Ut={},Ot=!1,Bt={};if(Mt.info("DataChannelFileSender send"),Mt.log("data.name :"+Tt.name),Tt.file instanceof Blob?(Mt.log("Blob"),this.blob=Tt.file,this.contentType=Tt.file.type,this.size=Tt.file.size,this.originalDataType="Blob"):Tt.file instanceof ArrayBuffer?(Mt.log("ArrayBuffer"),this.blob=Tt.file,this.contentType="application/octet-stream",this.size=Tt.file.byteLength,this.originalDataType="ArrayBuffer"):Tt.file instanceof String||typeof Tt.file=="string"?(Mt.log("string"),this.blob=Tt.file,this.size=Tt.file.length,this.contentType="application/octet-stream",this.originalDataType="String"):(Mt.log("unknown type"),this.blob=Tt.file,this.contentType="application/octet-stream",this.size=Tt.file.length||Tt.file.byteLength||Tt.file.size,this.originalDataType="Unknown"),this.contentType||(this.contentType="application/octet-stream"),this.size===0)return Mt.log("sending done"),Ct!==void 0&&(Mt.log("onProgress"),this.transferDuration=new Date-this.startingDate,Ct({sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Gt.callId,uuid:Tt.uuid,remoteId:Gt.remoteId,lastPacket:Ot,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!0})),vt.createEvent({eventType:"onFileProgress",sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Gt.callId,uuid:Tt.uuid,remoteId:Gt.remoteId,lastPacket:Ot,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!0}),void vt.createEvent({eventType:"onFileSended",callId:Gt.callId,remoteId:Gt.remoteId,name:Tt.name,uuid:Tt.uuid});if(nt)if(nt.readyState==="open"){if(this.sendChunkNb===0&&Mt.log("first packet"),this.sendChunkNb===0){Tt.uuid=(Math.random()*new Date().getTime()).toString(36).replace(/\./g,"-"),Ut={name:Tt.name,type:Tt.type,size:this.size,contentType:this.contentType,uuid:Tt.uuid},Mt.log("first packet",Ut),this.fileSize=this.size,Ct!==void 0&&(Mt.log("onProgress"),this.startingDate=new Date,this.transferDuration=0,Ct({sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Gt.callId,uuid:Tt.uuid,remoteId:Gt.remoteId,lastPacket:Ot,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}),vt.createEvent({eventType:"onFileProgress",sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Gt.callId,uuid:Tt.uuid,remoteId:Gt.remoteId,lastPacket:Ot,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}));try{nt.send(JSON.stringify(Ut))}catch(Qt){Mt.warn("error detected when sending on datachannel :",nt),Mt.warn("error is :",Qt)}vt.createEvent({eventType:"onFileSending",callId:Gt.callId,remoteId:Gt.remoteId,name:Tt.name,uuid:Tt.uuid})}else{yt<this.size?(Mt.log("sending chunk"),Pt=this.blob.slice(0,yt)):(Mt.log("sending last chunk"),Pt=this.blob.slice(0),Ot=!0),Mt.log("dataToSend.byteLength ="+Pt.byteLength),this.originalDataType==="ArrayBuffer"?Bt.message=st.cw.encode(Pt):Bt.message=Pt,Bt.messageSize=Pt.byteLength,Bt.uuid=Tt.uuid,Bt.originalDataType=this.originalDataType,Ct!==void 0&&(Mt.log("onProgress"),this.transferDuration=new Date-this.startingDate,Ct({sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Gt.callId,uuid:Tt.uuid,remoteId:Gt.remoteId,startingDate:this.startingDate,lastPacket:Ot,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}),vt.createEvent({eventType:"onFileProgress",sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:Gt.callId,uuid:Tt.uuid,remoteId:Gt.remoteId,startingDate:this.startingDate,lastPacket:Ot,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}));try{nt.send(JSON.stringify(Bt))}catch(Qt){Mt.warn("error detected when sending on datachannel :",nt),Mt.warn("error is :",Qt)}}Et=this.sendChunkNb===0?this.blob:this.blob.slice(yt),Ot===!1?this.sendChunkNb++:this.sendChunkNb=0,Tt.file=Et,setTimeout((function(){this.send(Tt,nt,Ct)}).bind(this))}else Mt.log("Trying to send on a closed channel");else Mt.log("No data channel to send data")},this.terminateTransfer=function(){var Tt=this;Mt.debug("terminateTransfer; terminated: "+this.terminated),this.channel!==null?this.useBufferedAmount===!0&&this.channel.bufferedAmount>0&&this.canceled!==!0?setTimeout(this.terminateTransfer.bind(this)):this.terminated!==!0&&(this.terminated=!0,this.recvDataEndAckTimeoutId&&(clearTimeout(this.recvDataEndAckTimeoutId),delete this.recvDataEndAckTimeoutId),delete this.call.dcfs,Mt.debug("terminateTransfer; terminating"),this.call.pipelineCallId?(this.call.pipelineCall&&(delete this.call.pipelineCall.clientCall,delete this.call.pipelineCall,this.call.sendDataChannel=null),this.channel=null):setTimeout(function(){Tt.channel.close(),Tt.channel=null}),setTimeout(function(){if(Tt.canceled===!0)vt.createEvent({eventType:"onFileSended",callId:Tt.call.callId,remoteId:Tt.call.remoteId,name:Tt.call.data.filename,error:"canceled"}),Tt.call.callbacks.failure("canceled");else if(Tt.call.failure)vt.createEvent({eventType:"onFileSended",callId:Tt.call.callId,remoteId:Tt.call.remoteId,name:Tt.call.data.filename,error:Tt.call.failure}),Tt.call.callbacks.failure(Tt.call.failure);else{var nt={eventType:"onFileSended",callId:Tt.call.callId,remoteId:Tt.call.remoteId,name:Tt.call.data.filename};Tt.call.success.data&&(nt.data=Tt.call.success.data),vt.createEvent(nt),Tt.call.callbacks.success(Tt.call.success)}apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Tt.call.callId)})):Mt.warn("No data channel to send data, leaving terminateTransfer")},this.recvDataEndAckTimeout=function(){Mt.error("recvDataEndAckTimeout"),this.call.failure="ackNotReceived",setTimeout(this.terminateTransfer.bind(this))},this.subsequentTransfer=function(){var Tt,nt=!1;if(Mt.debug("subsequentTransfer; remByteCount: "+this.remByteCount),this.canceled!==!0)if(this.channel!==null)if(this.useBufferedAmount===!0&&this.channel.bufferedAmount>Ft)setTimeout(this.subsequentTransfer.bind(this));else try{for(;;){if(!(this.remByteCount>=this.chunkLength)){Tt=this.data.slice(this.offset,this.offset+this.remByteCount),this.channel.send(Tt),this.packetsSent+=1,Mt.debug("packetSent "+this.packetsSent+" "+this.remByteCount),this.offset+=this.remByteCount,this.remByteCount-=this.remByteCount,nt=!0;break}if(Tt=this.data.slice(this.offset,this.offset+this.chunkLength),this.channel.send(Tt),this.packetsSent+=1,Mt.debug("packetSent "+this.packetsSent+" "+this.chunkLength),this.offset+=this.chunkLength,this.remByteCount-=this.chunkLength,this.remByteCount<=0){nt=!0;break}if(this.useBufferedAmount!==!0||this.channel.bufferedAmount>Ft)break}nt===!0?(vt.createEvent({eventType:"onFileProgress",name:this.call.data.filename,sendChunkNb:this.packetsSent,fileSize:this.call.data.size,remainingSize:this.remByteCount,callId:this.call.callId,remoteId:this.call.remoteId,percentage:100}),this.call.callbacks.progress({state:"complete",filename:this.call.data.filename,size:this.call.data.size,remBytes:0,progress:100}),this.call.success={state:"complete",filename:this.call.data.filename,size:this.call.data.size,mediaURL:this.call.mediaURL,mediaId:this.call.mediaId},this.recvDataEndAckTimeoutId=setTimeout(this.recvDataEndAckTimeout.bind(this),3e4)):(vt.createEvent({eventType:"onFileProgress",name:this.call.data.filename,sendChunkNb:this.packetsSent,fileSize:this.call.data.size,remainingSize:this.remByteCount,callId:this.call.callId,remoteId:this.call.remoteId,percentage:Math.floor(100*this.offset/this.call.data.size)}),this.call.callbacks.progress({state:"incomplete",filename:this.call.data.filename,size:this.call.data.size,remBytes:this.remByteCount,progress:Math.floor(100*this.offset/this.call.data.size)}),setTimeout(this.subsequentTransfer.bind(this)))}catch(Ct){return Mt.error("transfer: "+Ct),this.call.failure="dataChannelFailed",void setTimeout(this.terminateTransfer.bind(this))}else Mt.warn("No data channel to send data, leaving subsequentTransfer");else setTimeout(this.terminateTransfer.bind(this))},this.transfer=function(Tt,nt,Ct){var yt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},Pt=yt.hasOwnProperty("delay")?yt.delay:100;if(Mt.info("transfer",nt,Pt),this.call.beginTimeoutId&&(clearTimeout(this.call.beginTimeoutId),delete this.call.beginTimeoutId),this.data=Tt,this.channel=Ct,this.channel!==null){typeof this.channel.bufferedAmount=="number"&&this.channel.bufferedAmount>=0&&(Mt.debug("browserDetails",st.wL),st.wL.type==="chrome"?st.wL.version>=37&&(this.useBufferedAmount=!0,Mt.debug("useBufferedAmount enabled")):(this.useBufferedAmount=!0,Mt.debug("useBufferedAmount enabled"))),this.chunkLength=8192,nt>0?(this.offset=Math.floor(nt/this.chunkLength)*this.chunkLength,this.remByteCount=this.data.byteLength-this.offset):(this.offset=0,this.remByteCount=this.data.byteLength),this.packetsSent=0;try{var Et={chunkLength:this.chunkLength,offset:this.offset,remBytes:this.remByteCount};this.call.pipelineCallId&&(Et.pluginName=Gt.data.pluginName,Et.pluginData=Gt.data.pluginData,Gt.data.context&&(Et.context=Gt.data.context)),this.channel.send(JSON.stringify(Et))}catch(Ut){return Mt.error("transfer:",Ut),this.call.failure="dataChannelFailed",void setTimeout(this.terminateTransfer.bind(this))}vt.createEvent({eventType:"onFileSending",callId:this.call.callId,remoteId:this.call.remoteId,name:this.call.data.filename}),setTimeout(this.subsequentTransfer.bind(this),Pt)}else Mt.warn("No data channel to send data, leaving transfer")}},Wt=(et.Y.get("CallStatsMonitor"),function(Gt,Tt,nt,Ct){this.interval=Gt,this.browserType=Tt,this.browserVersion=nt,this.flavor=Ct,this.prevData={},this.prevDataThreshold=10/Gt,this.prevDataThreshold<2&&(this.prevDataThreshold=2),this.STANDARD_STAT_KEYS={audioReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},videoReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteAudioSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteVideoSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},audioSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},videoSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteAudioReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteVideoReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1}},this.refineStats_chrome_proprietary=function(yt,Pt){var Et,Ut;for(Et=0;Et<Pt.length;Et+=1){var Ot=Pt[Et],Bt=null,Qt=null;if(Ot.type==="ssrc"){if(Ot.id.indexOf("recv")>=0){if(Ot.stat("mediaType")==="audio")for(yt.audioReceived={timestamp:Math.floor(Date.parse(Ot.timestamp))/1e3,type:"inbound-rtp",isRemote:!1,mediaType:"audio",packetsReceived:0,bytesReceived:0},Bt=Ot.names(),Ut=0;Ut<Bt.length;Ut+=1)(Qt=Bt[Ut])==="packetsReceived"?yt.audioReceived.packetsReceived=parseInt(Ot.stat("packetsReceived"),10):Qt==="bytesReceived"&&(yt.audioReceived.bytesReceived=parseInt(Ot.stat("bytesReceived"),10));else if(Ot.stat("mediaType")==="video")for(yt.videoReceived={timestamp:Math.floor(Date.parse(Ot.timestamp))/1e3,type:"outbound-rtp",isRemote:!1,mediaType:"video",framesDecoded:0,packetsReceived:0,bytesReceived:0},Bt=Ot.names(),Ut=0;Ut<Bt.length;Ut+=1)(Qt=Bt[Ut])==="framesDecoded"?yt.videoReceived.framesDecoded=parseInt(Ot.stat("framesDecoded"),10):Qt==="packetsReceived"?yt.videoReceived.packetsReceived=parseInt(Ot.stat("packetsReceived"),10):Qt==="bytesReceived"&&(yt.videoReceived.bytesReceived=parseInt(Ot.stat("bytesReceived"),10))}else if(Ot.id.indexOf("send")>=0){if(Ot.stat("mediaType")==="audio")for(yt.audioSent={timestamp:Math.floor(Date.parse(Ot.timestamp))/1e3,type:"outbound-rtp",isRemote:!1,mediaType:"audio",packetsSent:0,bytesSent:0},Bt=Ot.names(),Ut=0;Ut<Bt.length;Ut+=1)(Qt=Bt[Ut])==="packetsSent"?yt.audioSent.packetsSent=parseInt(Ot.stat("packetsSent"),10):Qt==="bytesSent"&&(yt.audioSent.bytesSent=parseInt(Ot.stat("bytesSent"),10));else if(Ot.stat("mediaType")==="video")for(yt.videoSent={timestamp:Math.floor(Date.parse(Ot.timestamp))/1e3,type:"outbound-rtp",isRemote:!1,mediaType:"video",framesEncoded:0,packetsSent:0,bytesSent:0},Bt=Ot.names(),Ut=0;Ut<Bt.length;Ut+=1)(Qt=Bt[Ut])==="framesEncoded"?yt.videoSent.framesEncoded=parseInt(Ot.stat("framesEncoded"),10):Qt==="packetsSent"?yt.videoSent.packetsSent=parseInt(Ot.stat("packetsSent"),10):Qt==="bytesSent"&&(yt.videoSent.bytesSent=parseInt(Ot.stat("bytesSent"),10))}}}return!1},this.refineStats_chrome_legacy=function(yt,Pt){var Et=!1;return Pt.forEach(function(Ut){var Ot=null,Bt=null;if(Ut.type==="ssrc"&&Ut.id.indexOf("recv")>=0){if(Ut.mediaType==="audio"){for(Bt in yt.audioReceived={},Ot=Math.floor(Date.parse(Ut.timestamp)/1e3),Ut)Bt==="timestamp"?yt.audioReceived.timestamp=Ot:yt.audioReceived[Bt]=Ut[Bt];Et=!0}else if(Ut.mediaType==="video"){for(Bt in yt.videoReceived={},Ot=Math.floor(Date.parse(Ut.timestamp)/1e3),Ut)Bt==="timestamp"?yt.videoReceived.timestamp=Ot:yt.videoReceived[Bt]=Ut[Bt];Et=!0}}else if(Ut.type==="ssrc"&&Ut.id.indexOf("send")>=0){if(Ut.mediaType==="audio"){for(Bt in yt.audioSent={},Ot=Math.floor(Date.parse(Ut.timestamp)/1e3),Ut)Bt==="timestamp"?yt.audioSent.timestamp=Ot:yt.audioSent[Bt]=Ut[Bt];Et=!0}else if(Ut.mediaType==="video"){for(Bt in yt.videoSent={},Ot=Math.floor(Date.parse(Ut.timestamp)/1e3),Ut)Bt==="timestamp"?yt.videoSent.timestamp=Ot:yt.videoSent[Bt]=Ut[Bt];Et=!0}}}),Et},this.refineStats_chrome_58=function(yt,Pt){var Et=this,Ut=!1;return Pt.forEach(function(Ot){if(Ot.type!=="inbound-rtp"||Ot.isRemote){if(Ot.type==="outbound-rtp"&&!Ot.isRemote){if(Ot.mediaType==="audio"){yt.audioSent={};var Bt=Math.floor(Ot.timestamp/1e3);for(var Qt in Ot)Et.STANDARD_STAT_KEYS.audioSent[Qt]!==!1&&(Qt==="timestamp"?yt.audioSent.timestamp=Bt:yt.audioSent[Qt]=Ot[Qt]);Ut=!0}else if(Ot.mediaType==="video"){yt.videoSent={};var en=Math.floor(Ot.timestamp/1e3);for(var Jt in Ot)Et.STANDARD_STAT_KEYS.videoSent[Jt]!==!1&&(Jt==="timestamp"?yt.videoSent.timestamp=en:yt.videoSent[Jt]=Ot[Jt]);Ut=!0}}}else if(Ot.mediaType==="audio"||Ot.id.indexOf("Audio")>=0){yt.audioReceived={};var an=Math.floor(Ot.timestamp/1e3);for(var hn in Ot)Et.STANDARD_STAT_KEYS.audioReceived[hn]!==!1&&(hn==="timestamp"?yt.audioReceived.timestamp=an:yt.audioReceived[hn]=Ot[hn]);Ut=!0}else if(Ot.mediaType==="video"||Ot.id.indexOf("Video")>=0){yt.videoReceived={};var rn=Math.floor(Ot.timestamp/1e3);for(var dn in Ot)Et.STANDARD_STAT_KEYS.videoReceived[dn]!==!1&&(dn==="timestamp"?yt.videoReceived.timestamp=rn:yt.videoReceived[dn]=Ot[dn]);Ut=!0}}),Ut},this.refineStats_firefox_legacy=function(yt,Pt){var Et=!1,Ut=this;return Pt.forEach(function(Ot){var Bt=null,Qt=null;if(Ot.type==="inbound-rtp"&&Ot.isRemote===!1){if(Ot.mediaType==="audio"){for(Bt in yt.audioReceived={packetsReceived:0,bytesReceived:0},Qt=Math.floor(Ot.timestamp/1e3),Ot)Ut.STANDARD_STAT_KEYS.audioReceived[Bt]!==!1&&(Bt==="timestamp"?yt.audioReceived.timestamp=Qt:yt.audioReceived[Bt]=Ot[Bt]);Et=!0}else if(Ot.mediaType==="video"){for(Bt in yt.videoReceived={packetsReceived:0,bytesReceived:0,framesDecoded:0},Qt=Math.floor(Ot.timestamp/1e3),Ot)Ut.STANDARD_STAT_KEYS.videoReceived[Bt]!==!1&&(Bt==="timestamp"?yt.videoReceived.timestamp=Qt:yt.videoReceived[Bt]=Ot[Bt]);Et=!0}}else if(Ot.type==="outbound-rtp"&&Ot.isRemote===!1){if(Ot.mediaType==="audio"){for(Bt in yt.audioSent={packetsSent:0,bytesSent:0},Qt=Math.floor(Ot.timestamp/1e3),Ot)Ut.STANDARD_STAT_KEYS.audioSent[Bt]!==!1&&(Bt==="timestamp"?yt.audioSent.timestamp=Qt:yt.audioSent[Bt]=Ot[Bt]);Et=!0}else if(Ot.mediaType==="video"){for(Bt in yt.videoSent={packetsSent:0,bytesSent:0,framesEncoded:0},Qt=Math.floor(Ot.timestamp/1e3),Ot)Ut.STANDARD_STAT_KEYS.videoSent[Bt]!==!1&&(Bt==="timestamp"?yt.videoSent.timestamp=Qt:yt.videoSent[Bt]=Ot[Bt]);Et=!0}}}),Et},this.refineStats_firefox_63=function(yt,Pt){var Et=!1,Ut=this;return Pt.forEach(function(Ot){if(Ot.type!=="inbound-rtp"||Ot.isRemote){if(Ot.type==="outbound-rtp"&&!Ot.isRemote){if(Ot.kind==="audio"){yt.audioSent={packetsSent:0,bytesSent:0};var Bt=Math.floor(Ot.timestamp/1e3);for(var Qt in Ot)Ut.STANDARD_STAT_KEYS.audioSent[Qt]!==!1&&(Qt==="timestamp"?yt.audioSent.timestamp=Bt:yt.audioSent[Qt]=Ot[Qt]);Et=!0}else if(Ot.kind==="video"){yt.videoSent={packetsSent:0,bytesSent:0,framesEncoded:0};var en=Math.floor(Ot.timestamp/1e3);for(var Jt in Ot)Ut.STANDARD_STAT_KEYS.videoSent[Jt]!==!1&&(Jt==="timestamp"?yt.videoSent.timestamp=en:yt.videoSent[Jt]=Ot[Jt]);Et=!0}}}else if(Ot.kind==="audio"){yt.audioReceived={packetsReceived:0,bytesReceived:0};var an=Math.floor(Ot.timestamp/1e3);for(var hn in Ot)Ut.STANDARD_STAT_KEYS.audioReceived[hn]!==!1&&(hn==="timestamp"?yt.audioReceived.timestamp=an:yt.audioReceived[hn]=Ot[hn]);Et=!0}else if(Ot.kind==="video"){yt.videoReceived={packetsReceived:0,bytesReceived:0,framesDecoded:0};var rn=Math.floor(Ot.timestamp/1e3);for(var dn in Ot)Ut.STANDARD_STAT_KEYS.videoReceived[dn]!==!1&&(dn==="timestamp"?yt.videoReceived.timestamp=rn:yt.videoReceived[dn]=Ot[dn]);Et=!0}}),Et},this.addCallStats=function(yt){var Pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Et={};if(this.refineStats!==void 0){if(this.refineStats(Et,yt),Et.audioReceived!==void 0){if(this.prevData.audioReceived!==void 0){var Ut=Et.audioReceived.timestamp-this.prevData.audioReceived[0].timestamp;Ut>0?(Et.audioReceived.packetsReceivedPerSecond===void 0&&(Et.audioReceived.packetsReceivedPerSecond=Math.floor((Et.audioReceived.packetsReceived-this.prevData.audioReceived[0].packetsReceived)/Ut)),Et.audioReceived.bitsReceivedPerSecond===void 0&&(Et.audioReceived.bitsReceivedPerSecond=Math.floor(8*(Et.audioReceived.bytesReceived-this.prevData.audioReceived[0].bytesReceived)/Ut)),Et.audioReceived.packetsLostPerSecond===void 0&&(Et.audioReceived.packetsLostPerSecond=Math.floor((Et.audioReceived.packetsLost-this.prevData.audioReceived[0].packetsLost)/Ut)),Et.audioReceived.packetLossRatio===void 0&&(Et.audioReceived.packetLossRatio=100*(Et.audioReceived.packetsLost-this.prevData.audioReceived[0].packetsLost)/(Et.audioReceived.packetsReceived-this.prevData.audioReceived[0].packetsReceived)),Et.audioReceived.samplingInterval=Ut):(Et.audioReceived.packetsReceivedPerSecond===void 0&&(Et.audioReceived.packetsReceivedPerSecond=0),Et.audioReceived.bitsReceivedPerSecond===void 0&&(Et.audioReceived.bitsReceivedPerSecond=0),Et.audioReceived.packetsLostPerSecond===void 0&&(Et.audioReceived.packetsLostPerSecond=0),Et.audioReceived.packetLossRatio===void 0&&(Et.audioReceived.packetLossRatio=0),Et.audioReceived.samplingInterval=0)}else Et.audioReceived.packetsReceivedPerSecond===void 0&&(Et.audioReceived.packetsReceivedPerSecond=0),Et.audioReceived.bitsReceivedPerSecond===void 0&&(Et.audioReceived.bitsReceivedPerSecond=0),Et.audioReceived.packetsLostPerSecond===void 0&&(Et.audioReceived.packetsLostPerSecond=0),Et.audioReceived.packetLossRatio===void 0&&(Et.audioReceived.packetLossRatio=0),Et.audioReceived.samplingInterval=0,this.prevData.audioReceived=[];for(this.prevData.audioReceived.push(Et.audioReceived);this.prevData.audioReceived.length>this.prevDataThreshold;)this.prevData.audioReceived.shift()}if(Et.videoReceived!==void 0){if(this.prevData.videoReceived!==void 0){var Ot=Et.videoReceived.timestamp-this.prevData.videoReceived[0].timestamp;Ot>0?(Et.videoReceived.packetsReceivedPerSecond===void 0&&(Et.videoReceived.packetsReceivedPerSecond=Math.floor((Et.videoReceived.packetsReceived-this.prevData.videoReceived[0].packetsReceived)/Ot)),Et.videoReceived.bitsReceivedPerSecond===void 0&&(Et.videoReceived.bitsReceivedPerSecond=Math.floor(8*(Et.videoReceived.bytesReceived-this.prevData.videoReceived[0].bytesReceived)/Ot)),Et.videoReceived.packetsLostPerSecond===void 0&&(Et.videoReceived.packetsLostPerSecond=Math.floor((Et.videoReceived.packetsLost-this.prevData.videoReceived[0].packetsLost)/Ot)),Et.videoReceived.framesDecodedPerSecond===void 0&&(Et.videoReceived.framesDecodedPerSecond=Math.floor((Et.videoReceived.framesDecoded-this.prevData.videoReceived[0].framesDecoded)/Ot)),Et.videoReceived.packetLossRatio===void 0&&(Et.videoReceived.packetLossRatio=100*(Et.videoReceived.packetsLost-this.prevData.videoReceived[0].packetsLost)/(Et.videoReceived.packetsReceived-this.prevData.videoReceived[0].packetsReceived)),Et.videoReceived.samplingInterval=Ot):(Et.videoReceived.packetsReceivedPerSecond===void 0&&(Et.videoReceived.packetsReceivedPerSecond=0),Et.videoReceived.bitsReceivedPerSecond===void 0&&(Et.videoReceived.bitsReceivedPerSecond=0),Et.videoReceived.packetsLostPerSecond===void 0&&(Et.videoReceived.packetsLostPerSecond=0),Et.videoReceived.framesDecodedPerSecond===void 0&&(Et.videoReceived.framesDecodedPerSecond=0),Et.videoReceived.packetLossRatio===void 0&&(Et.videoReceived.packetLossRatio=0),Et.videoReceived.samplingInterval=0)}else Et.videoReceived.packetsReceivedPerSecond===void 0&&(Et.videoReceived.packetsReceivedPerSecond=0),Et.videoReceived.bitsReceivedPerSecond===void 0&&(Et.videoReceived.bitsReceivedPerSecond=0),Et.videoReceived.packetsLostPerSecond===void 0&&(Et.videoReceived.packetsLostPerSecond=0),Et.videoReceived.framesDecodedPerSecond===void 0&&(Et.videoReceived.framesDecodedPerSecond=0),Et.videoReceived.packetLossRatio===void 0&&(Et.videoReceived.packetLossRatio=0),Et.videoReceived.samplingInterval=0,this.prevData.videoReceived=[];for(this.prevData.videoReceived.push(Et.videoReceived);this.prevData.videoReceived.length>this.prevDataThreshold;)this.prevData.videoReceived.shift()}if(Et.audioSent!==void 0){if(this.prevData.audioSent!==void 0){var Bt=Et.audioSent.timestamp-this.prevData.audioSent[0].timestamp;Bt>0?(Et.audioSent.packetsSentPerSecond===void 0&&(Et.audioSent.packetsSentPerSecond=Math.floor((Et.audioSent.packetsSent-this.prevData.audioSent[0].packetsSent)/Bt)),Et.audioSent.bitsSentPerSecond===void 0&&(Et.audioSent.bitsSentPerSecond=Math.floor(8*(Et.audioSent.bytesSent-this.prevData.audioSent[0].bytesSent)/Bt)),Et.audioSent.samplingInterval=Bt):(Et.audioSent.packetsSentPerSecond===void 0&&(Et.audioSent.packetsSentPerSecond=0),Et.audioSent.bitsSentPerSecond===void 0&&(Et.audioSent.bitsSentPerSecond=0),Et.audioSent.samplingInterval=0)}else Et.audioSent.packetsSentPerSecond===void 0&&(Et.audioSent.packetsSentPerSecond=0),Et.audioSent.bitsSentPerSecond===void 0&&(Et.audioSent.bitsSentPerSecond=0),Et.audioSent.samplingInterval=0,this.prevData.audioSent=[];for(this.prevData.audioSent.push(Et.audioSent);this.prevData.audioSent.length>this.prevDataThreshold;)this.prevData.audioSent.shift()}if(Et.videoSent!==void 0){if(this.prevData.videoSent!==void 0){var Qt=Et.videoSent.timestamp-this.prevData.videoSent[0].timestamp;Qt>0?(Et.videoSent.packetsSentPerSecond===void 0&&(Et.videoSent.packetsSentPerSecond=Math.floor((Et.videoSent.packetsSent-this.prevData.videoSent[0].packetsSent)/Qt)),Et.videoSent.bitsSentPerSecond===void 0&&(Et.videoSent.bitsSentPerSecond=Math.floor(8*(Et.videoSent.bytesSent-this.prevData.videoSent[0].bytesSent)/Qt)),Et.videoSent.framesEncodedPerSecond===void 0&&(Et.videoSent.framesEncodedPerSecond=Math.floor((Et.videoSent.framesEncoded-this.prevData.videoSent[0].framesEncoded)/Qt)),Et.videoSent.samplingInterval=Qt):(Et.videoSent.packetsSentPerSecond===void 0&&(Et.videoSent.packetsSentPerSecond=0),Et.videoSent.bitsSentPerSecond===void 0&&(Et.videoSent.bitsSentPerSecond=0),Et.videoSent.framesEncodedPerSecond===void 0&&(Et.videoSent.framesEncodedPerSecond=0),Et.videoSent.samplingInterval=0)}else Et.videoSent.packetsSentPerSecond===void 0&&(Et.videoSent.packetsSentPerSecond=0),Et.videoSent.bitsSentPerSecond===void 0&&(Et.videoSent.bitsSentPerSecond=0),Et.videoSent.framesEncodedPerSecond===void 0&&(Et.videoSent.framesEncodedPerSecond=0),Et.videoSent.samplingInterval=0,this.prevData.videoSent=[];for(this.prevData.videoSent.push(Et.videoSent);this.prevData.videoSent.length>this.prevDataThreshold;)this.prevData.videoSent.shift()}}return Object.keys(Et).length>0&&typeof Pt.post=="function"&&Pt.post(Et),Et},this.browserType==="chrome"?Ct==="proprietary"?this.refineStats=this.refineStats_chrome_proprietary:this.browserVersion>=58?this.refineStats=this.refineStats_chrome_58:this.refineStats=this.refineStats_chrome_legacy:this.browserType==="firefox"?this.browserVersion>=63?this.refineStats=this.refineStats_firefox_63:this.refineStats=this.refineStats_firefox_legacy:this.browserType==="safari"&&(this.refineStats=this.refineStats_chrome_58)}),tn=(s(658),function(){this.NarrowBandSpeechQuality=function(Gt,Tt){var nt,Ct,yt=1,Pt=1+Gt/10,Et=1+Gt/150,Ut=(94.769-(nt=80+2.5*(65-40*Math.log10(Pt/Et)+6*Math.exp(Gt*Gt*-.3)-14)))*(94.769-nt)/4+100;return(Ct=93.193-((94.769-nt)/2+Math.sqrt(Ut)-1)*(1-Math.exp(-Gt))-(0+Tt/(Tt+4.3)*95))<0&&(yt=1),Ct<100&Ct>0&&(yt=1+.035*Ct+Ct*(Ct-60)*(100-Ct)*7*1e-6),Ct>100&&(yt=4.5),yt},this.WideBandspeechQuality=function(Gt,Tt){var nt,Ct,yt,Pt=0,Et=1;Gt<100&&(Pt=.08-Gt+10),Gt>=100&&(Pt=18);var Ut=1+Gt/10,Ot=1+Gt/150,Bt=(129-(nt=80+3*(65+Pt-40*Math.log10(Ut/Ot)+6*Math.exp(Gt*Gt*-.3)-14)))*(129-nt)/4+100;return(yt=(Ct=129-((129-nt)/2+Math.sqrt(Bt)-1)*(1-Math.exp(-Gt))-(0+Tt/(Tt+4.3)*95))/1.29)<=0&&(Et=1),yt<100&yt>0&&(Et=1+.035*Ct+Ct*(Ct-60)*(100-Ct)*7*1e-6),yt>=100&&(Et=4.5),Et},this.videoQuality=function(Gt,Tt,nt,Ct,yt){var Pt,Et,Ut,Ot,Bt,Qt,en,Jt,an;return an=Tt>720?[0,2.77,.009,3.95,460,1.28,2.12,32e-5,1.28,262,1.98,22.84,7.999]:Tt>576?[0,6.31,.008,3.68,262,1.28,1.97,33e-5,1.24,343,2.76,6.25,6.013]:Tt>480?[0,6.96,.007,3.58,214,1.2,1.75,63e-5,1.13,171,4.25,7.98,12.001]:Tt>288?[0,5.61,.01,3.38,182,1.31,2.23,75e-5,1.51,136,4.05,20.16,22.332]:[0,3.988,.013,3.625,89.25,1.125,.713,0,1.542,245.5,3.011,39.31,16.67],Qt=1+Math.pow(Ct/an[4],an[5]),Pt=an[3]-an[3]/Qt,Et=an[1]+an[2]*Ct,Ut=an[6]+an[7]*Ct,en=Math.pow(Math.log(yt)-Math.log(Et),2),Jt=2*Math.pow(Ut,2),Ot=Pt*Math.exp(-en/Jt),Bt=an[10]+an[11]*Math.exp(-yt/an[8])+an[12]*Math.exp(-Ct/an[9]),1+Ot*Math.exp(-nt/Bt)},this.audiovisualQuality=function(Gt,Tt,nt,Ct){var yt,Pt,Et,Ut,Ot;return Gt>0&&Tt>0?(yt=(Ot=[0,-.6966,-.8127,.4562,3.003,-.1638,.3626,.1291,.5457,-1251e-7,3.763,-.001065,.01465,-.001002,0])[9]*(nt+Ct)+Ot[10],nt>=Ct&&(Pt=Math.min(Ot[11]*(nt-Ct)+Ot[12],0)),nt<Ct&&(Pt=Math.min(Ot[13]*(Ct-nt)+Ot[14],0)),Et=Math.max(yt+Pt,1),Ot[1]*(Ut=Ot[5]*Gt+Ot[6]*Tt+Ot[7]*Gt*Tt+Ot[8])+Ot[2]*Et+Ot[3]*Ut*Et+Ot[4]):"NoAudiovisualStream"}});function gn(Gt,Tt){var nt=typeof Symbol<"u"&&Gt[Symbol.iterator]||Gt["@@iterator"];if(!nt){if(Array.isArray(Gt)||(nt=function(Ot,Bt){if(Ot){if(typeof Ot=="string")return nn(Ot,Bt);var Qt=Object.prototype.toString.call(Ot).slice(8,-1);return Qt==="Object"&&Ot.constructor&&(Qt=Ot.constructor.name),Qt==="Map"||Qt==="Set"?Array.from(Ot):Qt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Qt)?nn(Ot,Bt):void 0}}(Gt))||Tt&&Gt&&typeof Gt.length=="number"){nt&&(Gt=nt);var Ct=0,yt=function(){};return{s:yt,n:function(){return Ct>=Gt.length?{done:!0}:{done:!1,value:Gt[Ct++]}},e:function(Ot){throw Ot},f:yt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Pt,Et=!0,Ut=!1;return{s:function(){nt=nt.call(Gt)},n:function(){var Ot=nt.next();return Et=Ot.done,Ot},e:function(Ot){Ut=!0,Pt=Ot},f:function(){try{Et||nt.return==null||nt.return()}finally{if(Ut)throw Pt}}}}function nn(Gt,Tt){(Tt==null||Tt>Gt.length)&&(Tt=Gt.length);for(var nt=0,Ct=new Array(Tt);nt<Tt;nt++)Ct[nt]=Gt[nt];return Ct}var qt=et.Y.get("WebRTC_Call"),fn=apiCC.myWebRTC_Event,Cn=function(Gt){this.dest_roomId="",this.pc=null,this.callId=0,this.callee=!1,this.callerId=0,this.calleeId=0,this.started=!1,this.localDescriptionSetted=!1,this.remoteDescriptionSetted=!1,this.sendedSdpOfferMessage=null,this.receivedSdpOfferMessage=null,this.myWebRTC_Stack=new Rt.S(Gt.socket),this.remoteMediaStreams=[],this.rtpSenders={audio:[],video:[]},this.addingUserMedia=!1,this.myWebRTC_Event=apiCC.myWebRTC_Event,this.dtmfSender=null,this.incomingcandidatesQueue=[],ot.Xh==="Firefox"?ot.PR>43?(this.mediaConstraintsAudioOnly={offerToReceiveAudio:!0,offerToReceiveVideo:!1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}):(this.mediaConstraintsAudioOnly={mandatory:{offerToReceiveAudio:!0,offerToReceiveVideo:!1}},this.mediaConstraints={mandatory:{offerToReceiveAudio:!0,offerToReceiveVideo:!0}}):ot.Xh==="Chrome"?ot.PR<55?(this.mediaConstraintsAudioOnly={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},this.mediaConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}}):(this.mediaConstraintsAudioOnly={offerToReceiveAudio:1,offerToReceiveVideo:1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}):ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"?(this.mediaConstraintsAudioOnly={offerToReceiveAudio:!0,offerToReceiveVideo:!1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}):(this.mediaConstraintsAudioOnly={offerToReceiveAudio:1,offerToReceiveVideo:1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}),ot.ag.name==="iOS"&&(qt.log("Defining mediaConstraints for iOS "),this.mediaConstraints={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),this.trickleIce=Gt.trickleIce,this.callLocalStream=null,this.generatedLocalStream=!1,this.audioOnly=!1,this.inviteSended=!1,this.sendInviteTrickleIceFalseTimeOutId=0,this.sendInviteTrickleIceFalseTimer=5e3,this.message200OKSended=!1,this.send200OKTrickleIceFalseTimeOutId=0,this.send200OKTrickleIceFalseTimer=5e3,this.message200OKReceived=!1,this.callCancelled=!1,this.screenSharing=!1,this.desktopId=0,this.pc_config=Gt.pc_config,this.pc_constraints=Gt.pc_constraints,this.audioFileMediaElement=null,this.videoReceivedWidth=640,this.videoReceivedHeight=480,this.videoSendWidth=640,this.videoSendHeight=480,this.videoReceivedDelay=0,this.audioReceivedDelay=0,this.audioSendDelay=0,this.videoSendDelay=0,this.videoSendPacketLossRatio=0,this.audioSendPacketLossRatio=0,this.getStatsInterval=Gt.qosInterval,this.qm=null,this.statisticId=null,this.csmIntervalMs=Gt.csmIntervalMs,this.csmIntervalId=null,this.remoteId=0,this.callType="media",this.localCallProfile={audio:!1,audioActive:!1,video:!1,videoActive:!1},this.remoteCallProfile={audio:!1,audioActive:!1,video:!1,videoActive:!1},this.disconnectionTimeoutId=0,this.disconnectionTimer=4e4,this.disconnectionWarningDelay=9e3,this.disconnectionWarningInterval=0,this.disconnectionWarningTimeout=0,this.disconnectionWarningCount=0,this.checkCandidateTypesTimer=1e4,this.checkCandidateTypesTimeoutId=0,this.checkCandidateTypesTimeoutTable=[],this.data={},this.screenStream=null,this.screenIsDisplayed=!1,this.addingDataChannelOnCallOngoing=!1,this.sendDataChannel=null,this.receiveDataChannel=null,this.receiveChunkNb={},this.firstDataPacket={},this.receivedSize={},this.receiveArrayToStoreChunks={},this.destCallType="media",this.mcuRemoteStream=null,this.userMediaAccessRequired=!0,this.settingUpMode="normal",this.remoteType="web",this.mediaTypeForIncomingCall=Gt.mediaTypeForIncomingCall,this.mediaTypeForOutgoingCall=Gt.mediaTypeForOutgoingCall,this.mediaRoutingMode=Gt.mediaRoutingMode,this.stripAudioSDPActivated=!1,this.stripVideoSDPActivated=!1,this.iceState="notdefined",this.restarted=!1,this.audioSdpDirection=null,this.videoSdpDirection=null,this.isLocalAudioMuted=!1,this.isLocalVideoMuted=!1,this.isRemoteAudioMuted=!1,this.isRemoteVideoMuted=!1,this.isRemoteAudioSilent=!1,this.isRemoteVideoSilent=!1,this.isAccepted=!1,this.accessToMedia=!1,this.callConfiguration=null,this.captureSourceType=null,this.preferH264Codec=!1,this.preferVP8Codec=!1,this.preferVP9Codec=!1,this.candidateNb=0,this.sessionMCU=null,this.instanceId=0,this.retryUpdateMedia=!1,this.updateMediaOngoing=!1,this.setCallTurnServer=function(Tt){qt.info("setCallTurnServer :",Tt);var nt=JSON.stringify(this.pc_config);nt=nt.replace(/mp1.apizee.com/g,Tt),this.pc_config=JSON.parse(nt)},this.setCallMediaRoutingMode=function(Tt){qt.info("setCallMediaRoutingMode :",Tt),Tt==="hostOnly"?this.mediaRoutingMode=Gt.mediaRoutingModeEnum.hostOnly:Tt==="stun"?this.mediaRoutingMode=Gt.mediaRoutingModeEnum.stun:Tt==="stunOnly"?this.mediaRoutingMode=Gt.mediaRoutingModeEnum.stunOnly:Tt==="turn"?this.mediaRoutingMode=Gt.mediaRoutingModeEnum.turn:Tt==="turnOnly"?this.mediaRoutingMode=Gt.mediaRoutingModeEnum.turnOnly:(qt.log("parameter error when calling function : setCallMediaRoutingMode()"),this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setCallMediaRoutingMode()","PARAMETER_ERROR_SETCALLMEDIAROUTINGMODE"))},this.checkDTLSCompliancy=function(){if(qt.debug("checkDTLSCompliancy"),apiCC.session.isDeviceDTLSCompliant()===!1)qt.log("Device not DTLS compliant, setting DtlsSrtpKeyAgreement: false"),this.pc_constraints={optional:[{DtlsSrtpKeyAgreement:!1}]};else{var Tt=apiCC.session.isClientDTLSCompliant(this.remoteId);Tt!==!1&&Tt!=="false"||(qt.log("Remote Device not DTLS compliant, setting DtlsSrtpKeyAgreement: false"),this.pc_constraints={optional:[{DtlsSrtpKeyAgreement:!1}]})}},this.sendData=function(Tt,nt){qt.info("datachannel - sendData");var Ct=null,yt=null;if(Tt.file instanceof File)return qt.log("File"),this.contentType=Tt.file.type,this.originalDataType="File",Ct=new FileReader,yt=this,Ct.onload=function(Pt){var Et=Pt.target.result||Ct.result;yt.sendData({file:Et,name:Tt.name,type:Tt.type},nt)},void Ct.readAsArrayBuffer(Tt.file);new Ht(this).send(Tt,this.sendDataChannel,nt)},qt.log("New Call for client with Id :"+Gt.clientId),this.generateCallId=function(){this.callId=apiCC.generateCallId(),qt.info("new call with callId :"+this.callId)},this.sendInviteTrickleIceFalse=function(){qt.log("sendInviteTrickleIceFalse"),qt.log("sendInvite on candidate timer reached"),this.myWebRTC_Stack.sendInvite(this.callId,this.callerId,Gt.nickname,this.dest_roomId,this.dest_roomId,this.callType,{offer:this.pc.localDescription,data:this.data,stream:this.mcuRemoteStream,volatile:!!this.restarted}),this.inviteSended=!0},this.send200OkTrickleIceFalse=function(){qt.log("send200OkTrickleIceFalse"),this.myWebRTC_Stack.send200OK(this.callId,this.callerId,this.calleeId,Gt.nickname,this.dest_roomId,this.pc.localDescription,this.data),this.message200OKSended=!0},this.onSetLocalDescriptionSuccess=function(){qt.info("onSetLocalDescriptionSuccess"),this.localDescriptionSetted=!0,this.asyncCallbacks&&this.asyncCallbacks.type==="subscribe"&&delete this.asyncCallbacks,this.trickleIce===!1&&(this.callee===!0?(qt.info("starting send200OKTrickleIceFalseTimeOutId"),this.send200OKTrickleIceFalseTimeOutId=setTimeout(this.callback(this,"send200OkTrickleIceFalse"),this.send200OKTrickleIceFalseTimer)):(qt.info("starting sendInviteTrickleIceFalseTimeOutId"),this.sendInviteTrickleIceFalseTimeOutId=setTimeout(this.callback(this,"sendInviteTrickleIceFalse"),this.sendInviteTrickleIceFalseTimer))),Gt.rtpSenderSetParamatersCapable&&Gt.evaluateVideoCap(this)},this.onSetLocalDescriptionFailure=function(Tt){qt.warn("onSetLocalDescriptionFailure",Tt);var nt=null,Ct=null;this.callControl&&(nt=this.callControl.roomName,Ct=this.callControl.type),fn.createErrorEvent("Set local Description Failure","SET_LOCAL_DESCRIPTION_FAILURE",this.callId,nt,Ct),Gt.onHangup(this.callId,"Local_Description_Failure")},this.onSetRemoteDescriptionSuccess=function(){qt.info("onSetRemoteDescriptionSuccess");var Tt=null;for(this.remoteDescriptionSetted=!0,this.restarting===!0&&delete this.restarting,this.data&&(this.data.mesh||this.data.subscribeOrder)||fn.createCallEstablishedEvent(this.calleeId,this.callType,this.callId,this.destCallType);this.incomingcandidatesQueue.length;)Tt=this.incomingcandidatesQueue.shift(),this.processCandidateMsg(Tt);if(Gt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId]!==void 0){for(qt.debug("Restoring candidate from client, this.callId :"+this.callId+" , instanceId :"+this.instanceId);Gt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId].length;)Tt=Gt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId].shift(),this.processCandidateMsg(Tt);delete Gt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId]}if(this.asyncCallbacks&&(this.asyncCallbacks.type==="addingUserMedia"?(this.asyncCallbacks.resolve(this.callConfiguration.userMediaStreamId),this.asyncCallbacks.timeoutId&&(clearTimeout(this.asyncCallbacks.timeoutId),delete this.asyncCallbacks.timeoutId),delete this.asyncCallbacks):this.asyncCallbacks.type==="updateCallConfiguration"&&(this.asyncCallbacks.resolve(),this.asyncCallbacks.timeoutId&&(clearTimeout(this.asyncCallbacks.timeoutId),delete this.asyncCallbacks.timeoutId),delete this.asyncCallbacks)),this.updateMediaOngoing=!1,this.retryUpdateMedia===!0){qt.debug("an updateMedia was waiting for sig stable state or an other updateMedia end, updating Media now ..."),this.retryUpdateMedia=!1;var nt=this.updateMedia(!1);qt.debug("Retried updateMediaResult :",nt)}},this.processCandidateMsg=function(Tt){qt.info("processCandidateMsg :",Tt);var nt=null;this.pc!==null?(Tt.completeCandidate!==void 0?(qt.trace("new behavior of 2.13.8"),nt=new apiCC.myWebRTC_Adapter.RTCIceCandidate(Tt.completeCandidate)):(qt.log("old behavior < 2.13.8"),nt=new apiCC.myWebRTC_Adapter.RTCIceCandidate({sdpMLineIndex:Tt.label,candidate:Tt.candidate})),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("addIceCandidate"),this.pc.addIceCandidate(nt,function(){qt.trace("addIceCandidate success")},function(Ct){qt.warn("addIceCandidate failure: "+Ct),Ct=null})):(qt.log("addIceCandidate - Promise version"),this.pc.addIceCandidate(nt).then(function(){qt.trace("addIceCandidate success")}).catch(function(Ct){qt.warn("addIceCandidate failure: "+Ct),Ct=null}))):qt.error("Error, call is not null but pc is null")},this.onSetRemoteDescriptionFailure=function(Tt){qt.warn("onSetRemoteDescriptionFailure :",Tt);var nt=null,Ct=null;this.callControl&&(nt=this.callControl.roomName,Ct=this.callControl.type),fn.createErrorEvent("Set remote Description Failure","SET_REMOTE_DESCRIPTION_FAILURE",this.callId,nt,Ct),Gt.onHangup(this.callId,"Remote_Description_Failure")},this.getUserMediaOnCall=function(){var Tt=this,nt=!1;if(qt.info("getUserMediaOnCall, audio Only :"+this.audioOnly),qt.info("getUserMediaOnCall, screenSharing activated :"+this.screenSharing),qt.log("webRTCClient.gum_config :",Gt.gum_config),this.callerId===Gt.clientId){if(qt.log("outgoing call"),this.mediaTypeForOutgoingCall==="VIDEO"||this.mediaTypeForOutgoingCall==="VIDEOONLY")if(qt.log("mediaTypeForOutgoingCall :"+this.mediaTypeForOutgoingCall),this.mediaTypeForOutgoingCall==="VIDEOONLY"&&(nt=!0),this.screenSharing!==!0){if(apiCC.mediaDeviceMgr.videoDevicePresent===!1){if(apiCC.mediaDeviceMgr.audioDevicePresent===!1)return qt.log("getUserMediaOnCall without any device, calling without device"),void this.onUserMediaSuccessOnCall();qt.log("video is not present :"+this.callType),this.callType==="media"&&(qt.log("callType is media, but no webcam present, forcing callType to audio"),this.callType="audio",this.audioOnly=!0)}}else qt.log("screenSharing, no device checking");else if(this.mediaTypeForOutgoingCall==="AUDIO")qt.log("mediaTypeForOutgoingCall is AUDIO, setting call to audioOnly"),this.callType="audio",this.audioOnly=!0;else if(this.mediaTypeForOutgoingCall==="NONE"||this.mediaTypeForOutgoingCall==="DATA")return qt.log("mediaTypeForOutgoingCall is NONE, call will be recvOnly"),void this.onUserMediaSuccessOnCall()}else if(qt.log("incoming call"),this.mediaTypeForIncomingCall==="VIDEO"||this.mediaTypeForIncomingCall==="VIDEOONLY"){if(qt.log("mediaTypeForIncomingCall :"+this.mediaTypeForIncomingCall),this.mediaTypeForIncomingCall==="VIDEOONLY"&&(nt=!0),apiCC.mediaDeviceMgr.videoDevicePresent===!1){if(apiCC.mediaDeviceMgr.audioDevicePresent===!1)return qt.log("getUserMediaOnCall without any device, calling without device"),void this.onUserMediaSuccessOnCall();qt.log("video is not present :"+this.callType),this.callType==="media"&&(qt.log("callType is media, but no webcam present, forcing callType to audio"),this.callType="audio",this.audioOnly=!0)}}else if(this.mediaTypeForIncomingCall==="AUDIO")qt.log("mediaTypeForIncomingCall is AUDIO, setting call to audioOnly"),this.callType="audio",this.audioOnly=!0;else if(this.mediaTypeForIncomingCall==="NONE"||this.mediaTypeForIncomingCall==="DATA")return qt.log("mediaTypeForIncomingCall is NONE, call will be recvOnly"),void this.onUserMediaSuccessOnCall();Gt.getUserMediaOnGoing=!0;var Ct=null,yt=null;if(qt.log("this.screenSharing :"+this.screenSharing),qt.log("this.audioOnly :"+this.audioOnly),this.screenSharing===!0)if(qt.log("getScreenMedia"),ot.Xh==="Chrome")qt.log("this.desktopId :"+this.desktopId),Ct={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:this.desktopId}}};else{if(qt.log("this.captureSourceType :"+this.captureSourceType),this.captureSourceType!=="screen"&&this.captureSourceType!=="window"&&this.captureSourceType!=="application")return void qt.error("captureSourceType value is not correct");Ct={video:{mediaSource:this.captureSourceType}}}else this.audioOnly===!0?(qt.log("this.audioOnly = true"),Gt.gum_config=apiCC.setAudioSourceIdInConstraint(Gt.audioSourceId,Gt.gum_config),yt=JSON.parse(JSON.stringify(Gt.gum_config)),Gt.allowAsymetricMediaCalls===!1?yt.video=!1:qt.log("allow AsymetricMediaCalls is activated"),Ct=yt):(qt.log("audio and video call"),Ct=(0,st.ws)({},Gt.gum_config),nt?Ct.audio=!1:Ct=apiCC.setAudioSourceIdInConstraint(Gt.audioSourceId,Ct),Ct=apiCC.setVideoSourceIdInConstraint(Gt.videoSourceId,Ct),Ct=apiCC.setVideoFacingModeInConstraint(Gt.facingMode,Ct),typeof apiRTC_React<"u"&&(Ct={audio:!0,video:{mandatory:{minWidth:500,minHeight:300,minFrameRate:30},facingMode:"user"}}));apiCC.createUserMediaStream({callId:this.callId,type:this.callType,gum_config:Ct,success:function(Pt){qt.debug("[getUserMediaOnCall] success; userMediaStreamId: "+Pt.userMediaStreamId),Tt.callConfiguration!==void 0&&Tt.callConfiguration!==null||(Tt.callConfiguration={}),Tt.callConfiguration.userMediaStreamId=Pt.userMediaStreamId,Tt.onUserMediaSuccessOnCall(Pt.stream)},failure:function(Pt,Et){qt.debug("[getUserMediaOnCall] failure; userMediaStreamId: "+Pt.userMediaStreamId),Tt.onUserMediaErrorOnCall(Et)}})},this.handleToneChangeEvent=function(Tt){qt.debug("handleToneChangeEvent :",Tt.tone),Tt.tone!==""?qt.debug("Tone played: "+Tt.tone):qt.debug("All tones have played.")},this.sendTones=function(Tt,nt,Ct){qt.debug("sendTones :"),this.dtmfSender&&(qt.debug("sendTones : Tones, duration, gap: ",Tt,nt,Ct),this.dtmfSender.insertDTMF(Tt,nt,Ct))},this.addStream=function(Tt){var nt,Ct=null,yt=null,Pt=0,Et=!1,Ut=null,Ot=[];if(typeof apiRTC_React<"u"||ot.Xh==="Firefox"&&ot.PR<51||ot.Xh==="Chrome"&&ot.PR<65||ot.Xh==="Safari"&&ot.dc<12.1||ot.Xh==="Mobile Safari"&&ot.dc<12.1||apiRTC.osName==="iOS"&&typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0)qt.info("using addStream method"),this.pc.addStream(Tt),qt.debug("end addStream method");else{if(!(ot.Xh==="Firefox"&&ot.PR<59||ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome")){for(qt.info("using addTrack/replaceTrack method"),Ct=Tt.getTracks(),nt=0;nt<Ct.length;nt+=1){for(Et=!1,yt=this.rtpSenders[Ct[nt].kind],Pt=0;Pt<yt.length;Pt+=1)if(yt[Pt].track===null){Et=!0;break}if(Et===!0)Ot.push(yt[Pt].replaceTrack(Ct[nt])),qt.debug("addStream -> replaceTrack",yt[Pt]);else{if(this.simulcast==="RID"&&Ct[nt].kind==="video"&&st.wL.type==="chrome"){var Bt=[{rid:"h",active:!0,maxBitrate:9e5},{rid:"m",active:!0,maxBitrate:3e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:1e5,scaleResolutionDownBy:4}];this.callControl.callConfiguration.simulcast&&this.callControl.callConfiguration.simulcast.sendEncodings&&(Bt=this.callControl.callConfiguration.simulcast.sendEncodings.slice()),Ut=this.pc.addTransceiver(Ct[nt],{direction:"sendonly",streams:[Tt],sendEncodings:Bt}).sender}else if(Ut=this.pc.addTrack(Ct[nt],Tt),this.simulcast==="RID"&&Ct[nt].kind==="video"&&st.wL.type==="firefox"){var Qt=Ut.getParameters();Qt||(Qt={}),this.callControl.callConfiguration.simulcast&&this.callControl.callConfiguration.simulcast.sendEncodings?Qt.encodings=this.callControl.callConfiguration.simulcast.sendEncodings.slice():Qt.encodings=[{rid:"h",active:!0,maxBitrate:9e5},{rid:"m",active:!0,maxBitrate:3e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:1e5,scaleResolutionDownBy:4}],Ot.push(Ut.setParameters(Qt))}qt.debug("addStream -> addTrack",Ut),this.rtpSenders[Ct[nt].kind].push(Ut)}}return qt.debug("end addTrack/replaceTrack method"),this.rtpSenders.audio.length>0&&(this.dtmfSender=this.rtpSenders.audio[0].dtmf,this.dtmfSender&&(this.dtmfSender.ontonechange=this.handleToneChangeEvent)),new Promise(function(en,Jt){Promise.all(Ot).then(function(an){en()}).catch(Jt)})}for(qt.info("using addTrack method"),Ct=Tt.getTracks(),nt=0;nt<Ct.length;nt+=1)this.pc.addTrack(Ct[nt],Tt);qt.debug("end addTrack method")}return Promise.resolve()},this.removeStream=function(Tt){var nt,Ct=null,yt=[];if(qt.info("removeStream in call",Tt.id),ot.Xh==="Firefox"&&ot.PR<51||ot.Xh==="Chrome"&&ot.PR<65||ot.Xh==="Safari"&&ot.dc<12.1||ot.Xh==="Mobile Safari"&&ot.dc<12.1||apiRTC.osName==="iOS"&&typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0)qt.info("using removeStream method"),this.pc.removeStream(Tt),qt.debug("end removeStream method");else{if(!(ot.Xh==="Firefox"&&ot.PR<59||ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome")){for(qt.info("using replaceTrack method"),nt=0;nt<this.rtpSenders.audio.length;nt+=1)yt.push(this.rtpSenders.audio[nt].replaceTrack(null));for(nt=0;nt<this.rtpSenders.video.length;nt+=1)yt.push(this.rtpSenders.video[nt].replaceTrack(null));return qt.debug("end replaceTrack method"),new Promise(function(Pt,Et){Promise.all(yt).then(function(Ut){Pt()}).catch(Et)})}for(qt.info("using removeTrack method"),Ct=this.pc.getSenders(),qt.debug("senders :",Ct),nt=0;nt<Ct.length;nt+=1)this.pc.removeTrack(Ct[nt]);qt.debug("end removeTrack method")}return Promise.resolve()},this.stopStream=function(Tt){qt.info("stopStream in call");var nt,Ct=null;if(ot.Xh==="Chrome"&&ot.PR<45||ot.Xh==="Firefox"&&ot.PR<44||ot.Xh==="Opera"&&ot.PR<34||ot.Xh==="Chromium"&&ot.PR<44||ot.Xh==="Chrome WebView"&&ot.PR<45)qt.log("... using MediaStream.stop"),Tt.stop();else{for(qt.log("... using MediaStreamTrack.stop"),Ct=Tt.getTracks(),nt=0;nt<Ct.length;nt+=1)Ct[nt].stop();qt.log("... tracks stopped")}Tt=null},this.addVideoMedia=function(){var Tt=this;qt.info("addVideoMedia");var nt=Gt.gum_config;apiCC.createUserMediaStream({callId:this.callId,type:"media",gum_config:nt,success:function(Ct){qt.debug("[addVideoMedia] success; userMediaStreamId: "+Ct.userMediaStreamId);var yt=apiCC.getUserMediaStream(Tt.callConfiguration.userMediaStreamId),Pt=Promise.resolve();yt&&(Pt=Tt.removeStream(yt.stream).then(function(){Gt.myWebRTC_Event.createLocalStreamRemovedEvent(Tt.callType,Tt.callId,yt.stream,Tt.remoteId,Tt.destCallType),apiCC.releaseUserMediaStream(yt.userMediaStreamId,Tt.callId)})),Pt.then(function(){Tt.callConfiguration.userMediaStreamId=Ct.userMediaStreamId,Tt.callLocalStream=Ct.stream,Tt.addStream(Ct.stream),Tt.updateMediaWithRetryManagement(!1)}).catch(function(Et){qt.error("Failed to addVideoMedia",Et);var Ut=null,Ot=null;Tt.callControl&&(Ut=Tt.callControl.roomName,Ot=Tt.callControl.type),Gt.myWebRTC_Event.createErrorEvent("Failed to addVideoMedia","MEDIA_UPDATE_ERROR",Tt.callId,Ut,Ot)})},failure:function(Ct,yt){qt.debug("[addVideoMedia] failure; userMediaStreamId: "+Ct.userMediaStreamId),Tt.onUserMediaErrorOnCall(yt)}})},this.stopScreenSharing=function(){qt.debug("stopScreenSharing detected"),Gt.removeCallFromTableWithCallIdAndSendBye(this.callId,"stop_ScreenSharing")},this.checkingMutingState=function(){var Tt=this,nt=null;qt.debug("checkingMutingState");var Ct=function(){(0,st.ki)(Tt,"mcuRemoteStream","object")||(Tt.mcuRemoteStream={}),Tt.mcuRemoteStream.videoMuted=!0},yt=function(){(0,st.ki)(Tt,"mcuRemoteStream","object")||(Tt.mcuRemoteStream={}),Tt.mcuRemoteStream.audioMuted=!0};(0,st.ki)(this.callConfiguration,"userMediaStreamId","string")&&(nt=apiCC.getUserMediaStream(this.callConfiguration.userMediaStreamId))&&(nt.videoMuted?(Ct(),this.isLocalVideoMuted=!0):this.isLocalVideoMuted=!1,nt.audioMuted?(yt(),this.isLocalAudioMuted=!0):this.isLocalAudioMuted=!1);var Pt=function(){Tt.isLocalVideoMuted||(nt?nt.video&&!nt.videoMuted&&nt.muteVideoOnStreams("enabled"):Tt.callLocalStream&&(Gt.muteTracks(Tt.callLocalStream.getVideoTracks()),Tt.isLocalVideoMuted=!0),Ct())},Et=function(){Tt.isLocalAudioMuted||(nt?nt.audio&&!nt.audioMuted&&nt.muteAudioOnStreams("enabled"):Tt.callLocalStream&&(Gt.muteTracks(Tt.callLocalStream.getAudioTracks()),Tt.isLocalAudioMuted=!0),yt())};Gt.isVideoMuted===!0&&(qt.log("Client is video muted, applying to call"),Pt()),Gt.isAudioMuted===!0&&(qt.log("Client is audio muted, applying to call"),Et()),(0,st.ki)(this.callConfiguration,"muted","string")&&(qt.log("callConfiguration muted is set :",this.callConfiguration.muted),this.callConfiguration.muted==="VIDEO"&&(Pt(),Et()),this.callConfiguration.muted==="AUDIOONLY"&&Et(),this.callConfiguration.muted==="VIDEOONLY"&&Pt(),delete this.callConfiguration.muted)},this.onUserMediaSuccessOnCall=function(Tt){qt.info("onUserMediaSuccessOnCall");var nt=(0,st.Pj)(),Ct={};Gt.userMediaErrorDetected===!0&&(Gt.userMediaErrorDetected=!1,Ct.userMediaErrorDetected=Gt.userMediaErrorDetected,apiCC.session.setUserData(Ct)),qt.log("isHTTPS()"+nt),Gt.getUserMediaOnGoing=!1,qt.log("User has granted access to local media."),Gt.accessToLocalMedia=!0,this.accessToMedia=!0,this.screenSharing===!0?(this.callType="screenSharing",Tt!=null&&(Tt.onended=this.callback(this,"stopScreenSharing"),Tt.getVideoTracks().length>0&&(Tt.getVideoTracks()[0].onended=this.callback(this,"stopScreenSharing")))):this.audioOnly===!0&&(this.callType="audio"),Tt!==void 0&&(this.callLocalStream=Tt),(0,st.yJ)()?(qt.log("isHTTP true"),this.establishCall()):(qt.log("webRTCClient.userAcceptOnIncomingCall :"+Gt.userAcceptOnIncomingCall),qt.log("this.callee :"+this.callee),this.data!==void 0&&qt.log("this.data.MCUType :"+this.data.MCUType),Gt.userAcceptOnIncomingCall!==!0||this.callee!==!0&&this.data.MCUType!=="MCU-Callee"||this.isAccepted!==!1?this.calleeId!=="LOCAL"?this.establishCall():qt.log("call is not established as this is a LOCAL stream request"):qt.log("Stand-by :: wait for establishCall"))},this.establishCall=function(){var Tt=this;qt.debug("establishCall()"),this.started!==!0||this.addingUserMedia!==!0||!this.belongsToRoom()||this.settingUpType!=="publish"||this.data&&this.data.hasOwnProperty("MCUType")||!this.sessionMCU||this.sessionMCU.hasOwnProperty("roomMode")||(this.restarting=!0,this.pc.close(),this.pc=null,this.started=!1,this.localDescriptionSetted=!1,this.remoteDescriptionSetted=!1,this.sendedSdpOfferMessage=null,this.receivedSdpOfferMessage=null,this.rtpSenders={audio:[],video:[]},this.addingUserMedia=!1,this.updateUserMedia=!1,this.updateCause=null,this.incomingcandidatesQueue=[],this.message200OKReceived=!1,this.statisticId&&(clearInterval(this.statisticId),this.statisticId=null),this.csmIntervalId&&(clearInterval(this.csmIntervalId),this.csmIntervalId=null),this.instanceId=apiCC.generateInstanceId(),this.data.instanceId=this.instanceId),this.dataCall!==!0&&this.checkingMutingState(),this.maybeStart();var nt=null;this.callee&&this.addingUserMedia!==!0&&this.updateUserMedia!==!0?(nt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(this.receivedSdpOfferMessage),qt.log("Avant setRemote pour le callee :",nt),this.pc!==null?(Gt.preferSendingH264Codec&&(qt.log("Modification of SDP to set H264 as prefered sending codec"),nt.sdp=Gt.mySDPManager.maybePreferCodec(nt.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("establishCall : before setRemoteDescription for callee"),this.pc.setRemoteDescription(nt,this.callback(this,"onSetRemoteDescriptionSuccess"),this.callback(this,"onSetRemoteDescriptionFailure"))):(qt.log("establishCall : before setRemoteDescription for callee - Promise version"),this.pc.setRemoteDescription(nt).then(this.callback(this,"onSetRemoteDescriptionSuccess")).catch(this.callback(this,"onSetRemoteDescriptionFailure")))):qt.log("Error : PC is null"),this.doAnswer()):this.addingUserMedia===!0?(qt.log("Adding local stream 1."),this.pc!==null?(this.callLocalStream===null&&Gt.localStream!==null&&(this.callLocalStream=Gt.localStream),this.callLocalStream!==null?(qt.log("Add Stream of callLocalStream"),this.addStream(this.callLocalStream).then(function(){Tt.updateMediaWithRetryManagement(!1)}).catch(function(Ct){qt.error("failed to add stream",Ct)})):(qt.log("No Stream to addStream"),this.updateMediaWithRetryManagement(!1))):qt.error("Error : PC is null")):this.updateUserMedia===!0&&this.updateMediaWithRetryManagement(!1),qt.log("End of establishCall()")},this.onUserMediaSuccessTestUni=function(){Gt.getUserMediaOnGoing=!1,qt.info("onUserMediaSuccessTestUni : User has not granted access to local media.");var Tt=null,nt={};Gt.userMediaErrorDetected===!0&&(Gt.userMediaErrorDetected=!1,nt.userMediaErrorDetected=Gt.userMediaErrorDetected,apiCC.session.setUserData(nt)),Gt.accessToLocalMedia=!0,this.maybeStart(),this.callee&&(Tt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(this.receivedSdpOfferMessage),Gt.preferSendingH264Codec&&(qt.log("Modification of SDP to set H264 as prefered sending codec"),Tt.sdp=Gt.mySDPManager.maybePreferCodec(Tt.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("onUserMediaSuccessTestUni : before setRemoteDescription for callee"),this.pc.setRemoteDescription(Tt,this.callback(this,"onSetRemoteDescriptionSuccess"),this.callback(this,"onSetRemoteDescriptionFailure"))):(qt.log("onUserMediaSuccessTestUni : before setRemoteDescription for callee - Promise version"),this.pc.setRemoteDescription(Tt).then(this.callback(this,"onSetRemoteDescriptionSuccess")).catch(this.callback(this,"onSetRemoteDescriptionFailure"))),this.doAnswer())},this.onUserMediaErrorOnCall=function(Tt){var nt=this;qt.log("onUserMediaErrorOnCall");var Ct={};Gt.getUserMediaOnGoing=!1,setTimeout(function(){fn.createErrorEvent(Tt,"USER_MEDIA_ERROR",nt.callId)}),qt.error("Failed to get access to local media. Error code was "+Tt.code),qt.error(Tt),Tt=null,ot.$6!=="electron"&&ot.Xh==="Chrome"&&ot.PR>47&&(qt.log("browser_version > 47"),window.location.protocol!=="https:"&&qt.error("HTTPS is now mandatory to use getUserMedia()")),this.screenSharing===!0&&(this.callType="screenSharing",window.location.protocol!=="https:"?(qt.log("You need to be connected using HTTPS for screenSharing"),fn.createDesktopCaptureEvent("UserMediaError_HTTPS_needed",this.callId,this.remoteId)):(qt.log("screenSharing UserMediaError"),fn.createDesktopCaptureEvent("UserMediaError",this.callId,this.remoteId))),this.callee===!0?(this.myWebRTC_Stack.sendBye(this.callId,this.calleeId,this.dest_roomId,this.callerId,"User_Media_Error",this.data),Gt.removeCallFromTableWithCallIdandRemoteId(this.callId,this.callerId,"User_Media_Error")):(this.data!==void 0&&this.data!==null&&this.data.MCUType==="MCU-Callee"&&this.myWebRTC_Stack.sendBye(this.callId,this.callerId,this.dest_roomId,this.calleeId,"User_Media_Error",this.data),Gt.removeCallFromTableWithCallIdandRemoteId(this.callId,this.calleeId,"User_Media_Error")),this.screenSharing===!1&&(Gt.userMediaErrorDetected=!0,Ct.userMediaErrorDetected=Gt.userMediaErrorDetected,apiCC.session.setUserData(Ct))},this.maybeStart=function(){qt.debug("maybeStart"),!this.started&&Gt.channelReady&&(Gt.accessToLocalMedia||this.dataCall)&&(qt.log("Creating PeerConnection."),this.createPeerConnection(),Gt.unidirectionelCallOnly||this.screenSharing===!0?this.callee===!1&&(qt.log("Adding local stream 2."),this.callLocalStream!==null?(qt.log("Add Stream of callLocalStream"),this.addStream(this.callLocalStream)):Gt.localStream!==null?(qt.log("Add Stream of client.localStream"),this.addStream(Gt.localStream),this.callLocalStream=Gt.localStream):qt.log("No Stream to add")):this.dataCall||(qt.log("Adding local stream 3."),this.callLocalStream!==null?(qt.log("Add Stream of callLocalStream"),this.addStream(this.callLocalStream)):Gt.localStream!==null?(qt.log("Add Stream of client.localStream"),this.addStream(Gt.localStream),this.callLocalStream=Gt.localStream):(qt.log("No Stream to add"),this.belongsToRoom()||st.wL.type!=="safari"||typeof this.pc.addTransceiver!="function"||(qt.debug("add transceivers"),this.pc.addTransceiver("audio",{direction:"recvonly"}),this.pc.addTransceiver("video",{direction:"recvonly"})))),this.started=!0,this.callee===!1&&(qt.log("Before doCall()"),this.doCall())),qt.log("End of maybeStart")},this.createDataChannel=function(){if(qt.info("createDataChannel"),ot.Xh==="Edge"&&ot.PR<79&&apiRTC.browserDetails.type!=="chrome")qt.warn("Cannot create DataChannel as it is not supported on Edge");else if(this.sendDataChannel===null)try{this.sendDataChannel=this.pc.createDataChannel("apiRTCDataChannel",{}),this.sendDataChannel.binaryType="arraybuffer",qt.log("Created data channel"),qt.log("Subscribing to dc events"),this.sendDataChannel.onopen=this.callback(this,"onSendDataChannelOpen"),this.sendDataChannel.onclose=this.callback(this,"onSendDataChannelClose"),this.sendDataChannel.onmessage=this.callback(this,"onSendDataChannelMessage"),this.sendDataChannel.onerror=this.callback(this,"onSendDataChannelError")}catch(Tt){qt.log("createDataChannel() failed with exception: "+Tt.message)}else qt.log("Datachannel already exist")},this.createPeerConnection=function(){qt.info("createPeerConnection");try{qt.log("createPeerConnection with pc_config:",JSON.stringify(this.pc_config)),qt.log("and pc_constraints:",JSON.stringify(this.pc_constraints)),st.wL.type==="chrome"&&st.wL.version>=72&&st.wL.version<78?(qt.debug("Chrome 72=+ and 78-, force sdpSemantics plan-b"),this.pc_config.sdpSemantics="plan-b"):apiRTC.osName==="iOS"&&typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0?(qt.debug("Cordova, force sdpSemantics plan-b"),this.pc_config.sdpSemantics="plan-b"):qt.debug("sdpSemantics unified-plan is being used"),this.pc=new apiCC.myWebRTC_Adapter.RTCPeerConnection(this.pc_config,this.pc_constraints),this.dataCall&&this.createDataChannel(),this.pc.onicecandidate=this.callback(this,"onIceCandidate")}catch(Tt){return qt.log("Failed to create PeerConnection, exception: "+Tt.message),void qt.error("Cannot create RTCPeerConnection object; WebRTC is not supported by this browser.")}ot.Xh==="Firefox"&&ot.PR>=53||ot.Xh==="Edge"||st.wL.type==="chrome"&&st.wL.version>=64?(this.pc.ontrack=this.callback(this,"onRemoteTrackAdded"),this.pc.onaddstream=this.callback(this,"onRemoteStreamAdded")):ot.Xh==="Safari"&&ot.PR>=12||ot.Xh==="Mobile Safari"&&ot.PR>=12?this.pc.ontrack=this.callback(this,"onRemoteTrackAdded"):this.pc.onaddstream=this.callback(this,"onRemoteStreamAdded"),this.pc.onremovestream=this.callback(this,"onRemoteStreamRemoved"),this.pc.onnegotiationneeded=this.callback(this,"onNegotiationNeeded"),this.pc.onsignalingstatechange=this.callback(this,"onSignalingStateChange"),this.pc.oniceconnectionstatechange=this.callback(this,"onIceConnectionStateChange"),this.pc.ondatachannel=this.callback(this,"onDataChannel"),this.pc.onicegatheringstatechange=this.callback(this,"onIceGatheringStateChange"),this.pc.onconnectionstatechange=this.callback(this,"onConnectionStateChange"),Gt.qosEnable&&(this.statisticId=setInterval(this.callback(this,"getStatistics"),this.getStatsInterval)),Gt.csmEnable&&(this.csmLastResults={},this.csmIntervalId=setInterval(this.callback(this,"csmHandler"),this.csmIntervalMs))},this.onIceGatheringStateChange=function(Tt){qt.log("onIceGatheringStateChange"),this.pc!==null&&(qt.info("onIceGatheringStateChange, Ice Gathering State is now : "+this.pc.iceGatheringState),this.pc.iceGatheringState==="complete"&&this.candidateNb===0&&qt.warn("Warning, no candidate where retrieved for this call on client"))},this.onConnectionStateChange=function(Tt){qt.log("onConnectionStateChange event :",Tt)},this.onDataChannel=function(Tt){qt.info("onDataChannel event"),this.receiveDataChannel=Tt.channel,this.receiveDataChannel.binaryType="arraybuffer",this.sendDataChannel===null&&(qt.log("Setting this.sendDataChannel with receivedDataChannel"),this.sendDataChannel=Tt.channel,this.sendDataChannel.onopen=this.callback(this,"onSendDataChannelOpen"),this.sendDataChannel.onclose=this.callback(this,"onSendDataChannelClose"),this.sendDataChannel.onmessage=this.callback(this,"onSendDataChannelMessage"),this.sendDataChannel.onerror=this.callback(this,"onSendDataChannelError")),qt.log("got dataChannel",Tt.channel.label),qt.log("Subscribing to dc events"),this.receiveDataChannel.onopen=this.callback(this,"onReceiveDataChannelOpen"),this.receiveDataChannel.onclose=this.callback(this,"onReceiveDataChannelClose"),this.receiveDataChannel.onmessage=this.callback(this,"onReceiveDataChannelMessage"),this.receiveDataChannel.onerror=this.callback(this,"onReceiveDataChannelError")},this.onSendDataChannelOpen=function(Tt){qt.info("onSendDataChannelOpen"),this.callType==="data"&&this.calleeId==="dataChannelConnector"&&(this.pushDataStatus&&this.pushDataStatus.type==="pipeline"?(this.pushDataStatus.state="ready",setTimeout(function(){Gt.startNextPushData()})):this.transferStarted!==!0&&this.startTransfer()),fn.createEvent({eventType:"sendDataChannelOpen",callId:this.callId,remoteId:this.remoteId,details:Tt})},this.onSendDataChannelClose=function(Tt){qt.info("onSendDataChannelClose"),this.sendDataChannel=null,fn!==null&&fn.createEvent({eventType:"sendDataChannelClose",callId:this.callId,remoteId:this.remoteId,details:Tt})},this.processOnDataChannelMessage=function(Tt){var nt,Ct,yt=null,Pt=null,Et="",Ut=0;if(qt.info("processOnDataChannelMessage"),yt=JSON.parse(Tt.data),qt.log("data.uuid :"+yt.uuid),qt.log("data.messageSize :"+yt.messageSize),qt.log("data.originalDataType :"+yt.originalDataType),nt=yt.uuid,yt.originalDataType==="ArrayBuffer"&&(qt.log("ArrayBuffer conversion"),yt.message=st.cw.decode(yt.message)),qt.log("data :"+yt),qt.log("data.uuid :"+nt),qt.log("receiveChunkNb[uuid] :"+this.receiveChunkNb[nt]),this.receiveChunkNb[nt]===void 0)qt.log("receiving first packet for uuid :"+nt),qt.log("evt.data.message :"+Tt.data),this.firstDataPacket[nt]=yt,this.receiveChunkNb[nt]=1,this.receivedSize[nt]=0,this.startingDate=new Date,this.transferDuration=0,fn.createEvent({eventType:"onFileReceiving",remoteId:this.remoteId,callId:this.callId,name:yt.name,uuid:nt}),fn.createEvent({eventType:"onFileProgress",sendChunkNb:this.receiveChunkNb[nt],fileSize:this.firstDataPacket[nt].size,remainingSize:this.firstDataPacket[nt].size,callId:this.callId,uuid:nt,remoteId:this.remoteId,lastPacket:!1,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:0,transferEnded:!1});else if(qt.log("new packet for uuid :"+nt),this.receiveChunkNb[nt]+=1,qt.log("data.messageSize :"+yt.messageSize),qt.log("data.message.length :"+yt.message.length),Ut=yt.messageSize||yt.message.length,qt.log("receivedSize :"+Ut),this.receiveArrayToStoreChunks[nt]||(this.receiveArrayToStoreChunks[nt]=[]),this.receiveArrayToStoreChunks[nt].push(yt.message),this.receivedSize[nt]+=Ut,this.transferDuration=new Date-this.startingDate,this.receivedSize[nt]===this.firstDataPacket[nt].size){if(qt.log("End of data transfert"),qt.log("this.firstDataPacket.type :"+this.firstDataPacket[nt].type),this.firstDataPacket[nt].type==="image/png-dataUrl"){for(qt.log("Photo received from a takeSnapshot"),Ct=0;Ct<this.receiveArrayToStoreChunks[nt].length;Ct+=1)Et+=this.receiveArrayToStoreChunks[nt][Ct];Pt=Et}else Pt=new window.Blob(this.receiveArrayToStoreChunks[nt]);fn.createEvent({eventType:"onFileProgress",sendChunkNb:this.receiveChunkNb[nt],fileSize:this.firstDataPacket[nt].size,remainingSize:0,callId:this.callId,uuid:nt,remoteId:this.remoteId,lastPacket:!1,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:100,transferEnded:!0}),fn.createEvent({eventType:"onFileReceived",callId:this.callId,uuid:nt,remoteId:this.remoteId,callerId:this.callerId,calleeId:this.calleeId,data:{file:Pt,name:this.firstDataPacket[nt].name,type:this.firstDataPacket[nt].type,uuid:nt},details:Tt}),delete this.receiveArrayToStoreChunks[nt],delete this.receivedSize[nt],delete this.receiveChunkNb[nt],delete this.firstDataPacket[nt]}else fn.createEvent({eventType:"onFileProgress",sendChunkNb:this.receiveChunkNb[nt],fileSize:this.firstDataPacket[nt].size,remainingSize:this.firstDataPacket[nt].size-this.receivedSize[nt],callId:this.callId,uuid:nt,remoteId:this.remoteId,lastPacket:!1,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*this.receivedSize[nt]/this.firstDataPacket[nt].size,10),transferEnded:!1})},this.onSendDataChannelMessage=function(Tt){qt.info("onSendDataChannelMessage :",Tt),this.processOnDataChannelMessage(Tt)},this.onSendDataChannelError=function(Tt){qt.info("onSendDataChannelError"),this.sendDataChannel=null,fn.createEvent({eventType:"sendDataChannelError",callId:this.callId,remoteId:this.remoteId,details:Tt})},this.onReceiveDataChannelOpen=function(Tt){qt.info("onReceiveChannelOpen"),fn.createEvent({eventType:"receiveDataChannelOpen",callId:this.callId,remoteId:this.remoteId,details:Tt})},this.onReceiveDataChannelClose=function(Tt){qt.info("onReceiveDataChannelClose"),this.receiveDataChannel=null,fn!==null&&fn.createEvent({eventType:"receiveDataChannelClose",callId:this.callId,remoteId:this.remoteId,details:Tt})},this.onReceiveDataChannelMessage=function(Tt){qt.info("onReceiveChannelMessage"),this.processOnDataChannelMessage(Tt)},this.onReceiveDataChannelError=function(Tt){qt.info("onReceiveChannelError"),fn.createEvent({eventType:"receiveDataChannelError",callId:this.callId,remoteId:this.remoteId,details:Tt})},this.startTransfer=function(){var Tt=this,nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ct=nt.hasOwnProperty("delay")?nt.delay:100;this.transferStarted!==!0&&(qt.info("startTransfer",Ct),this.transferStarted=!0,setTimeout(function(){Tt.dcfs||(Tt.dcfs=new Ht(Tt),Tt.data.offset>0?Tt.dcfs.transfer(Tt.fileContent.buffer,Tt.data.offset,Tt.sendDataChannel,{delay:Ct}):Tt.dcfs.transfer(Tt.fileContent.buffer,0,Tt.sendDataChannel,{delay:Ct}))},Ct))},this.statisticsAnswer=function(Tt){var nt=Tt.result(),Ct=null;this.qm||(this.qm=new wt(this.getStatsInterval/1e3,this.callback(this,"onQosChange"),this.callback(this,"onQosAudioChange"),this.callback(this,"onQosVideoChange"),this.callId,Gt.apiKey,Gt.clientId,Gt.socket)),nt&&(this.qm.insertStats(nt,this.sendedSdpOfferMessage,this.receivedSdpOfferMessage,Gt.remoteVideo),Ct=this.qm.getAllStats(),Gt.qosEnable&&fn.createEvent({eventType:"onQosStatsUpdate",callId:this.callId,remoteId:this.remoteId,stats:Ct}),this.videoReceivedWidth=Ct.VideoRecv.FrameWidth,this.videoReceivedHeight=Ct.VideoRecv.FrameHeight,this.videoSendWidth=Ct.VideoSend.FrameWidth,this.videoSendHeight=Ct.VideoSend.FrameHeight,this.videoReceivedDelay=Ct.VideoRecv.delay,this.audioReceivedDelay=Ct.AudioRecv.delay,this.audioSendDelay=Ct.AudioSend.rtt,this.videoSendDelay=Ct.VideoSend.rtt,this.videoSendMoyDelay=Ct.VideoSend.moyRtt,this.videoSendPacketLossRatio=Ct.VideoSend.packetLostRatio,this.audioSendPacketLossRatio=Ct.AudioSend.packetLostRatio,this.videoSendEncodeUsagePercent=Ct.VideoSend.googEncodeUsagePercent,this.videoSendCpuLimitedResolution=Ct.VideoSend.googCpuLimitedResolution,this.videoSendBandwidthLimitedResolution=Ct.VideoSend.googBandwidthLimitedResolution,this.videoSendCpuLimitedResolution!==void 0&&JSON.parse(this.videoSendCpuLimitedResolution)===!0&&fn.createEvent({eventType:"cpuLimited",callId:this.callId,encodeUsagePercent:this.videoSendEncodeUsagePercent}),this.videoSendBandwidthLimitedResolution!==void 0&&JSON.parse(this.videoSendBandwidthLimitedResolution)===!0&&fn.createEvent({eventType:"bandwidthLimited",callId:this.callId}))},this.csmGetStatsHandler=function(Tt){var nt,Ct=this,yt=null,Pt=null,Et={};if(this.csm||(this.csm=new Wt(this.csmIntervalMs/1e3,st.wL.type,st.wL.version,"standard"),this.csm.browserInfo={browserAbout:ot.Xh+" "+ot.dc,browserType:st.wL.type,browserVersion:st.wL.version},(0,st.Ym)(this.mcuRemoteStream,"attributes","object")&&(this.mcuRemoteStream.replay===!0?(0,st.Ym)(this.mcuRemoteStream.attributes.callerId,"string")&&(0,st.Ym)(this.mcuRemoteStream.attributes.callId,"string")&&(0,st.Ym)(this.mcuRemoteStream.attributes.recId,"string")&&(this.csm.callFeed={clientId:this.mcuRemoteStream.attributes.callerId,callId:this.mcuRemoteStream.attributes.callId,modifier:"replay",recId:this.mcuRemoteStream.attributes.recId}):(0,st.Ym)(this.mcuRemoteStream.attributes.callerId,"string")&&(0,st.Ym)(this.mcuRemoteStream.attributes.callId,"string")&&(this.csm.callFeed={clientId:this.mcuRemoteStream.attributes.callerId,callId:this.mcuRemoteStream.attributes.callId}))),Et.post=function(Ot){Ct.mos||(Ct.mos=new tn),Ot.quality={},Ot.audioReceived?Ct.isRemoteAudioMuted?Ot.quality.mosS="Muted":Ot.audioReceived.bitsReceivedPerSecond!==0?(Ot.audioReceived.delay=parseInt(Ct.audioReceivedDelay,10),Ot.quality.mosS=Ct.mos.NarrowBandSpeechQuality(Ot.audioReceived.delay,Ot.audioReceived.packetLossRatio)):Ot.quality.mosS="NoStream":Ot.quality.mosS="NoStream",Ot.videoReceived?Ct.isRemoteVideoMuted?Ot.quality.mosV="Muted":Ot.videoReceived.bitsReceivedPerSecond!==0?(Ot.videoReceived.width=Ct.videoReceivedWidth,Ot.videoReceived.height=Ct.videoReceivedHeight,Ot.videoReceived.delay=parseInt(Ct.videoReceivedDelay,10),Ot.quality.mosV=Ct.mos.videoQuality(Ot.videoReceived.width,Ot.videoReceived.height,Ot.videoReceived.packetLossRatio,Math.floor(Ot.videoReceived.bitsReceivedPerSecond/1e3),Ot.videoReceived.framesDecodedPerSecond)):Ot.quality.mosV="NoStream":Ot.quality.mosV="NoStream",Ot.audioReceived&&Ot.videoReceived&&(Ot.quality.mosAV=Ct.mos.audiovisualQuality(Ot.quality.mosS,Ot.quality.mosV,Ot.audioReceived.delay,Ot.videoReceived.delay)),Ot.audioSent?Ct.isLocalAudioMuted?Ot.quality.mosSS="Muted":Ot.audioSent.bitsSentPerSecond!==0?(Ot.audioSent.delay=parseInt(Ct.audioSendDelay,10),Ot.audioSent.packetLossRatio=Ct.audioSendPacketLossRatio,Ot.quality.mosSS=Ct.mos.NarrowBandSpeechQuality(Ot.audioSent.delay,Ot.audioSent.packetLossRatio)):Ot.quality.mosSS="NoStream":Ot.quality.mosSS="NoStream",Ot.videoSent?Ct.isLocalVideoMuted?Ot.quality.mosSV="Muted":Ot.videoSent.bitsSentPerSecond!==0?(Ot.videoSent.width=Ct.videoSendWidth,Ot.videoSent.height=Ct.videoSendHeight,Ot.videoSent.delay=parseInt(Ct.videoSendDelay,10),Ot.videoSent.moyDelay=parseInt(Ct.videoSendMoyDelay,10),Ot.videoSent.packetLossRatio=Ct.videoSendPacketLossRatio,Ot.videoSent.encodeUsagePercent=Ct.videoSendEncodeUsagePercent,Ot.videoSent.cpuLimitedResolution=Ct.videoSendCpuLimitedResolution,Ot.videoSent.bandwidthLimitedResolution=Ct.videoSendBandwidthLimitedResolution,Ot.quality.mosSV=Ct.mos.videoQuality(Ot.videoSent.width,Ot.videoSent.height,Ot.videoSent.packetLossRatio,Math.floor(Ot.videoSent.bitsSentPerSecond/1e3),Ot.videoSent.framesEncodedPerSecond)):Ot.quality.mosSV="NoStream":Ot.quality.mosSV="NoStream",Ot.audioSent&&Ot.videoSent&&(Ot.quality.mosSAV=Ct.mos.audiovisualQuality(Ot.quality.mosSS,Ot.quality.mosSV,Ot.audioSent.delay,Ot.videoSent.delay))},nt=this.csm.addCallStats(Tt,Et),Object.keys(nt).length!==0){!nt.quality||nt.quality.mosS==="Muted"&&nt.quality.mosV==="Muted"&&nt.quality.mosSS==="Muted"&&nt.quality.mosSV==="Muted"||Gt.qualityScoreEnable&&fn.createEvent({eventType:"onCallScoreUpdate",callId:this.callId,score:nt.quality}),this.csmLastResults=nt,this.callLocalStream&&typeof this.callLocalStream.getVideoTracks=="function"&&(yt=this.callLocalStream.getVideoTracks())&&yt[0]&&typeof yt[0].getSettings=="function"&&(Pt=yt[0].getSettings());var Ut={save:!0,clientId:Gt.clientId,callId:this.callId,instanceId:this.instanceId,browserInfo:this.csm.browserInfo,stats:nt};this.sessionMCU&&(Ut.roomId=this.sessionMCU.roomName,Ut.pubSub=Gt.MCUClient.pubConnector),this.csm.callFeed&&(Ut.callFeed=this.csm.callFeed),Pt&&(Ut.videoSettings=Pt),this.data.mesh&&(Ut.mesh=this.data.mesh),this.myWebRTC_Stack.sendInfo("callStats",Ut),Gt.csmEnable&&(this.data&&this.data.mesh&&(this.data.mesh.calleeCompositeUserId?this.data.mesh.calleeCompositeUserId===Gt.compositeClientId:this.data.mesh.calleeId===Gt.clientId)?fn.createEvent({eventType:"onCallStatsUpdate",callId:this.data.mesh.calleeCallId,userId:this.data.mesh.callerId,stats:nt}):fn.createEvent({eventType:"onCallStatsUpdate",callId:this.callId,stats:nt}))}},this.onQosChange=function(Tt,nt){fn.createEvent({eventType:"onQosChange",callId:this.callId,remoteId:this.remoteId,qosIn:Tt,qosOut:nt})},this.onQosAudioChange=function(Tt,nt){fn.createEvent({eventType:"onQosAudioChange",callId:this.callId,remoteId:this.remoteId,qosAudioIn:Tt,qosAudioOut:nt})},this.onQosVideoChange=function(Tt,nt){fn.createEvent({eventType:"onQosVideoChange",callId:this.callId,remoteId:this.remoteId,qosVideoIn:Tt,qosVideoOut:nt})},this.getStatistics=function(){this.pc&&(ot.Xh==="Chrome"&&ot.PR>112?qt.debug("getStats with callback in now deprecated on Chrome, getStatistics() / QoSMonitor can no more be used"):this.pc.getStats&&ot.Xh==="Chrome"&&this.pc.getStats(this.callback(this,"statisticsAnswer")))},this.csmHandler=function(){this.statisticId||this.getStatistics(),this.pc&&typeof this.pc.getStats=="function"&&this.pc.getStats(null).then(this.callback(this,"csmGetStatsHandler")).catch(function(Tt){qt.warn("failed to get stats",Tt)})},this.doCall=function(){var Tt=null;qt.log("Sending offer to peer"),this.audioOnly?(qt.log("audioOnly call :",this.mediaConstraintsAudioOnly),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraintsAudioOnly)):(qt.log("createOffer - Promise version"),this.pc.createOffer(this.mediaConstraintsAudioOnly).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure")))):this.screenSharing===!0?(qt.log("screenSharing call : one way media :",Tt),Tt={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),Tt)):(qt.log("createOffer - Promise version"),this.pc.createOffer(Tt).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure")))):this.dataCall===!0?(qt.log("call is data only :",Tt),Tt=ot.Xh==="Firefox"&&ot.PR>43?{offerToReceiveAudio:!1,offerToReceiveVideo:!1}:{mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),Tt)):(qt.log("createOffer - Promise version"),this.pc.createOffer(Tt).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure")))):(qt.log("call is audio & video :",this.mediaConstraints),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraints)):(qt.log("createOffer - Promise version"),this.pc.createOffer(this.mediaConstraints).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure"))))},this.doAnswer=function(){qt.info("doAnswer");var Tt=null;this.audioOnly?(qt.log("audioOnly call"),Tt=this.mediaConstraintsAudioOnly):Tt=this.mediaConstraints,ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("createAnswer"),this.pc.createAnswer(this.callback(this,"setLocalAndSendMessage"),this.callback(this,"onCreateAnswerFailure"),Tt)):(qt.log("createAnswer - Promise version"),this.pc.createAnswer(Tt).then(this.callback(this,"setLocalAndSendMessage")).catch(this.callback(this,"onCreateAnswerFailure")))},this.doUpdateAnswer=function(){qt.info("doUpdateAnswer");var Tt=null;this.audioOnly?(qt.log("audioOnly call"),Tt=this.mediaConstraintsAudioOnly):Tt=this.mediaConstraints,ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("createAnswer"),this.pc.createAnswer(this.callback(this,"setLocalAndSendMessageUpdate"),this.callback(this,"onCreateAnswerFailure"),Tt)):(qt.log("createAnswer - Promise version"),this.pc.createAnswer(Tt).then(this.callback(this,"setLocalAndSendMessageUpdate")).catch(this.callback(this,"onCreateAnswerFailure")))},this.updateMediaWithRetryManagement=function(Tt){qt.debug("updateMediaWithRetryManagement");var nt=this.updateMedia(Tt);qt.debug("updateMediaResult :",nt),nt.reason!=="Sig_state_not_stable"&&nt.reason!=="Update_already_ongoing"||(qt.debug("updateMedia will be retried later for reason :",nt.reason),this.retryUpdateMedia=!0)},this.updateMedia=function(Tt){return qt.debug("updateMedia, callId :",this.callId),qt.log("iceRestartActivated :",Tt),this.pc===null?(qt.log("updateMedia, pc no more exist"),{status:"Not_Done",reason:"PC_Not_Exit"}):this.updateMediaOngoing===!0?(qt.log("updateMedia, already ongoing"),{status:"Not_Done",reason:"Update_already_ongoing"}):(this.updateMediaOngoing=!0,this.pc.signalingState!=="stable"?{status:"Not_Done",reason:"Sig_state_not_stable"}:(qt.log("Sending Update offer to peer."),this.audioOnly?(qt.log("audioOnly call :",this.mediaConstraintsAudioOnly),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("createOffer"),this.mediaConstraintsAudioOnly.mandatory!==void 0?this.mediaConstraintsAudioOnly.mandatory.IceRestart=!0:this.mediaConstraintsAudioOnly.iceRestart=!0,qt.log("this.mediaConstraints :",this.mediaConstraintsAudioOnly),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOfferUpdate"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraintsAudioOnly)):(qt.log("createOffer - Promise version"),Tt===!0&&(this.mediaConstraintsAudioOnly.iceRestart=!0),qt.log("this.mediaConstraints :",this.mediaConstraintsAudioOnly),this.pc.createOffer(this.mediaConstraintsAudioOnly).then(this.callback(this,"setLocalAndSendMessageonOfferUpdate")).catch(this.callback(this,"onCreateOfferFailure")))):ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("createOffer"),Tt===!0&&(this.mediaConstraints.mandatory!==void 0?this.mediaConstraints.mandatory.IceRestart=!0:this.mediaConstraints.iceRestart=!0),qt.log("this.mediaConstraints :",this.mediaConstraints),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOfferUpdate"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraints)):(qt.log("createOffer - Promise version"),Tt===!0&&(this.mediaConstraints.iceRestart=!0),qt.log("this.mediaConstraints :",this.mediaConstraints),this.pc.createOffer(this.mediaConstraints).then(this.callback(this,"setLocalAndSendMessageonOfferUpdate")).catch(this.callback(this,"onCreateOfferFailure"))),{status:"OnGoing",reason:"OK"}))},this.manipulateSDP=function(Tt,nt){var Ct=null,yt=!1;return qt.log("manipulateSDP with type :",nt),Gt.receiveMediaDeactivated===!0&&(qt.log("setting receiveMediaDeactivated in SDP :"+Gt.receiveMediaDeactivated),Tt.sdp=Gt.mySDPManager.setSendOnly(Tt.sdp)),Gt.RTPMedia===!0&&(Tt.sdp=Tt.sdp.replace(/RTP\/SAVPF/g,"RTP/SF")),Gt.audioBandwidth!==null&&(qt.log("setting audioBandwidth in SDP :"+Gt.audioBandwidth),Tt.sdp=Gt.mySDPManager.setAudioBandwidth(Tt.sdp,Gt.audioBandwidth)),Gt.videoBandwidth!==null&&(qt.log("setting videoBandwidth in SDP :"+Gt.videoBandwidth),Tt.sdp=Gt.mySDPManager.setVideoBandwidth(Tt.sdp,Gt.videoBandwidth)),Gt.dataBandwidth!==null&&(qt.log("setting dataBandwidth in SDP :"+Gt.dataBandwidth),Tt.sdp=Gt.mySDPManager.setDataBandwidth(Tt.sdp,Gt.dataBandwidth)),Gt.preferOpusCodec===!0&&(qt.log("setting preferOpusCodec"),Tt.sdp=Gt.mySDPManager.preferOpus(Tt.sdp)),Gt.preferVP9Codec!==!0&&this.preferVP9Codec!==!0||(qt.log("Call prefer VP9 Codec"),Tt.sdp=Gt.mySDPManager.maybePreferCodec(Tt.sdp,"video","VP9")),Gt.preferH264Codec!==!0&&this.preferH264Codec!==!0||(qt.log("Call prefer H264 Codec"),Tt.sdp=Gt.mySDPManager.maybePreferCodec(Tt.sdp,"video","H264")),this.preferVP8Codec===!0&&(qt.log("Call prefer VP8 Codec"),Tt.sdp=Gt.mySDPManager.maybePreferCodec(Tt.sdp,"video","VP8")),Gt.setStereo===!0&&(qt.log("Set Stereo"),Tt.sdp=Gt.mySDPManager.setCodecParam(Tt.sdp,"opus/48000","stereo","1")),Tt=Gt.mySDPManager.updateSDPcodecs(Tt,Tt.type,"audio",Gt.allowedAudioCodecs),Tt=Gt.mySDPManager.updateSDPcodecs(Tt,Tt.type,"video",Gt.allowedVideoCodecs),nt==="OFFER"?this.settingUpType==="publish"&&this.mediaTypeForIncomingCall==="NONE"?(Ct=Gt.mySDPManager.createGuideline(Tt.sdp),this.mediaTypeForOutgoingCall==="VIDEO"?((0,st.ki)(Ct,"audio","object")&&Ct.audio.direction!=="sendonly"&&(Ct.audio.direction="sendonly",yt=!0),(0,st.ki)(Ct,"video","object")&&Ct.video.direction!=="sendonly"&&(Ct.video.direction="sendonly",yt=!0)):this.mediaTypeForOutgoingCall==="AUDIO"?((0,st.ki)(Ct,"audio","object")&&Ct.audio.direction!=="sendonly"&&(Ct.audio.direction="sendonly",yt=!0),(0,st.ki)(Ct,"video","object")&&Ct.video.direction!=="inactive"&&(Ct.video.direction="inactive",yt=!0)):this.mediaTypeForOutgoingCall==="VIDEOONLY"&&((0,st.ki)(Ct,"audio","object")&&Ct.audio.direction!=="inactive"&&(Ct.audio.direction="inactive",yt=!0),(0,st.ki)(Ct,"video","object")&&Ct.video.direction!=="sendonly"&&(Ct.video.direction="sendonly",yt=!0)),yt===!0&&(Tt.sdp=Ct.generate())):this.mediaTypeForOutgoingCall==="VIDEO"?qt.log("mediaTypeForOutgoingCall is VIDEO"):this.mediaTypeForOutgoingCall==="AUDIO"||this.audioOnly===!0?(qt.log("mediaTypeForOutgoingCall is AUDIO"),Tt.sdp=Gt.mySDPManager.setRecvOnlyForVideo(Tt.sdp)):this.mediaTypeForOutgoingCall==="VIDEOONLY"?(qt.log("mediaTypeForOutgoingCall is VIDEOONLY"),Tt.sdp=Gt.mySDPManager.setRecvOnlyForAudio(Tt.sdp)):this.mediaTypeForOutgoingCall==="NONE"&&(qt.log("mediaTypeForOutgoingCall is NONE"),Tt.sdp=Gt.mySDPManager.setRecvOnly(Tt.sdp)):nt==="ANSWER"&&(this.mediaTypeForIncomingCall==="VIDEO"?qt.log("mediaTypeForIncomingCall is VIDEO"):this.mediaTypeForIncomingCall==="AUDIO"||this.audioOnly===!0?(qt.log("mediaTypeForIncomingCall is AUDIO"),Tt.sdp=Gt.mySDPManager.setRecvOnlyForVideo(Tt.sdp)):this.mediaTypeForIncomingCall==="VIDEOONLY"?(qt.log("mediaTypeForIncomingCall is VIDEOONLY"),Tt.sdp=Gt.mySDPManager.setRecvOnlyForAudio(Tt.sdp)):this.mediaTypeForIncomingCall==="NONE"&&(qt.log("mediaTypeForIncomingCall is NONE"),Tt.sdp=Gt.mySDPManager.setRecvOnly(Tt.sdp))),this.simulcast==="SDP"&&nt==="OFFER"&&this.settingUpType==="publish"&&((Ct=Gt.mySDPManager.createGuideline(Tt.sdp)).mungeForSimulcasting(),Tt.sdp=Ct.generate()),Tt},this.setLocalAndSendMessageonOffer=function(Tt){qt.info("setLocalAndSendMessageonOffer"),qt.log("sessionDescription = ",Tt),qt.log("sessionDescription.sdp = ",Tt.sdp);var nt=null;Tt.sdp=this.manipulateSDP(Tt,"OFFER").sdp,qt.log("manipulated sessionDescription.sdp = ",Tt.sdp),this.stripAudioSDPActivated===!0&&(Tt.sdp=Gt.mySDPManager.stripAudioMediaDescriptionFromSDP(Tt.sdp)),this.stripVideoSDPActivated===!0&&(Tt.sdp=Gt.mySDPManager.stripVideoMediaDescriptionFromSDP(Tt.sdp)),this.setLocalCallProfile(Gt.evalCallProfileWithSdp(Tt.sdp,"local","send")),this.sendedSdpOfferMessage=Tt,this.dataCall===!0&&(qt.log("setLocalAndSendMessageonOffer : data Call"),this.callType="data"),this.callCancelled===!1?Gt.NtoNConf===!1?(qt.log("Conf N to 1"),this.screenSharing===!0&&(nt=Gt.mySDPManager.getAudioMediaDescriptionPart(this.sendedSdpOfferMessage.sdp),this.callType=nt!=null?"screenSharingWithAudio":"screenSharing"),this.trickleIce===!0&&(this.myWebRTC_Stack.sendInvite(this.callId,this.callerId,Gt.nickname,this.dest_roomId,this.dest_roomId,this.callType,{offer:Tt,data:this.data,stream:this.mcuRemoteStream,volatile:!!this.restarted}),this.inviteSended=!0),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("setLocalAndSendMessageonOffer : before setLocalDescription"),this.pc.setLocalDescription(this.sendedSdpOfferMessage,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(qt.log("setLocalAndSendMessageonOffer : before setLocalDescription - Promise version"),this.pc.setLocalDescription(this.sendedSdpOfferMessage).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure")))):(qt.log("Conf N to N"),this.myWebRTC_Stack.sendInviteBroadcast(this.callId,this.callerId,Gt.nickname,this.dest_roomId,this.dest_roomId,Tt),this.inviteSended=!0):(qt.warn("Invite is not sent has call has been canceled"),Gt.removeCallFromTableWithCallIdandRemoteId(this.callId,this.calleeId,"Call_Cancelled"),Gt.callsTable.length===0&&qt.log("No more established calls for client"))},this.setLocalAndSendMessageonOfferUpdate=function(Tt){var nt,Ct=null;qt.info("setLocalAndSendMessageonOfferUpdate, sessionDescription :"+Tt),this.sendedSdpOfferMessage=Tt,qt.log("sessionDescription.sdp = ",Tt.sdp),((0,st.Ym)(this.audioSdpDirection,"string")||(0,st.Ym)(this.videoSdpDirection,"string"))&&(Ct=Gt.mySDPManager.createGuideline(Tt.sdp),(0,st.ki)(Ct,"audio","object")&&(0,st.Ym)(this.audioSdpDirection,"string")&&(Ct.audio.direction=this.audioSdpDirection),(0,st.ki)(Ct,"video","object")&&(0,st.Ym)(this.videoSdpDirection,"string")&&(Ct.video.direction=this.videoSdpDirection),Tt.sdp=Ct.generate()),this.setLocalCallProfile(Gt.evalCallProfileWithSdp(Tt.sdp,"local","send"),!0),nt=this.callee?this.callerId:this.calleeId,this.trickleIce===!0?(this.myWebRTC_Stack.sendUpdate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Tt,this.callType,this.data),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription"),this.pc.setLocalDescription(Tt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(qt.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Tt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure")))):(qt.log("Updating PC offer and answer after switch Stream"),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription"),this.pc.setLocalDescription(Tt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(qt.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Tt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure"))),Gt.preferSendingH264Codec&&(qt.log("Modification of SDP to set H264 as prefered sending codec"),this.pc.remoteDescription.sdp=Gt.mySDPManager.maybePreferCodec(this.pc.remoteDescription.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("setLocalAndSendMessageonOfferUpdate : before setRemoteDescription"),this.pc.setRemoteDescription(this.pc.remoteDescription,this.callback(this,"onSetRemoteDescriptionSuccess"),this.callback(this,"onSetRemoteDescriptionFailure"))):(qt.log("setLocalAndSendMessageonOfferUpdate : before setRemoteDescription - Promise version"),this.pc.setRemoteDescription(this.pc.remoteDescription).then(this.callback(this,"onSetRemoteDescriptionSuccess")).catch(this.callback(this,"onSetRemoteDescriptionFailure"))))},this.onCreateOfferFailure=function(Tt){qt.info("onCreateOfferFailure"+Tt),Tt=null},this.onCreateAnswerFailure=function(Tt){qt.info("onCreateAnswerFailure"+Tt),Tt=null},this.setLocalAndSendMessage=function(Tt){var nt;qt.info("setLocalAndSendMessage"),qt.log("sessionDescription.sdp = ",Tt.sdp),this.pc!==null?(Tt=this.manipulateSDP(Tt,"ANSWER"),nt=Gt.mySDPManager.createGuideline(Tt.sdp),this.setLocalCallProfile(Gt.evalCallProfileWithSdpGuideline(nt,Tt.sdp,"local","send")),this.setRemoteCallProfile(Gt.evalCallProfileWithSdpGuideline(nt,Tt.sdp,"local","receive")),qt.log("manipulated sessionDescription.sdp = ",Tt.sdp),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("setLocalAndSendMessage : before setLocalDescription"),this.pc.setLocalDescription(Tt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(qt.log("setLocalAndSendMessage : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Tt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure"))),this.sendedSdpOfferMessage=Tt,this.trickleIce===!0&&this.myWebRTC_Stack.send200OK(this.callId,this.callerId,this.calleeId,Gt.nickname,this.dest_roomId,Tt,this.data)):qt.log("setLocalAndSendMessage, pc no more exist")},this.setLocalAndSendMessageUpdate=function(Tt){var nt;if(this.pc!==null){st.wL.type==="safari"&&(Tt.sdp=this.manipulateSDP(Tt,"OFFER").sdp),nt=Gt.mySDPManager.createGuideline(Tt.sdp),this.mediaType==="AUDIOONLY"?nt.hasOwnProperty("video")&&nt.video.direction!=="inactive"&&(qt.debug("Only audio was requested at call setup: deactivating video"),nt.video.direction="inactive",Tt.sdp=nt.generate()):this.mediaType==="VIDEOONLY"&&nt.hasOwnProperty("audio")&&nt.audio.direction!=="inactive"&&(qt.debug("Only video was requested at call setup: deactivating audio"),nt.audio.direction="inactive",Tt.sdp=nt.generate()),this.setLocalCallProfile(Gt.evalCallProfileWithSdpGuideline(nt,Tt.sdp,"local","send"),!0),this.setRemoteCallProfile(Gt.evalCallProfileWithSdpGuideline(nt,Tt.sdp,"local","receive"),!0),this.updateOngoingTimeoutId&&(clearTimeout(this.updateOngoingTimeoutId),delete this.updateOngoingTimeoutId),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(qt.log("setLocalAndSendMessageUpdate : before setLocalDescription"),this.pc.setLocalDescription(Tt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(qt.log("setLocalAndSendMessageUpdate : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Tt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure")));var Ct;Ct=this.callee?this.callerId:this.calleeId,this.myWebRTC_Stack.send200Update(this.callId,this.callerId,this.calleeId,this.dest_roomId,Ct,Tt,this.data),this.asyncCallbacks&&this.asyncCallbacks.type==="updateMediaType"&&(qt.debug("asyncCallbacks resolve"),this.asyncCallbacks.resolve(),this.asyncCallbacks.timeoutId&&(clearTimeout(this.asyncCallbacks.timeoutId),delete this.asyncCallbacks.timeoutId),delete this.asyncCallbacks)}else qt.log("setLocalAndSendMessageUpdate, pc no more exist")},this.onIceCandidate=function(Tt){try{qt.debug("onIceCandidate :",JSON.stringify(Tt.candidate))}catch(Pt){qt.error(Pt)}var nt,Ct=0,yt=0;nt=this.callee?this.callerId:this.calleeId,this.pc!==null&&(qt.debug("Ice Connection State is now : "+this.pc.iceConnectionState),qt.debug("Ice Gathering State is now : "+this.pc.iceGatheringState)),Tt.candidate?(this.candidateNb+=1,this.trickleIce===!0?this.mediaRoutingMode===Gt.mediaRoutingModeEnum.hostOnly?(Ct=Tt.candidate.candidate.search("host"))!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Tt.candidate.sdpMLineIndex,Tt.candidate.sdpMid,Tt.candidate.candidate,this.data,Tt.candidate,{volatile:!!this.restarted}):qt.log("Media routing mode is hostOnly and not a HOST Candidate : ignoring message"):this.mediaRoutingMode===Gt.mediaRoutingModeEnum.stun?(Ct=Tt.candidate.candidate.search("host"),yt=Tt.candidate.candidate.search("srflx"),Ct!==-1||yt!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Tt.candidate.sdpMLineIndex,Tt.candidate.sdpMid,Tt.candidate.candidate,this.data,Tt.candidate,{volatile:!!this.restarted}):qt.log("Media routing mode is stun and not a HOST or SRFLX Candidate : ignoring message")):this.mediaRoutingMode===Gt.mediaRoutingModeEnum.stunOnly?(Ct=Tt.candidate.candidate.search("srflx"))!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Tt.candidate.sdpMLineIndex,Tt.candidate.sdpMid,Tt.candidate.candidate,this.data,Tt.candidate,{volatile:!!this.restarted}):qt.log("Media routing mode is stunOnly and not a SRFLX Candidate : ignoring message"):this.mediaRoutingMode===Gt.mediaRoutingModeEnum.turn?(qt.log("Media routing mode is turn : all candidates are considered"),this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Tt.candidate.sdpMLineIndex,Tt.candidate.sdpMid,Tt.candidate.candidate,this.data,Tt.candidate,{volatile:!!this.restarted})):this.mediaRoutingMode===Gt.mediaRoutingModeEnum.turnOnly&&((Ct=Tt.candidate.candidate.search("relay"))!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Tt.candidate.sdpMLineIndex,Tt.candidate.sdpMid,Tt.candidate.candidate,this.data,Tt.candidate,{volatile:!!this.restarted}):qt.log("Media routing mode is TurnOnly and not a RELAY Candidate : ignoring message")):qt.log("trickleIce is deactivated : candidates are not sended")):(qt.info("End of candidates."),this.trickleIce===!1&&(qt.log("trickleIce === false"),this.callee===!0?(this.send200OKTrickleIceFalseTimeOutId!==0&&(clearTimeout(this.send200OKTrickleIceFalseTimeOutId),this.send200OKTrickleIceFalseTimeOutId=0),this.message200OKSended===!1?this.myWebRTC_Stack.send200OK(this.callId,this.callerId,this.calleeId,Gt.nickname,this.dest_roomId,this.pc.localDescription,this.data):qt.log("200OK already sended")):this.pc!==null&&(this.sendInviteTrickleIceFalseTimeOutId!==0&&(clearTimeout(this.sendInviteTrickleIceFalseTimeOutId),this.sendInviteTrickleIceFalseTimeOutId=0),this.inviteSended===!1?(qt.log("sendInvite on end of candidate"),this.myWebRTC_Stack.sendInvite(this.callId,this.callerId,Gt.nickname,this.dest_roomId,this.dest_roomId,this.callType,{offer:this.pc.localDescription,data:this.data,stream:this.mcuRemoteStream,volatile:!!this.restarted}),this.inviteSended=!0):qt.log("Invite already sended"))))},this.combineRemoteStreams=function(Tt,nt,Ct,yt){var Pt=Tt.getTracks(),Et=Ct.getTracks();if(Pt.length===1&&Et.length===1&&(Pt[0].kind==="audio"&&Et[0].kind==="video"||Pt[0].kind==="video"&&Et[0].kind==="audio")){qt.debug("combineRemoteStreams");var Ut=new MediaStream;return Ut.addTrack(Pt[0]),Ut.addTrack(Et[0]),yt==="internal"&&(Ct.removeTrack(Et[0]),this.onRemoteStreamRemoved({stream:Ct})),nt==="internal"&&(Tt.removeTrack(Pt[0]),this.onRemoteStreamRemoved({stream:Tt})),this.onRemoteStreamAdded({stream:Ut}),!0}return!1},this.checkRemoteStreamExists=function(Tt,nt){var Ct=!1,yt=null,Pt=null,Et=null,Ut=null,Ot=null;for(nt&&Array.isArray(nt)&&(Ut=nt.slice(0)),yt=this.remoteMediaStreams.length;--yt>=0;){if(this.remoteMediaStreams[yt].id===Tt){Ct=!0;break}if(Ut)for(Et=(Pt=this.remoteMediaStreams[yt].getTracks()).length;--Et>=0;)(Ot=nt.indexOf(Pt[Et].id))>=0&&(Ut[Ot]=!0)}if(!Ct&&Ut){for(Ot=0,Et=Ut.length;--Et>=0;)Ut[Et]===!0&&(Ot+=1);Ot===Ut.length&&(Ct=!0)}return Ct},this.onRemoteStreamAdded=function(Tt){var nt,Ct,yt=this;if(qt.info("onRemoteStreamAdded",Tt),this.checkRemoteStreamExists(Tt.stream.id,Tt.stream.getTracks().map(function(Jt){return Jt.id})))qt.debug("onRemoteStreamAdded: ignoring event; stream/track already known");else if(this.remoteMediaStreams.length!==1||!this.combineRemoteStreams(this.remoteMediaStreams[0],"internal",Tt.stream,"event")){qt.debug("onRemoteStreamAdded adding",Tt.stream.id),this.remoteMediaStreams.push(Tt.stream),qt.log("CallId is :"+this.callId),qt.log("ClientId is :"+Gt.clientId),this.sessionMCU&&this.sessionMCU.modeChangeKind==="new"&&Gt.processRemoteStreamAdded(this,Tt.stream),this.screenSharing===!0?this.callType="screenSharing":this.audioOnly===!0&&(this.callType="audio");var Pt,Et=function(Jt){var an=null,hn=null;Jt.onmute=function(rn){qt.debug(Jt.kind+" mute event");var dn="";Jt.kind==="audio"&&an===null?an=setTimeout(function(){yt.isRemoteAudioSilent=!0,dn="audioIsSilentLocally";var Sn={},wn={},An=[];An.push(dn),Sn.available=yt.remoteCallProfile.audio,Sn.active=yt.remoteCallProfile.audioActive,Sn.muted=yt.isRemoteAudioMuted,Sn.silent=yt.isRemoteAudioSilent,wn.available=yt.remoteCallProfile.video,wn.active=yt.remoteCallProfile.videoActive,wn.muted=yt.isRemoteVideoMuted,wn.silent=yt.isRemoteVideoSilent,yt.myWebRTC_Event.createRemoteStreamUpdatedEvent(An,Sn,wn,yt.destCallType,yt.callId,"browserAction"),an=null},2520):Jt.kind==="video"&&hn===null&&(hn=setTimeout(function(){yt.isRemoteVideoSilent=!0,dn="videoIsSilentLocally";var Sn={},wn={},An=[];An.push(dn),Sn.available=yt.remoteCallProfile.audio,Sn.active=yt.remoteCallProfile.audioActive,Sn.muted=yt.isRemoteAudioMuted,Sn.silent=yt.isRemoteAudioSilent,wn.available=yt.remoteCallProfile.video,wn.active=yt.remoteCallProfile.videoActive,wn.muted=yt.isRemoteVideoMuted,wn.silent=yt.isRemoteVideoSilent,yt.myWebRTC_Event.createRemoteStreamUpdatedEvent(An,Sn,wn,yt.destCallType,yt.callId,"browserAction"),hn=null},2520))},Jt.onunmute=function(rn){if(qt.debug(Jt.kind+" unmute event"),Jt.kind==="audio"&&an!==null)clearTimeout(an),an=null;else if(Jt.kind==="video"&&hn!==null)clearTimeout(hn),hn=null;else{var dn="";Jt.kind==="audio"?(yt.isRemoteAudioSilent=!1,dn="audioIsSilentLocally"):Jt.kind==="video"&&(yt.isRemoteVideoSilent=!1,dn="videoIsSilentLocally");var Sn={},wn={},An=[];An.push(dn),Sn.available=yt.remoteCallProfile.audio,Sn.active=yt.remoteCallProfile.audioActive,Sn.muted=yt.isRemoteAudioMuted,Sn.silent=yt.isRemoteAudioSilent,wn.available=yt.remoteCallProfile.video,wn.active=yt.remoteCallProfile.videoActive,wn.muted=yt.isRemoteVideoMuted,wn.silent=yt.isRemoteVideoSilent,yt.myWebRTC_Event.createRemoteStreamUpdatedEvent(An,Sn,wn,yt.destCallType,yt.callId,"browserAction")}},Jt.onended=function(rn){qt.debug(Jt.kind+" ended event"),Jt.kind==="audio"&&an!==null?(clearTimeout(an),an=null):Jt.kind==="video"&&hn!==null&&(clearTimeout(hn),hn=null)}},Ut=gn(Tt.stream.getVideoTracks());try{for(Ut.s();!(Pt=Ut.n()).done;){var Ot=Pt.value;Et(Ot),this.isRemoteVideoSilent=Ot.muted}}catch(Jt){Ut.e(Jt)}finally{Ut.f()}var Bt,Qt=gn(Tt.stream.getAudioTracks());try{for(Qt.s();!(Bt=Qt.n()).done;){var en=Bt.value;Et(en),this.isRemoteAudioSilent=en.muted}}catch(Jt){Qt.e(Jt)}finally{Qt.f()}nt={available:this.remoteCallProfile.audio,active:this.remoteCallProfile.audioActive,muted:this.isRemoteAudioMuted,silent:this.isRemoteAudioSilent},Ct={available:this.remoteCallProfile.video,active:this.remoteCallProfile.videoActive,muted:this.isRemoteVideoMuted,silent:this.isRemoteVideoSilent},this.data!==null?this.data.mesh!==void 0?Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Tt.stream,this.remoteId,this.destCallType,nt,Ct):this.data.type==="publish"&&this.data.mode!=="passive"?qt.warn("Filtering Remote stream added event (behavior on Chrome 44), no remote stream on publish calls"):this.data.subscribeOrder===!0&&this.data.pubCallId!==void 0?(qt.debug("substitute callId: "+this.callId+" -> "+this.data.pubCallId),Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.data.pubCallId,Tt.stream,this.remoteId,this.destCallType,nt,Ct)):Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Tt.stream,this.remoteId,this.destCallType,nt,Ct):Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Tt.stream,this.remoteId,this.destCallType,nt,Ct)}},this.onRemoteTrackAdded=function(Tt){var nt,Ct;if(qt.info("onRemoteTrackAdded",Tt),Tt.streams[0]!==void 0&&Tt.track!==void 0){if(this.checkRemoteStreamExists(Tt.streams[0].id,[Tt.track.id]))qt.debug("onRemoteTrackAdded: ignoring event; stream/track already known");else if(this.remoteMediaStreams.length!==1||!this.combineRemoteStreams(this.remoteMediaStreams[0],"internal",Tt.streams[0],"event")){if(this.belongsToRoom()){if(this.callType==="audio"&&Tt.track.kind!=="audio"||this.callType==="videoOnly"&&Tt.track.kind!=="video"||this.callType==="media"&&Tt.track.kind!=="video"||this.callType==="screenSharing"&&Tt.track.kind!=="video"||this.callType==="screenSharingWithAudio"&&Tt.track.kind!=="video")return void qt.debug("onRemoteTrackAdded: ignoring event; callType: "+this.callType+", event.track.kind: "+Tt.track.kind)}else if(this.destCallType==="audio"&&Tt.track.kind!=="audio"||this.destCallType==="videoOnly"&&Tt.track.kind!=="video"||this.destCallType==="media"&&Tt.track.kind!=="video"||this.destCallType==="screenSharing"&&Tt.track.kind!=="video"||this.destCallType==="screenSharingWithAudio"&&Tt.track.kind!=="video")return qt.debug("onRemoteTrackAdded: ignoring event; destCallType: "+this.destCallType+", event.track.kind: "+Tt.track.kind),void(this.remoteMediaStreams.length===2&&this.combineRemoveStreams(this.remoteMediaStreams[0],"internal",this.remoteMediaStreams[1],"internal"));qt.debug("onRemoteTrackAdded adding; stream.id: "+Tt.streams[0].id),this.remoteMediaStreams.push(Tt.streams[0]),qt.log("CallId is :"+this.callId),qt.log("ClientId is :"+Gt.clientId),qt.log("this.callType :"+this.callType),this.screenSharing===!0?this.callType="screenSharing":this.audioOnly===!0&&(this.callType="audio"),this.sessionMCU&&this.sessionMCU.modeChangeKind==="new"&&Gt.processRemoteStreamAdded(this,Tt.streams[0]),Tt.streams[0].onaddtrack=function(yt){qt.debug("onRemoteTrackAdded ontrack.onaddtrack",yt)},Tt.streams[0].onremovetrack=(function(yt){var Pt=null;if(qt.debug("onRemoteTrackAdded ontrack.onremovetrack",yt),this.updateOngoingTimeoutId)return qt.debug("onRemoteTrackAdded onremovetrack: update ongoing"),void qt.debug("onRemoteTrackAdded onremovetrack: ignoring event",yt.track.kind);if(this.callType==="audio"&&yt.track.kind!=="audio"||this.callType==="videoOnly"&&yt.track.kind!=="video"||this.callType==="media"&&yt.track.kind!=="video"||this.callType==="screenSharing"&&yt.track.kind!=="video"||this.callType==="screenSharingWithAudio"&&yt.track.kind!=="video")qt.debug("onRemoteTrackAdded onremovetrack: ignoring event",yt.track.kind);else if(yt.target instanceof MediaStream){for(Pt=this.remoteMediaStreams.length;--Pt>=0;)if(this.remoteMediaStreams[Pt].id===yt.target.id){qt.debug("onRemoteTrackAdded onremovetrack removing",yt.target.id),this.remoteMediaStreams.splice(Pt,1);break}Gt.myWebRTC_Event.createRemoteStreamRemovedEvent(this.callType,this.callId,yt.target,this.remoteId,this.destCallType)}else qt.debug("onRemoteTrackAdded onremovetrack: ignoring event target not MediaStream")}).bind(this),nt={available:this.remoteCallProfile.audio,active:this.remoteCallProfile.audioActive,muted:this.isRemoteAudioMuted,silent:this.isRemoteAudioSilent},Ct={available:this.remoteCallProfile.video,active:this.remoteCallProfile.videoActive,muted:this.isRemoteVideoMuted,silent:this.isRemoteVideoSilent},this.data!==null?this.data.mesh!==void 0?(this.callType==="audio"&&Tt.track.kind==="audio"||this.callType==="videoOnly"&&Tt.track.kind==="video"||this.callType==="media"&&Tt.track.kind==="video"||this.callType==="screenSharing"&&Tt.track.kind==="video"||this.callType==="screenSharingWithAudio"&&Tt.track.kind==="video")&&Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Tt.streams[0],this.remoteId,this.destCallType,nt,Ct):this.data.type==="publish"&&this.data.mode!=="passive"?qt.warn("Filtering Remote stream added event (behavior on Chrome 44), no remote stream on publish calls"):this.belongsToRoom()?(this.callType==="audio"&&Tt.track.kind==="audio"||this.callType==="videoOnly"&&Tt.track.kind==="video"||this.callType==="media"&&Tt.track.kind==="video"||this.callType==="screenSharing"&&Tt.track.kind==="video"||this.callType==="screenSharingWithAudio"&&Tt.track.kind==="video")&&(this.data.subscribeOrder===!0&&this.data.pubCallId!==void 0?(qt.debug("substitute callId: "+this.callId+" -> "+this.data.pubCallId),Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.data.pubCallId,Tt.streams[0],this.remoteId,this.destCallType,nt,Ct)):Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Tt.streams[0],this.remoteId,this.destCallType,nt,Ct)):(this.destCallType==="audio"&&Tt.track.kind==="audio"||this.destCallType==="videoOnly"&&Tt.track.kind==="video"||this.destCallType==="media"&&Tt.track.kind==="video"||this.destCallType==="screenSharing"&&Tt.track.kind==="video"||this.destCallType==="screenSharingWithAudio"&&Tt.track.kind==="video")&&Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Tt.streams[0],this.remoteId,this.destCallType,nt,Ct):this.belongsToRoom()?(this.callType==="audio"&&Tt.track.kind==="audio"||this.callType==="videoOnly"&&Tt.track.kind==="video"||this.callType==="media"&&Tt.track.kind==="video"||this.callType==="screenSharing"&&Tt.track.kind==="video"||this.callType==="screenSharingWithAudio"&&Tt.track.kind==="video")&&Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Tt.streams[0],this.remoteId,this.destCallType,nt,Ct):(this.destCallType==="audio"&&Tt.track.kind==="audio"||this.destCallType==="videoOnly"&&Tt.track.kind==="video"||this.destCallType==="media"&&Tt.track.kind==="video"||this.destCallType==="screenSharing"&&Tt.track.kind==="video"||this.destCallType==="screenSharingWithAudio"&&Tt.track.kind==="video")&&Gt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Tt.streams[0],this.remoteId,this.destCallType,nt,Ct)}}else qt.debug("onRemoteTrackAdded: ignoring event; event data are not correct")},this.onRemoteStreamRemoved=function(Tt){var nt=null;for(qt.info("onRemoteStreamRemoved",Tt),nt=this.remoteMediaStreams.length;--nt>=0;)if(this.remoteMediaStreams[nt].id===Tt.stream.id){qt.debug("onRemoteStreamRemoved removing",Tt.stream.id),this.remoteMediaStreams.splice(nt,1);break}Gt.myWebRTC_Event.createRemoteStreamRemovedEvent(this.callType,this.callId,Tt.stream,this.remoteId,this.destCallType),Tt=null},this.onNegotiationNeeded=function(Tt){qt.debug("onNegotiationNeeded",Tt),Tt=null,this.addingDataChannelOnCallOngoing&&(this.updateMediaWithRetryManagement(!1),this.addingDataChannelOnCallOngoing=!1)},this.onSignalingStateChange=function(Tt){qt.debug("onSignalingStateChange",Tt),Tt=null},this.onCallDisconnection=function(){qt.info("onCallDisconnection; callId: "+this.callId);var Tt=new Date;qt.debug("date:",Tt),this.disconnectionWarningInterval!==0&&(qt.debug("date:",Tt),qt.debug("clearing disconnectionWarningInterval"),clearInterval(this.disconnectionWarningInterval),this.disconnectionWarningInterval=0),this.disconnectionWarningTimeout!==0&&(qt.debug("date:",Tt),qt.debug("clearing disconnectionWarningTimeout"),clearTimeout(this.disconnectionWarningTimeout),this.disconnectionWarningTimeout=0),this.belongsToRoom()?Gt.onHangup(this.callId,"disconnected"):Gt.onHangup(this.callId,"Ice_disconnected")},this.sendDisconnectionWarning=function(){qt.log("sendDisconnectionWarning()");var Tt=null,nt=null;if(this.callControl&&(Tt=this.callControl.roomName,nt=this.callControl.type),this.disconnectionWarningCount++,fn.createEvent({eventType:"disconnectionWarning",callId:this.callId,remoteId:this.remoteId,tries:this.disconnectionWarningCount,roomName:Tt,settingUpType:nt}),(this.disconnectionWarningCount-1)*this.disconnectionWarningDelay>=this.disconnectionTimer&&this.disconnectionWarningInterval!==0){var Ct=Date();qt.debug("date :"+Ct),qt.debug("clearing disconnectionWarningInterval : no more warnings"),clearInterval(this.disconnectionWarningInterval),this.disconnectionWarningInterval=0}},this.createIceErrorDescriptor=function(Tt,nt){var Ct={};return Tt==="disconnected"?Ct.iceState="disconnected":Tt==="failed"?(Ct.iceState="failed",nt===!0&&(Ct.previousIceState="disconnected")):Ct.iceState="unknown",Ct.callType=this.callType,this.belongsToRoom()?(Ct.context="conf",this.data.mesh?(Ct.mode="mesh",(this.data.mesh.callerCompositeUserId?this.data.mesh.callerCompositeUserId===Gt.compositeClientId:this.data.mesh.callerId===Gt.clientId)?(Ct.type="subscribe",Ct.clientId=this.data.mesh.callerId,Ct.remoteId=this.data.mesh.calleeId):(this.data.mesh.calleeCompositeUserId?this.data.mesh.calleeCompositeUserId===Gt.compositeClientId:this.data.mesh.calleeId===Gt.clientId)?(Ct.type="publish",Ct.clientId=this.data.mesh.calleeId,Ct.remoteId=this.data.mesh.callerId):Ct.type="unknown",Ct.mesh=this.data.mesh):(Ct.mode="sfu",this.settingUpType==="publish"||this.settingUpType==="shareScreen"?Ct.type="publish":this.settingUpType==="subscribe"?Ct.type="subscribe":Ct.type="unknown",this.callee?(Ct.clientId=this.calleeId,Ct.remoteId=this.callerId):(Ct.clientId=this.callerId,Ct.remoteId=this.calleeId)),this.mcuRemoteStream&&(Ct.stream=this.mcuRemoteStream)):(Ct.context="call",Ct.mode="p2p",this.callerId===Gt.clientId?(Ct.clientId=this.callerId,Ct.remoteId=this.calleeId):this.calleeId===Gt.clientId&&(Ct.clientId=this.calleeId,Ct.remoteId=this.callerId)),Ct},this.onIceConnectionStateChange=function(Tt){qt.debug("onIceConnectionStateChange: ",Tt),Tt=null;var nt=0,Ct=null,yt=null,Pt=null;this.pc!==null?(qt.info("Ice Connection State is now : "+this.pc.iceConnectionState),this.iceState=this.pc.iceConnectionState,this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed"||this.pc.iceConnectionState==="checking"?(qt.debug("iceConnectionState === connected or completed or checking"),qt.debug("this.disconnectionTimeoutId :"+this.disconnectionTimeoutId),this.disconnectionTimeoutId!==0&&(nt=Date(),qt.debug("date:",nt),qt.debug("clearing disconnectionTimeout"),clearTimeout(this.disconnectionTimeoutId),this.disconnectionTimeoutId=0),this.disconnectionWarningInterval!==0&&(nt=Date(),qt.debug("date:",nt),qt.debug("clearing disconnectionWarningInterval"),clearInterval(this.disconnectionWarningInterval),this.disconnectionWarningInterval=0),this.pc.iceConnectionState!=="checking"&&(this.checkCandidateTypesTimeoutId=setTimeout(this.callback(this,"checkCandidateTypes"),this.checkCandidateTypesTimer),this.checkCandidateTypesTimeoutTable.push(this.checkCandidateTypesTimeoutId))):this.pc.iceConnectionState==="disconnected"?(this.callControl&&(Ct=this.callControl.roomName,yt=this.callControl.type),(Pt=this.createIceErrorDescriptor("disconnected")).context==="conf"&&this.myWebRTC_Stack.sendInfo("iceError",{clientId:Gt.clientId,callId:this.callId,roomId:this.sessionMCU.roomName,pubSub:Gt.MCUClient.pubConnector,descriptor:Pt}),qt.warn("disconnection detected"),fn.createErrorEvent("iceDisconnection detected","ICE_CONNECTION_STATE_DISCONNECTED",this.callId,Ct,yt,Pt),nt=new Date,qt.debug("date:",nt),this.disconnectionTimeoutId=setTimeout(this.callback(this,"onCallDisconnection"),this.disconnectionTimer),this.disconnectionWarningCount=0,this.disconnectionWarningTimeout=setTimeout(this.callback(this,"sendDisconnectionWarning"),2e3),this.disconnectionWarningInterval=setInterval(this.callback(this,"sendDisconnectionWarning"),this.disconnectionWarningDelay)):this.pc.iceConnectionState==="failed"&&(this.callControl&&(Ct=this.callControl.roomName,yt=this.callControl.type),(Pt=this.createIceErrorDescriptor("failed",this.disconnectionTimeoutId!==0)).context==="conf"&&this.myWebRTC_Stack.sendInfo("iceError",{clientId:Gt.clientId,callId:this.callId,roomId:this.sessionMCU.roomName,pubSub:Gt.MCUClient.pubConnector,descriptor:Pt}),qt.warn("iceConnection failed detected"),fn.createErrorEvent("iceConnection failed detected","ICE_CONNECTION_STATE_FAILED",this.callId,Ct,yt,Pt),this.disconnectionTimeoutId!==0?this.belongsToRoom()&&(clearTimeout(this.disconnectionTimeoutId),this.disconnectionTimeoutId=0,Gt.onHangup(this.callId,"disconnected")):this.belongsToRoom()&&(0,st.ki)(this.callControl,["autoRestart","counter"],"number")&&this.callControl.autoRestart.counter>0?Gt.onHangup(this.callId,"disconnected"):(qt.warn("Removing call with callId: "+this.callId),Gt.removeCallFromTableWithCallIdAndSendBye(this.callId,"Ice_failed")))):qt.log("Ice Connection State change with pc is null")},this.callback=function(Tt,nt){return this.closureHandler=function(Ct,yt){return Tt[nt](Ct,yt)},this.closureHandler},this.onSelectedCandidate=function(Tt){if(this.selectedCandidate===void 0||this.selectedCandidate===null||this.selectedCandidate.LocalCandidateType!==Tt.LocalCandidateType||this.selectedCandidate.RemoteCandidateType!==Tt.RemoteCandidateType||this.selectedCandidate.LocalAddress!==Tt.LocalAddress||this.selectedCandidate.RemoteAddress!==Tt.RemoteAddress||this.selectedCandidate.TransportType!==Tt.TransportType||this.selectedCandidate.LocalTransportType!==Tt.LocalTransportType){qt.debug("WebRTC_Call::onSelectedCandidate() :",Tt),this.selectedCandidate=Tt,this.callControl&&this.callControl.autoRestart&&(qt.debug("selectedCandidate, this.callControl.autoRestart.counter:",this.callControl.autoRestart.counter),qt.debug("selectedCandidate, this.callControl.autoRestart.callIdWhenStartingTimer:",this.callControl.autoRestart.callIdWhenStartingTimer),this.callControl.autoRestart.counter&&(qt.debug("Reinit of autoRestart.counter"),this.callControl.autoRestart.counter=0,this.callControl.autoRestart.callIdWhenStartingTimer!==void 0&&Gt.stopMaxCallRetriesTimer(this.callControl.autoRestart.callIdWhenStartingTimer))),this.myWebRTC_Event.createSelectedICECandidateEvent(this.callId,Tt.LocalCandidateType,Tt.RemoteCandidateType,Tt.LocalAddress,Tt.RemoteAddress,Tt.TransportType,Tt.LocalTransportType);var nt=Tt;nt.callId=this.callId,nt.clientId=Gt.clientId,nt.roomId=this.dest_roomId,this.data.pubSub!==void 0&&(nt.pubSub=this.data.pubSub),this.data.confId!==void 0&&(nt.confId=this.data.confId),this.data.mesh!==void 0&&(nt.mesh=this.data.mesh),this.data.instanceId!==void 0&&(nt.instanceId=this.data.instanceId),this.myWebRTC_Stack.sendInfo("callSelectedCandidate",nt)}else qt.debug("filtering duplicate candidate")},this.checkCandidateTypes=function(){qt.debug("WebRTC_Call::checkCandidatesTypes()");var Tt=this,nt={LocalCandidateType:"unknow",RemoteCandidateType:"unknow",LocalAddress:"unknow",RemoteAddress:"unknow",TransportType:"unknow",LocalTransportType:"unknow",relayTransportType:"unknow"},Ct=["googLocalAddress","googLocalCandidateType","googRemoteAddress","googRemoteCandidateType","googTransportType"];this.pc===null?(qt.warn("Peer connection is null : no candidates"),Tt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Tt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Tt.onSelectedCandidate(nt)):typeof apiRTC_React<"u"?(qt.warn("apiRTC_React : no info on candidates"),Tt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Tt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Tt.onSelectedCandidate(nt)):st.wL.type==="chrome"&&ot.PR<=112?(qt.debug("WebRTC_Call::checkCandidatesTypes() chrome <= 112"),this.pc.getStats(function(yt){var Pt=yt.result().filter(function(Et){return Et.id.indexOf("Conn-")===0&&Et.stat("googActiveConnection")==="true"})[0];Pt?(Ct.forEach(function(Et){nt[Et.replace("goog","")]=Pt.stat(Et)}),Tt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Tt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Tt.onSelectedCandidate(nt)):(Tt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Tt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Tt.onSelectedCandidate(nt))})):st.wL.type==="chrome"||st.wL.type==="firefox"||st.wL.type==="safari"?(qt.debug("WebRTC_Call::checkCandidatesTypes()"),this.pc.getStats(null).then(function(yt){var Pt=null;if(yt.forEach(function(Ot){Ot.selected===!0&&st.wL.type==="firefox"?(Pt!==null&&qt.warn("multiple selected candidate-pairs"),Pt=Ot):Ot.nominated===!0&&(Pt=Ot)}),Pt!==null){var Et=yt.get(Pt.localCandidateId),Ut=yt.get(Pt.remoteCandidateId);nt.LocalCandidateType=Et.candidateType,nt.RemoteCandidateType=Ut.candidateType,Et.address&&Et.port?nt.LocalAddress=Et.address+":"+Et.port:Et.ipAddress&&Et.portNumber&&(nt.LocalAddress=Et.ipAddress+":"+Et.portNumber),Ut.address&&Ut.port?nt.RemoteAddress=Ut.address+":"+Ut.port:Ut.ipAddress&&Ut.portNumber&&(nt.RemoteAddress=Ut.ipAddress+":"+Ut.portNumber),nt.TransportType=Et.protocol,Et.candidateType==="relay"&&Et.relayProtocol!==void 0&&(nt.relayTransportType=Et.relayProtocol),Tt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Tt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Tt.onSelectedCandidate(nt)}}).catch(function(yt){qt.warn("failed to get stats",yt)})):(qt.debug("checkCandidateTypes not Chrome or Firefox"),Tt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Tt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Tt.onSelectedCandidate(nt))},this.belongsToRoom=function(){return!!(0,st.ki)(this.sessionMCU,"roomName","string")&&((0,st.ki)(this.data,"MCUType","string")&&(this.data.MCUType==="MCU-Caller"||this.data.MCUType==="MCU-Callee")&&(0,st.ki)(this.data,"confId","string")?this.data.confId===this.sessionMCU.roomName:this.dest_roomId===this.sessionMCU.roomName)},this.setLocalCallProfile=function(Tt){var nt=arguments.length>1&&arguments[1]!==void 0&&arguments[1],Ct=[],yt={},Pt={},Et=null,Ut=null,Ot="adaptation";this.dataCall!==!0&&this.settingUpType!=="subscribe"&&(this.localCallProfile.audioActive!==Tt.audioActive&&Ct.push("audioIsActive"),this.localCallProfile.videoActive!==Tt.videoActive&&Ct.push("videoIsActive"),this.localCallProfile=Tt,this.screenSharing===!0?this.localCallProfile.audioActive===!0&&this.localCallProfile.videoActive===!0?this.callType!=="screenSharingWithAudio"&&(this.callType="screenSharingWithAudio",Ct.push("callType")):this.localCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",Ct.push("callType")):this.localCallProfile.videoActive===!0?this.callType!=="screenSharing"&&(this.callType="screenSharing",Ct.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",Ct.push("callType")):this.localCallProfile.audioActive===!0&&this.localCallProfile.videoActive===!0?this.callType!=="media"&&(this.callType="media",Ct.push("callType")):this.localCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",Ct.push("callType")):this.localCallProfile.videoActive===!0?this.callType!=="videoOnly"&&(this.callType="videoOnly",Ct.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",Ct.push("callType")),nt===!0&&Ct.length>0&&(yt.available=this.localCallProfile.audio,yt.active=this.localCallProfile.audioActive,yt.muted=this.isLocalAudioMuted,yt.silent=this.isRemoteAudioSilent,Pt.available=this.localCallProfile.video,Pt.active=this.localCallProfile.videoActive,Pt.muted=this.isLocalVideoMuted,Pt.silent=this.isRemoteVideoSilent,this.callConfiguration&&this.callConfiguration.userMediaStreamId&&(Et=this.callConfiguration.userMediaStreamId,(Ut=apiCC.getUserMediaStream(Et))&&(yt.deviceLabel=Ut.audioDeviceLabel,Pt.deviceLabel=Ut.videoDeviceLabel)),this.updateCause&&(Ot=this.updateCause),this.myWebRTC_Event.createLocalStreamUpdatedEvent(Ct,yt,Pt,!0,this.callType,this.callId,this.callLocalStream,Et,Ot)))},this.setRemoteCallProfile=function(Tt){var nt=arguments.length>1&&arguments[1]!==void 0&&arguments[1],Ct=[],yt={},Pt={},Et="adaptation";this.dataCall!==!0&&(this.remoteCallProfile.audioActive!==Tt.audioActive&&Ct.push("audioIsActive"),this.remoteCallProfile.videoActive!==Tt.videoActive&&Ct.push("videoIsActive"),this.remoteCallProfile=Tt,this.settingUpType==="subscribe"?(this.screenSharing===!0?this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.callType!=="screenSharingWithAudio"&&(this.callType="screenSharingWithAudio",Ct.push("callType")):this.remoteCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",Ct.push("callType")):this.remoteCallProfile.videoActive===!0?this.callType!=="screenSharing"&&(this.callType="screenSharing",Ct.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",Ct.push("callType")):this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.callType!=="media"&&(this.callType="media",Ct.push("callType")):this.remoteCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",Ct.push("callType")):this.remoteCallProfile.videoActive===!0?this.callType!=="videoOnly"&&(this.callType="videoOnly",Ct.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",Ct.push("callType")),nt===!0&&Ct.length>0&&(yt.available=this.remoteCallProfile.audio,yt.active=this.remoteCallProfile.audioActive,yt.muted=this.isRemoteAudioMuted,yt.silent=this.isRemoteAudioSilent,Pt.available=this.remoteCallProfile.video,Pt.active=this.remoteCallProfile.videoActive,Pt.muted=this.isRemoteVideoMuted,Pt.silent=this.isRemoteVideoSilent,this.updateCause&&(Et=this.updateCause),this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Ct,yt,Pt,this.callType,this.callId,Et))):(this.screenSharing===!0?this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.destCallType!=="screenSharingWithAudio"&&(this.destCallType="screenSharingWithAudio",Ct.push("callType")):this.remoteCallProfile.audioActive===!0?this.destCallType!=="audio"&&(this.destCallType="audio",Ct.push("callType")):this.remoteCallProfile.videoActive===!0?this.destCallType!=="screenSharing"&&(this.destCallType="screenSharing",Ct.push("callType")):this.destCallType!=="inactive"&&(this.destCallType="inactive",Ct.push("callType")):this.settingUpType!=="publish"&&this.settingUpType!=="shareScreen"||(this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.destCallType!=="media"&&(this.destCallType="media",Ct.push("callType")):this.remoteCallProfile.audioActive===!0?this.destCallType!=="audio"&&(this.destCallType="audio",Ct.push("callType")):this.remoteCallProfile.videoActive===!0?this.destCallType!=="videoOnly"&&(this.destCallType="videoOnly",Ct.push("callType")):this.destCallType!=="inactive"&&(this.destCallType="inactive",Ct.push("callType"))),nt===!0&&Ct.length>0&&(yt.available=this.remoteCallProfile.audio,yt.active=this.remoteCallProfile.audioActive,yt.muted=this.isRemoteAudioMuted,yt.silent=this.isRemoteAudioSilent,Pt.available=this.remoteCallProfile.video,Pt.active=this.remoteCallProfile.videoActive,Pt.muted=this.isRemoteVideoMuted,Pt.silent=this.isRemoteVideoSilent,this.updateCause&&(Et=this.updateCause),this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Ct,yt,Pt,this.destCallType,this.callId,Et))))},this.setMediaConstraintsToSendOnlyOffer=function(){st.wL.type==="firefox"?ot.PR>43?this.mediaConstraints={offerToReceiveAudio:!1,offerToReceiveVideo:!1}:this.mediaConstraints={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}:st.wL.type==="edge"?this.mediaConstraints={offerToReceiveAudio:0,offerToReceiveVideo:0}:st.wL.type==="chrome"&&st.wL.version<55?this.mediaConstraints={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}:this.mediaConstraints={offerToReceiveAudio:!1,offerToReceiveVideo:!1,mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},this.mediaConstraintsAudioOnly=this.mediaConstraints},this.applyOutgoingBitrate=function(Tt){var nt=this;qt.debug("applyOutgoingBitrate",this.callId,Tt);for(var Ct=null,yt=0;yt<this.rtpSenders.video.length;yt+=1)if(this.rtpSenders.video[yt].track){Ct=this.rtpSenders.video[yt];break}if(Ct)if(typeof Ct.getParameters=="function"&&typeof Ct.setParameters=="function"){var Pt=Ct.getParameters();if(Object.prototype.hasOwnProperty.call(Pt,"encodings")){if(Pt.encodings.length!==1)return void qt.debug("encodings cannot be changed",this.callId,Pt.encodings.length)}else Pt.encodings=[{}];if(Tt!==null&&typeof Tt=="number"){Tt<50&&(Tt=50);var Et=1e3*Tt;if(Pt.encodings[0].maxBitrate===Et)return;Pt.encodings[0].maxBitrate=Et}else{if(!Object.prototype.hasOwnProperty.call(Pt.encodings[0],"maxBitrate"))return;delete Pt.encodings[0].maxBitrate}Ct.setParameters(Pt).catch(function(Ut){qt.error("applyOutgoingBitrate - setParameters",nt.callId,Ut)})}else qt.warn("no such functions: getParameters/setParameters",this.callId);else qt.warn("no such video rtpSender",this.callId)},this.configureSimulcastEncodings=function(Tt){var nt=this,Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(qt.debug("configureSimulcastEncodings",this.callId,Tt,Ct.maxBitrate),this.simulcast==="RID"){for(var yt=null,Pt=0;Pt<this.rtpSenders.video.length;Pt+=1)if(this.rtpSenders.video[Pt].track){yt=this.rtpSenders.video[Pt];break}if(yt)if(typeof yt.getParameters=="function"&&typeof yt.setParameters=="function"){var Et=yt.getParameters();if(Object.prototype.hasOwnProperty.call(Et,"encodings"))if(Et.encodings.length===3){for(var Ut=null,Ot=null,Bt=null,Qt=Et.encodings.length;--Qt>=0;){var en=Et.encodings[Qt];Ut||en.rid!=="h"?Ot||en.rid!=="m"?Bt||en.rid!=="l"||(Bt=en):Ot=en:Ut=en}if(Ut&&Object.prototype.hasOwnProperty.call(Ut,"maxBitrate")&&Ot&&Object.prototype.hasOwnProperty.call(Ot,"maxBitrate")&&Bt&&Object.prototype.hasOwnProperty.call(Bt,"maxBitrate")){var Jt=!1,an=Math.floor(Bt.maxBitrate/1e3),hn=!1,rn=!1;if(Ut.active&&Ut.maxBitrate>1&&(an+=Math.floor(Ut.maxBitrate/1e3),hn=!0),Ot.active&&Ot.maxBitrate>1&&(an+=Math.floor(Ot.maxBitrate/1e3),rn=!0),qt.debug("currentStatus",an,hn,rn),Tt==="changeMaxBitrate"){if(!(0,st.ki)(Ct,"maxBitrate","number"))return;var dn=Ct.maxBitrate;an<=dn?(rn||an+this.callConfiguration.simulcast.encodings.medium.maxBitrate<=dn&&(st.wL.type==="chrome"?Ot.active=!0:st.wL.type==="firefox"&&(Ot.maxBitrate=1e3*this.callConfiguration.simulcast.encodings.medium.maxBitrate),this.callConfiguration.simulcast.encodings.medium.active=!0,rn=!0,an+=this.callConfiguration.simulcast.encodings.medium.maxBitrate,Jt=!0),hn||an+this.callConfiguration.simulcast.encodings.high.maxBitrate<=dn&&(st.wL.type==="chrome"?Ut.active=!0:st.wL.type==="firefox"&&(Ut.maxBitrate=1e3*this.callConfiguration.simulcast.encodings.high.maxBitrate),this.callConfiguration.simulcast.encodings.high.active=!0,hn=!0,an+=this.callConfiguration.simulcast.encodings.high.maxBitrate,Jt=!0)):(hn&&(hn=!1,this.callConfiguration.simulcast.encodings.high.active=!1,an-=Math.floor(Ut.maxBitrate/1e3),st.wL.type==="chrome"?Ut.active=!1:st.wL.type==="firefox"&&(Ut.maxBitrate=1),Jt=!0),an>dn&&rn&&(rn=!1,this.callConfiguration.simulcast.encodings.medium.active=!1,an-=Math.floor(Ot.maxBitrate/1e3),st.wL.type==="chrome"?Ot.active=!1:st.wL.type==="firefox"&&(Ot.maxBitrate=1),Jt=!0))}else Tt==="disableEncoding"&&(hn?(hn=!1,this.callConfiguration.simulcast.encodings.high.active=!1,an-=Math.floor(Ut.maxBitrate/1e3),st.wL.type==="chrome"?Ut.active=!1:st.wL.type==="firefox"&&(Ut.maxBitrate=1),Jt=!0):rn&&(rn=!1,this.callConfiguration.simulcast.encodings.medium.active=!1,an-=Math.floor(Ot.maxBitrate/1e3),st.wL.type==="chrome"?Ot.active=!1:st.wL.type==="firefox"&&(Ot.maxBitrate=1),Jt=!0));qt.debug("applyChanges",an,hn,rn,Jt),Jt&&(yt.setParameters(Et).catch(function(Sn){qt.error("configureEncodings - setParameters",nt.callId,Sn)}),this.myWebRTC_Stack.sendInfo("configureEncodings",{pubSub:Gt.MCUClient.pubConnector,clientId:Gt.clientId,roomId:this.sessionMCU.roomName,callId:this.callId,instanceId:this.instanceId,hint:"simulcast",encodings:this.callConfiguration.simulcast.encodings}))}else qt.warn("cannot find h/m/l encodings",this.callId)}else qt.warn("wrong encodings",this.callId,Et.encodings.length);else qt.warn("no encodings configured",this.callId)}else qt.warn("no such functions: getParameters/setParameters",this.callId);else qt.warn("no such video rtpSender",this.callId)}}},Tn=(s(4363),s(9653),function(Gt){this.disconnectionTimer=15e3,Number.MAX_SAFE_INTEGER!==void 0?this.userMediaId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():this.userMediaId=Math.floor(1000001*Math.random()).toString(),this.callType="media",this.audio=!1,this.video=!1,this.audioSdpDirection=null,this.videoSdpDirection=null,this.callConfiguration={},this.sessionMCU=null,this.myWebRTC_Stack=new Rt.S(Gt.socket),this.getUserMediaStream=function(){return this.callConfiguration&&this.callConfiguration.userMediaStreamId?apiCC.getUserMediaStream(this.callConfiguration.userMediaStreamId):null},this.releaseUserMediaStream=function(){if(this.callConfiguration&&this.callConfiguration.userMediaStreamId){var Tt=this.callConfiguration.userMediaStreamId;return delete this.callConfiguration.userMediaStreamId,apiCC.releaseUserMediaStream(Tt,this.userMediaId)}return!1},this.close=function(){(this.addAck||this.addTimeoutId)&&(delete this.addAck,clearTimeout(this.addTimeoutId),delete this.addTimeoutId)}});function un(Gt){return un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Tt){return typeof Tt}:function(Tt){return Tt&&typeof Symbol=="function"&&Tt.constructor===Symbol&&Tt!==Symbol.prototype?"symbol":typeof Tt},un(Gt)}function mn(Gt,Tt){var nt=typeof Symbol<"u"&&Gt[Symbol.iterator]||Gt["@@iterator"];if(!nt){if(Array.isArray(Gt)||(nt=function(Ot,Bt){if(Ot){if(typeof Ot=="string")return yn(Ot,Bt);var Qt=Object.prototype.toString.call(Ot).slice(8,-1);return Qt==="Object"&&Ot.constructor&&(Qt=Ot.constructor.name),Qt==="Map"||Qt==="Set"?Array.from(Ot):Qt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Qt)?yn(Ot,Bt):void 0}}(Gt))||Tt&&Gt&&typeof Gt.length=="number"){nt&&(Gt=nt);var Ct=0,yt=function(){};return{s:yt,n:function(){return Ct>=Gt.length?{done:!0}:{done:!1,value:Gt[Ct++]}},e:function(Ot){throw Ot},f:yt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Pt,Et=!0,Ut=!1;return{s:function(){nt=nt.call(Gt)},n:function(){var Ot=nt.next();return Et=Ot.done,Ot},e:function(Ot){Ut=!0,Pt=Ot},f:function(){try{Et||nt.return==null||nt.return()}finally{if(Ut)throw Pt}}}}function yn(Gt,Tt){(Tt==null||Tt>Gt.length)&&(Tt=Gt.length);for(var nt=0,Ct=new Array(Tt);nt<Tt;nt++)Ct[nt]=Gt[nt];return Ct}var pn=et.Y.get("ApiCCMCUClient"),In=apiCC.myWebRTC_Event,kn=3e4,Mn=function(Gt,Tt){pn.debug("ApiCCMCUClient creation"),this.pubConnector="janusConnector",this.meshModeEnabled=!1,this.sessionMCUs=[],this.distantCalls=[],this.streamList=[],this.disputableStreamList=[],this.publishCallId=null,this.joinSessionReqs=[],this.transitionCount=0,this.browserCapabilities={updateStream:!0,mesh2janusTransition:!0,checkCallStatus:!0},this.receiveSessionId=function(nt){pn.debug("receiveSessionId()"),In.createMCUSessionCreationEvent(nt.sessionId,nt.token),this.publish(nt.sessionId,nt.token)},this.sendSessionInvitation=function(nt,Ct,yt){var Pt,Et;pn.debug("sendSessionInvitation()"),Ct!=null?(yt===void 0&&(yt=0),Pt={type:"MCUSessionInvitation",srcId:Tt,destId:nt,sessionId:Ct,groupChatId:yt},Et=JSON.stringify(Pt),pn.log("C->S: "+Et),apiCC.session.channel.socket.emit("MCUSessionInvitation",Et)):pn.log("Session is null or undefined, MCU Session invitation is not sended")},this.sendSessionInvitationToGroupChat=function(nt,Ct){if(pn.debug("sendSessionInvitationToGroupChat()"),nt!=null)if(Ct!=null){var yt,Pt;yt={type:"MCUSessionInvitationToGroupChat",srcId:Tt,groupChatId:nt,sessionId:Ct},Pt=JSON.stringify(yt),pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("MCUSessionInvitationToGroupChat",Pt)}else pn.log("Session is null or undefined, MCU Session invitation is not sended");else pn.log("groupChatId is null or undefined, MCU Session invitation is not sended")},this.receiveSessionInvitation=function(nt){pn.debug("receiveSessionInvitation()"),pn.log("msg.sessionId :"+nt.sessionId),pn.log("msg.token :"+nt.token),pn.log("msg.groupChatId :"+nt.groupChatId),In.createReceiveMCUSessionInvitationEvent(nt.sessionId,nt.token,nt.groupChatId,nt.srcId)},this.acceptSessionInvitation=function(nt,Ct){pn.debug("acceptSessionInvitation()"),pn.log("sessionId :"+nt),pn.log("token :"+Ct),this.publish(nt,Ct)},this.leaveSession=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};pn.info("leaveSession()");var yt=null,Pt=null,Et=null;if(!(Et=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0})))return new Error("leaveSession: session not set");Ct.noHangup!==!0&&(apiCC.session.apiCCWebRTCClient.webRTCClient.removeAllCallsFromRoom(Et.roomName,"leaveSession"),this.meshOnHangup(null,null,{roomId:Et.roomName}));var Ut=[],Ot={};Ut.push(Et.roomName),Ot.doneByApiRTC=!0,apiCC.session.leavePresenceGroup(Ut,Ot),apiCC.session.unsubscribePresenceGroup(Ut,Ot),yt={type:"leaveSession",roomId:Et.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector}},Pt=JSON.stringify(yt),pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("leaveSession",Pt),pn.debug("leaveSession: distant call clean up");for(var Bt=this.distantCalls.length;--Bt>=0;)this.distantCalls[Bt].roomId===Et.roomName&&(pn.debug("leaveSession: remove distant call descriptor",this.distantCalls[Bt]),this.distantCalls.splice(Bt,1));apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({multi:!0,roomName:Et.roomName});for(var Qt=this.streamList.length;--Qt>=0;)this.streamList[Qt].roomId===Et.roomName&&this.streamList.splice(Qt,1);return this.removeSessionMCU(Et),"OK"},this.createJoinSessionMessage=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=null;nt||(yt=Ct.hasOwnProperty("sessionMCU")?Ct.sessionMCU:this.getSessionMCU(null,{first:!0}))&&(nt=yt.roomName);var Pt=yt&&yt.roomMode==="mesh"||this.meshModeEnabled===!0||Ct.meshModeEnabled===!0,Et=yt&&yt.meshOnly===!0||Ct.meshOnlyEnabled===!0,Ut={type:"joinSession",roomId:nt,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector,meshModeEnabled:Pt,meshOnlyEnabled:Et,videoBandwidthSettings:apiCC.session.apiCCWebRTCClient.webRTCClient.videoBandwidthSettings,browserInfo:{browserAbout:ot.Xh+" "+ot.dc,browserType:st.wL.type,browserVersion:st.wL.version,osName:ot.BF,osVersion:ot.MM,deviceType:ot.vO}}};if(Ct.hasOwnProperty("transactionId")&&(Ut.transactionId=Ct.transactionId),Ct.hasOwnProperty("convId")?Ut.data.convId=Ct.convId:yt&&yt.hasOwnProperty("convId")&&(Ut.data.convId=yt.convId),Ct.moderationEnabled&&(Ut.data.moderationEnabled=!0),Ct.moderator&&(Ut.data.moderator=!0),Ct.qualityAdaptationEnabled&&(Ut.data.qualityAdaptationEnabled=!0),Array.isArray(Ct.supportedVideoCodecs)){Ut.data.supportedVideoCodecs=[];var Ot,Bt=mn(Ct.supportedVideoCodecs);try{for(Bt.s();!(Ot=Bt.n()).done;){var Qt=Ot.value;Qt==="h264"?Ut.data.supportedVideoCodecs.push({codec:"h264",profilelevelid:"42e01f"}):typeof Qt=="string"?Ut.data.supportedVideoCodecs.push({codec:Qt}):Ut.data.supportedVideoCodecs.push(Qt)}}catch(en){Bt.e(en)}finally{Bt.f()}}else st.wL.type==="safari"&&(ot.Xh==="Safari"&&ot.dc<12.1||ot.Xh==="Mobile Safari"&&ot.dc<12.1)&&(Ut.data.supportedVideoCodecs=[{codec:"h264",profilelevelid:"42e01f"}]);return Ut.data.capabilities=this.browserCapabilities,Ut},this.createSessionDescriptor=function(nt){var Ct={roomId:nt.roomName};return nt.convId&&(Ct.convId=nt.convId),nt.roomMode&&(Ct.roomMode=nt.roomMode),nt.modeChangeKind&&(Ct.modeChangeKind=nt.modeChangeKind),Ct},this.joinSession=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.getSessionMCU(nt))return pn.warn("joinSession: session already set"),new Error("joinSession: session already set");if(this.getJoinSessionReq(nt))return pn.warn("joinSession: session already requested"),new Error("joinSession: session already requested");var yt={};yt.roomId=nt,yt.transactionId=apiCC.randomString(12),this.joinSessionReqs.push(yt);var Pt=Object.assign({},Ct);Pt.transactionId=yt.transactionId,pn.info("joinSession() on ApiRTC MCU with roomId:",nt);var Et=this.createJoinSessionMessage(nt,Pt),Ut=JSON.stringify(Et);return pn.log("C->S: "+Ut),apiCC.session.channel.socket.emit("joinSession",Ut),"OK"},this.joinSessionAnswer=function(nt){if(pn.debug("joinSessionAnswer()"),this.getSessionMCU(nt.roomName))pn.warn("joinSessionAnswer: session already set");else{var Ct=null;if(nt.hasOwnProperty("transactionId")&&(Ct=this.getJoinSessionReq(null,{transactionId:nt.transactionId})),Ct||(Ct=this.getJoinSessionReq(nt.roomName)),Ct){this.removeJoinSessionReq(Ct);var yt={};if(yt.roomID=nt.sessionId,yt.roomName=nt.roomName,nt.hasOwnProperty("convId")&&(yt.convId=nt.convId),yt.joinSessionAnswer={},(0,st.ki)(nt,"data","object")?(nt.data.failed===!0?(yt.joinSessionAnswer.failed=!0,yt.joinSessionAnswer.reason=nt.data.reason):yt.joinSessionAnswer.failed=!1,nt.data.mode&&typeof nt.data.mode=="string"&&(yt.roomMode=nt.data.mode,pn.debug("session joined with mode; roomMode: "+yt.roomMode)),yt.roomMode==="mesh"&&nt.data.meshOnly===!0&&(yt.meshOnly=!0,pn.debug("meshOnly"))):yt.joinSessionAnswer.failed=!1,this.sessionMCUs.push(yt),!yt.joinSessionAnswer.failed){var Pt=[],Et={};Pt.push(nt.roomName),Et.doneByApiRTC=!0,apiCC.session.joinPresenceGroup(Pt,Et),apiCC.session.subscribePresenceGroup(Pt,Et)}In.createJoinMCUSessionAnswerEvent(nt.sessionId,nt.token,nt.groupChatId,nt.initiator,yt)}else pn.debug("joinSessionAnswer: no joinSession requested")}},this.changeSessionMode=function(nt,Ct){var yt=this.getSessionMCU(nt.roomName);if(yt)if(yt.roomMode==="mesh"){for(var Pt=0,Et=Gt.userMediaTable.length;--Et>=0;)if(Gt.userMediaTable[Et].sessionMCU===yt){pn.debug("changeSessionMode: userMedia",Gt.userMediaTable[Et]),Gt.userMediaTable[Et].distantCalls=[],Pt+=1;for(var Ut=this.distantCalls.length;--Ut>=0;)pn.debug("changeSessionMode: distantCall",this.distantCalls[Ut]),this.distantCalls[Ut].callMode==="mesh"&&this.distantCalls[Ut].callFeed.callId===Gt.userMediaTable[Et].userMediaId&&(pn.debug("changeSessionMode: match"),Gt.userMediaTable[Et].distantCalls.push(this.distantCalls[Ut]))}for(var Ot=0,Bt=Gt.callControlTable.length;--Bt>=0;)Gt.callControlTable[Bt].type==="subscribe"&&Gt.callControlTable[Bt].roomName===yt.roomName&&(Ot+=1,Gt.callControlTable[Bt].autoRestart.force=!0);if(In.createMCURoomModeChangedEvent(yt.roomName,"mesh","sfu","ongoing"),Pt===0&&Ot===0)delete yt.roomMode,In.createMCURoomModeChangedEvent(yt.roomName,"mesh","sfu","complete");else{yt.modeChangeKind="old";var Qt={};Qt.roomID=nt.roomName,Qt.roomName=nt.roomName,nt.hasOwnProperty("convId")&&(Qt.convId=nt.convId),Qt.joinSessionAnswer={failed:!1},Qt.modeChangeKind="new",Qt.transitionTimeoutId=setTimeout((function(en,Jt){delete Jt.transitionTimeoutId,Gt.finalizeMeshToJanusTransition(en,Jt,{force:!0})}).bind(this,yt,Qt),3e4),this.sessionMCUs.push(Qt),this.transitionCount+=1}}else pn.warn("changeSessionMode: session not using mesh mode");else pn.warn("changeSessionMode: no session")},this.updateSessionAnswer=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};pn.debug("updateSessionAnswer");var yt=this.getSessionMCU(nt.roomName);if(!yt){if(!Ct.createSession)return void pn.warn("updateSessionAnswer: no such session",nt.roomName);pn.debug("force session creation; roomName: "+nt.roomName),(yt={}).roomID=nt.roomName,yt.roomName=nt.roomName,nt.hasOwnProperty("convId")&&(yt.convId=nt.convId),yt.joinSessionAnswer={failed:!1},this.sessionMCUs.push(yt);for(var Pt=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length;--Pt>=0;){var Et=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[Pt];!Et.data||Et.data.MCUType!=="MCU-Caller"&&Et.data.MCUType!=="MCU-Callee"||Et.data.confId!==yt.roomName||(Et.sessionMCU=yt)}}var Ut=!1;if(nt.data&&nt.data.mode==="mesh"?(yt.roomMode="mesh",nt.data.meshOnly===!0&&(yt.meshOnly=!0)):(yt.roomMode==="mesh"&&(Ut=!0),delete yt.roomMode),yt.modeChangeKind==="new"){pn.debug("transition already ongoing");var Ot=this.getSessionMCU(null,{callback:function(dn){return dn.roomName===yt.roomName&&dn.modeChangeKind==="old"}});Ot&&Gt.finalizeMeshToJanusTransition(Ot,yt,{force:!0})}else if(Ut){pn.debug("transition NOT ongoing but should be"),In.createMCURoomModeChangedEvent(yt.roomName,"mesh","sfu","ongoing"),yt.modeChangeKind="old";var Bt={};Bt.roomID=yt.roomID,Bt.roomName=yt.roomName,yt.hasOwnProperty("convId")&&(Bt.convId=yt.convId),Bt.joinSessionAnswer={failed:!1},Bt.modeChangeKind="new",this.sessionMCUs.push(Bt),this.transitionCount+=1,Gt.finalizeMeshToJanusTransition(yt,Bt,{force:!0})}if(Ct.updateCalls)if(pn.debug("update stream list (prune)"),this.updateStreamList(nt,{prune:!0}),yt.roomMode==="mesh"){pn.debug("restart publish/shareScreen calls");for(var Qt=Gt.userMediaTable.slice(),en=Qt.length;--en>=0;){var Jt=Qt[en];Jt.sessionMCU===yt&&Gt.onHangup(Jt.userMediaId,"disconnected")}}else{pn.debug("roomMode is SFU, checking calls");for(var an=Gt.callsTable.slice(),hn=an.length;--hn>=0;){var rn=an[hn];rn.sessionMCU===yt&&(rn.settingUpType!=="publish"&&rn.settingUpType!=="shareScreen"||rn.data&&rn.data.mesh||rn.pc?rn.message200OKReceived===!1&&(pn.debug("restart call without 200OK received"),Gt.onHangup(rn.callId,"disconnected")):(pn.debug("restart publish/shareScreen calls with no PeerConnection"),Gt.onHangup(rn.callId,"disconnected")))}}},this.processCheckCallStatus=function(nt){this.updateStreamList(nt)},this.updateStreamList=function(nt){for(var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=(0,st.ki)(nt,"availableStreams","array")?nt.availableStreams.slice():null,Pt=(0,st.ki)(nt,"availableComposite","array")?nt.availableComposite.slice():null,Et=(0,st.ki)(nt,"availableReplay","array")?nt.availableReplay.slice():null,Ut=this.streamList.length;--Ut>=0;){var Ot=this.streamList[Ut];if(Ot.type==="regular"){if(!yt)continue;for(var Bt=yt.length;--Bt>=0&&yt[Bt].id!==Ot.streamInfo.id;);if(Bt>=0){(0,st.ki)(Ot,"clearDisputableEntry","function")&&Ot.clearDisputableEntry(),yt.splice(Bt,1);continue}Ct.prune===!0?((0,st.ki)(Ot,"clearDisputableEntry","function")&&Ot.clearDisputableEntry(),apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({type:"subscribe",stream:Ot.streamInfo}),In.createMCURemovedStreamEvent(Ot.streamInfo.id),this.streamList.splice(Ut,1)):Ot.disputableTimeoutId||(Ot.disputableTimeoutId=setTimeout(xn.bind(this,Ot.streamInfo.id),kn),Ot.clearDisputableEntry=Pn.bind(this,Ot.streamInfo.id),this.disputableStreamList.push(Ot))}else if(Ot.type==="composite"){if(!Pt)continue;for(var Qt=Pt.length;--Qt>=0&&Pt[Qt].id!==Ot.streamInfo.id;);if(Qt>=0){Pt.splice(Qt,1);continue}apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({type:"subscribe",stream:Ot.streamInfo}),In.createMCURemovedStreamEvent(Ot.streamInfo.id),this.streamList.splice(Ut,1)}else if(Ot.type==="replay"){if(!Et)continue;for(var en=Et.length;--en>=0&&Et[en].id!==Ot.streamInfo.id;);en>=0&&Et.splice(en,1)}}if(yt)for(var Jt=0;Jt<yt.length;Jt+=1){var an=[];an.push(yt[Jt]);var hn=this.newAvailableStream(an,"regular");In.createMCUAvailableStreamEvent(an,hn)}if(Pt)for(var rn=0;rn<Pt.length;rn+=1){var dn=[];dn.push(Pt[rn]);var Sn=this.newAvailableStream(dn,"composite");In.createMCUAvailableCompositeEvent(dn,Sn)}if(Et)for(var wn=0;wn<Et.length;wn+=1){var An=[];An.push(Et[wn]);var _n=this.newAvailableReplay(An);In.createMCUAvailableReplayEvent(An,_n)}},this.getStreamList=function(){return pn.debug("getStreamList :",this.streamList),this.streamList},this.getStreamFromList=function(nt){var Ct;for(pn.debug("getStreamFromList() with Id :",nt),pn.log("this.streamList :",this.streamList),Ct=0;Ct<this.streamList.length;Ct+=1){if(this.streamList[Ct].streamInfo.id===nt)return pn.log("stream found",this.streamList[Ct].streamInfo),this.streamList[Ct].streamInfo;pn.log("not the same stream",nt)}return null},this.getStreamIdOfUser=function(nt){var Ct;for(pn.debug("getStreamIdOfUser() with Id :",nt),pn.log("this.streamList :",this.streamList),Ct=0;Ct<this.streamList.length;Ct+=1)if(this.streamList[Ct].type!=="replay"){if(this.streamList[Ct].userId===nt)return pn.log("stream found",this.streamList[Ct].streamInfo),this.streamList[Ct].streamInfo.id;pn.log("not the same userId",nt)}return null},this.getStreamOfUserCall=function(nt,Ct){var yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Pt=this.streamList.length,Et=!1;for((0,st.ki)(yt,"replay","boolean")&&yt.replay===!0&&(Et=!0);--Pt>=0;){if(Et===!0){if(this.streamList[Pt].type!=="replay")continue}else if(this.streamList[Pt].type==="replay")continue;if(this.streamList[Pt].userId===nt&&this.streamList[Pt].streamInfo.attributes.callId===Ct)return this.streamList[Pt].streamInfo}return null},this.newAvailableStream=function(nt,Ct,yt){pn.debug("newAvailableStream():",nt);var Pt=!1,Et=!1,Ut=this.getSessionMCU(nt[0].room);if(Ut){nt[0].attributes.callerId!==Tt&&(Pt=!0);for(var Ot=Gt.getCallControls(["publish","shareScreen"],{addUserMedia:!0}),Bt=0;Bt<nt.length;Bt+=1){for(var Qt=this.streamList.length;--Qt>=0&&(this.streamList[Qt].type!=="regular"||nt[Bt].id!==this.streamList[Qt].streamInfo.id););Qt>=0?(Et=!0,(0,st.ki)(this.streamList[Qt],"clearDisputableEntry","function")?this.streamList[Qt].clearDisputableEntry():pn.debug("clearDisputableEntry is not set")):pn.debug("streamList is empty"),Pt=!Object.prototype.hasOwnProperty.call(Ot,nt[Bt].attributes.callId);var en={type:Ct,userId:nt[Bt].attributes.callerId,roomId:Ut.roomName,isRemoteStream:Pt,streamInfo:nt[Bt]};if(Et===!0?this.streamList[Qt]=en:this.streamList.push(en),pn.log("this.streamList :",this.streamList),Pt!==!0&&Ut.roomMode==="mesh"){var Jt=Gt.findUserMediaById(nt[Bt].attributes.callId);Jt&&Jt.addAck===!0&&(delete Jt.addAck,clearTimeout(Jt.addTimeoutId),delete Jt.addTimeoutId,In.createCallEstablishedEvent(Ut.roomName,Jt.callType,Jt.userMediaId,"none"))}var an=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallControl({type:"subscribe",stream:nt[Bt]});if(an&&!an.autoRestart.pending){pn.info("[newAvailableStream] auto subscribing to stream");var hn=!!an.autoRestart.force;delete an.autoRestart.force;var rn=an.callId,dn=Gt.findCallWithCallId(rn);dn!==null&&dn.sessionMCU!==null&&dn.sessionMCU.modeChangeKind==="old"&&(pn.debug("Re-init of autoRestart.counter"),delete an.autoRestart.counter);var Sn=this.subscribeToStreams([nt[Bt]],an.mediaType,an.data,an.callConfiguration,{noStreamCheck:!0,force:hn});rn&&Sn[0]&&In.createCallRestartingEvent(an.callType,an.audioOnly,rn,Sn[0],"subscribe",apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,an.roomName,an.roomName,nt[Bt].id)}if(Et!==!0&&(0,st.Ym)(yt,"function")&&yt(Pt,nt[Bt],Ct),nt[Bt].context!==void 0&&nt[Bt].context.remoteAccessCtx!==void 0){var wn=nt[Bt].context.remoteAccessCtx.invitationId;pn.debug("remoteAccess stream for invitationId : ",wn),apiRTC.session.remoteAccessInvitation!==null&&wn===apiRTC.session.remoteAccessInvitation.id&&Pt===!0?(pn.debug("Setting screenSharingStreamId for remote"),apiRTC.session.remoteAccessInvitation.screenSharingStreamId=nt[Bt].id,pn.debug("apiRTC.session.remoteAccessInvitation.screenSharingStreamId :",apiRTC.session.remoteAccessInvitation.screenSharingStreamId),apiRTC.session.remoteAccessInvitation.screenWidth=nt[Bt].context.remoteAccessCtx.screenWidth,apiRTC.session.remoteAccessInvitation.screenHeight=nt[Bt].context.remoteAccessCtx.screenHeight):pn.debug("Stream not linked to remoteAccessInvitation or this is localStream")}}return Pt}pn.debug("newAvailableStream() but client is not in session")},this.updateAvailableStream=function(nt,Ct,yt){pn.info("updateAvailableStream():",nt);var Pt=!1;if(this.getSessionMCU(nt[0].room)){nt[0].attributes.callerId!==Tt&&(Pt=!0);for(var Et=0;Et<nt.length;Et+=1)for(var Ut=this.streamList.length;--Ut>=0;)if(this.streamList[Ut].streamInfo.id===nt[Et].id){for(var Ot=[],Bt=0,Qt=["audio","audioMuted","video","videoMuted"];Bt<Qt.length;Bt++){var en=Qt[Bt];this.streamList[Ut].streamInfo[en]!==nt[Et][en]&&(this.streamList[Ut].streamInfo[en]=nt[Et][en],Ot.push(en))}this.streamList[Ut].streamInfo.attributes.callType!==nt[Et].attributes.callType&&(this.streamList[Ut].streamInfo.attributes.callType=nt[Et].attributes.callType,Ot.push("callType")),this.streamList[Ut].streamInfo.attributes.descriptor&&nt[Et].attributes.descriptor&&this.streamList[Ut].streamInfo.attributes.descriptor.priority!==nt[Et].attributes.descriptor.priority&&(this.streamList[Ut].streamInfo.attributes.descriptor.priority=nt[Et].attributes.descriptor.priority,Ot.push("priority")),Ot.length>0&&(0,st.Ym)(yt,"function")&&yt(Pt,nt[Et],Ct,Ot);break}return Pt}pn.log("updateAvailableStream() but client is not in session")},this.newAvailableReplay=function(nt){pn.info("newAvailableReplay() :",nt);var Ct=!1,yt=this.getSessionMCU(nt[0].room);if(yt){nt[0].attributes.callerId!==Tt&&(Ct=!0);for(var Pt=0;Pt<nt.length;Pt+=1){var Et={type:"replay",userId:nt[Pt].attributes.callerId,roomId:yt.roomName,isRemoteStream:Ct,streamInfo:nt[Pt]};this.streamList.push(Et)}return Ct}pn.log("newAvailableReplay() but client is not in session")},this.subscribeToStreams=function(nt,Ct,yt,Pt){var Et=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};pn.info("subscribeToStreams():",nt);var Ut,Ot,Bt=[],Qt=null,en=null,Jt=null,an=function(rn){return setTimeout(function(){pn.warn("invite + SDP offer not received -> restart call"),Gt.onHangup(rn,"disconnected")},15e3)};for(Jt in nt){if(Ut=nt[Jt],apiCC.session===null||apiCC.session===void 0)return pn.debug("no session, leaving subscribeToStreams()"),Bt;if((Qt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithStreamId(Ut.id,{ignoreModeChangeKindOld:!0}))!==null){if(pn.debug("call already exists"),Et.force!==!0){Bt[Jt]=Qt.callId;continue}pn.debug("Force is true")}else pn.debug("call does not exist");for(Ot=this.streamList.length;--Ot>=0&&this.streamList[Ot].streamInfo.id!==Ut.id;);if(Ot>=0){if(pn.debug("stream exists"),this.streamList[Ot].disputableTimeoutId){pn.debug("stream temporarily not available"),Bt[Jt]=null,Et.autoSub===!0&&((en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallControl({type:"subscribe",stream:Ut}))||apiCC.session.apiCCWebRTCClient.webRTCClient.createCallControl({type:"subscribe",roomName:Ut.room,mediaType:Ct,callConfiguration:Pt,data:yt,stream:Ut}));continue}}else if(pn.debug("stream does not exist"),Et.noStreamCheck!==!0){Bt[Jt]=null,In.createErrorEvent("stream not available","STREAM_NOT_AVAILABLE",null,Ut.room,null,{stream:Ut});continue}pn.info("stream:",Ut);var hn=this.getSessionMCU(Ut.room);hn&&((en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallControl({type:"subscribe",stream:Ut}))||(en=apiCC.session.apiCCWebRTCClient.webRTCClient.createCallControl({type:"subscribe",roomName:hn.roomName,mediaType:Ct,callConfiguration:Pt,data:yt,stream:Ut})),Ut.attributes.callType!=="COMPOSITE"&&this.pubConnector==="janusConnector"?(yt===void 0&&(yt={}),yt.mesh&&delete yt.mesh,(0,st.Ym)(Pt,"qos","object")?(yt.qos={},Pt.qos.videoForbidInactive===!1?yt.qos.videoForbidInactive=!1:yt.qos.videoForbidInactive=!0):(yt.qos={},yt.qos.videoForbidInactive=!0),(0,st.Ym)(Pt,"simulcast","object")&&(yt.simulcast={},Pt.simulcast.streamQuality&&(Pt.simulcast.streamQuality==="high"?yt.simulcast.substream=2:Pt.simulcast.streamQuality==="medium"?yt.simulcast.substream=1:Pt.simulcast.streamQuality==="low"&&(yt.simulcast.substream=0)),Pt.simulcast.streamFrameRate&&(Pt.simulcast.streamFrameRate==="high"?yt.simulcast.temporal=2:Pt.simulcast.streamFrameRate==="medium"?yt.simulcast.temporal=1:Pt.simulcast.streamFrameRate==="low"&&(yt.simulcast.temporal=0))),(Qt=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient)).instanceId=apiCC.generateInstanceId(),Qt.callControl=en,(0,st.ki)(Qt.callControl.autoRestart,"counter","number")?(Qt.callControl.autoRestart.counter+=1,Qt.restarted=!0):Qt.callControl.autoRestart.counter=0,Qt.settingUpType="subscribe",Pt!=null&&Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&Qt.setCallTurnServer(Pt.turnServerAddress),Qt.generateCallId(),en.callId=Qt.callId,Qt.setupTimeoutId=an(Qt.callId),Qt.callerId=hn.roomName,Qt.calleeId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Qt.callee=!0,Qt.mcuRemoteStream=Ut,Qt.dest_roomId=hn.roomName,Qt.callType=Ut.attributes.callType,Qt.callControl.callType=Ut.attributes.callType,Ut.attributes.callType!=="audio"&&Ct!=="AUDIOONLY"||(Qt.audioOnly=!0,Qt.callControl.audioOnly=!0),Qt.remoteId=Ut.attributes.callerId,Qt.remoteMailAddress=Ut.attributes.mailAddress,Qt.streamId=Ut.id,Qt.mediaType=Ct,Qt.sessionMCU=hn,pn.log("call.streamId: "+Qt.streamId),(0,st.Ym)(yt,"object")?Qt.data=(0,st.ws)({},yt):Qt.data={},Qt.data.pubSub="janusConnector",Qt.data.type="subscribe",Qt.data.mode="passive",Qt.data.mediaType=Ct,Qt.data.capabilities=this.browserCapabilities,Qt.data.cloudConvId=hn.convId,Qt.data.instanceId=Qt.instanceId,apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Qt),Bt[Jt]=Qt.callId,Qt.myWebRTC_Stack.sendInvite(Qt.callId,apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,hn.roomName,hn.roomName,Ut.attributes.callType,{mode:"passive",data:Qt.data,stream:Ut,volatile:!!Qt.restarted})):((Qt=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient)).instanceId=apiCC.generateInstanceId(),Qt.callControl=en,(0,st.ki)(Qt.callControl.autoRestart,"counter","number")?(Qt.callControl.autoRestart.counter+=1,Qt.restarted=!0):Qt.callControl.autoRestart.counter=0,Qt.settingUpType="subscribe",Pt!=null&&Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&Qt.setCallTurnServer(Pt.turnServerAddress),yt===void 0&&(yt={}),Qt.data=yt,Qt.data.pubSub=this.pubConnector,Qt.data.type="subscribe",Qt.data.capabilities=this.browserCapabilities,Qt.data.cloudConvId=hn.convId,Qt.data.instanceId=Qt.instanceId,pn.log("mediaType: ",Ct),pn.log("stream.attributes.callType: ",Ut.attributes.callType),Qt.callType=Ut.attributes.callType,Qt.callControl.callType=Ut.attributes.callType,Ut.attributes.callType==="COMPOSITE"&&this.pubConnector==="janusConnector"||Ut.attributes.callType==="audio"||Ct==="AUDIOONLY"?(pn.log("Setting call as audioOnly"),Qt.audioOnly=!0,Qt.callControl.audioOnly=!0,Qt.stripVideoSDPActivated=!0):Ct==="VIDEOONLY"&&(Qt.stripAudioSDPActivated=!0,Qt.callType="videoOnly",Qt.callControl.callType="videoOnly"),Qt.mcuRemoteStream=Ut,Qt.dest_roomId=hn.roomName,Qt.calleeId=hn.roomName,Qt.generateCallId(),en.callId=Qt.callId,Qt.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Qt.sessionMCU=hn,apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Qt),Qt.createPeerConnection(),Qt.doCall(),Qt.started=!0,Qt.callType=Ut.attributes.callType,Qt.remoteId=Ut.attributes.callerId,Qt.remoteMailAddress=Ut.attributes.mailAddress,Ut.audio===!0?Ut.video===!0?Qt.destCallType="media":Qt.destCallType="audio":Ut.video===!0&&(Qt.destCallType="videoOnly"),Ut.id===void 0&&pn.log("stream.id is undefined :",Ut),Qt.streamId=Ut.id,Qt.mediaType=Ct,pn.log("stream.attributes.callType: ",Ut.attributes.callType),Bt[Jt]=Qt.callId),Qt.asyncCallbacks={},Qt.asyncCallbacks.type="subscribe")}return Bt},this.unsubscribe=function(nt){pn.info("unsubscribe() :",nt);var Ct=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithStreamId(nt);Ct===null?pn.log("error call not found on unsubscribe"):Ct.callId!==void 0&&apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Ct.callId)},this.publish=function(nt,Ct,yt,Pt,Et,Ut){pn.info("publish roomName :",nt),pn.log("publish sessionId :",Ct),pn.log("publish token :",yt),pn.log("publish callConfiguration :",Pt);var Ot=null,Bt=!1,Qt=!1,en=null,Jt=null,an=this.getSessionMCU(nt);if(!an)return pn.error("roomName does not match any sessionMCU"),null;if(Et!==null&&un(Et)==="object"||(Et={}),this.pubConnector==="janusConnector"&&!Et.mesh&&Ut&&Ut.callControl&&Ut.callControl.callId&&apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Ut.callControl.callId))return pn.debug("call already exists",Ut.callControl.callId),Ut.callControl.callId;if(Pt===!0||Pt==="true"?(pn.log("DEPRECATED ... please use callConfiguration JSON parameter : callConfiguration.audioOnly instead of audioOnly"),Bt=!0,Pt={}):Pt===!1||Pt==="false"?(pn.log("DEPRECATED ... please use callConfiguration JSON parameter : callConfiguration.audioOnly instead of audioOnly"),Pt={}):Pt!==null&&un(Pt)==="object"||(Pt={}),Pt.audioOnly===!0&&Pt.videoOnly===!0)return In.createErrorEvent("Cannot publish without audio nor video","PUBLISH_FAILURE",null,nt),null;if(Pt.audioOnly===!0&&(Bt=!0),Pt.videoOnly===!0&&(Qt=!0),["audioOnly","videoOnly","record","private"].forEach(function(rn){Pt.hasOwnProperty(rn)&&((0,st.ki)(Et,"callConfiguration","object")||(Et.callConfiguration={}),Et.callConfiguration[rn]=Pt[rn])}),an.convId&&(Et.cloudConvId=an.convId),(0,st.Ym)(Pt,"qos","object")?(Et.qos={},Pt.qos.videoMinBitrate?Et.qos.videoMinBitrate=Pt.qos.videoMinBitrate:Pt.qos.videoMinQuality&&["excellent","good","medium","bad"].indexOf(Pt.qos.videoMinQuality)>=0?Et.qos.videoMinQuality=Pt.qos.videoMinQuality:Et.qos.videoMinQuality="bad",Pt.qos.videoStartBitrate?Et.qos.videoStartBitrate=Pt.qos.videoStartBitrate:Pt.qos.videoStartQuality&&["upper","excellent","good","medium","bad"].indexOf(Pt.qos.videoStartQuality)>=0&&(Et.qos.videoStartQuality=Pt.qos.videoStartQuality),Pt.qos.videoForbidInactive===!1?Et.qos.videoForbidInactive=!1:Et.qos.videoForbidInactive=!0):Et.qos={videoMinQuality:"bad",videoForbidInactive:!0},Pt.simulcast&&(Pt.userMediaStreamId&&(Jt=apiCC.getUserMediaStream(Pt.userMediaStreamId))&&Jt.isSimulcastCompliant()||delete Pt.simulcast),function(rn){if(!(0,st.ki)(rn,"simulcast","object")||st.wL.type==="safari"&&rn.simulcast.mode!=="SDP")return delete rn.simulcast,!1;delete rn.simulcast.sendEncodings,(0,st.ki)(rn.simulcast,"maxBitrate","number")?st.wL.type==="chrome"&&st.wL.version>=78&&rn.simulcast.mode!=="SDP"?(pn.debug("configure simulcast RID chrome maxBitrate"),!Fn(rn.simulcast,rn.simulcast.maxBitrate)&&(pn.warn("cannot configure simulcast"),delete rn.simulcast)):st.wL.type==="firefox"?(pn.debug("configure simulcast RID firefox maxBitrate"),!Fn(rn.simulcast,rn.simulcast.maxBitrate)&&(pn.warn("cannot configure simulcast"),delete rn.simulcast)):delete rn.simulcast.encodings:(0,st.ki)(rn.simulcast,"encodings","object")?st.wL.type==="chrome"&&st.wL.version>=78&&rn.simulcast.mode!=="SDP"?(pn.debug("configure simulcast RID chrome encodings"),!Dn(rn.simulcast)&&(pn.warn("cannot configure simulcast"),delete rn.simulcast)):st.wL.type==="firefox"?(pn.debug("configure simulcast RID firefox encodings"),!Dn(rn.simulcast)&&(pn.warn("cannot configure simulcast"),delete rn.simulcast)):delete rn.simulcast.encodings:st.wL.type==="chrome"&&st.wL.version>=78&&rn.simulcast.mode!=="SDP"?(pn.debug("configure simulcast RID chrome default"),rn.simulcast.encodings={high:{maxBitrate:900},medium:{maxBitrate:300,scaleResolutionDownBy:2},low:{maxBitrate:100,scaleResolutionDownBy:4}},!Dn(rn.simulcast)&&delete rn.simulcast):st.wL.type==="firefox"&&(pn.debug("configure simulcast RID firefox default"),rn.simulcast.encodings={high:{maxBitrate:900},medium:{maxBitrate:300,scaleResolutionDownBy:2},low:{maxBitrate:100,scaleResolutionDownBy:4}},!Dn(rn.simulcast))&&delete rn.simulcast}(Pt),Pt.distributedBroadcastEnabled&&!Pt.simulcast&&(Et.distributedBroadcastEnabled=!0),["audioLabels","videoLabels"].forEach(function(rn){(0,st.Ym)(Pt[rn],"array")&&(Et[rn]=[],Pt[rn].forEach(function(dn){(0,st.Ym)(dn,"string")&&Et[rn].push(dn)}))}),(0,st.Ym)(Pt,"context","object"))try{JSON.stringify(Pt.context),Et.context=Pt.context}catch{}if((0,st.Ym)(Pt,"profileType","string")&&(Et.profileType=Pt.profileType),(0,st.Ym)(Pt,"priority","number")&&Pt.priority>=0&&(Et.priority=Pt.priority),(0,st.Ym)(Pt,"downgradeProfileList","array")&&(Et.downgradeProfileList=Pt.downgradeProfileList),pn.debug("callConfiguration; audioOnly: "+Bt+", videoOnly: "+Qt),Ut&&Ut.forceScreenSharingCallType===!0)pn.debug("publish screenSharing");else if(apiCC.mediaDeviceMgr.videoDevicePresent===!1){if(apiCC.mediaDeviceMgr.audioDevicePresent===!1)return pn.debug("publish without any device, leaving publish ..."),Et.publishWithoutMediaDeviceDetected=!0,apiCC.session.setUserData(Et),In.createErrorEvent("Cannot publish without audio nor video","PUBLISH_FAILURE",null,nt),null;Bt!==!0&&(pn.debug("publish video, but no webcam present, forcing callType to audio"),Bt=!0)}else apiCC.mediaDeviceMgr.audioDevicePresent===!1&&Qt!==!0&&(pn.debug("publish video, but no microphone present, forcing callType to videoOnly"),Qt=!0);if(Ot=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient),Et.mesh!==void 0&&Et.instanceId!==void 0?(pn.debug("keeping instanceId "),Ot.instanceId=Et.instanceId):Ot.instanceId=apiCC.generateInstanceId(),this.pubConnector!=="janusConnector"||Et.mesh?(Ot.settingUpType="publish",Ot.generateCallId()):(Ot.settingUpType="publish",Ut&&Ut.callControl?(Ot.callControl=Ut.callControl,Ot.callControl.autoRestart.counter+=1,Ot.callId=Ot.callControl.callId,Ot.restarted=!0):(Ot.callControl=apiCC.session.apiCCWebRTCClient.webRTCClient.createCallControl({type:"publish",roomName:nt,callConfiguration:Pt,data:Et}),Ot.callControl.sessionId=Ct,Ot.callControl.token=yt,Ot.callControl.autoRestart.counter=0,Ot.generateCallId(),Ot.callControl.callId=Ot.callId)),Pt!=null&&Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&Ot.setCallTurnServer(Pt.turnServerAddress),Pt.userMediaStreamId&&((Jt=apiCC.getUserMediaStream(Pt.userMediaStreamId))?(Ot.callType=Jt.callType,pn.debug("Setting callType to "+Ot.callType),Ot.callType==="screenSharing"&&(Ot.screenSharing=!0)):(pn.debug("callConfiguration.userMediaStreamId is setted but stream is not present"),delete Pt.userMediaStreamId)),Ot.data=Et,Ot.data.instanceId=Ot.instanceId,Ct==="restarted"&&(Ot.restarted=!0),Ot.mediaTypeForIncomingCall="NONE",Bt===!0?(pn.log("Setting call as audioOnly"),Ot.audioOnly=!0,Ot.callType="audio",Ot.mediaTypeForOutgoingCall="AUDIO"):Qt===!0?(pn.log("Setting call as videoOnly"),Ot.callType="videoOnly",Ot.mediaTypeForOutgoingCall="VIDEOONLY"):pn.log("Not Setting call as audioOnly nor videoOnly"),Ot.dest_roomId=an.roomName,Ot.calleeId=an.roomName,Ot.data.pubSub=this.pubConnector,Ot.data.type="publish",Ot.data.capabilities=this.browserCapabilities,Ot.data.cloudConvId=an.convId,Ot.callConfiguration=Pt,Ot.sessionMCU=an,Ot.setMediaConstraintsToSendOnlyOffer(),Ot.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,(0,st.Ym)(Pt,"simulcast","object")){var hn=null;Jt&&(hn=Jt.getSimulcastProfile()),st.wL.type==="chrome"&&st.wL.version>=78&&Pt.simulcast.mode!=="SDP"?(pn.debug("simulcast chrome 78+ -> RID",Pt.simulcast),Ot.simulcast="RID",Ot.data.simulcast={enabled:!0,mode:"RID"},Ot.data.simulcast.encodings=Object.assign({},Pt.simulcast.encodings),hn&&(Ot.data.simulcast.profile=hn)):st.wL.type==="chrome"?(pn.debug("simulcast chrome -> SDP",Pt.simulcast),Ot.simulcast="SDP",Ot.data.simulcast={enabled:!0,mode:"SDP"}):st.wL.type==="firefox"?(pn.debug("simulcast firefox -> RID",Pt.simulcast),Ot.simulcast="RID",Ot.data.simulcast={enabled:!0,mode:"RID"},Ot.data.simulcast.encodings=Object.assign({},Pt.simulcast.encodings),hn&&(Ot.data.simulcast.profile=hn)):st.wL.type==="safari"&&(pn.debug("simulcast safari -> SDP",Pt.simulcast),Ot.simulcast="SDP",Ot.data.simulcast={enabled:!0,mode:"SDP"})}return pn.log("webRTCClient.accessToLocalMedia :",Gt.accessToLocalMedia),apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Ot),this.publishCallId=Ot.callId,Ot.callControl&&Ot.callControl.autoRestart.stream&&pn.debug("call.callControl.autoRestart.stream.active :",Ot.callControl.autoRestart.stream.active),this.pubConnector==="janusConnector"&&Ot.callControl&&Ot.callControl.autoRestart.stream&&Ot.callControl.autoRestart.stream.active?(apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Ot.callLocalStream=Ot.callControl.autoRestart.stream,Ot.establishCall(),Ot.callId):(Et.mesh!==void 0&&(en=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Et.mesh.calleeCallId))!==null&&en.callConfiguration&&en.callConfiguration.userMediaStreamId&&(Ot.callType=en.callType,Pt.userMediaStreamId=en.callConfiguration.userMediaStreamId),Pt.userMediaStreamId?((Jt=apiCC.getUserMediaStream(Pt.userMediaStreamId)).addCallInfo(Ot.callId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,this.pubConnector==="janusConnector"&&Ot.callControl&&(Ot.callControl.autoRestart.stream=Jt.stream),Ot.callConfiguration.userMediaStreamId=Jt.userMediaStreamId,Ot.callLocalStream=Jt.stream,Ot.establishCall(),Ot.callId):apiCC.userMediaStreamTable.length>0?((Jt=apiCC.userMediaStreamTable[0]).addCallInfo(Ot.callId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,this.pubConnector==="janusConnector"&&Ot.callControl&&(Ot.callControl.autoRestart.stream=Jt.stream),Ot.callConfiguration.userMediaStreamId=Jt.userMediaStreamId,Ot.callLocalStream=Jt.stream,Ot.establishCall(),Ot.callId):(apiCC.createUserMediaStream({callId:Ot.callId,type:Ot.callType,audioSourceId:Gt.audioSourceId,videoSourceId:Gt.videoSourceId,success:function(rn){pn.debug("[publish] success; userMediaStreamId: "+rn.userMediaStreamId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector==="janusConnector"&&Ot.callControl&&(Ot.callControl.autoRestart.stream=rn.stream),Ot.callConfiguration.userMediaStreamId=rn.userMediaStreamId,Ot.callLocalStream=rn.stream,Ot.establishCall()}}),Ot.callId))},this.publishScreen=function(nt,Ct,yt,Pt){pn.info("publishScreen()");var Et=this.getSessionMCU(nt);return Et?(Ct==null&&(Ct={}),yt==null&&(yt={}),yt.record!==void 0&&(Ct.callConfiguration!==void 0||(Ct.callConfiguration={}),Ct.callConfiguration.record=yt.record),yt.private!==void 0&&(Ct.callConfiguration!==void 0||(Ct.callConfiguration={}),Ct.callConfiguration.private=yt.private),Ct.pubSub=this.pubConnector,Ct.type="publish",apiCC.session.apiCCWebRTCClient.webRTCClient.shareScreen(Et.roomName,Ct,Pt,yt)):(pn.error("roomId does not match any sessionMCU"),null)},this.unpublish=function(nt){pn.info("unpublish call with callId :",nt),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(nt),this.publishCallId=null},this.removeMCUStream=function(nt,Ct,yt){var Pt,Et=!1;for(yt!=="Broken_by_MCU"&&yt!=="disconnected"||(Et=!0),pn.debug("streamId:",Ct),pn.debug("reason:",yt),pn.debug("quiet:",Et),Pt=0;Pt<this.streamList.length;Pt+=1)if(pn.log("this.streamList[i].streamInfo.id :",this.streamList[Pt].streamInfo.id),this.streamList[Pt].streamInfo.id===Ct){Et===!0?(pn.debug("add stream into disputableStreamList: ",Ct),this.streamList[Pt].disputableTimeoutId=setTimeout(xn.bind(this,this.streamList[Pt].streamInfo.id),kn),this.streamList[Pt].clearDisputableEntry=Pn.bind(this,this.streamList[Pt].streamInfo.id),this.disputableStreamList.push(this.streamList[Pt])):(pn.debug("remove stream from streamList:",Ct),apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({type:"subscribe",stream:this.streamList[Pt].streamInfo}),this.streamList.splice(Pt,1));break}nt!==void 0&&apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(nt),Et!==!0&&In.createMCURemovedStreamEvent(Ct)},this.startStreaming=function(nt,Ct,yt,Pt){pn.info("startStreaming");var Et,Ut,Ot=nt!=null&&nt.length>0,Bt=Ct!=null&&Ct.length>0,Qt={};if(!Ot&&!Bt||yt==null||yt.length===0)return!1;if(Pt===void 0){if(this.publishCallId===null)return pn.log("Cannot start streaming as no stream is published"),!1;Pt=this.publishCallId}var en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Pt);return en||(en=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Pt))?en.sessionMCU?(Ot||(nt="custom"),Qt.pubSub=this.pubConnector,Qt.service=nt,Bt&&(Qt.server=Ct),Qt.streamKey=yt,pn.log("startStreaming() on ApiRTC MCU with roomId:",en.sessionMCU.roomName),Et={type:"startStreaming",roomId:en.sessionMCU.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Pt,data:Qt},Ut=JSON.stringify(Et),pn.log("C->S: "+Ut),apiCC.session.channel.socket.emit("startStreaming",Ut),!0):(pn.error("no such sessionMCU"),!1):(pn.error("callIdToStream does not match any call"),!1)},this.stopStreaming=function(nt){var Ct,yt;if(pn.info("stopStreaming"),nt===void 0){if(this.publishCallId===null)return pn.log("Cannot stop streaming as no stream is published"),!1;nt=this.publishCallId}var Pt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(nt);if(!Pt)return pn.error("callIdToStream does not match any call"),!1;var Et=this.getSessionMCU(Pt.dest_roomId);return Et?(pn.log("stopStreaming() on ApiRTC MCU with roomId:",Et.roomName),Ct={type:"stopStreaming",roomId:Et.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:nt,data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("stopStreaming",yt),!0):(pn.error("dest_roomId does not match any sessionMCU"),!1)},this.startRecording=function(nt,Ct,yt,Pt,Et){var Ut,Ot;if(pn.info("startRecording"),Pt==null){if(this.publishCallId===null)return void pn.log("Call recording can not start as stream is not published");Pt=this.publishCallId}var Bt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Pt);return Bt||(Bt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Pt))?Bt.sessionMCU?(nt!=="AUDIO-ONLY"&&nt!=="VIDEO-ONLY"&&(nt="AUDIO-VIDEO"),Et==null&&(Et={}),Et.pubSub=this.pubConnector,pn.log("startRecording() on ApiRTC MCU with roomId :",Bt.sessionMCU.roomName),Ut={type:"startRecording",roomId:Bt.sessionMCU.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Pt,data:Et,customIdInFilename:Ct,mediaType:nt,convId:yt},Ot=JSON.stringify(Ut),pn.log("C->S: "+Ot),void apiCC.session.channel.socket.emit("startRecording",Ot)):(pn.error("no such sessionMCU"),!1):(pn.error("callIdToRecord does not match any call"),!1)},this.stopRecording=function(nt){var Ct,yt;if(pn.info("stopRecording"),nt===void 0){if(this.publishCallId===null)return void pn.log("Call recording can not stop as stream is not published");nt=this.publishCallId}var Pt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(nt);if(!Pt)return pn.error("callIdToRecord does not match any call"),!1;var Et=this.getSessionMCU(Pt.dest_roomId);if(!Et)return pn.error("dest_roomId does not match any sessionMCU"),!1;pn.log("stopRecording() on ApiRTC MCU with roomId :",Et.roomName),Ct={type:"stopRecording",roomId:Et.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:nt,data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("stopRecording",yt)},this.recordingStarted=function(nt){pn.info("recordingStarted:",nt),In.createMCURecordingStartedEvent(nt.roomName,nt.callId,nt.clientId,nt.recordType,nt.time,nt.convId,nt.mediaId,nt.mediaURL,nt.remoteId,nt.recordedFileName,nt.mediaType,nt.descriptor)},this.recordingStopped=function(nt){pn.info("recordingStopped:",nt),In.createMCURecordingStoppedEvent(nt.roomName,nt.callId,nt.clientId,nt.recordType,nt.time,nt.convId,nt.mediaId,nt.mediaURL,nt.remoteId,nt.recordedFileName,nt.mediaType,nt.descriptor)},this.recordingStreamAvailable=function(nt){pn.info("recordingStreamAvailable :",nt),In.createMCURecordedStreamsAvailableEvent(nt.roomName,nt.callId,nt.clientId,nt.recordedFileName,nt.convId,nt.mediaId,nt.mediaURL,nt.recordType,nt.remoteId,nt.mediaType,nt.descriptor),this.pubConnector==="janusConnector"&&nt.hasOwnProperty("confId")&&nt.hasOwnProperty("remoteId")&&In.createRecordedStreamsAvailableEvent(nt.confId,nt.clientId,nt.remoteId,nt.callId,nt.convId,nt.mediaId,nt.mediaURL)},this.streamingStarted=function(nt){pn.info("streamingStarted: ",nt),In.createMCUStreamingStartedEvent(nt.roomName,nt.callId,nt.clientId,nt.time)},this.streamingStopped=function(nt){pn.info("streamingStopped: ",nt),In.createMCUStreamingStoppedEvent(nt.roomName,nt.callId,nt.clientId,nt.time)},this.startComposite=function(nt){var Ct,yt,Pt;(Pt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0}))?(pn.log("startComposite() on ApiRTC MCU with roomId :",Pt.roomName),Ct={type:"startComposite",roomId:Pt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("startComposite",yt)):pn.log("startComposite() but client is not in session")},this.stopComposite=function(nt){var Ct,yt,Pt;(Pt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0}))?(pn.log("stopComposite() on ApiRTC MCU with roomId :",Pt.roomName),Ct={type:"stopComposite",roomId:Pt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("stopComposite",yt)):pn.log("stopComposite() but client is not in session")},this.startCompositeRecording=function(nt,Ct,yt,Pt,Et){pn.info("startCompositeRecording with convId :",yt);var Ut,Ot,Bt;(Bt=Et?this.getSessionMCU(Et):this.getSessionMCU(null,{first:!0}))?(nt!=="AUDIO-ONLY"&&nt!=="VIDEO-ONLY"&&(nt="AUDIO-VIDEO"),(Pt=(0,st.Ym)(Pt,"object")?(0,st.ws)({},Pt):{}).pubSub=this.pubConnector,["complete","efficient","audioOnly"].indexOf(Pt.mode)<0&&(Pt.mode="complete"),Pt.labelEnabled=Pt.labelEnabled===!0,(0,st.Ym)(Pt,"labels","array")||(Pt.labels=["microphone","camera","screenSharing","sip"]),pn.log("startRecording() on ApiRTC MCU with roomId :",Bt.roomName),Ut={type:"startRecording",roomId:Bt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:"COMPOSITE",data:Pt,customIdInFilename:Ct,mediaType:nt,convId:yt},Ot=JSON.stringify(Ut),pn.log("C->S: "+Ot),apiCC.session.channel.socket.emit("startRecording",Ot)):pn.log("startCompositeRecording() but client is not in session")},this.stopCompositeRecording=function(nt){pn.info("stopCompositeRecording");var Ct,yt,Pt;(Pt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0}))?(pn.log("stopRecording() on ApiRTC MCU with roomId :",Pt.roomName),Ct={type:"stopRecording",roomId:Pt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:"COMPOSITE",data:{pubSub:this.pubConnector}},yt=JSON.stringify(Ct),pn.log("C->S: "+yt),apiCC.session.channel.socket.emit("stopRecording",yt)):pn.log("stopCompositeRecording() but client is not in session")},this.inviteVoIP=function(nt,Ct,yt){var Pt=this;return new Promise(function(Et,Ut){if(!nt||typeof nt!="string")return Ut(new Error("wrong roomId"));if(!Pt.getSessionMCU(nt))return Ut(new Error("no such session"));if(!Ct||typeof Ct!="string")return Ut(new Error("wrong convId"));if(!yt||typeof yt!="string")return Ut(new Error("wrong phoneNumber"));var Ot="inviteVoIP-"+yt;try{if(Gt.hasReceiptHook(Ot))return Ut(new Error("busy"));var Bt=new Dt;Bt.onSuccess(function(){return Et()}),Bt.onFailure(function(Jt){return Ut(Jt)}),Bt.setTimeout(1e4,"timeout"),Gt.createReceiptHook(Ot,Bt)}catch(Jt){return pn.debug("inviteVoIP: createReceiptHook",Jt),Ut(new Error("internal error"))}var Qt={type:"inviteVoIP",clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,roomId:nt,convId:Ct,phoneNumber:yt,receiptId:Ot,data:{pubSub:"sipConnector"}},en=JSON.stringify(Qt);pn.debug("C->S:",en),apiCC.session.channel.socket.emit("inviteVoIP",en)})},this.enforceMCU=function(nt){var Ct;if(Ct=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0})){var yt={type:"info",infoType:"enforceMCU",data:{clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,roomId:Ct.roomName,pubSub:this.pubConnector}},Pt=JSON.stringify(yt);pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("info",Pt)}else pn.log("enforceMCU() but client is not in session")},this.meshPublish=function(nt,Ct,yt,Pt,Et,Ut){var Ot=!1,Bt=null,Qt=null,en=this.getSessionMCU(nt);if(!en)return pn.error("meshPublish() - missing sessionMCU"),null;if(Pt===!0||Pt===!1||Pt==="true"||Pt==="false"?(pn.log("DEPRECATED ... please use callConfiguration JSON parameter : callConfiguration.audioOnly instead of audioOnly"),Ot=Pt,Pt={}):Pt!==null&&un(Pt)==="object"||(Pt={}),Et!==null&&un(Et)==="object"||(Et={}),(0,st.Ym)(Pt,"profileType","string")&&(Et.profileType=Pt.profileType),(0,st.Ym)(Pt,"priority","number")&&Pt.priority>=0&&(Et.priority=Pt.priority),(0,st.Ym)(Pt,"downgradeProfileList","array")&&(Et.downgradeProfileList=Pt.downgradeProfileList),Pt.audioOnly!==void 0&&(Ot=Pt.audioOnly,Et.callConfiguration!==void 0||(Et.callConfiguration={}),Et.callConfiguration.audioOnly=Pt.audioOnly),(0,st.Ym)(Pt,"context","object"))try{JSON.stringify(Pt.context),Et.context=Pt.context}catch{}return Bt=new Tn(apiCC.session.apiCCWebRTCClient.webRTCClient),Ot!==!0&&Ot!=="true"||(pn.log("Setting call as audioOnly"),Bt.callType="audio"),Bt.roomId=nt,Bt.sessionId=Ct,Bt.token=yt,Bt.callConfiguration=Pt,Bt.data=Et,Bt.options=Ut,Bt.sessionMCU=en,apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.push(Bt),Pt.userMediaStreamId?((Qt=apiCC.getUserMediaStream(Pt.userMediaStreamId)).addCallInfo(Bt.userMediaId,"userMedia"),Bt.callConfiguration.userMediaStreamId=Qt.userMediaStreamId,Bt.callType=Qt.callType,Bt.audio=Qt.audio,Bt.video=Qt.video,Bt.audioMuted=Qt.audioMuted,Bt.videoMuted=Qt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Bt),apiCC.checkMutingStateForUserMedia(Pt,Qt)):apiCC.createUserMediaStream({callId:Bt.userMediaId,callFlavor:"userMedia",type:Bt.callType,audioSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.audioSourceId,videoSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.videoSourceId,success:function(Jt){pn.debug("[meshPublish] success; userMediaStreamId: "+Jt.userMediaStreamId),Bt.callConfiguration.userMediaStreamId=Jt.userMediaStreamId,Bt.callType=Jt.callType,Bt.audio=Jt.audio,Bt.video=Jt.video,Bt.audioMuted=Jt.audioMuted,Bt.videoMuted=Jt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Bt),apiCC.checkMutingStateForUserMedia(Pt,Jt)}}),Bt.userMediaId},this.meshOnUserMediaSuccess=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0&&arguments[1],yt=null,Pt=null;Ct===!0?((yt={}).type="streamStatusChanged",yt.callerId=Gt.clientId,yt.roomId=nt.roomId,yt.streams={},yt.streams[nt.userMediaId]={eventType:"modify",callId:nt.userMediaId,callType:nt.callType,audio:nt.audio,video:nt.video,audioMuted:nt.audioMuted,videoMuted:nt.videoMuted},yt.data={},yt.data.meshPublish=!0,yt.data.pubSub=this.pubConnector,Pt=JSON.stringify(yt),pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("streamStatusChanged",Pt)):(this.publishCallId=nt.userMediaId,nt.addAck=!0,nt.addTimeoutId=setTimeout(function(){Gt.onRemoteHangup(nt.userMediaId,Gt.clientId,nt.roomId,"Unable_to_establish",null,null)},nt.disconnectionTimer),(yt={}).type="streamStatusChanged",yt.callerId=Gt.clientId,yt.roomId=nt.roomId,yt.streams={},yt.streams[nt.userMediaId]={eventType:"add",callId:nt.userMediaId,callType:nt.callType,audio:nt.audio,video:nt.video,audioMuted:nt.audioMuted,videoMuted:nt.videoMuted},yt.data=nt.data,yt.data.meshPublish=!0,yt.data.pubSub=this.pubConnector,Pt=JSON.stringify(yt),pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("streamStatusChanged",Pt))},this.meshPublishScreen=function(nt,Ct,yt,Pt,Et){var Ut=null,Ot=null,Bt=this.getSessionMCU(nt);return Bt?(yt!==null&&un(yt)==="object"||(yt={}),(Ut=new Tn(apiCC.session.apiCCWebRTCClient.webRTCClient)).roomId=nt,Ut.data=Ct,Ut.callConfiguration=yt,Ut.captureSourceType=Pt,Ut.sessionMCU=Bt,apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.push(Ut),yt.userMediaStreamId?((Ot=apiCC.getUserMediaStream(yt.userMediaStreamId)).addCallInfo(Ut.userMediaId,"userMedia"),Ut.callConfiguration.userMediaStreamId=Ot.userMediaStreamId,Ut.callType=Ot.callType,Ut.audio=Ot.audio,Ut.video=Ot.video,Ut.audioMuted=Ot.audioMuted,Ut.videoMuted=Ot.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Ut)):apiCC.createUserMediaStream({callId:Ut.userMediaId,callFlavor:"userMedia",type:"screenSharing",captureSourceType:Pt,success:function(Qt){pn.debug("[meshPublishScreen] success; userMediaStreamId: "+Qt.userMediaStreamId),Ut.callConfiguration.userMediaStreamId=Qt.userMediaStreamId,Ut.callType=Qt.callType,Ut.audio=Qt.audio,Ut.video=Qt.video,Ut.audioMuted=Qt.audioMuted,Ut.videoMuted=Qt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnScreenMediaSuccess(Ut)}}),Ut.userMediaId):(pn.error("meshPublishScreen() - missing sessionMCU"),null)},this.meshOnScreenMediaSuccess=function(nt){var Ct,yt=null;nt.addAck=!0,nt.addTimeoutId=setTimeout(function(){Gt.onRemoteHangup(nt.userMediaId,Gt.clientId,nt.roomId,"Unable_to_establish",null,null)},nt.disconnectionTimer),(yt={}).type="streamStatusChanged",yt.callerId=Gt.clientId,yt.roomId=nt.roomId,yt.streams={},yt.streams[nt.userMediaId]={eventType:"add",callId:nt.userMediaId,callType:nt.callType,audio:nt.audio,video:nt.video,audioMuted:nt.audioMuted,videoMuted:nt.videoMuted},yt.data={},yt.data.pubSub=this.pubConnector,Ct=JSON.stringify(yt),pn.log("C->S: "+Ct),apiCC.session.channel.socket.emit("streamStatusChanged",Ct)},this.meshOnHangup=function(nt,Ct){var yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Pt=0,Et=null,Ut=null,Ot=null;if(Ct!==null&&un(Ct)==="object"||(Ct={}),nt){if((Et=Gt.findUserMediaById(nt))!==null){for(Et.close(),Et.streamStolen!==!0&&(Gt.myWebRTC_Event.createHangupEvent("local",Gt.clientId,0,!0,null,Et.userMediaId,Et.callType),Et.releaseUserMediaStream()),(Ut={}).type="streamStatusChanged",Ut.callerId=Gt.clientId,Ut.roomId=Et.roomId,Ut.streams={},Ut.streams[Et.userMediaId]={eventType:"remove",callId:Et.userMediaId,callType:Et.callType},yt.restart&&(Ut.streams[Et.userMediaId].restart=!0),Ut.data={},Ut.data.pubSub=this.pubConnector,Ot=JSON.stringify(Ut),pn.log("C->S: "+Ot),apiCC.session.channel.socket.emit("streamStatusChanged",Ot),Pt=Gt.userMediaTable.length;--Pt>=0;)if(Gt.userMediaTable[Pt]===Et){Gt.userMediaTable.splice(Pt,1);break}}}else for(Pt=Gt.userMediaTable.length;--Pt>=0;)Et=Gt.userMediaTable[Pt],yt.hasOwnProperty("roomId")&&Et.sessionMCU.roomName!==yt.roomId||(Gt.myWebRTC_Event.createHangupEvent("local",Gt.clientId,0,!0,null,Et.userMediaId,Et.callType),Et.close(),Et.releaseUserMediaStream(),(Ut={}).type="streamStatusChanged",Ut.callerId=Gt.clientId,Ut.roomId=Et.roomId,Ut.streams={},Ut.streams[Et.userMediaId]={eventType:"remove",callId:Et.userMediaId,callType:Et.callType},Ut.data={},Ut.data.pubSub=this.pubConnector,Ot=JSON.stringify(Ut),pn.log("C->S: "+Ot),apiCC.session.channel.socket.emit("streamStatusChanged",Ot),Gt.userMediaTable.splice(Pt,1))},this.participantEjected=function(nt){(0,st.Ym)(nt.data,"clientId","string")&&Gt.myWebRTC_Event.createMCUParticipantEjectedEvent(nt.roomId,nt.data.clientId,nt.data.info)},this.ejectParticipant=function(nt,Ct,yt){var Pt;if(Pt=yt?this.getSessionMCU(yt):this.getSessionMCU(null,{first:!0})){var Et={type:"ejectParticipant",roomId:Pt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector,clientId:nt}};Ct&&(Et.data.info=Ct);var Ut=JSON.stringify(Et);pn.log("C->S: "+Ut),apiCC.session.channel.socket.emit("ejectParticipant",Ut)}else pn.debug("ejectParticipant() - missing sessionMCU")},this.getJoinSessionReq=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=null;if(!nt){if(Ct.hasOwnProperty("transactionId")){for(var Pt=this.joinSessionReqs.length;--Pt>=0;)if(this.joinSessionReqs[Pt].transactionId===Ct.transactionId){yt=this.joinSessionReqs[Pt];break}return yt}return null}for(var Et=this.joinSessionReqs.length;--Et>=0;)if(this.joinSessionReqs[Et].roomId===nt){yt=this.joinSessionReqs[Et];break}return yt},this.removeJoinSessionReq=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!nt){if(Ct.all===!0)return this.joinSessionReqs.splice(0,this.joinSessionReqs.length),!0;Ct.hasOwnProperty("roomId")&&(nt=this.getJoinSessionReq(Ct.roomId))}if(!nt)return!1;for(var yt=this.joinSessionReqs.length;--yt>=0&&this.joinSessionReqs[yt]!==nt;);return yt>=0&&(this.joinSessionReqs.splice(yt,1),!0)},this.getSessionMCU=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=null;if(!nt){if(Ct.first===!0)return this.sessionMCUs[0];if((0,st.Ym)(Ct.callback,"function")){pn.debug("getSessionMCU callback");for(var Pt=this.sessionMCUs.length;--Pt>=0;)if(Ct.callback(this.sessionMCUs[Pt])){yt=this.sessionMCUs[Pt];break}}return yt}for(var Et=this.sessionMCUs.length;--Et>=0;)if(this.sessionMCUs[Et].roomName===nt){yt=this.sessionMCUs[Et];break}return yt},this.removeSessionMCU=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!nt&&Ct.all===!0)return this.sessionMCUs.splice(0,this.sessionMCUs.length),!0;if(!nt)return!1;for(var yt=this.sessionMCUs.length;--yt>=0&&this.sessionMCUs[yt]!==nt;);return yt>=0&&(this.sessionMCUs.splice(yt,1),!0)},this.callback=function(nt,Ct){return this.closureHandler=function(yt){return nt[Ct](yt)},this.closureHandler}};function xn(Gt){pn.debug("disputableEntryTimeout",Gt);for(var Tt=apiCC.session.apiCCWebRTCClient.webRTCClient,nt=this.disputableStreamList.length;--nt>=0;)if(this.disputableStreamList[nt].streamInfo.id===Gt){this.disputableStreamList.splice(nt,1);break}for(var Ct=null,yt=this.streamList.length;--yt>=0;)if(this.streamList[yt].streamInfo.id===Gt){Ct=Tt.destroyCallControl({type:"subscribe",stream:this.streamList[yt].streamInfo}),this.streamList.splice(yt,1);break}Ct&&Ct.callId&&In.createHangupEvent("remote",Tt.clientId,Ct.roomName,!1,"Hangup_From_Callee",Ct.callId,Ct.callType),In.createMCURemovedStreamEvent(Gt)}function Pn(Gt){pn.debug("clearDisputableEntry",Gt);for(var Tt=this.disputableStreamList.length;--Tt>=0;)if(this.disputableStreamList[Tt].streamInfo.id===Gt){this.disputableStreamList.splice(Tt,1);break}for(var nt=this.streamList.length;--nt>=0;)if(this.streamList[nt].streamInfo.id===Gt){this.streamList[nt].disputableTimeoutId&&(clearTimeout(this.streamList[nt].disputableTimeoutId),delete this.streamList[nt].disputableTimeoutId),delete this.streamList[nt].clearDisputableEntry;break}}function On(Gt){var Tt={};return(0,st.ki)(Gt,"maxBitrate","number")&&(Tt.maxBitrate=Gt.maxBitrate),(0,st.ki)(Gt,"scaleResolutionDownBy","number")&&(Tt.scaleResolutionDownBy=Gt.scaleResolutionDownBy),Tt}function Dn(Gt){return(0,st.Ym)(Gt.encodings,"object")?(0,st.ki)(Gt.encodings.high,"maxBitrate","number")&&(0,st.ki)(Gt.encodings.medium,"maxBitrate","number")&&(0,st.ki)(Gt.encodings.low,"maxBitrate","number")?(Gt.encodings.high=Object.assign({active:!0},On(Gt.encodings.high)),Gt.encodings.medium=Object.assign({active:!0},On(Gt.encodings.medium)),Gt.encodings.low=Object.assign({active:!0},On(Gt.encodings.low)),Gt.sendEncodings=[{rid:"h",active:!0},{rid:"m",active:!0},{rid:"l",active:!0}],Gt.sendEncodings[0].maxBitrate=1e3*Gt.encodings.high.maxBitrate,Gt.sendEncodings[1].maxBitrate=1e3*Gt.encodings.medium.maxBitrate,Gt.sendEncodings[2].maxBitrate=1e3*Gt.encodings.low.maxBitrate,(0,st.ki)(Gt.encodings.medium,"scaleResolutionDownBy","number")&&(Gt.sendEncodings[1].scaleResolutionDownBy=Gt.encodings.medium.scaleResolutionDownBy),(0,st.ki)(Gt.encodings.low,"scaleResolutionDownBy","number")&&(Gt.sendEncodings[2].scaleResolutionDownBy=Gt.encodings.low.scaleResolutionDownBy),!0):(pn.warn("no such maxBitrate"),!1):(pn.warn("no such encodings"),!1)}function Fn(Gt,Tt){if(Tt<650)return!1;var nt=Math.floor(9*Tt/13),Ct=Math.floor(3*Tt/13),yt=Tt-nt-Ct;return Gt.encodings={high:{maxBitrate:nt},medium:{maxBitrate:Ct,scaleResolutionDownBy:2},low:{maxBitrate:yt,scaleResolutionDownBy:4}},Dn(Gt)}et.Y.get("CallControl");var dr=function(Gt){this.type=Gt.type,Gt.callId&&(this.callId=Gt.callId),Gt.callType?this.callType=Gt.callType:this.callType="media",Object.prototype.hasOwnProperty.call(Gt,"audioOnly")&&(this.audioOnly=!!Gt.audioOnly),Gt.roomName&&(this.roomName=Gt.roomName),Gt.mediaType&&(this.mediaType=Gt.mediaType),Gt.callConfiguration&&(this.callConfiguration=Gt.callConfiguration),Gt.data&&(this.data=Gt.data),Gt.stream&&(this.stream=Gt.stream),this.autoRestart={}},ir=function(){var Gt=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];this.a=1,this.b=0,this.c=7,this.d=0,this.update=function(Tt,nt,Ct){var yt=0;for(nt==null&&(nt=0),Ct==null&&(Ct=Tt.length);yt<Ct;yt+=1)this.a=(this.a+Tt[nt+yt])%65521,this.b=(this.b+this.a)%65521,this.c=(this.c+3)*(Tt[nt+yt]+5)%65521,this.d=(this.d+this.c)%65521},this.digest=function(Tt){return Gt[this.d>>12&15]+Gt[this.d>>8&15]+Gt[this.d>>4&15]+Gt[15&this.d]+Gt[this.c>>12&15]+Gt[this.c>>8&15]+Gt[this.c>>4&15]+Gt[15&this.c]+Gt[this.b>>12&15]+Gt[this.b>>8&15]+Gt[this.b>>4&15]+Gt[15&this.b]+Gt[this.a>>12&15]+Gt[this.a>>8&15]+Gt[this.a>>4&15]+Gt[15&this.a]}};function Xn(Gt,Tt){return Gt==="checksum64"?new ir:null}function tr(Gt){return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Tt){return typeof Tt}:function(Tt){return Tt&&typeof Symbol=="function"&&Tt.constructor===Symbol&&Tt!==Symbol.prototype?"symbol":typeof Tt},tr(Gt)}var cn=et.Y.get("WebRTC_Client"),Jn=apiCC.myWebRTC_Event,Qn=4e4,sr=function(Gt){function Tt(nt,Ct,yt){var Pt,Et=nt.width,Ut=Et<<2,Ot=nt.height,Bt=null,Qt=0,en=0,Jt=0,an=0,hn=0,rn=0,dn=0,Sn=0,wn=0,An=0,_n=0,jn=0,ar=0,fr=0,Cr=0,gr=0;if(Ct){for(Bt=Ct.data,yt<0&&(yt=0),Sn=1-((hn=(2.44413*(Qt=yt>=2.5?.98711*yt-.9633:yt>=.5?3.97156-4.14554*Math.sqrt(1-.26891*yt):2*yt*(3.97156-4.14554*Math.sqrt(.865545)))+2.85619*(en=Qt*Qt)+1.26661*(Jt=en*Qt))/(an=1.57825+2.44413*Qt+1.4281*en+.422205*Jt))+(rn=-(1.4281*en+1.26661*Jt)/an)+(dn=.422205*Jt/an)),Pt=0;Pt<3;Pt++)for(wn=0;wn<Ot;wn++){for(_n=wn*Ut+(Et-1<<2)+Pt,Cr=fr=ar=jn=Bt[An=wn*Ut+Pt],An=wn*Ut+Pt;An<=_n;An+=4)jn=Sn*Bt[An]+hn*ar+rn*fr+dn*Cr,Bt[An]=jn,Cr=fr,fr=ar,ar=jn;for(_n=wn*Ut+Pt,Cr=fr=ar=jn=Bt[An=wn*Ut+(Et-1<<2)+Pt],An=wn*Ut+(Et-1<<2)+Pt;An>=_n;An-=4)jn=Sn*Bt[An]+hn*ar+rn*fr+dn*Cr,Bt[An]=jn,Cr=fr,fr=ar,ar=jn}for(Pt=0;Pt<3;Pt++)for(gr=0;gr<Et;gr++){for(_n=(Ot-1)*Ut+(gr<<2)+Pt,Cr=fr=ar=jn=Bt[An=(gr<<2)+Pt],An=(gr<<2)+Pt;An<=_n;An+=Ut)jn=Sn*Bt[An]+hn*ar+rn*fr+dn*Cr,Bt[An]=jn,Cr=fr,fr=ar,ar=jn;for(_n=(gr<<2)+Pt,Cr=fr=ar=jn=Bt[An=(Ot-1)*Ut+(gr<<2)+Pt],An=(Ot-1)*Ut+(gr<<2)+Pt;An>=_n;An-=Ut)jn=Sn*Bt[An]+hn*ar+rn*fr+dn*Cr,Bt[An]=jn,Cr=fr,fr=ar,ar=jn}return Ct}}this.localStream=null,this.remoteStream=null,this.channelReady=!1,this.socket=Gt.channel.socket,this.clientId=Gt.apiCCId,this.compositeClientId=Gt.apiCCId+"@"+Gt.apiCCSessionId,this.apiKey=Gt.apiKey,this.isVideoMuted=!1,this.isAudioMuted=!1,this.receiptHooks={},this.callControlTable=[],this.userMediaTable=[],this.callsTable=[],this.callsRetriesTable={},this.restartCallDelay=1e3,this.maxCallsRetriesDuration=15e4,this.accessToLocalMedia=!1,this.unidirectionelCallOnly=!1,this.NtoNConf=!1,this.autoAnswer=!1,this.RTPMedia=!1,this.logoAdded=!1,this.preferOpusCodec=!1,this.preferVP9Codec=!1,typeof apiRTC_React<"u"&&ot.BF==="iOS"?(cn.log("React and iOS : Setting H264 as preferred codec"),this.preferH264Codec=!0):this.preferH264Codec=!1,this.preferSendingH264Codec=!1,this.setStereo=!1,this.allowedAudioCodecs="",this.allowedVideoCodecs="",this.mediaRoutingModeEnum={hostOnly:1,stun:2,stunOnly:3,turn:4,turnOnly:5},this.mediaRoutingMode=this.mediaRoutingModeEnum.turn,this.myWebRTC_Event=apiCC.myWebRTC_Event,this.getUserMediaOnGoing=!1,this.userAcceptOnIncomingCall=!1,this.userAcceptOnIncomingCallBeforeGetUserMedia=!1,this.userAcceptOnIncomingDataCall=!1,this.userAcceptOnIncomingScreenSharingCall=!1,this.maxWidthRemoteVideo=0,this.maxHeightRemoteVideo=0,this.nickname=Gt.nickname,this.allowMultipleCalls=!1,this.mySDPManager=new pt,this.MCUClient=new Mn(this,this.clientId),this.audioSourceId=null,this.audioOutputId=null,this.videoSourceId=null,this.facingMode=null,this.apiRTCExtensionInstalled=!1,this.trickleIce=!0,this.waitingShareScreenCallId=0,this.waitingShareScreenDestNumber=0,this.waitingCaptureSourceType=null,this.qosEnable=!1,this.qosInterval=5e3,this.csmEnable=!1,this.qualityScoreEnable=!1,this.qualityScoreIntervalMs=5e3,this.csmIntervalMs=5e3,this.recordedCall=!1,this.audioBandwidth=null,this.videoBandwidth=null,this.videoRemoteBandwidth=null,this.videoBandwidthSettings={},this.dataBandwidth=null,this.pc_config="",this.clientIncomingCandidatesQueue=[],this.cleanStoredCallCandidateTimer=6e4,this.initializeGumConfig=function(){ot.Xh==="Edge"&&ot.PR>=15&&apiRTC.browserDetails.type!=="chrome"?this.gum_config={audio:!0,video:!0}:ot.Xh==="Chrome"&&ot.PR<49||ot.Xh==="Firefox"&&ot.PR<50?this.gum_config={audio:{mandatory:{},optional:[]},video:{mandatory:{},optional:[]}}:this.gum_config={audio:{},video:{}}},this.initializeGumConfig(),this.setGumConfigWithDevicePresent=function(){apiCC.mediaDeviceMgr.audioDevicePresent===!1&&(this.gum_config.audio=!1),apiCC.mediaDeviceMgr.videoDevicePresent===!1&&(this.gum_config.video=!1),apiCC.mediaDeviceMgr.audioDevicePresent===!1&&apiCC.mediaDeviceMgr.videoDevicePresent===!1&&(this.unidirectionelCallOnly=!0),cn.log("this.gum_config:",this.gum_config)},this.userMediaErrorDetected=!1,this.lastUsedUserMediaConstraint=null,this.mediaTypeForIncomingCall="VIDEO",this.mediaTypeForOutgoingCall="VIDEO",this.allowAsymetricMediaCalls=!1,this.receiveMediaDeactivated=!1,this.configTurnServer=null,apiCC.myWebRTC_Adapter.adaptForIoSCordova(),this.pc_config={iceServers:[{urls:["turns:mp1.apizee.com:443?transport=udp","turns:mp1.apizee.com:443?transport=tcp","turn:mp1.apizee.com:443?transport=udp","turn:mp1.apizee.com:443?transport=tcp","turns:mp2.apizee.com:443?transport=udp","turns:mp2.apizee.com:443?transport=tcp","turn:mp2.apizee.com:443?transport=udp","turn:mp2.apizee.com:443?transport=tcp"],credential:"password",username:"anonymous"}]},ot.Xh==="Firefox"&&ot.PR<53?(cn.log("createPeerConnection FIREFOX"),cn.log("webrtcDetectedVersion : "+apiCC.myWebRTC_Adapter.webrtcDetectedVersion),ot.PR<38?this.pc_config={iceServers:[{url:"stun:mp1.apizee.com:443",credential:"password",username:"anonymous"},{url:"turn:mp1.apizee.com:443",credential:"password",username:"anonymous"}]}:ot.PR>=42?this.pc_config={iceServers:[{urls:["turn:mp1.apizee.com:443?transport=udp","turn:mp1.apizee.com:443?transport=tcp"],credential:"password",username:"anonymous"}]}:this.pc_config={iceServers:[{urls:"turn:mp1.apizee.com:443?transport=tcp",credential:"password",username:"anonymous"},{url:"turn:mp1.apizee.com:443?transport=tcp",credential:"password",username:"anonymous"}]}):ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11?(cn.log("Browser is :"+ot.Xh+" - using Plugin"),this.pc_config={iceServers:[{url:"stun:mp1.apizee.com:443",credential:"password",username:"anonymous"},{url:"turn:mp1.apizee.com:443",credential:"password",username:"anonymous"}]}):ot.Xh==="Edge"&&ot.PR<45&&apiRTC.browserDetails.type!=="chrome"?(cn.log("Browser is Edge < 45 - removing Turns config"),this.pc_config={iceServers:[{urls:["turn:mp1.apizee.com:443?transport=udp","turn:mp1.apizee.com:443?transport=tcp","turn:mp2.apizee.com:443?transport=udp","turn:mp2.apizee.com:443?transport=tcp"],credential:"password",username:"anonymous"}]}):cn.log("default this.pc_config configuration"),this.pc_constraints={optional:[]},st.wL.type==="edge"?cn.debug("not data channel capable"):st.wL.type==="safari"?st.wL.version>=11?this.dataChannelCapable=!0:cn.debug("not data channel capable"):this.dataChannelCapable=!0,st.wL.type==="chrome"&&st.wL.version>=68||st.wL.type==="firefox"&&st.wL.version>=64||st.wL.type==="safari"&&st.wL.version>=12?(cn.debug("RTCRtpSender#setParameters is available"),this.rtpSenderSetParamatersCapable=!0):(cn.debug("RTCRtpSender#setParameters is NOT available"),this.rtpSenderSetParamatersCapable=!1),this.setClientTurnServer=function(nt){cn.info("setClientTurnServer :",nt);var Ct=JSON.stringify(this.pc_config);Ct=Ct.replace(/mp1.apizee.com/g,nt),this.pc_config=JSON.parse(Ct)},this.activateScreenSharing=function(nt){apiCC.activateScreenSharing(nt)},this.setGetUserMediaConfig=function(nt){if(cn.log("setGetUserMediaConfig :",nt),navigator.mediaDevices!==null&&navigator.mediaDevices!==void 0&&navigator.mediaDevices.getSupportedConstraints!==null&&navigator.mediaDevices.getSupportedConstraints!==void 0){var Ct=navigator.mediaDevices.getSupportedConstraints();cn.log("Supported Constraints :",Ct)}nt.video!==void 0&&(nt.video.height===void 0&&nt.video.width===void 0||nt.optional!==void 0&&(cn.warn("contraints with both optional/mandatory and specific or advanced constraints usage : this may failed depending of browsers"),cn.log("setGetUserMediaConfig : contraints modification to avoid both optional/mandatory and specific or advanced constraints usage"),nt.optional.sourceId!==void 0&&(cn.log("sourceId contraints modification to deviceId"),nt.video.deviceId===void 0&&(nt.video.deviceId={}),nt.video.deviceId.ideal=nt.optional.sourceId),delete nt.optional)),cn.log("this.gum_config :",this.gum_config),this.gum_config=nt},this.getUserMedia=function(){try{this.gum_config=apiCC.setAudioSourceIdInConstraint(this.audioSourceId,this.gum_config),this.gum_config=apiCC.setVideoSourceIdInConstraint(this.videoSourceId,this.gum_config),this.lastUsedUserMediaConstraint=this.gum_config,ot.Xh==="IE"&&ot.dc>8?apiCC.getUserMediaWithCB(this.gum_config,this.callback(this,"onUserMediaSuccess"),this.callback(this,"onUserMediaError")):apiCC.getUserMedia(this.gum_config).then(this.callback(this,"onUserMediaSuccess")).catch(this.callback(this,"onUserMediaError"))}catch(nt){cn.error("getUserMedia() failed. Is this a WebRTC capable browser?"),cn.log("getUserMedia failed with exception: "+nt.message)}},this.onUserMediaSuccess=function(nt){cn.info("onUserMediaSuccess : User has granted access to local media."),this.accessToLocalMedia=!0;var Ct=!1,yt="Unknown",Pt=!1,Et="Unknown";this.localStream=nt,nt.getAudioTracks().length>0&&(Ct=!0,nt.getAudioTracks()[0].label&&(yt=nt.getAudioTracks()[0].label),cn.log("Using audio device: "+yt)),nt.getVideoTracks().length>0&&(Pt=!0,nt.getVideoTracks()[0].label&&(Et=nt.getVideoTracks()[0].label),cn.log("Using video device: "+Et)),this.myWebRTC_Event.createUserMediaSuccessEvent(!1,Ct,yt,Pt,Et,"media",null,nt,null,!1)},this.onUserMediaError=function(nt){cn.info("onUserMediaError : Failed to get access to local media. Error : ",nt),cn.error(nt),this.accessToLocalMedia=!1,ot.$6!=="electron"&&ot.Xh==="Chrome"&&ot.PR>47&&(cn.log("browser_version > 47"),window.location.protocol!=="https:"&&cn.error("HTTPS is now mandatory to use getUserMedia()")),this.myWebRTC_Event.createUserMediaErrorEvent(!1,"media",nt,null,null,null,this.gum_config),nt=null,apiCC.session.tryAudioCallAfterUserMediaError===!0?(cn.log("this.lastUsedUserMediaConstraint :",this.lastUsedUserMediaConstraint),cn.log("this.lastUsedUserMediaConstraint.video :",this.lastUsedUserMediaConstraint.video),this.lastUsedUserMediaConstraint.video!==!1?(cn.log("this.lastUsedUserMediaConstraint.audio :",this.lastUsedUserMediaConstraint.audio),cn.log("UserMediaError, Trying to getUserMedia with audioOnly"),this.videoSourceId=null,this.gum_config.video=!1,this.getUserMedia()):cn.log("onUserMediaError without video")):cn.log("try AudioCall after UserMediaError is not activated")},this.evalCallProfileWithSdp=function(nt,Ct,yt){return this.evalCallProfileWithSdpGuideline(this.mySDPManager.createGuideline(nt),nt,Ct,yt)},this.evalCallProfileWithSdpGuideline=function(nt,Ct,yt,Pt){var Et={};return nt.hasOwnProperty("audio")?(Et.audio=!0,Et.audioActive=yt==="local"&&Pt==="send"?nt.audio.direction==="sendrecv"||nt.audio.direction==="sendonly":yt==="local"&&Pt==="receive"||yt==="remote"&&Pt==="send"?nt.audio.direction==="sendrecv"||nt.audio.direction==="recvonly":yt==="remote"&&Pt==="receive"&&(nt.audio.direction==="sendrecv"||nt.audio.direction==="sendonly")):(Et.audio=!1,Et.audioActive=!1),nt.hasOwnProperty("video")?(Et.video=!0,Et.videoActive=yt==="local"&&Pt==="send"?nt.video.direction==="sendrecv"||nt.video.direction==="sendonly":yt==="local"&&Pt==="receive"||yt==="remote"&&Pt==="send"?nt.video.direction==="sendrecv"||nt.video.direction==="recvonly":yt==="remote"&&Pt==="receive"&&(nt.video.direction==="sendrecv"||nt.video.direction==="sendonly")):(Et.video=!1,Et.videoActive=!1),Et},this.checkDestCallTypeWithSDP=function(nt,Ct){cn.debug("checkDestCallTypeWithSDP");var yt=this.mySDPManager.createGuideline(nt),Pt=!1,Et=!1;!yt.audio||yt.audio.direction!=="sendrecv"&&yt.audio.direction!=="sendonly"||(Pt=!0),!yt.video||yt.video.direction!=="sendrecv"&&yt.video.direction!=="sendonly"||(Et=!0),Ct.destCallType=Pt===!0?Et===!0?"media":"audio":Et===!0?"videoOnly":"inactive",cn.debug("call.destCallType: "+Ct.destCallType),Ct.callee!==!0||yt.audio&&yt.audio.direction!=="sendonly"||yt.video&&yt.video.direction!=="sendonly"||(Ct.userMediaAccessRequired=!1,Ct.mediaTypeForOutgoingCall="NONE",cn.debug("access to user media not required"))},this.evaluateVideoCap=function(nt){delete nt.videoCap,nt.belongsToRoom()?nt.settingUpType!=="publish"&&nt.settingUpType!=="shareScreen"||nt.localCallProfile&&nt.localCallProfile.video&&nt.localCallProfile.videoActive&&this.evalOutgoingVideoBandwithCap(nt):(this.rtpSenderSetParamatersCapable||!nt.callee)&&nt.localCallProfile&&nt.localCallProfile.video&&nt.localCallProfile.videoActive&&this.evalOutgoingVideoBandwithCap(nt)},this.processInvite=function(nt){cn.info("processInvite() - invite received from :"+nt.callerId);var Ct,yt=0,Pt=null,Et=null,Ut=null,Ot=null,Bt=!1,Qt=null,en=null,Jt=null,an={};if(nt.data!==void 0&&nt.data.type==="publish"&&nt.data.mesh!==void 0){if(cn.info("received invite publish mesh; mesh: "+JSON.stringify(nt.data.mesh)),(Pt=this.findCallWithCallIdAndInstanceId(nt.data.mesh.callerCallId,nt.data.instanceId))==null)return void cn.error("cannot find call; callId: "+nt.data.mesh.callerCallId);Pt.userMediaAccessRequired=!1,Pt.data.mesh=nt.data.mesh,Pt.setupTimeoutId&&(clearTimeout(Pt.setupTimeoutId),delete Pt.setupTimeoutId),Bt=!0}else{if(nt.data!==void 0&&nt.data.type==="subscribe"&&nt.data.mesh!==void 0){if(cn.debug("received invite subscribe mesh; mesh: ",nt.data.mesh),(Et=this.findUserMediaById(nt.data.mesh.calleeCallId))!==null)if(this.MCUClient.distantCalls.push({early:!0,roomId:nt.roomId,clientId:nt.data.mesh.callerId,callId:nt.data.mesh.callerCallId,callMode:"mesh",callDirection:"recvonly",callFeed:{clientId:nt.data.mesh.calleeId,callId:nt.data.mesh.calleeCallId}}),setTimeout((function(dn,Sn,wn){cn.debug("early distant call descriptor timeout");for(var An=this.MCUClient.distantCalls.length;--An>=0;)if(this.MCUClient.distantCalls[An].early&&this.MCUClient.distantCalls[An].roomId===dn&&this.MCUClient.distantCalls[An].clientId===Sn&&this.MCUClient.distantCalls[An].callId===wn){cn.debug("remove early distant call descriptor: timeout"),this.MCUClient.distantCalls.splice(An,1);break}}).bind(this,nt.roomId,nt.data.callerId,nt.data.callerCallId),3e4),Et.callType==="screenSharing"||Et.callType==="screenSharingWithAudio")an.type="publish",an.mesh=nt.data.mesh,an.instanceId=nt.data.instanceId,this.MCUClient.publishScreen(nt.roomId,an,null,Et.captureSourceType);else{var hn=(0,st.ws)({},Et.callConfiguration);nt.data.mediaType==="AUDIOONLY"?hn.audioOnly=!0:nt.data.mediaType==="VIDEOONLY"&&(hn.videoOnly=!0),(Ut=apiCC.getUserMediaStream(hn.userMediaStreamId))&&(Ut.audioMuted&&Ut.videoMuted?hn.muted="VIDEO":Ut.audioMuted?hn.muted="AUDIOONLY":Ut.videoMuted?hn.muted="VIDEOONLY":delete hn.muted),delete hn.distributedBroadcastEnabled,delete hn.simulcast,an.type="publish",an.mesh=nt.data.mesh,an.instanceId=nt.data.instanceId,this.MCUClient.publish(nt.roomId,null,null,hn,an,null)}else cn.debug("media not found: sending bye : Call_not_found"),new Rt.S(apiCC.session.channel.socket).sendBye(nt.callId,nt.calleeId,nt.roomId,nt.callerId,"Call_not_found",nt.data);return}if(nt.data!==void 0&&nt.data.type==="publish"&&nt.data.mode==="passive"){if((Pt=this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,nt.data.instanceId))==null)return void cn.debug("cannot find call; callId: "+nt.callId+", callerId: "+nt.callerId+", instanceId: "+nt.data.instanceId);Pt.userMediaAccessRequired=!1,Pt.setupTimeoutId&&(clearTimeout(Pt.setupTimeoutId),delete Pt.setupTimeoutId),Bt=!0}else(Pt=new Cn(this)).callId=nt.callId,Pt.instanceId=nt.data.instanceId,Pt.callerId=nt.callerId,Pt.calleeId=this.clientId,Pt.callee=!0,Pt.remoteId=nt.callerId}if(Pt.dest_roomId=nt.roomId,Pt.data!==void 0&&Bt===!0)for(Jt in nt.data)nt.data.hasOwnProperty(Jt)&&(Pt.data[Jt]=nt.data[Jt]);else Pt.data=nt.data;if(Pt.data.instanceId=Pt.instanceId,nt.data!==void 0&&nt.data.pubSub==="sipConnector"&&(Pt.trickleIce=!1,Pt.remoteType="sip"),Pt.checkDTLSCompliancy(),ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"&&(Qt=apiCC.session.getConnectedUserInfo(nt.callerId,"userData"),cn.log("destUserInfo :",Qt),Qt!=="User_Not_Found"&&Qt!==void 0&&(en=JSON.parse(Qt)).browser==="Chrome"&&en.osName==="Android"&&(cn.log("Browser is Edge and caller is Chrome on Android, setting VP8 as prefered codec for the call"),Pt.preferVP8Codec=!0)),nt.data!==void 0&&nt.data.type==="publish"&&nt.data.mode==="passive"&&nt.stream!==void 0&&nt.stream.id!==void 0&&(Pt.streamId=nt.stream.id,cn.log("call.streamId: "+Pt.streamId)),yt=this.callsTable.length,cn.log("processInvite() - Actual call Number is :"+yt),nt.callType==="screenSharing"||nt.callType==="screenSharingWithAudio")Pt.screenSharing=!0,Pt.callType=nt.callType;else if(nt.callType!=="data"){if(this.allowMultipleCalls===!1){for(cn.log("processInvite() - Refusing double call checking ..."),Ct=0;Ct<yt;Ct+=1)if(this.callsTable[Ct].callType!=="screenSharing"&&this.callsTable[Ct].callType!=="screenSharingWithAudio"&&this.callsTable[Ct].callType!=="data")return cn.log("processInvite() - Refusing double call"),Bt===!1?this.callsTable.push(Pt):cn.log("callAlreadyExist in table"),this.myWebRTC_Event.createCallAttemptEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId),void this.refuseCall(Pt.callId,"User_Busy");cn.log("NOT Refusing double call")}}Bt===!1?(yt=this.callsTable.push(Pt),cn.log("processInvite() - New call Number is :"+yt)):(cn.log("callAlreadyExist in table"),cn.log("processInvite() - call Number is :"+yt)),this.checkDestCallTypeWithSDP(nt.sdpoffer.sdp,Pt);var rn=this.mySDPManager.createGuideline(nt.sdpoffer.sdp);if(Pt.setLocalCallProfile(this.evalCallProfileWithSdpGuideline(rn,nt.sdpoffer.sdp,"remote","send")),Pt.setRemoteCallProfile(this.evalCallProfileWithSdpGuideline(rn,nt.sdpoffer.sdp,"remote","receive")),this.rtpSenderSetParamatersCapable||(this.evaluateVideoCap(Pt),Pt.videoCap&&(rn.video.bandwidth=Pt.videoCap,nt.sdpoffer.sdp=rn.generate())),Pt.receivedSdpOfferMessage=nt.sdpoffer,(0,st.ki)(nt,"stream","object")&&(nt.stream.audioMuted===!0&&(Pt.isRemoteAudioMuted=!0),nt.stream.videoMuted===!0&&(Pt.isRemoteVideoMuted=!0)),nt.callType==="data"){if(cn.log("Receiving DATA call"),Pt.callType="data",Pt.dataCall=!0,ot.Xh==="Edge"&&ot.PR<79&&apiRTC.browserDetails.type!=="chrome")return cn.warn("Cannot create DataChannel as it is not supported on Edge"),void this.refuseCall(Pt.callId,"DataChannel_Not_Supported");this.userAcceptOnIncomingDataCall||Pt.onUserMediaSuccessTestUni(),this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId,!1,yt,!1,nt.callType,!1,Pt.remoteType,Pt.destCallType)}else Pt.userMediaAccessRequired===!1||this.unidirectionelCallOnly||Pt.screenSharing===!0?(cn.log("call.userMediaAccessRequired :",Pt.userMediaAccessRequired),cn.log("this.unidirectionelCallOnly :",this.unidirectionelCallOnly),cn.log("call.screenSharing :",Pt.screenSharing),Pt.screenSharing===!0?this.userAcceptOnIncomingScreenSharingCall===!1?Pt.onUserMediaSuccessTestUni():cn.debug("userAcceptOnIncomingScreenSharingCall is activated : need user accept"):Bt===!0?(cn.log("processInvite() - callAlreadyExist"),Pt.onUserMediaSuccessTestUni()):this.userAcceptOnIncomingCall===!0||this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("processInvite() - Waiting for call accept or refuse from user - 1"):(cn.log("processInvite() - userAcceptOnIncomingCall is not activated"),Pt.onUserMediaSuccessTestUni()),nt.data!==void 0&&nt.data.subscribeOrder===!0||Bt!==!1||this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId,!1,yt,!1,nt.callType,!1,Pt.remoteType,Pt.destCallType)):(apiCC.userMediaStreamTable.length>0&&(Ot=apiCC.userMediaStreamTable[0].userMediaStreamId),this.accessToLocalMedia!==!0&&!Ot||this.autoAnswer!==!0?(Pt.audioOnly===!0&&apiCC.mediaDeviceMgr.audioDevicePresent===!1?(cn.log("processInvite() - audio and video media are not transmitted"),Pt.onUserMediaSuccessTestUni()):this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("Stand-by :: wait for getUserMediaOnCall && establishCall"):(cn.debug("processInvite() - call.getUserMediaOnCall()"),cn.log("processInvite() - this.autoAnswer :"+this.autoAnswer),Pt.getUserMediaOnCall()),Bt===!1&&this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId,!1,yt,Pt.audioOnly,nt.callType,!1,Pt.remoteType,Pt.destCallType)):(cn.log("processInvite() :: User has already granted access to local media and AutoAnswer activated : establishing call"),this.userAcceptOnIncomingCall===!0||this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("processInvite() - Waiting for call accept or refuse from user - 2"):Ot?(cn.log("using First available stream on apiRTC"),(Ut=apiCC.getUserMediaStream(Ot)).addCallInfo(Pt.callId),Pt.callConfiguration!==void 0&&Pt.callConfiguration!==null||(Pt.callConfiguration={}),Pt.callConfiguration.userMediaStreamId=Ut.userMediaStreamId,Pt.onUserMediaSuccessOnCall(Ut.stream)):Pt.establishCall(),Bt===!1&&this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId,!0,yt,Pt.audioOnly,nt.callType,!1,Pt.remoteType,Pt.destCallType)))},this.setRemoteDescriptionProcess=function(nt,Ct){this.preferSendingH264Codec&&(cn.log("Modification of SDP to set H264 as prefered sending codec"),Ct.sdp=this.mySDPManager.maybePreferCodec(Ct.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"||typeof apiRTC_React<"u"?nt.pc!==null?nt.pc.setRemoteDescription(Ct,nt.callback(nt,"onSetRemoteDescriptionSuccess"),nt.callback(nt,"onSetRemoteDescriptionFailure")):cn.debug("setRemoteDescriptionProcess - pc is null"):(cn.log("before setRemoteDescription - Promise version"),nt.pc!==null?nt.pc.setRemoteDescription(Ct).then(nt.callback(nt,"onSetRemoteDescriptionSuccess")).catch(nt.callback(nt,"onSetRemoteDescriptionFailure")):cn.debug("setRemoteDescriptionProcess - pc is null"))},this.process200OK=function(nt){var Ct,yt=null,Pt=null;if(nt.data!==void 0&&nt.data.instanceId!==void 0?(cn.info("200OK received from callId :"+nt.calleeId+", intanceId is :"+nt.data.instanceId),yt=this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,nt.data.instanceId)):(cn.info("200OK received from callId :"+nt.calleeId),yt=this.findCallWithCallIdAndRemoteId(nt.callId,nt.calleeId)),yt===null)return cn.warn("200OK received but callId and instanceId are not matching, no process"),void this.myWebRTC_Event.createErrorEvent("200OK received but callId is not matching, no process","NOT_MATCHING_CALLID_ON_200OK");yt.calleeId=nt.calleeId,nt.sdpanswer&&nt.sdpanswer.type!=="no-answer"?yt.message200OKReceived===!1?(cn.debug("first 200OK for the call"),yt.message200OKReceived=!0,yt.data.type!=="subscribe"&&this.checkDestCallTypeWithSDP(nt.sdpanswer.sdp,yt),Ct=this.mySDPManager.createGuideline(nt.sdpanswer.sdp),yt.setLocalCallProfile(this.evalCallProfileWithSdpGuideline(Ct,nt.sdpanswer.sdp,"remote","send")),yt.setRemoteCallProfile(this.evalCallProfileWithSdpGuideline(Ct,nt.sdpanswer.sdp,"remote","receive")),this.evaluateVideoCap(yt),!this.rtpSenderSetParamatersCapable&&yt.videoCap&&(Ct.video.bandwidth=yt.videoCap,nt.sdpanswer.sdp=Ct.generate()),yt.receivedSdpOfferMessage=nt.sdpanswer,cn.log("process200OK : before setRemoteDescription"),Pt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(nt.sdpanswer),this.videoRemoteBandwidth&&(cn.log("Modification of SDP to set remote video bandwidth"),Pt.sdp=this.mySDPManager.setVideoBandwidth(Pt.sdp,this.videoRemoteBandwidth)),this.setRemoteDescriptionProcess(yt,Pt),nt.data!==null&&nt.data!==void 0&&(yt.data!==null&&yt.data!==void 0?yt.data=(0,st.S6)(yt.data,nt.data):yt.data=nt.data)):cn.debug("200OK has already been received for this call, leaving process200OK"):Jn.createCallEstablishedEvent(yt.calleeId,yt.callType,yt.callId,yt.destCallType)},this.cleanStoredCallCandidate=function(nt,Ct){cn.debug("cleanStoredCallCandidate from callId :"+nt+", instanceId is :"+Ct),this.clientIncomingCandidatesQueue[nt+"-"+Ct]!==void 0&&this.clientIncomingCandidatesQueue[nt+"-"+Ct].length!==0&&(this.clientIncomingCandidatesQueue[nt+"-"+Ct].splice(0,this.clientIncomingCandidatesQueue[nt+"-"+Ct].length),delete this.clientIncomingCandidatesQueue[nt+"-"+Ct])},this.processCandidate=function(nt){var Ct=null,yt=nt.data&&nt.data.instanceId?nt.data.instanceId:null;cn.debug("Candidate received from callId :"+nt.callId+", instanceId is :"+yt),Ct=nt.callerId===this.clientId?yt?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,yt):this.findCallWithCallIdAndRemoteId(nt.callId,nt.calleeId):yt?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,yt):this.findCallWithCallIdAndRemoteId(nt.callId,nt.callerId),cn.trace("msg.label :"+nt.label),cn.log("msg.candidate :"+nt.candidate),Ct!==null?Ct.started&&Ct.remoteDescriptionSetted?Ct.processCandidateMsg(nt):(cn.log("Call not started or remoteDescription is not yet setted"),Ct.incomingcandidatesQueue.push(nt)):yt&&(cn.debug("Call not found, Candidate message is not handled, storing candidate message in client"),this.clientIncomingCandidatesQueue[nt.callId+"-"+yt]!==null&&this.clientIncomingCandidatesQueue[nt.callId+"-"+yt]!==void 0||(this.clientIncomingCandidatesQueue[nt.callId+"-"+yt]=[],cn.debug("First candidate for this call, starting a timeout before candidate storage cleaning"),setTimeout(this.cleanStoredCallCandidate.bind(this),this.cleanStoredCallCandidateTimer,nt.callId,yt)),this.clientIncomingCandidatesQueue[nt.callId+"-"+yt].push(nt))},this.processUpdate=function(nt){cn.info("Update message on:"+nt.roomId);var Ct,yt=null;if((yt=nt.callerId===this.clientId?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,nt.data.instanceId):this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,nt.data.instanceId))!==null)if(nt.hasOwnProperty("sdpoffer")&&nt.sdpoffer.hasOwnProperty("sdp"))yt.setRemoteCallProfile(this.evalCallProfileWithSdp(nt.sdpoffer.sdp,"remote","receive"),!0),yt.updateOngoingTimeoutId=setTimeout(function(){delete yt.updateOngoingTimeoutId},Qn),this.checkDestCallTypeWithSDP(nt.sdpoffer.sdp,yt),cn.log("processUpdate : before setRemoteDescription"),Ct=new apiCC.myWebRTC_Adapter.RTCSessionDescription(nt.sdpoffer),this.setRemoteDescriptionProcess(yt,Ct),yt.doUpdateAnswer();else if((0,st.ki)(nt.data,"mesh","object")&&(nt.data.mesh.calleeCompositeUserId?nt.data.mesh.calleeCompositeUserId===this.compositeClientId:nt.data.mesh.calleeId===this.clientId)){cn.debug("mesh update from subscriber");var Pt={};nt.data.mediaType==="AUDIOONLY"?Pt.audioOnly=!0:nt.data.mediaType==="VIDEOONLY"&&(Pt.videoOnly=!0),this.updateCallConfigurationOnCall(nt.callId,Pt).then(function(){cn.debug("updateCallConfigurationOnCall OK")}).catch(function(Et){cn.error("updateCallConfigurationOnCall failed",Et)})}else cn.error("update without SDP offer");else this.myWebRTC_Event.createErrorEvent("Cannot find call to process Update","CALL_NOT_FOUND_ON_UPDATE")},this.process200Update=function(nt){cn.info("200 Update received from :"+nt.calleeId);var Ct,yt=null,Pt=null;if((yt=nt.callerId===this.clientId?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,nt.data.instanceId):this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,nt.data.instanceId))===null)return cn.info("Call not found on 200 Update"),void this.myWebRTC_Event.createErrorEvent("Cannot find call to process 200 Update","CALL_NOT_FOUND_ON_200UPDATE");yt.calleeId=nt.calleeId,Ct=this.mySDPManager.createGuideline(nt.sdpanswer.sdp),yt.setLocalCallProfile(this.evalCallProfileWithSdpGuideline(Ct,nt.sdpanswer.sdp,"remote","send"),!0),yt.setRemoteCallProfile(this.evalCallProfileWithSdpGuideline(Ct,nt.sdpanswer.sdp,"remote","receive"),!0),this.evaluateVideoCap(yt),!this.rtpSenderSetParamatersCapable&&yt.videoCap&&(Ct.video.bandwidth=yt.videoCap,nt.sdpanswer.sdp=Ct.generate()),cn.log("process200Update : before setRemoteDescription"),Pt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(nt.sdpanswer),this.videoBandwidth&&(cn.log("Modification of SDP to set remote video bandwidth"),Pt.sdp=this.mySDPManager.setVideoBandwidth(Pt.sdp,this.videoBandwidth)),this.setRemoteDescriptionProcess(yt,Pt),cn.log("msg.sdpanswer.sdp :",nt.sdpanswer.sdp),yt.addingUserMedia===!0&&(yt.addingUserMedia=!1),yt.updateUserMedia===!0&&(yt.updateUserMedia=!1),yt.updateCause&&(yt.updateCause=null)},this.processSlowLink=function(nt,Ct){for(var yt=this.callsTable.length,Pt=null;--yt>=0;)if(this.callsTable[yt].callId===nt){Pt=this.callsTable[yt];break}if(Pt!==null){var Et=null;Ct&&Ct.advice&&(Et=Ct.advice),this.myWebRTC_Event.createSlowLinkEvent(Pt.callId,Et)}},this.processAudioAmplitude=function(nt,Ct){Jn.createAudioAmplitudeEvent(nt.descriptor.audioAmplitude,Ct,nt.callId,nt.descriptor.streamID)},this.processDistantIceError=function(nt){nt.descriptor.iceState==="disconnected"?this.myWebRTC_Event.createErrorEvent("distant iceDisconnection detected","DISTANT_ICE_CONNECTION_STATE_DISCONNECTED",null,nt.roomId,null,nt.descriptor):nt.descriptor.iceState==="failed"&&Jn.createErrorEvent("distant iceConnection failed detected","DISTANT_ICE_CONNECTION_STATE_FAILED",null,nt.roomId,null,nt.descriptor)},this.processStreamTrackMuteChanged=function(nt,Ct,yt){for(var Pt=this.callsTable.length,Et=null,Ut=[],Ot={},Bt={};--Pt>=0;)if(this.callsTable[Pt].callId===nt){Et=this.callsTable[Pt];break}Et!==null&&(Ct==="audio"?(Et.isRemoteAudioMuted=yt,Ut.push("audioIsMuted"),Ot.available=Et.remoteCallProfile.audio,Ot.active=Et.remoteCallProfile.audioActive,Ot.muted=Et.isRemoteAudioMuted,Ot.silent=Et.isRemoteAudioSilent,Bt.available=Et.remoteCallProfile.video,Bt.active=Et.remoteCallProfile.videoActive,Bt.muted=Et.isRemoteVideoMuted,Bt.silent=Et.isRemoteVideoSilent):Ct==="video"&&(Et.isRemoteVideoMuted=yt,Ut.push("videoIsMuted"),Ot.available=Et.remoteCallProfile.audio,Ot.active=Et.remoteCallProfile.audioActive,Ot.muted=Et.isRemoteAudioMuted,Ot.silent=Et.isRemoteAudioSilent,Bt.available=Et.remoteCallProfile.video,Bt.active=Et.remoteCallProfile.videoActive,Bt.muted=Et.isRemoteVideoMuted,Bt.silent=Et.isRemoteVideoSilent),Ut.length>0&&this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Ut,Ot,Bt,Et.destCallType,Et.callId,"userAction"))},this.processStreamTrackStatusChanged=function(nt,Ct,yt){for(var Pt=this.callsTable.length,Et=null,Ut=[],Ot={},Bt={};--Pt>=0;)if(this.callsTable[Pt].callId===nt){Et=this.callsTable[Pt];break}Et!==null&&(Ct==="audio"?(Et.isRemoteAudioSilent=yt,Ut.push("audioIsSilent"),Ot.available=Et.remoteCallProfile.audio,Ot.active=Et.remoteCallProfile.audioActive,Ot.muted=Et.isRemoteAudioMuted,Ot.silent=Et.isRemoteAudioSilent,Bt.available=Et.remoteCallProfile.video,Bt.active=Et.remoteCallProfile.videoActive,Bt.muted=Et.isRemoteVideoMuted,Bt.silent=Et.isRemoteVideoSilent):Ct==="video"&&(Et.isRemoteVideoSilent=yt,Ut.push("videoIsSilent"),Ot.available=Et.remoteCallProfile.audio,Ot.active=Et.remoteCallProfile.audioActive,Ot.muted=Et.isRemoteAudioMuted,Ot.silent=Et.isRemoteAudioSilent,Bt.available=Et.remoteCallProfile.video,Bt.active=Et.remoteCallProfile.videoActive,Bt.muted=Et.isRemoteVideoMuted,Bt.silent=Et.isRemoteVideoSilent),Ut.length>0&&this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Ut,Ot,Bt,Et.destCallType,Et.callId,"userAction"))},this.processUpdateStream=function(nt,Ct,yt){for(var Pt=this.callsTable.length,Et=null;--Pt>=0;)if((0,st.ki)(this.callsTable[Pt].data,"mesh","object")&&this.callsTable[Pt].data.mesh.calleeCallId===nt||this.callsTable[Pt].callId===nt){Et=this.callsTable[Pt];break}if(!Et)return!1;var Ut=!1;return Ct==="audio"?yt==="inactive"?Et.callType==="media"&&(Et.callType="videoOnly",Et.updateUserMedia=!0,Et.updateCause="adaptation",Et.audioSdpDirection="inactive",Et.establishCall(),Ut=!0):Et.callType==="videoOnly"&&(Et.callType="media",Et.updateUserMedia=!0,Et.updateCause="adaptation",Et.audioSdpDirection=null,Et.establishCall(),Ut=!0):Ct==="video"&&(yt==="inactive"?Et.callType==="media"&&(this.evalOutgoingVideoBandwithCap(Et),Et.callType="audio",Et.updateUserMedia=!0,Et.updateCause="adaptation",Et.videoSdpDirection="inactive",Et.establishCall(),Ut=!0):Et.callType==="audio"&&(this.evalOutgoingVideoBandwithCap(Et),Et.callType="media",Et.updateUserMedia=!0,Et.updateCause="adaptation",Et.videoSdpDirection=null,Et.establishCall(),Ut=!0)),Ut},this.processUpdateVideoQuality=function(nt,Ct){cn.debug("processUpdateVideoQuality",nt,Ct);var yt=this.findCallWithCallId(nt);if(yt)if(yt.sessionMCU&&yt.sessionMCU.roomMode!=="mesh"){var Pt=apiCC.getUserMediaStream(yt.callConfiguration.userMediaStreamId);if(Pt){var Et=Pt.getVideoTrack();if(Et){var Ut={};Ct.width&&Ct.height&&(Ut.width=Ct.width,Ut.height=Ct.height),Ct.frameRate&&(Ut.frameRate=Ct.frameRate),Et.applyConstraints(Ut).then(function(Ot){cn.debug("processUpdateVideoQuality - applyConstraints; OK")}).catch(function(Ot){cn.error("processUpdateVideoQuality - applyConstraints",Ot)})}else cn.warn("processUpdateVideoQuality - no such video track; callId:",nt)}else cn.warn("processUpdateVideoQuality - no such userMediaStream; callId:",nt)}else cn.warn("processUpdateVideoQuality - wrong roomMode; callId:",nt);else cn.warn("processUpdateVideoQuality - no such call; callId:",nt)},this.removeAllCallsFromRoom=function(nt,Ct){cn.info("removeAllCallsFromRoom :"+nt+" with reason :"+Ct);var yt,Pt,Et=this.callsTable.length,Ut=[],Ot={};for(yt=0;yt<Et;yt+=1)this.callsTable[yt].dest_roomId==nt&&(cn.log("Call is attached to the room, removing ..."),Ot={callId:this.callsTable[yt].callId},Ut.push(Ot));for(Pt=0;Pt<Ut.length;Pt+=1)this.removeCallFromTableWithCallIdAndSendBye(Ut[Pt].callId,Ct);Ut.splice(0,Ut.length)},this.onHangup=function(nt,Ct){var yt=null,Pt=null,Et=null,Ut=null,Ot=[],Bt=!1,Qt=!1,en=null,Jt=null;if(nt?typeof nt!="string"&&(nt=String(nt)):nt=null,Ct?typeof Ct!="string"&&(Ct=null):Ct=null,cn.info("Hanging up."),nt===null)cn.log("Leaving all calls that are established"),this.MCUClient&&this.MCUClient.meshOnHangup(),this.removeAllCalls(),this.callControlTable.splice(0,this.callControlTable.length);else if((Pt=this.findUserMediaById(nt))!==null){for(this.MCUClient.pubConnector!=="janusConnector"||Ct!=="RTC_Setup_Timeout"&&Ct!=="disconnected"||(Et=Pt.getUserMediaStream())&&Et.stream&&(Bt=!0,en=Et.stream,Pt.streamStolen=!0,Pt.sessionMCU.roomMode==="mesh"?Qt=!0:(Jt=Et.getCallInfo(Pt.userMediaId))&&(Jt.flavor="call")),Ut=this.callsTable.length;--Ut>=0;)(0,st.Ym)(this.callsTable[Ut].data,"object")&&(0,st.Ym)(this.callsTable[Ut].data.mesh,"object")&&this.callsTable[Ut].data.mesh.calleeCallId===nt&&Ot.push(this.callsTable[Ut].callId);for(Ut=Ot.length;--Ut>=0;)this.removeCallFromTableWithCallIdAndSendBye(Ot[Ut],Ct);this.MCUClient.meshOnHangup(nt,null,{restart:Bt})}else(yt=this.findCallWithCallId(nt))!==null&&(this.MCUClient.pubConnector!=="janusConnector"||Ct!=="RTC_Setup_Timeout"&&Ct!=="disconnected"||(yt.settingUpType==="publish"||yt.settingUpType==="shareScreen"?yt.data&&yt.data.mesh||(Bt=!0,yt.streamStolen=!0):yt.settingUpType==="subscribe"&&(Bt=!0)),cn.log("Leaving call with callId :"+nt),this.removeCallFromTableWithCallIdAndSendBye(nt,Ct));Bt===!0?yt!==null?this.restartCall(yt):Pt&&(Qt===!0?this.restartCall(Pt,{userMedia:!0,mesh:!0}):this.restartCall(Pt,{userMedia:!0,stream:en})):(yt&&yt.callControl&&this.destroyCallControl(yt.callControl),this.stopMaxCallRetriesTimer(nt),this.stopRestartCallTimer(nt),delete this.callsRetriesTable[nt])},this.stopStream=function(nt){cn.info("stopStream in client");var Ct,yt=null;if(ot.Xh==="Chrome"&&ot.PR<45||ot.Xh==="Firefox"&&ot.PR<44||ot.Xh==="Opera"&&ot.PR<34||ot.Xh==="Chromium"&&ot.PR<44||ot.Xh==="Chrome WebView"&&ot.PR<45)nt.onended=null,nt.stop();else{for(nt.onended=null,cn.log("MediaStream.stop is now deprecated, using MediaStreamTrack.stop"),yt=nt.getTracks(),Ct=0;Ct<yt.length;Ct+=1)yt[Ct].onended=null,yt[Ct].stop();cn.log("... tracks stopped")}nt=null},this.clearCallTimeouts=function(nt){var Ct;for(cn.debug("clearCallTimeouts"),nt.send200OKTrickleIceFalseTimeOutId!==0&&(cn.debug("clearing send200OKTrickleIceFalseTimeOutId"),clearTimeout(nt.send200OKTrickleIceFalseTimeOutId),nt.send200OKTrickleIceFalseTimeOutId=0),nt.sendInviteTrickleIceFalseTimeOutId!==0&&(cn.debug("clearing sendInviteTrickleIceFalseTimeOutId"),clearTimeout(nt.sendInviteTrickleIceFalseTimeOutId),nt.sendInviteTrickleIceFalseTimeOutId=0),nt.disconnectionTimeoutId!==0&&(cn.debug("clearing disconnectionTimeout"),clearTimeout(nt.disconnectionTimeoutId),nt.disconnectionTimeoutId=0),nt.disconnectionWarningInterval!==0&&(cn.debug("clearing disconnectionWarningInterval"),clearInterval(nt.disconnectionWarningInterval),nt.disconnectionWarningInterval=0),Ct=0;Ct<nt.checkCandidateTypesTimeoutTable.length;Ct+=1)cn.debug("clearing checkCandidateTypesTimeout :",nt.checkCandidateTypesTimeoutTable[Ct]),clearTimeout(nt.checkCandidateTypesTimeoutTable[Ct]);nt.checkCandidateTypesTimeoutTable.splice(0,nt.checkCandidateTypesTimeoutTable.length)},this.removeAllCalls=function(){cn.info("removeAllCalls");var nt,Ct=this.callsTable.length,yt=0,Pt=null,Et=0,Ut=null;for(cn.log("callsNumber = "+Ct),nt=0;nt<Ct;nt+=1){if(yt=this.callsTable[nt-Et].callee?this.callsTable[nt-Et].callerId:this.callsTable[nt-Et].calleeId,this.callsTable[nt-Et].callee===!0)Pt="Hangup_From_Callee",this.callsTable[nt-Et].myWebRTC_Stack.sendBye(this.callsTable[nt-Et].callId,this.clientId,this.callsTable[nt-Et].dest_roomId,yt,Pt,this.callsTable[nt-Et].data);else{if(Pt="Hangup_From_Caller",this.callsTable[nt-Et].inviteSended!==!0){this.callsTable[nt-Et].callCancelled=!0,cn.warn("Leaving call iteration on removeAllCalls");continue}this.callsTable[nt-Et].myWebRTC_Stack.sendBye(this.callsTable[nt-Et].callId,this.clientId,this.callsTable[nt-Et].dest_roomId,yt,Pt,this.callsTable[nt-Et].data)}(0,st.ki)(this.callsTable[nt-Et].sessionMCU,"roomName","string")&&(0,st.ki)(this.callsTable[nt-Et].data,"MCUType","string")&&(this.callsTable[nt-Et].data.MCUType==="MCU-Caller"||this.callsTable[nt-Et].data.MCUType==="MCU-Callee")&&this.MCUClient.leaveSession(this.callsTable[nt-Et].sessionMCU.roomName,{noHangup:!0}),this.callsTable[nt-Et].callConfiguration&&this.callsTable[nt-Et].callConfiguration.userMediaStreamId&&(Ut=apiCC.getUserMediaStream(this.callsTable[nt-Et].callConfiguration.userMediaStreamId))&&apiCC.releaseUserMediaStream(Ut.userMediaStreamId,this.callsTable[nt-Et].callId),this.callsTable[nt-Et].screenStream!==null&&(cn.log("stopping screenStream"),this.stopStream(this.callsTable[nt-Et].screenStream),Jn.createUserMediaStopEvent(this.callsTable[nt-Et].callId,"screen")),this.callsTable[nt-Et].pc!==null&&(cn.log("Closing PC"),this.qosEnable&&this.callsTable[nt-Et].qm!==void 0&&this.callsTable[nt-Et].qm!==null&&typeof this.callsTable[nt-Et].qm.saveStatsToDb=="function"&&(this.callsTable[nt-Et].qm.saveStatsToDb(!0),clearInterval(this.callsTable[nt-Et].statisticId)),this.callsTable[nt-Et].csmIntervalId&&clearInterval(this.callsTable[nt-Et].csmIntervalId),this.callsTable[nt-Et].pc.close(),this.callsTable[nt-Et].pc=null),this.myWebRTC_Event.createHangupEvent("local",this.clientId,this.callsTable[nt-Et].remoteId,!0,Pt,this.callsTable[nt-Et].callId,this.callsTable[nt-Et].callType),this.callsTable[nt-Et].data!==void 0&&this.callsTable[nt-Et].data!==null&&(this.callsTable[nt-Et].data.pubSub==="janusConnector"||this.callsTable[nt-Et].data.MCUType!=="MCU-Caller"&&this.callsTable[nt-Et].data.MCUType!=="MCU-Callee"||this.myWebRTC_Event.createRecordedStreamsAvailableEvent(this.callsTable[nt-Et].data.confId,this.callsTable[nt-Et].callerId,this.callsTable[nt-Et].calleeId,this.callsTable[nt-Et].callId)),this.clearCallTimeouts(this.callsTable[nt-Et]),this.callsTable[nt-Et].incomingcandidatesQueue.length!==0&&this.callsTable[nt-Et].incomingcandidatesQueue.splice(0,this.callsTable[nt-Et].incomingcandidatesQueue.length),this.clientIncomingCandidatesQueue[this.callsTable[nt-Et].callId+"-"+this.callsTable[nt-Et].instanceId]!==void 0&&this.clientIncomingCandidatesQueue[this.callsTable[nt-Et].callId+"-"+this.callsTable[nt-Et].instanceId].length!==0&&this.clientIncomingCandidatesQueue[this.callsTable[nt-Et].callId+"-"+this.callsTable[nt-Et].instanceId].splice(0,this.clientIncomingCandidatesQueue[this.callsTable[nt-Et].callId+"-"+this.callsTable[nt-Et].instanceId].length),cn.log("Removing call from table"),this.callsTable.splice(nt-Et,1),Et+=1}},this.onRemoteHangup=function(nt,Ct,yt,Pt,Et,Ut){var Ot=this;cn.debug("onRemoteHangup");var Bt=null,Qt=null,en=null,Jt=null,an=!1,hn=!1,rn=!1,dn=null,Sn=null;if(cn.log("callId :"+nt),cn.log("confId :"+Et),this.MCUClient.pubConnector==="janusConnector")if(Pt==="RTC_Setup_Timeout"||Pt==="Broken_by_MCU"||Pt==="disconnected")if((Qt=Ut==null?this.findCallWithCallId(nt):this.findCallWithCallIdAndInstanceId(nt,Ut.instanceId))!=null){if(Qt.setupTimeoutId&&(clearTimeout(Qt.setupTimeoutId),delete Qt.setupTimeoutId),Qt.restarting===!0)return void cn.debug("call restarting");if(Qt.settingUpType==="publish"||Qt.settingUpType==="shareScreen"?Qt.data&&Qt.data.mesh||(an=!0,Qt.streamStolen=!0):Qt.settingUpType==="subscribe"&&(an=!0),Qt.sessionMCU!==null&&Qt.sessionMCU.modeChangeKind==="old")return void cn.debug("onRemoteHangup ignore")}else(en=this.findUserMediaById(nt))!==null?(en.close(),(Jt=en.getUserMediaStream())&&Jt.stream&&(en.sessionMCU!==null&&en.sessionMCU.modeChangeKind==="old"?(an=!0,dn=Jt.stream,en.streamStolen=!0,en.distantCalls.length>0&&(rn=!0),(Sn=Jt.getCallInfo(en.userMediaId))&&(Sn.flavor="call")):en.sessionMCU!==null&&en.sessionMCU.roomMode==="mesh"?(an=!0,hn=!0,dn=Jt.stream,en.streamStolen=!0):(an=!0,dn=Jt.stream,en.streamStolen=!0,(Sn=Jt.getCallInfo(en.userMediaId))&&(Sn.flavor="call")))):cn.debug("No call and no userMedia found");else(Qt=Ut==null?this.findCallWithCallId(nt):this.findCallWithCallIdAndInstanceId(nt,Ut.instanceId))?(Qt.setupTimeoutId&&(clearTimeout(Qt.setupTimeoutId),delete Qt.setupTimeoutId),Qt.settingUpType==="subscribe"&&Pt!=="Ejected"&&(an=!0)):(en=this.findUserMediaById(nt))&&en.close();if(!rn)if(en!==null){var wn=null,An=[];for(wn=this.callsTable.length;--wn>=0;)(0,st.ki)(this.callsTable[wn].data,"mesh","object")&&this.callsTable[wn].data.mesh.calleeCallId===nt&&this.callsTable[wn].settingUpType!=="subscribe"&&An.push(this.callsTable[wn].callId);for(wn=An.length;--wn>=0;)this.removeCallFromTableWithCallIdAndSendBye(An[wn],Pt);if(this.MCUClient.meshOnHangup(nt),en.sessionMCU.modeChangeKind==="old"){var _n=this.MCUClient.getSessionMCU(null,{callback:function(jn){return jn.roomName===en.sessionMCU.roomName&&jn.modeChangeKind==="new"}});_n&&this.finalizeMeshToJanusTransition(en.sessionMCU,_n)}}else nt!==void 0?Bt=Ut==null?this.removeCallFromTableWithCallIdandRemoteId(nt,Ct,Pt):this.removeCallFromTableWithCallIdandInstanceId(nt,Ut.instanceId,Pt):Et!==void 0&&(Bt=this.removeCallFromTableWithConfIdandRemoteId(Et,Ct,Pt));cn.log("Reason : "+Pt),Qt&&an!==!0?this.callsTable.length===0&&this.userMediaTable.length===0?(cn.log("No more established calls for client"),this.myWebRTC_Event.createRemoteHangupEvent(this.clientId,Ct,!0,Pt),this.myWebRTC_Event.createHangupEvent("remote",this.clientId,Ct,!0,Pt,nt,Bt),this.getUserMediaOnGoing===!0&&Gt.deactivateReloadOnCancel!==!0&&(cn.log("Cancel from Remote"),typeof apiRTC_React>"u"&&location.reload(),this.getUserMediaOnGoing=!1)):(cn.log("Other calls are still established"),this.myWebRTC_Event.createRemoteHangupEvent(this.clientId,Ct,!1,Pt),this.myWebRTC_Event.createHangupEvent("remote",this.clientId,Ct,!1,Pt,nt,Bt)):Qt&&Qt.settingUpType==="subscribe"&&(this.myWebRTC_Event.createRemoteHangupEvent(this.clientId,Ct,!1,"restarted"),this.myWebRTC_Event.createHangupEvent("remote",this.clientId,Ct,!1,"restarted",nt,Bt)),Ut!=null&&(this.MCUClient.pubConnector==="janusConnector"||Ut.MCUType!=="MCU-Caller"&&Ut.MCUType!=="MCU-Callee"||this.myWebRTC_Event.createRecordedStreamsAvailableEvent(Et,this.clientId,Ct,nt)),an===!0?Qt!==null?this.restartCall(Qt):en&&(hn===!0?this.restartCall(en,{userMedia:!0,mesh:!0}):this.randomDelayOnRestart?(cn.debug("onRemoteHangup - randomDelayOnRestart"),setTimeout(function(){Ot.restartCall(en,{userMedia:!0,stream:dn})},5e3*Math.random())):this.restartCall(en,{userMedia:!0,stream:dn})):(Qt&&Qt.callControl&&this.destroyCallControl(Qt.callControl),(Qt||en)&&(this.stopMaxCallRetriesTimer(nt),this.stopRestartCallTimer(nt),delete this.callsRetriesTable[nt]))},this.startMaxCallRetriesTimer=function(nt){var Ct=this;cn.debug("startMaxCallRetriesTimer for callIdWhenStartingTimer :",nt);var yt=setTimeout(function(){cn.debug("[restartCall] MaxCallRetriesTimer reached for callIdWhenStartingTimer :",nt),Ct.callsRetriesTable[nt].allowedStatus=!1,delete Ct.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId},this.maxCallsRetriesDuration);this.callsRetriesTable[nt]={},this.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId=yt},this.stopMaxCallRetriesTimer=function(nt){cn.debug("stopMaxCallRetriesTimer for callId :",nt),this.callsRetriesTable[nt]!==void 0&&this.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId!==void 0&&(clearTimeout(this.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId),cn.debug("[restartCall] MaxCallRetriesTimer cleared for callId :",nt),delete this.callsRetriesTable[nt])},this.stopRestartCallTimer=function(nt){cn.debug("stopRestartCallTimer for callId :",nt),this.callsRetriesTable[nt]!==void 0&&this.callsRetriesTable[nt].restartCallTimeOutId!==void 0&&(clearTimeout(this.callsRetriesTable[nt].restartCallTimeOutId),cn.error("[restartCall] RestartCallTimer cleared for callId :",nt),delete this.callsRetriesTable[nt].restartCallTimeOutId)},this.restartCall=function(nt){var Ct=this,yt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cn.debug("[restartCall] restartCall for callId :",nt.callId);var Pt=-1;if(yt.userMedia!==!0)if(nt.callControl&&nt.callControl.autoRestart)if((Pt=nt.callControl.autoRestart.counter)===0&&(nt.callControl.autoRestart.callIdWhenStartingTimer=nt.callId,this.startMaxCallRetriesTimer(nt.callId)),this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer]!==void 0&&this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].allowedStatus===void 0){cn.debug("[restartCall] ... for callIdWhenStartingTimer :",nt.callControl.autoRestart.callIdWhenStartingTimer),cn.debug("AutoRestartCounter :",Pt),cn.debug("Calling restartCallProcess in :",this.restartCallDelay*Math.pow(2,Pt));var Et=setTimeout(function(){cn.debug("Timer reached for restartCall"),delete nt.callControl.autoRestart.pending,Ct.restartCallProcess(nt,yt),Ct.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer]!==void 0&&Ct.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].restartCallTimeOutId!==void 0&&delete Ct.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].restartCallTimeOutId},this.restartCallDelay*Math.pow(2,Pt));nt.callControl.autoRestart.pending=!0,this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].restartCallTimeOutId=Et}else cn.warn("CALL_ABORTED, retries not allowed (maxCallsRetriesDuration reached) for callIdWhenStartingTimer :",nt.callControl.autoRestart.callIdWhenStartingTimer),this.destroyCallControl(nt.callControl),Jn.createErrorEvent("call aborted after calls retries (maxCallsRetriesDuration reached)","CALL_ABORTED",nt.callId,nt.callControl.roomName),this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer]!==void 0&&delete this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer];else cn.debug("[restartCall] autoRestart options not defined");else this.restartCallProcess(nt,yt)},this.restartCallProcess=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cn.debug("restartCallProcess ");var yt=!1,Pt=!1,Et=null;if(nt.restarting!==!0){if(nt.restarting=!0,Ct.userMedia===!0&&(yt=!0),Ct.mesh===!0&&(Pt=!0),yt===!0)if(Pt===!0)nt.callType==="screenSharing"||nt.callType==="screenSharingWithAudio"?(nt.restarting=!1,this.userMediaTable.push(nt),this.MCUClient.meshOnScreenMediaSuccess(nt)):(nt.restarting=!1,this.userMediaTable.push(nt),this.MCUClient.meshOnUserMediaSuccess(nt));else if(nt.callType==="screenSharing"||nt.callType==="screenSharingWithAudio"){delete nt.data.meshPublish,nt.data.type="publish";var Ut=this.createCallControl({type:"shareScreen",callId:nt.userMediaId,roomName:nt.roomId,callConfiguration:nt.callConfiguration,data:nt.data});Ut.captureSourceType=nt.captureSourceType,Ut.autoRestart.counter=0,Ut.autoRestart.stream=Ct.stream,this.shareScreen(nt.roomId,nt.data,nt.captureSourceType,nt.callConfiguration,{callControl:Ut}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,nt.userMediaId,nt.userMediaId,"publish",this.clientId,nt.roomId,nt.roomId,null)}else{delete nt.data.meshPublish;var Ot=this.createCallControl({type:"publish",callId:nt.userMediaId,callType:nt.callType,roomName:nt.roomId,callConfiguration:nt.callConfiguration,data:nt.data});Ot.audioOnly=nt.callType==="audio",Ot.sessionId=nt.sessionId,Ot.token=nt.token,Ot.autoRestart.counter=0,Ot.autoRestart.stream=Ct.stream,this.MCUClient.publish(nt.roomId,nt.sessionId,nt.token,nt.callConfiguration,nt.data,{callControl:Ot}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.callType==="audio",nt.userMediaId,nt.userMediaId,"publish",this.clientId,nt.roomId,nt.roomId,null)}else if(nt.settingUpType==="publish")(0,st.Ym)(nt.callControl,"object")?(cn.debug("[restartCall] restarting call publish"),this.MCUClient.publish(nt.callControl.roomName,nt.callControl.sessionId,nt.callControl.token,nt.callControl.callConfiguration,nt.callControl.data,{callControl:nt.callControl}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,nt.callId,nt.callId,"publish",this.clientId,nt.callControl.roomName,nt.callControl.roomName,null)):cn.warn("[restartCall] cannot auto restart; missing info");else if(nt.settingUpType==="shareScreen")(0,st.Ym)(nt.callControl,"object")?(cn.debug("[restartCall] restarting call shareScreen"),this.shareScreen(nt.callControl.roomName,nt.callControl.data,nt.callControl.captureSourceType,nt.callControl.callConfiguration,{callControl:nt.callControl}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,nt.callId,nt.callId,"publish",this.clientId,nt.callControl.roomName,nt.callControl.roomName,null)):cn.warn("[restartCall] cannot auto restart; missing info");else if(nt.settingUpType==="subscribe"&&(cn.debug("[restartCall] restarting call subscribe"),Et=nt.mcuRemoteStream.replay===!0?this.MCUClient.getStreamOfUserCall(nt.mcuRemoteStream.attributes.callerId,nt.mcuRemoteStream.attributes.callId,{replay:!0}):this.MCUClient.getStreamOfUserCall(nt.mcuRemoteStream.attributes.callerId,nt.mcuRemoteStream.attributes.callId),(0,st.Ym)(nt.callControl,"object")&&Et)){cn.debug("[restartCall] stream exists, subscribing to it");var Bt=!!nt.callControl.autoRestart.force;delete nt.callControl.autoRestart.force;var Qt=nt.callControl.callId,en=this.MCUClient.subscribeToStreams([Et],nt.callControl.mediaType,nt.callControl.data,nt.callControl.callConfiguration,{noStreamCheck:!0,autoSub:!0,force:Bt});Qt&&en[0]&&this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,Qt,en[0],"subscribe",this.clientId,nt.callControl.roomName,nt.callControl.roomName,Et.id)}}else cn.debug("[restartCall] call already restarting")},this.closingCallProcess=function(nt,Ct){cn.log("Session terminated.");var yt=null;(0,st.ki)(this.callsTable[nt].sessionMCU,"roomName","string")&&(0,st.ki)(this.callsTable[nt].data,"MCUType","string")&&(this.callsTable[nt].data.MCUType==="MCU-Caller"||this.callsTable[nt].data.MCUType==="MCU-Callee")&&this.MCUClient.leaveSession(this.callsTable[nt].sessionMCU.roomName),this.callsTable[nt].callConfiguration&&this.callsTable[nt].callConfiguration.userMediaStreamId&&this.callsTable[nt].streamStolen!==!0&&(yt=apiCC.getUserMediaStream(this.callsTable[nt].callConfiguration.userMediaStreamId))&&apiCC.releaseUserMediaStream(yt.userMediaStreamId,this.callsTable[nt].callId),this.callsTable[nt].screenStream!==null&&(cn.log("stopping screenStream"),this.stopStream(this.callsTable[nt].screenStream),Jn.createUserMediaStopEvent(this.callsTable[nt].callId,"screen")),this.callsTable[nt].pc!==null&&(cn.log("Closing PC"),this.qosEnable&&this.callsTable[nt].qm!==void 0&&this.callsTable[nt].qm!==null&&typeof this.callsTable[nt].qm.saveStatsToDb=="function"&&(this.callsTable[nt].qm.saveStatsToDb(!0),clearInterval(this.callsTable[nt].statisticId)),this.callsTable[nt].csmIntervalId&&clearInterval(this.callsTable[nt].csmIntervalId),this.callsTable[nt].beginTimeoutId&&(clearTimeout(this.callsTable[nt].beginTimeoutId),delete this.callsTable[nt].beginTimeoutId),this.callsTable[nt].dcfs?Ct==="Ice_failed"?this.callsTable[nt].dcfs.failure="iceFailed":this.callsTable[nt].dcfs.canceled=!0:this.callsTable[nt].callType==="data"&&this.callsTable[nt].calleeId==="dataChannelConnector"&&(this.callsTable[nt].failure||this.callsTable[nt].success||setTimeout(function(Pt,Et){Jn.createEvent({eventType:"onFileSended",callId:Pt.callId,remoteId:Pt.remoteId,name:Pt.data.filename,error:Et}),Pt.callbacks&&Pt.callbacks.failure&&Pt.callbacks.failure(Et)},0,this.callsTable[nt],Ct==="Ice_failed"?"iceFailed":"canceled")),this.callsTable[nt].pc.close(),this.callsTable[nt].pc=null)},this.removeCallProcess=function(nt){var Ct=this,yt=this.callsTable[nt];this.clearCallTimeouts(yt),yt.incomingcandidatesQueue.length!==0&&yt.incomingcandidatesQueue.splice(0,yt.incomingcandidatesQueue.length),this.clientIncomingCandidatesQueue[yt.callId+"-"+yt.instanceId]!==void 0&&this.clientIncomingCandidatesQueue[yt.callId+"-"+yt.instanceId].length!==0&&this.clientIncomingCandidatesQueue[yt.callId+"-"+yt.instanceId].splice(0,this.clientIncomingCandidatesQueue[yt.callId+"-"+yt.instanceId].length),cn.log("Removing call from table"),this.callsTable.splice(nt,1),cn.log("this.callsTable.length :",this.callsTable.length),cn.log("Call is terminated"),setTimeout(function(){Ct.startNextPushData()}),this.evalOutgoingVideoBandwithCap()},this.removeCallFromTableWithCallIdAndSendBye=function(nt,Ct){cn.debug("removeCallFromTableWithCallIdAndSendBye()",nt);var yt,Pt=null;if((yt=this.findCallIndexWithCallId(nt))!==-1){if(this.closingCallProcess(yt,Ct),this.callsTable[yt].callId,this.callsTable[yt].calleeId,this.callsTable[yt].callee?(Pt=this.callsTable[yt].callerId,Ct===null&&(Ct="Hangup_From_Callee")):(Pt=this.callsTable[yt].calleeId,Ct===null&&(Ct="Hangup_From_Caller")),cn.log("reason is :"+Ct),this.callsTable[yt].calleeId!=="LOCAL"&&apiCC.session!==null){var Et=apiCC.session.getConnectedUserInfo(this.callsTable[yt].calleeId,"userData"),Ut=null;if(Et!=="User_Not_Found")try{Ut=JSON.parse(Et)}catch{cn.error("userInfo parse fail",Et)}Ut!=null&&Ut.isSimulated==="true"?apiCC.session.channel.socket.emit("simulatedAgentCancelCallRequest",{number:this.callsTable[yt].calleeId,callId:nt}):this.callsTable[yt].myWebRTC_Stack.sendBye(this.callsTable[yt].callId,this.clientId,this.callsTable[yt].dest_roomId,Pt,Ct,this.callsTable[yt].data)}Ct!=="Broken_by_MCU"&&this.myWebRTC_Event.createHangupEvent("local",this.clientId,this.callsTable[yt].remoteId,!0,Ct,this.callsTable[yt].callId,this.callsTable[yt].callType),this.callsTable[yt].data!==void 0&&this.callsTable[yt].data!==null&&(this.callsTable[yt].data.pubSub==="janusConnector"||this.callsTable[yt].data.MCUType!=="MCU-Caller"&&this.callsTable[yt].data.MCUType!=="MCU-Callee"||this.myWebRTC_Event.createRecordedStreamsAvailableEvent(this.callsTable[yt].data.confId,this.callsTable[yt].callerId,this.callsTable[yt].calleeId,this.callsTable[yt].callId)),this.removeCallProcess(yt)}else cn.log("No call removed");this.MCUClient.publishCallId===nt&&(this.publishCallId=null)},this.removeCall=function(nt){cn.info("removeCall");var Ct=null;return nt!==-1?(this.closingCallProcess(nt,null),this.callsTable[nt].disconnectionWarningTimeout!==0&&(cn.debug("clearing disconnectionWarningTimeout"),clearTimeout(this.callsTable[nt].disconnectionWarningTimeout),this.callsTable[nt].disconnectionWarningTimeout=0),Ct=this.callsTable[nt].callType,this.removeCallProcess(nt)):cn.debug("No call removed"),Ct},this.removeCallFromTableWithConfIdandRemoteId=function(nt,Ct,yt){var Pt;return cn.debug("removeCallFromTableWithConfIdandRemoteId() with reason :"+yt),yt=null,Pt=this.findCallIndexWithConfIdAndRemoteId(nt,Ct),this.removeCall(Pt)},this.removeCallFromTableWithCallIdandRemoteId=function(nt,Ct,yt){var Pt;return cn.debug("removeCallFromTableWithCallIdandRemoteId() with reason :"+yt),cn.log("callId :"+nt),cn.log("remoteId :"+Ct),yt=null,Pt=this.findCallIndexWithCallIdAndRemoteId(nt,Ct),this.removeCall(Pt)},this.removeCallFromTableWithCallIdandInstanceId=function(nt,Ct,yt){var Pt;return cn.debug("removeCallFromTableWithCallIdandInstanceId() with reason :"+yt),cn.log("callId :"+nt),cn.log("instanceId :"+Ct),yt=null,Pt=this.findCallIndexWithCallIdAndInstanceId(nt,Ct),this.removeCall(Pt)},this.toggleVideoMute=function(nt){cn.debug("toggleVideoMute");var Ct,yt,Pt=this.callsTable.length,Et=null,Ut=null;if(nt==null){for(cn.debug("no callId defined, toggleVideoMute all local video"),this.isVideoMuted?this.localStream!==null&&(cn.debug("localStream unMuteTracks"),this.unMuteTracks(this.localStream.getVideoTracks())):this.localStream!==null&&(cn.debug("localStream muteTracks"),this.muteTracks(this.localStream.getVideoTracks())),this.isVideoMuted=!this.isVideoMuted,Ct=0;Ct<Pt;Ct+=1)this.callsTable[Ct].data&&this.callsTable[Ct].data.mesh||(Ut=null,this.callsTable[Ct].callConfiguration&&(Ut=apiCC.getUserMediaStream(this.callsTable[Ct].callConfiguration.userMediaStreamId)),Ut?Ut.videoMuted?Ut.unMuteVideoOnStreams("enabled"):Ut.muteVideoOnStreams("enabled"):this.callsTable[Ct].callLocalStream!==null&&(this.callsTable[Ct].isLocalVideoMuted?(cn.debug("unmuting call :",this.callsTable[Ct].callId),this.unMuteTracks(this.callsTable[Ct].callLocalStream.getVideoTracks())):(cn.debug("muting call :",this.callsTable[Ct].callId),this.muteTracks(this.callsTable[Ct].callLocalStream.getVideoTracks())),this.callsTable[Ct].isLocalVideoMuted=!this.callsTable[Ct].isLocalVideoMuted));for(Pt=this.userMediaTable.length,Ct=0;Ct<Pt;Ct+=1)Ut=null,this.userMediaTable[Ct].callConfiguration&&(Ut=apiCC.getUserMediaStream(this.userMediaTable[Ct].callConfiguration.userMediaStreamId)),Ut&&(Ut.videoMuted?Ut.unMuteVideoOnStreams("enabled"):Ut.muteVideoOnStreams("enabled"));return{muteState:this.isVideoMuted,callId:"ALL"}}return cn.debug("callId is defined :",nt),(yt=this.findCallIndexWithCallId(nt))>=0?(this.callsTable[yt].callConfiguration&&(Ut=apiCC.getUserMediaStream(this.callsTable[yt].callConfiguration.userMediaStreamId)),Ut?(Ut.videoMuted?Ut.unMuteVideoOnStreams("enabled"):Ut.muteVideoOnStreams("enabled"),{muteState:Ut.videoMuted,callId:nt}):this.callsTable[yt].callLocalStream!==null?(this.callsTable[yt].isLocalVideoMuted?(cn.debug("unmuting call :",this.callsTable[yt].callId),this.unMuteTracks(this.callsTable[yt].callLocalStream.getVideoTracks())):(cn.debug("muting call :",this.callsTable[yt].callId),this.muteTracks(this.callsTable[yt].callLocalStream.getVideoTracks())),this.callsTable[yt].isLocalVideoMuted=!this.callsTable[yt].isLocalVideoMuted,{muteState:this.callsTable[yt].isLocalVideoMuted,callId:nt}):{muteState:"STREAM_NOT_FOUND",callId:nt}):(Et=this.findUserMediaById(nt))&&(Et.callConfiguration&&(Ut=apiCC.getUserMediaStream(Et.callConfiguration.userMediaStreamId)),Ut)?(Ut.videoMuted?Ut.unMuteVideoOnStreams("enabled"):Ut.muteVideoOnStreams("enabled"),{muteState:Ut.videoMuted,callId:nt}):{muteState:"CALL_NOT_FOUND",callId:nt}},this.unMuteTracks=function(nt){var Ct;if(nt.length!==0){for(Ct=0;Ct<nt.length;Ct+=1)nt[Ct].enabled=!0;cn.log("tracks unMuted.")}else cn.log("No tracks available.")},this.muteTracks=function(nt){var Ct;if(nt.length!==0){for(Ct=0;Ct<nt.length;Ct+=1)nt[Ct].enabled=!1;cn.log("tracks muted.")}else cn.log("No tracks available.")},this.toggleAudioMute=function(nt){cn.debug("toggleAudioMute");var Ct,yt,Pt=this.callsTable.length,Et=null,Ut=null;if(nt==null){for(cn.debug("no callId defined, toggleAudioMute all local audio"),this.isAudioMuted?this.localStream!==null&&(cn.debug("localStream unMuteTracks"),this.unMuteTracks(this.localStream.getAudioTracks())):this.localStream!==null&&(cn.debug("localStream muteTracks"),this.muteTracks(this.localStream.getAudioTracks())),this.isAudioMuted=!this.isAudioMuted,Ct=0;Ct<Pt;Ct+=1)this.callsTable[Ct].data&&this.callsTable[Ct].data.mesh||(Ut=null,this.callsTable[Ct].callConfiguration&&(Ut=apiCC.getUserMediaStream(this.callsTable[Ct].callConfiguration.userMediaStreamId)),Ut?Ut.audioMuted?Ut.unMuteAudioOnStreams("enabled"):Ut.muteAudioOnStreams("enabled"):this.callsTable[Ct].callLocalStream!==null&&(this.callsTable[Ct].isLocalAudioMuted?(cn.debug("unmuting call :",this.callsTable[Ct].callId),this.unMuteTracks(this.callsTable[Ct].callLocalStream.getAudioTracks())):(cn.debug("muting call :",this.callsTable[Ct].callId),this.muteTracks(this.callsTable[Ct].callLocalStream.getAudioTracks())),this.callsTable[Ct].isLocalAudioMuted=!this.callsTable[Ct].isLocalAudioMuted));for(Pt=this.userMediaTable.length,Ct=0;Ct<Pt;Ct+=1)Ut=null,this.userMediaTable[Ct].callConfiguration&&(Ut=apiCC.getUserMediaStream(this.userMediaTable[Ct].callConfiguration.userMediaStreamId)),Ut&&(Ut.audioMuted?Ut.unMuteAudioOnStreams("enabled"):Ut.muteAudioOnStreams("enabled"));return{muteState:this.isAudioMuted,callId:"ALL"}}return cn.debug("callId is defined :",nt),(yt=this.findCallIndexWithCallId(nt))>=0?(this.callsTable[yt].callConfiguration&&(Ut=apiCC.getUserMediaStream(this.callsTable[yt].callConfiguration.userMediaStreamId)),Ut?(Ut.audioMuted?Ut.unMuteAudioOnStreams("enabled"):Ut.muteAudioOnStreams("enabled"),{muteState:Ut.audioMuted,callId:nt}):this.callsTable[yt].callLocalStream!==null?(this.callsTable[yt].isLocalAudioMuted?(cn.debug("unmuting call :",this.callsTable[yt].callId),this.unMuteTracks(this.callsTable[yt].callLocalStream.getAudioTracks())):(cn.debug("muting call :",this.callsTable[yt].callId),this.muteTracks(this.callsTable[yt].callLocalStream.getAudioTracks())),this.callsTable[yt].isLocalAudioMuted=!this.callsTable[yt].isLocalAudioMuted,{muteState:this.callsTable[yt].isLocalAudioMuted,callId:nt}):{muteState:"STREAM_NOT_FOUND",callId:nt}):(Et=this.findUserMediaById(nt))&&(Et.callConfiguration&&(Ut=apiCC.getUserMediaStream(Et.callConfiguration.userMediaStreamId)),Ut)?(Ut.audioMuted?Ut.unMuteAudioOnStreams("enabled"):Ut.muteAudioOnStreams("enabled"),{muteState:Ut.audioMuted,callId:nt}):{muteState:"CALL_NOT_FOUND",callId:nt}},this.sendDTMF=function(nt,Ct,yt,Pt){cn.debug("sendDTMF");var Et=0;nt!=null?(cn.debug("callId is defined :",nt),Et=this.findCallIndexWithCallId(nt),cn.debug("index :",Et),Et>=0&&(cn.debug("index :",Et),this.callsTable[Et].sendTones(Ct,yt,Pt))):cn.debug("no callId defined, leaving sendDTMF")},this.xhr=function(nt,Ct,yt,Pt){var Et=new XMLHttpRequest;Et.onreadystatechange=function(){Et.readyState===4&&Et.status===200&&yt(Et.responseText)},Pt!==void 0&&(Et.upload.onprogress=Pt),Et.open("POST",nt),Et.send(Ct)},this.takeSnapshot=function(nt,Ct,yt,Pt,Et,Ut,Ot){var Bt=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{};cn.info("takeSnapshot");var Qt,en=null,Jt=null,an=document.createElement("canvas"),hn=null,rn=null,dn=new Date,Sn=dn.toJSON(),wn=Sn.replace(new RegExp(":","g"),"-"),An=null;switch(Pt){case"Desactivated":Qt=0;break;case"Low":Qt=2;break;case"Medium":Qt=4;break;case"High":Qt=6;break;default:cn.log("blurLevel not defined switch case : "+Pt),Qt=0}return Ot===void 0?(cn.warn("ApiRTC DEPRECATED : Please add videoId for TakeSnapshot"),cn.log("Leaving takeSnapshot"),void this.myWebRTC_Event.createErrorEvent("Deprecated - localVideo Div Name is not correct for takeSnapshot","INCORRECT_VIDEOID_FOR_SNAPSHOT")):(cn.log("takeSnapshot of defined video Id :"+Ot),(An=document.getElementById(Ot))===null?(cn.log("Cannot find video with Id :"+Ot),cn.log("Leaving takeSnapshot"),void this.myWebRTC_Event.createErrorEvent("localVideo Div Name is not correct for takeSnapshot","INCORRECT_VIDEOID_FOR_SNAPSHOT")):(an.width=An.videoWidth,an.height=An.videoHeight,Bt.hasOwnProperty("width")&&(cn.debug("options.width is set :"+Bt.width),an.width=Bt.width),Bt.hasOwnProperty("height")&&(cn.debug("options.height is set :"+Bt.height),an.height=Bt.height),cn.log("snapshot.width : "+an.width),cn.log("snapshot.height :"+an.height),(en=an.getContext("2d")).drawImage(An,0,0,an.width,an.height),(Jt=document.createElement("img")).src=an.toDataURL("image/png"),Jt.style.padding=5,Jt.width=an.width,Jt.height=an.height,Qt!==0?(cn.log("Adding Blur on Photo"),hn=en.getImageData(0,0,an.width,an.height),cn.log("av pixels data : "+hn.data),hn=Tt(Jt,hn,Qt),cn.log("ap pixels data : "+hn.data),en.putImageData(hn,0,0),Jt.src=an.toDataURL("image/png")):cn.log("blur on photo is desactivated"),tr(Ct)==="object"?Ct!==null?Ct.src=Jt.src:cn.log("localPhotoIdOrDiv is null"):document.getElementById(Ct)!==null?document.getElementById(Ct).src=Jt.src:cn.log("localPhotoId is not defined"),rn=new FormData,Et!==void 0?(cn.log("sessionId !== undefined :"+Et),rn.append("destFileName",this.clientId+"-"+wn+".png"),rn.append("data",an.toDataURL("image/png")),rn.append("sessionId",Et)):(cn.log("Upload on data1"),rn.append("photo",an.toDataURL("image/png")),rn.append("clientId",this.clientId),rn.append("apiKey",apiCC.session.apiKey)),void this.xhr(nt,rn,function(_n){if(cn.log("fileName :",_n),_n!==null)try{var jn=JSON.parse(_n);jn.resultCode==="OK"&&(cn.log("files loaded, filename :"+jn.fileUrl),Jn.createSnapShotPhotoUploaded(jn.fileUrl))}catch(ar){cn.log("Parsing error:",ar)}_n!=="Photo received"&&_n!=="An error occurred."&&_n.substring(0,6)!=="Photo-"||Jn.createSnapShotPhotoUploaded(_n)},Ut)))},this.takeSnapshotAndSendOnDataChannel=function(nt,Ct,yt,Pt){cn.info("takeSnapshotAndSendOnDataChannel");var Et,Ut=null,Ot=document.createElement("canvas"),Bt=null;if(Ct!==void 0){if(cn.log("takeSnapshot of defined video Id :"+Ct),(Bt=document.getElementById(Ct))===null)return cn.log("Cannot find video with Id :"+Ct),cn.log("Leaving takeSnapshot"),void this.myWebRTC_Event.createErrorEvent("localVideo Div Name is not correct for takeSnapshot","INCORRECT_VIDEOID_FOR_SNAPSHOT")}else cn.warn("ApiRTC DEPRECATED : Please add videoId for TakeSnapshot");Bt!=null&&(Ot.width=Bt.clientWidth,Ot.height=Bt.clientHeight),cn.log("snapshot.width : "+Ot.width),cn.log("snapshot.height :"+Ot.height),Ot.getContext("2d").drawImage(Bt,0,0,Ot.width,Ot.height),(Ut=document.createElement("img")).src=Ot.toDataURL("image/png"),Ut.style.padding=5,Ut.width=Ot.width,Ut.height=Ot.height,tr(nt)==="object"?nt!==null?nt.src=Ut.src:cn.log("localPhotoIdOrDiv is null"):document.getElementById(nt)!==null?document.getElementById(nt).src=Ut.src:cn.log("localPhotoId is not defined"),Et=Ot.toDataURL("image/png"),this.sendDataWithCallId(yt,{file:Et,name:"nomFichier",type:"image/png-dataUrl"},Pt)},this.callWithNumber=function(nt,Ct,yt,Pt){cn.info("Click on Call Button, video activated : "+Ct),cn.log("callConfiguration : ",Pt);var Et=null,Ut=0,Ot=null,Bt=null,Qt=null,en=null,Jt=null;if(typeof nt=="number"&&(cn.log("called number type is number, converting to string"),nt=nt.toString()),nt!==""&&nt!==this.clientId){if((Et=new Cn(this)).instanceId=apiCC.generateInstanceId(),cn.log("Calling destination number :"+nt),Pt==null||Pt.apzcallId===void 0||Pt.apzcallId===null?Et.generateCallId():Et.callId=Pt.apzcallId,apiCC.isSIPNumber(nt)===!0?(cn.log("Prefix 0 , + , or 'sip:' detected, calling a SIP device"),nt.toString().startsWith("sip:")===!0&&(nt=nt.toString().replace("sip:",""),cn.log("called SIP number is :",nt)),yt!=null?yt.pubSub="sipConnector":(yt={}).pubSub="sipConnector",Et.trickleIce=!1):cn.log("Establishing Web call"),Et.callerId=this.clientId,Et.calleeId=nt,Et.dest_roomId=nt,Et.audioOnly=!Ct,Et.remoteId=nt,Et.callConfiguration=Pt,Pt!=null?(Pt.mediaTypeForOutgoingCall==="VIDEO"||Pt.mediaTypeForOutgoingCall==="AUDIO"||Pt.mediaTypeForOutgoingCall==="VIDEOONLY"||Pt.mediaTypeForOutgoingCall==="NONE"?(cn.log("Setting mediaTypeForOutgoingCall :"+Pt.mediaTypeForOutgoingCall),Et.mediaTypeForOutgoingCall=Pt.mediaTypeForOutgoingCall):(cn.log("mediaTypeForOutgoingCall is not set"),Ct===!1&&(cn.log("videoActivated is false, setting mediaTypeForOutgoingCall to AUDIO"),Et.mediaTypeForOutgoingCall="AUDIO")),Pt.mediaRoutingMode!==void 0&&Pt.mediaRoutingMode!==null&&Et.setCallMediaRoutingMode(Pt.mediaRoutingMode),Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&Et.setCallTurnServer(Pt.turnServerAddress),Pt.preferVP9Codec!==!0&&Pt.preferVP9Codec!==!1||(Et.preferVP9Codec=Pt.preferVP9Codec),Pt.hasOwnProperty("forceCallType")&&(Et.callType=Pt.forceCallType,Et.callType!=="screenSharing"&&Et.callType!=="screenSharingWithAudio"||(Et.screenSharing=!0))):cn.log("callConfiguration is not set"),yt!==void 0&&yt.MCUType!==void 0&&(yt.MCUType!=="MCU-Caller"&&yt.MCUType!=="MCU-Callee"||(this.MCUClient.pubConnector==="janusConnector"&&ot.Xh==="Firefox"&&(ot.PR>43?Et.mediaConstraints={offerToReceiveAudio:!1,offerToReceiveVideo:!1}:Et.mediaConstraints={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}),yt.pubSub=this.MCUClient.pubConnector,yt.videoBandwidthSettings=this.videoBandwidthSettings,yt.pubSub==="groupKurentoConnector"&&(yt.pubSub="kurentoConnector"))),Et.checkDTLSCompliancy(),Ot=Et.callId,Bt=apiCC.session.getConnectedUserInfo(nt,"userData"),cn.log("userInfo :",Bt),Bt!=="User_Not_Found"&&Bt!==void 0&&(Qt=JSON.parse(Bt))!==void 0&&Qt.react==="true"&&(cn.log("userInfoJson.react :",JSON.stringify(Qt.react)),cn.log("userInfoJson.osName :",JSON.stringify(Qt.osName)),Qt.osName==="iOS"&&(cn.log("Callee : React and iOS detected, setting H264 as preferred codec for the call"),Et.preferH264Codec=!0)),Et.audioOnly===!0&&(Et.callType="audio"),yt!==void 0?Et.data=yt:yt={},yt.convId&&(yt.cloudConvId||(yt.cloudConvId=yt.convId),delete yt.convId),yt.dataCall===!0&&(Et.dataCall=!0),Et.data.instanceId=Et.instanceId,Ut=this.callsTable.push(Et),cn.log("Call Number is :"+Ut),Et.data&&Et.data.MCUType==="MCU-Caller"&&Et.mediaTypeForOutgoingCall==="NONE")return Et.inviteSended=!0,Et.myWebRTC_Stack.sendInvite(Et.callId,Et.callerId,this.nickname,Et.dest_roomId,Et.dest_roomId,"none",{offer:{type:"no-offer"},data:Et.data}),Et.callId;Et.data&&Et.data.MCUType==="MCU-Caller"&&(Et.settingUpType="publish",Et.callControl=this.createCallControl({type:"publish",callId:Et.callId,roomName:Et.data.confId,callConfiguration:Et.callConfiguration,data:Et.data}),Et.callControl.sessionId=Et.data.confId,Et.callControl.token=Et.data.confId,Et.callControl.autoRestart.counter=0,Et.setMediaConstraintsToSendOnlyOffer()),(0,st.ki)(Pt,"userMediaStreamId","string")&&(Jt=Pt.userMediaStreamId),Qt!=null&&Qt.isSimulated==="true"?apiCC.session.channel.socket.emit("simulatedAgentCallRequest",{number:nt,call:Et,videoActivated:Ct,data:yt,callConfiguration:{apzcallId:Et.callId}}):this.accessToLocalMedia===!0&&this.autoAnswer===!0||Et.dataCall||Jt?Et.dataCall?(cn.log("Datachannel call"),Et.establishCall()):(cn.log("callWithNumber :: User has already granted access to local media and AutoAnswer activated : establishing call"),Jt?((en=apiCC.getUserMediaStream(Jt)).addCallInfo(Et.callId),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=en.userMediaStreamId,Et.onUserMediaSuccessOnCall(en.stream)):Et.establishCall()):yt.MCUType==="MCU-Callee"&&this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("Stand-by :: wait for AcceptCall on recorded 1to1 call"):Et.getUserMediaOnCall()}else cn.log("Call Number is incorrect");return Ot},this.startTestCall=function(nt,Ct){cn.info("startTestCall : video activated : "+nt);var yt,Pt,Et=null,Ut=null,Ot={};return(Et=new Cn(this)).generateCallId(),Et.instanceId=apiCC.generateInstanceId(),Et.callerId=this.clientId,Et.calleeId=12345,Et.dest_roomId=12345,Et.audioOnly=!nt,Et.remoteId=12345,Et.callConfiguration=Ct,Ct!=null?(Ct.mediaTypeForOutgoingCall==="VIDEO"||Ct.mediaTypeForOutgoingCall==="AUDIO"||Ct.mediaTypeForOutgoingCall==="VIDEOONLY"||Ct.mediaTypeForOutgoingCall==="NONE"?(cn.log("Setting mediaTypeForOutgoingCall :"+Ct.mediaTypeForOutgoingCall),Et.mediaTypeForOutgoingCall=Ct.mediaTypeForOutgoingCall):cn.log("mediaTypeForOutgoingCall is not set"),Ct.mediaRoutingMode!==void 0&&Ct.mediaRoutingMode!==null&&Et.setCallMediaRoutingMode(Ct.mediaRoutingMode),Ct.turnServerAddress!==void 0&&Ct.turnServerAddress!==null&&Et.setCallTurnServer(Ct.turnServerAddress),Ct.preferVP9Codec!==!0&&Ct.preferVP9Codec!==!1||(Et.preferVP9Codec=Ct.preferVP9Codec)):(cn.log("callConfiguration is not set"),Ct={}),Et.checkDTLSCompliancy(),Pt=Et.callId,Ot.pubSub="testCallKurentoConnector",Et.data=Ot,Et.data.instanceId=Et.instanceId,Et.audioOnly===!0&&(Et.callType="audio"),yt=this.callsTable.push(Et),cn.log("Call Number is :"+yt),this.accessToLocalMedia===!0&&this.autoAnswer===!0||Et.dataCall||Ct.userMediaStreamId||apiCC.userMediaStreamTable.length>0?Et.dataCall?(cn.log("Datachannel call"),Et.establishCall()):(cn.log("startTestCall :: User has already granted access to local media and AutoAnswer activated : establishing call"),Ct.userMediaStreamId?((Ut=apiCC.getUserMediaStream(Ct.userMediaStreamId)).addCallInfo(Et.callId),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=Ut.userMediaStreamId,Et.callLocalStream=Ut.stream,Et.establishCall()):(apiCC.userMediaStreamTable.length>0&&((Ut=apiCC.userMediaStreamTable[0]).addCallInfo(Et.callId),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=Ut.userMediaStreamId,Et.callLocalStream=Ut.stream),Et.establishCall())):Et.getUserMediaOnCall(),Pt},this.extensionInstallationSuccessCallback=function(){cn.debug("extensionInstallationSuccessCallback"),apiCC.session.apiCCWebRTCClient.webRTCClient.apiRTCExtensionInstalled=!0},this.extensionInstallationFailureCallback=function(nt,Ct){cn.debug("extensionInstallationFailureCallback : Error :"+nt+", "+Ct),nt=null,Ct=null,Jn.createDesktopCaptureEvent("Extension_installation_Error",this.waitingShareScreenCallId,this.waitingShareScreenDestNumber,this.waitingCaptureSourceType)},this.manageNotInstalledExtension=function(nt,Ct,yt){cn.debug("manageNotInstalledExtension"),cn.warn("apiRTC extension not installed"),Jn.createDesktopCaptureEvent("Extension_not_installed",nt,Ct),cn.warn("Starting apiRTC extension installation"),this.waitingShareScreenDestNumber=Ct,this.waitingShareScreenCallId=nt,this.waitingCaptureSourceType=yt,chrome.webstore.install("https://chrome.google.com/webstore/detail/mjjnofoemoepfididplbfimokpnpcoeg",this.callback(this,"extensionInstallationSuccessCallback"),this.callback(this,"extensionInstallationFailureCallback"))},this.shareScreen=function(nt,Ct,yt,Pt,Et){cn.info("shareScreen");var Ut=null,Ot=null,Bt=null,Qt=null;if(apiCC.isScreenSharingCompliant()===!0)if(nt!==""&&nt!==this.clientId){if(Ct!==null&&tr(Ct)==="object"||(Ct={}),this.MCUClient.pubConnector==="janusConnector"&&!Ct.mesh&&Et&&Et.callControl&&Et.callControl.callId&&this.findCallWithCallId(Et.callControl.callId))return cn.debug("call already exists",Et.callControl.callId),Et.callControl.callId;if(Pt!==null&&tr(Pt)==="object"||(Pt={}),Pt.qos!==null&&tr(Pt.qos)==="object"?(Ct.qos={},Pt.qos.videoMinQuality==="excellent"?Ct.qos.videoMinQuality="excellent":Pt.qos.videoMinQuality==="good"?Ct.qos.videoMinQuality="good":Pt.qos.videoMinQuality==="medium"?Ct.qos.videoMinQuality="medium":(Pt.qos.videoMinQuality,Ct.qos.videoMinQuality="bad"),Pt.qos.videoForbidInactive===!0&&(Ct.qos.videoForbidInactive=!0)):Ct.qos={videoMinQuality:"bad"},["audioLabels","videoLabels"].forEach(function(Jt){(0,st.Ym)(Pt[Jt],"array")&&(Ct[Jt]=[],Pt[Jt].forEach(function(an){(0,st.Ym)(an,"string")&&Ct[Jt].push(an)}))}),(0,st.Ym)(Pt,"context","object"))try{JSON.stringify(Pt.context),Ct.context=Pt.context}catch{}cn.log("shareScreen; callConfiguration: "+JSON.stringify(Pt)),Ot=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient),Ct.mesh!==void 0&&Ct.instanceId!==void 0?(cn.debug("keeping instanceId "),Ot.instanceId=Ct.instanceId):Ot.instanceId=apiCC.generateInstanceId(),cn.log("Calling destination number :"+nt);var en=this.MCUClient.getSessionMCU(nt);if(en&&(Ot.sessionMCU=en),Ot.sessionMCU&&this.MCUClient.pubConnector==="janusConnector"&&!Ct.mesh?(Ot.settingUpType="shareScreen",Et&&Et.callControl?(Ot.callControl=Et.callControl,Ot.callControl.autoRestart.counter+=1,Ot.callId=Ot.callControl.callId,Ot.restarted=!0):(Ot.callControl=this.createCallControl({type:"shareScreen",roomName:nt,callConfiguration:Pt,data:Ct}),Ot.callControl.captureSourceType=yt,Ot.callControl.autoRestart.counter=0,Ot.generateCallId(),Ot.callControl.callId=Ot.callId)):(Ot.settingUpType="shareScreen",Ot.generateCallId()),Ut=Ot.callId,Ot.callerId=this.clientId,Ot.calleeId=nt,Ot.dest_roomId=nt,Ot.audioOnly=!1,Ot.screenSharing=!0,Ot.remoteId=nt,Ot.callType="screenSharing",Ot.captureSourceType=yt,Ot.callConfiguration=Pt,Ot.data=Ct,Ot.data.instanceId=Ot.instanceId,en&&en.convId&&(Ot.data.cloudConvId=en.convId),Pt!=null&&Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&Ot.setCallTurnServer(Pt.turnServerAddress),Ot.checkDTLSCompliancy(),apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Ot),Ot.sessionMCU&&this.MCUClient.pubConnector==="janusConnector"&&Ot.callControl&&Ot.callControl.autoRestart.stream)return cn.debug("shareScreen; autoRestart"),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Ot.callLocalStream=Ot.callControl.autoRestart.stream,Ot.establishCall(),Ot.callId;if(Ct!==void 0&&Ct.mesh!==void 0&&(Bt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Ct.mesh.calleeCallId))!==null&&Bt.callConfiguration&&Bt.callConfiguration.userMediaStreamId)return(Qt=apiCC.getUserMediaStream(Bt.callConfiguration.userMediaStreamId)).addCallInfo(Ot.callId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Ot.sessionMCU&&apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector==="janusConnector"&&Ot.callControl&&(Ot.callControl.autoRestart.stream=Qt.stream),Ot.callConfiguration.userMediaStreamId=Qt.userMediaStreamId,Ot.callLocalStream=Qt.stream,Ot.establishCall(),Ot.callId;apiCC.createUserMediaStream({callId:Ot.callId,type:Ot.callType,captureSourceType:yt,success:function(Jt){cn.debug("[shareScreen] success; userMediaStreamId: "+Jt.userMediaStreamId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Ot.sessionMCU&&apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector==="janusConnector"&&Ot.callControl&&(Ot.callControl.autoRestart.stream=Jt.stream),Ot.callConfiguration.userMediaStreamId=Jt.userMediaStreamId,Ot.callLocalStream=Jt.stream,Ot.establishCall()}})}else cn.log("Call Number is incorrect");else cn.log("shareScreen is not supported on this browser"),Jn.createDesktopCaptureEvent("Browser_Not_Compatible",Ut,nt);return cn.info("shareScreen, callId :",Ut),Ut},this.startScreenSharingOnCall=function(nt,Ct){cn.info("getScreenMedia for callId :"+nt);var yt=null;if(ot.Xh==="Chrome")if((yt=this.findCallWithCallId(nt))!==null){if(this.apiRTCExtensionInstalled===!1)return void this.manageNotInstalledExtension(yt.callId,yt.remoteId,Ct);Ct==null&&(Ct=["screen","window","tab"]),window.postMessage({command:"getDesktopId",callNumber:yt.callId,remoteId:yt.remoteId,captureSourceType:Ct,browser_major_version:ot.PR},"*")}else cn.log("call not found");else cn.log("shareScreen is only available for chrome Browser"),Jn.createDesktopCaptureEvent("Browser_Not_Compatible",nt,null)},this.toggleVideoScreen=function(nt){cn.info("toggleVideoScreen for callId :"+nt);var Ct=this.findCallWithCallId(nt);Ct!==null?Ct.toggleVideoScreen():cn.log("call not found")},this.addVideoMedia=function(nt){cn.info("webRTCClient::addVideoMedia for callId :"+nt);var Ct=this.findCallWithCallId(nt);Ct!==null?Ct.addVideoMedia():cn.log("call not found")},this.callbymail=function(nt){var Ct;cn.info("Click on Call per mail Button"),Ct=nt,new RegExp("^[0-9a-z._-]+@{1}[0-9a-z.-]{2,}[.]{1}[a-z]{2,5}$","i").test(Ct)?(cn.log("Calling Destination mail :"+nt),this.socket.emit("webrtc_invite_permail",nt),Gt.channel.socket.emit("webrtc_invite_permail",nt)):cn.log("Mail address is not correct :"+nt)},this.callperURL=function(nt){cn.info("Call per URL");var Ct,yt=null;(yt=new Cn(this)).instanceId=apiCC.generateInstanceId(),cn.log("Calling Destination number :"+nt),yt.generateCallId(),yt.callerId=this.clientId,yt.calleeId=nt,yt.dest_roomId=nt,yt.audioOnly=!1,yt.getUserMediaOnCall(),yt.remoteId=nt,yt.checkDTLSCompliancy(),Ct=this.callsTable.push(yt),cn.log("Call Number is :"+Ct)},this.acceptCall=function(nt,Ct){cn.info("acceptCall for callId :"+nt),cn.log("acceptCall() - callConfiguration : ",Ct);var yt=null,Pt=null;if((yt=this.findCallWithCallId(nt))!==null){if(cn.log("acceptCall() - Call found"),yt.isAccepted=!0,Ct!=null?(Ct.mediaTypeForIncomingCall==="VIDEO"||Ct.mediaTypeForIncomingCall==="AUDIO"||Ct.mediaTypeForIncomingCall==="VIDEOONLY"||Ct.mediaTypeForIncomingCall==="NONE"||Ct.mediaTypeForIncomingCall==="DATA"?(cn.log("acceptCall() - Setting mediaTypeForIncomingCall :"+Ct.mediaTypeForIncomingCall),yt.mediaTypeForIncomingCall=Ct.mediaTypeForIncomingCall):cn.log("acceptCall() - mediaTypeForIncomingCall is not set"),Ct.mediaRoutingMode!==void 0&&Ct.mediaRoutingMode!==null&&yt.setCallMediaRoutingMode(Ct.mediaRoutingMode),Ct.turnServerAddress!==void 0&&Ct.turnServerAddress!==null&&yt.setCallTurnServer(Ct.turnServerAddress),Ct.preferVP9Codec!==!0&&Ct.preferVP9Codec!==!1||(yt.preferVP9Codec=Ct.preferVP9Codec)):(cn.log("acceptCall() - callConfiguration is not set"),Ct={}),yt.screenSharing===!0&&(cn.log("acceptCall() for screenSharing : forcing mediaTypeForIncomingCall to NONE"),Ct.mediaTypeForIncomingCall="NONE",yt.mediaTypeForIncomingCall="NONE"),yt.callConfiguration=(0,st.S6)(yt.callConfiguration,Ct),yt.mediaTypeForIncomingCall==="VIDEO"?yt.setLocalCallProfile({audio:!0,audioActive:!0,video:!0,videoActive:!0}):yt.mediaTypeForIncomingCall==="AUDIO"?yt.setLocalCallProfile({audio:!0,audioActive:!0,video:!1,videoActive:!1}):yt.mediaTypeForIncomingCall==="VIDEOONLY"?yt.setLocalCallProfile({audio:!1,audioActive:!1,video:!0,videoActive:!0}):yt.mediaTypeForIncomingCall==="NONE"&&yt.setLocalCallProfile({audio:!1,audioActive:!1,video:!1,videoActive:!1}),yt.data&&yt.data.MCUType==="MCU-Callee"&&yt.mediaTypeForIncomingCall==="NONE")return void yt.myWebRTC_Stack.sendInvite(yt.callId,yt.callerId,this.nickname,yt.dest_roomId,yt.dest_roomId,"none",{offer:{type:"no-offer"},data:yt.data});yt.data&&yt.data.MCUType==="MCU-Callee"&&(yt.mediaTypeForOutgoingCall=yt.mediaTypeForIncomingCall,yt.settingUpType="publish",yt.callControl=this.createCallControl({type:"publish",callId:yt.callId,roomName:yt.data.confId,callConfiguration:yt.callConfiguration,data:yt.data}),yt.callControl.sessionId=yt.data.confId,yt.callControl.token=yt.data.confId,yt.callControl.autoRestart.counter=0,yt.setMediaConstraintsToSendOnlyOffer()),this.unidirectionelCallOnly?(cn.log("acceptCall() - unidirectional call"),yt.onUserMediaSuccessTestUni()):this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?(cn.log("acceptCall with userAcceptOnIncomingCallBeforeGetUserMedia"),Ct.userMediaStreamId?((Pt=apiCC.getUserMediaStream(Ct.userMediaStreamId)).addCallInfo(yt.callId),yt.callConfiguration!==void 0&&yt.callConfiguration!==null||(yt.callConfiguration={}),yt.callConfiguration.userMediaStreamId=Pt.userMediaStreamId,yt.onUserMediaSuccessOnCall(Pt.stream)):yt.getUserMediaOnCall()):yt.accessToMedia===!0||Ct.userMediaStreamId||yt.dataCall?(cn.log("acceptCall() :: User has already granted access to local media and AutoAnswer activated : establishing call"),yt.dataCall||Ct.userMediaStreamId&&((Pt=apiCC.getUserMediaStream(Ct.userMediaStreamId)).addCallInfo(yt.callId),yt.callConfiguration!==void 0&&yt.callConfiguration!==null||(yt.callConfiguration={}),yt.callConfiguration.userMediaStreamId=Pt.userMediaStreamId,yt.callLocalStream=Pt.stream),yt.establishCall()):cn.log("acceptCall() - call will be established when user accept his media")}else cn.log("Call not found")},this.refuseCall=function(nt,Ct){cn.info("refuseCall for callId :"+nt);var yt,Pt=null;yt=Ct!==void 0?Ct:"User_Refused_Call",(Pt=this.findCallWithCallId(nt))!==null?(cn.log("Call found"),Pt.data.MCUType==="MCU-Callee"?(Pt.myWebRTC_Stack.sendBye(Pt.callId,Pt.callerId,Pt.dest_roomId,Pt.calleeId,"User_Media_Error",Pt.data),this.removeCallFromTableWithCallIdandRemoteId(Pt.callId,Pt.calleeId,yt)):(Pt.myWebRTC_Stack.sendBye(Pt.callId,Pt.calleeId,Pt.dest_roomId,Pt.callerId,yt,Pt.data),this.removeCallFromTableWithCallIdandRemoteId(Pt.callId,Pt.callerId,yt)),this.callsTable.length===0&&cn.log("No more established calls for client")):cn.log("Call not found")},this.stopMedia=function(nt){var Ct=this;return new Promise(function(yt,Pt){var Et=null,Ut=null;return(Et=Ct.findCallWithCallId(nt))?Et.callLocalStream?void Et.removeStream(Et.callLocalStream).then(function(){return Et.callLocalStream=null,(0,st.ki)(Et.callConfiguration,"userMediaStreamId","string")&&(apiCC.releaseUserMediaStream(Et.callConfiguration.userMediaStreamId,Et.callId),delete Et.callConfiguration.userMediaStreamId),yt()}).catch(Pt):yt():((Ut=Ct.findUserMediaById(nt))&&Ut.releaseUserMediaStream(),yt())})},this.addMedia=function(nt,Ct,yt,Pt){var Et=this;cn.info("addMedia for callId :"+nt);var Ut=null,Ot=null,Bt=null,Qt=function(){return Promise.resolve()},en=function(){return Promise.resolve()};Ct===!0&&(Qt=function(){return Et.stopMedia(nt)}),(0,st.Ym)(yt,"string")&&(Bt=apiCC.getUserMediaStream(yt),yt=null);var Jt=function(){cn.error("[addMedia] success; userMediaStreamId: "+Bt.userMediaStreamId),Ot.callConfiguration!==void 0&&Ot.callConfiguration!==null||(Ot.callConfiguration={}),Ot.callConfiguration.userMediaStreamId=Bt.userMediaStreamId,Ot.callType=Bt.callType,Ot.audio=Bt.audio,Ot.video=Bt.video,Ot.audioMuted=Bt.audioMuted,Ot.videoMuted=Bt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Ot,!0)},an=function(dn){dn.callConfiguration!==void 0&&dn.callConfiguration!==null||(dn.callConfiguration={}),dn.isLocalAudioMuted&&dn.isLocalVideoMuted?dn.callConfiguration.muted="VIDEO":dn.isLocalAudioMuted?dn.callConfiguration.muted="AUDIOONLY":dn.isLocalVideoMuted&&(dn.callConfiguration.muted="VIDEOONLY")},hn=function(dn,Sn,wn){Sn==="audio"?wn?dn.audioSdpDirection=null:(0,st.ki)(dn.remoteCallProfile,"audio","boolean")&&dn.remoteCallProfile.audio===!0&&dn.remoteCallProfile.audioActive===!0?dn.audioSdpDirection="recvonly":dn.audioSdpDirection="inactive":Sn==="video"&&(wn?dn.videoSdpDirection=null:(0,st.ki)(dn.remoteCallProfile,"video","boolean")&&dn.remoteCallProfile.video===!0&&dn.remoteCallProfile.videoActive===!0?dn.videoSdpDirection="recvonly":dn.videoSdpDirection="inactive")},rn=function(dn,Sn,wn,An){dn.callConfiguration!==void 0&&dn.callConfiguration!==null||(dn.callConfiguration={}),dn.callConfiguration.userMediaStreamId=Sn.userMediaStreamId,hn(dn,"audio",Sn.audio),hn(dn,"video",Sn.video),an(dn),function(_n,jn,ar){jn&&ar?(_n.audioOnly=!1,_n.mediaTypeForIncomingCall="VIDEO",_n.mediaTypeForOutgoingCall="VIDEO"):jn?(_n.audioOnly=!1,_n.mediaTypeForIncomingCall="AUDIO",_n.mediaTypeForOutgoingCall="AUDIO"):ar?(_n.audioOnly=!1,_n.mediaTypeForIncomingCall="VIDEOONLY",_n.mediaTypeForOutgoingCall="VIDEOONLY"):(_n.audioOnly=!1,_n.mediaTypeForIncomingCall="NONE",_n.mediaTypeForOutgoingCall="NONE")}(dn,Sn.audio,Sn.video),dn.callLocalStream=Sn.stream,dn.started?dn.addingUserMedia=!0:Et.accessToLocalMedia=!0,dn.asyncCallbacks={},dn.asyncCallbacks.type="addingUserMedia",dn.asyncCallbacks.resolve=wn,dn.asyncCallbacks.reject=An,dn.asyncCallbacks.timeoutId=setTimeout(function(){dn.asyncCallbacks&&typeof dn.asyncCallbacks.reject=="function"&&(dn.asyncCallbacks.reject("addMedia timeout"),delete dn.asyncCallbacks)},Qn),dn.establishCall()};if((Ut=this.findCallWithCallId(nt))!==null){if(Ut.asyncCallbacks)return Promise.reject("job already ongoing");en=function(){return new Promise(function(dn,Sn){Bt?(Bt.addCallInfo(Ut.callId),rn(Ut,Bt,dn,Sn)):yt?apiCC.createUserMediaStream({type:"media",callId:Ut.callId,stream:yt,sync:!0,success:function(wn){cn.debug("[addMedia] success; userMediaStreamId: "+wn.userMediaStreamId),rn(Ut,wn,dn,Sn)},failure:function(wn,An){return Sn(An)}}):(0,st.ki)(Pt,"getUserMediaStreamId","function")?Pt.getUserMediaStreamId().then(function(wn){if(!(Bt=apiCC.getUserMediaStream(wn)))return Sn("wrong userMediaStreamId");Bt.addCallInfo(Ut.callId),rn(Ut,Bt,dn,Sn)}).catch(Sn):apiCC.userMediaStreamTable.length>0?((Bt=apiCC.userMediaStreamTable[0]).addCallInfo(Ut.callId),rn(Ut,Bt,dn,Sn)):(an(Ut),Ut.addingUserMedia=!0,Ut.asyncCallbacks={},Ut.asyncCallbacks.type="addingUserMedia",Ut.asyncCallbacks.resolve=dn,Ut.asyncCallbacks.reject=Sn,Ut.asyncCallbacks.timeoutId=setTimeout(function(){Ut.asyncCallbacks&&typeof Ut.asyncCallbacks.reject=="function"&&(Ut.asyncCallbacks.reject("addMedia timeout"),delete Ut.asyncCallbacks)},Qn),Ut.getUserMediaOnCall())})}}else if(Ot=this.findUserMediaById(nt)){if(Ot.addingUserMedia===!0)return Promise.reject("addMedia already ongoing");en=function(){return new Promise(function(dn,Sn){Ot.addingUserMedia=!0,new Promise(function(wn,An){if(Bt)return Bt.addCallInfo(Ot.userMediaId,"userMedia"),Ot.callConfiguration!==void 0&&Ot.callConfiguration!==null||(Ot.callConfiguration={}),Ot.callConfiguration.userMediaStreamId=Bt.userMediaStreamId,Ot.callType=Bt.callType,Ot.audio=Bt.audio,Ot.video=Bt.video,Ot.audioMuted=Bt.audioMuted,Ot.videoMuted=Bt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Ot,!0),wn(Bt.userMediaStreamId);if(yt)apiCC.createUserMediaStream({callId:Ot.userMediaId,callFlavor:"userMedia",type:Ot.callType,stream:yt,sync:!0,success:function(){return Jt(),wn(Bt.userMediaStreamId)},failure:function(_n,jn){return An(jn)}});else if((0,st.ki)(Pt,"getUserMediaStreamId","function"))Pt.getUserMediaStreamId().then(function(_n){return(Bt=apiCC.getUserMediaStream(_n))?(Bt.addCallInfo(Ot.userMediaId,"userMedia"),Ot.callConfiguration!==void 0&&Ot.callConfiguration!==null||(Ot.callConfiguration={}),Ot.callConfiguration.userMediaStreamId=Bt.userMediaStreamId,Ot.callType=Bt.callType,Ot.audio=Bt.audio,Ot.video=Bt.video,Ot.audioMuted=Bt.audioMuted,Ot.videoMuted=Bt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Ot,!0),wn(Bt.userMediaStreamId)):An("wrong userMediaStreamId")}).catch(An);else{if(apiCC.userMediaStreamTable.length>0)return(Bt=apiCC.userMediaStreamTable[0]).addCallInfo(Ot.userMediaId,"userMedia"),Ot.callConfiguration!==void 0&&Ot.callConfiguration!==null||(Ot.callConfiguration={}),Ot.callConfiguration.userMediaStreamId=Bt.userMediaStreamId,Ot.callType=Bt.callType,Ot.audio=Bt.audio,Ot.video=Bt.video,Ot.audioMuted=Bt.audioMuted,Ot.videoMuted=Bt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Ot,!0),wn(Bt.userMediaStreamId);apiCC.createUserMediaStream({callId:Ot.userMediaId,callFlavor:"userMedia",type:Ot.callType,audioSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.audioSourceId,videoSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.videoSourceId,success:function(){return Jt(),wn(Bt.userMediaStreamId)},failure:function(_n,jn){return An(jn)}})}}).then(function(wn){return function(An){return new Promise(function(_n,jn){for(var ar=[],fr=0;fr<apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length;fr+=1){var Cr=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[fr];Cr.data!==void 0&&Cr.data.mesh!==void 0&&Cr.data.mesh.calleeCallId===nt&&ar.push(apiCC.session.apiCCWebRTCClient.webRTCClient.addMedia(Cr.callId,!0,An))}Promise.all(ar).then(function(){return _n(An)}).catch(jn)})}(wn)}).then(function(wn){return delete Ot.addingUserMedia,dn(wn)}).catch(function(wn){return delete Ot.addingUserMedia,Sn(wn)})})}}else en=function(){return Promise.reject("no suitable replacement")};return new Promise(function(dn,Sn){Qt().then(function(){return en()}).then(function(wn){return cn.info("addMedia success; userMediaStreamId: "+wn),dn(wn)}).catch(function(wn){cn.error("addMedia failure: "+wn);var An=null,_n=null;return Ut?(Ut.callControl&&(An=Ut.callControl.roomName,_n=Ut.callControl.type),Jn.createErrorEvent("Failed to addMedia","MEDIA_UPDATE_ERROR",Ut.callId,An,_n)):Ot&&Jn.createErrorEvent("Failed to addMedia","MEDIA_UPDATE_ERROR",Ot.userMediaId,null,"publish"),Sn(wn)})})},this.updateMediaDeviceOnCall=function(nt,Ct){return cn.info("updateMediaDeviceOnCall for callId :"+nt),this.addMedia(nt,!0,Ct),nt},this.updateMediaTypeOnCall=function(nt,Ct){var yt=function(Ut,Ot,Bt){return new Promise(function(Qt,en){var Jt,an={};Ut.callControl.mediaType=Bt,Ut.mediaType=Bt,Ut.data.mediaType=Bt,Ut.updateCause="userAction",an.type="update",an.mode="passive",an.callId=Ut.callId,an.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,an.callerNickname=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,an.calleeId=Ut.sessionMCU.roomName,an.roomId=Ut.sessionMCU.roomName,an.callType=Ot.attributes.callType,an.data=(0,st.S6)(Ut.data),an.data.type="subscribe",an.stream=Ot,Jt=JSON.stringify(an),cn.log("C->S: "+Jt),apiCC.session.apiCCWebRTCClient.webRTCClient.socket.emit("update",Jt),Ut.asyncCallbacks={},Ut.asyncCallbacks.type="updateMediaType",Ut.asyncCallbacks.resolve=Qt,Ut.asyncCallbacks.reject=en,Ut.asyncCallbacks.timeoutId=setTimeout(function(){Ut.asyncCallbacks&&typeof Ut.asyncCallbacks.reject=="function"&&(Ut.asyncCallbacks.reject("timeout"),delete Ut.asyncCallbacks)},2e4)})},Pt=this.findCallWithCallId(nt);if(!Pt)return Promise.reject("call not found");if(Pt.settingUpType!=="subscribe")return Promise.reject("wrong call type");if(Pt.asyncCallbacks)return Promise.reject("job already ongoing");var Et=this.MCUClient.getStreamFromList(Pt.streamId);if(!Et)return Promise.reject("wrong streamId");if(Pt.callControl.mediaType==="VIDEO"){if(Ct==="AUDIOONLY"&&Et.audio||Ct==="VIDEOONLY"&&Et.video)return yt(Pt,Et,Ct)}else if(Pt.callControl.mediaType==="AUDIOONLY"){if(Ct==="VIDEO"&&Et.video||Ct==="VIDEOONLY"&&Et.video)return yt(Pt,Et,Ct)}else if(Pt.callControl.mediaType==="VIDEOONLY"&&(Ct==="VIDEO"&&Et.video||Ct==="AUDIOONLY"&&Et.audio))return yt(Pt,Et,Ct);return Promise.reject("wrong mediaType")},this.updateSimulcastFeedOnCall=function(nt,Ct){var yt=this.findCallWithCallId(nt);if(!yt)return Promise.reject("call not found");if(yt.settingUpType!=="subscribe")return Promise.reject("wrong call type");if(yt.asyncCallbacks)return Promise.reject("job already ongoing");var Pt=this.MCUClient.getStreamFromList(yt.streamId);if(!Pt)return Promise.reject("wrong streamId");if(!Ct)return Promise.reject("wrong simulcast");yt.callControl.callConfiguration.simulcast||(yt.callControl.callConfiguration.simulcast={}),yt.data.simulcast||(yt.data.simulcast={}),Ct.streamQuality&&(Ct.streamQuality==="high"?(yt.callControl.callConfiguration.simulcast.substream=2,yt.data.simulcast.substream=2):Ct.streamQuality==="medium"?(yt.callControl.callConfiguration.simulcast.substream=1,yt.data.simulcast.substream=1):Ct.streamQuality==="low"?(yt.callControl.callConfiguration.simulcast.substream=0,yt.data.simulcast.substream=0):(yt.callControl.callConfiguration.simulcast.substream=-1,yt.data.simulcast.substream=-1)),Ct.streamFrameRate&&(Ct.streamFrameRate==="high"?(yt.callControl.callConfiguration.simulcast.temporal=2,yt.data.simulcast.temporal=2):Ct.streamFrameRate==="medium"?(yt.callControl.callConfiguration.simulcast.temporal=1,yt.data.simulcast.temporal=1):Ct.streamFrameRate==="low"?(yt.callControl.callConfiguration.simulcast.temporal=0,yt.data.simulcast.temporal=0):(yt.callControl.callConfiguration.simulcast.temporal=-1,yt.data.simulcast.temporal=-1));var Et={type:"updateSimulcastFeed"};Et.callId=yt.callId,Et.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Et.callerNickname=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Et.calleeId=yt.sessionMCU.roomName,Et.roomId=yt.sessionMCU.roomName,Et.callType=Pt.attributes.callType,Et.data=(0,st.S6)(yt.data),Et.stream=Pt;var Ut=JSON.stringify(Et);return cn.log("C->S: "+Ut),apiCC.session.apiCCWebRTCClient.webRTCClient.socket.emit("updateSimulcastFeed",Ut),Promise.resolve()},this.updateCallConfigurationOnCall=function(nt,Ct){var yt=function(Et,Ut,Ot){Ut==="audio"?Et.audioSdpDirection=Ot?null:"inactive":Ut==="video"&&(Et.videoSdpDirection=Ot?null:"inactive")},Pt=this.findCallWithCallId(nt);return Pt?Pt.settingUpType!=="publish"?Promise.reject("wrong call type"):Pt.asyncCallbacks?Promise.reject("job already ongoing"):((0,st.Ym)(Ct,"object")||(Ct={}),(0,st.ki)(Ct,"audioOnly","boolean")||(Ct.audioOnly=!1),(0,st.ki)(Ct,"videoOnly","boolean")||(Ct.videoOnly=!1),function(Et,Ut){return new Promise(function(Ot,Bt){Et.mediaTypeForIncomingCall="NONE",Ut.audioOnly===!0?(cn.log("Setting call as audioOnly"),Et.audioOnly=!0,Et.callType="audio",Et.mediaTypeForOutgoingCall="AUDIO",yt(Et,"audio",!0),yt(Et,"video",!1)):Ut.videoOnly===!0?(cn.log("Setting call as videoOnly"),Et.audioOnly=!1,Et.callType="videoOnly",Et.mediaTypeForOutgoingCall="VIDEOONLY",yt(Et,"audio",!1),yt(Et,"video",!0)):(cn.log("Setting call as media"),Et.audioOnly=!1,Et.callType="media",Et.mediaTypeForOutgoingCall="VIDEO",yt(Et,"audio",!0),yt(Et,"video",!0)),Et.updateUserMedia=!0,Et.updateCause="userAction",Et.establishCall(),Et.asyncCallbacks={},Et.asyncCallbacks.type="updateCallConfiguration",Et.asyncCallbacks.resolve=Ot,Et.asyncCallbacks.reject=Bt,Et.asyncCallbacks.timeoutId=setTimeout(function(){Et.asyncCallbacks&&typeof Et.asyncCallbacks.reject=="function"&&(Et.asyncCallbacks.reject("timeout"),delete Et.asyncCallbacks)},2e4)})}(Pt,Ct)):Promise.reject("call not found")},this.findUserMediaById=function(nt){for(var Ct=this.userMediaTable.length;--Ct>=0;)if(this.userMediaTable[Ct].userMediaId===nt)return this.userMediaTable[Ct];return null},this.findCallIndexWithCallIdAndRemoteId=function(nt,Ct){cn.debug("findCallIndexWithCallIdAndRemoteId");var yt,Pt=this.callsTable.length;for(cn.trace("callsNumber : "+Pt),yt=0;yt<Pt;yt+=1)if(this.callsTable[yt].callId===nt&&(cn.log("callId found"),cn.log("this.callsTable[i].callee :"+this.callsTable[yt].callee),cn.log("this.callsTable[i].calleeId :"+this.callsTable[yt].calleeId),this.callsTable[yt].callee===!0&&this.callsTable[yt].callerId===Ct||this.callsTable[yt].callee===!1&&this.callsTable[yt].calleeId===Ct))return yt;return cn.log("Call not found"),-1},this.findCallIndexWithConfIdAndRemoteId=function(nt,Ct){cn.debug("findCallIndexWithConfIdAndRemoteId"),cn.log("confId :"+nt),cn.log("remoteId :"+Ct);var yt,Pt=this.callsTable.length;for(yt=0;yt<Pt;yt+=1)if(cn.log("this.callsTable[i].data.confId :"+this.callsTable[yt].data.confId),this.callsTable[yt].data.confId===nt){if(this.callsTable[yt].callee===!0&&this.callsTable[yt].callerId===Ct||this.callsTable[yt].callee===!1&&this.callsTable[yt].calleeId===Ct)return yt}else cn.debug("ConfId is different");return cn.debug("Call not found - findCallIndexWithConfIdAndRemoteId"),-1},this.findCallIndexWithCallId=function(nt){cn.debug("findCallIndexWithCallId");var Ct,yt=this.callsTable.length;for(Ct=0;Ct<yt;Ct+=1)if(this.callsTable[Ct].callId===nt)return cn.log("Call found with callId"),Ct;return cn.debug("Call not found - findCallIndexWithCallId"),-1},this.findCallWithCallIdAndInstanceId=function(nt,Ct){cn.debug("findCallWithCallIdAndInstanceId :"+nt+" ,instanceId : "+Ct),Ct===void 0&&cn.debug("instanceId is undefined : must be a mesh publish call, id must be a streamId");var yt,Pt=this.callsTable.length;for(cn.trace("callsNumber :"+Pt),yt=0;yt<Pt;yt+=1)if(this.callsTable[yt].callId===nt&&this.callsTable[yt].instanceId===Ct)return this.callsTable[yt];return cn.debug("Call not found, findCallWithCallIdAndInstanceId"),null},this.findCallIndexWithCallIdAndInstanceId=function(nt,Ct){cn.debug("findCallIndexWithCallIdAndInstanceId :"+nt+" ,instanceId : "+Ct),Ct===void 0&&cn.debug("instanceId is undefined : must be a mesh publish call, id must be a streamId");var yt,Pt=this.callsTable.length;for(cn.trace("callsNumber :"+Pt),yt=0;yt<Pt;yt+=1)if(this.callsTable[yt].callId===nt&&this.callsTable[yt].instanceId===Ct)return yt;return cn.debug("Call not found, findCallIndexWithCallIdAndInstanceId"),-1},this.findCallWithCallId=function(nt){cn.trace("findCallWithCallId :"+nt);var Ct,yt=this.callsTable.length;for(cn.trace("callsNumber :"+yt),Ct=0;Ct<yt;Ct+=1)if(cn.trace("this.callsTable[i].callId :"+this.callsTable[Ct].callId),this.callsTable[Ct].callId===nt)return this.callsTable[Ct];return cn.debug("Call not found"),null},this.findCallWithStreamId=function(nt,Ct){cn.debug("findCallWithStreamId :"+nt);var yt,Pt=!(!Ct||!Ct.ignoreModeChangeKindOld),Et=this.callsTable.length;for(cn.trace("callsNumber :"+Et),yt=0;yt<Et;yt+=1)if(cn.log("this.callsTable[i].streamId :"+this.callsTable[yt].streamId),!(this.callsTable[yt].streamId!=nt||Pt&&this.callsTable[yt].sessionMCU&&this.callsTable[yt].sessionMCU.modeChangeKind==="old"))return cn.log("Call found"),this.callsTable[yt];return cn.log("Call not found"),null},this.findCallWithCallIdAndRemoteIdAndInstanceId=function(nt,Ct,yt){cn.debug("findCallWithCallIdAndRemoteIdAndInstanceId callId : "+nt+" ,instanceId : "+yt);var Pt,Et=this.callsTable.length;for(cn.trace("callsNumber :"+Et),Pt=0;Pt<Et;Pt+=1)if(this.callsTable[Pt].callId===nt&&this.callsTable[Pt].instanceId===yt&&(this.callsTable[Pt].callee===!0&&this.callsTable[Pt].callerId===Ct||this.callsTable[Pt].callee===!1&&this.callsTable[Pt].calleeId===Ct))return this.callsTable[Pt];return cn.debug("Call not found"),null},this.findCallWithCallIdAndRemoteId=function(nt,Ct){cn.log("findCallWithCallIdAndRemoteId");var yt,Pt=this.callsTable.length;for(cn.trace("callsNumber :"+Pt),yt=0;yt<Pt;yt+=1)if(this.callsTable[yt].callId===nt&&(this.callsTable[yt].callee===!0&&this.callsTable[yt].callerId===Ct||this.callsTable[yt].callee===!1&&this.callsTable[yt].calleeId===Ct))return this.callsTable[yt];return cn.log("Call not found"),null},this.releaseUserMedia=function(){cn.info("releaseUserMedia"),this.localStream!==null&&(cn.log("stopping localStream"),this.stopStream(this.localStream),Jn.createUserMediaStopEvent(null,"media"),this.accessToLocalMedia=!1,this.autoAnswer=!1,cn.log("this.autoAnswer :"+this.autoAnswer)),this.screenStream!==null&&this.screenStream!==void 0&&(cn.log("stopping screenStream"),this.stopStream(this.screenStream),Jn.createUserMediaStopEvent(null,"screen"))},this.startDataChannelOnCall=function(nt){cn.info("startDataChannelOnCall with callId :"+nt);var Ct=this.findCallWithCallId(nt);Ct?(cn.log("Call found",Ct),Ct.addingDataChannelOnCallOngoing=!0,Ct.createDataChannel()):cn.log("Call not found")},this.sendDataWithCallId=function(nt,Ct,yt){cn.info("sendDataWithCallId :"+nt);var Pt=this.findCallWithCallId(nt);Pt?(cn.log("Call found",Pt),Pt.sendData(Ct,yt)):cn.log("Call not found")},this.processDataAck=function(nt){cn.debug("processDataAck",nt);var Ct=this.findCallWithCallId(nt.callId);if(Ct)if(nt.result==="ok")if((0,st.ki)(nt,"capabilities","object")&&(0,st.ki)(nt.capabilities,"dataEndAckEnabled","boolean")&&(Ct.dataEndAckEnabled=nt.capabilities.dataEndAckEnabled,cn.debug("dataEndAckEnabled",Ct.dataEndAckEnabled)),nt.state==="complete")Ct.beginTimeoutId&&(clearTimeout(Ct.beginTimeoutId),delete Ct.beginTimeoutId),Ct.callbacks.success({state:"complete",filename:Ct.data.filename,size:Ct.data.size,mediaURL:nt.mediaURL,mediaId:nt.mediaId}),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Ct.callId);else if(nt.state==="incomplete"){var yt,Pt,Et=131072,Ut=[],Ot=Math.floor(Ct.data.size/Et),Bt=Ct.data.size%Et;for(yt=0;yt<Ot;yt+=1)(Pt=Xn("checksum64")).update(Ct.fileContent,yt*Et,Et),Ut.push(Pt.digest("hex"));if(Bt>0&&((Pt=Xn("checksum64")).update(Ct.fileContent,Ot*Et,Bt),Ut.push(Pt.digest("hex"))),cn.debug(JSON.stringify(Ut)),nt.checksums.length===Ut.length){for(yt=0;yt<Ut.length&&nt.checksums[yt]===Ut[yt];yt+=1);Ct.data.offset=Et*yt}Ct.mediaURL=nt.mediaURL,Ct.mediaId=nt.mediaId,Ct.establishCall()}else nt.state==="missing"?(Ct.mediaURL=nt.mediaURL,Ct.mediaId=nt.mediaId,Ct.establishCall()):nt.state==="ready"?Ct.establishCall():(cn.debug("wrong state "+nt.state),Ct.beginTimeoutId&&(clearTimeout(Ct.beginTimeoutId),delete Ct.beginTimeoutId),Ct.callbacks.failure("serverError"),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Ct.callId));else cn.debug("wrong result "+nt.result),Ct.beginTimeoutId&&(clearTimeout(Ct.beginTimeoutId),delete Ct.beginTimeoutId),Ct.callbacks.failure("serverError"),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Ct.callId);else cn.debug("no such call",nt.callId)},this.processDataEndAck=function(nt){cn.debug("processDataEndAck",nt);var Ct=this.findCallWithCallId(nt.callId);if(Ct){var yt=null;if(!Ct.dcfs){if(!Ct.data||Ct.data.transferType!=="pipeline")return void cn.debug("not pipeline");cn.debug("pipeline"),yt=Ct,Ct.clientCall?(cn.debug("resolve client call"),Ct=Ct.clientCall):(cn.debug("no client call"),Ct=null)}Ct&&(Ct.success&&nt.data&&(Ct.success.data=nt.data),nt.result==="ok"?(nt.complete===!0||(delete Ct.success,Ct.failure="transferIncomplete"),Ct.dcfs.terminateTransfer()):nt.result==="error"&&(delete Ct.success,Ct.failure=nt.errorInfo,Ct.dcfs.terminateTransfer())),yt&&nt.result==="error"&&(cn.debug("error on pipeline"),yt.failure=nt.errorInfo,Jn.createEvent({eventType:"onFileSended",callId:yt.callId,remoteId:yt.remoteId,name:yt.filename,error:yt.failure}),yt.callbacks.failure(yt.failure),this.onHangup(yt.callId))}else cn.debug("no such call",nt.callId)},this.pushData=function(nt,Ct,yt,Pt){var Et=this;if(!(0,st.Ym)(Ct,"object")||((Ct=Object.assign({},Ct)).transferType||(Ct.transferType="file"),Ct.transferType==="file"&&!nt)||Ct.transferType!=="file"&&Ct.transferType!=="pipeline"&&Ct.transferType!=="plugin"||!(Ct.transferType!=="plugin"||Ct.pluginName&&Ct.pluginData))return null;(0,st.Ym)(Pt,"object")||(Pt={}),typeof Pt.pending!="function"&&(Pt.pending=function(){}),typeof Pt.progress!="function"&&(Pt.progress=function(){}),typeof Pt.success!="function"&&(Pt.success=function(){}),typeof Pt.failure!="function"&&(Pt.failure=function(){});var Ut=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient);if(Ut.generateCallId(),Ut.instanceId=apiCC.generateInstanceId(),Ut.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Ut.calleeId="dataChannelConnector",Ut.dest_roomId="dataChannelConnector",Ut.callType="data",Ut.dataCall=!0,Ut.remoteId="dataChannelConnector",Ct.pipelineCallId&&(Ut.pipelineCallId=Ct.pipelineCallId),Ut.data={},Ut.data.pubSub="dataChannelConnector",Ut.data.transferType=Ct.transferType,Ct.transferType==="pipeline"?(Ct.checksumEnabled=!1,Ut.transferCount=0):Ct.transferType==="plugin"&&(Ct.checksumEnabled=!1,Ut.data.pluginName=Ct.pluginName,Ut.data.pluginData=Object.assign({},Ct.pluginData),Ut.data.pluginData.headers&&(Ut.data.pluginData.headers=Object.assign({},Ut.data.pluginData.headers)),Ut.data.pluginData.data&&(Ut.data.pluginData.data=Object.assign({},Ut.data.pluginData.data)),Ut.data.pluginData.formData&&(Ut.data.pluginData.formData=Object.assign({},Ut.data.pluginData.formData))),(0,st.ki)(Ct,"context","object"))try{JSON.stringify(Ct.context),Ut.data.context=Object.assign({},Ct.context)}catch{}if(Ct.overwrite===!0&&(Ut.data.overwrite=!0),(0,st.Ym)(Ct,"ttl","number")&&Ct.ttl>0&&(Ut.data.ttl=Ct.ttl),Ut.data.instanceId=Ut.instanceId,nt&&(Ut.data.cloudConvId=nt),Ut.callbacks=Pt,yt!=null&&yt.turnServerAddress!==void 0&&yt.turnServerAddress!==null&&Ut.setCallTurnServer(yt.turnServerAddress),Ut.data.transferType==="pipeline")Ut.data.size=0,Ut.pushDataStatus={type:"pipeline",state:"pending",data:Ct},this.callsTable.push(Ut),setTimeout(function(){Et.startNextPushData()});else if((0,st.Ym)(Ct,"file","object")&&(Ct.file instanceof File||Ct.file.constructor===File||Ct.asFile===!0))(0,st.Ym)(Ct,"filename","string")?Ut.data.filename=Ct.filename:Ut.data.filename=Ct.file.name,(0,st.Ym)(Ct,"filetype","string")?Ut.data.contentType=Ct.filetype:Ut.data.contentType=Ct.file.type,(0,st.Ym)(Ct,"sourceType","string")&&Ct.sourceType.length>0&&(Ut.data.sourceType=Ct.sourceType),Ut.data.size=Ct.file.size,Ut.data.metadata=Ct.metadata,Ut.pushDataStatus={type:"file",state:"pending",convId:String(nt),data:Ct},this.callsTable.push(Ut),setTimeout(function(){Et.startNextPushData()});else{if(!(0,st.Ym)(Ct,"buffer","object")||!(Ct.buffer instanceof ArrayBuffer||Ct.buffer.constructor===ArrayBuffer||Ct.asBuffer===!0)||!(0,st.Ym)(Ct,"filename","string")||!(0,st.Ym)(Ct,"filetype","string"))return null;Ut.data.filename=Ct.filename,Ut.data.contentType=Ct.filetype,(0,st.Ym)(Ct,"sourceType","string")&&Ct.sourceType.length>0&&(Ut.data.sourceType=Ct.sourceType),Ut.data.size=Ct.buffer.byteLength,Ut.data.metadata=Ct.metadata,Ut.pushDataStatus={type:"buffer",state:"pending",convId:String(nt),data:Ct},this.callsTable.push(Ut),setTimeout(function(){Et.startNextPushData()})}return Ut.callId},this.startNextPushData=function(){for(var nt=this,Ct=[],yt=0;yt<this.callsTable.length;yt+=1){var Pt=this.callsTable[yt];if(Pt.callType==="data"&&Pt.dataCall&&Pt.remoteId==="dataChannelConnector"&&Pt.pushDataStatus){if(Pt.pushDataStatus.state==="ready")continue;Ct.push(Pt)}}if(Ct.length===0)return!1;var Et=null;Ct[0].pushDataStatus.state==="active"?Ct.splice(0,1):Ct[0].pushDataStatus.state==="pending"&&(Et=Ct[0],Ct.splice(0,1));for(var Ut=0;Ut<Ct.length;Ut+=1){var Ot=Ct[Ut];Ot.pushDataStatus.rank!==Ut&&(Ot.pushDataStatus.rank=Ut,Jn.createEvent({eventType:"onFilePending",callId:Ot.callId,remoteId:Ot.remoteId,name:Ot.data.filename,rank:Ut}),Ot.callbacks.pending({state:"pending",callId:Ot.callId,rank:Ut}))}if(!Et)return!1;cn.debug("startNextPushData",Et.callId);var Bt=Et.pushDataStatus.data;if(delete Et.pushDataStatus.data,Et.pushDataStatus.type==="pipeline"){Et.pushDataStatus.state="active";var Qt={type:"pushData",callerId:apiCC.session.apiCCId,callId:Et.callId,data:Et.data},en=JSON.stringify(Qt);return cn.debug("C->S: "+en),apiCC.session.channel.socket.emit("pushData",en),!0}if(Et.pushDataStatus.type==="file"){Et.pushDataStatus.state="active";var Jt=new FileReader;Jt.onload=function(an){apiCC.session.apiCCWebRTCClient.webRTCClient.startPushData(Et,Bt,an.target.result)},Jt.readAsArrayBuffer(Bt.file)}else{if(Et.pushDataStatus.type!=="buffer")return cn.error("startNextPushData - wrong type"),Et.callbacks.failure("start",Et.callId),this.onHangup(Et.callId),!1;Et.pushDataStatus.state="active",this.startPushData(Et,Bt,Bt.buffer)}return Et.beginTimeoutId=setTimeout(function(){delete Et.beginTimeoutId,Et.callbacks.failure("timeout",Et.callId),nt.onHangup(Et.callId)},2e4),!0},this.startPushData=function(nt,Ct,yt){if(nt.fileContent=new Uint8Array(yt),nt.pipelineCallId){var Pt=this.findCallWithCallId(nt.pipelineCallId);if(!Pt)return cn.error("no such pipeline call"),void this.onHangup(nt.callId);nt.pipelineCall=Pt,Pt.clientCall=nt,nt.sendDataChannel=Pt.sendDataChannel;var Et=Pt.transferCount===0?100:0;nt.startTransfer({delay:Et}),Pt.transferCount+=1}else{if(!Object.prototype.hasOwnProperty.call(Ct,"checksumEnabled")||Ct.checksumEnabled){var Ut=Xn("checksum64");Ut.update(nt.fileContent),nt.data.checksum=Ut.digest("hex")}else nt.data.checksumEnabled=!1;var Ot={type:"pushData",callerId:apiCC.session.apiCCId,convId:nt.pushDataStatus.convId,callId:nt.callId,data:nt.data},Bt=JSON.stringify(Ot);cn.debug("C->S: "+Bt),apiCC.session.channel.socket.emit("pushData",Bt)}},this.cancelPushData=function(nt){for(var Ct=null,yt=this.callsTable.length;--yt>=0;){var Pt=this.callsTable[yt];if(Pt.callId===nt&&Pt.callType==="data"&&Pt.dataCall&&Pt.remoteId==="dataChannelConnector"&&Pt.pushDataStatus){Ct=Pt;break}}if(!Ct)return cn.error("cancelPushData - no such call",nt),"no such call";if(Ct.pushDataStatus.state==="pending")Jn.createEvent({eventType:"onFileSended",callId:Ct.callId,remoteId:Ct.remoteId,name:Ct.data.filename,error:"canceled"}),Ct.callbacks.failure("canceled"),this.onHangup(Ct.callId);else if(Ct.pushDataStatus.state==="active")this.onHangup(Ct.callId);else{if(Ct.pushDataStatus.state!=="ready")return cn.error("cancelPushData - wrong state"),"wrong state";Ct.clientCall&&this.cancelPushData(Ct.clientCall.callId),Ct.success={state:"complete"},Jn.createEvent({eventType:"onFileSended",callId:Ct.callId,remoteId:Ct.remoteId}),Ct.callbacks.success(Ct.success),this.onHangup(Ct.callId)}return null},this.setVideoBandwidth=function(nt,Ct,yt){if(typeof nt=="number"){var Pt=!1,Et=!1;if(Ct==="overall"?yt==="incoming"?nt>0?(this.videoBandwidthSettings.overallIncoming=nt,Pt=!0):(delete this.videoBandwidthSettings.overallIncoming,Pt=!0):yt==="outgoing"&&(nt>0?(this.videoBandwidthSettings.overallOutgoing=nt,Pt=!0,Et=!0):(delete this.videoBandwidthSettings.overallOutgoing,Pt=!0,Et=!0)):Ct==="perCall"?yt==="incoming"?nt>0?(this.videoBandwidthSettings.perCallIncoming=nt,Pt=!0):(delete this.videoBandwidthSettings.perCallIncoming,Pt=!0):yt==="outgoing"&&(nt>0?(this.videoBandwidthSettings.perCallOutgoing=nt,Pt=!0,Et=!0):(delete this.videoBandwidthSettings.perCallOutgoing,Pt=!0,Et=!0)):Ct==="remote"&&(this.videoRemoteBandwidth=nt),Pt)for(var Ut=this.MCUClient.sessionMCUs.length;--Ut>=0;){var Ot={type:"info",infoType:"setVideoBandwidthSettings",data:{clientId:this.clientId,roomId:this.MCUClient.sessionMCUs[Ut].roomName,pubSub:this.MCUClient.pubConnector,videoBandwidthSettings:this.videoBandwidthSettings}},Bt=JSON.stringify(Ot);cn.log("C->S: "+Bt),apiCC.session.channel.socket.emit("info",Bt)}Et&&this.evalOutgoingVideoBandwithCap()}else cn.error("Unvalid target bandwidth usage value needs to be a number :",nt)},this.setAudioBandwidth=function(nt){this.audioBandwidth=nt},this.setDataBandwidth=function(nt){this.dataBandwidth=nt},this.processCheckCallStatus=function(nt){this.MCUClient.processCheckCallStatus(nt);var Ct={type:"updateCallStatus",clientId:this.clientId,data:{}};nt.data.pubSub&&(Ct.data.pubSub=nt.data.pubSub),Ct.sessions=[];for(var yt=0;yt<this.MCUClient.sessionMCUs.length;yt+=1)Ct.sessions.push(this.MCUClient.createSessionDescriptor(this.MCUClient.sessionMCUs[yt]));Ct.calls=[];for(var Pt=0;Pt<this.userMediaTable.length;Pt+=1){var Et=this.userMediaTable[Pt];Ct.calls.push({callId:Et.userMediaId,callType:Et.callType,remoteId:Et.remoteId,roomId:Et.roomId,data:Et.data,meshPublish:!0})}for(var Ut=0;Ut<this.callsTable.length;Ut+=1){var Ot=this.callsTable[Ut];Ct.calls.push({callId:Ot.callId,callType:Ot.callType,remoteId:Ot.remoteId,roomId:Ot.roomId,data:Ot.data,remoteStream:Ot.mcuRemoteStream})}var Bt=JSON.stringify(Ct);apiCC.session.channel.socket.emit("updateCallStatus",Bt)},this.processRemoteStreamAdded=function(nt,Ct){if(nt.sessionMCU&&nt.sessionMCU.modeChangeKind==="new"){cn.debug("processRemoteStreamAdded",nt);var yt=this.MCUClient.getSessionMCU(null,{callback:function(Et){return Et.roomName===nt.sessionMCU.roomName&&Et.modeChangeKind==="old"}});if(!yt)return void cn.error("wrong roomId: no such old session");cn.debug("oldSessionMCU",yt);for(var Pt=this.callsTable.length;--Pt>=0;)if(this.callsTable[Pt].sessionMCU===yt&&(0,st.ki)(this.callsTable[Pt],["mcuRemoteStream","attributes","callId"],"string")&&this.callsTable[Pt].mcuRemoteStream.attributes.callId===nt.mcuRemoteStream.attributes.callId){cn.debug("processRemoteStreamAdded: bye",this.callsTable[Pt]),this.removeCallFromTableWithCallIdAndSendBye(this.callsTable[Pt].callId);break}}},this.processDistantCallEstablished=function(nt){if(cn.debug("processDistantCallEstablished",nt),(0,st.ki)(nt,["descriptor","callFeed","callId"],"string"))if(nt.descriptor.callFeed.clientId===this.clientId){var Ct=null;if(nt.descriptor.callMode==="mesh"?Ct=this.MCUClient.getSessionMCU(null,{callback:function(An){return An.roomName===nt.descriptor.roomId&&An.roomMode==="mesh"}}):nt.descriptor.callMode==="sfu"&&(Ct=this.MCUClient.getSessionMCU(null,{callback:function(An){return An.roomName===nt.descriptor.roomId&&!An.hasOwnProperty("roomMode")}})),Ct){cn.debug("sessionMCU",Ct);var yt=null,Pt=null;if(nt.descriptor.callMode==="mesh"?(yt=this.findUserMediaById(nt.descriptor.callFeed.callId),cn.debug("userMedia",yt)):(Pt=this.findCallWithCallId(nt.descriptor.callFeed.callId),cn.debug("call",Pt)),nt.active){if(!yt&&!Pt)return void cn.debug("wrong callId: no such call");for(var Et=this.MCUClient.distantCalls.length;--Et>=0&&(this.MCUClient.distantCalls[Et].roomId!==nt.descriptor.roomId||this.MCUClient.distantCalls[Et].clientId!==nt.descriptor.clientId||this.MCUClient.distantCalls[Et].callId!==nt.descriptor.callId););if(Et>=0){if(!this.MCUClient.distantCalls[Et].early)return void cn.debug("processDistantCallEstablished: descriptor already exists");cn.debug("processDistantCallEstablished: replace early descriptor",this.MCUClient.distantCalls[Et],nt.descriptor),this.MCUClient.distantCalls[Et]=nt.descriptor}else cn.debug("processDistantCallEstablished: add descriptor",nt.descriptor),this.MCUClient.distantCalls.push(nt.descriptor)}else if(Ct.modeChangeKind==="old"){for(var Ut=this.MCUClient.distantCalls.length;--Ut>=0;)if(this.MCUClient.distantCalls[Ut].roomId===nt.descriptor.roomId&&this.MCUClient.distantCalls[Ut].clientId===nt.descriptor.clientId&&this.MCUClient.distantCalls[Ut].callId===nt.descriptor.callId){cn.debug("processDistantCallEstablished: set descriptor to removed",this.MCUClient.distantCalls[Ut]),this.MCUClient.distantCalls[Ut].removed=!0;break}}else for(var Ot=this.MCUClient.distantCalls.length;--Ot>=0;)if(this.MCUClient.distantCalls[Ot].roomId===nt.descriptor.roomId&&this.MCUClient.distantCalls[Ot].clientId===nt.descriptor.clientId&&this.MCUClient.distantCalls[Ot].callId===nt.descriptor.callId){cn.debug("processDistantCallEstablished: remove descriptor",this.MCUClient.distantCalls[Ot]),this.MCUClient.distantCalls.splice(Ot,1);break}if(Ct.modeChangeKind==="new"){var Bt=this.MCUClient.getSessionMCU(null,{callback:function(An){return An.roomName===nt.descriptor.roomId&&An.modeChangeKind==="old"}});if(!Bt)return void cn.error("wrong roomId: no such old session");cn.debug("oldSessionMCU",Bt),cn.debug("processDistantCallEstablished: replacement");for(var Qt=!1,en=this.userMediaTable.length;--en>=0;){var Jt=this.userMediaTable[en];if(Jt.sessionMCU===Bt){var an=!1,hn=0;cn.debug("processDistantCallEstablished: userMedia",Jt);for(var rn=Jt.distantCalls.length;--rn>=0;)Jt.distantCalls[rn].replaced?hn+=1:Jt.distantCalls[rn].callFeed.callId===nt.descriptor.callFeed.callId&&(cn.debug("processDistantCallEstablished: distantCall",Jt.distantCalls[rn]),an=!0,Jt.distantCalls[rn].replaced=!0,hn+=1);if(an){if(hn===Jt.distantCalls.length){cn.debug("processDistantCallEstablished: remove replaced distant call descriptors");for(var dn=this.MCUClient.distantCalls.length;--dn>=0;)this.MCUClient.distantCalls[dn].callMode==="mesh"&&this.MCUClient.distantCalls[dn].callFeed.callId===Jt.userMediaId&&this.MCUClient.distantCalls[dn].replaced&&(cn.debug("processDistantCallEstablished: remove distantCall",this.MCUClient.distantCalls[dn]),this.MCUClient.distantCalls.splice(dn,1));cn.debug("processDistantCallEstablished: close old calls");for(var Sn=this.callsTable.slice(),wn=Sn.length;--wn>=0;)(0,st.ki)(Sn[wn].data,"mesh","object")&&Sn[wn].data.mesh.calleeCallId===Jt.userMediaId&&Sn[wn].settingUpType!=="subscribe"&&this.removeCallFromTableWithCallIdAndSendBye(Sn[wn].callId);this.MCUClient.meshOnHangup(Jt.userMediaId),Qt=!0}break}}}Qt&&this.finalizeMeshToJanusTransition(Bt,Ct)}}else cn.debug("wrong roomId: no such session")}else cn.debug("wrong clientId: message not intended for self");else cn.debug("wrong format: missing callFeed")},this.finalizeMeshToJanusTransition=function(nt,Ct){var yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};cn.debug("finalizeMeshToJanusTransition");var Pt=0,Et=0;if(yt.force===!0){for(var Ut=this.callsTable.slice(),Ot=Ut.length;--Ot>=0;){var Bt=Ut[Ot];Bt.sessionMCU===nt&&((Bt.settingUpType==="publish"||Bt.settingUpType==="shareScreen")&&Bt.data&&Bt.data.mesh?this.onHangup(Bt.callId):this.onHangup(Bt.callId,"disconnected"))}for(var Qt=this.userMediaTable.slice(),en=Qt.length;--en>=0;){var Jt=Qt[en];Jt.sessionMCU===nt&&this.onHangup(Jt.userMediaId,"disconnected")}}else for(var an=this.userMediaTable.length;--an>=0;){var hn=this.userMediaTable[an];if(hn.sessionMCU===nt){Pt+=1;for(var rn=0,dn=hn.distantCalls.length;--dn>=0;)cn.debug("finalizeMeshToJanusTransition: distantCall",hn.distantCalls[dn]),hn.distantCalls[dn].replaced&&(rn+=1);rn===hn.distantCalls.length&&(Et+=1)}}Pt===Et&&(cn.debug("finalizeMeshToJanusTransition: finalize transition"),Ct.transitionTimeoutId&&(clearTimeout(Ct.transitionTimeoutId),delete Ct.transitionTimeoutId),this.MCUClient.removeSessionMCU(nt),delete Ct.modeChangeKind,this.MCUClient.transitionCount-=1,this.MCUClient.transitionCount<=0&&this.evalOutgoingVideoBandwithCap(),Jn.createMCURoomModeChangedEvent(Ct.roomName,"mesh","sfu","complete"))},this.processConfigureEncodings=function(nt){var Ct=this.findCallWithCallId(nt.callId);if(Ct&&Object.prototype.hasOwnProperty.call(nt,"command")&&Ct.simulcast==="RID"){var yt={};Object.prototype.hasOwnProperty.call(nt,"maxBitrate")&&(yt.maxBitrate=nt.maxBitrate),Ct.configureSimulcastEncodings(nt.command,yt)}},this.processSimulcastFeedChanged=function(nt){var Ct=this.findCallWithCallId(nt.callId);if(Ct){var yt={};nt.substream===2?yt.streamQuality="high":nt.substream===1?yt.streamQuality="medium":nt.substream===0&&(yt.streamQuality="low"),nt.temporal===2?yt.streamFrameRate="high":nt.temporal===1?yt.streamFrameRate="medium":nt.temporal===0&&(yt.streamFrameRate="low"),Object.keys(yt).length>0&&Jn.createSimulcastFeedChanged(Ct.callId,yt)}},this.hasReceiptHook=function(nt){if(!nt||typeof nt!="string")throw new Error("wrong receiptId");return Object.prototype.hasOwnProperty.call(this.receiptHooks,nt)},this.createReceiptHook=function(nt,Ct){var yt=this;if(this.hasReceiptHook(nt))throw new Error("receiptHook already exists");if(!Ct||Ct.fulfilled!==!1)throw new Error("wrong future");Ct.onFulfillment(function(){delete yt.receiptHooks[nt]}),this.receiptHooks[nt]=Ct},this.finalizeReceiptHookFailure=function(nt,Ct){if(cn.debug("finalizeReceiptHookFailure",nt,Ct),!nt||typeof nt!="string")throw new Error("wrong receiptId");if(!Object.prototype.hasOwnProperty.call(this.receiptHooks,nt))throw new Error("receiptHook does not exist");this.receiptHooks[nt].fulfill(Ct)},this.finalizeReceiptHookSuccess=function(nt,Ct){if(cn.debug("finalizeReceiptHookSuccess",nt,Ct),!nt||typeof nt!="string")throw new Error("wrong receiptId");if(!Object.prototype.hasOwnProperty.call(this.receiptHooks,nt))throw new Error("receiptHook does not exist");this.receiptHooks[nt].fulfill(null,Ct)},this.processReceipt=function(nt){if(nt&&tr(nt)==="object"){var Ct=nt.receiptId,yt=nt.result;if(Ct&&typeof Ct=="string")try{this.finalizeReceiptHookSuccess(Ct,yt)}catch(Pt){cn.debug("processReceipt: finalizeReceiptHookSuccess",Pt)}else cn.warn("processReceipt: wrong receiptId")}else cn.warn("processReceipt: wrong msg")},this.processError=function(nt){var Ct=nt.receiptId,yt=nt.errorInfo,Pt=nt.errorCode,Et=nt.callId,Ut=nt.roomId,Ot=nt.convId;if(Ct&&typeof Ct=="string")try{this.finalizeReceiptHookFailure(Ct,new Error(yt))}catch(Bt){cn.debug("processError: finalizeReceiptHookFailure",Bt)}Jn.createErrorEvent(yt,Pt,Et,Ut,null,null,Ot)},this.createCallControl=function(nt){var Ct=new dr(nt);return this.callControlTable.push(Ct),Ct},this.destroyCallControl=function(nt){if(nt.multi){if(!nt.roomName)return cn.warn("findCallControl: cannot destroy without roomName"),null;for(var Ct=[],yt=this.callControlTable.length;--yt>=0;)this.callControlTable[yt].roomName===nt.roomName&&(Ct.push(this.callControlTable[yt]),this.callControlTable.splice(yt,1));return Ct}var Pt=this.findCallControl(nt,{accept:"index"});if(Pt!==null&&Pt>=0){var Et=this.callControlTable[Pt];return this.callControlTable.splice(Pt,1),Et}return null},this.findCallControl=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt=Ct.accept==="index";if(nt.type==="publish"||nt.type==="shareScreen"){if(!nt.callId)return cn.warn("findCallControl: cannot search without callId"),null;for(var Pt=null,Et=null,Ut=this.callControlTable.length;--Ut>=0;)if((this.callControlTable[Ut].type==="publish"||this.callControlTable[Ut].type==="shareScreen")&&this.callControlTable[Ut].callId===nt.callId){Pt=this.callControlTable[Ut],Et=Ut;break}return Pt?yt?Et:Pt:null}if(nt.type==="subscribe"){if(!(0,st.ki)(nt,"stream","object")||!Object.prototype.hasOwnProperty.call(nt.stream,"id")||!(0,st.ki)(nt.stream,"attributes","object"))return cn.warn("findCallControl: cannot search without stream"),null;for(var Ot=null,Bt=null,Qt=this.callControlTable.length;--Qt>=0;)if(this.callControlTable[Qt].type==="subscribe"&&(this.callControlTable[Qt].stream.id===nt.stream.id||this.callControlTable[Qt].stream.attributes.callerId===nt.stream.attributes.callerId&&this.callControlTable[Qt].stream.attributes.callId===nt.stream.attributes.callId)){Ot=this.callControlTable[Qt],Bt=Qt;break}return Ot?yt?Bt:Ot:null}return cn.warn("findCallControl: wrong type",nt.type),null},this.getCallControls=function(nt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},yt={};if(Ct.addUserMedia)for(var Pt=this.userMediaTable.length;--Pt>=0;){var Et=this.userMediaTable[Pt];yt[Et.userMediaId]=Et}if(nt){for(var Ut=this.callControlTable.length;--Ut>=0;){var Ot=this.callControlTable[Ut];nt.indexOf(Ot.type)>=0&&(yt[Ot.callId]=Ot)}return yt}for(var Bt=this.callControlTable.length;--Bt>=0;){var Qt=this.callControlTable[Bt];yt[Qt.callId]=Qt}return yt},this.getCallIds=function(nt){for(var Ct=[],yt=this.callControlTable.length;--yt>=0;){var Pt=this.callControlTable[yt];nt.indexOf(Pt.type)>=0&&Ct.push(Pt.callId)}return Ct},this.evalOutgoingVideoBandwithCap=function(nt){if(cn.debug("evalOutgoingVideoBandwithCap"),!(this.MCUClient.transitionCount>0)){var Ct=null;this.videoBandwidthSettings.perCallOutgoing&&(Ct=this.videoBandwidthSettings.perCallOutgoing);for(var yt=[],Pt=this.callsTable.length;--Pt>=0;)this.callsTable[Pt].belongsToRoom()&&this.callsTable[Pt].settingUpType!=="publish"&&this.callsTable[Pt].settingUpType!=="shareScreen"||this.callsTable[Pt].localCallProfile&&this.callsTable[Pt].localCallProfile.video&&this.callsTable[Pt].localCallProfile.videoActive&&yt.push(this.callsTable[Pt]);if(yt.length===0)return Ct;if(this.videoBandwidthSettings.overallOutgoing){var Et=Math.floor(this.videoBandwidthSettings.overallOutgoing/yt.length);Ct=Ct?Math.min(Ct,Et):Et}for(var Ut=yt.length;--Ut>=0;)nt&&yt[Ut]===nt?Ct&&yt[Ut].videoCap!==Ct?(yt[Ut].videoCap=Ct,this.rtpSenderSetParamatersCapable&&yt[Ut].applyOutgoingBitrate(yt[Ut].videoCap)):!Ct&&yt[Ut].videoCap&&(delete yt[Ut].videoCap,this.rtpSenderSetParamatersCapable&&yt[Ut].applyOutgoingBitrate(null)):Ct&&yt[Ut].videoCap!==Ct?(yt[Ut].videoCap=Ct,this.rtpSenderSetParamatersCapable?yt[Ut].applyOutgoingBitrate(yt[Ut].videoCap):setTimeout(function(Ot){Ot.belongsToRoom()||!Ot.callee?(Ot.updateUserMedia=!0,Ot.establishCall()):cn.debug("Call is not to be updated")},0,yt[Ut])):!Ct&&yt[Ut].videoCap&&(delete yt[Ut].videoCap,this.rtpSenderSetParamatersCapable?yt[Ut].applyOutgoingBitrate(null):setTimeout(function(Ot){Ot.belongsToRoom()||!Ot.callee?(Ot.updateUserMedia=!0,Ot.establishCall()):cn.debug("Call is not to be updated")},0,yt[Ut]));return Ct}cn.debug("evalOutgoingVideoBandwithCap - transition ongoing")},this.callback=function(nt,Ct){return this.closureHandler=function(yt){return nt[Ct](yt)},this.closureHandler},this.callbackWithParams=function(nt,Ct){return this.closureHandler=function(yt,Pt,Et){return nt[Ct](yt,Pt,Et)},this.closureHandler},this.simulatedAgentLaunchWaitingCall=function(){this.socket.emit("simulatedAgentLaunchWaitingCall",{type:"simulatedAgentLaunchWaitingCall"})}},Bn=(s(2707),et.Y.get("PreCallTest")),rr=125e3,nr=2e4,Nn=apiCC.myWebRTC_Event,Wn=function(Gt,Tt,nt,Ct,yt){var Pt=this;this.webRTCClient=Gt.webRTCClient,this.notifyTerminated=Gt.notifyTerminated,this.audioSourceId=Ct,this.videoSourceId=yt,this.testId="initial",this.stepId="initial",this.report={tests:[],resolutions:[],failurCause:""},this.maxHeight=240,this.maxWidth=320,this.resolutions=[[320,240,"QVGA"],[640,480,"VGA"],[1024,576,"SD"],[1280,720,"HD 720p"],[1920,1080,"HD 1080p"]],this.currentResolution=0,this.userMediastreamId=null,nt==="simpleVideoRecordTest"&&(Bn.warn("Simple video record test is activated"),this.simpleVideoRecordTest=!0),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshModeEnabled===!0&&(Bn.debug("Forcing meshModeEnabled to false for precall test"),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshModeEnabled=!1,this.modifyMeshModeEnabledValueBeforePreCall=!0),this.generateId=function(Et){for(var Ut="",Ot="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Bt=0;Bt<Et;Bt+=1)Ut+=Ot.charAt(Math.floor(Math.random()*Ot.length));return Ut},this.generateRoomId=function(){return"PC-"+this.generateId(4)+"-"+this.generateId(4)+"-"+this.generateId(4)},this.pushStats=function(Et,Ut){return Et.data.push(Ut),!0},this.evalQuartiles=function(Et,Ut,Ot){var Bt=[];if(Ot===void 0?Et.forEach(function(qr){typeof qr[Ut]=="number"&&Bt.push(qr[Ut])}):Et.forEach(function(qr){Bt.push(Ot(qr[Ut]))}),Bt.sort(function(qr,Qr){return qr<Qr?-1:qr===Qr?0:1}),Bt.length%2==0){var Qt=Bt.length/2,en=Math.floor((Bt[Qt-1]+Bt[Qt])/2);if(Qt%2==0){var Jt=Qt/2,an=Math.floor((Bt[Jt-1]+Bt[Jt])/2),hn=Qt+Jt,rn=Math.floor((Bt[hn-1]+Bt[hn])/2);return{min:Bt[0],firstQuartile:an,median:en,thirdQuartile:rn,max:Bt[Bt.length-1]}}var dn=Math.floor(Qt/2),Sn=Bt[dn],wn=Bt[Qt+dn];return{min:Bt[0],firstQuartile:Sn,median:en,thirdQuartile:wn,max:Bt[Bt.length-1]}}var An=Math.floor(Bt.length/2),_n=Bt[An];if((An+1)%2==0){var jn=(An+1)/2,ar=Math.floor((Bt[jn-1]+Bt[jn])/2),fr=An+jn,Cr=Math.floor((Bt[fr-1]+Bt[fr])/2);return{min:Bt[0],firstQuartile:ar,median:_n,thirdQuartile:Cr,max:Bt[Bt.length-1]}}var gr=Math.floor(An/2),Er=Bt[gr],Nr=Bt[An+gr];return{min:Bt[0],firstQuartile:Er,median:_n,thirdQuartile:Nr,max:Bt[Bt.length-1]}},this.runBitRateTest=function(){apiCC.webRTCCompliant?(Bn.debug("Run bitrate test"),this.testId==="initial"&&(this.handlers=[{type:"joinMCUSessionAnswer",callback:this.handleJoinMCUSessionAnswer.bind(this)},{type:"MCUAvailableStream",callback:this.handleMCUAvailableStream.bind(this)},{type:"onCallStatsUpdate",callback:this.handleOnCallStatsUpdate.bind(this)},{type:"remoteStreamAdded",callback:this.handleRemoteStreamAdded.bind(this)},{type:"userMediaSuccess",callback:this.handleuserMediaSuccess.bind(this)},{type:"MCURecordedStreamsAvailable",callback:this.handleRecordingStreamAvailable.bind(this)}],this.handlers.forEach(function(Et){apiRTC.addEventListener(Et.type,Et.callback)}),this.webRTCClient.setMCUConnector("mcu4.apizee.com"),this.webRTCClient.setAllowMultipleCalls(!0),this.webRTCClient.enableCallStatsMonitoring(!0,1e3),this.webRTCClient.enableQualityEvaluating(!0,1e3),this.startNextTest())):(this.report.failurCause="Your device is not WebRTC Compliant",this.terminate())},this.startNextTest=function(){if(this.simpleVideoRecordTest===!0)this.testId==="initial"?(Bn.debug("initial simple test"),Tt?this.runResolutionTest():this.startTestAudioNlVideo(2e3)):this.testId==="resolution-test"?(Bn.debug("resolution-test simple"),this.startTestAudioNlVideo(2e3)):this.testId==="audio-and-video-2000"&&(Bn.debug("Before recordThenTerminate simple"),this.recordThenTerminate());else if(this.testId==="initial")Tt?this.runResolutionTest():this.startTestAudioNlVideo(nt);else if(this.testId==="resolution-test")this.startTestAudioNlVideo(nt);else if(this.testId==="audio-and-video-"+nt)if(this.report[this.testId].status==="success"){var Et=this.report[this.testId].subscribeCallIds[0],Ut=this.stats[Et].videoReceived;Ut.bitsReceivedPerSecond.max!==void 0&&Ut.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():Ut.bitsReceivedPerSecond.max>=15e5?this.startTestAudioNlVideo(1500):Ut.bitsReceivedPerSecond.max>=1e6?this.startTestAudioNlVideo(1e3):Ut.bitsReceivedPerSecond.max>=6e5?this.startTestAudioNlVideo(600):Ut.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-1500")if(this.report[this.testId].status==="success"){var Ot=this.report[this.testId].subscribeCallIds[0],Bt=this.stats[Ot].videoReceived;Bt.bitsReceivedPerSecond.max!==void 0&&Bt.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():Bt.bitsReceivedPerSecond.max>=1e6?this.startTestAudioNlVideo(1e3):Bt.bitsReceivedPerSecond.max>=6e5?this.startTestAudioNlVideo(600):Bt.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-1000")if(this.report[this.testId].status==="success"){var Qt=this.report[this.testId].subscribeCallIds[0],en=this.stats[Qt].videoReceived;en.bitsReceivedPerSecond.max!==void 0&&en.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():en.bitsReceivedPerSecond.max>=6e5?this.startTestAudioNlVideo(600):en.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-600")if(this.report[this.testId].status==="success"){var Jt=this.report[this.testId].subscribeCallIds[0],an=this.stats[Jt].videoReceived;an.bitsReceivedPerSecond.max!==void 0&&an.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():an.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-250")if(this.report[this.testId].status==="success"){var hn=this.report[this.testId].subscribeCallIds[0],rn=this.stats[hn].videoReceived;rn.bitsReceivedPerSecond.max!==void 0&&rn.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else this.recordThenTerminate()},this.startTestAudioNlVideo=function(Et){this.prepareEnvForNewTest(),Bn.debug("%ctestAudioNlVideo"+Et),this.testId="audio-and-video-"+Et,this.report.tests.push(this.testId),this.audioEnabled=!0,this.videoEnabled=!0,this.videoBandwidth=Et,this.webRTCClient.setRemoteVideoBandwidth(this.videoBandwidth),this.stats={},this.report[this.testId]={audioEnabled:!0,audioLimited:!1,videoEnabled:!0,videoLimited:!0,videoBandwidth:this.videoBandwidth,stats:this.stats},this.mcuSession={},this.mcuSession.roomId=this.generateRoomId(),this.report[this.testId].roomId=this.mcuSession.roomId,this.webRTCClient.joinMCUSession(this.mcuSession.roomId),this.stepId="joining-mcu-session",this.timeoutId=setTimeout(this.abortJoinMCUSession.bind(this),nr)},this.startTestAudioNlOnly=function(){this.prepareEnvForNewTest(),Bn.debug("%cstartTestAudioNlOnly"),this.testId="audio-only",this.report.tests.push(this.testId),this.audioEnabled=!0,this.videoEnabled=!1,this.webRTCClient.setRemoteVideoBandwidth(null),this.stats={},this.report[this.testId]={audioEnabled:!0,audioLimited:!1,videoEnabled:!1,stats:this.stats},this.mcuSession={},this.mcuSession.roomId=this.generateRoomId(),this.report[this.testId].roomId=this.mcuSession.roomId,this.webRTCClient.joinMCUSession(this.mcuSession.roomId),this.stepId="joining-mcu-session",this.timeoutId=setTimeout(this.abortJoinMCUSession.bind(this),nr)},this.startTestVideoNlOnly=function(){this.prepareEnvForNewTest(),Bn.debug("%cstartTestVideoNlOnly"),this.testId="video-only",this.report.tests.push(this.testId),this.audioEnabled=!1,this.videoEnabled=!0,this.videoBandwidth=600,this.webRTCClient.setRemoteVideoBandwidth(this.videoBandwidth),this.stats={},this.report[this.testId]={audioEnabled:!1,audioLimited:!1,videoEnabled:!0,stats:this.stats},this.mcuSession={},this.mcuSession.roomId=this.generateRoomId(),this.report[this.testId].roomId=this.mcuSession.roomId,this.webRTCClient.joinMCUSession(this.mcuSession.roomId),this.stepId="joining-mcu-session",this.timeoutId=setTimeout(this.abortJoinMCUSession.bind(this),nr)},this.recordThenTerminate=function(){Pt.modifyMeshModeEnabledValueBeforePreCall===!0&&(Bn.debug("Restoring meshModeEnabled to true, as it was modified for precall test"),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshModeEnabled=!0);var Et=null;if(Pt.videoEnabled&&Pt.audioEnabled?Et="AUDIO-VIDEO":Pt.audioEnabled?Et="AUDIO-ONLY":Pt.videoEnabled&&(Et="VIDEO-ONLY"),!Et)return Bn.error("Can't define record type"),void Pt.terminate();Bn.debug("Start recording with type:",Et),Pt.webRTCClient.startRecording(Et,"recordPreCall",null,null,{ttl:900}),setTimeout(function(){Bn.debug("Stop recording"),Pt.webRTCClient.stopRecording()},1e4)},this.terminate=function(){Bn.debug("Terminate"),this.testId="terminated",this.handlers&&this.handlers.forEach(function(Et){apiRTC.removeEventListener(Et.type,Et.callback)}),this.notifyTerminated(this.report),this.leaveSession()},this.succeed=function(){Nn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"success",stepId:this.stepId}),this.report[this.testId].status="success",this.startNextTest()},this.fail=function(){Bn.debug("fail"),Nn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"failure",stepId:this.stepId}),this.report[this.testId].status="failure",this.report[this.testId].stepId=this.stepId,this.leaveSession(),this.startNextTest()},this.prepareEnvForNewTest=function(){Pt.mcuSession!==void 0&&Pt.leaveSession()},this.abortJoinMCUSession=function(){Bn.debug("abortJoinMCUSession"),this.fail()},this.abortStreamPublishing=function(){Bn.debug("abortStreamPublishing"),this.fail()},this.abortStreamSubscribing=function(){Bn.debug("abortStreamSubscribing"),this.fail()},this.observeStreamPublished=function(){if(Bn.debug("observeStreamPublished"),apiRTC.browser==="Safari"||apiRTC.browser==="Mobile Safari")return Bn.info("Safari"),Bn.error("observeStreamPublished not supported on Safari"),clearInterval(this.intervalId),void this.fail();if(this.intervalCounter+=1,this.intervalCounter>30)return clearInterval(this.intervalId),void this.fail();if(this.audioEnabled&&this.videoEnabled){var Et=0;if(this.stats[this.publishCallId]!==void 0&&(this.stats[this.publishCallId].audioSent!==void 0&&this.stats[this.publishCallId].audioSent.bitsSentPerSecond!==void 0&&this.stats[this.publishCallId].audioSent.bitsSentPerSecond.thirdQuartile>=2e4&&(Et+=1),this.stats[this.publishCallId].videoSent!==void 0&&this.stats[this.publishCallId].videoSent.bitsSentPerSecond!==void 0&&this.stats[this.publishCallId].videoSent.bitsSentPerSecond.thirdQuartile>=rr&&(Et+=1)),Et===2){clearInterval(this.intervalId);var Ut=this.streams[0];this.subscribeToUserStream(Ut.attributes.callerId,Ut.id,"VIDEO"),this.stepId="stream-subscribing",this.timeoutId=setTimeout(this.abortStreamSubscribing.bind(this),nr)}else Bn.debug("okCnt !== 2")}else if(this.audioEnabled)if(this.stats[this.publishCallId]!==void 0)if(this.stats[this.publishCallId].audioSent!==void 0&&this.stats[this.publishCallId].audioSent.bitsSentPerSecond!==void 0)if(this.stats[this.publishCallId].audioSent.bitsSentPerSecond.thirdQuartile>=2e4){clearInterval(this.intervalId);var Ot=this.streams[0];this.subscribeToUserStream(Ot.attributes.callerId,Ot.id,"AUDIOONLY"),this.stepId="stream-subscribing",this.timeoutId=setTimeout(this.abortStreamSubscribing.bind(this),nr)}else Bn.debug("no stats audio 1 ");else Bn.debug("no stats audio 2");else Bn.debug("no stats audio 3");else if(this.videoEnabled)if(this.stats[this.publishCallId]!==void 0)if(this.stats[this.publishCallId].videoSent!==void 0&&this.stats[this.publishCallId].videoSent.bitsSentPerSecond!==void 0)if(this.stats[this.publishCallId].videoSent.bitsSentPerSecond.thirdQuartile>=rr){clearInterval(this.intervalId);var Bt=this.streams[0];this.subscribeToUserStream(Bt.attributes.callerId,Bt.id,"VIDEOONLY"),this.stepId="stream-subscribing",this.timeoutId=setTimeout(this.abortStreamSubscribing.bind(this),nr)}else Bn.debug("no stats video 1 ");else Bn.debug("no stats video 2");else Bn.debug("no stats video 3");else Bn.debug("no audio or video"),clearInterval(this.intervalId),this.fail()},this.observeStreamSubscribed=function(){if(this.intervalCounter+=1,this.intervalCounter>30)return clearInterval(this.intervalId),void this.succeed();var Et=null,Ut=null,Ot=0,Bt=0;this.audioEnabled&&(Et=this.stats[this.publishCallId].audioSent),this.videoEnabled&&(Ut=this.stats[this.publishCallId].videoSent);for(var Qt=0;Qt<this.subscribeCallIds.length;Qt+=1){var en=this.subscribeCallIds[Qt];if(this.audioEnabled&&this.videoEnabled){var Jt=0;this.stats[en]!==void 0&&(this.stats[en].audioReceived!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond!==void 0&&Et!=null&&Et.bitsSentPerSecond!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond.thirdQuartile>=Et.bitsSentPerSecond.firstQuartile-2e3&&(Jt+=1),this.stats[en].videoReceived!==void 0&&this.stats[en].videoReceived.bitsReceivedPerSecond!==void 0&&Ut!=null&&Ut.bitsSentPerSecond!==void 0&&this.stats[en].videoReceived.bitsReceivedPerSecond.thirdQuartile>=Ut.bitsSentPerSecond.firstQuartile&&(Jt+=1)),Jt===2&&(Ot+=1)}else this.audioEnabled?this.stats[en]!==void 0&&this.stats[en].audioReceived!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond!==void 0&&Et!=null&&Et.bitsSentPerSecond!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond.thirdQuartile>=Et.bitsSentPerSecond.firstQuartile&&(Ot+=1):Bt+=1}Bt>0?(clearInterval(this.intervalId),this.fail()):Ot===this.subscribeCallIds.length&&(clearInterval(this.intervalId),this.succeed())},this.handleJoinMCUSessionAnswer=function(Et){if(this.stepId==="joining-mcu-session"){if(Nn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"start",stepId:this.stepId}),clearTimeout(this.timeoutId),this.mcuSession.sessionId=Et.detail.sessionId,this.mcuSession.token=Et.detail.token,this.audioEnabled&&this.videoEnabled){var Ut=this,Ot={audio:{},video:{}};Ot=apiCC.setResolutionInConstraint(this.maxWidth,this.maxHeight,Ot),Bn.debug("constraints :",Ot),apiRTC.createUserMediaStream({type:"media",audioSourceId:this.audioSourceId,videoSourceId:this.videoSourceId,gum_config:Ot,release:function(Bt){Bn.debug("createUserMediaStream release",Bt.userMediaStreamId)},success:function(Bt){Bn.debug("createUserMediaStream success",Bt.userMediaStreamId),Bn.debug("audioSourceId",Ct),Bn.debug("videoSourceId",yt)},failure:function(Bt,Qt){Bn.error("createUserMediaStream failure",Bt.userMediaStreamId),Bn.error("failure; userMediaStreamId: "+Bt.userMediaStreamId),Bn.error("failure; error: "+Qt),Nn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"failure",stepId:this.stepId,createUserMediaStreamError:Qt}),Ut.terminate()}})}else if(this.audioEnabled)this.publishCallId=this.webRTCClient.publish(this.mcuSession.roomId,this.mcuSession.sessionId,this.mcuSession.token,{audioOnly:!0});else{if(!this.videoEnabled)return void this.fail();this.publishCallId=this.webRTCClient.publish(this.mcuSession.roomId,this.mcuSession.sessionId,this.mcuSession.token,{videoOnly:!0,qos:{videoStartQuality:"upper"}})}this.subscribeCallIds=[],this.report[this.testId].publishCallId=this.publishCallId,this.report[this.testId].subscribeCallIds=[],this.streams=[],this.stepId="stream-publishing",this.timeoutId=setTimeout(this.abortStreamPublishing.bind(this),nr)}},this.handleuserMediaSuccess=function(Et){var Ut={userMediaStreamId:Et.detail.userMediaStreamId,qos:{videoStartQuality:"upper"}};this.userMediastreamId=Et.detail.userMediaStreamId,this.publishCallId=this.webRTCClient.publish(this.mcuSession.roomId,this.mcuSession.sessionId,this.mcuSession.token,Ut),this.report[this.testId].publishCallId=this.publishCallId},this.handleRecordingStreamAvailable=function(Et){Bn.debug("handleRecordingStreamAvailable"),this.terminate()},this.handleMCUAvailableStream=function(Et){if(this.stepId==="stream-publishing"&&Et.detail.isRemoteStream===!1)for(var Ut=0;Ut<Et.detail.streams.length;Ut+=1){var Ot=Et.detail.streams[Ut];if(Ot.room===this.mcuSession.roomId&&Ot.attributes.callId===this.publishCallId&&this.stepId==="stream-publishing"){if(clearTimeout(this.timeoutId),this.stepId="stream-published",this.streams.push(Ot),this.simpleVideoRecordTest===!0){var Bt="VIDEO";Ot.audio===!1&&(Bt="VIDEOONLY"),Ot.video===!1&&(Bt="AUDIOONLY"),this.subscribeToUserStream(Ot.attributes.callerId,Ot.id,Bt),this.stepId="stream-subscribing"}else this.intervalId=setInterval(this.observeStreamPublished.bind(this),1e3);this.intervalCounter=0}}},this.handleRemoteStreamAdded=function(Et){this.stepId==="stream-subscribing"&&this.subscribeCallIds.find(function(Ut){return Ut===Et.detail.callId})!==void 0&&(clearTimeout(this.timeoutId),this.stepId="stream-subscribed",this.intervalId=setInterval(this.observeStreamSubscribed.bind(this),1e3),this.intervalCounter=0)},this.handleOnCallStatsUpdate=function(Et){var Ut=this;if(this.stepId!=="stream-published"&&this.stepId!=="stream-subscribing"&&this.stepId!=="stream-subscribed"||(this.stats[this.publishCallId]===void 0&&(this.stats[this.publishCallId]={}),Et.detail.stats.audioSent!==void 0&&(this.stats[this.publishCallId].audioSent===void 0&&(this.stats[this.publishCallId].audioSent={startTime:Et.detail.stats.audioSent.timestamp,data:[]}),this.pushStats(this.stats[this.publishCallId].audioSent,Et.detail.stats.audioSent)?this.stats[this.publishCallId].audioSent.data.length>=5&&["bitsSentPerSecond","packetsSentPerSecond"].forEach(function(en){var Jt=Ut.evalQuartiles(Ut.stats[Ut.publishCallId].audioSent.data,en);Jt.sampleCount=Ut.stats[Ut.publishCallId].audioSent.data.length,Jt.time=Et.detail.stats.audioSent.timestamp-Ut.stats[Ut.publishCallId].audioSent.startTime,Ut.stats[Ut.publishCallId].audioSent[en]=Jt}):Bn.debug("audio stats not pushed for :",this.publishCallId)),Et.detail.stats.videoSent!==void 0&&(this.stats[this.publishCallId].videoSent===void 0&&(this.stats[this.publishCallId].videoSent={startTime:Et.detail.stats.videoSent.timestamp,data:[]}),this.pushStats(this.stats[this.publishCallId].videoSent,Et.detail.stats.videoSent)?this.stats[this.publishCallId].videoSent.data.length>=5&&(["bitsSentPerSecond","packetsSentPerSecond","framesEncodedPerSecond"].forEach(function(en){var Jt=Ut.evalQuartiles(Ut.stats[Ut.publishCallId].videoSent.data,en);Jt.sampleCount=Ut.stats[Ut.publishCallId].videoSent.data.length,Jt.time=Et.detail.stats.videoSent.timestamp-Ut.stats[Ut.publishCallId].videoSent.startTime,Ut.stats[Ut.publishCallId].videoSent[en]=Jt}),this.stats[this.publishCallId].videoSent.width=Et.detail.stats.videoSent.width,this.stats[this.publishCallId].videoSent.height=Et.detail.stats.videoSent.height):Bn.debug("video stats not pushed for :",this.publishCallId))),this.stepId==="stream-subscribed")for(var Ot=function(en){Qt=0;var Jt=Ut.subscribeCallIds[en];Ut.stats[Jt]===void 0&&(Ut.stats[Jt]={}),Et.detail.stats.audioReceived!==void 0&&(Ut.stats[Jt].audioReceived===void 0&&(Ut.stats[Jt].audioReceived={startTime:Et.detail.stats.audioReceived.timestamp,data:[]}),Ut.pushStats(Ut.stats[Jt].audioReceived,Et.detail.stats.audioReceived)?(Qt=Ut.stats[Jt].audioReceived.data.length,Ut.stats[Jt].audioReceived.data[Qt-1].mosS===void 0&&(Ut.stats[Jt].audioReceived.data[Qt-1].mosS={}),Ut.stats[Jt].audioReceived.data[Qt-1].mosS=Et.detail.stats.quality.mosS,Ut.stats[Jt].audioReceived.data.length>=15&&(["bitsReceivedPerSecond","packetsReceivedPerSecond","delay"].forEach(function(an){var hn=Ut.evalQuartiles(Ut.stats[Jt].audioReceived.data,an);hn.sampleCount=Ut.stats[Jt].audioReceived.data.length,hn.time=Et.detail.stats.audioReceived.timestamp-Ut.stats[Jt].audioReceived.startTime,Ut.stats[Jt].audioReceived[an]=hn}),Ut.stats[Jt].audioReceived.data[0].jitter!==void 0&&["jitter"].forEach(function(an){var hn=Ut.evalQuartiles(Ut.stats[Jt].audioReceived.data,an,function(rn){return Math.floor(1e3*rn)});hn.sampleCount=Ut.stats[Jt].audioReceived.data.length,hn.time=Et.detail.stats.audioReceived.timestamp-Ut.stats[Jt].audioReceived.startTime,Ut.stats[Jt].audioReceived[an]=hn}),Ut.stats[Jt].audioReceived.packetsLost={max:Et.detail.stats.audioReceived.packetsLost,sampleCount:Ut.stats[Jt].audioReceived.data.length,time:Et.detail.stats.audioReceived.timestamp-Ut.stats[Jt].audioReceived.startTime},["packetsLostRatio"].forEach(function(an){var hn=Ut.evalQuartiles(Ut.stats[Jt].audioReceived.data,an);hn.sampleCount=Ut.stats[Jt].audioReceived.data.length,hn.time=Et.detail.stats.audioReceived.timestamp-Ut.stats[Jt].audioReceived.startTime,Ut.stats[Jt].audioReceived[an]=hn}),Ut.stats[Jt].audioReceived.mosS===void 0&&(Ut.stats[Jt].audioReceived.mosS={}),["mosS"].forEach(function(an){var hn=Ut.evalQuartiles(Ut.stats[Jt].audioReceived.data,an);hn.sampleCount=Ut.stats[Jt].audioReceived.data.length,Ut.stats[Jt].audioReceived[an]=hn}))):Bn.error("audio stats not pushed for callId :",Jt)),Et.detail.stats.videoReceived!==void 0&&(Ut.stats[Jt].videoReceived===void 0&&(Ut.stats[Jt].videoReceived={startTime:Et.detail.stats.videoReceived.timestamp,data:[]}),Ut.pushStats(Ut.stats[Jt].videoReceived,Et.detail.stats.videoReceived)?(Qt=Ut.stats[Jt].videoReceived.data.length,Ut.stats[Jt].videoReceived.data[Qt-1].mosV===void 0&&(Ut.stats[Jt].videoReceived.data[Qt-1].mosV={}),Ut.stats[Jt].videoReceived.data[Qt-1].mosAV===void 0&&(Ut.stats[Jt].videoReceived.data[Qt-1].mosAV={}),Ut.stats[Jt].videoReceived.data[Qt-1].mosV=Et.detail.stats.quality.mosV,Ut.stats[Jt].videoReceived.data[Qt-1].mosAV=Et.detail.stats.quality.mosAV,Ut.stats[Jt].videoReceived.data.length>=15&&(["bitsReceivedPerSecond","packetsReceivedPerSecond","framesDecodedPerSecond"].forEach(function(an){var hn=Ut.evalQuartiles(Ut.stats[Jt].videoReceived.data,an);hn.sampleCount=Ut.stats[Jt].videoReceived.data.length,hn.time=Et.detail.stats.videoReceived.timestamp-Ut.stats[Jt].videoReceived.startTime,Ut.stats[Jt].videoReceived[an]=hn}),Ut.stats[Jt].videoReceived.data[0].jitter!==void 0&&["jitter"].forEach(function(an){var hn=Ut.evalQuartiles(Ut.stats[Jt].videoReceived.data,an,function(rn){return Math.floor(1e3*rn)});hn.sampleCount=Ut.stats[Jt].videoReceived.data.length,hn.time=Et.detail.stats.videoReceived.timestamp-Ut.stats[Jt].videoReceived.startTime,Ut.stats[Jt].videoReceived[an]=hn}),Ut.stats[Jt].videoReceived.packetsLost={max:Et.detail.stats.videoReceived.packetsLost,sampleCount:Ut.stats[Jt].videoReceived.data.length,time:Et.detail.stats.videoReceived.timestamp-Ut.stats[Jt].videoReceived.startTime},["packetsLostRatio"].forEach(function(an){var hn=Ut.evalQuartiles(Ut.stats[Jt].videoReceived.data,an);hn.sampleCount=Ut.stats[Jt].videoReceived.data.length,hn.time=Et.detail.stats.videoReceived.timestamp-Ut.stats[Jt].videoReceived.startTime,Ut.stats[Jt].videoReceived[an]=hn}),Ut.stats[Jt].videoReceived.mosV===void 0&&(Ut.stats[Jt].videoReceived.mosV={}),["mosV"].forEach(function(an){var hn=Ut.evalQuartiles(Ut.stats[Jt].videoReceived.data,an);hn.sampleCount=Ut.stats[Jt].videoReceived.data.length,Ut.stats[Jt].videoReceived[an]=hn}),Ut.stats[Jt].videoReceived.mosAV===void 0&&(Ut.stats[Jt].videoReceived.mosAV={}),["mosAV"].forEach(function(an){var hn=Ut.evalQuartiles(Ut.stats[Jt].videoReceived.data,an);hn.sampleCount=Ut.stats[Jt].videoReceived.data.length,Ut.stats[Jt].videoReceived[an]=hn}),Ut.stats[Jt].videoReceived.width=Et.detail.stats.videoReceived.width,Ut.stats[Jt].videoReceived.height=Et.detail.stats.videoReceived.height)):Bn.error("video stats not pushed for callId :",Jt))},Bt=0;Bt<this.subscribeCallIds.length;Bt+=1){var Qt;Ot(Bt)}},this.subscribeToUserStream=function(Et,Ut,Ot){var Bt=this,Qt=this.webRTCClient.getStreamFromList(Ut);if(Qt!=null){var en=[];en.push(Qt),this.webRTCClient.subscribe(en,Ot).forEach(function(Jt){Bt.subscribeCallIds.push(Jt),Bt.report[Bt.testId].subscribeCallIds.push(Jt)})}},this.leaveSession=function(){Bn.debug("leaveSession"),this.streams!==void 0&&typeof this.streams[0]=="number"&&this.webRTCClient!==null&&this.webRTCClient.unsubscribe(this.streams[0]),this.userMediastreamId!==null&&apiRTC.releaseUserMediaStream(this.userMediastreamId),delete this.streams,delete this.subscribeCallIds,typeof this.publishCallId=="string"&&this.webRTCClient.unpublish(this.publishCallId),delete this.publishCallId,this.mcuSession!==void 0&&this.mcuSession.sessionId!==void 0&&(this.webRTCClient.leaveMCUSession(),delete this.mcuSession.sessionId),delete this.mcuSession,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs.splice(0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs.length),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.joinSessionReqs.splice(0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.joinSessionReqs.length),Bn.debug("leaveSession done")},this.runResolutionTest=function(){this.testId="resolution-test",this.stepId="resolution-test",Nn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"start",stepId:this.stepId}),Bn.debug("Run resolution test"),this.startGetUserMedia(this.resolutions[this.currentResolution])},this.startGetUserMedia=function(Et){Bn.debug("startGetUserMedia :",Et);var Ut={audio:!1,video:{}};Ut=apiCC.setVideoSourceIdInConstraint(this.videoSourceId,Ut),Ut=apiCC.setResolutionInConstraint(Et[0],Et[1],Ut),Bn.debug("startGetUserMedia constraints:",Ut),apiCC.getUserMedia(Ut).then((function(Ot){this.resolutions.length>1?(this.report.resolutions.push(Et[2]+":   "+Et[0]+"x"+Et[1]),this.maxWidth=Et[0],this.maxHeight=Et[1],Ot.getTracks().forEach(function(Bt){Bt.stop()}),this.maybeContinueGetUserMedia()):Bn.debug("No video track in returned stream.")}).bind(this)).catch((function(Ot){Bn.debug("startGetUserMedia catch error:",Ot),this.resolutions.length>1?Bn.debug(Et[0]+"x"+Et[1]+" not supported"):Bn.error("getUserMedia failed with error: "+Ot.name),this.maybeContinueGetUserMedia()}).bind(this))},this.maybeContinueGetUserMedia=function(){this.currentResolution!==this.resolutions.length-1?(this.currentResolution++,this.startGetUserMedia(this.resolutions[this.currentResolution])):this.startNextTest()}},vn=et.Y.get("ApiCCWebRTCClient"),Rn=function(Gt){vn.debug("apiCC.ApiCCWebRTCClient"),this.myWebRTC_Event=apiCC.myWebRTC_Event,this.webRTCClient=new sr(Gt),this.webRTCClient.channelReady=!0,this.callTest=null,this.call=function(Tt,nt,Ct){return nt==="RECORD"&&vn.warn("DEPRECATED : usage of data parameter on call() as a string with 'RECORD' value will be deprecated in a next version of apiRTC. Please consider using a JSON Data parameter instead : data = {isRecorded : true}"),this.webRTCClient.recordedCall===!0&&(vn.log("recordedCall option is activated"),nt!==void 0&&nt!=="RECORD"||(nt={}),nt.MCUType="MCU-Caller",nt.confId=Math.floor(1000001*Math.random()).toString()),nt!==void 0&&(nt!=="RECORD"&&nt.isRecorded!==!0||(vn.log("recordedCall option is activated"),nt==="RECORD"&&(nt={}),nt.MCUType="MCU-Caller",nt.confId=Math.floor(1000001*Math.random()).toString())),Ct!=null&&Ct.record===!0&&(vn.log("callConfiguration record option is activated"),nt!==void 0&&nt!=="RECORD"||(nt={}),nt.MCUType="MCU-Caller",nt.confId=Math.floor(1000001*Math.random()).toString()),vn.log("session.webRTCPluginActivated =",Gt.webRTCPluginActivated),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&Gt.webRTCPluginActivated===!0?(vn.log("managing call with WebRTC Plugin"),Ct==null&&(Ct={}),Ct.apzcallId=apiCC.generateCallId(),apiCC.manageWebRTCPlugin(function(){vn.log("manageWebRTCPlugin cb in call"),apiCC.session.apiCCWebRTCClient.webRTCClient.callWithNumber(Tt,!0,nt,Ct)},function(){vn.log("actionOnInstallationNeeded")}),Ct.apzcallId):(vn.log("managing call with browser"),this.webRTCClient.callWithNumber(Tt,!0,nt,Ct))},this.getStatsFromCall=function(Tt,nt){var Ct=this.webRTCClient.findCallWithCallId(Tt);Ct===null?nt(new Error("Call was not found"),null):Ct.pc===null?nt(new Error("Call has no peerconnection"),null):this.webRTCClient.csmEnable===!0?nt(null,this.webRTCClient.csmLastResults):nt(new Error("Call stats monitoring not activated"),null)},this.testCall=function(Tt){return vn.log("session.webRTCPluginActivated =",Gt.webRTCPluginActivated),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&Gt.webRTCPluginActivated===!0?(vn.log("managing call with WebRTC Plugin"),Tt==null&&(Tt={}),Tt.apzcallId=apiCC.generateCallId(),apiCC.manageWebRTCPlugin(function(){vn.log("manageWebRTCPlugin cb in call"),apiCC.session.apiCCWebRTCClient.webRTCClient.startTestCall(!0,Tt)},function(){vn.log("actionOnInstallationNeeded")}),Tt.apzcallId):(vn.log("managing call with browser"),this.webRTCClient.startTestCall(!0,Tt))},this.setClientTurnServer=function(Tt){this.webRTCClient.setClientTurnServer(Tt)},this.activateScreenSharing=function(Tt){this.webRTCClient.activateScreenSharing(Tt)},this.shareScreen=function(Tt,nt,Ct){return vn.info("shareScreen"),this.webRTCClient.shareScreen(Tt,nt,Ct)},this.startScreenSharingOnCall=function(Tt,nt){vn.info("startScreenSharingOnCall"),this.webRTCClient.startScreenSharingOnCall(Tt,nt)},this.startDataChannel=function(Tt,nt){if(vn.info("startDataChannel"),!(ot.Xh==="Edge"&&ot.PR<79&&apiRTC.browserDetails.type!=="chrome"))return nt!==void 0?nt.dataCall=!0:(nt={}).dataCall=!0,this.webRTCClient.callWithNumber(Tt,!0,nt,null);vn.warn("Cannot startDataChannel as it is not supported on Edge")},this.startDataChannelOnCall=function(Tt){this.webRTCClient.startDataChannelOnCall(Tt)},this.sendDataWithCallId=function(Tt,nt,Ct){this.webRTCClient.sendDataWithCallId(Tt,nt,Ct)},this.callAudio=function(Tt,nt,Ct){return vn.info("callAudio"),this.webRTCClient.callWithNumber(Tt,!1,nt,Ct)},this.callbymail=function(Tt){this.webRTCClient.callbymail(Tt)},this.addMedia=function(Tt){return this.webRTCClient.addMedia(Tt),Tt},this.hangUp=function(Tt){this.webRTCClient.onHangup(Tt)},this.getMyMedia=function(Tt,nt){vn.info("getMyMedia : ",Tt),Tt==="screen"?this.webRTCClient.shareScreen("LOCAL",{},nt):this.webRTCClient.getUserMedia()},this.releaseStream=function(Tt){vn.info("releaseStream : ",Tt),vn.info("releaseStream.callId : ",Tt.callId),Tt.callId!==void 0?this.webRTCClient.removeCallFromTableWithCallIdAndSendBye(Tt.callId,"stop_ScreenSharing"):this.webRTCClient.stopStream(Tt)},this.autoAnswerUserMediaSuccessHandler=function(Tt){vn.info("autoAnswerUserMediaSuccessHandler :"+Tt),Tt=null,this.webRTCClient.autoAnswer=!0},this.autoAnswerUserMediaErrorHandler=function(Tt){vn.info("autoAnswerUserMediaErrorHandler :"+Tt),Tt=null,this.webRTCClient.autoAnswer=!1},this.activateAutoAnswer=function(){apiCC.addEventListener("userMediaSuccess",this.callback(this,"autoAnswerUserMediaSuccessHandler")),apiCC.addEventListener("userMediaError",this.callback(this,"autoAnswerUserMediaErrorHandler")),this.webRTCClient.getUserMedia()},this.getAutoAnswer=function(){return this.webRTCClient.autoAnswer},this.setUnidirectionalCall=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.unidirectionelCallOnly=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUnidirectionalCall()","PARAMETER_ERROR_SETUNIDIRCALL")},this.setReceiveMediaDeactivated=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.receiveMediaDeactivated=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setReceiveMediaDeactivated()","PARAMETER_ERROR_SETRECVMEDIADEACTIVATED")},this.setPreferVP9Codec=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.preferVP9Codec=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setPreferVP9Codec()","PARAMETER_ERROR_SETPREFERVP9CODEC")},this.setPreferH264Codec=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.preferH264Codec=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setPreferH264Codec()","PARAMETER_ERROR_SETPREFERH264CODEC")},this.getUnidirectionalCall=function(){return this.webRTCClient.unidirectionelCallOnly},this.toggleVideoMute=function(Tt){return this.webRTCClient.toggleVideoMute(Tt)},this.isVideoMuted=function(Tt){var nt;return vn.debug("isVideoMuted :",Tt),Tt==null?this.webRTCClient.isVideoMuted:(vn.debug("callId is defined :",Tt),(nt=this.webRTCClient.findCallIndexWithCallId(Tt))!==-1?this.webRTCClient.callsTable[nt].isLocalVideoMuted:void 0)},this.toggleAudioMute=function(Tt){return this.webRTCClient.toggleAudioMute(Tt)},this.sendDTMF=function(Tt,nt,Ct,yt){return this.webRTCClient.sendDTMF(Tt,nt,Ct,yt)},this.isAudioMuted=function(Tt){var nt;return vn.debug("isAudioMuted :",Tt),Tt==null?this.webRTCClient.isAudioMuted:(vn.debug("callId is defined :",Tt),(nt=this.webRTCClient.findCallIndexWithCallId(Tt))!==-1?this.webRTCClient.callsTable[nt].isLocalAudioMuted:void 0)},this.setNtoNConf=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.NtoNConf=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setNtoNConf()","PARAMETER_ERROR_SETNTONCONF")},this.getNtoNConf=function(){return this.webRTCClient.NtoNConf},this.setRTPMedia=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.RTPMedia=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setRTPMedia()","PARAMETER_ERROR_SETRTPMEDIA")},this.getRTPMedia=function(){return this.webRTCClient.RTPMedia},this.setMediaRoutingMode=function(Tt){Tt==="hostOnly"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.hostOnly:Tt==="stun"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.stun:Tt==="stunOnly"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.stunOnly:Tt==="turn"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.turn:Tt==="turnOnly"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.turnOnly:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setMediaRoutingMode()","PARAMETER_ERROR_SETMEDIAROUTINGMODE")},this.enableQos=function(Tt,nt){apiCC.browser!=="Chrome"&&apiCC.browser!=="Firefox"&&(vn.warn("enableQos() is only supported on Chrome and Firefox, support on other browsers will be added soon"),Tt=!1),vn.info("this.enableQos="+Tt),this.webRTCClient.qosEnable=Tt,this.webRTCClient.qosInterval=nt||this.webRTCClient.qosInterval},this.enableCallStatsMonitoring=function(Tt,nt){["chrome","firefox","safari"].indexOf(st.wL.type)<0?vn.warn("enableCallStatsMonitoring() is only supported on Chrome, Firefox and Safari, support on other browsers will be added soon"):(this.webRTCClient.csmEnable=Tt,nt&&(this.webRTCClient.csmIntervalMs=nt))},this.enableQualityEvaluating=function(Tt,nt){["chrome","firefox"].indexOf(st.wL.type)<0?vn.warn("enableQualityEvaluating() is only supported on Chrome and Firefox, support on other browsers will be added soon"):(this.webRTCClient.qualityScoreEnable=Tt,nt&&(this.webRTCClient.qualityScoreIntervalMs=nt))},this.getMediaRoutingMode=function(){var Tt=null;return this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.hostOnly?Tt="hostOnly":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.stun?Tt="stun":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.stunOnly?Tt="stunOnly":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.turn?Tt="turn":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.turnOnly&&(Tt="turnOnly"),Tt},this.setMediaTypeForIncomingCall=function(Tt){vn.debug("setMediaTypeForIncomingCall :",Tt),Tt==="VIDEO"||Tt==="AUDIO"||Tt==="VIDEOONLY"||Tt==="NONE"?this.webRTCClient.mediaTypeForIncomingCall=Tt:vn.log("setMediaTypeForIncomingCall, value is not correct",Tt)},this.setMediaTypeForOutgoingCall=function(Tt){vn.debug("setMediaTypeForOutgoingCall :",Tt),Tt==="VIDEO"||Tt==="AUDIO"||Tt==="VIDEOONLY"||Tt==="NONE"?this.webRTCClient.mediaTypeForOutgoingCall=Tt:vn.log("setMediaTypeForOutgoingCall, value is not correct",Tt)},this.setStereo=function(Tt){vn.info("setStereo :",Tt),Tt===!0?(this.webRTCClient.setStereo=Tt,this.webRTCClient.gum_config={audio:{mandatory:{echoCancellation:!1,googEchoCancellation:!1},optional:[]},video:{mandatory:{},optional:[]}}):Tt===!1?this.webRTCClient.setStereo=Tt:vn.log("setStereo, value is not correct",Tt)},this.setMCUConnector=function(Tt){vn.info("setMCUConnector :",Tt),vn.log("setting value :",Tt),Tt==="mcu4.apizee.com"?this.webRTCClient.MCUClient.pubConnector="janusConnector":Tt==="mcu3.apizee.com"?this.webRTCClient.MCUClient.pubConnector="groupKurentoConnector":vn.log("value is incorrect :",Tt)},this.enableMeshRoomMode=function(Tt){vn.info("enableMeshRoomMode :",Tt),ot.Xh==="IE"?(vn.log("IE detected, MeshRoomMode is not supported"),this.webRTCClient.MCUClient.meshModeEnabled=!1):this.webRTCClient.MCUClient.meshModeEnabled=Tt},this.setAllowAsymetricMediaCalls=function(Tt){vn.info("setAllowAsymetricMediaCalls :",Tt),Tt===!0||Tt===!1?this.webRTCClient.allowAsymetricMediaCalls=Tt:vn.log("setAllowAsymetricMediaCalls, value is not correct",Tt)},this.takeSnapshot=function(Tt,nt,Ct,yt,Pt,Et,Ut){this.webRTCClient.takeSnapshot(Tt,nt,Gt.apiKey,Ct,yt,Pt,Et,Ut)},this.takeSnapshotAndSendOnDataChannel=function(Tt,nt,Ct,yt){this.webRTCClient.takeSnapshotAndSendOnDataChannel(Tt,nt,Ct,yt)},this.setUserAcceptOnIncomingCall=function(Tt){vn.info("setUserAcceptOnIncomingCall :",Tt),Tt===!0||Tt===!1?this.webRTCClient.userAcceptOnIncomingCall=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingCall()","PARAMETER_ERROR_SETUSERACCEPTONINCOCALL")},this.setUserAcceptOnIncomingCallBeforeGetUserMedia=function(Tt){vn.info("setUserAcceptOnIncomingCallBeforeGetUserMedia :",Tt),Tt===!0||Tt===!1?this.webRTCClient.userAcceptOnIncomingCallBeforeGetUserMedia=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingCallBeforeGetUserMedia()","PARAMETER_ERROR_SETUSERACCEPTONINCOCALLBEFOREGUM")},this.setUserAcceptOnIncomingDataCall=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.userAcceptOnIncomingDataCall=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingDataCall()","PARAMETER_ERROR_SETUSERACCEPTONINCOCALL")},this.setUserAcceptOnIncomingScreenSharingCall=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.userAcceptOnIncomingScreenSharingCall=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingScreenSharingCall()","PARAMETER_ERROR_SETUSERACCEPTONINCOSCREENSHARINGCALL")},this.setAllowMultipleCalls=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.allowMultipleCalls=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setAllowMultipleCalls()","PARAMETER_ERROR_SETALLOWMULTIPLECALLS")},this.setPcConfig=function(Tt){vn.info("Setting PC_config to :",Tt),this.webRTCClient.pc_config=Tt},this.setPcConstraints=function(Tt){vn.info("Setting PC_constraints to :"+Tt),this.webRTCClient.pc_constraints=Tt},this.setGetUserMediaConfig=function(Tt){this.webRTCClient.setGetUserMediaConfig(Tt)},this.setTrickleIce=function(Tt){vn.info("Setting trickleIce to :"+Tt),Tt===!0||Tt===!1?this.webRTCClient.trickleIce=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setTrickleIce()","PARAMETER_ERROR_SETTRICKLEICE")},this.setRecordedCall=function(Tt){Tt===!0||Tt===!1?this.webRTCClient.recordedCall=Tt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setRecordedCall()","PARAMETER_ERROR_SETRECORDEDCALL")},this.getRecordedCall=function(){return this.webRTCClient.recordedCall},this.acceptCall=function(Tt,nt){this.webRTCClient.acceptCall(Tt,nt)},this.refuseCall=function(Tt){vn.info("refuseCall"),this.webRTCClient.refuseCall(Tt)},this.addVideoMedia=function(Tt){vn.info("addVideoMedia"),this.webRTCClient.addVideoMedia(Tt)},this.updateMediaDeviceOnCall=function(Tt,nt){return vn.info("updateMediaDeviceOnCall"),this.webRTCClient.updateMediaDeviceOnCall(Tt,nt)},this.updateMediaTypeOnCall=function(Tt,nt){return!(0,st.Ym)(Tt,"string")||nt!=="VIDEO"&&nt!=="AUDIOONLY"&&nt!=="VIDEOONLY"?Promise.reject("wrong arguments"):this.webRTCClient.updateMediaTypeOnCall(Tt,nt)},this.releaseUserMedia=function(){this.webRTCClient.releaseUserMedia()},this.setAllowedAudioCodecs=function(Tt){this.webRTCClient.allowedAudioCodecs=Tt},this.setAllowedVideoCodecs=function(Tt){this.webRTCClient.allowedVideoCodecs=Tt},this.setAudioBandwidth=function(Tt){this.webRTCClient.setAudioBandwidth(Tt)},this.setVideoBandwidth=function(Tt){},this.setRemoteVideoBandwidth=function(Tt){typeof Tt=="number"?this.webRTCClient.setVideoBandwidth(Tt,"remote"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Tt)},this.setOverallIncomingVideoBandwidth=function(Tt){typeof Tt=="number"?this.webRTCClient.setVideoBandwidth(Tt,"overall","incoming"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Tt)},this.setOverallOutgoingVideoBandwidth=function(Tt){typeof Tt=="number"?this.webRTCClient.setVideoBandwidth(Tt,"overall","outgoing"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Tt)},this.setPerCallIncomingVideoBandwidth=function(Tt){typeof Tt=="number"?this.webRTCClient.setVideoBandwidth(Tt,"perCall","incoming"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Tt)},this.setPerCallOutgoingVideoBandwidth=function(Tt){typeof Tt=="number"?this.webRTCClient.setVideoBandwidth(Tt,"perCall","outgoing"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Tt)},this.setDataBandwidth=function(Tt){this.webRTCClient.setDataBandwidth(Tt)},this.createMCUSession=function(Tt,nt){vn.info("createMCUSession"),this.webRTCClient.MCUClient.initDivElements(Tt,nt),this.webRTCClient.MCUClient.createSession()},this.joinMCUSession=function(Tt){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vn.debug("joinMCUSession"),Tt?this.webRTCClient.MCUClient.joinSession(Tt,nt):new Error("wrong roomId")},this.getMCUStreamList=function(){return vn.debug("getMCUStreamList"),this.webRTCClient.MCUClient.getStreamList()},this.getStreamFromList=function(Tt){return vn.debug("getStreamFromList"),this.webRTCClient.MCUClient.getStreamFromList(Tt)},this.getStreamIdOfUser=function(Tt){return vn.debug("getStreamIdOfUser"),this.webRTCClient.MCUClient.getStreamIdOfUser(Tt)},this.getCallIdFromStreamId=function(Tt){vn.debug("getCallIdFromStreamId");var nt=this.webRTCClient.findCallWithStreamId(Tt);return nt===null?(vn.log("call not found in getCallIdFromStreamId"),null):nt.callId},this.getCallIdFromRemoteMCUUser=function(Tt){var nt,Ct;return vn.debug("getCallIdFromRemoteMCUUser"),nt=this.webRTCClient.MCUClient.getStreamIdOfUser(Tt),(Ct=this.webRTCClient.findCallWithStreamId(nt))===null?(vn.log("call not found in getCallIdFromRemoteMCUUser"),null):Ct.callId},this.ejectParticipantFromMCUSession=function(Tt,nt,Ct){this.webRTCClient.MCUClient.ejectParticipant(Tt,nt,Ct)},this.publish=function(Tt,nt,Ct,yt,Pt,Et){if(ot.Xh==="IE"&&(vn.log("apiCC.session.webRTCPluginActivated ="+apiCC.session.webRTCPluginActivated),vn.log("apiCC.webRTCPluginInstalled ="+apiCC.webRTCPluginInstalled)),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&apiCC.session.webRTCPluginActivated===!0&&apiCC.webRTCPluginInstalled===!1)return vn.log("managing call with WebRTC Plugin"),yt==null&&(yt={}),yt.apzcallId=apiCC.generateCallId(),apiCC.manageWebRTCPlugin(function(){apiCC.webRTCPluginInstalled=!0,vn.info("manageWebRTCPlugin cb in call");var Ot=this.webRTCClient.MCUClient.getSessionMCU(Tt);return Ot&&Ot.roomMode==="mesh"?this.webRTCClient.MCUClient.meshPublish(Tt,nt,Ct,yt,Pt,Et):(vn.debug("publish"),this.webRTCClient.MCUClient.publish(Tt,nt,Ct,yt,Pt,Et))},function(){vn.log("actionOnInstallationNeeded")}),yt.apzcallId;var Ut=this.webRTCClient.MCUClient.getSessionMCU(Tt);return Ut&&Ut.roomMode==="mesh"?this.webRTCClient.MCUClient.meshPublish(Tt,nt,Ct,yt,Pt,Et):(vn.debug("publish"),this.webRTCClient.MCUClient.publish(Tt,nt,Ct,yt,Pt,Et))},this.unpublish=function(Tt){vn.info("unpublish"),this.webRTCClient.MCUClient.unpublish(Tt)},this.publishScreen=function(Tt,nt,Ct,yt){var Pt=this.webRTCClient.MCUClient.getSessionMCU(Tt);return Pt&&Pt.roomMode==="mesh"?(vn.info("publishScreen"),this.webRTCClient.MCUClient.meshPublishScreen(Tt,nt,Ct,yt)):(vn.info("publishScreen"),this.webRTCClient.MCUClient.publishScreen(Tt,nt,Ct,yt))},this.subscribe=function(Tt,nt,Ct,yt,Pt){return vn.info("subscribe :",Tt),ot.Xh==="IE"&&(vn.log("apiCC.session.webRTCPluginActivated ="+apiCC.session.webRTCPluginActivated),vn.log("apiCC.webRTCPluginInstalled ="+apiCC.webRTCPluginInstalled)),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&apiCC.session.webRTCPluginActivated===!0&&apiCC.webRTCPluginInstalled===!1?(vn.log("managing call with WebRTC Plugin"),apiCC.manageWebRTCPlugin(function(){return apiCC.webRTCPluginInstalled=!0,vn.log("manageWebRTCPlugin cb in subscribe"),typeof nt=="boolean"&&(vn.warn("DEPRECATED : usage of audioOnly parameter on subscribe() is now replaced by mediatype with value VIDEO, AUDIOONLY or VIDEOONLY and will be deprecated in a next version of apiRTC"),nt=nt===!0?"AUDIOONLY":"VIDEO"),apiCC.session.apiCCWebRTCClient.subscribe(Tt,nt,Ct,yt)},function(){vn.log("actionOnInstallationNeeded")}),"WebRTC_Plugin"):(typeof nt=="boolean"&&(vn.warn("DEPRECATED : usage of audioOnly parameter on subscribe() is now replaced by mediatype with value VIDEO, AUDIOONLY or VIDEOONLY and will be deprecated in a next version of apiRTC"),nt=nt===!0?"AUDIOONLY":"VIDEO"),this.webRTCClient.MCUClient.subscribeToStreams(Tt,nt,Ct,yt,Pt))},this.unsubscribe=function(Tt){vn.info("unsubscribe :",Tt),this.webRTCClient!==null&&this.webRTCClient.MCUClient!==null&&this.webRTCClient.MCUClient.unsubscribe(Tt)},this.startStreaming=function(Tt,nt,Ct,yt){return vn.info("startStreaming"),this.webRTCClient.MCUClient.startStreaming(Tt,nt,Ct,yt)},this.stopStreaming=function(Tt){return vn.info("stopStreaming"),this.webRTCClient.MCUClient.stopStreaming(Tt)},this.startRecording=function(Tt,nt,Ct,yt,Pt){vn.info("startRecording"),this.webRTCClient.MCUClient.startRecording(Tt,nt,Ct,yt,Pt)},this.stopRecording=function(Tt){vn.info("stopRecording"),this.webRTCClient.MCUClient.stopRecording(Tt)},this.changeStreamPriority=function(Tt,nt){var Ct=this.webRTCClient.findCallWithCallId(Tt);if(!Ct&&!(Ct=this.webRTCClient.findUserMediaById(Tt)))return vn.error("changeStreamPriority - no such call",Tt),!1;if(!Ct.sessionMCU)return vn.error("changeStreamPriority - no such sessionMCU"),!1;if(!(0,st.Ym)(nt,"number")||nt<0)return vn.error("changeStreamPriority - wrong priority",nt),!1;var yt=JSON.stringify({type:"changeStreamPriority",roomId:Ct.sessionMCU.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Tt,data:{pubSub:this.webRTCClient.MCUClient.pubConnector,priority:nt}});return vn.log("C->S: "+yt),apiCC.session.channel.socket.emit("changeStreamPriority",yt),!0},this.startComposite=function(Tt){vn.info("startComposite"),this.webRTCClient.MCUClient.startComposite(Tt)},this.stopComposite=function(Tt){vn.info("stopComposite"),this.webRTCClient.MCUClient.stopComposite(Tt)},this.startCompositeRecording=function(Tt,nt,Ct,yt,Pt){vn.info("startCompositeRecording"),this.webRTCClient.MCUClient.startCompositeRecording(Tt,nt,Ct,yt,Pt)},this.stopCompositeRecording=function(Tt){vn.info("stopCompositeRecording"),this.webRTCClient.MCUClient.stopCompositeRecording(Tt)},this.checkCallExist=function(Tt){for(var nt=null,Ct=this.webRTCClient.callsTable.length;--Ct>=0;){var yt=this.webRTCClient.callsTable[Ct];if(yt.callId===Tt&&yt.data&&yt.sessionMCU&&(yt.data.MCUType==="MCU-Caller"||yt.data.MCUType==="MCU-Callee")&&yt.data.confId===yt.sessionMCU.roomName){nt=yt;break}}return nt||vn.error("startCallRecording: no such call"),nt},this.startCallRecording=function(Tt){var nt;if(nt=this.checkCallExist(Tt)){var Ct=(0,st.ws)({},nt.data);this.webRTCClient.MCUClient.startCompositeRecording("AUDIO-VIDEO",null,nt.sessionMCU.convId,Ct,nt.sessionMCU.roomName)}},this.stopCallRecording=function(Tt){var nt;(nt=this.checkCallExist(Tt))&&this.webRTCClient.MCUClient.stopCompositeRecording(nt.sessionMCU.roomName)},this.enforceMCU=function(Tt){this.webRTCClient.MCUClient.enforceMCU(Tt)},this.takeSnapshotOnMCUSession=function(Tt){return vn.info("takeSnapshotOnMCUSession"),this.webRTCClient.MCUClient.takeSnapshot(Tt)},this.sendMCUSessionInvitation=function(Tt,nt,Ct){this.webRTCClient.MCUClient.sendSessionInvitation(Tt,nt,Ct)},this.sendMCUSessionInvitationToGroupChat=function(Tt,nt){this.webRTCClient.MCUClient.sendSessionInvitationToGroupChat(Tt,nt)},this.acceptMCUSessionInvitation=function(Tt,nt,Ct,yt){this.webRTCClient.MCUClient.initDivElements(Ct,yt),this.webRTCClient.MCUClient.acceptSessionInvitation(Tt,nt)},this.leaveMCUSession=function(Tt){this.webRTCClient.MCUClient.leaveSession(Tt)},this.recordStream=function(Tt){vn.info("recordStream :",Tt),MediaRecorder!==void 0?apiCC.recordMgr.record(Tt).then(function(){vn.log("Recording started")}).catch(function(nt){vn.error("startRecord failed :",nt)}):vn.debug("MediaRecorder is not supported on this browser, leaving recordStream process")},this.stopRecordStream=function(Tt){vn.info("stopRecordStream"),MediaRecorder!==void 0?apiCC.recordMgr.stop().then(function(nt){vn.log("Recording stopped"),Tt(nt)}).catch(function(nt){vn.error("stopRecord failed :",nt)}):vn.debug("MediaRecorder is not supported on this browser, leaving recordStream process")},this.getMediaDevices=function(Tt){vn.debug("getMediaDevices 2"),apiCC.getMediaDevices().then(function(nt){Tt(nt),apiCC.mediaDeviceMgr.gotSources(nt)}).catch(function(nt){Tt(null),apiCC.mediaDeviceMgr.gotSources(null)})},this.setAudioSourceId=function(Tt){vn.info("setAudioSourceId :"+Tt),this.webRTCClient.audioSourceId=Tt},this.setAudioOutputId=function(Tt){vn.info("setaudioOutputId :"+Tt),this.webRTCClient.audioOutputId=Tt},this.setVideoSourceId=function(Tt){vn.info("setVideoSourceId :"+Tt),this.webRTCClient.videoSourceId=Tt},this.setVideoFacingMode=function(Tt){vn.info("setVideoFacingMode :"+Tt),Tt==="user"||Tt==="environment"||Tt==="left"||Tt==="right"||Tt==="deactivated"?this.webRTCClient.facingMode=Tt==="deactivated"?null:Tt:vn.log("facingMode value is not correct")},this.attachMediaStream=function(Tt,nt){vn.debug("attachMediaStream"),apiCC.attachMediaStream(Tt,nt)},this.addStreamInDiv=function(Tt,nt,Ct,yt,Pt,Et){vn.debug("addStreamInDiv"),apiCC.addStreamInDiv(Tt,nt,Ct,yt,Pt,Et)},this.removeElementFromDiv=function(Tt,nt){vn.debug("removeElementFromDiv"),apiCC.removeElementFromDiv(Tt,nt)},this.setSelectedStream=function(Tt){vn.warn("setSelectedStream() is now deprecated")},this.callback=function(Tt,nt){return this.closureHandler=function(Ct){return Tt[nt](Ct)},this.closureHandler},this.startPrecallTest=function(Tt,nt,Ct,yt,Pt){var Et={webRTCClient:this,notifyTerminated:Tt};this.callTest=new Wn(Et,nt,Ct,yt,Pt),this.callTest.runBitRateTest()}}},6527:(it,ut,s)=>{s.d(ut,{p:()=>ot}),s(3843),s(3710),s(7941),s(4916),s(2772),s(2564),s(561),s(1058),s(9653),s(3290),s(6755),s(3123),s(2222),s(4812);var et=s(1549).Y.get("ApiCCWhiteBoardClient"),ot=function(st,Rt,ht,bt,ct){function mt(rt){rt.style.display="none"}et.debug("Loading apiCC.ApiCCWhiteBoardClient"),this.roomId=null,this.whiteBoardDisconnectionTimeoutId=0,this.sessionStarted=!1,this.prev={},this.lastEmit=Date.now(),this.clients={},this.listenedPeers={},this.touchScreenActivated=!1,this.touchControlPoint={},this.drawElements=[],this.ghostElements={},this.redoStack=[],this.undoIndex=0,this.userCursorColor=null,this.cursors={},this.cursorStyle="cross",this.CURSOR_STYLES=["circle","cross"],this.currentScale=1,this.dx=0,this.dy=0,this.instructionsFaded=!1,this.canvas=null,this.ctx=null,this.currentTool="pen",this.currentColor="rgba(0, 0, 0, 1)",this.currentBrushWidth=1,this.readOnly=!1,this.isDrawing=!1,this.focusOnDrawing=!1,this.paperSheetId=0,this.drawingId=0,this.offline=!1,this.roomJoined=!1,this.laserModeActivated=!1,this.AVAILABLE_TOOLS=["pen","ellipse","rectangle","erase","void","arrow"],this.GEOMETRY_TOOLS=["arrow","rectangle","ellipse"],this.disconnectionTimer=ct!==void 0?ct:3e4,et.log("Setting Whiteboard disconnectionTimer to : "+this.disconnectionTimer),this.setCanvas=function(rt){et.debug("[Whiteboard] setCanvas() :",rt),this.canvas!==null&&(et.log("Unsetting old canvas events"),this.sessionStarted&&!this.readOnly&&(this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseleave=null,this.canvas.onmousemove=null,this.touchScreenActivated&&(this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1)))),rt!==null&&document.getElementById(rt)!==null?(this.canvas=document.getElementById(rt),this.ctx=this.canvas.getContext("2d"),this.sessionStarted&&!this.readOnly&&(this.canvas.onmousedown=this.onmousedown,this.canvas.onmouseup=this.onmouseup,this.canvas.onmouseleave=this.onmouseleave,this.canvas.onmousemove=this.onmousemove,this.touchScreenActivated&&(this.canvas.addEventListener("touchstart",this.onTouchStart,!1),this.canvas.addEventListener("touchend",this.onTouchEnd,!1),this.canvas.addEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.addEventListener("touchleave",this.onTouchEnd,!1),this.canvas.addEventListener("touchmove",this.onTouchMove,!1)))):(rt!==null&&document.getElementById(rt)===null&&et.warn("No such element whose id is : "+rt),this.canvas=null,this.ctx=null)},this.setCanvas(Rt),this.sendDataToRoom=function(rt){if(et.info("[Whiteboard] sendDataToRoom()"),this.offline===!1&&this.roomId!==null){if(apiCC.session===null||apiCC.session===void 0)return void et.info("apiCC.session does not exist, leaving process");et.debug("this.drawElements :",this.drawElements),et.debug("data.tool :",rt.tool);var pt=[];et.debug("drawElementsToSend :",pt);var ft,St={x:0,y:0,drawing:!1,tool:this.currentTool,cursorColor:this.userCursorColor,color:this.currentColor,width:this.currentBrushWidth,paperSheetId:this.paperSheetId,drawElements:pt,id:apiCC.session.apiCCId},It=Object.keys(rt);for(ft=0;ft<It.length;ft++)St[It[ft]]=rt[It[ft]];apiCC.session.roomMgr.sendMessageToRoom(this.roomId,"whiteBoard",St)}},this.setCursorsDiv=function(){et.warn("[Whiteboard] setCursorsDiv() - method obsolete, please use setUserCursorColor to set a cursor pointer that will be seen by other users")},this.setUserCursorColor=function(rt){et.debug("[Whiteboard] setUserCursorColor() : "+rt),rt===null||rt==="invisible"?this.userCursorColor="invisible":/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(rt)?this.userCursorColor=rt:(et.warn("[Whiteboard] setUserCursorColor() color "+rt+" is invalid, defaulting to invisible"),this.userCursorColor="invisible")},this.setUserCursorColor(ht),this.setCursorStyle=function(rt){et.debug("[Whiteboard] setCursorStyle() : "+rt),this.CURSOR_STYLES.indexOf(rt)>-1?(this.userCursorColor="invisible",this.cursorStyle=rt):et.error("[Whiteboard] setCursorStyle() style "+rt+" is invalid")},this.setFocusOnDrawing=function(rt){et.debug("[Whiteboard] setFocusOnDrawing()"),this.focusOnDrawing=rt},this.createRoom=function(){var rt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};et.debug("[Whiteboard] createRoom()"),apiCC.session.roomMgr.createRoom("whiteBoard",rt)},this.requestContactListInRoom=function(rt){et.log("[Whiteboard] requestContactListInRoom :"+rt),apiCC.session.roomMgr.requestContactListInRoom(rt)},this.setDrawingTool=function(rt){et.debug("[Whiteboard] setDrawingTool()");var pt=0;apiCC.session!==null&&(pt=apiCC.session.apiCCId),this.AVAILABLE_TOOLS.indexOf(rt)>-1&&(this.currentTool=rt,this.ghostElements[pt]=null)},this.setReadOnly=function(rt){et.debug("[Whiteboard] setReadOnly()");var pt=0;apiCC.session!==null&&(pt=apiCC.session.apiCCId),this.ghostElements[pt]=null,this.readOnly=rt===!0,this.readOnly&&this.canvas!==null?(this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseleave=null,this.canvas.onmousemove=null,this.touchScreenActivated&&(this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1))):this.canvas!==null&&(this.canvas.onmousedown=this.onmousedown,this.canvas.onmouseup=this.onmouseup,this.canvas.onmouseleave=this.onmouseleave,this.canvas.onmousemove=this.onmousemove,this.touchScreenActivated&&(this.canvas.addEventListener("touchstart",this.onTouchStart,!1),this.canvas.addEventListener("touchend",this.onTouchEnd,!1),this.canvas.addEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.addEventListener("touchleave",this.onTouchEnd,!1),this.canvas.addEventListener("touchmove",this.onTouchMove,!1)))},this.laserModeProcess=function(rt){var pt=this;setTimeout(function(){return pt.undo(rt)},5e3)},this.undo=function(rt){et.debug("[Whiteboard] undo()");var pt=this.drawElements.length-1,ft=null,St=[],It=[],xt=null,At=0;if(apiCC.session!==null&&(At=apiCC.session.apiCCId),rt===void 0)for(;pt>=0;)this.drawElements[pt].userId==At&&(ft===null&&(ft=this.drawElements[pt].undoIndex),ft===this.drawElements[pt].undoIndex&&(xt=this.drawElements.splice(pt,1)[0],St.push(xt),It.push(xt.drawingId))),pt--;else for(pt=0;pt<this.drawElements.length;pt++)this.drawElements[pt].userId==At&&this.drawElements[pt].drawingId===rt&&(et.debug("[Whiteboard] element found with drawingId in undo laser :",rt),xt=this.drawElements.splice(pt,1)[0],St.push(xt),It.push(xt.drawingId));St.length>0&&(this.redraw(),this.sendDataToRoom({tool:"void",delete:It,undoneElements:St}),this.redoStack.push(St))},this.redo=function(){et.debug("[Whiteboard] redo()");var rt,pt=[];if(this.redoStack.length>0){for(pt=this.redoStack.pop(),rt=0;rt<pt.length;rt++)this.addNewDrawing(pt[rt]);this.sendDataToRoom({tool:"void",drawObjectsArray:pt}),this.redraw()}},this.setBrushSize=function(rt){et.debug("[Whiteboard] setBrushSize()"),!isNaN(rt)&&rt>0&&(this.currentBrushWidth=rt)},this.setBrushColor=function(rt){et.debug("[Whiteboard] setBrushColor()"),this.currentColor=rt},this.setScale=function(rt){et.debug("[Whiteboard] setScale()"),rt>0?(this.currentScale=rt,this.redraw()):et.warn("Scale factor must be > 0!")},this.getScale=function(){return et.debug("[Whiteboard] getScale()"),this.currentScale},this.setOffset=function(rt,pt){et.debug("[Whiteboard] setOffset()");var ft=parseInt(rt,10),St=parseInt(pt,10);isNaN(ft)||isNaN(St)||(this.dx=Number(ft),this.dy=Number(St),this.redraw())},this.getOffset=function(){return et.debug("[Whiteboard] getOffset()"),{x:this.dx,y:this.dy}},this.printSharedText=function(rt,pt,ft,St,It,xt){et.debug("[Whiteboard] printSharedText()"),this.setBrushStyle(this.currentColor,this.currentBrushWidth),this.undoIndex++,this.redoStack=[];var At=0;apiCC.session!==null&&(At=apiCC.session.apiCCId);var Dt={type:"text",x:rt,y:pt,text:ft,size:St,font:It,border:xt,userId:At,drawingId:this.drawingId,color:this.currentColor,width:this.currentBrushWidth,undoIndex:this.undoIndex,time:Date.now()};this.sendDataToRoom({x:rt,y:pt,tool:"void",drawObject:Dt}),this.drawingId++,this.addNewDrawing(Dt)},this.addPeerListener=function(rt,pt){et.debug("[Whiteboard] addPeerListener()"),this.listenedPeers.hasOwnProperty(rt)||(this.listenedPeers[rt]=[]),this.listenedPeers[rt].push(pt)},this.inviteInRoom=function(rt,pt,ft){var St=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};et.debug("[Whiteboard] inviteInRoom()"),rt!==null?pt!==null?apiCC.session.roomMgr.inviteInRoom(rt,pt,"whiteBoard",ft,St):et.debug("wrong destId"):et.debug("wrong roomId")},this.answerToRoomInvitation=function(rt,pt){et.info("[Whiteboard] answerToRoomInvitation()");var ft=pt&&!this.isInRoom();return this.isInRoom()?et.error("[Whiteboard] cannot answer room invitation : user is already in a room"):apiCC.session.roomMgr.answerToRoomInvitation(rt,pt,"whiteBoard"),ft&&(et.log("[Whiteboard] user joining room"),this.paperSheetId=0,this.drawingId=0,this.roomId=rt,this.sendDataToRoom({tool:"void",needCatchUp:"*||-1"})),ft},this.joinRoom=function(rt){var pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};et.info("[Whiteboard] joinRoom() roomId :",rt),rt==null?et.error("[Whiteboard] cannot join room : room is null or undefined"):this.isInRoom()&&this.roomJoined===!0?et.error("[Whiteboard] cannot join room : user is already in a room"):apiCC.session.roomMgr.joinRoom(rt,"whiteBoard",pt)},this.leaveRoom=function(){et.info("[Whiteboard] leaveRoom()"),this.isInRoom()&&(apiCC.session.roomMgr.leaveRoom(this.roomId,"whiteBoard"),this.roomId=null,this.paperSheetId=0,this.drawingId=0,this.listenedPeers={},this.roomJoined=!1)},this.isInRoom=function(){return this.roomId!==null},this.clearPaper=function(){et.debug("[Whiteboard] clearPaper()"),this.deleteHistory()},this.refreshCanvas=function(){if(this.canvas!==null&&this.ctx!==null){var rt=this.canvas.width;this.canvas.width=rt}},this.deleteHistory=function(){et.info("[Whiteboard] deleteHistory()");var rt=0;apiCC.session!==null&&(rt=apiCC.session.apiCCId),this.refreshCanvas(),this.drawElements=[],this.ghostElements[rt]=null,this.paperSheetId++,this.drawingId=0,this.sendDataToRoom({tool:"void",deleteHistory:!0})},this.setBrushStyle=function(rt,pt){this.ctx!==null&&(this.ctx.strokeStyle=rt,this.ctx.fillStyle=rt,this.ctx.lineWidth=pt)},this.redraw=function(){var rt,pt,ft;for(et.debug("[Whiteboard] redraw()"),this.refreshCanvas(),rt=0;rt<this.drawElements.length;rt++)this.drawSingleObject(this.drawElements[rt]);for(pt=Object.keys(this.ghostElements),rt=0;rt<pt.length;rt++)this.ghostElements[pt[rt]]!==null&&this.drawSingleObject(this.ghostElements[pt[rt]]);for(pt=Object.keys(this.cursors),rt=0;rt<pt.length;rt++)if(this.cursors[pt[rt]]!==null&&this.cursors[pt[rt]].color!=="invisible"&&(this.cursors[pt[rt]].x!==0||this.cursors[pt[rt]].y!==0))switch(ft={fromx:(this.cursors[pt[rt]].x-this.dx)*this.currentScale-13,fromy:(this.cursors[pt[rt]].y-this.dy)*this.currentScale-13,tox:(this.cursors[pt[rt]].x-this.dx)*this.currentScale+13,toy:(this.cursors[pt[rt]].y-this.dy)*this.currentScale+13},this.setBrushStyle(this.cursors[pt[rt]].color,4),this.cursorStyle){case"circle":this.ctx!==null&&(this.ctx.globalAlpha=.4,this.fillEllipse(ft.fromx,ft.fromy,ft.tox,ft.toy),this.drawEllipse(ft.fromx+2,ft.fromy+2,ft.tox-2,ft.toy-2),this.ctx.globalAlpha=1);break;case"cross":this.ctx!==null&&(this.ctx.globalAlpha=.7,this.ctx.beginPath(),this.ctx.moveTo(ft.fromx+(ft.tox-ft.fromx)/2,ft.fromy),this.ctx.lineTo(ft.fromx+(ft.tox-ft.fromx)/2,ft.toy),this.ctx.lineCap="butt",this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(ft.fromx,ft.fromy+(ft.toy-ft.fromy)/2),this.ctx.lineTo(ft.tox,ft.fromy+(ft.toy-ft.fromy)/2),this.ctx.lineCap="butt",this.ctx.stroke(),this.ctx.globalAlpha=1)}},this.addNewDrawing=function(rt){var pt=0;this.drawElements.push(rt),this.drawSingleObject(rt),apiCC.session!==null&&(pt=apiCC.session.apiCCId),rt.userId===pt&&this.laserModeActivated===!0&&this.laserModeProcess(rt.drawingId)},this.drawSingleObject=function(rt){if(this.ctx!==null&&this.canvas!==null){var pt={};switch(this.setBrushStyle(rt.color,rt.width),this.ctx.scale(this.currentScale,this.currentScale),pt.fromx=rt.fromx-this.dx,pt.tox=rt.tox-this.dx,pt.x=rt.x-this.dx,pt.fromy=rt.fromy-this.dy,pt.toy=rt.toy-this.dy,pt.y=rt.y-this.dy,rt.type){case"arrow":this.drawArrow(pt.fromx,pt.fromy,pt.tox,pt.toy);break;case"ellipse":this.drawEllipse(pt.fromx,pt.fromy,pt.tox,pt.toy);break;case"rectangle":this.drawRectangle(pt.fromx,pt.fromy,pt.tox,pt.toy);break;case"pen":this.drawLine(pt.fromx,pt.fromy,pt.tox,pt.toy);break;case"erase":this.eraseArea(pt.fromx,pt.fromy);break;case"text":this.drawText(pt.x,pt.y,rt.text,rt.size,rt.font,rt.border)}this.ctx.scale(1/this.currentScale,1/this.currentScale)}},this.drawLine=function(rt,pt,ft,St){this.ctx!==null&&(this.ctx.beginPath(),this.ctx.moveTo(rt,pt),this.ctx.lineTo(ft,St),this.ctx.lineCap="round",this.ctx.stroke())},this.drawText=function(rt,pt,ft,St,It,xt){if(this.ctx!==null){var At,Dt,wt="Arial";It!=null&&(wt=It),this.ctx.font=St+"px "+wt,this.ctx.fillText(ft,rt,pt),xt!=null&&(At=this.ctx.strokeStyle,Dt=this.ctx.lineWidth,this.ctx.strokeStyle=xt,this.ctx.lineWidth=1,this.ctx.strokeText(ft,rt,pt),this.ctx.strokeStyle=At,this.ctx.lineWidth=Dt)}},this.eraseArea=function(rt,pt){this.ctx!==null&&this.ctx.clearRect(rt-this.ctx.lineWidth-1,pt-this.ctx.lineWidth-1,2*this.ctx.lineWidth+2,2*this.ctx.lineWidth+2)},this.drawArrow=function(rt,pt,ft,St){if(this.ctx!==null){var It=Math.atan2(St-pt,ft-rt);this.ctx.beginPath(),this.ctx.lineCap="butt",this.ctx.moveTo(rt,pt),this.ctx.lineTo(ft,St),this.ctx.stroke(),this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(ft,St),this.ctx.rotate(It+Math.PI/2),this.ctx.moveTo(0,-this.ctx.lineWidth),this.ctx.lineTo(5*this.ctx.lineWidth*.5+1,10+.25*this.ctx.lineWidth),this.ctx.lineTo(-5*this.ctx.lineWidth*.5-1,10+.25*this.ctx.lineWidth),this.ctx.closePath(),this.ctx.restore(),this.ctx.fill()}},this.drawEllipse=function(rt,pt,ft,St){var It=null,xt=null;this.ctx!==null&&(It={x:Math.abs(rt-ft)/2,y:Math.abs(pt-St)/2},xt={x:rt-(rt-ft)/2,y:pt-(pt-St)/2},this.ctx.beginPath(),apiRTC.browser!=="IE"&&this.ctx.ellipse(xt.x,xt.y,It.x,It.y,0,0,2*Math.PI),this.ctx.stroke())},this.fillEllipse=function(rt,pt,ft,St){if(this.ctx!==null){var It={x:Math.abs(rt-ft)/2,y:Math.abs(pt-St)/2},xt={x:rt-(rt-ft)/2,y:pt-(pt-St)/2};this.ctx.beginPath(),apiRTC.browser!=="IE"&&this.ctx.ellipse(xt.x,xt.y,It.x,It.y,0,0,2*Math.PI),this.ctx.fill()}},this.drawRectangle=function(rt,pt,ft,St){if(this.ctx!==null){this.ctx.beginPath();var It=rt,xt=pt;rt>ft&&(It=ft),pt>St&&(xt=St),this.ctx.rect(It,xt,Math.abs(rt-ft),Math.abs(pt-St)),this.ctx.stroke()}},this.getContext=function(){return this.ctx},this.loadPhotoInBackground=function(rt){et.debug("[Whiteboard] loadPhotoInBackground :"+rt);var pt=document.getElementsByTagName("body")[0];pt.style.backgroundImage="url("+rt+")",pt.style.backgroundPosition="50% 50%",pt.style.backgroundRepeat="no-repeat"},this.messageProcessing=function(rt){et.debug("[Whiteboard] messageProcessing");var pt,ft=null,St=null,It=!1,xt=null,At=null,Dt=null,wt=null,Mt=null;if(this.cursors[rt.id]||(et.log("[Whiteboard] messageProcessing - creating cursor for new user : "+rt.id),this.cursors[rt.id]={id:rt.id},this.clients[rt.id]={}),this.cursors[rt.id].x=rt.x,this.cursors[rt.id].y=rt.y,this.cursors[rt.id].lastUpdate=Date.now(),rt.cursorColor&&rt.cursorColor!==null?this.cursors[rt.id].color=rt.cursorColor:this.cursors[rt.id].color="invisible",apiRTC.userAgentInstance===void 0||apiRTC.userAgentInstance.capabilities.whiteboardCursor==="ON"?this.cursors[rt.id].color!=="invisible"&&(It=!0):(et.debug("[Whiteboard] - cursor is not supported on userAgent"),this.cursors[rt.id].color="invisible"),this.ghostElements[rt.id]!==null&&(this.ghostElements[rt.id]=null,It=!0),this.listenedPeers.hasOwnProperty(rt.id))for(xt={id:rt.id,x:rt.x,y:rt.y,tool:rt.tool,drawing:rt.drawing},pt=0;pt<this.listenedPeers[rt.id].length;pt++)typeof this.listenedPeers[rt.id][pt]=="function"?this.listenedPeers[rt.id][pt](xt):et.warn("[Whiteboard] Peer listenener is not a function!");if(rt.drawing&&this.clients[rt.id]&&(et.debug("data.drawing && this.clients[data.id]"),St={fromx:rt.prevX!==void 0?rt.prevX:this.clients[rt.id].x,fromy:rt.prevY!==void 0?rt.prevY:this.clients[rt.id].y,tox:rt.x,toy:rt.y,type:rt.tool!==null?rt.tool:"pen",color:rt.color,width:rt.width,userId:rt.id,drawingId:rt.drawingId},this.GEOMETRY_TOOLS.indexOf(St.type)>-1?rt.prevX&&rt.prevY&&(this.ghostElements[rt.id]=St,It=!0):this.addNewDrawing(St),this.focusOnDrawing&&((ft=this.canvas.parentNode).scrollLeft=this.currentScale*(rt.x-this.dx)-ft.clientWidth/2,ft.scrollTop=this.currentScale*(rt.y-this.dy)-ft.clientHeight/2)),rt.drawObject&&((St=rt.drawObject).color=rt.color,St.width=rt.width,this.ghostElements[rt.id]=null,this.addNewDrawing(St),this.focusOnDrawing&&((ft=this.canvas.parentNode).scrollLeft=this.currentScale*(rt.x-this.dx)-ft.clientWidth/2,ft.scrollTop=this.currentScale*(rt.y-this.dy)-ft.clientHeight/2)),rt.hasOwnProperty("drawObjectsArray"))for(pt=0;pt<rt.drawObjectsArray.length;pt++)this.addNewDrawing(rt.drawObjectsArray[pt]);if(rt.hasOwnProperty("delete"))for(pt=this.drawElements.length-1,It=!0;pt>=0;)rt.delete.indexOf(this.drawElements[pt].drawingId)>-1&&this.drawElements[pt].userId==rt.id&&this.drawElements.splice(pt,1),pt--;if(rt.hasOwnProperty("paperSheetId")){if(rt.paperSheetId<this.paperSheetId)et.debug("[Whiteboard] - data.paperSheetId < this.paperSheetId");else if(rt.paperSheetId>this.paperSheetId){if(et.debug("[Whiteboard] - messageProcessing : peer has a more recent version : "+this.paperSheetId+" vs "+rt.paperSheetId),rt.hasOwnProperty("deleteHistory")&&et.debug("User : "+rt.id+" ,has deleted the history"),rt.hasOwnProperty("drawElements")){for(et.debug("[Whiteboard] - messageProcessing : receiving update from peer"),rt.drawElements!==null?this.drawElements=rt.drawElements:this.drawElements=[],pt=0;pt<this.drawElements.length;pt++)this.drawElements[pt].hasOwnProperty("userId")&&this.drawElements[pt].hasOwnProperty("drawingId")&&(this.clients[this.drawElements[pt].userId]={x:0,y:0,drawing:!1,tool:"pen",cursorColor:null,color:null,width:1,paperSheetId:this.paperSheetId,drawingId:this.drawElements[pt].drawingId,id:this.drawElements[pt].userId});this.paperSheetId=rt.paperSheetId,this.drawingId=0,It=!0}}else if(rt.hasOwnProperty("drawingId"))if(et.debug("[Whiteboard] - data.hasOwnProperty(drawingId): "),rt.drawingId!==0&&this.clients[rt.id]===void 0||this.clients[rt.id]!==void 0&&this.clients[rt.id].hasOwnProperty("drawingId")&&rt.drawingId-this.clients[rt.id].drawingId>1)et.log("[Whiteboard] - messageProcessing : catchup from peer required : "+rt.drawingId),wt=rt.id+"||-1",this.clients[rt.id]!==void 0&&this.clients[rt.id].hasOwnProperty("drawingId")&&(wt=rt.id+"||"+this.clients[rt.id].drawingId),this.sendDataToRoom({tool:"void",needCatchUp:wt});else if(rt.hasOwnProperty("needCatchUp")&&(rt.needCatchUp.startsWith(apiCC.session.apiCCId+"||")||rt.needCatchUp.startsWith("*||"))){for(et.debug("[Whiteboard] - messageProcessing : letting peer catchup: "+rt.id),At=rt.needCatchUp.split("||")[1],Dt=[],pt=0;pt<this.drawElements.length;pt++)(Mt=this.drawElements[pt]).hasOwnProperty("userId")&&Mt.hasOwnProperty("drawingId")&&Mt.userId===apiCC.session.apiCCId&&Mt.drawingId>parseInt(At,10)&&Dt.push(Mt);this.sendDataToRoom({tool:"void",catchUpData:Dt,catchupIndex:At})}else et.debug("[Whiteboard] - else - drawingId");else if(rt.hasOwnProperty("needCatchUp")){for(et.debug("[Whiteboard] - messageProcessing : needCatchUp"+rt.id),At=rt.needCatchUp.split("||")[1],Dt=[],pt=0;pt<this.drawElements.length;pt++)Mt=this.drawElements[pt],Dt.push(Mt);et.debug("[Whiteboard] - sending catchUpData : ",Dt),this.sendDataToRoom({tool:"void",catchUpData:Dt,catchupIndex:At})}else et.debug("[Whiteboard] - else - paperSheetId");if(rt.hasOwnProperty("catchUpData")){for(et.debug("[Whiteboard] - messageProcessing : catching up: "+rt.id),rt.catchUpStatus==="complete"&&(et.debug("catchUpData is complete, cleaning drawElements"),this.drawElements.splice(0,this.drawElements.length)),pt=0;pt<rt.catchUpData.length;pt++)Mt=rt.catchUpData[pt],rt.userId===apiCC.session.apiCCId&&Mt.hasOwnProperty("drawingId")&&this.drawingId<Mt.drawingId&&(this.drawingId=Mt.drawingId+1);this.drawElements=rt.catchUpData.concat(this.drawElements),this.paperSheetId=rt.paperSheetId,It=!0}}It&&this.redraw(),this.clients[rt.id]=rt},this.isStarted=function(){return this.sessionStarted},this.start=function(){this.isStarted()?et.warn("[Whiteboard] WhiteBoardClient is already started"):(et.info("[Whiteboard] starting WhiteBoardClient"),this.isDrawing=!1,this.prev={},this.lastEmit=Date.now(),this.currentScale=1,this.dx=0,this.dy=0,this.drawingId=0,this.clients={},this.listenedPeers={},this.cursors={},this.drawElements=[],this.touchScreenActivated=!1,this.sessionStarted=!0,this.canvas!==null&&(this.canvas.onmousedown=this.onmousedown,this.canvas.onmouseup=this.onmouseup,this.canvas.onmouseleave=this.onmouseleave,this.canvas.onmousemove=this.onmousemove),this.redraw()),apiCC.session!==null&&apiCC.session.roomMgr!==void 0||(et.log("[Whiteboard] roomMgr is not defined, setting offline mode"),this.offline=!0)},this.stop=function(){this.isStarted()?(et.info("[Whiteboard] Stopping WhiteBoardClient"),this.isInRoom()&&this.leaveRoom(),this.sessionStarted=!1,this.canvas!==null&&(this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseleave=null,this.canvas.onmousemove=null,this.touchScreenActivated&&(this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1))),this.drawElements=[],this.ghostElements={},this.redoStack=[]):et.info("[Whiteboard] cannot stop WhiteboardClient as it is not started")},this.getTouchOffSet=function(rt){et.debug("[Whiteboard] getTouchOffSet():");var pt,ft,St,It,xt=null,At={offsetX:0,offsetY:0};return xt=rt.target,pt=window.getComputedStyle(xt,null),ft=parseInt(pt.borderLeftWidth,10),St=parseInt(pt.borderTopWidth,10),It=xt.getBoundingClientRect(),At.offsetX=rt.clientX-ft-It.left,At.offsetY=rt.clientY-St-It.top,et.log("offset.offsetX :"+At.offsetX),et.log("offset.offsetY :"+At.offsetY),At},this.toggleTouchScreen=function(){this.touchScreenActivated===!0?this.deactivateTouchScreen():this.activateTouchScreen()},this.activateTouchScreen=function(){this.canvas!==null?(this.touchScreenActivated=!0,this.canvas.addEventListener("touchstart",this.onTouchStart,!1),this.canvas.addEventListener("touchend",this.onTouchEnd,!1),this.canvas.addEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.addEventListener("touchleave",this.onTouchEnd,!1),this.canvas.addEventListener("touchmove",this.onTouchMove,!1)):et.warn("Trying to activateTouchScreen() while canvas is null.")},this.deactivateTouchScreen=function(){this.canvas!==null?(this.touchScreenActivated=!1,this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1)):et.warn("Trying to deactivateTouchScreen() while canvas is null.")},this.activateLaserMode=function(){this.laserModeActivated=!0},this.deactivateLaserMode=function(){this.laserModeActivated=!1},this.sendDrawingData=function(rt,pt,ft){et.debug("[Whiteboard] sendDrawingData()");var St={x:rt.offsetX,y:rt.offsetY,drawing:pt,prevX:this.prev.x,prevY:this.prev.y};if(pt!==!1||this.userCursorColor!=="invisible"){var It=0;apiCC.session!==null&&(It=apiCC.session.apiCCId),ft!==null&&(St.drawObject=ft,St.drawObject.drawingId=this.drawingId,St.drawObject.userId=It,this.drawingId++),St.drawingId=this.drawingId,this.sendDataToRoom(St)}else et.debug("isDrawing false and userCursorColor invisible - leaving sendDrawingData")},this.onmousedown=(function(rt){rt.preventDefault();var pt,ft,St=rt.target||rt.srcElement,It=St.currentStyle||window.getComputedStyle(St,null),xt=parseInt(It.borderLeftWidth,10)||0,At=parseInt(It.borderTopWidth,10)||0,Dt=St.getBoundingClientRect(),wt={offsetX:this.dx+1/this.currentScale*(rt.clientX-xt-Dt.left),offsetY:this.dy+1/this.currentScale*(rt.clientY-At-Dt.top)};if(this.prev.x=wt.offsetX,this.prev.y=wt.offsetY,this.isDrawing=!0,this.undoIndex++,this.redoStack=[],(pt=document.getElementById(bt))===null||this.instructionsFaded||(mt(pt),this.instructionsFaded=!0),this.currentTool==="erase"){this.sendDrawingData(wt,this.isDrawing,null);var Mt=0;apiCC.session!==null&&(Mt=apiCC.session.apiCCId),this.lastEmit=Date.now(),ft={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,color:this.currentColor,width:this.currentBrushWidth,userId:Mt,drawingId:this.drawingId,undoIndex:this.undoIndex,time:Date.now()},this.drawingId++,this.addNewDrawing(ft),this.redraw()}}).bind(this),this.onmouseup=(function(rt){var pt,ft=null,St=null,It=0,xt=0,At=null,Dt={offsetX:0,offsetY:0},wt=0;this.isDrawing&&this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&(St=(ft=rt.target||rt.srcElement).currentStyle||window.getComputedStyle(ft,null),It=parseInt(St.borderLeftWidth,10)||0,xt=parseInt(St.borderTopWidth,10)||0,At=ft.getBoundingClientRect(),Dt.offsetX=this.dx+1/this.currentScale*(rt.clientX-It-At.left),Dt.offsetY=this.dy+1/this.currentScale*(rt.clientY-xt-At.top),apiCC.session!==null&&(wt=apiCC.session.apiCCId),pt={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,tox:Dt.offsetX,toy:Dt.offsetY,color:this.currentColor,width:this.currentBrushWidth,userId:wt,undoIndex:this.undoIndex,time:Date.now()},this.sendDrawingData(Dt,this.isDrawing,pt),this.ghostElements[wt]=null,this.redraw(),this.addNewDrawing(pt),this.prev.x=Dt.offsetX,this.prev.y=Dt.offsetY),this.isDrawing=!1,this.ghostElements[wt]=null}).bind(this),this.onmouseleave=(function(){var rt=0;apiCC.session!==null&&(rt=apiCC.session.apiCCId),this.isDrawing=!1,this.sendDrawingData({offsetX:0,offsetY:0},this.isDrawing,null),this.ghostElements[rt]=null}).bind(this),this.onmousemove=(function(rt){var pt,ft,St,It,xt,At=null,Dt={};if(pt=(At=rt.target||rt.srcElement).currentStyle||window.getComputedStyle(At,null),ft=parseInt(pt.borderLeftWidth,10)||0,St=parseInt(pt.borderTopWidth,10)||0,It=At.getBoundingClientRect(),Dt.offsetX=this.dx+1/this.currentScale*(rt.clientX-ft-It.left),Dt.offsetY=this.dy+1/this.currentScale*(rt.clientY-St-It.top),Date.now()-this.lastEmit>30)if(this.sendDrawingData(Dt,this.isDrawing,null),this.lastEmit=Date.now(),this.isDrawing){var wt=0;apiCC.session!==null&&(wt=apiCC.session.apiCCId),xt={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,color:this.currentColor,width:this.currentBrushWidth,userId:wt,undoIndex:this.undoIndex,time:Date.now()},this.currentTool==="pen"||this.currentTool==="erase"?(this.currentTool==="pen"&&(xt.tox=Dt.offsetX,xt.toy=Dt.offsetY),xt.drawingId=this.drawingId,this.drawingId++,this.addNewDrawing(xt),this.prev.x=Dt.offsetX,this.prev.y=Dt.offsetY):this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&(xt.tox=Dt.offsetX,xt.toy=Dt.offsetY,this.ghostElements[wt]=xt),this.currentTool!=="pen"&&this.redraw()}else this.currentTool==="erase"&&(this.redraw(),xt={type:"rectangle",fromx:Dt.offsetX-this.currentBrushWidth,fromy:Dt.offsetY-this.currentBrushWidth,tox:parseInt(Dt.offsetX,10)+parseInt(this.currentBrushWidth,10),toy:parseInt(Dt.offsetY,10)+parseInt(this.currentBrushWidth,10),color:"#444444",width:1},this.drawSingleObject(xt),xt.color="#DDDDDD",xt.fromx=xt.fromx-1,xt.fromy=xt.fromy-1,xt.tox=xt.tox+1,xt.toy=xt.toy+1,this.drawSingleObject(xt))}).bind(this),this.onTouchStart=(function(rt){et.debug("[Whiteboard] handleStart"),rt.preventDefault();var pt,ft=rt.changedTouches,St={};this.isDrawing=!0,this.undoIndex++,this.redoStack=[],(St=this.getTouchOffSet(ft[0])).offsetX=this.dx+1/this.currentScale*St.offsetX,St.offsetY=this.dy+1/this.currentScale*St.offsetY,this.prev.x=St.offsetX,this.prev.y=St.offsetY,this.sendDrawingData(St,!1,null),(pt=document.getElementById(bt))!==null&&mt(pt)}).bind(this),this.onTouchEnd=(function(rt){et.debug("[Whiteboard] handleEnd :"+rt);var pt,ft={},St=rt.changedTouches,It=0;this.isDrawing&&this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&((ft=this.getTouchOffSet(St[0])).offsetX=this.dx+1/this.currentScale*ft.offsetX,ft.offsetY=this.dy+1/this.currentScale*ft.offsetY,apiCC.session!==null&&(It=apiCC.session.apiCCId),pt={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,tox:ft.offsetX,toy:ft.offsetY,color:this.currentColor,width:this.currentBrushWidth,userId:It,undoIndex:this.undoIndex,time:Date.now()},this.sendDrawingData(ft,this.isDrawing,pt),this.addNewDrawing(pt),this.prev.x=ft.offsetX,this.prev.y=ft.offsetY),this.isDrawing=!1,this.ghostElements[It]=null,rt=null}).bind(this),this.onTouchCancel=(function(rt){et.debug("[Whiteboard] handleCancel :"+rt);var pt=0;apiCC.session!==null&&(pt=apiCC.session.apiCCId),this.isDrawing=!1,this.ghostElements[pt]=null,rt=null}).bind(this),this.onTouchMove=(function(rt){et.debug("[Whiteboard] handleMove :"+rt);var pt,ft=rt.changedTouches,St={};if(Date.now()-this.lastEmit>30&&((St=this.getTouchOffSet(ft[0])).offsetX=this.dx+1/this.currentScale*St.offsetX,St.offsetY=this.dy+1/this.currentScale*St.offsetY,this.sendDrawingData(St,this.isDrawing,null),this.lastEmit=Date.now(),this.isDrawing)){(St=this.getTouchOffSet(ft[0])).offsetX=this.dx+1/this.currentScale*St.offsetX,St.offsetY=this.dy+1/this.currentScale*St.offsetY;var It=0;apiCC.session!==null&&(It=apiCC.session.apiCCId),pt={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,color:this.currentColor,width:this.currentBrushWidth,userId:It,undoIndex:this.undoIndex,time:Date.now()},this.currentTool==="pen"||this.currentTool==="erase"?(this.currentTool==="pen"&&(pt.tox=St.offsetX,pt.toy=St.offsetY),pt.drawingId=this.drawingId,this.drawingId++,this.addNewDrawing(pt),this.prev.x=St.offsetX,this.prev.y=St.offsetY):this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&(pt.tox=St.offsetX,pt.toy=St.offsetY,this.ghostElements[It]=pt,this.redraw())}}).bind(this)}},8560:(it,ut,s)=>{s.r(ut),s(2772),s(3710),s(9554),s(1539),s(8674),s(561),s(2564),s(8309),s(4916),s(3123),s(1058),s(6992),s(8783),s(3948),s(285),s(1637),s(4363),s(9653),s(9714),s(3843),s(7941),s(4812),s(9575),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(2222),s(9600),s(6755),s(4747),s(2526),s(1817),s(2165);var et=s(1549),ot=s(5945),st=s(8765),Rt=s(1215),ht=s(3173),bt=et.Y.get("RecordManager"),ct=s(4708);function mt(wt,Mt){for(var vt=0;vt<Mt.length;vt++){var Ft=Mt[vt];Ft.enumerable=Ft.enumerable||!1,Ft.configurable=!0,"value"in Ft&&(Ft.writable=!0),Object.defineProperty(wt,Ft.key,Ft)}}s(2707),s(7042),s(9070);var rt=et.Y.get("AudioProcessor"),pt=window.AudioContext||window.webkitAudioContext||!1,ft=function(){function wt(){(function(Ft,Ht){if(!(Ft instanceof Ht))throw new TypeError("Cannot call a class as a function")})(this,wt),this.audioContext=null}var Mt,vt;return Mt=wt,(vt=[{key:"getOrCreateAudioContext",value:function(){return rt.debug("getOrCreateAudioContext"),apiRTC.osName==="iOS"&&typeof cordova<"u"?rt.debug("No audioContext for iOS cordova"):pt&&(this.audioContext=new pt),this.audioContext.state==="suspended"&&this.audioContext.resume().then(function(){rt.debug("AudioContext is resumed")}),this.audioContext}},{key:"listenToAudio",value:function(Ft,Ht){if(rt.debug("listenToAudio()"),Ht!=null&&apiCC.activeSpeakerDetect===!0&&Ht.childStreamType!=="noiseReduction"){rt.debug("activeSpeakerDetect()");var Wt=null,tn=!1,gn=this.getOrCreateAudioContext();gn!=null?(Ht.nodeCtx={},Ht.nodeCtx.sourceNode=gn.createMediaStreamSource(Ft),Ht.nodeCtx.analyserNode=gn.createAnalyser(),Ht.nodeCtx.analyserNode.fftSize=2048,Ht.nodeCtx.sourceNode.connect(Ht.nodeCtx.analyserNode),Ht.nodeCtx.listenToAudioIntervalId=setInterval(function(){var nn,qt,fn=new Uint8Array(Ht.nodeCtx.analyserNode.frequencyBinCount),Cn=0;for(Ht.nodeCtx.analyserNode.getByteFrequencyData(fn),fn.sort(function(Tn,un){return un-Tn}),fn=fn.slice(0,50),qt=0;qt<fn.length;qt++)Cn+=fn[qt];(nn=Cn/fn.length)>255*apiCC.activeSpeakerThreshold&&(tn||(tn=!0,Ht.notifyActiveSpeaker(nn),rt.debug("notifyActiveSpeaker this.userMediaStreamId :",Ht.userMediaStreamId)),Wt!==null&&clearTimeout(Wt),Wt=setTimeout(function(){Ht.notifyNotActiveSpeaker(nn),rt.debug("notifyNotActiveSpeaker this.userMediaStreamId :",Ht.userMediaStreamId),tn=!1},1e3))},100)):rt.error("listenToAudio() - Unable to create audio context")}else rt.debug("activeSpeakerDetecting is not activated or stream type is noiseReduction")}},{key:"checkstopAudioNodeCtxConditions",value:function(Ft){return apiCC.userAgentInstance!==void 0&&apiCC.userAgentInstance.getCapabilities().noiseReduction==="OFF"?"Navigator not compatible with this function":Ft===void 0?"nodeCtx undefined":"OK"}},{key:"stopAudioNodeCtx",value:function(Ft){rt.debug("stopAudioNodeCtx :",Ft);var Ht=this.checkstopAudioNodeCtxConditions(Ft);if(Ht!=="OK")return Ht;Ft.sourceNode!==void 0&&Ft.sourceNode!==null&&(Ft.sourceNode.disconnect(),Ft.sourceNode=null),Ft.analyserNode!==void 0&&Ft.analyserNode!==null&&(Ft.analyserNode.disconnect(),Ft.analyserNode=null),Ft.audioDestination!==void 0&&Ft.audioDestination!==null&&(Ft.audioDestination.disconnect(),Ft.audioDestination=null),Ft.originalMediaTrack!==void 0&&Ft.originalMediaTrack!==null&&(Ft.originalMediaTrack=null),Ft.outputMediaTrack!==void 0&&Ft.outputMediaTrack!==null&&(Ft.outputMediaTrack=null),Ft.listenToAudioIntervalId!==void 0&&Ft.listenToAudioIntervalId!==null&&(clearInterval(Ft.listenToAudioIntervalId),Ft.listenToAudioIntervalId=null),Ft.noiseSuppressorNode!==void 0&&Ft.noiseSuppressorNode!==null&&(Ft.noiseSuppressorNode.port.onmessage=null,Ft.noiseSuppressorNode.port.close(),Ft.noiseSuppressorNode=null)}},{key:"checkChildTypeConditions",value:function(Ft){return apiCC.userAgentInstance!==void 0&&apiCC.userAgentInstance.getCapabilities().noiseReduction==="OFF"?"Navigator not compatible with this function":Ft.childType!==void 0&&Ft.childType==="noiseReduction"?"This stream has already a noiseReduction effect applied : "+Ft.childType:Ft.childrenTypeExists("noiseReduction")?"This stream has already has a noiseReduction sub instance running":"OK"}},{key:"startNoiseReduction",value:function(Ft){var Ht=this,Wt=null,tn=!1;return new Promise(function(gn,nn){rt.debug("startNoiseReduction");var qt=Ht.checkChildTypeConditions(Ft);if(qt!=="OK")return nn(qt);Ft.nodeCtx={},Ft.nodeCtx.originalMediaTrack=Ft.data.getAudioTracks()[0];var fn=apiCC.audioProcessor.getOrCreateAudioContext();Ft.nodeCtx.sourceNode=fn.createMediaStreamSource(Ft.data);var Cn={channelCount:Ft.data.getAudioTracks()[0].getSettings().channelCount,channelCountMode:"explicit"};Ft.nodeCtx.audioDestination=new MediaStreamAudioDestinationNode(fn,Cn),Ft.nodeCtx.outputMediaTrack=Ft.nodeCtx.audioDestination.stream.getAudioTracks()[0],fn.audioWorklet.addModule("https://cdn.apizee.com/apiRTC/lib/noiseReduction/ApiRTC_NR_Worklet_1.0.1.js").then(function(){Ft.nodeCtx.noiseSuppressorNode=new AudioWorkletNode(fn,"NoiseSuppressorWorklet",{parameterData:{activeSpeakerDetect:apiCC.activeSpeakerDetect}}),Ft.nodeCtx.sourceNode.connect(Ft.nodeCtx.noiseSuppressorNode).connect(Ft.nodeCtx.audioDestination);var Tn={audioFilterIsApplied:Ft.audioFilterIsApplied,audioAppliedFilter:Ft.audioAppliedFilter,videoFilterIsApplied:Ft.videoFilterIsApplied,videoAppliedFilter:Ft.videoAppliedFilter,childType:Ft.childType},un=Ft.nodeCtx.audioDestination.stream;Ft.data.getVideoTracks().forEach(function(mn){un.addTrack(mn.clone())}),Ft.createChildStreamFromStream(un,"noiseReduction",Tn).then(function(mn){Ft.addChildren(mn,"noiseReduction"),mn.applyMuteStatusFromParent();var yn=apiCC.getUserMediaStream(Ft.userMediaStreamId);apiCC.audioProcessor.stopAudioNodeCtx(yn.nodeCtx);var pn=apiCC.getUserMediaStream(mn.userMediaStreamId);return Ft.nodeCtx.noiseSuppressorNode.port.onmessage=function(In){In.data.vadScore>apiCC.activeSpeakerThreshold&&(tn||(tn=!0,pn.notifyActiveSpeaker(In.data.vadScore),rt.debug("notifyActiveSpeaker this.userMediaStreamId :",pn.userMediaStreamId)),Wt!==null&&clearTimeout(Wt),Wt=setTimeout(function(){pn.notifyNotActiveSpeaker(In.data.vadScore),rt.debug("notifyNotActiveSpeaker this.userMediaStreamId :",pn.userMediaStreamId),tn=!1},1e3))},gn(mn)}).catch(nn)}).catch(function(Tn){console.error("Error while adding audio worklet module: ",Tn)})})}}])&&mt(Mt.prototype,vt),Object.defineProperty(Mt,"prototype",{writable:!1}),wt}();function St(wt){return St=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Mt){return typeof Mt}:function(Mt){return Mt&&typeof Symbol=="function"&&Mt.constructor===Symbol&&Mt!==Symbol.prototype?"symbol":typeof Mt},St(wt)}var It=et.Y.get("ApiCC_Methods"),xt=s(6075).F;apiCC.myWebRTC_Adapter=new xt,apiCC.myWebRTC_Event=new st.K;var At=apiCC.myWebRTC_Event;apiCC.myEventTable=[],apiCC.ApiCCSession=s(3720).K,apiCC.ApiCCWebRTCClient=s(1192).D,apiCC.ApiCCUserMediaStream=s(7323).q,apiCC.ApiCCPointerSharingClient=s(9213).X,apiCC.ApiCCWhiteBoardClient=s(6527).p,apiCC.ApiCCDataClient=s(128)._,apiCC.ApiCCIMClient=s(6844).U,apiCC.recordMgr=new function(){bt.debug("RecordManager creation"),this.mediaRecorder=null,this.recordedBlobs=[],this.mimeType=null,this.record=function(wt,Mt){var vt=this;return bt.info("record"),bt.log("stream :"+wt),bt.log("stream :",wt),new Promise(function(Ft,Ht){var Wt=null;if(MediaRecorder===void 0)return bt.debug("MediaRecorder is not supported on this browser, leaving recordStream process"),void Ht(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"MediaRecorder is not supported on this browser, leaving recordStream process",bt));if(wt===null)return bt.debug("Stream has no data, cannot record"),void Ht(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"Stream has no data, cannot record",bt));if(vt.mediaRecorder!==null&&(bt.log("this.mediaRecorder.state :"+vt.mediaRecorder.state),vt.mediaRecorder.state==="recording"||vt.mediaRecorder.state==="paused"))return bt.log("mediaRecorder is already ongoing, use stopRecordStream before trying another record"),void Ht(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder is already ongoing, use stopRecordStream before trying another record",bt));if(bt.debug("checking MediaRecorderOptions mimeType support"),Mt!=null?(bt.debug("options is defined :",Mt),Mt.mimeType!==null&&Mt.mimeType!==void 0&&(bt.debug("contentType is defined :",Mt.mimeType),MediaRecorder.isTypeSupported(Mt.mimeType)&&(Wt=Mt.mimeType))):Mt={},Wt===null){var tn="video/webm;codecs=vp8,opus";MediaRecorder.isTypeSupported(tn)||(bt.debug(tn+" is not Supported"),tn="video/webm;codecs=vp9,opus",MediaRecorder.isTypeSupported(tn)||(bt.debug(tn+" is not Supported"),tn="video/webm",MediaRecorder.isTypeSupported(tn)||(bt.debug(tn+" is not Supported"),tn=""))),Mt.mimeType=tn}vt.mimeType=Mt.mimeType,bt.debug("Start record with MediaRecorderOptions :",Mt);try{vt.recordedBlobs=[],vt.mediaRecorder=new MediaRecorder(wt,Mt)}catch(gn){return bt.error("Exception while creating MediaRecorder: "+gn+". mimeType: "+Mt.mimeType),void Ht(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"Exception while creating MediaRecorder: "+gn+". mimeType: "+Mt.mimeType,bt))}vt.mediaRecorder.onstart=function(gn){bt.log("onstart :"+gn),this.onerror=null,Ft()},vt.mediaRecorder.ondataavailable=function(gn){gn.data&&gn.data.size>0&&apiCC.recordMgr.recordedBlobs.push(gn.data)},vt.mediaRecorder.onerror=function(gn){bt.log("onerror :"+gn),Ht(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder error :"+gn,bt)),this.onerror=null},vt.mediaRecorder.start(10),bt.log("MediaRecorder started",vt.mediaRecorder)})},this.stop=function(){var wt=this;return bt.info("stop"),new Promise(function(Mt,vt){return wt.mediaRecorder.onstop=function(Ft){bt.log("mediaRecorder onstop :"+Ft),this.onstart=null,this.onstop=null,this.onerror=null,this.onpause=null,this.onresume=null,this.ondataavailable=null;var Ht=new Blob(apiCC.recordMgr.recordedBlobs,{type:this.mimeType});Mt(Ht)},MediaRecorder===void 0?(bt.debug("MediaRecorder is not supported on this browser, leaving recordStream process"),void vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"MediaRecorder is not supported on this browser, leaving recordStream process",bt))):wt.mediaRecorder===null?(bt.log("mediaRecorder is not running, use startRecordStream before trying to stop"),void vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder is not running, use startRecordStream before trying to stop",bt))):(bt.log("this.mediaRecorder.state :"+wt.mediaRecorder.state),wt.mediaRecorder.state==="inactive"?(bt.log("mediaRecorder is already inactive"),void vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder is already inactive",bt))):void wt.mediaRecorder.stop())})},this.pause=function(){var wt=this;return bt.info("pause"),new Promise(function(Mt,vt){return wt.mediaRecorder===null?(bt.log("mediaRecorder is not running, use startRecordStream before trying to pause"),void vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder is not running, use startRecordStream before trying to pause",bt))):(bt.log("this.mediaRecorder.state :"+wt.mediaRecorder.state),wt.mediaRecorder.state==="paused"?(bt.log("mediaRecorder is already paused"),void vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder is already paused",bt))):wt.mediaRecorder.state==="inactive"?(bt.log("mediaRecorder is inactive"),void vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder is inactive",bt))):(wt.mediaRecorder.onerror=function(Ft){bt.log("onerror :"+Ft),vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder error :"+Ft,bt)),this.onerror=null},wt.mediaRecorder.onpause=function(Ft){bt.log("onpause :"+Ft),this.onerror=null,Mt()},void wt.mediaRecorder.pause()))})},this.resume=function(){var wt=this;return bt.info("resume"),new Promise(function(Mt,vt){return wt.mediaRecorder===null?(bt.log("mediaRecorder is not running, use startRecordStream before trying to resume"),void vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder is not running, use startRecordStream before trying to resume",bt))):(bt.log("this.mediaRecorder.state :"+wt.mediaRecorder.state),wt.mediaRecorder.state==="recording"?(bt.log("mediaRecorder is already recording"),void vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder is already recording",bt))):wt.mediaRecorder.state==="inactive"?(bt.log("mediaRecorder is inactive"),void vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder is inactive",bt))):(wt.mediaRecorder.onerror=function(Ft){bt.log("onerror :"+Ft),vt(Rt.g.createError(ht.g.ERROR_STREAM_RECORD,"mediaRecorder error :"+Ft,bt)),this.onerror=null},wt.mediaRecorder.onresume=function(Ft){bt.log("onresume :"+Ft),this.onerror=null,Mt()},void wt.mediaRecorder.resume()))})}},apiCC.audioProcessor=new ft,apiCC.pendingPromises=[],apiCC.pendingPromisesId=0,ot.$6!=="electron"?s(2746):It.debug("Electron detected, not loading onbeforeunload"),apiCC.addEventListener=function(wt,Mt,vt){var Ft={},Ht=null;["sessionReady","incomingCall","callEstablished","remoteHangup","userMediaSuccess","userMediaError","userMediaStop","error","receiveIMMessage","updatePresence","webRTCClientCreated","updateUserStatus","channelEvent","groupChatCreation","groupChatInvitation","groupChatMemberUpdate","addUserInGroupChatAnswer","receiveGroupChatMessage","userDataAnswer","fetchUserDataAnswer","receiveConversationList","receiveConversationHistory","receiveConversationDetailReport","receiveContactOccurrencesFromConversationList","receiveMCUSessionInvitation","MCUSessionCreation","MCUAvailableStream","MCUAvailableStreamUpdate","MCUAvailableReplay","MCURemoveStream","canPlayRemoteVideo","recordedFileAvailable","receiveData","roomCreation","roomJoined","roomInvitation","roomMemberUpdate","receiveRoomMessage","contactListInRoom","snapShotPhotoUploaded","stopRecord","callAttempt","joinMCUSessionAnswer","hangup","desktopCapture","remoteStreamAdded","localStreamRemoved","remoteStreamRemoved","switchStream","sendDataChannelOpen","sendDataChannelClose","sendDataChannelError","receiveDataChannelOpen","receiveDataChannelClose","receiveDataChannelError","connectedUsersListUpdate","onFileSended","onFileSending","onFileReceiving","onFileReceived","onFileProgress","onFilePending","recordedStreamsAvailable","closingWhiteBoard","webRTCPluginInstallation","onQosStatsUpdate","onQosChange","onQosAudioChange","onCallScoreUpdate","activeSpeaker","stopSpeaking","audioAmplitude","preCallTestStatus","onQosVideoChange","onCallStatsUpdate","cpuLimited","bandwidthLimited","MCURecordedStreamsAvailable","MCURecordingStarted","MCURecordingStopped","ICECandidateTypeUpdate","disconnectionWarning","MCUAvailableComposite","callRestarting","selectedICECandidate","MCUParticipantEjected","MCURoomModeChanged","MCUStreamingStarted","MCUStreamingStopped","mediaDeviceChanged","externalJsLoadingStatus","slowLink","localStreamUpdated","remoteStreamUpdated","simulcastFeedChanged","videoQualityChanged","bandwidthResourceManagement","backgroundSubstractionStopVisibilityChange","backgroundSubstractionStopComputeTime","AIESnapshot","AIELog","cloudEventOccurred"].indexOf(wt)>-1?(wt==="remoteHangup"&&It.warn("DEPRECATED : ApiRTC : remoteHangup event is now deprecated, please use hangup event instead"),It.log("Adding listener on type :"+wt),typeof apiRTC_React<"u"?eventManager.addEventListener(wt,Mt):document.addEventListener?document.addEventListener(wt,Mt,!1):typeof $jqApz<"u"?(It.log("using $jqApz"),$jqApz(document).on(wt,Mt)):typeof jQuery<"u"?(It.log("using jQuery"),jQuery(document).on(wt,Mt)):It.warn("Custom Events not supported on this browser : addEventListener()"),Ft={type:wt,listener:Mt,setBy:vt},Ht=apiCC.myEventTable.push(Ft),It.trace("number of myEventTable:"+Ht)):(At.createErrorEvent("ERROR: Trying to add a listener on an unknow event","UNKNOWN_EVENT_ON_ADDLISTENER"),It.log("ERROR: Trying to add a listener on an unknow event :"+wt))},apiCC.removeEventListener=function(wt,Mt){It.debug("Removing listener on type :"+wt),document.removeEventListener?document.removeEventListener(wt,Mt,!1):typeof jQuery<"u"?jQuery(document).off(wt,Mt):It.log("Custom Events not supported on this browser")},apiCC.setSessionStorage=function(wt,Mt,vt){It.debug("setSessionStorage"),vt=vt||36e5;var Ft=new Date,Ht=new Date;Ht.setTime(Ft.getTime()+vt);try{var Wt=JSON.stringify({value:Mt,expiresAt:Ht});sessionStorage.setItem(wt,Wt)}catch{It.error("Sotheming went wrong during json strigify to set session storage values")}},apiCC.isWebRTCCompliant=function(){It.debug("isWebRTCCompliant");var wt=!1,Mt=!1;return["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(vt){wt||vt in window&&(wt=!0)}),wt===!1?(It.debug("isWebRTCCompliant::isWebRTCSupported false"),!1):(["getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia"].forEach(function(vt){Mt||vt in navigator&&(Mt=!0)}),Mt===!1?(It.debug("isWebRTCCompliant::isWebRTCGUMSupported false or you are connected with HTTP"),!1):ot.Xh==="MIUI Browser"?(It.debug("isWebRTCCompliant::MIUI Browser detected false"),!1):ot.Xh==="UCBrowser"?(It.debug("isWebRTCCompliant::UCBrowser detected false"),!1):ot.Xh==="QQ"||ot.Xh==="QQBrowser"||ot.Xh==="QQBrowserLite"?(It.debug("isWebRTCCompliant::QQ or QQBrowser or QQBrowserLite detected false"),!1):ot.Xh==="Baidu"||ot.Xh==="baidu"?(It.debug("isWebRTCCompliant::Baidu or baidu detected false"),!1):(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&this.webRTCPluginActivated!==!0?(It.debug("isWebRTCCompliant FALSE : IE or Safari"),!1):(It.debug("isWebRTCCompliant:: WebRTC is supported"),!0))},apiCC.isQoSStatCompliant=function(){var wt=!1;return["chrome","firefox"].indexOf(apiCC.browserDetails.type)<0?(It.debug("QoS Statistics is only supported on Chrome and Firefox"),wt):wt=!0},apiCC.isScreenSharingCompliant=function(){var wt=!1;return typeof apiRTC_React<"u"?wt=!0:(ot.Xh==="IE"||ot.BF==="Android"||apiRTC.osName==="iOS"&&typeof cordova<"u"||(ot.Xh==="Chrome"||ot.Xh==="Firefox"&&ot.PR>=52||navigator.getDisplayMedia||navigator.mediaDevices.getDisplayMedia?wt=!0:It.debug("ScreenSharing is not supported")),wt)},apiCC.getMediaDevices=function(){return It.debug("getMediaDevices"),new Promise(function(wt,Mt){if(typeof apiRTC_React<"u")It.log("enumerateDevices() is supported - React Native"),mediaDevices.enumerateDevices().then(function(vt){It.log("enumerateDevices(), sources :",vt),apiCC.mediaDeviceMgr.mediaSourceInfos=vt,wt(vt)}).catch(function(vt){It.log("enumerateDevices(), error :",vt),Mt(vt)});else if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)It.log("enumerateDevices() is supported."),navigator.mediaDevices.enumerateDevices().then(function(vt){It.log("enumerateDevices(), sources :",vt),apiCC.mediaDeviceMgr.mediaSourceInfos=vt,wt(vt)}).catch(function(vt){It.log("enumerateDevices(), error :",vt),Mt(vt)});else if(It.log("enumerateDevices() not supported."),typeof MediaStreamTrack>"u")It.warn("This browser does not support MediaStreamTrack"),Mt(new Error("getMediaDevices() - MediaStreamTrack undefined"));else try{MediaStreamTrack.getSources(wt)}catch(vt){It.debug("catch MediaStreamTrack.getSources :"+vt),Mt(new Error("getMediaDevices() - Error on MediaStreamTrack.getSources :"+vt))}})},apiCC.getMediaDevicesWithCB=function(wt){if(It.debug("getMediaDevicesWithCB"),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)It.log("enumerateDevices() is supported."),navigator.mediaDevices.enumerateDevices().then(wt).catch(function(Mt){It.log("navigator.mediaDevices.enumerateDevices error: ",Mt),Mt=null});else if(It.log("enumerateDevices() not supported."),typeof MediaStreamTrack>"u")wt(null),It.warn("This browser does not support MediaStreamTrack");else try{MediaStreamTrack.getSources(wt)}catch(Mt){It.debug("catch MediaStreamTrack.getSources :"+Mt),wt(null)}},apiCC.getUserMedia=function(wt){return It.info("getUserMedia"),It.debug("with constraints :",wt),new Promise(function(Mt,vt){navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0?(It.debug("webRTC getUserMedia with promises"),navigator.mediaDevices.getUserMedia(wt).then(Mt).catch(vt)):typeof apiRTC_React<"u"?(It.debug("webRTC getUserMedia with promises on React Native"),mediaDevices.getUserMedia(wt).then(Mt).catch(vt)):(It.debug("webRTC getUserMedia without promises"),apiCC.myWebRTC_Adapter.getUserMedia(wt,Mt,vt))})},apiCC.getUserMediaWithCB=function(wt,Mt,vt){It.info("getUserMediaWithCB"),It.debug("with constraints :"+JSON.stringify(wt)),navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0?(It.log("getUserMedia with promises"),navigator.mediaDevices.getUserMedia(wt).then(Mt).catch(vt)):(It.log("getUserMedia without promises"),apiCC.myWebRTC_Adapter.getUserMedia(wt,Mt,vt))},apiCC.userMediaStreamTable=[],apiCC.getUserMediaStreamIds=function(){for(var wt=[],Mt=apiCC.userMediaStreamTable.length;--Mt>=0;)wt.push(apiCC.userMediaStreamTable[Mt].userMediaStreamId);return wt},apiCC.getUserMediaStream=function(wt,Mt){var vt=null,Ft=apiCC.userMediaStreamTable.length;if(wt==null){if(Mt&&typeof Mt.accept=="function"){for(;--Ft>=0;)if(Mt.accept(apiCC.userMediaStreamTable[Ft])===!0){vt=apiCC.userMediaStreamTable[Ft];break}}}else for(;--Ft>=0;)if(apiCC.userMediaStreamTable[Ft].userMediaStreamId===wt){vt=apiCC.userMediaStreamTable[Ft];break}return vt},apiCC.getFirstUserMediaStream=function(){return apiCC.userMediaStreamTable.length>0?apiCC.userMediaStreamTable[0]:null},apiCC.createUserMediaStream=function(wt){var Mt=function(Ht){for(var Wt=apiCC.userMediaStreamTable.length;--Wt>=0;)if(apiCC.userMediaStreamTable[Wt].userMediaStreamId===Ht){apiCC.userMediaStreamTable.splice(Wt,1);break}},vt=new apiCC.ApiCCUserMediaStream,Ft="call";return It.debug("[createUserMediaStream] userMediaStreamId: "+vt.userMediaStreamId),wt==null&&(wt={}),wt.type&&(vt.callType=wt.type),wt.stream?(vt.stream=wt.stream,vt.streamStolen=!0,vt.notifyUserMediaStop=!1,vt.listenForMuteEvents()):wt.gum_config&&(vt.gum_config=(0,ct.S6)(wt.gum_config)),wt.audioSourceId&&(vt.inputs.audioSourceId=wt.audioSourceId),wt.videoSourceId&&(vt.inputs.videoSourceId=wt.videoSourceId),wt.facingMode&&(vt.inputs.facingMode=wt.facingMode),wt.captureSourceType&&(vt.captureSourceType=wt.captureSourceType),wt.notifyUserMediaSuccess&&(vt.notifyUserMediaSuccess=wt.notifyUserMediaSuccess),wt.notifyUserMediaError&&(vt.notifyUserMediaError=wt.notifyUserMediaError),wt.tryAudioCallAfterUserMediaError&&(vt.tryAudioCallAfterUserMediaError=wt.tryAudioCallAfterUserMediaError),wt.displayMediaStreamConstraints&&(vt.displayMediaStreamConstraints=wt.displayMediaStreamConstraints),wt.forceExtensionOnChrome&&(vt.forceExtensionOnChrome=wt.forceExtensionOnChrome),wt.filters&&(vt.filters=wt.filters),wt.callId&&(wt.callFlavor!=="call"&&wt.callFlavor!=="userMedia"||(Ft=wt.callFlavor),vt.stream===null?vt.addCallInfo(wt.callId,Ft,!0):vt.addCallInfo(wt.callId,Ft,!1)),wt.childStreamType&&(vt.childStreamType=wt.childStreamType),vt.callbacks.release=typeof wt.release=="function"?wt.release:function(){},vt.callbacks.success=typeof wt.success=="function"?wt.success:function(){},vt.callbacks.failure=typeof wt.failure=="function"?wt.failure:function(){},apiCC.userMediaStreamTable.push(vt),vt.stream===null?vt.callType==="screenSharing"||vt.callType==="screenSharingWithAudio"?vt.getScreenMedia():vt.callType!=="data"?vt.getUserMedia():wt.sync===!0?(Mt(vt.userMediaStreamId),vt.callbacks.failure(vt,"wrong type")):setTimeout(function(){Mt(vt.userMediaStreamId),vt.callbacks.failure(vt,"wrong type")},0):(vt.updateMediaProperties(vt.stream),wt.sync===!0?vt.callbacks.success(vt):setTimeout(function(){vt.callbacks.success(vt)},0)),vt},apiCC.releaseUserMediaStream=function(wt,Mt,vt){var Ft=!1,Ht=apiCC.userMediaStreamTable.length,Wt=null;if(Mt!==null&&typeof Mt!="string"&&(Mt=null),wt==null){if(vt&&typeof vt.accept=="function"){for(;--Ht>=0;)if(vt.accept(apiCC.userMediaStreamTable[Ht])===!0){if(Mt){if((Wt=apiCC.userMediaStreamTable[Ht].getOwnerCallInfo())===null||Wt.callId!==Mt){apiCC.userMediaStreamTable[Ht].removeCallInfo(Mt);break}}else if((Wt=apiCC.userMediaStreamTable[Ht].getOwnerCallInfo())!==null)break;It.debug("[releaseUserMediaStream] match; userMediaStreamId: "+apiCC.userMediaStreamTable[Ht].userMediaStreamId),apiCC.userMediaStreamTable[Ht].release(),Mt&&apiCC.userMediaStreamTable[Ht].removeCallInfo(Mt),apiCC.userMediaStreamTable.splice(Ht,1),Ft=!0;break}}}else for(;--Ht>=0;)if(apiCC.userMediaStreamTable[Ht].userMediaStreamId===wt){if(Mt){if((Wt=apiCC.userMediaStreamTable[Ht].getOwnerCallInfo())===null||Wt.callId!==Mt){apiCC.userMediaStreamTable[Ht].removeCallInfo(Mt);break}}else if((Wt=apiCC.userMediaStreamTable[Ht].getOwnerCallInfo())!==null)break;It.debug("[releaseUserMediaStream] id; userMediaStreamId: "+apiCC.userMediaStreamTable[Ht].userMediaStreamId),apiCC.userMediaStreamTable[Ht].release(),Mt&&apiCC.userMediaStreamTable[Ht].removeCallInfo(Mt),apiCC.userMediaStreamTable.splice(Ht,1),Ft=!0;break}return Ft},apiCC.activeSpeakerDetect=!1,apiCC.activeSpeakerThreshold=.4,apiCC.enableActiveSpeakerDetecting=function(wt,Mt){apiCC.activeSpeakerDetect=wt,Mt&&(apiCC.activeSpeakerThreshold=Mt)},apiCC.apiRTCExtensionInstalled=!1,apiCC.extensionInstallationSuccessCallback=function(){It.debug("extensionInstallationSuccessCallback"),apiCC.apiRTCExtensionInstalled=!0},apiCC.extensionInstallationFailureCallback=function(wt,Mt){It.debug("extensionInstallationFailureCallback : Error :"+wt+", "+Mt),wt=null,Mt=null,At.createDesktopCaptureEvent("Extension_installation_Error",apiRTC.waitingShareScreenCallId,apiRTC.waitingShareScreenDestNumber,apiRTC.waitingCaptureSourceType)},apiCC.manageNotInstalledExtension=function(wt,Mt,vt){It.debug("manageNotInstalledExtension"),It.warn("apiRTC extension not installed"),At.createDesktopCaptureEvent("Extension_not_installed",wt,Mt),It.warn("Starting apiRTC extension installation"),apiRTC.waitingShareScreenDestNumber=Mt,apiRTC.waitingShareScreenCallId=wt,apiRTC.waitingCaptureSourceType=vt,ot.PR>=71?(It.debug("Chrome >= 71, opening Chrome web Store"),apiRTC.extensionInstallationFailureCallback("Chrome71 : chrome.webstore.install() no more supported","Chrome71-screenShare"),window.open("https://chrome.google.com/webstore/detail/apizee-desktop-capture/mjjnofoemoepfididplbfimokpnpcoeg")):chrome.webstore.install("https://chrome.google.com/webstore/detail/mjjnofoemoepfididplbfimokpnpcoeg",apiRTC.extensionInstallationSuccessCallback,apiRTC.extensionInstallationFailureCallback)},apiCC.activateScreenSharing=function(wt){It.debug("activateScreenSharing");var Mt=null;wt!==void 0?It.log("extensionId is defined :"+wt):(It.log("using apirtc extension's Id"),wt="mjjnofoemoepfididplbfimokpnpcoeg"),ot.Xh==="Chrome"?document.getElementById(wt)!==null?(It.log("extensionLink is present, screenSharing is already activated"),window.postMessage("apiRTC-extension","*")):(It.log("screenSharing is not yet activated"),(Mt=document.createElement("link")).href="https://chrome.google.com/webstore/detail/"+wt,Mt.rel="chrome-webstore-item",Mt.id=wt,document.getElementsByTagName("head")[0].appendChild(Mt),window.addEventListener("message",function(vt){var Ft=null;if(It.log("message: event: "+JSON.stringify(vt.data)),vt.origin==window.location.origin){if(vt.data!=="apiRTC-DeskstopCapture-loaded")return vt.data==="extensionInstalledAndLoaded"?(apiCC.apiRTCExtensionInstalled=!0,apiCC.waitingShareScreenUserMediaStream!==null&&apiCC.waitingShareScreenUserMediaStream!==void 0&&(apiCC.userMediaStreamTable.push(apiCC.waitingShareScreenUserMediaStream[0]),delete apiCC.waitingShareScreenUserMediaStream),void(apiCC.waitingShareScreenUserMediaStreamId&&(Ft=apiCC.getUserMediaStream(apiCC.waitingShareScreenUserMediaStreamId),delete apiCC.waitingShareScreenUserMediaStreamId,Ft&&Ft.getScreenMedia()))):void(St(vt.data)==="object"&&vt.data.desktopId!==void 0&&(vt.data.remoteId!=="getScreenMedia"||(Ft=apiCC.getUserMediaStream(vt.data.callNumber))===null||Ft.registerScreenMedia(vt.data.captureSourceType,vt.data.desktopId)));apiCC.apiRTCExtensionInstalled=!0}}),window.postMessage("apiRTC-extension","*")):(It.log("activateScreenSharing is only available for chrome Browser"),At.createDesktopCaptureEvent("Browser_Not_Compatible",null,null))},apiCC.checkIfAudioSourceIdExistOnDevice=function(wt){It.log("checkIfAudioSourceIdExistOnDevice :",wt);var Mt,vt=!1,Ft=null;if(apiCC.mediaDeviceMgr.mediaSourceInfos!==null)for(Mt=0;Mt<apiCC.mediaDeviceMgr.mediaSourceInfos.length;++Mt)(Ft=apiCC.mediaDeviceMgr.mediaSourceInfos[Mt]).kind!=="audio"&&Ft.kind!=="audioinput"||(Ft.deviceId===wt?(It.log("Audio device present :",wt),vt=!0):It.log("not this deviceId"));return vt},apiCC.setAudioSourceIdInConstraint=function(wt,Mt){return It.log("setAudioSourceIdInConstraint:",Mt),wt==null?It.log("audioSourceId not defined"):Mt.audio===!1?It.log("constraints.audio === false, no audio device present"):apiCC.checkIfAudioSourceIdExistOnDevice(wt)===!1?(It.log("audioSourceId not found on device"),Mt.audio={}):(Mt.audio!==!0&&Mt.audio!==void 0||(Mt.audio={}),It.log("audioSourceId is defined :",wt),ot.ag.name==="iOS"?ot.Xh==="Mobile Safari"||(Mt.audio.deviceId=wt):ot.Xh==="Firefox"&&ot.PR>=50?Mt.audio.deviceId=wt:ot.Xh==="Chrome"&&ot.PR<48||ot.Xh==="Safari"&&ot.PR<11?Mt.audio.optional=[{sourceId:wt}]:Mt.audio.deviceId=wt?{ideal:wt}:void 0),It.debug("constraints =",Mt),Mt},apiCC.checkIfVideoSourceIdExistOnDevice=function(wt){It.log("checkIfVideoSourceIdExistOnDevice :",wt);var Mt,vt=!1,Ft=null;if(It.debug("apiCC.mediaDeviceMgr.mediaSourceInfos :",apiCC.mediaDeviceMgr.mediaSourceInfos),apiCC.mediaDeviceMgr.mediaSourceInfos!==null)for(Mt=0;Mt<apiCC.mediaDeviceMgr.mediaSourceInfos.length;++Mt)(Ft=apiCC.mediaDeviceMgr.mediaSourceInfos[Mt]).kind!=="video"&&Ft.kind!=="videoinput"||(Ft.deviceId===wt?(It.log("Video device present :",wt),vt=!0):It.log("not this deviceId"));return vt},apiCC.getMediaDeviceLabelFromDeviceid=function(wt){It.log("getMediaDeviceLabelFromDeviceid :",wt);var Mt,vt="Not_Found",Ft=null;if(It.debug("apiCC.mediaDeviceMgr.mediaSourceInfos :",apiCC.mediaDeviceMgr.mediaSourceInfos),apiCC.mediaDeviceMgr.mediaSourceInfos!==null)for(Mt=0;Mt<apiCC.mediaDeviceMgr.mediaSourceInfos.length;++Mt)(Ft=apiCC.mediaDeviceMgr.mediaSourceInfos[Mt]).deviceId===wt?(It.log("Video device present :",wt),vt=Ft.label):It.log("not this deviceId");return vt},apiCC.setVideoSourceIdInConstraint=function(wt,Mt){if(It.log("setVideoSourceIdInConstraint : ",Mt),wt==null)It.log("videoSourceId not defined");else if(Mt.video===!1)It.log("constraints.video === false, no video device present");else if(apiCC.checkIfVideoSourceIdExistOnDevice(wt)===!1)It.log("videoSourceId not found on device"),Mt.video={};else if(It.log("videoSourceId is defined :",wt),Mt.video!==!0&&Mt.video!==void 0||(Mt.video={}),ot.ag.name==="iOS")if(ot.Xh==="Mobile Safari"){if(wt){var vt=!1,Ft=ot.ag.version.split(".");Ft.length>0&&parseInt(Ft[0])<13&&(vt=!0),Mt.video.deviceId=vt?{exact:wt}:{ideal:wt}}}else Mt.video.deviceId=wt;else ot.Xh==="Firefox"&&ot.PR>=50?ot.Xh==="Firefox"&&ot.PR>=77?(It.debug("FX > 77 using exact to set deviceId"),Mt.video.deviceId={exact:wt}):Mt.video.deviceId=wt:ot.Xh==="Chrome"&&ot.PR<48||ot.Xh==="Safari"&&ot.PR<11?Mt.video.optional=[{sourceId:wt}]:Mt.video.deviceId=wt?{ideal:wt}:void 0;return It.log("constraints =",Mt),Mt},apiCC.setVideoFacingModeInConstraint=function(wt,Mt){It.log("setVideoFacingModeInConstraint");var vt={};return Mt.video===!1?(It.log("facingMode value is not setted, constraints.video is false"),Mt):wt==null?(It.log("facingMode value is not setted"),Mt):wt!=="user"&&wt!=="environment"&&wt!=="left"&&wt!=="right"?(It.log("facingMode value is not correct"),Mt):(navigator.mediaDevices!==null&&navigator.mediaDevices!==void 0&&navigator.mediaDevices.getSupportedConstraints!==null&&navigator.mediaDevices.getSupportedConstraints!==void 0&&(vt=navigator.mediaDevices.getSupportedConstraints()),vt.hasOwnProperty("facingMode")?(It.log("Setting FacingMode in constraint"),Mt.video===!0&&(Mt.video={}),Mt.video.facingMode={ideal:wt}):It.log("FacingMode not supported by device"),It.debug("constraints =",Mt),Mt)},apiCC.setResolutionInConstraint=function(wt,Mt,vt){return It.log("setResolutionInConstraint"),wt<=0||Mt<=0?(It.log("Resolution value must be positif non null"),vt):(vt.video===!0||vt.video!==void 0?ot.ag.name==="iOS"?ot.Xh==="Mobile Safari"?(vt.video.width=wt?{exact:wt}:void 0,vt.video.height=Mt?{exact:Mt}:void 0):(vt.video.width=wt,vt.video.height=Mt):ot.Xh==="Firefox"&&ot.PR>=50?(vt.video.width=wt,vt.video.height=Mt):ot.Xh==="Safari"&&ot.PR>=11||ot.Xh==="Mobile Safari"||ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"||ot.Xh==="Chrome"&&ot.PR>=49||ot.Xh==="Firefox"&&ot.PR>=50?(vt.video.width=wt?{exact:wt}:void 0,vt.video.height=Mt?{exact:Mt}:void 0):vt.video.mandatory=[{width:wt,height:Mt}]:It.error("setResolutionInConstraint : contraint.video must be true or defined"),It.debug("constraints =",vt),vt)},apiCC.checkConstraintDependingOnDevice=function(wt){It.debug("checkConstraintDependingOnDevice :",wt),ot.Xh==="Mobile Safari"&&ot.PR>=13&&wt.video!==void 0&&wt.video.height!==void 0&&wt.video.width!==void 0&&wt.video.height.ideal===1080&&wt.video.width.ideal===1920&&(It.debug("Downgrading selected height and width resolution on iOS, to avoid stream issue"),wt.video.height.ideal=720,wt.video.width.ideal=1280)},apiCC.attachMediaStream=function(wt,Mt){It.debug("attachMediaStream"),wt!==null?(wt.srcObject!==void 0?wt.srcObject=Mt:wt.mozSrcObject!==void 0?wt.mozSrcObject=Mt:wt.src!==void 0?ot.Xh==="Chrome"&&ot.PR<46?(It.log("Attaching media stream for Chrome < 46"),wt.src=webkitURL.createObjectURL(Mt)):wt.src=URL.createObjectURL(Mt):It.error("Error attaching stream to element."),ot.ag.name==="iOS"&&(It.log("iOS detected"),wt.setAttribute("playsinline",!0))):It.log("videoElt is null")},apiCC.addStreamInDiv=function(wt,Mt,vt,Ft,Ht,Wt,tn){It.debug("addStreamInDiv");var gn,nn=null,qt=null,fn=!1,Cn=null;(0,ct.Ym)(tn,"object")&&tn.type!=null&&(Mt=tn.type),(0,ct.Ym)(tn,"object")&&tn.forceAudioAndVideoMediaElementSeparation!==void 0&&(It.debug("forceAudioAndVideoMediaElementSeparation is set"),fn=!0),Mt==="audio"?nn=document.createElement("audio"):(ot.BF==="iOS"&&ot.Xh==="Mobile Safari"&&(It.debug("iOS && Mobile Safari"),fn=!0),nn=document.createElement("video")),nn.id=Ft,nn.autoplay=!0,fn===!0&&Wt===!1?(It.debug("before adding separated MediaEltAudio"),(Cn=document.createElement("audio")).id=Ft+"_sepAudio",Cn.muted=Wt,Cn.autoplay=!0,nn.muted=!0):nn.muted=Wt,nn.style.width=Ht.width,nn.style.height=Ht.height,Ht.controls===!0&&(nn.controls=!0),gn=function(Tn){var un=null,mn=Tn.play();un=function(){var yn=Tn.play();It.log("funcFixIoS"),yn!==void 0&&yn.then(function(){It.log("Autoplay started"),document.removeEventListener("touchstart",un)}).catch(function(pn){It.error("Autoplay was prevented")})},mn!==void 0&&mn.then(function(){It.log("Autoplay started")}).catch(function(yn){ot.ag.name==="iOS"?(It.warn("iOS : Autoplay was prevented, activating touch event to start media play"),apiCC.myWebRTC_Event.createErrorEvent("ERROR: iOS : Autoplay was prevented","IOS_AUTOPLAY_PREVENTED"),document.addEventListener("touchstart",un)):It.warn("Autoplay was prevented")})},ot.Xh==="Chrome"&&ot.PR==="61"&&ot.BF==="Android"&&(nn.style.borderRadius="1px",It.log("Patch for video display on Chrome 61 Android")),apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId!==void 0&&apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId!==null?(It.log("audioOutputId set to: "+apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId),nn.setSinkId(apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId).then(function(){It.log("Success, audio output device attached")})):It.log("No audioOutputId set"),ot.BF!=="iOS"&&(qt=document.getElementById(vt)).appendChild(nn),wt!==void 0&&(apiCC.attachMediaStream(nn,wt),fn===!0&&Wt===!1&&apiCC.attachMediaStream(Cn,wt)),ot.BF==="iOS"&&(qt=document.getElementById(vt)).appendChild(nn),fn===!0&&Wt===!1&&qt!==null&&qt.appendChild(Cn),gn(nn),fn===!0&&Wt===!1&&gn(Cn)},apiCC.removeElementFromDiv=function(wt,Mt){It.debug("removeElementFromDiv");var vt,Ft,Ht=null;vt=document.getElementById(Mt),Ht=document.getElementById(wt),vt!==null&&(It.log("Removing video element with Id : "+Mt),Ht!==null&&Ht.removeChild(vt)),(Ft=document.getElementById(Mt+"_sepAudio"))!==null&&(It.log("iOS : Removing audio element with Id : "+Mt+"_sepAudio"),Ht!==null&&Ht.removeChild(Ft))},apiCC.randomString=function(wt,Mt){for(var vt=typeof Mt=="string"&&Mt.length>0?Mt:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Ft="";--wt>=0;)Ft+=vt.charAt(Math.floor(Math.random()*vt.length));return Ft},apiCC.generateCallId=function(){var wt;return wt=Number.MAX_SAFE_INTEGER!==void 0?Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():Math.floor(1000001*Math.random()).toString(),It.debug("new callId :"+wt),wt},apiCC.generateInstanceId=function(){var wt;return wt=Number.MAX_SAFE_INTEGER!==void 0?Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():Math.floor(1000001*Math.random()).toString(),It.debug("new instanceId :"+wt),wt},apiCC.myApiCCWhiteBoardClient=null,apiCC.createWhiteBoard=function(wt,Mt,vt,Ft){return It.debug("createWhiteBoard"),apiCC.myApiCCWhiteBoardClient=new apiCC.ApiCCWhiteBoardClient(apiCC.session,wt,Mt,vt,Ft),apiCC.myApiCCWhiteBoardClient},apiCC.closeWhiteBoardClient=function(wt){It.info("closeWhiteBoardClient"),At.createClosingWhiteBoardEvent(apiCC.myApiCCWhiteBoardClient.roomId,wt),apiCC.myApiCCWhiteBoardClient.isInRoom()&&apiCC.myApiCCWhiteBoardClient.leaveRoom(),apiCC.myApiCCWhiteBoardClient.stop()},apiCC.registerIOsDevice=function(wt){It.debug("call registerIOsDevice 1");var Mt={type:"registerIOsDevice",senderId:apiCC.session.apiCCId,token:wt},vt=JSON.stringify(Mt);It.debug("call registerIOsDevice "+vt),apiCC.session.channel.socket.emit("registerIOsDevice",vt),It.debug("call registerIOsDevice  done")},apiCC.registerAndroidDevice=function(wt){It.debug("registerAndroidDevice");var Mt={type:"registerAndroidDevice",senderId:apiCC.session.apiCCId,token:wt},vt=JSON.stringify(Mt);apiCC.session.channel.socket.emit("registerAndroidDevice",vt)},apiCC.unRegisterIOsDevice=function(wt){It.debug("unRegisterIOsDevice");var Mt={type:"unRegisterIOsDevice",senderId:apiCC.session.apiCCId,token:wt},vt=JSON.stringify(Mt);apiCC.session.channel.socket.emit("unRegisterIOsDevice",vt)},apiCC.unRegisterAndroidDevice=function(wt){It.debug("unRegisterAndroidDevice");var Mt={type:"unRegisterAndroidDevice",senderId:apiCC.session.apiCCId,token:wt},vt=JSON.stringify(Mt);apiCC.session.channel.socket.emit("unRegisterAndroidDevice",vt)},apiCC.storeSessionInfoInSessionStorage=function(){var wt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(It.info("storeSessionInfoInSessionStorage",wt),apiCC.session){var Mt=5e3;(0,ct.ki)(apiCC.session,"apiCCIdPersistenceTimeout","number")&&apiCC.session.apiCCIdPersistenceTimeout>=0&&(Mt=apiCC.session.apiCCIdPersistenceTimeout),(0,ct.Ym)(wt.apiCCIdPersistenceTimeout,"number")&&wt.apiCCIdPersistenceTimeout>=0&&(Mt=wt.apiCCIdPersistenceTimeout),apiCC.setSessionStorage("apiCCId",apiCC.session.apiCCId,Mt),apiCC.setSessionStorage("apiKey",apiCC.session.apiKey,Mt),apiCC.session.sessionId!==null&&apiCC.setSessionStorage("sessionId",apiCC.session.sessionId,Mt)}},apiCC.disconnect=function(){var wt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};It.info("disconnect",wt),apiCC!==null&&apiCC.cleanAllEventListener(wt),apiCC.session!==null&&apiCC.session!==void 0&&(typeof apiRTC_React>"u"&&wt.invalidateApiCCId!==!0&&apiCC.storeSessionInfoInSessionStorage(wt),apiCC.myApiCCWhiteBoardClient!==null&&(It.log("apiCC.myApiCCWhiteBoardClient.roomId :"+apiCC.myApiCCWhiteBoardClient.roomId),apiCC.myApiCCWhiteBoardClient.roomId!==null&&apiCC.closeWhiteBoardClient("USER_DISCONNECTION")),It.log("Disconnecting from Server"),apiCC.session.channel.socket!==void 0&&apiCC.session.channel.socket!==null&&apiCC.session.channel.socket.disconnect(),apiCC.session.channel.channelHasBeenDisconnected=!1,apiCC.session.connectedUsersList.splice(0,apiCC.session.connectedUsersList.length)),apiCC&&(apiCC.session=null,apiCC.jsLoaded=!1)},apiCC.reconnect=function(){It.log("Reconnect"),It.log("apiCC.session.channel.socket:",apiCC.session.channel.socket),apiCC.session.channel.socket.socket.connect()},apiCC.cleanApiRTCContext=function(){apiCC.session!==null&&apiCC.session!==void 0&&(apiCC.session.apiCCWebRTCClient!==null&&apiCC.session.apiCCWebRTCClient!==void 0&&(apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length!==0&&It.warn("Call is still established and will be disconnected"),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs.length>0&&It.log("MCU session is still established and will be disconnected"),apiCC.session.apiCCWebRTCClient.hangUp(),apiCC.session.apiCCWebRTCClient.webRTCClient.localStream!==null&&(apiCC.session.apiCCWebRTCClient.webRTCClient.stopStream(apiCC.session.apiCCWebRTCClient.webRTCClient.localStream),At.createUserMediaStopEvent(null,"media")),apiCC.session.apiCCWebRTCClient=null),apiCC.session.apiCCIMClient!==null&&apiCC.session.apiCCIMClient!==void 0&&(apiCC.session.apiCCIMClient=null),apiCC.session.apiCCDataClient!==null&&apiCC.session.apiCCDataClient!==void 0&&(apiCC.session.apiCCDataClient=null),apiCC.myApiCCWhiteBoardClient!==null&&apiCC.myApiCCWhiteBoardClient!==void 0&&(apiCC.myApiCCWhiteBoardClient=null))},apiCC.cleanAllEventListener=function(){var wt,Mt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},vt=0;if(apiCC!==null&&apiCC.myEventTable!==null&&(vt=apiCC.myEventTable.length),vt!==0){for(It.trace("number of myEventTable:"+vt),wt=0;wt<vt;wt+=1)Mt.unregister===!0&&apiCC.myEventTable[wt].setBy==="UserAgent"?It.debug("Keeping event for UserAgent process"):apiCC.removeEventListener(apiCC.myEventTable[wt].type,apiCC.myEventTable[wt].listener);apiCC.myEventTable.splice(0,vt),vt=apiCC.myEventTable.length,It.trace("number of myEventTable after splice:"+vt)}},apiCC.testUserPing=function(wt){It.debug("testUserPing()");var Mt,vt,Ft,Ht,Wt=apiCC.bandwidthTestServer+"/upload-test",tn=new XMLHttpRequest,gn=new FormData,nn=Math.round(5*Math.random()),qt=!1;"withCredentials"in tn?tn.open("POST",Wt,!0):typeof XDomainRequest<"u"?(tn=new XDomainRequest).open("POST",Wt):tn=null,Mt=new Blob([nn],{type:"text/xml"}),gn.append("file",Mt),tn?(tn.onload=function(){tn.status===200&&(Ht=Date.now()-vt,qt||(clearTimeout(Ft),wt(null,Ht)))},tn.onerror=function(fn){It.log("testUserUpload onerror status :",fn.target.status),wt({err:"An error occured during XMLHttpRequest",msg:fn.target.status},null)},Ft=setTimeout(function(){qt=!0,wt("Ping timeout",-1)},5e3),tn.send(gn),vt=Date.now()):wt({err:"XMLHttpRequest is not defined",msg:"XMLHttpRequest is not defined"},null)},apiCC.testUserDownload=function(wt,Mt){It.debug("testUserDownload()");var vt,Ft,Ht,Wt,tn,gn,nn=apiCC.bandwidthTestServer+"/files/noise_"+wt+"ko.jpg",qt=0,fn=new Image,Cn=0;nn+="?nnn="+Date.now();var Tn=[[256,257529],[500,525944],[768,787234],[1e3,1055741],[1500,1541044],[2e3,1992034],[2500,2596028],[3e3,2904977],[3500,3648299],[4e3,4151187],[4500,4741712],[5e3,5264577],[5500,5776081],[6e3,6318553],[6500,6779868],[7e3,7334256],[7500,7874040],[8e3,8081460],[8500,8651795],[9e3,9081899],[9500,9503574],[1e4,10082008],[10500,10543425],[11e3,11200424],[11500,11200424],[12e3,12110671],[12500,12715962],[13e3,13222120],[13500,13605073],[14e3,13954769],[14500,14777594],[15e3,15178928],[15500,15602106],[16e3,16054618],[16500,16578623],[17e3,17048069],[17500,17456403],[18e3,17910332],[18500,18725846],[19e3,19284746],[19500,19771902],[2e4,20121527],[21e3,20975042],[22e3,22189200],[23e3,23027928],[24e3,24027870],[25e3,24878845],[26e3,26237503],[27e3,27112004],[28e3,27953446],[29e3,29313013],[3e4,30474095]];for(tn=0;tn<Tn.length;tn++)wt===Tn[tn][0]&&(qt=Tn[tn][1]);apiCC.testUserPing(function(un,mn){fn.onload=function(){for((Ft=Date.now()-vt)-mn>10&&(Ft-=mn),Ht=qt/(Ft/1e3),Wt=Math.round(Ht/1e3),gn={type:"download",kBPerSec:Wt},tn=0;tn<apiCC.bandwidthRatingThresholds.length;tn++)8*gn.kBPerSec>=apiCC.bandwidthRatingThresholds[tn]&&Cn++;gn.rating=Cn+"/"+apiCC.bandwidthRatingThresholds.length,Mt(null,gn)},fn.onerror=function(yn,pn){Mt({label:"Error when downloading",err:yn,msg:pn},null)},vt=new Date().getTime(),fn.src=nn})},apiCC.testUserUpload=function(wt,Mt){It.debug("testUserUpload()");var vt,Ft,Ht,Wt,tn,gn,nn,qt=apiCC.bandwidthTestServer+"/upload-test",fn=new XMLHttpRequest,Cn=new FormData,Tn="",un=0;for(("withCredentials"in fn)?fn.open("POST",qt,!0):typeof XDomainRequest<"u"?(fn=new XDomainRequest).open("POST",qt):fn=null,Ft=0;Ft<wt;Ft++)Tn+=Math.round(5*Math.random());vt=new Blob([Tn],{type:"text/xml"}),Cn.append("file",vt),fn?(fn.onload=function(){if(fn.status===200){for(tn=Date.now()-Wt,gn=wt/(tn/1e3),nn=Math.round(gn/1e3),Ht={type:"upload",kBPerSec:nn},Ft=0;Ft<apiCC.bandwidthRatingThresholds.length;Ft++)8*Ht.kBPerSec>=apiCC.bandwidthRatingThresholds[Ft]&&un++;Ht.rating=un+"/"+apiCC.bandwidthRatingThresholds.length,Mt(null,Ht)}else Mt({err:"An error occured during XMLHttpRequest",msg:fn.status},null)},fn.onerror=function(mn){It.log("testUserUpload onerror status :",mn.target.status),Mt({err:"An error occured during XMLHttpRequest",msg:mn.target.status},null)},fn.send(Cn),Wt=Date.now()):Mt({err:"XMLHttpRequest is not defined",msg:"XMLHttpRequest is not defined"},null)},apiCC.testUserUploadLoop=function(wt,Mt,vt){var Ft={type:"upload",kBPerSec:Mt.kbps/8,kbps:Mt.kbps,rating:Mt.rating},Ht=0;Mt.kbps>1e3?apiCC.testUserUpload(wt,function(Wt,tn){Wt!==null?vt({err:"An error occured during XMLHttpRequest"},null):(Ft.kBPerSec=tn.kBPerSec,Ft.kbps=8*tn.kBPerSec,Ft.rating=tn.rating,Ht=Ft.kbps-Mt.kbps,It.debug("upload "+wt+" "+JSON.stringify(Ft)+"; diff "+Ht),Ht>=2e4&&wt<12e6?apiCC.testUserUploadLoop(wt+8e6,Ft,vt):Ht>=1e4&&wt<14e6?apiCC.testUserUploadLoop(wt+6e6,Ft,vt):Ht>=5e3&&wt<16e6?apiCC.testUserUploadLoop(wt+4e6,Ft,vt):Ht>=1e3&&wt<18e6?apiCC.testUserUploadLoop(wt+2e6,Ft,vt):Ht>=200&&wt<19e6?apiCC.testUserUploadLoop(wt+1e6,Ft,vt):vt(null,Ft))}):vt(null,Ft)},apiCC.testUserDownloadLoop=function(wt,Mt,vt){var Ft={type:"download",kBPerSec:Mt.kbps/8,kbps:Mt.kbps,rating:Mt.rating},Ht=0;Mt.kbps>=3500?apiCC.testUserDownload(wt,function(Wt,tn){Wt!==null?vt({err:"Error when downloading"},null):(Ft.kBPerSec=tn.kBPerSec,Ft.kbps=8*tn.kBPerSec,Ft.rating=tn.rating,Ht=Ft.kbps-Mt.kbps,It.debug("download "+wt+" "+JSON.stringify(Ft)+"; diff "+Ht),Ht>=2e4?apiCC.testUserDownloadLoop(3e4,Ft,vt):Ht>=1e4&&wt<=2e4?apiCC.testUserDownloadLoop(wt+1e4,Ft,vt):Ht>=5e3&&wt<=25e3?apiCC.testUserDownloadLoop(wt+5e3,Ft,vt):Ht>=1e3&&wt<=27e3?apiCC.testUserDownloadLoop(wt+3e3,Ft,vt):Ht>=200&&wt<=29e3?apiCC.testUserDownloadLoop(wt+1e3,Ft,vt):vt(null,Ft))}):vt(null,Ft)},apiCC.listenedAudioSources={};var Dt=window.AudioContext||window.webkitAudioContext||!1;apiCC.audioContext=null,apiCC.getAudioContext=function(){return apiRTC.osName==="iOS"&&typeof cordova<"u"?It.debug("No audioContext for iOS cordova"):Dt&&apiCC.audioContext===null&&(apiCC.audioContext=new Dt),apiCC.audioContext},apiCC.listenToAudioSources=function(wt){It.debug("listenToAudioSources()");var Mt,vt=apiCC.getAudioContext();vt!=null?(Object.keys(apiCC.listenedAudioSources).length>0&&apiCC.stopAudioSourceListening(),apiCC.getMediaDevices().then(function(Ft){for(It.log(Ft),Mt=0;Mt<Ft.length;Mt++)Ft[Mt].kind==="audioinput"&&(apiCC.listenedAudioSources[Ft[Mt].deviceId]={deviceId:Ft[Mt].deviceId,callback:wt,label:Ft[Mt].label},navigator.getUserMedia({audio:{optional:[{sourceId:Ft[Mt].deviceId}]},video:!1},(function(Ht){It.log("new stream processing function for : "+this.device.deviceId),this.device.audioListener=this;var Wt=this,tn=vt.createScriptProcessor(2048,1,1),gn=vt.createMediaStreamSource(Ht);tn.connect(vt.destination),tn.onaudioprocess=function(){var nn,qt,fn,Cn=new Uint8Array(this.analyser.frequencyBinCount),Tn=0;for(this.analyser.getByteFrequencyData(Cn),qt=0;qt<Cn.length;qt++)Tn+=Cn[qt];nn=Tn/Cn.length,fn={deviceId:Wt.device.deviceId,label:Wt.device.label,amplitude:nn,active:Ht.active},Wt.device.callback(fn)},tn.analyser=vt.createAnalyser(),tn.analyser.smoothingTimeConstant=.3,tn.analyser.fftSize=1024,gn.connect(tn.analyser),tn.analyser.connect(tn),this.destroy=function(){It.log("destroy()");var nn,qt=Ht.getTracks();for(nn=0;nn<qt.length;nn+=1)qt[nn].stop();gn.disconnect(),tn.analyser.disconnect(),tn.disconnect()}}).bind({device:apiCC.listenedAudioSources[Ft[Mt].deviceId]}),function(Ht){It.error("Error getting microphone",Ht)}))},function(Ft){It.debug("listenToAudioSources() - getMediaDevices error :",Ft)})):It.debug("listenToAudioSources() - Unable to create audio context")},apiCC.stopAudioSourceListening=function(){var wt;for(It.debug("stopAudioSourceListening()"),wt=0;wt<Object.keys(apiCC.listenedAudioSources).length;wt++)apiCC.listenedAudioSources[Object.keys(apiCC.listenedAudioSources)[wt]]!==void 0?apiCC.listenedAudioSources[Object.keys(apiCC.listenedAudioSources)[wt]].audioListener!==void 0?apiCC.listenedAudioSources[Object.keys(apiCC.listenedAudioSources)[wt]].audioListener.destroy():It.warn("error on stopAudioSourceListening, audioListener"):It.warn("error on stopAudioSourceListening, listenedAudioSources element");apiCC.listenedAudioSources={}},apiCC.webRTCPluginInstalled=!1,apiCC.iePluginInstallationPreventUnload=!1,apiCC.setlogStorageActivated=function(wt,Mt){It.debug("setlogStorageActivated :",wt),this.logStorageActivated=(wt===!0||wt===!1)&&wt,Mt!==void 0&&(this.logStorageLevel=Mt)},apiCC.sendLogToCloud=function(wt,Mt,vt,Ft){It.info("sendLogToCloud");var Ht,Wt,tn=[],gn=null,nn=[],qt=null,fn=null;for(tn.push(JSON.stringify({title:"ApiRTC logs",description:"Logs of apiRTC client"})),tn.push(JSON.stringify({ts:Date.now(),name:"system-info",args:{browserName:apiCC.browser,browserVersion:apiCC.browser_version,platform:apiCC.osName}})),Ht=0;Ht<wt.length;Ht++)gn=wt[Ht][0]==="error"?{name:"test-run",args:{error:wt[Ht][1]}}:{name:"test-run",args:{info:wt[Ht][1]}},tn.push(JSON.stringify(gn));nn=tn.concat(apiCC.logStorage),qt=new FormData,Wt="["+nn.join(`,
`)+"]",It.debug("fileContent :",Wt),Ft!==!0&&(qt.append("data",Wt),qt.append("apiKey",apiCC.initApiKey),Mt!==void 0&&qt.append("id",Mt),(fn=new XMLHttpRequest).open("POST",vt+"/test/api/",!0),fn.onreadystatechange=function(){fn.readyState===4&&fn.status===200&&console.info("[apiRTC_Logs] POST'd successfully"),console.trace(fn.responseText)},fn.send(qt))},apiCC.manageWebRTCPlugin=function(wt,Mt){It.debug("manageWebRTCPlugin");var vt;vt=window.location.protocol!=="https:"?"http":"https",_e([vt+"://cdn.temasys.io/adapterjs/0.15.x/adapter.debug.js"],"temAdapter",{async:!0,numRetries:apiCC.extJsLoadingRetryNb||100,reqdelay:apiCC.extJsLoadingRetryDelay||200,success:function(){It.log("End of .js loading for plugin"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("temAdapter","loaded"),AdapterJS.WebRTCPlugin.isPluginInstalled(AdapterJS.WebRTCPlugin.pluginInfo.prefix,AdapterJS.WebRTCPlugin.pluginInfo.plugName,AdapterJS.WebRTCPlugin.pluginInfo.type,function(){apiCC.myWebRTC_Adapter.RTCSessionDescription=RTCSessionDescription,apiCC.myWebRTC_Adapter.RTCIceCandidate=RTCIceCandidate,apiCC.myWebRTC_Adapter.RTCPeerConnection=RTCPeerConnection,apiCC.myWebRTC_Adapter.getUserMedia=navigator.getUserMedia,apiCC.attachMediaStream=attachMediaStream,AdapterJS.webRTCReady(function(Ft){return It.log("webRTCReady, plugin already installed"),wt()})},function(){return apiCC.iePluginInstallationPreventUnload=!0,Mt(),AdapterJS.webRTCReady(function(Ft){return It.log("webRTCReady after plugin install"),apiCC.iePluginInstallationPreventUnload=!1,apiCC.myWebRTC_Adapter.RTCSessionDescription=RTCSessionDescription,apiCC.myWebRTC_Adapter.RTCIceCandidate=RTCIceCandidate,apiCC.myWebRTC_Adapter.RTCPeerConnection=RTCPeerConnection,apiCC.myWebRTC_Adapter.getUserMedia=navigator.getUserMedia,apiCC.attachMediaStream=attachMediaStream,wt()}),apiCC.session.apiCCWebRTCClient.myWebRTC_Event.createEvent({eventType:"webRTCPluginInstallation"}),null})},error:function(Ft){It.error("temAdapter loading error"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("temAdapter","error")},retrycb:function(Ft,Ht){It.warn("temAdapter loading retry :"+Ft+" ,delay before retry :"+Ht),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("temAdapter","retry")}})},apiCC.checkMutingStateForUserMedia=function(wt,Mt){It.debug("checkMutingStateForUserMedia"),(0,ct.ki)(wt,"muted","string")&&(It.log("callConfiguration muted is set :",wt.muted),wt.muted==="VIDEO"&&(Mt.muteVideoOnStreams("enabled"),Mt.muteAudioOnStreams("enabled")),wt.muted==="AUDIOONLY"&&Mt.muteAudioOnStreams("enabled"),wt.muted==="VIDEOONLY"&&Mt.muteVideoOnStreams("enabled"))},apiCC.isSIPNumber=function(wt){var Mt,vt=null,Ft=!1;return Mt=wt.toString().startsWith("sip:"),wt.toString().length<=20&&(vt=!0),(wt.toString().indexOf("0")!==0&&wt.toString().indexOf("+")!==0||vt!==!0)&&Mt!==!0||(Ft=!0),Ft},apiCC.loadSentry=function(wt,Mt){It.debug("Remote logging activation"),_e([Mt+"://browser.sentry-cdn.com/5.24.2/bundle.tracing.min.js"],"Sentry",{async:!0,numRetries:10,reqdelay:500,success:function(){Sentry.init({dsn:"https://c24c226714f841dbbc3d1518b6cc7fe8@o333237.ingest.sentry.io/5448622",release:apiCC.version,tracesSampleRate:1}),Sentry.configureScope(function(vt){vt.setTag("apiKey",wt)})},error:function(vt){console.error("Remote logging - loading error")},retrycb:function(vt,Ft){console.warn("Remote logging - loading retry :"+vt+" ,delay before retry :"+Ft)}})},apiCC.sendSentryEvent=function(wt){if(It.debug("sendSentryEvent",wt),typeof Sentry<"u"){var Mt="",vt={};wt.eventType==="muteUnmuteEvent"?(Mt="Mute event on callId:"+wt.callId,vt.muteType=wt.muteType,vt.source=wt.source,vt.mLine=wt.mLine,vt.state=wt.state,vt.callId=wt.callId,vt.username=wt.username):It.error("sendSentryEvent error : type ",wt.eventType," is not supported");var Ft=Object.keys(vt);Mt!==""&&Ft.length>0&&Sentry.withScope(function(Ht){Ft.forEach(function(Wt){Ht.setTag(Wt,vt[Wt])}),Sentry.captureMessage(Mt)})}else It.debug("Sentry not activated")},apiCC.addPendingPromise=function(wt,Mt,vt){var Ft=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5e3;It.debug("addPendingPromise"),apiCC.pendingPromisesId++;var Ht=function(tn){apiCC.cleanPendingPromiseTable(tn),vt("Timeout problem during ".concat(wt," process on a remote stream"))},Wt=setTimeout(function(){Ht(apiCC.pendingPromisesId)},Ft);return apiCC.pendingPromises.push({timeout:Wt,resolve:Mt,reject:vt,pendingPromisesId:apiCC.pendingPromisesId}),Wt},apiCC.resolvePendingPromise=function(wt,Mt){It.debug("resolvePendingPromise"),apiCC.pendingPromises.forEach(function(vt){wt===vt.timeout&&(clearTimeout(wt),vt.resolve(Mt),apiCC.cleanPendingPromiseTable(vt.pendingPromisesId))})},apiCC.rejectPendingPromise=function(wt,Mt){It.debug("rejectPendingPromise"),apiCC.pendingPromises.forEach(function(vt){wt===vt.timeout&&(clearTimeout(wt),vt.reject(Mt),apiCC.cleanPendingPromiseTable(vt.pendingPromisesId))})},apiCC.cleanPendingPromiseTable=function(wt){apiCC.pendingPromises.forEach(function(Mt,vt){wt===Mt.pendingPromisesId&&apiCC.pendingPromises.splice(vt,1)})}},5945:(it,ut,s)=>{s.d(ut,{$6:()=>St,AA:()=>At,Ak:()=>ft,BF:()=>ct,Cm:()=>pt,E2:()=>ot,MM:()=>mt,Ne:()=>xt,PR:()=>ht,TI:()=>Dt,Xh:()=>st,ag:()=>bt,cf:()=>It,dc:()=>Rt,vO:()=>rt}),s(8309),s(2772),s(9064);var et,ot=null,st=null,Rt=null,ht=null,bt=null,ct=null,mt=null,rt=null,pt=null,ft=null,St=null,It=null,xt=null,At=null,Dt=null;et=(ot=new UAParser).getBrowser(),bt=ot.getOS(),It=ot.getBrowser(),typeof apiRTC_React<"u"?(Rt=DeviceInfo.getSystemVersion(),ct=DeviceInfo.getSystemName(),st=DeviceInfo.getUserAgent(),rt=DeviceInfo.getModel()):(Rt=et.version||"Unknown",ct=ot.getOS().name||"Unknown",mt=ot.getOS().version||"Unknown",st=et.name||"Unknown",xt=ot.getCPU().architecture||"Unknown",rt=ot.getDevice().type||"Unknown",pt=ot.getDevice().vendor||"Unknown",ft=ot.getDevice().model||"Unknown",At=ot.getEngine().name||"Unknown",Dt=ot.getEngine().version||"Unknown"),ht=Rt!==void 0?et.major:99,window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase().indexOf(" electron/")>=0&&(St="electron")},4708:(it,ut,s)=>{function et(Dt){return et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(wt){return typeof wt}:function(wt){return wt&&typeof Symbol=="function"&&wt.constructor===Symbol&&wt!==Symbol.prototype?"symbol":typeof wt},et(Dt)}s.d(ut,{Pj:()=>Rt,S6:()=>mt,Wc:()=>ct,Ym:()=>It,_C:()=>st,cw:()=>St,dD:()=>bt,fS:()=>At,ki:()=>xt,wL:()=>pt,ws:()=>rt,yJ:()=>ht}),s(4603),s(4916),s(9714),s(3123),s(9600),s(1249),s(7941),s(4723),s(1058),s(6992),s(9575),s(1539),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(9753),s(7042),s(2526),s(1817),s(2165),s(8783),s(3948);var ot=s(1549).Y.get("Utils");function st(Dt){return new RegExp("^[0-9-.]*$","g").test(Dt)}function Rt(){return typeof apiRTC_React<"u"||window.location.protocol==="https:"}function ht(){return typeof apiRTC_React>"u"&&window.location.protocol==="http:"}function bt(Dt){var wt,Mt,vt,Ft,Ht={};for(vt=0,Ft=(wt=Dt.split("&")).length;vt<Ft;vt++)Ht[(Mt=wt[vt].split("="))[0]]=Mt[1];return Ht}function ct(Dt){return Object.keys(Dt).map(function(wt){return wt+"="+Dt[wt]}).join("&")}function mt(Dt,wt){ot.debug("mergeJSON");var Mt={},vt=null;if(Dt)for(vt in Dt)Dt.hasOwnProperty(vt)&&(Mt[vt]=Dt[vt]);if(wt)for(vt in wt)wt.hasOwnProperty(vt)&&(Mt[vt]=wt[vt]);return ot.log(Mt),Mt}var rt=function(Dt,wt){var Mt,vt,Ft;for(Dt==null&&(Dt={}),Mt=1;Mt<arguments.length;Mt+=1)for(vt in Ft=arguments[Mt])Ft.hasOwnProperty(vt)&&(Dt[vt]=Ft[vt]);return Dt},pt=function(){var Dt=function(Mt,vt,Ft){var Ht=Mt.match(vt);return Ht&&Ht.length>=Ft&&parseInt(Ht[Ft],10)},wt={};if(typeof apiRTC_React<"u")return wt.type="react-native",wt;if(window!==void 0&&window.navigator!==void 0)if(window.navigator.mozGetUserMedia)wt.type="firefox",wt.version=Dt(window.navigator.userAgent,/Firefox\/(\d+)\./,1);else if(window.navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)wt.type="chrome",wt.version=Dt(window.navigator.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!window.navigator.userAgent.match(/Version\/(\d+).(\d+)/))return wt;wt.type="safari",wt.version=Dt(window.navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(window.navigator.mediaDevices&&window.navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))wt.type="edge",wt.version=Dt(window.navigator.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!window.navigator.mediaDevices||!window.navigator.userAgent.match(/AppleWebKit\/(\d+)\./))return wt;wt.type="safari",wt.version=Dt(window.navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}return wt}(),ft="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-/=",St={decode:function(Dt){var wt,Mt=ft.indexOf(Dt.charAt(Dt.length-1)),vt=ft.indexOf(Dt.charAt(Dt.length-2)),Ft=Dt.length/4*3,Ht=null,Wt=null,tn=null,gn=null,nn=null,qt=null,fn=0,Cn=null;for(Mt===64&&Ft--,vt===64&&Ft--,Cn=new Uint8Array(Ft),wt=0;wt<Ft;wt+=3)Ht=ft.indexOf(Dt.charAt(fn++))<<2|(gn=ft.indexOf(Dt.charAt(fn++)))>>4,Wt=(15&gn)<<4|(nn=ft.indexOf(Dt.charAt(fn++)))>>2,tn=(3&nn)<<6|(qt=ft.indexOf(Dt.charAt(fn++))),Cn[wt]=Ht,nn!==64&&(Cn[wt+1]=Wt),qt!==64&&(Cn[wt+2]=tn);return Cn},encode:function(Dt){var wt,Mt="",vt=new Uint8Array(Dt),Ft=vt.byteLength,Ht=Ft%3,Wt=Ft-Ht,tn=null;for(wt=0;wt<Wt;wt+=3)tn=vt[wt]<<16|vt[wt+1]<<8|vt[wt+2],Mt+=ft[(16515072&tn)>>18]+ft[(258048&tn)>>12]+ft[(4032&tn)>>6]+ft[63&tn];return Ht===1?(tn=vt[Wt],Mt+=ft[(252&tn)>>2]+ft[(3&tn)<<4]+"=="):Ht===2&&(tn=vt[Wt]<<8|vt[Wt+1],Mt+=ft[(64512&tn)>>10]+ft[(1008&tn)>>4]+ft[(15&tn)<<2]+"="),Mt}};function It(Dt,wt){return arguments.length===3?xt(arguments[0],arguments[1],arguments[2]):wt==="null"?Dt===null:wt==="array"?Dt!==null&&et(Dt)==="object"&&Array.isArray(Dt):Dt!==null&&et(Dt)===wt}function xt(Dt,wt,Mt){if(wt!==null&&et(wt)==="object"&&Array.isArray(wt)&&wt.length>=1){var vt=wt[0];if(wt.length>1)return It(Dt,"object")&&It(vt,"string")&&Dt.hasOwnProperty(vt)&&It(Dt[vt],"object")&&xt(Dt[vt],wt.slice(1),Mt);wt=vt}return Mt==="undefined"?It(Dt,"object")&&It(wt,"string")&&!Dt.hasOwnProperty(wt)&&It(Dt[wt],Mt):It(Dt,"object")&&It(wt,"string")&&Dt.hasOwnProperty(wt)&&It(Dt[wt],Mt)}function At(Dt,wt){if(Dt===wt)return!0;if(!(Dt instanceof Object&&wt instanceof Object)||Dt.constructor!==wt.constructor)return!1;for(var Mt in Dt)if(Dt.hasOwnProperty(Mt)){if(!wt.hasOwnProperty(Mt))return!1;if(Dt[Mt]===wt[Mt])continue;if(et(Dt[Mt])!=="object"||!At(Dt[Mt],wt[Mt]))return!1}for(Mt in wt)if(wt.hasOwnProperty(Mt)&&!Dt.hasOwnProperty(Mt))return!1;return!0}},6075:(it,ut,s)=>{s.d(ut,{F:()=>ot});var et=s(1549).Y.get("WebRTC_Stack"),ot=function(){this.adaptForIoSCordova=function(){if(apiRTC.osName==="iOS"&&typeof cordova<"u"){if(et.log("Modification for iOS cordova"),cordova.plugins===void 0)return void et.log("cordova.plugins not defined");if(cordova.plugins.iosrtc===void 0)return void et.log("cordova.plugins.iosrtc not defined");this.RTCPeerConnection=cordova.plugins.iosrtc.RTCPeerConnection,this.RTCSessionDescription=cordova.plugins.iosrtc.RTCSessionDescription,this.RTCIceCandidate=cordova.plugins.iosrtc.RTCIceCandidate}},typeof RTCSessionDescription<"u"?this.RTCSessionDescription=RTCSessionDescription:et.log("RTCSessionDescription is undefined"),typeof RTCIceCandidate<"u"?this.RTCIceCandidate=RTCIceCandidate:et.log("RTCIceCandidate is undefined"),typeof RTCPeerConnection<"u"?this.RTCPeerConnection=RTCPeerConnection:et.log("RTCPeerConnection is undefined"),navigator.getUserMedia!==void 0?this.getUserMedia=navigator.getUserMedia:typeof getUserMedia<"u"?this.getUserMedia=getUserMedia:et.log("getUserMedia is undefined")}},8765:(it,ut,s)=>{s.d(ut,{K:()=>bt}),s(6755),s(2772),s(3710),s(8309),s(9601),s(2526),s(1817),s(1539),s(2165),s(6992),s(8783),s(3948);var et=s(1549),ot=s(5945),st=s(4708);function Rt(ct){return Rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(mt){return typeof mt}:function(mt){return mt&&typeof Symbol=="function"&&mt.constructor===Symbol&&mt!==Symbol.prototype?"symbol":typeof mt},Rt(ct)}var ht=et.Y.get("WebRTC_Event"),bt=function(){if(ht.debug("WebRTC_Event"),this.customEventIsDefined="notTested",this.customEventIsDefined==="notTested")try{new CustomEvent("test",{detail:"test",bubbles:!0,cancelable:!0}),this.customEventIsDefined=!0}catch(ct){this.customEventIsDefined=!1,ht.log("customEvent error :"+ct)}(ot.Xh==="IE"&&ot.dc>8||ot.Xh==="Netscape")&&(ht.log("polyfill the CustomEvent()"),function(){function ct(mt,rt){rt=rt||{bubbles:!1,cancelable:!1,detail:void 0};var pt=document.createEvent("CustomEvent");return pt.initCustomEvent(mt,rt.bubbles,rt.cancelable,rt.detail),pt}ct.prototype=window.CustomEvent.prototype,window.CustomEvent=ct}(),this.customEventIsDefined=!0),ot.Xh==="IE"&&ot.dc>8&&(ht.log("polyfill startsWith()"),String.prototype.startsWith||(String.prototype.startsWith=function(ct,mt){return mt=mt||0,this.indexOf(ct,mt)===mt})),this.eventDispatchMgr=function(ct,mt){if(typeof apiRTC_React<"u"){var rt={type:ct,detail:mt};eventManager.dispatchEvent(rt)}else if(this.customEventIsDefined===!1)typeof $jqApz<"u"?(ht.log("CustomEvent not supported by Browser, using $jqApz "),$jqApz.event.trigger({type:ct,detail:mt})):typeof jQuery<"u"?(ht.log("CustomEvent not supported by Browser, using jQuery "),jQuery.event.trigger({type:ct,detail:mt})):ht.warn("Custom Events not supported on this browser : eventDispatchMgr()");else{var pt=new CustomEvent(ct,{detail:mt,bubbles:!0,cancelable:!0});document.dispatchEvent(pt)}},this.createIncomingCallEvent=function(ct,mt,rt,pt,ft,St,It,xt,At,Dt,wt){var Mt={eventType:"incomingCall",time:new Date,clientId:ct,callerId:mt,callId:pt,autoAnswerActivated:ft,callNumber:St,callerNickname:rt,audioOnly:It,callType:xt,destCallType:wt,recordedCall:At,remoteType:Dt};this.eventDispatchMgr("incomingCall",Mt)},this.createCallAttemptEvent=function(ct,mt,rt,pt){var ft={eventType:"callAttempt",time:new Date,clientId:ct,callerId:mt,callId:pt,callerNickname:rt};this.eventDispatchMgr("callAttempt",ft)},this.createCallEstablishedEvent=function(ct,mt,rt,pt){ht.debug("createCallEstablishedEvent with callType : "+mt),ht.debug("destCallType : "+pt);var ft={eventType:"callEstablished",time:new Date,calleeId:ct,callType:mt,callId:rt,destCallType:pt};this.eventDispatchMgr("callEstablished",ft)},this.createHangupEvent=function(ct,mt,rt,pt,ft,St,It){var xt={eventType:"hangup",time:new Date,hangupType:ct,clientId:mt,remoteId:rt,lastEstablishedCall:pt,reason:ft,callId:St,callType:It};this.eventDispatchMgr("hangup",xt)},this.createRemoteHangupEvent=function(ct,mt,rt,pt){var ft={eventType:"remoteHangup",time:new Date,clientId:ct,remoteId:mt,lastEstablishedCall:rt,reason:pt};this.eventDispatchMgr("remoteHangup",ft)},this.createCallRestartingEvent=function(ct,mt,rt,pt,ft,St,It,xt,At){var Dt={eventType:"callRestarting",time:new Date,callType:ct,audioOnly:mt,oldCallId:rt,newCallId:pt,dataType:ft,clientId:St,remoteId:It,destRoom:xt,streamId:At};this.eventDispatchMgr("callRestarting",Dt)},this.createUserMediaSuccessEvent=function(ct,mt,rt,pt,ft,St,It,xt,At,Dt,wt){var Mt={eventType:"userMediaSuccess",time:new Date,onCallEstablishment:ct,audioIsAvailable:mt,audioDeviceLabel:rt,videoIsAvailable:pt,videoDeviceLabel:ft,callType:St,callId:It,stream:xt,remoteId:At,restarted:Dt,userMediaStreamId:wt};this.eventDispatchMgr("userMediaSuccess",Mt)},this.createUserMediaErrorEvent=function(ct,mt,rt,pt,ft,St,It){var xt={eventType:"userMediaError",time:new Date,onCallEstablishment:ct,callType:mt,userMediaStreamId:pt,callId:ft,tryAudioCallActivated:St,gumConfig:It};Rt(rt)==="object"?(xt.error={},xt.error.message=rt.message,xt.error.code=rt.code,xt.error.name=rt.name):xt.error=rt,this.eventDispatchMgr("userMediaError",xt)},this.createUserMediaStopEvent=function(ct,mt,rt){var pt={eventType:"userMediaStop",time:new Date,callId:ct,mediaType:mt,userMediaStreamId:rt};this.eventDispatchMgr("userMediaStop",pt)},this.createICECandidateTypeUpdateEvent=function(ct,mt,rt){var pt={eventType:"ICECandidateTypeUpdate",time:new Date,callId:ct,localCandidate:mt,remoteCandidate:rt};this.eventDispatchMgr("ICECandidateTypeUpdate",pt)},this.createSelectedICECandidateEvent=function(ct,mt,rt,pt,ft,St,It){var xt={eventType:"selectedICECandidate",time:new Date,callId:ct,localCandidateType:mt,remoteCandidateType:rt,localAddress:pt,remoteAdress:ft,transportType:St,localTransportType:It};this.eventDispatchMgr("selectedICECandidate",xt)},this.createErrorEvent=function(ct,mt,rt,pt,ft,St,It){var xt={eventType:"error",time:new Date,errorInfo:ct,errorCode:mt,callId:rt,roomName:pt,roomCallType:ft};(0,st.Ym)(St,"object")&&(xt.data=St),(0,st.Ym)(It,"string")&&(xt.convId=It),this.eventDispatchMgr("error",xt)},this.createReceiveIMMessageEvent=function(ct,mt,rt,pt,ft,St){var It={eventType:"receiveIMMessage",time:new Date,senderId:ct,senderNickname:mt,senderPhotoURL:rt,message:pt,UUCSeq:ft,convId:St};this.eventDispatchMgr("receiveIMMessage",It)},this.createChannelEvent=function(ct,mt){var rt={eventType:"channelEvent",time:new Date,channelEvent:ct,event:mt};this.eventDispatchMgr("channelEvent",rt)},this.createSessionReadyEvent=function(ct){ht.debug("createSessionReadyEvent");var mt={eventType:"sessionReady",time:new Date,apiCCId:ct};this.eventDispatchMgr("sessionReady",mt)},this.createWebRTCClientCreatedEvent=function(){var ct={eventType:"webRTCClientCreated",time:new Date};this.eventDispatchMgr("webRTCClientCreated",ct)},this.createUpdatePresenceEvent=function(ct,mt,rt){var pt={eventType:"updatePresence",time:new Date,connectedUsersList:ct,connectedUsersListWithStatus:rt,state:mt};this.eventDispatchMgr("updatePresence",pt)},this.createCloudEventOccurredEvent=function(ct,mt){var rt={eventType:"cloudEventOccurred",time:new Date,topic:ct,target:mt};this.eventDispatchMgr("cloudEventOccurred",rt)},this.createUpdateUserStatusEvent=function(ct){var mt={eventType:"updateUserStatus",time:new Date,message:ct};this.eventDispatchMgr("updateUserStatus",mt)},this.createGroupChatCreationEvent=function(ct,mt,rt,pt,ft,St){var It={eventType:"groupChatCreation",time:new Date,status:ct,groupChatId:mt,initialDestId:rt,invitationSendedToInitialDestId:pt,newContactId:ft,invitationSendedToNewContactId:St};this.eventDispatchMgr("groupChatCreation",It)},this.createGroupChatInvitationEvent=function(ct,mt,rt,pt,ft){var St={eventType:"groupChatInvitation",time:new Date,groupChatId:ct,contactList:ft,senderId:mt,senderNickname:rt,senderPhotoURL:pt};this.eventDispatchMgr("groupChatInvitation",St)},this.createGroupChatMemberUpdateEvent=function(ct,mt,rt){var pt={eventType:"groupChatMemberUpdate",time:new Date,groupChatId:ct,contactList:mt,status:rt};this.eventDispatchMgr("groupChatMemberUpdate",pt)},this.createAddUserInGroupChatEvent=function(ct,mt,rt){var pt={eventType:"addUserInGroupChatAnswer",time:new Date,invitationSended:ct,groupChatId:mt,contactId:rt};this.eventDispatchMgr("addUserInGroupChatAnswer",pt)},this.createReceiveGroupChatMessageEvent=function(ct,mt,rt,pt,ft){var St={eventType:"receiveGroupChatMessage",time:new Date,groupChatId:ct,senderId:mt,senderNickname:rt,message:pt};(0,st.Ym)(ft,"object")&&(St.metadata=ft),this.eventDispatchMgr("receiveGroupChatMessage",St)},this.createReceiveConversationListAnswerEvent=function(ct){var mt={eventType:"receiveConversationList",time:new Date,convList:ct};this.eventDispatchMgr("receiveConversationList",mt)},this.createReceiveContactOccurrencesFromConversationListAnswerEvent=function(ct){var mt={eventType:"receiveContactOccurrencesFromConversationList",time:new Date,occurrencesList:ct};this.eventDispatchMgr("receiveContactOccurrencesFromConversationList",mt)},this.createReceiveConversationDetailReportAnswerEvent=function(ct){var mt={eventType:"receiveConversationDetailReport",time:new Date,CDR:ct};this.eventDispatchMgr("receiveConversationDetailReport",mt)},this.createReceiveConversationHistoryEvent=function(ct,mt,rt){var pt={eventType:"receiveConversationHistory",time:new Date,convId:ct,convHistory:mt,status:rt};this.eventDispatchMgr("receiveConversationHistory",pt)},this.createUserDataAnswerEvent=function(ct,mt,rt,pt){var ft={eventType:"userDataAnswer",time:new Date,userFound:ct,contactId:mt,nickname:rt,photoURL:pt};this.eventDispatchMgr("userDataAnswer",ft)},this.createFetchUserDataAnswerEvent=function(ct){var mt="fetchUserDataAnswer",rt={eventType:mt,timeout:ct.timeout,userData:ct.userData,id:ct.id};this.eventDispatchMgr(mt,rt)},this.createReceiveDataEvent=function(ct,mt,rt){var pt={eventType:"receiveData",time:new Date,senderId:ct,dstRoomId:mt,data:rt};this.eventDispatchMgr("receiveData",pt)},this.createMCUSessionCreationEvent=function(ct,mt){var rt={eventType:"MCUSessionCreation",time:new Date,sessionId:ct,token:mt};this.eventDispatchMgr("MCUSessionCreation",rt)},this.createJoinMCUSessionAnswerEvent=function(ct,mt,rt,pt,ft){var St={eventType:"joinMCUSessionAnswer",time:new Date,sessionId:ct,token:mt,groupChatId:rt,initiator:pt,roomId:ft.roomName};ft.roomMode&&(St.mode=ft.roomMode),ft.meshOnly===!0&&(St.meshOnly=!0),ft.joinSessionAnswer&&(St.result=Object.assign({},ft.joinSessionAnswer)),this.eventDispatchMgr("joinMCUSessionAnswer",St)},this.createMCUAvailableStreamEvent=function(ct,mt){var rt={eventType:"MCUAvailableStream",time:new Date,streams:ct,isRemoteStream:mt};this.eventDispatchMgr("MCUAvailableStream",rt)},this.createMCUAvailableReplayEvent=function(ct,mt){var rt={eventType:"MCUAvailableReplay",time:new Date,streams:ct,isRemoteStream:mt};this.eventDispatchMgr("MCUAvailableReplay",rt)},this.createMCUAvailableCompositeEvent=function(ct,mt){var rt={eventType:"MCUAvailableComposite",time:new Date,streams:ct,isRemoteStream:mt};this.eventDispatchMgr("MCUAvailableComposite",rt)},this.createMCURemovedStreamEvent=function(ct){var mt={eventType:"MCURemoveStream",time:new Date,streamId:ct};this.eventDispatchMgr("MCURemoveStream",mt)},this.createMCUAvailableStreamUpdateEvent=function(ct,mt){var rt={eventType:"MCUAvailableStreamUpdate",time:new Date,streams:ct,isRemoteStream:mt};this.eventDispatchMgr("MCUAvailableStreamUpdate",rt)},this.createMCUParticipantEjectedEvent=function(ct,mt,rt){var pt={eventType:"MCUParticipantEjected",time:new Date,roomId:ct,clientId:mt};rt&&(pt.data=rt),this.eventDispatchMgr("MCUParticipantEjected",pt)},this.createReceiveMCUSessionInvitationEvent=function(ct,mt,rt,pt){rt===void 0&&(rt=0);var ft={eventType:"receiveMCUSessionInvitation",time:new Date,sessionId:ct,token:mt,groupChatId:rt,initiatorId:pt};this.eventDispatchMgr("receiveMCUSessionInvitation",ft)},this.createRemoteStreamAddedEvent=function(ct,mt,rt,pt,ft,St,It){var xt={eventType:"remoteStreamAdded",time:new Date,callId:mt,callType:ct,stream:rt,remoteId:pt,destCallType:ft,audioIsAvailable:St.available,audioIsActive:St.active,audioIsMuted:St.muted,videoIsAvailable:It.available,videoIsActive:It.active,videoIsMuted:It.muted};this.eventDispatchMgr("remoteStreamAdded",xt)},this.createRemoteStreamRemovedEvent=function(ct,mt,rt,pt,ft){var St={eventType:"remoteStreamRemoved",time:new Date,callId:mt,callType:ct,stream:rt,remoteId:pt,destCallType:ft};this.eventDispatchMgr("remoteStreamRemoved",St)},this.createSimulcastFeedChanged=function(ct,mt){var rt={eventType:"simulcastFeedChanged",time:new Date,callId:ct,simulcast:mt};this.eventDispatchMgr("simulcastFeedChanged",rt)},this.createLocalStreamRemovedEvent=function(ct,mt,rt,pt,ft){var St={eventType:"localStreamRemoved",time:new Date,callId:mt,callType:ct,stream:rt,remoteId:pt,destCallType:ft};this.eventDispatchMgr("localStreamRemoved",St)},this.createSlowLinkEvent=function(ct,mt){var rt={eventType:"slowLink",time:new Date,callId:ct};mt&&(rt.advice=mt),this.eventDispatchMgr("slowLink",rt)},this.createVideoQualityChangedEvent=function(ct,mt,rt,pt){var ft={eventType:"videoQualityChanged",time:new Date,roomname:mt,callId:ct,hint:rt,profileType:pt.name};pt.bitrate&&(ft.bitrate=pt.bitrate),pt.width&&pt.height&&(ft.width=pt.width,ft.height=pt.height),pt.frameRate&&(ft.frameRate=pt.frameRate),this.eventDispatchMgr("videoQualityChanged",ft)},this.createAudioAmplitudeEvent=function(ct,mt,rt,pt){var ft={eventType:"audioAmplitude",time:new Date,callId:rt,userMediaStreamId:pt,descriptor:{amplitude:ct,isSpeaking:mt}};this.eventDispatchMgr("audioAmplitude",ft)},this.createLocalStreamUpdatedEvent=function(ct,mt,rt,pt,ft,St,It,xt,At){var Dt={eventType:"localStreamUpdated",time:new Date,changeList:ct,audioIsAvailable:mt.available,audioDeviceLabel:mt.deviceLabel,audioIsActive:mt.active,audioIsMuted:mt.muted,audioIsSilent:mt.silent,videoIsAvailable:rt.available,videoDeviceLabel:rt.deviceLabel,videoIsActive:rt.active,videoIsMuted:rt.muted,videoIsSilent:rt.silent,onCall:pt,callType:ft,callId:St,stream:It,userMediaStreamId:xt,cause:At};this.eventDispatchMgr("localStreamUpdated",Dt)},this.createRemoteStreamUpdatedEvent=function(ct,mt,rt,pt,ft,St){var It={eventType:"remoteStreamUpdated",time:new Date,changeList:ct,audioIsAvailable:mt.available,audioIsActive:mt.active,audioIsMuted:mt.muted,audioIsSilent:mt.silent,videoIsAvailable:rt.available,videoIsActive:rt.active,videoIsMuted:rt.muted,videoIsSilent:rt.silent,callType:pt,callId:ft,cause:St};this.eventDispatchMgr("remoteStreamUpdated",It)},this.createCanPlayRemoteVideoEvent=function(ct,mt,rt){var pt={eventType:"canPlayRemoteVideo",time:new Date,videoDivId:ct,callType:mt,remoteId:rt};this.eventDispatchMgr("canPlayRemoteVideo",pt)},this.createRecordedFileAvailableEvent=function(ct){var mt={eventType:"recordedFileAvailable",time:new Date,fileName:ct};this.eventDispatchMgr("recordedFileAvailable",mt)},this.createRecordedStreamsAvailableEvent=function(ct,mt,rt,pt,ft,St,It){var xt={eventType:"recordedStreamsAvailable",time:new Date,confId:ct,userId1:mt,userId2:rt,callId:pt,apiKey:apiCC.session.apiKey};ft&&(xt.convId=ft),St&&(xt.mediaId=St),It&&(xt.mediaURL=It),this.eventDispatchMgr("recordedStreamsAvailable",xt)},this.createMCURecordedStreamsAvailableEvent=function(ct,mt,rt,pt,ft,St,It,xt,At,Dt,wt){var Mt={eventType:"MCURecordedStreamsAvailable",time:new Date,roomName:ct,callId:mt,clientId:rt,convId:ft,mediaId:St,mediaURL:It,recordType:xt};At&&(Mt.remoteId=At),pt&&(Mt.recordedFileName=pt),Dt&&(Mt.mediaType=Dt),(0,st.Ym)(wt,"object")?(Mt.descriptor={},(0,st.Ym)(wt,"mode","string")&&(Mt.descriptor.mode=wt.mode),(0,st.Ym)(wt,"labelEnabled","boolean")&&(Mt.descriptor.labelEnabled=wt.labelEnabled),Mt.descriptor.labelEnabled===!0&&(0,st.Ym)(wt,"labels","array")&&(Mt.descriptor.labels=wt.labels)):Mt.descriptor={mode:"complete",labelEnabled:!1},this.eventDispatchMgr("MCURecordedStreamsAvailable",Mt)},this.createMCURecordingStartedEvent=function(ct,mt,rt,pt,ft,St,It,xt,At,Dt,wt,Mt){var vt={eventType:"MCURecordingStarted",time:new Date,roomName:ct,callId:mt,clientId:rt,recordType:pt,recordStartTime:ft};St&&(vt.convId=St),It&&(vt.mediaId=It),xt&&(vt.mediaURL=xt),At&&(vt.remoteId=At),Dt&&(vt.recordedFileName=Dt),wt&&(vt.mediaType=wt),(0,st.Ym)(Mt,"object")&&(vt.descriptor={},(0,st.Ym)(Mt,"mode","string")&&(vt.descriptor.mode=Mt.mode),(0,st.Ym)(Mt,"labelEnabled","boolean")&&(vt.descriptor.labelEnabled=Mt.labelEnabled),vt.descriptor.labelEnabled===!0&&(0,st.Ym)(Mt,"labels","array")&&(vt.descriptor.labels=Mt.labels)),this.eventDispatchMgr("MCURecordingStarted",vt)},this.createMCURecordingStoppedEvent=function(ct,mt,rt,pt,ft,St,It,xt,At,Dt,wt,Mt){var vt={eventType:"MCURecordingStopped",time:new Date,roomName:ct,callId:mt,clientId:rt,recordType:pt,recordStartTime:ft};St&&(vt.convId=St),It&&(vt.mediaId=It),xt&&(vt.mediaURL=xt),At&&(vt.remoteId=At),Dt&&(vt.recordedFileName=Dt),wt&&(vt.mediaType=wt),(0,st.Ym)(Mt,"object")&&(vt.descriptor={},(0,st.Ym)(Mt,"mode","string")&&(vt.descriptor.mode=Mt.mode),(0,st.Ym)(Mt,"labelEnabled","boolean")&&(vt.descriptor.labelEnabled=Mt.labelEnabled),vt.descriptor.labelEnabled===!0&&(0,st.Ym)(Mt,"labels","array")&&(vt.descriptor.labels=Mt.labels)),this.eventDispatchMgr("MCURecordingStopped",vt)},this.createStopRecordEvent=function(){var ct={eventType:"stopRecord",time:new Date};this.eventDispatchMgr("stopRecord",ct)},this.createMCUStreamingStartedEvent=function(ct,mt,rt,pt){var ft={eventType:"MCUStreamingStarted",time:new Date,roomName:ct,callId:mt,clientId:rt,streamingStartTime:pt};this.eventDispatchMgr("MCUStreamingStarted",ft)},this.createMCUStreamingStoppedEvent=function(ct,mt,rt,pt){var ft={eventType:"MCUStreamingStopped",time:new Date,roomName:ct,callId:mt,clientId:rt,streamingEndTime:pt};this.eventDispatchMgr("MCUStreamingStopped",ft)},this.createMCURoomModeChangedEvent=function(ct,mt,rt,pt){var ft={eventType:"MCURoomModeChanged",time:new Date,roomId:ct,oldMode:mt,newMode:rt,state:pt};this.eventDispatchMgr("MCURoomModeChanged",ft)},this.createSnapShotPhotoUploaded=function(ct){var mt={eventType:"snapShotPhotoUploaded",time:new Date,fileName:ct};this.eventDispatchMgr("snapShotPhotoUploaded",mt)},this.createRoomCreationEvent=function(ct,mt,rt){var pt={eventType:"roomCreation",time:new Date,status:ct,roomId:mt,roomType:rt};this.eventDispatchMgr("roomCreation",pt)},this.createRoomJoinedEvent=function(ct,mt,rt){var pt={eventType:"roomJoined",time:new Date,status:ct,roomId:mt,roomType:rt};this.eventDispatchMgr("roomJoined",pt)},this.createRoomInvitationEvent=function(ct,mt,rt,pt,ft,St){var It=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},xt="roomInvitation",At={eventType:"roomInvitation",time:new Date,roomId:ct,contactList:ft,senderId:mt,senderNickname:rt,senderPhotoURL:pt,roomType:St};It.cloudConvId&&(At.cloudConvId=It.cloudConvId),It.webconf===!0&&(At.webconf=!0),this.eventDispatchMgr(xt,At)},this.createRoomMemberUpdateEvent=function(ct,mt,rt,pt){var ft={eventType:"roomMemberUpdate",time:new Date,roomId:ct,contactList:mt,status:rt,roomType:pt};this.eventDispatchMgr("roomMemberUpdate",ft)},this.createContactListInRoomEvent=function(ct,mt,rt){var pt={eventType:"contactListInRoom",time:new Date,roomId:ct,contactList:mt,roomType:rt};this.eventDispatchMgr("contactListInRoom",pt)},this.createReceiveRoomMessageEvent=function(ct,mt,rt,pt,ft){var St={eventType:"receiveRoomMessage",time:new Date,roomId:ct,senderId:mt,senderNickname:rt,message:pt,roomType:ft};this.eventDispatchMgr("receiveRoomMessage",St)},this.createDesktopCaptureEvent=function(ct,mt,rt){var pt={eventType:"desktopCapture",time:new Date,event:ct,callId:mt,remoteId:rt};this.eventDispatchMgr("desktopCapture",pt)},this.createMediaDeviceChangedEvent=function(ct,mt,rt){var pt="NotDefined";mt!=null&&(pt=mt);var ft={eventType:"mediaDeviceChanged",time:new Date,diff:ct,updateReason:pt,firstMediaDeviceListInitialization:rt};this.eventDispatchMgr("mediaDeviceChanged",ft)},this.createSwitchStreamEvent=function(ct,mt){var rt={eventType:"switchStream",time:new Date,callId:ct,stream:mt};this.eventDispatchMgr("switchStream",rt)},this.createConnectedUsersListUpdateEvent=function(ct,mt,rt,pt){var ft={eventType:"ConnectedUsersListUpdate",time:new Date,group:ct,usersList:mt,status:rt,updateReason:pt};this.eventDispatchMgr("connectedUsersListUpdate",ft)},this.createClosingWhiteBoardEvent=function(ct,mt){var rt={eventType:"closingWhiteBoard",time:new Date,roomId:ct,reason:mt};this.eventDispatchMgr("closingWhiteBoard",rt)},this.createExternalJsLoadingStatusEvent=function(ct,mt){var rt={eventType:"externalJsLoadingStatus",extjs:ct,status:mt,time:new Date};this.eventDispatchMgr("externalJsLoadingStatus",rt)},this.createBackgroundSubstractionStopVisibilityChangeEvent=function(ct){var mt={userMediaStreamId:ct};this.eventDispatchMgr("backgroundSubstractionStopVisibilityChange",mt)},this.createBackgroundSubstractionStopComputeTimeEvent=function(ct){var mt={userMediaStreamId:ct};this.eventDispatchMgr("backgroundSubstractionStopComputeTime",mt)},this.createAIESnapshotEvent=function(ct,mt){var rt={userMediaStreamId:ct,image:mt};this.eventDispatchMgr("AIESnapshot",rt)},this.createAIELogEvent=function(ct,mt){var rt={userMediaStreamId:ct,log:mt};this.eventDispatchMgr("AIELog",rt)},this.createEvent=function(ct){if(!ct.eventType)throw new Error("The event json must have an eventType"+ct);ct.time=new Date,this.eventDispatchMgr(ct.eventType,ct)}}},940:(it,ut,s)=>{s.d(ut,{S:()=>Rt}),s(2772);var et=s(1549),ot=s(5945),st=et.Y.get("WebRTC_Stack"),Rt=function(ht){this.sendInvite=function(bt,ct,mt,rt,pt,ft){var St=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{};st.debug("WebRTC_Stack::sendInvite()"),ft||(ft="media");var It={type:"invite",callId:bt,callerId:ct,callerNickname:mt,calleeId:rt,roomId:pt,callType:ft};St.mode&&(It.mode=St.mode);var xt=St.offer;if(xt){if(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11){var At=xt.type,Dt=xt.sdp;st.log("JSON.stringify(type):",JSON.stringify(At)),st.log("JSON.stringify(sdp):",JSON.stringify(Dt)),xt={type:At,sdp:Dt}}It.sdpoffer=xt}St.data&&(It.data=St.data),St.stream&&(It.stream=St.stream);var wt=JSON.stringify(It);st.info("C->S:",wt),ht.emit("invite",wt)},this.sendInviteBroadcast=function(bt,ct,mt,rt,pt,ft){var St,It;st.debug("WebRTC_Stack::sendInviteBroadcast()"),St={type:"invite",callId:bt,callerId:ct,callerNickname:mt,calleeId:rt,roomId:pt,sdpoffer:ft},It=JSON.stringify(St),st.debug("C->S: "+It),ht.emit("invite_broadcast",It)},this.send200OK=function(bt,ct,mt,rt,pt,ft,St){st.debug("WebRTC_Stack::send200OK()");var It,xt,At=null;(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&(st.log("JSON.stringify(offer.sdp) :"+JSON.stringify(ft.sdp)),st.log("JSON.stringify(offer.type) :"+JSON.stringify(ft.type)),(At={}).sdp=ft.sdp,At.type=ft.type,ft=At),It={type:"200OK",callId:bt,callerId:ct,calleeId:mt,calleeNickname:rt,roomId:pt,sdpanswer:ft,data:St},xt=JSON.stringify(It),st.info("C->S: "+xt),ht.emit("200OK",xt)},this.sendCandidate=function(bt,ct,mt,rt,pt,ft,St,It,xt,At){st.debug("WebRTC_Stack::sendCandidate()");var Dt=null,wt={};st.debug("completeCandidate :",At),ot.Xh==="IE"?(st.log("Browser is IE, adapting completeCandidate"),wt.sdpMLineIndex=At.sdpMLineIndex,wt.candidate=At.candidate,wt.sdpMid=At.sdpMid):wt=At,xt!==null?(st.log("call data is defined :",xt),Dt={type:"candidate",callId:bt,callerId:ct,calleeId:mt,roomId:rt,dst:pt,label:ft,id:St,candidate:It,data:xt,completeCandidate:wt}):(st.log("call data is undefined"),Dt={type:"candidate",callId:bt,callerId:ct,calleeId:mt,roomId:rt,dst:pt,label:ft,id:St,candidate:It,completeCandidate:wt});var Mt=JSON.stringify(Dt);st.info("C->S:",Mt),ht.emit("candidate",Mt)},this.sendBye=function(bt,ct,mt,rt,pt,ft){st.debug("WebRTC_Stack::sendBye()");var St,It=null;ft!==null?(st.log("call data is defined :"+ft),It={type:"bye",callId:bt,clientId:ct,roomId:mt,dst:rt,reason:pt,data:ft}):(st.log("call data is undefined"),It={type:"bye",callId:bt,clientId:ct,roomId:mt,dst:rt,reason:pt}),St=JSON.stringify(It),st.info("C->S: "+St),ht.emit("bye",St)},this.sendUpdate=function(bt,ct,mt,rt,pt,ft,St,It){st.debug("WebRTC_Stack::sendUpdate()");var xt,At=null;At={type:"update",callId:bt,callerId:ct,calleeId:mt,roomId:rt,dst:pt,sdpoffer:ft,callType:St},It!=null&&(st.log("call data is defined: "+It),At.data=It),xt=JSON.stringify(At),st.info("C->S: "+xt),ht.emit("update",xt)},this.send200Update=function(bt,ct,mt,rt,pt,ft,St){st.debug("WebRTC_Stack::send200Update()");var It,xt=null;St!==null?(st.log("call data is defined :"+St),xt={type:"200update",callId:bt,callerId:ct,calleeId:mt,roomId:rt,dst:pt,sdpanswer:ft,data:St}):(st.log("call data is undefined"),xt={type:"200update",callId:bt,callerId:ct,calleeId:mt,roomId:rt,dst:pt,sdpanswer:ft}),It=JSON.stringify(xt),st.info("C->S: "+It),ht.emit("200update",It)},this.sendDebugCommand=function(bt,ct,mt){var rt,pt;st.debug("WebRTC_Stack::sendDebugCommand :"+bt),rt={type:"debugCommand",command:bt,apiKey:ct,clientId:mt},pt=JSON.stringify(rt),st.info("C->S: "+pt),ht.emit("debugCommand",pt)},this.sendAck=function(bt,ct,mt){var rt,pt;st.debug("WebRTC_Stack::sendAck()"),rt={type:"Ack",AckMessageType:bt,cSeq:ct,dst:mt},pt=JSON.stringify(rt),st.info("C->S: "+pt),ht.emit("Ack",pt)},this.sendInfo=function(bt,ct){var mt,rt,pt=["activeSpeaker","callStats","stopSpeaking"];pt.indexOf(bt)<0&&st.debug("WebRTC_Stack::sendInfo()"),mt={type:"info",infoType:bt,data:ct},rt=JSON.stringify(mt),pt.indexOf(bt)<0&&st.info("C->S: "+rt),ht.emit("info",rt)},this.sendDataMessage=function(bt,ct){st.debug("WebRTC_Stack::sendDataMessage()");var mt={type:"apiRTCDataMessage",senderId:bt,data:ct},rt=JSON.stringify(mt);st.info("C->S: "+rt),ht.emit("apiRTCDataMessage",rt)}}},4170:(it,ut,s)=>{s.r(ut),s(4916),s(4723),s(3710),s(1539),s(9714),s(561),function(et){var ot,st,Rt=null,ht=null,bt=[];function ct(){return Math.random().toString(36).substr(2)}ot=function(){if(typeof apiRTC_React<"u")return"react-native";var mt,rt=navigator.appName,pt=navigator.userAgent,ft=pt.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return ft&&(mt=pt.match(/version\/([\.\d]+)/i))!==null&&(ft[2]=mt[1]),(ft=ft?[ft[1],ft[2]]:[rt,navigator.appVersion,"-?"])[0]}(),st=function(){if(typeof apiRTC_React<"u")return 1;var mt,rt=navigator.appName,pt=navigator.userAgent,ft=pt.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return ft&&(mt=pt.match(/version\/([\.\d]+)/i))!==null&&(ft[2]=mt[1]),(ft=ft?[ft[1],ft[2]]:[rt,navigator.appVersion,"-?"])[1]}(),ht=new function(){(ot==="MSIE"&&st>8||ot==="Netscape")&&function(){function mt(rt,pt){pt=pt||{bubbles:!1,cancelable:!1,detail:void 0};var ft=document.createEvent("CustomEvent");return ft.initCustomEvent(rt,pt.bubbles,pt.cancelable,pt.detail),ft}mt.prototype=et.CustomEvent.prototype,et.CustomEvent=mt}(),this.eventDispatchMgr=function(mt,rt){if(typeof apiRTC_React<"u"){var pt={type:mt,detail:rt};eventManager.dispatchEvent(pt)}else if(ot==="MSIE"&&st<=8)typeof $jqApz<"u"?$jqApz.event.trigger({type:mt,detail:rt}):typeof jQuery<"u"&&jQuery.event.trigger({type:mt,detail:rt});else{var ft=new CustomEvent(mt,{detail:rt,bubbles:!0,cancelable:!0});document.dispatchEvent(ft)}},this.createGetUserFromIdAnswerEvent=function(mt){var rt={eventType:"getUserFromIdAnswer",time:new Date,message:mt};this.eventDispatchMgr("getUserFromIdAnswer",rt)},this.createGetAllUsersAnswerEvent=function(mt){var rt={eventType:"getAllUsersAnswer",time:new Date,message:mt};this.eventDispatchMgr("getAllUsersAnswer",rt)},this.createErrorEvent=function(mt){var rt={eventType:"error :",time:new Date,errorInfo:mt};this.eventDispatchMgr("error",rt)},this.createSearchUserAnswerEvent=function(mt,rt,pt){var ft={eventType:"searchUserAnswer :",time:new Date,searchStr:mt,searchAnswerList:rt,group:pt};this.eventDispatchMgr("searchUserAnswer",ft)}},(Rt={version:"1.0.4",description:"ApiRTC DataBase Library"}).init=function(mt){this.socket=mt,this.socket.on("getUserFromIdAnswer",this.callback(this,"onGetUserFromIdAnswer")).on("getAllUsersAnswer",this.callback(this,"onGetAllUsersAnswer")).on("searchUserAnswer",this.callback(this,"onSearchUserAnswer"))},Rt.createUser=function(mt){if(mt!==null&&mt.mail!==null&&mt.id!==null){var rt=JSON.stringify(mt);this.socket.emit("createUser",rt)}},Rt.searchUserInGroup=function(mt,rt,pt,ft){var St=null,It=null,xt=ct();(rt===void 0||rt!=="all"&&rt!=="connected"&&rt!=="disconnected")&&(rt="all"),mt!==null&&(St={searchStr:mt,presenceState:rt,group:pt},ft!==void 0&&(St.callbackId=xt,bt[xt]=ft),It=JSON.stringify(St),this.socket.emit("searchUser",It))},Rt.searchUser=function(mt,rt,pt,ft){var St=null;typeof pt=="function"?(St=pt,Rt.searchUserInGroup(mt,rt,void 0,St)):Rt.searchUserInGroup(mt,rt,pt,ft)},Rt.onSearchUserAnswer=function(mt){var rt=JSON.parse(mt);rt.callbackId!==void 0&&rt.callbackId in bt?(bt[rt.callbackId](rt.searchStr,rt.searchAnswerList),bt.splice(rt.callbackId,1)):ht.createSearchUserAnswerEvent(rt.searchStr,rt.searchAnswerList,rt.group)},Rt.getUserFromId=function(mt,rt){var pt=null,ft=null,St=ct();mt!==null&&(pt={id:mt},rt!==void 0&&(pt.callbackId=St,bt[St]=rt),ft=JSON.stringify(pt),this.socket.emit("getUserFromId",ft))},Rt.onGetUserFromIdAnswer=function(mt){mt!==null&&mt.callbackId!==void 0&&mt.callbackId in bt?(bt[mt.callbackId](mt),bt.splice(mt.callbackId,1)):ht.createGetUserFromIdAnswerEvent(mt)},Rt.getAllUsers=function(){var mt,rt;mt={},rt=JSON.stringify(mt),this.socket.emit("getAllUsers",rt)},Rt.onGetAllUsersAnswer=function(mt){ht.createGetAllUsersAnswerEvent(mt)},Rt.setPresenceStatus=function(mt,rt,pt){var ft,St;ft={id:mt,presenceStatus:rt,commentStatus:pt},St=JSON.stringify(ft),this.socket.emit("setPresenceStatus",St)},Rt.setUserStatus=function(mt,rt){var pt;rt.id=mt,pt=JSON.stringify(rt),this.socket.emit("setUserStatus",pt)},Rt.setUserInfos=function(mt){var rt,pt;rt=mt,pt=JSON.stringify(rt),this.socket.emit("setUserInfos",pt)},Rt.addEventListener=function(mt,rt){typeof apiRTC_React<"u"?eventManager.addEventListener(mt,rt):mt!=="getUserFromIdAnswer"||mt!=="error"||mt!=="getAllUsersAnswer"||mt!=="searchUserAnswer"?document.addEventListener(mt,rt,!1):ht.createErrorEvent("ERROR: Trying to add a listener on an unknow event")},Rt.callback=function(mt,rt){return this.closureHandler=function(pt){return mt[rt](pt)},this.closureHandler},et.apiDB=Rt}(window)},2746:(it,ut,s)=>{s.r(ut);var et=s(1549).Y.get("onbeforeunload");apiCC.beforeUnloadFct=function(ot){et.debug("User has refreshed or left the page, eventType :",ot);try{if(typeof mailClicked<"u"&&mailClicked!==null&&(et.log("mailClicked variable is defined"),mailClicked===!0))return et.log("mailClicked is true : leaving onbeforeunload"),void(mailClicked=!1)}catch(Rt){et.log("Catch error on PATCH/WORKAROUND to avoid reload of page in chrome when mailto :"+Rt)}try{if(apiCC.iePluginInstallationPreventUnload!==void 0&&apiCC.iePluginInstallationPreventUnload!==null&&apiCC.iePluginInstallationPreventUnload===!0)return void et.log("iePluginInstallationPreventUnload is true : leaving onbeforeunload")}catch(Rt){et.log("Catch error on PATCH/WORKAROUND to avoid reload of page in IE when installing webRTC plugin :"+Rt)}if(apiCC!=null){if(apiRTC.session!==null&&apiRTC.session.remoteAccessInvitation!==null){var st;st=apiRTC.session.remoteAccessInvitation.invitationType==="sent"?{code:"AGENT_LEFT"}:{code:"USER_LEFT"},et.debug("Stopping remote access on refresh"),apiRTC.session.remoteAccessInvitation.stop(!0,st)}apiCC.storeSessionInfoInSessionStorage(),apiCC.cleanApiRTCContext(),apiCC.disconnect({invalidateApiCCId:!0}),apiCC.cleanAllEventListener(),apiCC.myEventTable=[]}apiCC!=null&&(apiCC.session=null,apiCC.jsLoaded=!1)},apiRTC.browser==="Mobile Safari"?window.addEventListener("pagehide",function(){apiCC.beforeUnloadFct("unload_MobileSafari")}):window.onbeforeunload=function(){apiCC.beforeUnloadFct("unload")}},9064:(it,ut,s)=>{function et(ot){return et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(st){return typeof st}:function(st){return st&&typeof Symbol=="function"&&st.constructor===Symbol&&st!==Symbol.prototype?"symbol":typeof st},et(ot)}s(2222),s(2772),s(4916),s(3123),s(5306),s(2526),s(1817),s(1539),s(2165),s(6992),s(8783),s(3948),it=s.hmd(it),function(ot){var st="function",Rt="undefined",ht="object",bt="string",ct="model",mt="name",rt="type",pt="vendor",ft="version",St="architecture",It="console",xt="mobile",At="tablet",Dt="smarttv",wt="wearable",Mt="embedded",vt="Amazon",Ft="Apple",Ht="ASUS",Wt="BlackBerry",tn="Google",gn="Huawei",nn="LG",qt="Microsoft",fn="Motorola",Cn="Samsung",Tn="Sharp",un="Sony",mn="Xiaomi",yn="Zebra",pn="Facebook",In="Chromium OS",kn="Mac OS",Mn=function(Jn){for(var Qn={},sr=0;sr<Jn.length;sr++)Qn[Jn[sr].toUpperCase()]=Jn[sr];return Qn},xn=function(Jn,Qn){return et(Jn)===bt&&Pn(Qn).indexOf(Pn(Jn))!==-1},Pn=function(Jn){return Jn.toLowerCase()},On=function(Jn,Qn){if(et(Jn)===bt)return Jn=Jn.replace(/^\s\s*/,""),et(Qn)===Rt?Jn:Jn.substring(0,350)},Dn=function(Jn,Qn){for(var sr,Bn,rr,nr,Nn,Wn,vn=0;vn<Qn.length&&!Nn;){var Rn=Qn[vn],Gt=Qn[vn+1];for(sr=Bn=0;sr<Rn.length&&!Nn&&Rn[sr];)if(Nn=Rn[sr++].exec(Jn))for(rr=0;rr<Gt.length;rr++)Wn=Nn[++Bn],et(nr=Gt[rr])===ht&&nr.length>0?nr.length===2?et(nr[1])==st?this[nr[0]]=nr[1].call(this,Wn):this[nr[0]]=nr[1]:nr.length===3?et(nr[1])!==st||nr[1].exec&&nr[1].test?this[nr[0]]=Wn?Wn.replace(nr[1],nr[2]):void 0:this[nr[0]]=Wn?nr[1].call(this,Wn,nr[2]):void 0:nr.length===4&&(this[nr[0]]=Wn?nr[3].call(this,Wn.replace(nr[1],nr[2])):void 0):this[nr]=Wn||void 0;vn+=2}},Fn=function(Jn,Qn){for(var sr in Qn)if(et(Qn[sr])===ht&&Qn[sr].length>0){for(var Bn=0;Bn<Qn[sr].length;Bn++)if(xn(Qn[sr][Bn],Jn))return sr==="?"?void 0:sr}else if(xn(Qn[sr],Jn))return sr==="?"?void 0:sr;return Jn},dr={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ir={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[ft,[mt,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[ft,[mt,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[mt,ft],[/opios[\/ ]+([\w\.]+)/i],[ft,[mt,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[ft,[mt,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[mt,ft],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[ft,[mt,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[ft,[mt,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[ft,[mt,"WeChat"]],[/konqueror\/([\w\.]+)/i],[ft,[mt,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[ft,[mt,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[ft,[mt,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[mt,/(.+)/,"$1 Secure Browser"],ft],[/\bfocus\/([\w\.]+)/i],[ft,[mt,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[ft,[mt,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[ft,[mt,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[ft,[mt,"Dolphin"]],[/coast\/([\w\.]+)/i],[ft,[mt,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[ft,[mt,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[ft,[mt,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[mt,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[mt,/(.+)/,"$1 Browser"],ft],[/(comodo_dragon)\/([\w\.]+)/i],[[mt,/_/g," "],ft],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[mt,ft],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[mt],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[mt,pn],ft],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[mt,ft],[/\bgsa\/([\w\.]+) .*safari\//i],[ft,[mt,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[ft,[mt,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[ft,[mt,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[mt,"Chrome WebView"],ft],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[ft,[mt,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[mt,ft],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[ft,[mt,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[ft,mt],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[mt,[ft,Fn,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[mt,ft],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[mt,"Netscape"],ft],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[ft,[mt,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[mt,ft],[/(cobalt)\/([\w\.]+)/i],[mt,[ft,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[St,"amd64"]],[/(ia32(?=;))/i],[[St,Pn]],[/((?:i[346]|x)86)[;\)]/i],[[St,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[St,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[St,"armhf"]],[/windows (ce|mobile); ppc;/i],[[St,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[St,/ower/,"",Pn]],[/(sun4\w)[;\)]/i],[[St,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[St,Pn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[ct,[pt,Cn],[rt,At]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[ct,[pt,Cn],[rt,xt]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[ct,[pt,Ft],[rt,xt]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[ct,[pt,Ft],[rt,At]],[/(macintosh);/i],[ct,[pt,Ft]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[ct,[pt,Tn],[rt,xt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[ct,[pt,gn],[rt,At]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[ct,[pt,gn],[rt,xt]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[ct,/_/g," "],[pt,mn],[rt,xt]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[ct,/_/g," "],[pt,mn],[rt,At]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[ct,[pt,"OPPO"],[rt,xt]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[ct,[pt,"Vivo"],[rt,xt]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[ct,[pt,"Realme"],[rt,xt]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[ct,[pt,fn],[rt,xt]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[ct,[pt,fn],[rt,At]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[ct,[pt,nn],[rt,At]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[ct,[pt,nn],[rt,xt]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[ct,[pt,"Lenovo"],[rt,At]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[ct,/_/g," "],[pt,"Nokia"],[rt,xt]],[/(pixel c)\b/i],[ct,[pt,tn],[rt,At]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[ct,[pt,tn],[rt,xt]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[ct,[pt,un],[rt,xt]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[ct,"Xperia Tablet"],[pt,un],[rt,At]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[ct,[pt,"OnePlus"],[rt,xt]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[ct,[pt,vt],[rt,At]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[ct,/(.+)/g,"Fire Phone $1"],[pt,vt],[rt,xt]],[/(playbook);[-\w\),; ]+(rim)/i],[ct,pt,[rt,At]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[ct,[pt,Wt],[rt,xt]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[ct,[pt,Ht],[rt,At]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[ct,[pt,Ht],[rt,xt]],[/(nexus 9)/i],[ct,[pt,"HTC"],[rt,At]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[pt,[ct,/_/g," "],[rt,xt]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[ct,[pt,"Acer"],[rt,At]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[ct,[pt,"Meizu"],[rt,xt]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[pt,ct,[rt,xt]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[pt,ct,[rt,At]],[/(surface duo)/i],[ct,[pt,qt],[rt,At]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[ct,[pt,"Fairphone"],[rt,xt]],[/(u304aa)/i],[ct,[pt,"AT&T"],[rt,xt]],[/\bsie-(\w*)/i],[ct,[pt,"Siemens"],[rt,xt]],[/\b(rct\w+) b/i],[ct,[pt,"RCA"],[rt,At]],[/\b(venue[\d ]{2,7}) b/i],[ct,[pt,"Dell"],[rt,At]],[/\b(q(?:mv|ta)\w+) b/i],[ct,[pt,"Verizon"],[rt,At]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[ct,[pt,"Barnes & Noble"],[rt,At]],[/\b(tm\d{3}\w+) b/i],[ct,[pt,"NuVision"],[rt,At]],[/\b(k88) b/i],[ct,[pt,"ZTE"],[rt,At]],[/\b(nx\d{3}j) b/i],[ct,[pt,"ZTE"],[rt,xt]],[/\b(gen\d{3}) b.+49h/i],[ct,[pt,"Swiss"],[rt,xt]],[/\b(zur\d{3}) b/i],[ct,[pt,"Swiss"],[rt,At]],[/\b((zeki)?tb.*\b) b/i],[ct,[pt,"Zeki"],[rt,At]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[pt,"Dragon Touch"],ct,[rt,At]],[/\b(ns-?\w{0,9}) b/i],[ct,[pt,"Insignia"],[rt,At]],[/\b((nxa|next)-?\w{0,9}) b/i],[ct,[pt,"NextBook"],[rt,At]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[pt,"Voice"],ct,[rt,xt]],[/\b(lvtel\-)?(v1[12]) b/i],[[pt,"LvTel"],ct,[rt,xt]],[/\b(ph-1) /i],[ct,[pt,"Essential"],[rt,xt]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[ct,[pt,"Envizen"],[rt,At]],[/\b(trio[-\w\. ]+) b/i],[ct,[pt,"MachSpeed"],[rt,At]],[/\btu_(1491) b/i],[ct,[pt,"Rotor"],[rt,At]],[/(shield[\w ]+) b/i],[ct,[pt,"Nvidia"],[rt,At]],[/(sprint) (\w+)/i],[pt,ct,[rt,xt]],[/(kin\.[onetw]{3})/i],[[ct,/\./g," "],[pt,qt],[rt,xt]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[ct,[pt,yn],[rt,At]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[ct,[pt,yn],[rt,xt]],[/smart-tv.+(samsung)/i],[pt,[rt,Dt]],[/hbbtv.+maple;(\d+)/i],[[ct,/^/,"SmartTV"],[pt,Cn],[rt,Dt]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[pt,nn],[rt,Dt]],[/(apple) ?tv/i],[pt,[ct,"Apple TV"],[rt,Dt]],[/crkey/i],[[ct,"Chromecast"],[pt,tn],[rt,Dt]],[/droid.+aft(\w)( bui|\))/i],[ct,[pt,vt],[rt,Dt]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[ct,[pt,Tn],[rt,Dt]],[/(bravia[\w ]+)( bui|\))/i],[ct,[pt,un],[rt,Dt]],[/(mitv-\w{5}) bui/i],[ct,[pt,mn],[rt,Dt]],[/Hbbtv.*(technisat) (.*);/i],[pt,ct,[rt,Dt]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[pt,On],[ct,On],[rt,Dt]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[rt,Dt]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[pt,ct,[rt,It]],[/droid.+; (shield) bui/i],[ct,[pt,"Nvidia"],[rt,It]],[/(playstation [345portablevi]+)/i],[ct,[pt,un],[rt,It]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[ct,[pt,qt],[rt,It]],[/((pebble))app/i],[pt,ct,[rt,wt]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[ct,[pt,Ft],[rt,wt]],[/droid.+; (glass) \d/i],[ct,[pt,tn],[rt,wt]],[/droid.+; (wt63?0{2,3})\)/i],[ct,[pt,yn],[rt,wt]],[/(quest( 2| pro)?)/i],[ct,[pt,pn],[rt,wt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[pt,[rt,Mt]],[/(aeobc)\b/i],[ct,[pt,vt],[rt,Mt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[ct,[rt,xt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[ct,[rt,At]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[rt,At]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[rt,xt]],[/(android[-\w\. ]{0,9});.+buil/i],[ct,[pt,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[ft,[mt,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[ft,[mt,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[mt,ft],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[ft,mt]],os:[[/microsoft (windows) (vista|xp)/i],[mt,ft],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[mt,[ft,Fn,dr]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[mt,"Windows"],[ft,Fn,dr]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[ft,/_/g,"."],[mt,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[mt,kn],[ft,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[ft,mt],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[mt,ft],[/\(bb(10);/i],[ft,[mt,Wt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[ft,[mt,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[ft,[mt,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[ft,[mt,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[ft,[mt,"watchOS"]],[/crkey\/([\d\.]+)/i],[ft,[mt,"Chromecast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[mt,In],ft],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[mt,ft],[/(sunos) ?([\w\.\d]*)/i],[[mt,"Solaris"],ft],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[mt,ft]]},Xn=function Jn(Qn,sr){if(et(Qn)===ht&&(sr=Qn,Qn=void 0),!(this instanceof Jn))return new Jn(Qn,sr).getResult();var Bn=et(ot)!==Rt&&ot.navigator?ot.navigator:void 0,rr=Qn||(Bn&&Bn.userAgent?Bn.userAgent:""),nr=Bn&&Bn.userAgentData?Bn.userAgentData:void 0,Nn=sr?function(vn,Rn){var Gt={};for(var Tt in vn)Rn[Tt]&&Rn[Tt].length%2==0?Gt[Tt]=Rn[Tt].concat(vn[Tt]):Gt[Tt]=vn[Tt];return Gt}(ir,sr):ir,Wn=Bn&&Bn.userAgent==rr;return this.getBrowser=function(){var vn,Rn={name:void 0,version:void 0};return Dn.call(Rn,rr,Nn.browser),Rn.major=et(vn=Rn.version)===bt?vn.replace(/[^\d\.]/g,"").split(".")[0]:void 0,Wn&&Bn&&Bn.brave&&et(Bn.brave.isBrave)==st&&(Rn.name="Brave"),Rn},this.getCPU=function(){var vn={architecture:void 0};return Dn.call(vn,rr,Nn.cpu),vn},this.getDevice=function(){var vn={vendor:void 0,model:void 0,type:void 0};return Dn.call(vn,rr,Nn.device),Wn&&!vn.type&&nr&&nr.mobile&&(vn.type=xt),Wn&&vn.model=="Macintosh"&&Bn&&et(Bn.standalone)!==Rt&&Bn.maxTouchPoints&&Bn.maxTouchPoints>2&&(vn.model="iPad",vn.type=At),vn},this.getEngine=function(){var vn={name:void 0,version:void 0};return Dn.call(vn,rr,Nn.engine),vn},this.getOS=function(){var vn={name:void 0,version:void 0};return Dn.call(vn,rr,Nn.os),Wn&&!vn.name&&nr&&nr.platform!="Unknown"&&(vn.name=nr.platform.replace(/chrome os/i,In).replace(/macos/i,kn)),vn},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return rr},this.setUA=function(vn){return rr=et(vn)===bt&&vn.length>350?On(vn,350):vn,this},this.setUA(rr),this};Xn.VERSION="1.0.35",Xn.BROWSER=Mn([mt,ft,"major"]),Xn.CPU=Mn([St]),Xn.DEVICE=Mn([ct,pt,rt,It,xt,Dt,At,wt,Mt]),Xn.ENGINE=Xn.OS=Mn([mt,ft]),et(o)!==Rt?(et(it)!==Rt&&it.exports&&(o=it.exports=Xn),o.UAParser=Xn,ot.UAParser=Xn):et(ot)!==Rt&&(ot.UAParser=Xn);var tr=et(ot)!==Rt&&(ot.jQuery||ot.Zepto);if(tr&&!tr.ua){var cn=new Xn;tr.ua=cn.getResult(),tr.ua.get=function(){return cn.getUA()},tr.ua.set=function(Jn){cn.setUA(Jn);var Qn=cn.getResult();for(var sr in Qn)tr.ua[sr]=Qn[sr]}}}((typeof window>"u"?"undefined":et(window))==="object"?window:void 0)},1256:(it,ut,s)=>{s.r(ut),s.d(ut,{Call:()=>qr,CloudApi:()=>cp,Conference:()=>Fs,Contact:()=>No,Conversation:()=>jo,ConversationCall:()=>Gl,DataChannel:()=>ys,Enterprise:()=>Xs,EventCenter:()=>Mt,EventEmitter:()=>ht,MediaDevice:()=>Ht,Observable:()=>fn,PointerSharingRoom:()=>ru,ReceivedCallInvitation:()=>Ir,ReceivedConversationInvitation:()=>Bt,ReceivedConversationJoinRequest:()=>Ho,ReceivedDataChannelInvitation:()=>zo,ReceivedFileTransferInvitation:()=>eo,ReceivedInvitation:()=>Rn,ReceivedPointerSharingInvitation:()=>xl,ReceivedWhiteboardInvitation:()=>vs,SentInvitation:()=>Do,Session:()=>Br,Stream:()=>so,UserAgent:()=>sp,UserData:()=>Io,default:()=>wm}),s(7941),s(2526),s(1817),s(1539),s(2165),s(6992),s(8783),s(3948);var et=s(3173);function ot($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function st($t){return st=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},st($t)}function Rt($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}s(4603),s(4916),s(9714),s(7042),s(561),s(9070),s(8309),s(1038),s(9753);var ht=function(){function $t(){(function(kt,jt){if(!(kt instanceof jt))throw new TypeError("Cannot call a class as a function")})(this,$t)}var Lt,Yt;return Lt=$t,Yt=[{key:"getListeners",value:function(kt){var jt,sn,ln=this._getEvents();if(kt instanceof RegExp)for(sn in jt={},ln)ln.hasOwnProperty(sn)&&kt.test(sn)&&(jt[sn]=ln[sn]);else jt=ln[kt]||(ln[kt]=[]);return jt}},{key:"flattenListeners",value:function(kt){var jt,sn=[];for(jt=0;jt<kt.length;jt+=1)sn.push(kt[jt].listener);return sn}},{key:"getListenersAsObject",value:function(kt){var jt,sn=this.getListeners(kt);return sn instanceof Array&&((jt={})[kt]=sn),jt||sn}},{key:"emit",value:function(kt){var jt=Array.prototype.slice.call(arguments,1);return this.emitEvent(kt,jt)}},{key:"addListener",value:function(kt,jt){if(!rt(jt))throw new TypeError("listener must be a function");var sn,ln=this.getListenersAsObject(kt),Kt=st(jt)==="object";for(sn in ln)ln.hasOwnProperty(sn)&&ct(ln[sn],jt)===-1&&ln[sn].push(Kt?jt:{listener:jt,once:!1});if(kt==="contactListUpdate"){apiRTC.userAgentInstance.currentSession.contactListUpdateListenerSetted=!0;var dt,gt=function(zt,Xt){var Zt=typeof Symbol<"u"&&zt[Symbol.iterator]||zt["@@iterator"];if(!Zt){if(Array.isArray(zt)||(Zt=function(cr,hr){if(cr){if(typeof cr=="string")return ot(cr,hr);var Ar=Object.prototype.toString.call(cr).slice(8,-1);return Ar==="Object"&&cr.constructor&&(Ar=cr.constructor.name),Ar==="Map"||Ar==="Set"?Array.from(cr):Ar==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ar)?ot(cr,hr):void 0}}(zt))||Xt&&zt&&typeof zt.length=="number"){Zt&&(zt=Zt);var on=0,bn=function(){};return{s:bn,n:function(){return on>=zt.length?{done:!0}:{done:!1,value:zt[on++]}},e:function(cr){throw cr},f:bn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var En,Gn=!0,Kn=!1;return{s:function(){Zt=Zt.call(zt)},n:function(){var cr=Zt.next();return Gn=cr.done,cr},e:function(cr){Kn=!0,En=cr},f:function(){try{Gn||Zt.return==null||Zt.return()}finally{if(Kn)throw En}}}}(apiRTC.userAgentInstance.currentSession.waitingContactListUpdateEvent);try{for(gt.s();!(dt=gt.n()).done;){var Nt=dt.value;this.emit("contactListUpdate",Nt)}}catch(zt){gt.e(zt)}finally{gt.f()}apiRTC.userAgentInstance.currentSession.waitingContactListUpdateEvent=[]}else if(kt==="mediaDeviceChanged"&&apiRTC.mediaDeviceMgr.mediaDeviceChangedDetected===!0){var Vt=apiRTC.mediaDeviceMgr.getMediaDeviceListsDiff(apiRTC.mediaDeviceMgr.mediaDeviceSourceInfosArray,apiRTC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources);apiRTC.myWebRTC_Event.createMediaDeviceChangedEvent(Vt,"updatedOnDeviceChange",apiRTC.mediaDeviceMgr.realMediaDevicesListInitializationWasAlreadyDone)}return this}},{key:"addOnceListener",value:function(kt,jt){return this.addListener(kt,{listener:jt,once:!0})}},{key:"defineEvent",value:function(kt){return this.getListeners(kt),this}},{key:"defineEvents",value:function(kt){for(var jt=0;jt<kt.length;jt+=1)this.defineEvent(kt[jt]);return this}},{key:"removeListener",value:function(kt,jt){var sn,ln,Kt=this.getListenersAsObject(kt);for(ln in Kt)Kt.hasOwnProperty(ln)&&(sn=ct(Kt[ln],jt))!==-1&&Kt[ln].splice(sn,1);return this}},{key:"addListeners",value:function(kt,jt){return this.manipulateListeners(!1,kt,jt)}},{key:"removeListeners",value:function(kt,jt){return this.manipulateListeners(!0,kt,jt)}},{key:"manipulateListeners",value:function(kt,jt,sn){var ln,Kt,dt=kt?this.removeListener:this.addListener,gt=kt?this.removeListeners:this.addListeners;if(st(jt)!=="object"||jt instanceof RegExp)for(ln=sn.length;ln--;)dt.call(this,jt,sn[ln]);else for(ln in jt)jt.hasOwnProperty(ln)&&(Kt=jt[ln])&&(typeof Kt=="function"?dt.call(this,ln,Kt):gt.call(this,ln,Kt));return this}},{key:"removeEvent",value:function(kt){var jt,sn=st(kt),ln=this._getEvents();if(sn==="string")delete ln[kt];else if(kt instanceof RegExp)for(jt in ln)ln.hasOwnProperty(jt)&&kt.test(jt)&&delete ln[jt];else delete this._events;return this}},{key:"emitEvent",value:function(kt,jt){var sn,ln,Kt,dt,gt=this.getListenersAsObject(kt);for(dt in gt)if(gt.hasOwnProperty(dt))for(sn=gt[dt].slice(0),Kt=0;Kt<sn.length;Kt++)(ln=sn[Kt]).once===!0&&this.removeListener(kt,ln.listener),ln.listener.apply(this,jt||[])===this._getOnceReturnValue()&&this.removeListener(kt,ln.listener);return this}},{key:"setOnceReturnValue",value:function(kt){return this._onceReturnValue=kt,this}},{key:"_getOnceReturnValue",value:function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue}},{key:"_getEvents",value:function(){return this._events||(this._events={})}}],Yt&&Rt(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}(),bt=ht.prototype,ct=function($t,Lt){for(var Yt=$t.length;Yt--;)if($t[Yt].listener===Lt)return Yt;return-1},mt=function($t){return function(){return this[$t].apply(this,arguments)}},rt=function $t(Lt){return typeof Lt=="function"||Lt instanceof RegExp||!(!Lt||st(Lt)!=="object")&&$t(Lt.listener)};bt.on=mt("addListener"),bt.once=mt("addOnceListener"),bt.off=mt("removeListener"),bt.removeAllListeners=mt("removeEvent"),bt.trigger=mt("emitEvent"),s(1249);var pt=s(5945),ft=s(1549),St=s(4708);ft.Y.get("ApiCC");var It={description:"ApiRTC Cloud Communication Library",session:null,jsLoaded:!1,initApiKey:null,initApiCCId:null,extJsLoadingRetryNb:null,extJsLoadingRetryDelay:null,bandwidthTestServer:"https://cloud.apizee.com",bandwidthRatingThresholds:[300,500,1e3,1500,2e3],LOG_LEVEL_OFF:0,LOG_LEVEL_ERROR:1,LOG_LEVEL_WARN:2,LOG_LEVEL_INFO:3,LOG_LEVEL_DEBUG:4,LOG_LEVEL_TRACE:5,browser:pt.Xh,browser_major_version:pt.PR,browser_version:pt.dc,osName:pt.BF,osVersion:pt.MM,osUAParser:pt.ag,browserInfo:pt.cf,browserDetails:St.wL,parser:pt.E2,logStorageActivated:!1,logStorageLevel:3,logStorage:[],eventCenter:null,sioEmbedded:!1,apizee_version:"5.0"};function xt($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}var At=ft.Y.get("EventCenter"),Dt="eventCenterData",wt="[REMOTE-EVENTCENTER]",Mt=function(){function $t(){var kt=this;(function(jt,sn){if(!(jt instanceof sn))throw new TypeError("Cannot call a class as a function")})(this,$t),this.consoleOutputEnabled=!1,this.storageDisabled=!1,typeof apiRTC_React>"u"&&(document.addEventListener("error",function(jt){kt.handleErrorEvent(jt)}),document.addEventListener("userMediaError",function(jt){kt.handleErrorEvent(jt)}))}var Lt,Yt;return Lt=$t,Yt=[{key:"handleErrorEvent",value:function(kt){var jt=kt.detail;if(this.storageDisabled!==!0)if(jt!==void 0){var sn={},ln={},Kt="UNKNOWN";sn.type=kt.type;for(var dt=0,gt=Object.keys(jt);dt<gt.length;dt++){var Nt=gt[dt];Nt!=="eventType"&&(sn[Nt]=jt[Nt])}sn.systemInfo={apiRTC:It.version,app:pt.$6,device:pt.vO,osName:pt.BF,osVersion:pt.MM,browser:pt.Xh,browser_version:pt.dc},It.session!==null&&It.session!==void 0?Kt=It.session.apiCCId:It.initApiCCId!==null&&It.initApiCCId!==void 0&&(Kt=It.initApiCCId),sn.userInfo={apiCCId:Kt,apiKey:apiRTC.initApiKey};var Vt=localStorage.getItem(Dt);(Vt=Vt?JSON.parse(Vt):[]).unshift(sn),Vt.length>100&&Vt.splice(100,Vt.length-100),localStorage.setItem(Dt,JSON.stringify(Vt)),this.consoleOutputEnabled&&At.error("[EVENTCENTER]",sn),typeof Sentry<"u"&&(kt.detail.errorCode!=="USER_MEDIA_ERROR"?(ln.type=kt.type,kt.detail.error&&(ln.error=kt.detail.error),kt.detail.errorInfo&&(ln.errorInfo=kt.detail.errorInfo),kt.detail.errorCode&&(ln.errorCode=kt.detail.errorCode),kt.detail.callId&&(ln.callId=kt.detail.callId),kt.detail.convId&&(ln.convId=kt.detail.convId),kt.detail.gumConfig&&(kt.detail.gumConfig.video===!1?ln.gumConfigVideo=!1:ln.gumConfigVideo=!0),Sentry.withScope(function(zt){zt.setTag("event-center",!0),zt.setTag("userId",It.session.apiCCId),Sentry.captureException(new Error(JSON.stringify(ln)))})):At.debug("Filtering error event for USER_MEDIA_ERROR for Sentry"))}else At.error("Can't handle error event: data is undefined");else At.debug("Event Center is disabled")}},{key:"handleDataAnswer",value:function(kt){kt?kt.map(function(jt){At.debug(wt+": ",jt)}):At.debug(wt+": "+this.getUsername()+" has no event records")}},{key:"getStoredData",value:function(){var kt=localStorage.getItem(Dt);return kt===void 0?(At.warn("No data was stored by event center"),null):JSON.parse(kt)}},{key:"clearStoredData",value:function(){localStorage.removeItem(Dt)}},{key:"enableConsoleOutput",value:function(kt){this.consoleOutputEnabled=kt}},{key:"disableStorage",value:function(kt){this.storageDisabled=kt}}],Yt&&xt(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function vt($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}s(3710);var Ft=ft.Y.get("MediaDevice"),Ht=function(){function $t(kt,jt,sn,ln){(function(Kt,dt){if(!(Kt instanceof dt))throw new TypeError("Cannot call a class as a function")})(this,$t),Ft.trace("Create "+jt+" MediaDevice"),this.id=kt,this.type=jt,this.label=sn,this.capabilities=ln}var Lt,Yt;return Lt=$t,(Yt=[{key:"getId",value:function(){return this.id.toString()}},{key:"getType",value:function(){return this.type}},{key:"getLabel",value:function(){return this.label}},{key:"isCamera",value:function(){return this.type==="videoinput"}},{key:"isMicrophone",value:function(){return this.type==="audioinput"}},{key:"isAudioOutput",value:function(){return this.type==="audiooutput"}},{key:"getCapabilities",value:function(){return this.capabilities}}])&&vt(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}(),Wt=(s(1532),s(4129),s(9653),s(4363),s(2772),s(9554),s(4747),s(8674),s(9575),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(2707),s(2564),s(7327),s(9600),s(285),s(1637),s(2479),s(4812),s(2222),s(1058),s(6755),s(4986),s(8304),s(489),s(2419),s(8011),s(2443),s(3680),s(3706),s(2703),s(4819),s(5003),s(1215));function tn($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function gn($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}var nn=new WeakMap,qt=new WeakMap,fn=function(){function $t(jt){(function(sn,ln){if(!(sn instanceof ln))throw new TypeError("Cannot call a class as a function")})(this,$t),qt.set(this,jt),nn.set(this,new ht)}var Lt,Yt,kt;return Lt=$t,kt=[{key:"getAvailableEvents",value:function(){return[]}}],(Yt=[{key:"on",value:function(jt,sn){return this.constructor.getAvailableEvents().indexOf(jt)>-1?nn.get(this).on(jt,sn):qt.get(this).error("No such event "+jt),this}},{key:"removeListener",value:function(jt,sn){if(this.constructor.getAvailableEvents().indexOf(jt)>-1){var ln,Kt=!1,dt=function(gt,Nt){var Vt=typeof Symbol<"u"&&gt[Symbol.iterator]||gt["@@iterator"];if(!Vt){if(Array.isArray(gt)||(Vt=function(En,Gn){if(En){if(typeof En=="string")return tn(En,Gn);var Kn=Object.prototype.toString.call(En).slice(8,-1);return Kn==="Object"&&En.constructor&&(Kn=En.constructor.name),Kn==="Map"||Kn==="Set"?Array.from(En):Kn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Kn)?tn(En,Gn):void 0}}(gt))||Nt&&gt&&typeof gt.length=="number"){Vt&&(gt=Vt);var zt=0,Xt=function(){};return{s:Xt,n:function(){return zt>=gt.length?{done:!0}:{done:!1,value:gt[zt++]}},e:function(En){throw En},f:Xt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Zt,on=!0,bn=!1;return{s:function(){Vt=Vt.call(gt)},n:function(){var En=Vt.next();return on=En.done,En},e:function(En){bn=!0,Zt=En},f:function(){try{on||Vt.return==null||Vt.return()}finally{if(bn)throw Zt}}}}(nn.get(this).getListeners(jt));try{for(dt.s();!(ln=dt.n()).done;)if(ln.value.listener===sn){Kt=!0;break}}catch(gt){dt.e(gt)}finally{dt.f()}Kt?nn.get(this).off(jt,sn):qt.get(this).trace("removeListener() - No such listener for event "+jt)}else qt.get(this).error("No such event "+jt);return this}}])&&gn(Lt.prototype,Yt),kt&&gn(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Cn($t,Lt){var Yt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Yt){if(Array.isArray($t)||(Yt=function(dt,gt){if(dt){if(typeof dt=="string")return Tn(dt,gt);var Nt=Object.prototype.toString.call(dt).slice(8,-1);return Nt==="Object"&&dt.constructor&&(Nt=dt.constructor.name),Nt==="Map"||Nt==="Set"?Array.from(dt):Nt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Nt)?Tn(dt,gt):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Yt&&($t=Yt);var kt=0,jt=function(){};return{s:jt,n:function(){return kt>=$t.length?{done:!0}:{done:!1,value:$t[kt++]}},e:function(dt){throw dt},f:jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Kt=!1;return{s:function(){Yt=Yt.call($t)},n:function(){var dt=Yt.next();return ln=dt.done,dt},e:function(dt){Kt=!0,sn=dt},f:function(){try{ln||Yt.return==null||Yt.return()}finally{if(Kt)throw sn}}}}function Tn($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function un($t){return un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},un($t)}function mn($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}s(6699),s(2023),s(3843);var yn=ft.Y.get("ApiRTCManager"),pn=["sessionReady","incomingCall","callEstablished","userMediaSuccess","userMediaStop","userMediaError","callRestarting","error","receiveIMMessage","updatePresence","webRTCClientCreated","updateUserStatus","channelEvent","groupChatCreation","groupChatInvitation","groupChatMemberUpdate","addUserInGroupChatAnswer","receiveGroupChatMessage","userDataAnswer","fetchUserDataAnswer","receiveConversationList","receiveConversationHistory","receiveConversationDetailReport","receiveContactOccurrencesFromConversationList","receiveMCUSessionInvitation","MCUSessionCreation","MCUAvailableStream","MCUAvailableStreamUpdate","MCURemoveStream","canPlayRemoteVideo","recordedFileAvailable","receiveData","roomCreation","roomJoined","roomInvitation","roomMemberUpdate","receiveRoomMessage","contactListInRoom","snapShotPhotoUploaded","stopRecord","callAttempt","joinMCUSessionAnswer","hangup","desktopCapture","remoteStreamAdded","remoteStreamRemoved","switchStream","sendDataChannelOpen","sendDataChannelClose","sendDataChannelError","receiveDataChannelOpen","receiveDataChannelClose","receiveDataChannelError","connectedUsersListUpdate","onFileSended","onFileSending","onFileReceiving","onFileReceived","onFileProgress","onFilePending","recordedStreamsAvailable","closingWhiteBoard","webRTCPluginInstallation","onQosStatsUpdate","onQosChange","onQosAudioChange","onQosVideoChange","MCURecordedStreamsAvailable","MCURecordingStarted","MCURecordingStopped","ICECandidateTypeUpdate","disconnectionWarning","MCUAvailableComposite","MCUParticipantEjected","MCUStreamingStarted","MCUStreamingStopped","MCUAvailableReplay","MCURoomModeChanged","onCallStatsUpdate","slowLink","localStreamUpdated","remoteStreamUpdated","audioAmplitude","videoQualityChanged","cpuLimited","bandwidthLimited","simulcastFeedChanged","cloudEventOccurred","groupUnsubscribed","transferBegun","transferProgress","transferEnded"],In=null,kn=!1,Mn=!1,xn=function($t){if(In!==null&&In.isInitialized()){if($t==="groupUnsubscribed"||$t==="transferBegun"||$t==="transferProgress"||$t==="transferEnded")return;apiRTC.addEventListener($t,function(Lt){yn.trace("Emiting "+$t,Lt),In.eventEmitter.emit($t,Lt)})}},Pn=function($t){In!==null&&In.isInitialized()&&apiRTC.removeEventListener($t,function(Lt){yn.trace("Emiting "+$t,Lt),In.eventEmitter.emit($t,Lt)})},On=function(){function $t(){if(function(jt,sn){if(!(jt instanceof sn))throw new TypeError("Cannot call a class as a function")}(this,$t),In!==null)throw"Cannot construct singleton ApiRTCManager";this.eventEmitter=new ht,this.apiRTCSession=null,this.whiteBoardClient=null,this.pointerSharingClient=null,this.webRTCClient=null,this.dataClient=null,this.IMClient=null,this.contactDisconnectionDelay=et.g.CONTACT_DISCONNECTION_DELAY,In=this}var Lt,Yt,kt;return Lt=$t,Yt=[{key:"onEvent",value:function(jt,sn){return pn.indexOf(jt)>-1?this.eventEmitter.on(jt,sn):yn.error("No such apiRTC event "+jt),this}},{key:"onceEvent",value:function(jt,sn){pn.indexOf(jt)>-1?this.eventEmitter.once(jt,sn):yn.error("No such apiRTC event "+jt)}},{key:"sendData",value:function(jt,sn){var ln=this;return new Promise(function(Kt,dt){ln.dataClient===null?dt(et.g.ERROR_APIRTC_INITIALISATION_FAILED):ln.dataClient.sendData(jt,sn,function(gt){var Nt=et.g.ERROR_OTHER;gt!=null?gt.reason!=="timeoutReached"&&gt.reason!=="destNotFound"?Kt():(gt.reason==="timerReached"?Nt=et.g.ERROR_TIMED_OUT:gt.reason==="destNotFound"&&(Nt=et.g.ERROR_NOT_FOUND),dt(Nt)):dt(Nt)})})}},{key:"sendMessage",value:function(jt,sn){var ln=this,Kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(dt,gt){ln.IMClient===null?gt(et.g.ERROR_APIRTC_INITIALISATION_FAILED):ln.IMClient.sendMessage(jt,sn,function(Nt){var Vt=et.g.ERROR_OTHER;Nt!=null?Nt.reason!=="timeoutReached"&&Nt.reason!=="destNotFound"?dt(Nt.UUCSeq):(Nt.reason==="timerReached"?Vt=et.g.ERROR_TIMED_OUT:Nt.reason==="destNotFound"&&(Vt=et.g.ERROR_NOT_FOUND),gt(Vt)):gt(Vt)},Kt)})}},{key:"joinGroupChat",value:function(jt){var sn=this;return new Promise(function(ln,Kt){if(sn.IMClient===null)return Kt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"joinGroupChat() - cannot join group chat"));sn.IMClient.joinGroupChat(jt),ln()})}},{key:"leaveGroupChat",value:function(jt){var sn=this;return new Promise(function(ln,Kt){if(sn.IMClient===null)return Kt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"leaveGroupChat() - cannot leave group chat"));sn.IMClient.leaveGroupChat(jt),ln()})}},{key:"sendMessageToGroupChat",value:function(jt,sn){var ln=this,Kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(dt,gt){if(ln.IMClient===null)gt(et.g.ERROR_APIRTC_INITIALISATION_FAILED);else{var Nt={};Wt.g.isTypeof(Kt,"metadata","object")&&(Nt.metadata=Kt.metadata),ln.IMClient.sendMessageToGroupChat(jt,sn,function(Vt){return Vt!==null&&un(Vt)==="object"?Vt.reason==="ack"?dt(Vt.UUCSeq):Vt.reason==="timeoutReached"?gt(et.g.ERROR_TIMED_OUT):Vt.reason==="destNotFound"?gt(et.g.ERROR_NOT_FOUND):gt(et.g.ERROR_OTHER):gt(et.g.ERROR_OTHER)},Nt)}})}},{key:"removeEventListener",value:function(jt,sn){sn!=null&&(pn.indexOf(jt)>-1?this.eventEmitter.off(jt,sn):yn.error("No such apiRTC event "+jt))}},{key:"isInitialized",value:function(){return kn}},{key:"unsubscribeToPresenceGroup",value:function(jt){this.apiRTCSession!==null?(this.apiRTCSession.unsubscribePresenceGroup([jt]),In.eventEmitter.emit("groupUnsubscribed",jt)):yn.error("apiRTC session is not initialized")}},{key:"joinAndSubscribeToPresenceGroup",value:function(jt){this.apiRTCSession!==null?(this.apiRTCSession.joinPresenceGroup([jt]),this.apiRTCSession.subscribePresenceGroup([jt])):yn.error("apiRTC session is not initialized")}},{key:"leaveAndUnsubscribeToPresenceGroup",value:function(jt){this.apiRTCSession!==null?(this.apiRTCSession.leavePresenceGroup([jt]),this.unsubscribeToPresenceGroup(jt)):yn.error("apiRTC session is not initialized")}},{key:"subscribeToCloudEvent",value:function(jt,sn){this.apiRTCSession?this.apiRTCSession.subscribeToCloudEvent(jt,sn):yn.error("apiRTC session is not initialized")}},{key:"unsubscribeToCloudEvent",value:function(jt,sn){this.apiRTCSession?this.apiRTCSession.unsubscribeToCloudEvent(jt,sn):yn.error("apiRTC session is not initialized")}},{key:"disconnect",value:function(){var jt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(apiRTC.disconnect(jt),kn=!1,this.apiRTCSession=null,this.webRTCClient=null,this.dataClient=null,this.IMClient=null,Mn){var sn,ln=Cn(pn);try{for(ln.s();!(sn=ln.n()).done;){var Kt=sn.value;Pn(Kt)}}catch(dt){ln.e(dt)}finally{ln.f()}Mn=!1}}},{key:"initializeApiRTC",value:function(jt){return yn.info("initializeApiRTC()"),new Promise(function(sn,ln){if(jt===void 0||jt.apiKey===void 0)ln("Invalid apiRTC initialization params");else{var Kt=function(dt){switch(yn.debug("onChannelEventDuringInit()",dt.detail),dt.detail.channelEvent){case"onChannelError":ln("Channel Error : "+dt.detail.event);break;case"onChannelConnectError":ln("Channel Connect Error : "+dt.detail.event);break;case"onChannelOpened":yn.debug("onChannelOpened");break;default:yn.debug("Unhandle case in onChannelEventDuringInit :",dt.detail.channelEvent)}};apiRTC.addEventListener("channelEvent",Kt),jt.onReady=function(){if(kn=!0,In.webRTCClient=apiRTC.session.createWebRTCClient({}),In.webRTCClient.setMCUConnector(jt.hasOwnProperty("mcu")?jt.mcu:et.g.DEFAULT_MCU),Wt.g.isPropertyTypeof(jt,"turnServerAddress","string")&&In.webRTCClient.setClientTurnServer(jt.turnServerAddress),In.webRTCClient.setUserAcceptOnIncomingCallBeforeGetUserMedia(!0),Wt.g.isPropertyTypeof(jt,"userAcceptOnIncomingDataCall","boolean")?In.webRTCClient.setUserAcceptOnIncomingDataCall(jt.userAcceptOnIncomingDataCall):In.webRTCClient.setUserAcceptOnIncomingDataCall(!0),Wt.g.isPropertyTypeof(jt,"userAcceptOnIncomingScreenSharingCall","boolean")?In.webRTCClient.setUserAcceptOnIncomingScreenSharingCall(jt.userAcceptOnIncomingScreenSharingCall):In.webRTCClient.setUserAcceptOnIncomingScreenSharingCall(!1),In.dataClient=apiRTC.session.createDataClient(),In.IMClient=apiRTC.session.createIMClient(),In.pointerSharingClient=apiRTC.session.createPointerSharingClient(),In.webRTCClient.setAllowMultipleCalls(!0),In.apiRTCSession=apiRTC.session,!Mn){var dt,gt=Cn(pn);try{for(gt.s();!(dt=gt.n()).done;){var Nt=dt.value;xn(Nt)}}catch(Vt){gt.e(Vt)}finally{gt.f()}Mn=!0}apiRTC.removeEventListener("channelEvent",Kt),sn(apiRTC.session.apiCCId)},kn=!1,In.apiRTCSession=null,In.webRTCClient=null,In.dataClient=null,In.IMClient=null,apiRTC.init(jt)}})}},{key:"createWhiteBoard",value:function(){yn.debug("createWhiteBoard()"),In.whiteBoardClient=apiRTC.createWhiteBoard(null,"invisible",null,6e4)}},{key:"getMediaDevices",value:function(){return yn.debug("ApiRTCManager::getMediaDevices()"),new Promise(function(jt,sn){apiRTC.getMediaDevices().then(function(ln){yn.debug("ApiRTCManager::getMediaDevices(), sources :",ln),jt(ln)}).catch(function(ln){var Kt="getMediaDevices() - error";yn.error(Kt,ln),sn(new Error(Kt))})})}},{key:"getUserMedia",value:function(jt){return new Promise(function(sn,ln){apiRTC.getUserMedia(jt).then(function(Kt){yn.debug("ApiRTCManager::getUserMedia() success"),sn(Kt)}).catch(function(Kt){yn.error("ApiRTCManager::getUserMedia() - Could not get user media :",Kt),ln(new Error("ApiRTCManager::getUserMedia() - Could not get user media :"+Kt))})})}},{key:"setAudioSourceIdInConstraint",value:function(jt,sn){return apiRTC.setAudioSourceIdInConstraint(jt,sn)}},{key:"setVideoSourceIdInConstraint",value:function(jt,sn){return apiRTC.setVideoSourceIdInConstraint(jt,sn)}},{key:"attachMediaStream",value:function(jt,sn){apiRTC.attachMediaStream(jt,sn)}},{key:"addStreamInDiv",value:function(jt,sn,ln,Kt,dt,gt,Nt){apiRTC.addStreamInDiv(jt,sn,ln,Kt,dt,gt,Nt)}},{key:"removeElementFromDiv",value:function(jt,sn){yn.debug("removeElementFromDiv"),apiRTC.removeElementFromDiv(jt,sn)}},{key:"getClientId",value:function(){return this.apiRTCSession!==null&&this.apiRTCSession.apiCCWebRTCClient!==null?this.apiRTCSession.apiCCWebRTCClient.webRTCClient.clientId:null}},{key:"getActiveApiKey",value:function(){return apiRTC.session!==void 0&&apiRTC.session!==null?apiRTC.session.apiKey:null}}],kt=[{key:"get",value:function(){return In===null&&(In=new $t),In}}],Yt&&mn(Lt.prototype,Yt),kt&&mn(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Dn($t){return Dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Dn($t)}function Fn($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function dr($t,Lt){return dr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},dr($t,Lt)}function ir($t,Lt){if(Lt&&(Dn(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xn($t)}function Xn($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function tr($t){return tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},tr($t)}var cn=ft.Y.get("Invitation"),Jn=new WeakMap,Qn=["statusChange"],sr=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&dr(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=tr(jt);if(sn){var Nt=tr(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return ir(this,dt)});function Kt(){var dt;return function(gt,Nt){if(!(gt instanceof Nt))throw new TypeError("Cannot call a class as a function")}(this,Kt),(dt=ln.call(this,cn)).id=null,Jn.set(Xn(dt),et.g.INVITATION_STATUS_STANDBY),dt.apiRTCManager=On.get(),dt.type="not_defined",dt}return Lt=Kt,kt=[{key:"getAvailableEvents",value:function(){return Qn}}],(Yt=[{key:"setStatus",value:function(dt){Jn.set(this,dt),nn.get(this).emit("statusChange",{status:dt,id:this.id})}},{key:"getStatus",value:function(){return Jn.get(this)}}])&&Fn(Lt.prototype,Yt),kt&&Fn(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(fn);function Bn($t){return Bn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Bn($t)}function rr($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function nr($t,Lt){return nr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},nr($t,Lt)}function Nn($t,Lt){if(Lt&&(Bn(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}($t)}function Wn($t){return Wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Wn($t)}ft.Y.get("ReceivedInvitation");var vn=["statusChange","messageDelivered","messageNotDelivered"],Rn=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&nr(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Wn(jt);if(sn){var Nt=Wn(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return Nn(this,dt)});function Kt(dt,gt){var Nt;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,Kt),(Nt=ln.call(this)).invitationType="received",Nt.id=gt,Nt.sender=dt,Nt.receiveTime=Date.now(),Nt}return Lt=Kt,kt=[{key:"getAvailableEvents",value:function(){return vn}}],(Yt=[{key:"accept",value:function(){return new Promise}},{key:"decline",value:function(dt){}},{key:"getSender",value:function(){return this.sender}},{key:"getReceiveTime",value:function(){return this.receiveTime}},{key:"getId",value:function(){return this.id}}])&&rr(Lt.prototype,Yt),kt&&rr(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(sr);function Gt($t){return Gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Gt($t)}function Tt($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function nt($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Ct($t,Lt){return Ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Ct($t,Lt)}function yt($t,Lt){if(Lt&&(Gt(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pt($t)}function Pt($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Et($t){return Et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Et($t)}var Ut=ft.Y.get("ReceivedInvitation"),Ot=new WeakMap,Bt=function($t){(function(Kt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Kt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Kt,writable:!0,configurable:!0}}),Object.defineProperty(Kt,"prototype",{writable:!1}),dt&&Ct(Kt,dt)})(ln,$t);var Lt,Yt,kt,jt,sn=(kt=ln,jt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Kt,dt=Et(kt);if(jt){var gt=Et(this).constructor;Kt=Reflect.construct(dt,arguments,gt)}else Kt=dt.apply(this,arguments);return yt(this,Kt)});function ln(Kt,dt,gt){var Nt,Vt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Tt(this,ln),Nt=sn.call(this,Kt,dt.invitationId),Ut.info("Create ReceivedConversationInvitation"),Nt.conversation=gt,Nt.type="conversation",Nt.invitationData=dt,Ot.set(Pt(Nt),Vt),Nt}return Lt=ln,Yt=[{key:"accept",value:function(Kt){var dt=this,gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Nt=function(){return new Promise(function(zt,Xt){var Zt=Ot.get(dt);gt.hasOwnProperty("password")&&(Zt.password=gt.password),gt.hasOwnProperty("session")&&(Zt.session=gt.session),dt.conversation.join(Zt).then(function(){Kt!=null&&dt.conversation.publish(Kt),zt(dt.conversation)}).catch(function(on){Xt(Wt.g.createError(et.g.ERROR_OTHER,"accept() - cannot join webconf",Ut,{fromError:on}))})})},Vt=function(){return new Promise(function(zt,Xt){dt.conversation.joinGroupChat().then(function(){zt(dt.conversation)}).catch(function(Zt){Xt(Wt.g.createError(et.g.ERROR_OTHER,"accept() - cannot join groupChat",Ut,{fromError:Zt}))})})};return new Promise(function(zt,Xt){return dt.getStatus()!==et.g.INVITATION_STATUS_STANDBY?Xt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"accept() - cannot accept invitation",Ut)):(dt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),dt.apiRTCManager.sendData(dt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,answer:"accept"}),dt.invitationData&&dt.invitationData.conversationTypes?dt.invitationData.conversationTypes.indexOf("WEBCONF")>=0?Nt().then(zt).catch(Xt):dt.invitationData.conversationTypes.indexOf("GROUP_CHAT")>=0?Vt().then(zt).catch(Xt):void 0:Nt().then(zt).catch(Xt))})}},{key:"decline",value:function(Kt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:Kt,answer:"decline"}))}},{key:"getConversation",value:function(){return this.conversation}}],Yt&&nt(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(Rn);function Qt($t){return Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Qt($t)}function en($t,Lt){var Yt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Yt){if(Array.isArray($t)||(Yt=function(dt,gt){if(dt){if(typeof dt=="string")return Jt(dt,gt);var Nt=Object.prototype.toString.call(dt).slice(8,-1);return Nt==="Object"&&dt.constructor&&(Nt=dt.constructor.name),Nt==="Map"||Nt==="Set"?Array.from(dt):Nt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Nt)?Jt(dt,gt):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Yt&&($t=Yt);var kt=0,jt=function(){};return{s:jt,n:function(){return kt>=$t.length?{done:!0}:{done:!1,value:$t[kt++]}},e:function(dt){throw dt},f:jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Kt=!1;return{s:function(){Yt=Yt.call($t)},n:function(){var dt=Yt.next();return ln=dt.done,dt},e:function(dt){Kt=!0,sn=dt},f:function(){try{ln||Yt.return==null||Yt.return()}finally{if(Kt)throw sn}}}}function Jt($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function an($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function hn($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function rn($t,Lt){return rn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},rn($t,Lt)}function dn($t,Lt){if(Lt&&(Qt(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sn($t)}function Sn($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function wn($t){return wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},wn($t)}s(189);var An=ft.Y.get("Call"),_n=On.get(),jn=["streamAdded","streamRemoved","response","accepted","declined","hangup","localStreamAvailable","recordAvailable","statsUpdate","error","disconnectionWarning","userMediaError","desktopCapture","remoteStreamUpdated","recordingStarted","recordingStopped","recordingAvailable"],ar=new Set(["audioSent","videoSent","audioReceived","videoReceived","quality"]),fr=new WeakMap,Cr=new WeakMap,gr=new WeakMap,Er=new WeakMap,Nr=new WeakMap,qr=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&rn(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=wn(jt);if(sn){var Nt=wn(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return dn(this,dt)});function Kt(dt,gt){var Nt,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(an(this,Kt),Nt=ln.call(this,An),An.debug("Create Call with id "+dt),fr.set(Sn(Nt),dt),Cr.set(Sn(Nt),gt),Nt.publishedStreams=new Map,Nt.receivedStreams=new Map,Nt.stats={},gr.set(Sn(Nt),Vt.hasOwnProperty("started")&&Vt.started?et.g.CALL_STATUS_ONGOING:et.g.CALL_STATUS_WAITING_FOR_CALLEE),Er.set(Sn(Nt),!!Vt.hasOwnProperty("isRecorded")&&Vt.isRecorded),Vt.isRecorded){Nt.confId=null,Nt.recordingStatus=null;for(var zt=_n.webRTCClient.webRTCClient.callsTable.length;--zt>=0;){var Xt=_n.webRTCClient.webRTCClient.callsTable[zt];if(Xt.callId===dt&&Xt.data){Nt.confId=Xt.data.confId;break}}Er.set(Sn(Nt),!0)}else Er.set(Sn(Nt),!1);var Zt={hangup:function(bn){Nt.getId()===bn.detail.callId&&Nt.destroy()},receiveData:function(bn){bn.detail.data.info!==void 0&&bn.detail.data.info===et.g.INVITATION_ANSWER_IDENTIFIER&&bn.detail.data.invitationId.toString()===Nt.getId()&&Nt.getStatus()===et.g.CALL_STATUS_WAITING_FOR_CALLEE&&(An.info("Call answer from "+Nt.getContact().getUsername()+" for "+Nt.getId()),bn.detail.data.answer==="accept"?(gr.set(Sn(Nt),et.g.CALL_STATUS_ONGOING),nn.get(Sn(Nt)).emit("accepted"),nn.get(Sn(Nt)).emit("response","accepted")):(gr.set(Sn(Nt),et.g.CALL_STATUS_ENDED),nn.get(Sn(Nt)).emit("declined",{reason:"User_Refused_Call"}),nn.get(Sn(Nt)).emit("response","declined")))},remoteStreamUpdated:function(bn){if(Nt.getId()===bn.detail.callId){var En={callId:bn.detail.callId,audio:bn.detail.audioIsAvailable&&bn.detail.audioIsActive,audioMuted:bn.detail.audioIsMuted,audioSilent:bn.detail.audioIsSilent,video:bn.detail.videoIsAvailable&&bn.detail.videoIsActive,videoMuted:bn.detail.videoIsMuted,videoSilent:bn.detail.videoIsSilent};nn.get(Sn(Nt)).emit("remoteStreamUpdated",En)}},MCURecordingStarted:function(bn){if(Er.get(Sn(Nt))&&bn.detail.roomName===Nt.confId){var En=Wt.g.parseRecordingEvent("MCURecordingStarted",bn.detail);En.callId==="COMPOSITE"&&(Nt.recordingStatus=En,nn.get(Sn(Nt)).emit("recordingStarted",En))}},MCURecordingStopped:function(bn){if(Er.get(Sn(Nt))&&bn.detail.roomName===Nt.confId){var En=Wt.g.parseRecordingEvent("MCURecordingStopped",bn.detail);En.callId==="COMPOSITE"&&(delete Nt.recordingStatus,nn.get(Sn(Nt)).emit("recordingStopped",En))}},MCURecordedStreamsAvailable:function(bn){if(Er.get(Sn(Nt))&&bn.detail.roomName===Nt.confId){var En=Wt.g.parseRecordingEvent("MCURecordedStreamsAvailable",bn.detail);nn.get(Sn(Nt)).emit("recordingAvailable",En)}}};for(var on in Zt)_n.onEvent(on,Zt[on]);return Nr.set(Sn(Nt),Zt),Nt}return Lt=Kt,Yt=[{key:"destroy",value:function(){var dt=Nr.get(this);if(dt){for(var gt in dt)_n.removeEventListener(gt,dt[gt]);Nr.delete(this)}}},{key:"getId",value:function(){return fr.get(this).toString()}},{key:"isRecorded",value:function(){return Er.get(this)}},{key:"getContact",value:function(){return Cr.get(this)}},{key:"getStatus",value:function(){return gr.get(this)}},{key:"setStatus",value:function(dt){gr.set(this,dt)}},{key:"getPublishedStreams",value:function(){var dt,gt=[],Nt=en(this.publishedStreams.values());try{for(Nt.s();!(dt=Nt.n()).done;){var Vt=dt.value;gt.push(Vt)}}catch(zt){Nt.e(zt)}finally{Nt.f()}return gt}},{key:"getReceivedStreams",value:function(){var dt,gt=[],Nt=en(this.receivedStreams.values());try{for(Nt.s();!(dt=Nt.n()).done;){var Vt=dt.value;gt.push(Vt)}}catch(zt){Nt.e(zt)}finally{Nt.f()}return gt}},{key:"hangUp",value:function(){this.getStatus()===et.g.CALL_STATUS_ENDED?An.error("hangUp() - Call has already ended"):_n.webRTCClient.hangUp(this.getId())}},{key:"getStats",value:function(){return Wt.g.assignObject({},this.stats)}},{key:"stopPublishedStreams",value:function(){return _n.webRTCClient.webRTCClient.stopMedia(this.getId())}},{key:"replacePublishedStreams",value:function(dt,gt){var Nt=this,Vt=function(zt){if(yo.has(zt))return yo.get(zt);var Xt=apiCC.getUserMediaStream(zt);if(Xt){var Zt="audio";return Xt.video===!0&&(Zt="video"),new so(Xt.stream,{type:Zt,constructor:!0,userMediaStreamId:Xt.userMediaStreamId})}return null};return new Promise(function(zt,Xt){if(Nt.getStatus()!==et.g.CALL_STATUS_ONGOING)return Xt(new Error("replacePublishedStreams() - Cannot replace stream as call is not ongoing"));if(dt===null)if(Wt.g.isPropertyTypeof(gt,"getStream","function")){var Zt={getUserMediaStreamId:function(){return gt.getStream().then(function(on){return on.userMediaStreamId}).catch(Xt)}};_n.webRTCClient.webRTCClient.addMedia(Nt.getId(),!0,null,Zt).then(function(on){return zt(Vt(on))}).catch(function(on){return Xt(new Error("replacePublishedStreams() - "+on))})}else _n.webRTCClient.webRTCClient.addMedia(Nt.getId(),!0,null,null).then(function(on){return zt(Vt(on))}).catch(function(on){return Xt(new Error("replacePublishedStreams() - "+on))});else _n.webRTCClient.webRTCClient.addMedia(Nt.getId(),!0,dt.userMediaStreamId).then(function(on){return zt(Vt(on))}).catch(function(on){return Xt(new Error("replacePublishedStreams() - "+on))})})}},{key:"getRecordingInfo",value:function(){return Er.get(this)?this.recordingStatus:null}},{key:"startRecording",value:function(){var dt=this;return new Promise(function(gt,Nt){if(dt.asyncCallbacks)return Nt(Wt.g.createError(et.g.ERROR_OTHER,"startRecording() - busy",An));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(_n.removeEventListener("error",dt.asyncCallbacks.error),_n.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),delete dt.asyncCallbacks),Nt(Wt.g.createError(et.g.ERROR_OTHER,"startRecording() - timeout",An))},et.g.CONVERSATION_RECORDING_STARTED_DELAY),dt.asyncCallbacks.error=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"&&Vt.detail.errorCode.indexOf("START_RECORD")>=0)return dt.asyncCallbacks&&(_n.removeEventListener("error",dt.asyncCallbacks.error),_n.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Nt(Wt.g.createError(et.g.ERROR_OTHER,"startRecording() - "+Vt.detail.errorInfo,An))},dt.asyncCallbacks.recordingStarted=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"){dt.asyncCallbacks&&(_n.removeEventListener("error",dt.asyncCallbacks.error),_n.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var zt=Wt.g.parseRecordingEvent("MCURecordingStarted",Vt.detail);return gt(zt)}},_n.onEvent("error",dt.asyncCallbacks.error),_n.onEvent("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),_n.webRTCClient.startCallRecording(fr.get(dt))})}},{key:"stopRecording",value:function(){var dt=this;return new Promise(function(gt,Nt){if(dt.asyncCallbacks)return Nt(Wt.g.createError(et.g.ERROR_OTHER,"stopRecording() - busy",An));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(_n.removeEventListener("error",dt.asyncCallbacks.error),_n.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),delete dt.asyncCallbacks),Nt(Wt.g.createError(et.g.ERROR_OTHER,"stopRecording() - timeout",An))},et.g.CONVERSATION_RECORDING_STOPPED_DELAY),dt.asyncCallbacks.error=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"&&Vt.detail.errorCode.indexOf("STOP_RECORD")>=0)return dt.asyncCallbacks&&(_n.removeEventListener("error",dt.asyncCallbacks.error),_n.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Nt(Wt.g.createError(et.g.ERROR_OTHER,"stopRecording() - "+Vt.detail.errorInfo,An))},dt.asyncCallbacks.recordingStopped=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"){dt.asyncCallbacks&&(_n.removeEventListener("error",dt.asyncCallbacks.error),_n.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var zt=Wt.g.parseRecordingEvent("MCURecordingStopped",Vt.detail);return gt(zt)}},_n.onEvent("error",dt.asyncCallbacks.error),_n.onEvent("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),_n.webRTCClient.stopCallRecording(fr.get(dt))})}},{key:"manageCallEstablishedEvent",value:function(dt){An.debug("callEstablished",dt.detail,this.getId());var gt=dt.detail.callId.toString();this.getId()===gt&&(An.info("callEstablished from "+this.getContact().getUsername(),dt),this.getStatus()!==et.g.CALL_STATUS_ONGOING&&this.getStatus()!==et.g.CALL_STATUS_ENDED&&(nn.get(this).emit("accepted"),nn.get(this).emit("response","accepted"),gr.set(this,et.g.CALL_STATUS_ONGOING)))}},{key:"manageRemoteStreamAddedEvent",value:function(dt){An.debug("remoteStreamAdded",dt.detail,this.getId());var gt=dt.detail.callId.toString();if(this.getId()===gt){var Nt=dt.detail.destCallType==="audio"?"audio":"video",Vt=dt.detail.callType==="screenSharing",zt=new so(dt.detail.stream,{screensharing:Vt,type:Nt,contact:this.getContact(),streamId:dt.detail.stream.id,callId:dt.detail.callId,callAudioAvailable:dt.detail.audioIsAvailable,callAudioActive:dt.detail.audioIsActive,callAudioMuted:dt.detail.audioIsMuted,callVideoAvailable:dt.detail.videoIsAvailable,callVideoActive:dt.detail.videoIsActive,callVideoMuted:dt.detail.videoIsMuted,constructor:!0});this.receivedStreams.set(dt.detail.stream.id,zt),nn.get(this).emit("streamAdded",zt)}}},{key:"manageRemoteStreamRemovedEvent",value:function(dt){An.debug("remoteStreamRemoved",dt.detail,this.getId());var gt=dt.detail.callId.toString();if(this.getId()===gt){var Nt=this.receivedStreams.get(dt.detail.stream.id);this.receivedStreams.delete(dt.detail.stream.id),nn.get(this).emit("streamRemoved",Nt)}}},{key:"manageUserMediaSuccessEvent",value:function(dt){An.debug("UserMediaSuccess",dt.detail,this.getId());var gt,Nt=null;if(gt=dt.detail.videoIsAvailable===!0?"video":"audio",dt.detail.callId!==null&&(Nt=dt.detail.callId.toString()),this.getId()===Nt){An.info("localStreamAvailable",dt.detail);var Vt=yo.get(dt.detail.userMediaStreamId);Vt||(Vt=new so(dt.detail.stream,{type:gt,constructor:!0,userMediaStreamId:dt.detail.userMediaStreamId,callId:this.getId()})),this.publishedStreams.set(Wt.g.guid(),Vt),nn.get(this).emit("localStreamAvailable",Vt)}}},{key:"manageCallStatsUpdateEvent",value:function(dt){if(this.getId()===dt.detail.callId){for(var gt=0,Nt=Object.keys(dt.detail.stats);gt<Nt.length;gt++){var Vt=Nt[gt];ar.has(Vt)&&(this.stats[Vt]=dt.detail.stats[Vt])}nn.get(this).emit("statsUpdate",Wt.g.assignObject({},{stats:this.stats}))}}},{key:"manageErrorEvent",value:function(dt){if(An.debug("Error",dt.detail,this.getId()),this.getId()===dt.detail.callId){var gt={errorCode:dt.detail.errorCode,errorInfo:dt.detail.errorInfo};dt.detail.data&&(gt.descriptor=dt.detail.data),nn.get(this).emit("error",gt)}}},{key:"manageDisconnectionWarningEvent",value:function(dt){An.debug("DisconnectionWarning",dt.detail,this.getId()),this.getId()===dt.detail.callId&&nn.get(this).emit("disconnectionWarning",{tries:dt.detail.tries})}},{key:"manageHangupEvent",value:function(dt){An.debug("hangup",dt.detail,this.getId());var gt=dt.detail.callId.toString(),Nt=this.getStatus()===et.g.CALL_STATUS_WAITING_FOR_CALLEE&&dt.detail.hangupType==="remote";if(this.getId()===gt&&this.getStatus()!==et.g.CALL_STATUS_ENDED){gr.set(this,et.g.CALL_STATUS_ENDED),An.info("Hangup from "+this.getContact().getUsername(),dt);var Vt,zt=en(this.receivedStreams.keys());try{for(zt.s();!(Vt=zt.n()).done;){var Xt=Vt.value,Zt=this.receivedStreams.get(Xt);this.receivedStreams.delete(Xt),nn.get(this).emit("streamRemoved",Zt)}}catch(on){zt.e(on)}finally{zt.f()}nn.get(this).emit("hangup",{from:dt.detail.hangupType,reason:dt.detail.reason}),Nt&&(nn.get(this).emit("declined",{reason:dt.detail.reason}),nn.get(this).emit("response","declined"))}}},{key:"manageRecordAvailableEvent",value:function(dt){An.warn("recordedStreamsAvailable",dt.detail,this.getId()),nn.get(this).emit("recordAvailable",{mediaURL:dt.detail.mediaURL})}},{key:"manageUserMediaErrorEvent",value:function(dt){An.warn("userMediaError",dt.detail,this.getId()),nn.get(this).emit("userMediaError",{callType:dt.detail.callType,error:dt.detail.error,onCallEstablishment:dt.detail.onCallEstablishment,userMediaStreamId:dt.detail.userMediaStreamId,tryAudioCallActivated:dt.detail.tryAudioCallActivated})}},{key:"manageDesktopCaptureEvent",value:function(dt){An.warn("desktopCapture",dt.detail,this.getId()),nn.get(this).emit("desktopCapture",{event:dt.detail.event})}}],kt=[{key:"getAvailableEvents",value:function(){return jn}}],Yt&&hn(Lt.prototype,Yt),kt&&hn(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(fn);function Qr($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function Sr($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}var Dr=ft.Y.get("ConversationCatalog"),wr=null,Or=function(){function $t(){if(function(jt,sn){if(!(jt instanceof sn))throw new TypeError("Cannot call a class as a function")}(this,$t),wr!==null)throw"Cannot construct singleton CallCatalog";this.callList=new Map,wr=this}var Lt,Yt,kt;return Lt=$t,kt=[{key:"get",value:function(){return wr===null&&(wr=new $t),wr}}],(Yt=[{key:"getOrCreateCall",value:function(jt,sn,ln){var Kt=null;return jt!=null&&(this.callList.has(jt.toString())?Kt=this.callList.get(jt.toString()):(Kt=new qr(jt.toString(),sn,ln),this.callList.set(jt.toString(),Kt))),Kt}},{key:"getCall",value:function(jt,sn){var ln=null;if(jt!=null){if(!this.callList.has(jt.toString()))return null;ln=this.callList.get(jt.toString())}else if(sn){var Kt,dt=function(Vt,zt){var Xt=typeof Symbol<"u"&&Vt[Symbol.iterator]||Vt["@@iterator"];if(!Xt){if(Array.isArray(Vt)||(Xt=function(Kn,cr){if(Kn){if(typeof Kn=="string")return Qr(Kn,cr);var hr=Object.prototype.toString.call(Kn).slice(8,-1);return hr==="Object"&&Kn.constructor&&(hr=Kn.constructor.name),hr==="Map"||hr==="Set"?Array.from(Kn):hr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(hr)?Qr(Kn,cr):void 0}}(Vt))||zt&&Vt&&typeof Vt.length=="number"){Xt&&(Vt=Xt);var Zt=0,on=function(){};return{s:on,n:function(){return Zt>=Vt.length?{done:!0}:{done:!1,value:Vt[Zt++]}},e:function(Kn){throw Kn},f:on}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var bn,En=!0,Gn=!1;return{s:function(){Xt=Xt.call(Vt)},n:function(){var Kn=Xt.next();return En=Kn.done,Kn},e:function(Kn){Gn=!0,bn=Kn},f:function(){try{En||Xt.return==null||Xt.return()}finally{if(Gn)throw bn}}}}(this.callList.values());try{for(dt.s();!(Kt=dt.n()).done;){var gt=Kt.value,Nt=gt.getContact();if(Nt&&Nt.getId()===sn.getId()){ln=gt;break}}}catch(Vt){dt.e(Vt)}finally{dt.f()}}return ln}},{key:"removeCallFromList",value:function(jt){Dr.log("removeCallFromList : av instance.callList :",wr.callList),wr.callList.has(jt)&&wr.callList.delete(jt),Dr.log("removeCallFromList : ap instance.callList :",wr.callList)}},{key:"getCalls",value:function(){return this.callList}}])&&Sr(Lt.prototype,Yt),kt&&Sr(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Ur($t){return Ur=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Ur($t)}function Hr($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function na($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Vn($t,Lt){return Vn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Vn($t,Lt)}function zn($t,Lt){if(Lt&&(Ur(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yn($t)}function Yn($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Rr($t){return Rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Rr($t)}var Hn=ft.Y.get("ReceivedInvitation"),jr=Or.get(),xr=["expired","statusChange"],Ir=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&Vn(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Rr(jt);if(sn){var Nt=Rr(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return zn(this,dt)});function Kt(dt,gt,Nt){var Vt,zt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Hr(this,Kt),Vt=ln.call(this,dt,gt),Hn.info("Create ReceivedCallInvitation with call type "+Nt),Vt.type="call",Vt.callType=Nt,Vt.isRecordedCall=!!zt.hasOwnProperty("isRecorded")&&zt.isRecorded,Vt.call=jr.getOrCreateCall(Vt.id,Vt.sender,{isRecorded:Vt.isRecorded()}),Vt.apiRTCManager.onEvent("hangup",function(Xt){var Zt=Xt.detail.callId.toString();Vt.id.toString()===Zt&&Vt.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(Vt.setStatus(et.g.INVITATION_STATUS_EXPIRED),nn.get(Yn(Vt)).emit("expired"))}),Vt}return Lt=Kt,Yt=[{key:"getCallType",value:function(){return this.callType}},{key:"isRecorded",value:function(){return this.isRecordedCall}},{key:"accept",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){var Xt=gt.getCallType()==="audio",Zt=!0,on=Nt;Nt.hasOwnProperty("audioOnly")&&(Xt=Nt.audioOnly,delete Nt.audioOnly,on.mediaTypeForIncomingCall!==void 0&&on.mediaTypeForIncomingCall!==null||Nt.audioOnly===!0&&(on.mediaTypeForIncomingCall="AUDIO")),Nt.hasOwnProperty("noStream")&&(on.mediaTypeForIncomingCall="NONE",Zt=!1),on.mediaTypeForIncomingCall==="NONE"&&(Zt=!1),gt.getStatus()===et.g.INVITATION_STATUS_STANDBY?(gt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),gt.apiRTCManager.sendData(gt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:gt.id,answer:"accept"}),gt.call.setStatus(et.g.CALL_STATUS_ONGOING),Zt&&dt!==null&&dt instanceof so&&(Hn.debug("accept() - A stream was preselected; audio only : ",Xt),on.userMediaStreamId=dt.userMediaStreamId),gt.apiRTCManager.webRTCClient.acceptCall(gt.id,on),Vt(gt.call)):zt(Wt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this call, invitation state invalid",Hn))})}},{key:"decline",value:function(dt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:dt,answer:"decline"}),this.apiRTCManager.webRTCClient.refuseCall(this.id))}},{key:"getCall",value:function(){return this.call}}],kt=[{key:"getAvailableEvents",value:function(){return xr}}],Yt&&na(Lt.prototype,Yt),kt&&na(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(Rn);function $n($t){return $n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},$n($t)}function pr($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function _r($t,Lt){return _r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},_r($t,Lt)}function yr($t,Lt){if(Lt&&($n(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}($t)}function Jr($t){return Jr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Jr($t)}var $r=ft.Y.get("ReceivedInvitation"),Co=["error","progress","statusChange"],eo=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&_r(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Jr(jt);if(sn){var Nt=Jr(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return yr(this,dt)});function Kt(dt,gt,Nt){var Vt;return function(zt,Xt){if(!(zt instanceof Xt))throw new TypeError("Cannot call a class as a function")}(this,Kt),Vt=ln.call(this,dt,gt),$r.debug("Create ReceivedFileTransferInvitation"),Vt.type="sendFile",Vt.fileInfo=Nt,Vt.apiRTCManager.onEvent("hangup",function(zt){$r.debug("hangup");var Xt=zt.detail.callId.toString();Vt.getId()===Xt&&($r.debug("hangup for ReceivedFileTransferInvitation"),Vt.getStatus()===et.g.INVITATION_STATUS_ENDED?$r.debug("invitation ended"):($r.debug("invitation is cancelled"),Vt.setStatus(et.g.INVITATION_STATUS_CANCELLED)),apiRTC.userAgentInstance.currentSession.invitationsMap.has(zt.detail.remoteId+"-sendfile-"+Xt)&&apiRTC.userAgentInstance.currentSession.invitationsMap.delete(zt.detail.remoteId+"-sendfile-"+Xt))}),Vt}return Lt=Kt,kt=[{key:"getAvailableEvents",value:function(){return Co}}],(Yt=[{key:"accept",value:function(){var dt=this;return new Promise(function(gt,Nt){if(dt.getStatus()!==et.g.INVITATION_STATUS_STANDBY)Nt(Wt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this file transfer session, invitation state invalid",$r));else{dt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),dt.apiRTCManager.sendData(dt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,answer:"accept"});var Vt=dt;dt.apiRTCManager.onEvent("onFileReceived",function zt(Xt){if(Xt.detail.callId.toString()===Vt.id.toString()){if($r.debug("typeof(e.detail.data.file) :",$n(Xt.detail.data.file)),typeof Xt.detail.data.file=="string")gt({file:Xt.detail.data.file,name:Xt.detail.data.name,type:Xt.detail.data.type});else{var Zt=new FileReader;Zt.addEventListener("loadend",function(){dt.setStatus(et.g.INVITATION_STATUS_ENDED),dt.apiRTCManager.webRTCClient.hangUp(Vt.id.toString());try{$r.info("accept() - file received from "+Vt.sender.getUsername()+" !"),gt({file:Xt.detail.data.file,name:Xt.detail.data.name,type:Xt.detail.data.type})}catch(on){$r.error("File Error",on),Nt(Wt.g.createError(et.g.ERROR_OTHER,"accept() - Could not read file received",$r))}}),Zt.readAsArrayBuffer(Xt.detail.data.file)}dt.apiRTCManager.removeEventListener("onFileReceived",zt)}}),dt.apiRTCManager.onEvent("onFileProgress",function(zt){zt.detail.callId.toString()===Vt.id.toString()&&($r.trace("file transfering",zt.detail),nn.get(Vt).emit("progress",{uuid:zt.detail.uuid,fileSize:zt.detail.fileSize,remainingSize:zt.detail.remainingSize,percentage:zt.detail.percentage,sendChunkNb:zt.detail.sendChunkNb,transferDuration:zt.detail.transferDuration,lastPacket:zt.detail.lastPacket}))}),dt.apiRTCManager.onEvent("receiveDataChannelError",function(zt){zt.detail.callId.toString()===Vt.id.toString()&&($r.warn("receiveDataChannelError",zt.detail),nn.get(Vt).emit("error","receiveDataChannelError"))}),dt.apiRTCManager.webRTCClient.acceptCall(dt.id,{mediaTypeForIncomingCall:"DATA"})}})}},{key:"getFileInfo",value:function(){return this.fileInfo}},{key:"decline",value:function(dt){$r.log("decline"),this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:dt,answer:"decline"}),this.apiRTCManager.webRTCClient.refuseCall(this.id))}}])&&pr(Lt.prototype,Yt),kt&&pr(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(Rn);function ga($t){return ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},ga($t)}function ms($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Qo($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Zs($t,Lt){return Zs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Zs($t,Lt)}function hp($t,Lt){if(Lt&&(ga(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}($t)}function gs($t){return gs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},gs($t)}var gu=ft.Y.get("ReceivedInvitation"),vs=function($t){(function(Kt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Kt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Kt,writable:!0,configurable:!0}}),Object.defineProperty(Kt,"prototype",{writable:!1}),dt&&Zs(Kt,dt)})(ln,$t);var Lt,Yt,kt,jt,sn=(kt=ln,jt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Kt,dt=gs(kt);if(jt){var gt=gs(this).constructor;Kt=Reflect.construct(dt,arguments,gt)}else Kt=dt.apply(this,arguments);return hp(this,Kt)});function ln(Kt,dt){var gt,Nt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ms(this,ln),gt=sn.call(this,Kt,dt),gu.info("Create ReceivedWhiteboardInvitation"),gt.type="whiteboard",Nt.cloudConvId&&(gt.cloudConvId=Nt.cloudConvId),Nt.webconf===!0&&(gt.webconf=!0),gt}return Lt=ln,(Yt=[{key:"accept",value:function(){var Kt=this;return new Promise(function(dt,gt){if(Kt.getStatus()===et.g.INVITATION_STATUS_STANDBY){Kt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),Kt.apiRTCManager.sendData(Kt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:"wb-"+Kt.id,answer:"accept"}),Kt.apiRTCManager.whiteBoardClient.leaveRoom(),Kt.apiRTCManager.whiteBoardClient.start();var Nt={};Kt.cloudConvId&&(Nt.convId=Kt.cloudConvId),Kt.webconf===!0&&(Nt.webconf=!0),Kt.apiRTCManager.whiteBoardClient.joinRoom(Kt.id,Nt),dt(Kt.id)}else gt(Wt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this whiteboard session, invitation state invalid",gu))})}},{key:"decline",value:function(Kt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:"wb-"+this.id,reason:Kt,answer:"decline"}))}}])&&Qo(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(Rn);function Cl($t){return Cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Cl($t)}function fp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function vu($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function yl($t,Lt){return yl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},yl($t,Lt)}function mp($t,Lt){if(Lt&&(Cl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yr($t)}function Yr($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Cs($t){return Cs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Cs($t)}var To=ft.Y.get("DataChannel"),Sl=On.get(),gp=["response","accepted","declined","error","opened","closed","error","transferProgress","transferComplete","dataReceived","ended"],Cu=new WeakMap,bu=new WeakMap,Zo=new WeakMap,bs=new WeakMap,ys=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&yl(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Cs(jt);if(sn){var Nt=Cs(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return mp(this,dt)});function Kt(dt,gt){var Nt,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return fp(this,Kt),Nt=ln.call(this,To),To.debug("Create DataChannel with id "+dt),Cu.set(Yr(Nt),dt),bu.set(Yr(Nt),gt),bs.set(Yr(Nt),et.g.DATACHANNEL_TYPE_RECEIVE),Vt.hasOwnProperty("type")&&(Vt.type===et.g.DATACHANNEL_TYPE_RECEIVE?bs.set(Yr(Nt),et.g.DATACHANNEL_TYPE_RECEIVE):Vt.type===et.g.DATACHANNEL_TYPE_SEND&&bs.set(Yr(Nt),et.g.DATACHANNEL_TYPE_SEND)),Zo.set(Yr(Nt),et.g.DATACHANNEL_STATUS_WAITING),Sl.onEvent("receiveData",function(zt){zt.detail.data.info!==void 0&&zt.detail.data.info===et.g.INVITATION_ANSWER_IDENTIFIER&&zt.detail.data.invitationId.toString()===Nt.getId()&&Nt.getStatus()===et.g.DATACHANNEL_STATUS_WAITING&&(To.info("DataChannel answer from "+Nt.getContact().getUsername()+" for "+Nt.getId()),zt.detail.data.answer==="accept"?nn.get(Yr(Nt)).emit("accepted"):(Zo.set(Yr(Nt),et.g.DATACHANNEL_STATUS_ENDED),nn.get(Yr(Nt)).emit("declined")),nn.get(Yr(Nt)).emit("response"))}).onEvent("callEstablished",function(zt){var Xt=zt.detail.callId.toString();Nt.getId()===Xt&&(To.info("callEstablished from "+Nt.getContact().getUsername(),zt),Nt.getStatus()!==et.g.DATACHANNEL_STATUS_ONGOING&&Nt.getStatus()!==et.g.DATACHANNEL_STATUS_ENDED&&nn.get(Yr(Nt)).emit("accepted"))}).onEvent("hangup",function(zt){var Xt=zt.detail.callId.toString(),Zt=Nt.getStatus()===et.g.DATACHANNEL_STATUS_WAITING&&zt.detail.hangupType==="remote";Nt.getId()===Xt&&Nt.getStatus()!==et.g.DATACHANNEL_STATUS_ENDED&&(Zo.set(Yr(Nt),et.g.DATACHANNEL_STATUS_ENDED),To.info("Hangup from "+Nt.getContact().getUsername(),zt),nn.get(Yr(Nt)).emit("ended",{from:zt.detail.hangupType}),Zt&&nn.get(Yr(Nt)).emit("declined"))}).onEvent("onFileReceived",function(zt){if(zt.detail.callId.toString()===Nt.getId()){var Xt=zt.detail.data,Zt=new FileReader;Zt.addEventListener("loadend",function(){try{var on=Wt.g.arrayBuffertoString(Zt.result);To.info("dataReceived !"),nn.get(Yr(Nt)).emit("dataReceived",{uuid:Xt.uuid,data:on})}catch(bn){To.error("dataReceived Error",bn)}}),Zt.readAsArrayBuffer(Xt.file)}}).onEvent("onFileProgress",function(zt){if(zt.detail.callId.toString()===Nt.getId()){var Xt=zt.detail;To.trace("file transfering",Xt);var Zt={uuid:Xt.uuid,fileSize:Xt.fileSize,remainingSize:Xt.remainingSize,percentage:Xt.percentage,sendChunkNb:Xt.sendChunkNb,transferDuration:Xt.transferDuration,lastPacket:Xt.lastPacket};nn.get(Yr(Nt)).emit("transferProgress",Zt),Xt.transferEnded&&nn.get(Yr(Nt)).emit("transferComplete",Zt)}}).onEvent("receiveDataChannelError",function(zt){var Xt=zt.detail.callId.toString();Nt.getId()===Xt&&nn.get(Yr(Nt)).emit("error","receiveDataChannelError")}).onEvent("sendDataChannelError",function(zt){var Xt=zt.detail.callId.toString();Nt.getId()===Xt&&nn.get(Yr(Nt)).emit("error","sendDataChannelError")}).onEvent("receiveDataChannelClose",function(zt){var Xt=zt.detail.callId.toString();Nt.getId()===Xt&&nn.get(Yr(Nt)).emit("closed")}).onEvent("sendDataChannelClose",function(zt){var Xt=zt.detail.callId.toString();Nt.getId()===Xt&&nn.get(Yr(Nt)).emit("closed")}).onEvent("receiveDataChannelOpen",function(zt){var Xt=zt.detail.callId.toString();Nt.getId()===Xt&&(Zo.set(Yr(Nt),et.g.DATACHANNEL_STATUS_ONGOING),nn.get(Yr(Nt)).emit("opened"))}).onEvent("sendDataChannelOpen",function(zt){var Xt=zt.detail.callId.toString();Nt.getId()===Xt&&nn.get(Yr(Nt)).emit("opened")}),Nt}return Lt=Kt,Yt=[{key:"getId",value:function(){return Cu.get(this).toString()}},{key:"getContact",value:function(){return bu.get(this)}},{key:"getType",value:function(){return bs.get(this)}},{key:"getStatus",value:function(){return Zo.get(this)}},{key:"sendData",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){var Xt=!1;gt.getStatus()!==et.g.DATACHANNEL_STATUS_ONGOING?zt(Wt.g.createError(et.g.ERROR_OTHER,"Cannot send data as datachannel session is not ongoing",To)):gt.getType()!==et.g.DATACHANNEL_TYPE_SEND?zt(Wt.g.createError(et.g.ERROR_OTHER,"Cannot send data as datachannel session is receiving only",To)):Sl.webRTCClient.sendDataWithCallId(gt.getId(),{file:dt,name:Nt.name,type:Nt.type},function(Zt){Xt||(Xt=!0,Vt(Zt.uuid)),To.trace("sendData() - progress : ",Zt);var on={uuid:Zt.uuid,fileSize:Zt.fileSize,remainingSize:Zt.remainingSize,percentage:Zt.percentage,sendChunkNb:Zt.sendChunkNb,transferDuration:Zt.transferDuration,lastPacket:Zt.lastPacket};nn.get(gt).emit("transferProgress",on),Zt.transferEnded&&nn.get(gt).emit("transferComplete",on)})})}},{key:"close",value:function(){this.getStatus()===et.g.DATACHANNEL_STATUS_ENDED?To.error("close() - DataChannel session has already ended"):Sl.webRTCClient.hangUp(this.getId())}}],kt=[{key:"getAvailableEvents",value:function(){return gp}}],Yt&&vu(Lt.prototype,Yt),kt&&vu(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(fn);function Tl($t){return Tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Tl($t)}function yu($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Il($t,Lt){return Il=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Il($t,Lt)}function vp($t,Lt){if(Lt&&(Tl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Su($t)}function Su($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Ss($t){return Ss=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Ss($t)}var Tu=ft.Y.get("ReceivedInvitation"),Cp=["expired","statusChange"],zo=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&Il(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Ss(jt);if(sn){var Nt=Ss(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return vp(this,dt)});function Kt(dt,gt){var Nt;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,Kt),Nt=ln.call(this,dt,gt),Tu.info("Create ReceivedDataChannelInvitation "),Nt.type="dataChannel",Nt.apiRTCManager.onEvent("hangup",function(Vt){var zt=Vt.detail.callId.toString();Nt.id.toString()===zt&&Nt.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(Nt.setStatus(et.g.INVITATION_STATUS_EXPIRED),nn.get(Su(Nt)).emit("expired"))}),Nt}return Lt=Kt,kt=[{key:"getAvailableEvents",value:function(){return Cp}}],(Yt=[{key:"accept",value:function(){var dt=this;return new Promise(function(gt,Nt){if(dt.getStatus()===et.g.INVITATION_STATUS_STANDBY){dt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),dt.apiRTCManager.sendData(dt.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,answer:"accept"});var Vt=new ys(dt.id,dt.sender,{started:!0,type:et.g.DATACHANNEL_TYPE_SEND});dt.apiRTCManager.webRTCClient.acceptCall(dt.id,{mediaTypeForIncomingCall:"DATA"}),gt(Vt)}else Nt(Wt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this datachannel session, invitation state invalid",Tu))})}},{key:"decline",value:function(dt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(this.setStatus(et.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:dt,answer:"decline"}),this.apiRTCManager.webRTCClient.refuseCall(this.id))}}])&&yu(Lt.prototype,Yt),kt&&yu(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(Rn);function Rl($t){return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Rl($t)}function bp($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function El($t,Lt){return El=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},El($t,Lt)}function yp($t,Lt){if(Lt&&(Rl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}($t)}function Ts($t){return Ts=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Ts($t)}var Ol=ft.Y.get("ReceivedInvitation"),Ho=function($t){(function(Kt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Kt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Kt,writable:!0,configurable:!0}}),Object.defineProperty(Kt,"prototype",{writable:!1}),dt&&El(Kt,dt)})(ln,$t);var Lt,Yt,kt,jt,sn=(kt=ln,jt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Kt,dt=Ts(kt);if(jt){var gt=Ts(this).constructor;Kt=Reflect.construct(dt,arguments,gt)}else Kt=dt.apply(this,arguments);return yp(this,Kt)});function ln(Kt,dt,gt){var Nt;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,ln),Nt=sn.call(this,Kt,gt),Ol.info("Create ReceivedConversationJoinRequest"),Nt.type="conversationJoinRequest",Nt.conversation=dt||null,Nt}return Lt=ln,(Yt=[{key:"getConversation",value:function(){return this.conversation}},{key:"accept",value:function(){var Kt=this;return new Promise(function(dt,gt){Kt.getStatus()===et.g.INVITATION_STATUS_STANDBY?(Kt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),Kt.conversation?Kt.conversation.allowEntry(Kt.sender,{invitationId:Kt.id,answer:"accept",ackEnabled:!0}).then(dt).catch(gt):(Kt.apiRTCManager.sendData(Kt.sender.getId(),{roomname:Kt.id,event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:Kt.id,answer:"accept",command:"access",value:{access:!0}}),dt())):gt(Wt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot accept request, invitation state invalid",Ol))})}},{key:"decline",value:function(Kt){var dt=this;return new Promise(function(gt,Nt){dt.getStatus()===et.g.INVITATION_STATUS_STANDBY?(dt.setStatus(et.g.INVITATION_STATUS_DECLINED),dt.conversation?dt.conversation.denyEntry(dt.sender,{invitationId:dt.id,answer:"decline",reason:Kt}).then(gt).catch(Nt):(dt.apiRTCManager.sendData(dt.sender.getId(),{roomname:dt.id,event:et.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,reason:Kt,answer:"decline",command:"access",value:{access:!1}}),gt())):Nt(Wt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"decline() - Cannot decline request, invitation state invalid",Ol))})}}])&&bp(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(Rn);function Al($t){return Al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Al($t)}function Sp($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Ml($t,Lt){return Ml=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Ml($t,Lt)}function Tp($t,Lt){if(Lt&&(Al(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}($t)}function Is($t){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Is($t)}var Iu=ft.Y.get("ReceivedInvitation"),xl=function($t){(function(Kt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Kt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Kt,writable:!0,configurable:!0}}),Object.defineProperty(Kt,"prototype",{writable:!1}),dt&&Ml(Kt,dt)})(ln,$t);var Lt,Yt,kt,jt,sn=(kt=ln,jt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Kt,dt=Is(kt);if(jt){var gt=Is(this).constructor;Kt=Reflect.construct(dt,arguments,gt)}else Kt=dt.apply(this,arguments);return Tp(this,Kt)});function ln(Kt,dt,gt){var Nt;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,ln),(Nt=sn.call(this,Kt,dt)).session=gt,Nt.type="pointerSharing",Nt}return Lt=ln,(Yt=[{key:"accept",value:function(){var Kt=this;return new Promise(function(dt,gt){Kt.getStatus()===et.g.INVITATION_STATUS_STANDBY?(Kt.setStatus(et.g.INVITATION_STATUS_ACCEPTED),Kt.session.joinPointerSharingRoom(Kt.id).then(dt).catch(function(Nt){gt(Wt.g.createError(et.g.ERROR_OTHER,"accept() - cannot accept invitation",Iu))})):gt(Wt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - cannot accept invitation",Iu))})}},{key:"decline",value:function(Kt){this.getStatus()===et.g.INVITATION_STATUS_STANDBY&&this.setStatus(et.g.INVITATION_STATUS_DECLINED)}}])&&Sp(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(Rn);function Ip($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}s(4723);var Lr=ft.Y.get("AicConsoleManager"),Ru=function(){function $t(){var kt=this;(function(jt,sn){if(!(jt instanceof sn))throw new TypeError("Cannot call a class as a function")})(this,$t),Lr.info("Create AicConsoleManager"),this.ws=null,this.connectedToapplication=!1,this.domStream=null,this.keyboard_mode=0,this.ports=[4545,5858,37371,41793,42803],this.port_index=0,this.aic_agent_running=0,this.ip="127.0.0.1",this.aic_agent_handshake_done=0,this.controlActivated=!1,this.handshakeTimeoutId=0,this.kd=function(jt){kt.key_down(jt)},this.ku=function(jt){kt.key_up(jt)},this.wfl=function(jt){kt.window_focus_lost(jt)},this.mm=function(jt){kt.mouse_move(jt)},this.dc=function(jt){kt.mouse_doubleclick(jt)},this.md=function(jt){kt.mouse_down(jt)},this.mu=function(jt){kt.mouse_up(jt)},this.mw=function(jt){kt.mouse_wheel(jt)}}var Lt,Yt;return Lt=$t,Yt=[{key:"aic_control_onmessage",value:function(kt){if(Lr.debug("Message to send to remote app :",kt),apiRTC.session.remoteAccessInvitation!==null){var jt={event:et.g.CONTACT_REMOTEACCESS_APP_MESSAGE,invitationId:apiRTC.session.remoteAccessInvitation.id,roomname:apiRTC.session.remoteAccessInvitation.conversation._getTechnicalName(),message:kt};apiRTC.session.remoteAccessInvitation.send(jt).then(function(){}).catch(function(sn){Lr.warn("Contact#send CONTACT_REMOTEACCESS_APP_MESSAGE message error:",sn)})}else Lr.error("Error on aic_control_onmessage, remoteAccessInvitation is not initialized")}},{key:"aic_keyboard_keydown",value:function(kt,jt){this.aic_control_onmessage('aic_keyboard_keypress("'+kt+'","KEY_DOWN,'+jt+'")')}},{key:"aic_keyboard_keyup",value:function(kt,jt){this.aic_control_onmessage('aic_keyboard_keypress("'+kt+'","KEY_UP,'+jt+'")')}},{key:"key_down",value:function(kt){if(Lr.debug("key_down"),kt.target===document.body)if(kt.preventDefault(),kt.isComposing||kt.keyCode===229)Lr.debug("Ignoring event "+kt);else if(this.keyboard_mode===0){var jt=(kt.altKey?"MOD_ALT,":"")+(kt.ctrlKey?"MOD_CONTROL,":"")+(kt.metaKey?"MOD_META,":"")+(kt.shiftKey?"MOD_SHIFT,":"");this.aic_keyboard_keydown(kt.key,jt)}else this.keyboard_mode===1&&this.aic_control_onmessage("aic_keyboard_keydown("+kt.keyCode+")");else Lr.debug("this is not document body, ignoring this event")}},{key:"key_up",value:function(kt){if(Lr.debug("key_up"),kt.target===document.body)if(kt.preventDefault(),kt.isComposing||kt.keyCode===229)console.log("Ignoring event "+kt);else if(this.keyboard_mode===0){var jt=(kt.altKey?"MOD_ALT,":"")+(kt.ctrlKey?"MOD_CONTROL,":"")+(kt.metaKey?"MOD_META,":"")+(kt.shiftKey?"MOD_SHIFT,":"");this.aic_keyboard_keyup(kt.key,jt)}else this.keyboard_mode===1&&this.aic_control_onmessage("aic_keyboard_keyup("+kt.keyCode+")");else Lr.debug("this is not document body, ignoring this event")}},{key:"window_focus_lost",value:function(kt){Lr.debug("window_focus_lost"),this.aic_keyboard_keyup("Shift","MOD_ALT,MOD_CONTROL,MOD_META,MOD_SHIFT")}},{key:"mouse_doubleclick",value:function(kt){this.mouse_move(kt),this.aic_control_onmessage("aic_mouse_doubleclick("+kt.which+")")}},{key:"mouse_down",value:function(kt){this.mouse_move(kt),this.aic_control_onmessage("aic_mouse_down("+kt.which+")")}},{key:"mouse_up",value:function(kt){this.mouse_move(kt),this.aic_control_onmessage("aic_mouse_up("+kt.which+")")}},{key:"mouse_wheel",value:function(kt){kt.preventDefault(),this.aic_control_onmessage("aic_mouse_scroll("+kt.deltaX+","+-1*kt.deltaY+")")}},{key:"mouse_move",value:function(kt){var jt=window.screen.width,sn=window.screen.height;apiRTC.session.remoteAccessInvitation!==null&&(jt=apiRTC.session.remoteAccessInvitation.screenWidth,sn=apiRTC.session.remoteAccessInvitation.screenHeight);var ln=getComputedStyle(kt.target),Kt=parseInt(ln.getPropertyValue("width"),10),dt=parseInt(ln.getPropertyValue("height"),10),gt=0,Nt=0,Vt=!1;Kt/parseInt(kt.target.videoWidth,10)<=dt/parseInt(kt.target.videoHeight,10)&&(Vt=!0),Vt===!0?(Lr.debug("Keeping width"),Nt=Kt*kt.target.videoHeight/kt.target.videoWidth,gt=Kt):(Lr.debug("Keeping height"),gt=dt*kt.target.videoWidth/kt.target.videoHeight,Nt=dt);var zt=kt.target.getBoundingClientRect(),Xt=kt.clientX-zt.left-(Kt-gt)/2,Zt=kt.clientY-zt.top-(dt-Nt)/2,on=Math.floor(Xt/gt*jt),bn=Math.floor(Zt/Nt*sn);this.aic_control_onmessage("aic_mouse_move("+on+","+bn+")")}},{key:"searchDOMElement",value:function(kt){var jt=this;return new Promise(function(sn,ln){if(jt.domStream=document.getElementById(kt),jt.domStream)sn();else{var Kt="Dom element not found in searchDOMElement";Lr.debug(Kt),ln(new Error(Kt))}})}},{key:"aic_control_start",value:function(){var kt=this;return new Promise(function(jt,sn){Lr.debug("aic_control_start"),window.oncontextmenu=function(){return!1};var ln=apiRTC.session.remoteAccessInvitation.screenSharingStreamDOMElementId;Lr.debug("domSearchFilter :",ln),kt.searchDOMElement(ln).then(function(){if(kt.domStream)Lr.debug("Adding mouse and keyboard events listeners"),document.addEventListener("keydown",kt.kd,{passive:!1}),document.addEventListener("keyup",kt.ku,{passive:!1}),document.addEventListener("blur",kt.wfl,{passive:!1}),kt.domStream.addEventListener("mousemove",kt.mm,!0),kt.domStream.addEventListener("mousedown",kt.md,!0),kt.domStream.addEventListener("mouseup",kt.mu,!0),kt.domStream.addEventListener("wheel",kt.mw,{passive:!1}),kt.controlActivated=!0,jt();else{var Kt="Dom element not found";Lr.debug(Kt),sn(new Error(Kt))}}).catch(function(Kt){sn(Kt)})})}},{key:"aic_control_stop",value:function(){var kt=this;return Lr.debug("aic_control_stop"),new Promise(function(jt,sn){if(window.oncontextmenu=function(){return!0},kt.domStream)Lr.debug("Removing mouse and keyboard events listeners"),document.removeEventListener("keydown",kt.kd,{passive:!1}),document.removeEventListener("keyup",kt.ku,{passive:!1}),document.removeEventListener("blur",kt.wfl,{passive:!1}),kt.domStream.removeEventListener("mousemove",kt.mm,!0),kt.domStream.removeEventListener("dblclick",kt.dc,!0),kt.domStream.removeEventListener("mousedown",kt.md,!0),kt.domStream.removeEventListener("mouseup",kt.mu,!0),kt.domStream.removeEventListener("wheel",kt.mw,{passive:!1}),kt.controlActivated=!1,jt();else{var ln="Dom element not found";Lr.debug(ln),sn(new Error(ln))}})}},{key:"aic_agent_send_message",value:function(kt){this.ws!==void 0?this.ws.readyState===1?this.ws.send(kt):Lr.info("aic_agent_send_message : ws in not in readyState"):Lr.info("aic_agent_send_message : ws in not defined")}},{key:"ws_onopen",value:function(){var kt=this;Lr.debug("ws_onopen : Connected"),this.aic_agent_handshake_done=0,this.aic_agent_send_message("aic_agent_start()"),this.handshakeTimeoutId=setTimeout(function(){Lr.error("Timeout reached on handshake"),kt.ws.close(1e3,"HANDSHAKE_NOK")},1e3)}},{key:"ws_onmessage",value:function(kt){var jt=kt.data;Lr.debug("received_msg :",jt);var sn=jt.match(/^aic_notify\(\"([^\"]*)\",\"([^\"]*)\"\)$/);sn&&sn[1]==="aic_agent_version"&&(Lr.debug("aic_agent_version is :",sn[2]),clearTimeout(this.handshakeTimeoutId),this.aic_agent_handshake_done=1,this.connectedToapplication=!0,this.send_application_status("APP_CONNECTION_OK"),apiRTC.session.remoteAccessInvitation!=null&&apiRTC.session.remoteAccessInvitation.fireEvent("application_connection_ok"))}},{key:"ws_onclose",value:function(kt){var jt=this;Lr.debug("ws_onclose : Closed - event :",kt),this.connectedToapplication===!0?(apiRTC.session.remoteAccessInvitation!==null&&apiRTC.session.remoteAccessInvitation.stop(!0),this.connectedToapplication=!1):this.ws_reconnect()===2&&setTimeout(function(){jt.ws_reconnect()},3e3)}},{key:"ws_onerror",value:function(kt){Lr.debug("ws_onerror : "+kt)}},{key:"ws_connect",value:function(kt){var jt=this;Lr.debug("ws_connect : Connecting ");var sn="ws://"+this.ip+":"+kt+"/ws";Lr.debug("... on url :",sn),this.ws=new WebSocket(sn,"ws-server-aic"),this.ws.addEventListener("open",function(ln){jt.ws_onopen(ln)}),this.ws.addEventListener("message",function(ln){jt.ws_onmessage(ln)}),this.ws.addEventListener("close",function(ln){jt.ws_onclose(ln)}),this.ws.addEventListener("error",function(ln){jt.ws_onerror(ln)})}},{key:"ws_reconnect",value:function(){return this.aic_agent_running===0?0:this.port_index>=this.ports.length?(this.port_index=0,2):(this.ws_connect(this.ports[this.port_index]),this.port_index++,0)}},{key:"send_application_status",value:function(kt){if(Lr.debug("send_application_status"),apiRTC.session.remoteAccessInvitation!==null){var jt={event:et.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE,invitationId:apiRTC.session.remoteAccessInvitation.id,roomname:apiRTC.session.remoteAccessInvitation.conversation._getTechnicalName(),status:kt};apiRTC.session.remoteAccessInvitation.sendMessageToSender(et.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE,jt).then(function(){}).catch(function(sn){Lr.warn("Contact#send send_application_status message error:",sn)})}else Lr.warn("send_application_status but not linked to a remoteAccessInvitation")}},{key:"aic_agent_start",value:function(){Lr.debug("aic_agent_start"),"WebSocket"in window?(this.aic_agent_running=1,this.send_application_status("APP_CONNECTION_ONGOING"),apiRTC.session.remoteAccessInvitation!=null&&apiRTC.session.remoteAccessInvitation.fireEvent("application_connection_ongoing"),this.ws_reconnect(this.ip)):Lr.error("WebSocket NOT supported by your Browser!")}},{key:"aic_agent_stop",value:function(){Lr.debug("aic_agent_stop"),this.aic_agent_running=0,this.ws.close()}},{key:"aic_agent_exit",value:function(){this.aic_agent_send_message("aic_agent_exit()")}}],Yt&&Ip(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function _l($t){return _l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},_l($t)}function Rp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Eu($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Pl($t,Lt){return Pl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Pl($t,Lt)}function Ep($t,Lt){if(Lt&&(_l(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}($t)}function Rs($t){return Rs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Rs($t)}var xa=ft.Y.get("ReceivedInvitation"),wp=["stop","messageDelivered","messageNotDelivered","application_connection_ongoing","application_connection_ok"],kp=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&Pl(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Rs(jt);if(sn){var Nt=Rs(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return Ep(this,dt)});function Kt(dt,gt,Nt){var Vt,zt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Rp(this,Kt),xa.debug("Create ReceivedRemoteAccessInvitation"),(Vt=ln.call(this,dt,gt.invitationId)).type="remoteAccess",Vt.conversation=Nt,zt.cloudConvId&&(Vt.cloudConvId=zt.cloudConvId),zt.webconf===!0&&(Vt.webconf=!0),Vt.aicConsoleManager=null,Vt.screenSharingStreamId=null,Vt.screenSharingStream=null,Vt.apiRTCManager.onEvent("receiveData",function(Xt){xa.debug("ReceivedRemoteAccessInvitation receiveData "),Xt.detail.data.event!==void 0&&Xt.detail.data.event===et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER&&Xt.detail.data.invitationId.toString()===Vt.id.toString()?(xa.debug("Received stop for "+Vt.id,Xt.detail.data),Vt.stop(!1,Xt.detail.data.reason)):Xt.detail.data.event===et.g.CONTACT_REMOTEACCESS_APP_MESSAGE&&Xt.detail.data.invitationId.toString()===Vt.id.toString()&&(xa.debug("Received CONTACT_REMOTEACCESS_APP_MESSAGE for "+Vt.id,Xt.detail.data),Vt.aicConsoleManager!==null?Vt.aicConsoleManager.aic_agent_send_message(Xt.detail.data.message):xa.debug("aicConsoleManager is not initialized"))}),Vt.conversation.on("contactLeft",function(Xt){Xt.id===Vt.sender.id&&(xa.debug("Remote user has left, stopping remoteAccess"),Vt.stop(!1,{code:"AGENT_LEFT"}))}),Vt}return Lt=Kt,Yt=[{key:"accept",value:function(){var dt=this;return new Promise(function(gt,Nt){if(xa.debug("ReceivedRemoteAccessInvitation accept"),dt.getStatus()===et.g.INVITATION_STATUS_STANDBY){dt.setStatus(et.g.INVITATION_STATUS_ACCEPTED);var Vt={event:et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,invitationId:dt.id,roomname:dt.conversation._getTechnicalName(),answer:"accept"};dt.sendMessageToSender(et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,Vt).then(function(){gt(dt.id)}).catch(function(zt){Nt(zt)})}else Nt(Wt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot accept remote access, invitation state invalid",xa))})}},{key:"decline",value:function(){var dt=this;return new Promise(function(gt,Nt){if(xa.debug("ReceivedRemoteAccessInvitation decline"),dt.getStatus()===et.g.INVITATION_STATUS_STANDBY){dt.setStatus(et.g.INVITATION_STATUS_DECLINED);var Vt={event:et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,invitationId:dt.id,roomname:dt.conversation._getTechnicalName(),answer:"decline"};dt.sendMessageToSender(et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,Vt).then(function(){gt(dt.id)}).catch(function(zt){Nt(zt)}),dt.stop(!0,{code:"USER_DECLINE"})}else Nt(Wt.g.createError(et.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot decline remote access, invitation state invalid",xa))})}},{key:"sendMessageToSender",value:function(dt,gt){var Nt=this;return xa.debug("sendMessageToSender :",gt),new Promise(function(Vt,zt){Nt.apiRTCManager.sendData(Nt.sender.getId(),gt).then(function(){nn.get(Nt).emit("messageDelivered",{event:dt,contact:Nt.sender,messageData:gt}),Vt()}).catch(function(Xt){var Zt=Wt.g.createError(Xt,"Invitation not delivered",xa);nn.get(Nt).emit("messageNotDelivered",{error:Zt,contact:Nt.sender,event:dt,messageData:gt}),zt(Zt)})})}},{key:"fireEvent",value:function(dt,gt){nn.get(this).emit(dt,gt)}},{key:"startScreenSharingAndPublish",value:function(){var dt=this;return xa.debug("startScreenSharingAndPublish"),new Promise(function(gt,Nt){apiRTC.Stream.createDisplayMediaStream({video:{cursor:"always",displaySurface:"monitor"},surfaceSwitching:"exclude",selfBrowserSurface:"exclude",systemAudio:"exclude"}).then(function(Vt){Vt.screensharingRemoteAccessStream=!0;var zt={},Xt={};Xt.invitationId=dt.id,Xt.screenWidth=window.screen.width,Xt.screenHeight=window.screen.height,zt.context={remoteAccessCtx:Xt},dt.screenSharingStreamId=Vt.getId(),dt.screenSharingStream=Vt,xa.debug("setting screenSharingStreamId :",dt.screenSharingStreamId),dt.conversation.publish(Vt,zt).then(function(Zt){dt.aicConsoleManager=new Ru,dt.aicConsoleManager.aic_agent_start(),gt(Zt)}).catch(function(Zt){var on={code:"DISPLAY_MEDIA_PUBLISH_ERROR",error:Zt};dt.stop(!0,on),Nt(Zt)})}).catch(function(Vt){xa.error("error on createDisplayMediaStream :",Vt);var zt={code:"CREATE_DISPLAY_MEDIA_ERROR",error:Vt};dt.stop(!0,zt),Nt(Vt)})})}},{key:"downloadApplication",value:function(){return xa.debug("downloadApplication"),new Promise(function(dt,gt){fetch("https://dev.cdn.apizee.com/apiRTC/app/remoteAccess.exe").then(function(Nt){return Nt.blob()}).then(function(Nt){var Vt=window.URL.createObjectURL(Nt),zt=document.createElement("a");zt.href=Vt,zt.download="remoteAccess.exe",document.body.appendChild(zt),zt.click(),zt.remove(),dt()}).catch(function(Nt){xa.error("Something went wrong during remote access application loading.. toString :",Nt.toString()),gt(new Error("error on application fetch :"+Nt.toString()))})})}},{key:"stop",value:function(){var dt=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;xa.debug("stop with sendMessage :",dt),gt==null&&(gt={code:"USER_STOP"});var Nt=this.conversation.conversationPublishedStreams.get(this.screenSharingStreamId);if(Nt!=null&&(xa.debug("streamInfo :",Nt),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Nt.callId)),this.screenSharingStream!==null&&(this.screenSharingStream.release(),this.screenSharingStream=null),this.aicConsoleManager!==null&&(this.aicConsoleManager.aic_agent_exit(),this.aicConsoleManager.aic_agent_stop(),this.aicConsoleManager=null),apiRTC.session.remoteAccessInvitation=null,dt){var Vt={event:et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER,invitationId:this.id,roomname:this.conversation._getTechnicalName(),reason:gt};this.sendMessageToSender(et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER,Vt).then(function(){}).catch(function(zt){xa.warn("Contact#send stop message error:",zt)})}nn.get(this).emit("stop",gt)}}],kt=[{key:"getAvailableEvents",value:function(){return wp}}],Yt&&Eu(Lt.prototype,Yt),kt&&Eu(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(Rn),Op=s(8364),Go=s.n(Op);function Es($t){return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Es($t)}function Ap($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function wu($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}s(9601),s(5306);var Mp=ft.Y.get("UserData"),xp=On.get(),Io=function(){function $t(){var jt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(var sn in Ap(this,$t),jt)jt.hasOwnProperty(sn)&&(this[sn]=jt[sn])}var Lt,Yt,kt;return Lt=$t,kt=[{key:"equals",value:function(jt,sn){if(!(jt instanceof Object&&sn instanceof Object))return!1;for(var ln in jt)if(sn[ln]===void 0||Es(sn[ln])==="object"&&!this.equals(sn[ln],jt[ln])||sn[ln]!==jt[ln])return!1;for(var Kt in sn)if(jt[Kt]===void 0||Es(jt[Kt])==="object"&&!this.equals(jt[Kt],sn[Kt])||jt[Kt]!==sn[Kt])return!1;return!0}}],(Yt=[{key:"get",value:function(jt){return this.hasOwnProperty(jt)&&this[jt]!==void 0&&this[jt]!=="null"&&this[jt]!==null?this[jt]:null}},{key:"setToSession",value:function(){try{var jt={};for(var sn in this)this.hasOwnProperty(sn)&&typeof this[sn]!="function"&&(jt[sn]=this[sn]);xp.apiRTCSession.setUserData(jt)}catch{Mp.error("setUserData() - could not set userData")}}},{key:"setProp",value:function(jt,sn){return this[jt]=sn,this}},{key:"setProps",value:function(jt){for(var sn in jt)jt.hasOwnProperty(sn)&&(this[sn]=jt[sn]);return this}}])&&wu(Lt.prototype,Yt),kt&&wu(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Dl($t){return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Dl($t)}function _p($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function ku($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Nl($t,Lt){return Nl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Nl($t,Lt)}function Pp($t,Lt){if(Lt&&(Dl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ws($t)}function ws($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function ks($t){return ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},ks($t)}var Ao=ft.Y.get("SentInvitation"),Dp=["response","receive","statusChange"],Do=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&Nl(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=ks(jt);if(sn){var Nt=ks(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return Pp(this,dt)});function Kt(dt,gt){var Nt,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return _p(this,Kt),(Nt=ln.call(this)).conversation=gt,Ao.info("Create SentInvitation"),Nt.invitationType="sent",Nt.contact=dt,Nt.id=Wt.g.guid(),Nt.sendTime=Date.now(),Nt.expirationTime=null,Nt.expirationTimeout=null,Vt.hasOwnProperty("expirationTime")&&(Nt.expirationTime=Vt.expirationTime,Nt.expirationTimeout=setTimeout(function(){Nt.getStatus()===et.g.INVITATION_STATUS_STANDBY&&(Ao.info("Conversation invitation expired"),Nt.setStatus(et.g.INVITATION_STATUS_EXPIRED),nn.get(ws(Nt)).emit("response",Nt.getStatus()))},Vt.expirationTime)),Vt.hasOwnProperty("receiveNotifier")&&Vt.receiveNotifier.on("receive",function(){nn.get(ws(Nt)).emit("receive")}),Nt.apiRTCManager.onEvent("receiveData",function(zt){Ao.debug("SentInvitation receiveData "),zt.detail.data.event!==void 0&&(zt.detail.data.event!==et.g.INVITATION_ANSWER_IDENTIFIER&&zt.detail.data.event!==et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER||zt.detail.data.invitationId.toString()!==Nt.id.toString()||Nt.getStatus()!==et.g.INVITATION_STATUS_STANDBY||(Ao.debug("Received invitation answer for "+Nt.id,zt.detail.data),Nt.expirationTimeout!==null&&clearTimeout(Nt.expirationTimeout),zt.detail.data.answer==="accept"?Nt.setStatus(et.g.INVITATION_STATUS_ACCEPTED):Nt.setStatus(et.g.INVITATION_STATUS_DECLINED),nn.get(ws(Nt)).emit("response",Nt.getStatus())))}),Nt.apiRTCManager.onEvent("hangup",function(zt){Ao.debug("hangup");var Xt=zt.detail.callId.toString();Nt.getId()===Xt&&(Ao.debug("hangup for sentInvitation"),Nt.setStatus(et.g.INVITATION_STATUS_ENDED))}),Nt}return Lt=Kt,kt=[{key:"getAvailableEvents",value:function(){return Dp}}],(Yt=[{key:"getId",value:function(){return this.id}},{key:"onResponse",value:function(dt){this.on("response",dt)}},{key:"cancel",value:function(){Ao.info("cancel"),this.type==="sendFile"?(Ao.info("cancel sendfile"),this.apiRTCManager.webRTCClient.hangUp(this.id)):Ao.warn("cancel is not managed for invitation with type :",this.type)}},{key:"send",value:function(dt){var gt=this;return Ao.debug("SentInvitation#send"),new Promise(function(Nt,Vt){gt.apiRTCManager.sendData(gt.contact.getId(),dt).then(function(){return Nt()}).catch(function(zt){var Xt=Wt.g.createError(zt,"Invitation not delivered",Ao);return Vt(Xt)})})}}])&&ku(Lt.prototype,Yt),kt&&ku(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(sr);function Ll($t){return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Ll($t)}function Np($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Ou($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Ul($t,Lt){return Ul=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Ul($t,Lt)}function Lp($t,Lt){if(Lt&&(Ll(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Os($t)}function Os($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function As($t){return As=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},As($t)}var mo=ft.Y.get("SentRemoteAccessInvitation"),Up=["response","receive","remoteAccessStreamAdded","stop","application_connection_ongoing","application_connection_ok"],$p=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&Ul(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=As(jt);if(sn){var Nt=As(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return Lp(this,dt)});function Kt(dt,gt){var Nt,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Np(this,Kt),Nt=ln.call(this,dt,gt,Vt),mo.debug("Create sentRemoteAccessInvitation"),Nt.type="remoteAccess",Nt.screenSharingStreamId=null,Nt.screenSharingStream=null,Nt.aicConsoleManager=null,Nt.screenSharingStreamDOMElementId=null,Nt.apiRTCManager.onEvent("receiveData",function(zt){mo.debug("SentRemoteAccessInvitation receiveData "),zt.detail.data.event!==void 0&&(zt.detail.data.event===et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER&&zt.detail.data.invitationId.toString()===Nt.id.toString()?(mo.debug("SentRemoteAccessInvitation Received stop for "+Nt.id,zt.detail.data),Nt.stop(!1,zt.detail.data.reason)):zt.detail.data.event===et.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE&&zt.detail.data.invitationId.toString()===Nt.id.toString()&&(mo.debug("CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE : "+Nt.id,zt.detail.data.status),zt.detail.data.status==="APP_CONNECTION_ONGOING"?(nn.get(Os(Nt)).emit("application_connection_ongoing"),Nt.aicConsoleManager=new Ru,Nt.aicConsoleManager.controlActivated===!0&&Nt.aicConsoleManager.aic_control_stop().then(function(){nn.get(Os(Nt)).emit("controlStop")}).catch(function(Xt){mo.debug("aic_control_stop error:",Xt)})):zt.detail.data.status==="APP_CONNECTION_OK"&&nn.get(Os(Nt)).emit("application_connection_ok")))}),Nt.conversation.on("contactLeft",function(zt){zt.id===Nt.contact.id&&(mo.debug("Remote user has left, stopping remoteAccess"),Nt.stop(!1,{code:"USER_LEFT"}))}),Nt}return Lt=Kt,Yt=[{key:"setRemoteAccessStream",value:function(dt){mo.debug("setRemoteAccessStream"),this.screenSharingStream=dt,nn.get(this).emit("remoteAccessStreamAdded",this.screenSharingStream)}},{key:"setScreenSharingStreamDOMElementId",value:function(dt){var gt=this;this.screenSharingStreamDOMElementId=dt,this.aicConsoleManager!==null?this.aicConsoleManager.aic_control_start().then(function(){nn.get(gt).emit("controlStart")}).catch(function(Nt){mo.warn("aic_control_start error:",Nt)}):mo.debug("aicConsoleManager is not activated")}},{key:"toggleMouseAndKeyboardAccess",value:function(){var dt=this;return mo.debug("toggleMouseAndKeyboardAccess"),new Promise(function(gt,Nt){if(dt.aicConsoleManager!==null)dt.aicConsoleManager.controlActivated===!0?dt.aicConsoleManager.aic_control_stop().then(function(){nn.get(dt).emit("controlStop"),gt()}).catch(function(zt){Nt(zt)}):dt.aicConsoleManager.aic_control_start().then(function(){nn.get(dt).emit("controlStart"),gt()}).catch(function(zt){Nt(zt)});else{var Vt="aicConsoleManager is not activated";mo.debug(Vt),Nt(new Error(Vt))}})}},{key:"getMouseAndKeyboardAccessStatus",value:function(){return this.aicConsoleManager.controlActivated}},{key:"stop",value:function(){var dt=this,gt=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(mo.debug("stop"),Nt==null&&(Nt={code:"AGENT_STOP"}),this.aicConsoleManager!==null&&(this.aicConsoleManager.controlActivated===!0&&this.aicConsoleManager.aic_control_stop().then(function(){nn.get(dt).emit("controlStop")}).catch(function(zt){mo.warn("aic_control_stop error:",zt)}),this.aicConsoleManager=null),gt){var Vt={event:et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER,invitationId:this.id,roomname:this.conversation._getTechnicalName(),reason:Nt};this.send(Vt).then(function(){}).catch(function(zt){mo.warn("Contact#send stop message error:",zt)})}apiRTC.session.remoteAccessInvitation!==null&&(nn.get(this).emit("stop",Nt),apiRTC.session.remoteAccessInvitation=null)}}],kt=[{key:"getAvailableEvents",value:function(){return Up}}],Yt&&Ou(Lt.prototype,Yt),kt&&Ou(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(Do);function $l($t){return $l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},$l($t)}function Au($t,Lt){var Yt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Yt){if(Array.isArray($t)||(Yt=function(dt,gt){if(dt){if(typeof dt=="string")return Mu(dt,gt);var Nt=Object.prototype.toString.call(dt).slice(8,-1);return Nt==="Object"&&dt.constructor&&(Nt=dt.constructor.name),Nt==="Map"||Nt==="Set"?Array.from(dt):Nt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Nt)?Mu(dt,gt):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Yt&&($t=Yt);var kt=0,jt=function(){};return{s:jt,n:function(){return kt>=$t.length?{done:!0}:{done:!1,value:$t[kt++]}},e:function(dt){throw dt},f:jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Kt=!1;return{s:function(){Yt=Yt.call($t)},n:function(){var dt=Yt.next();return ln=dt.done,dt},e:function(dt){Kt=!0,sn=dt},f:function(){try{ln||Yt.return==null||Yt.return()}finally{if(Kt)throw sn}}}}function Mu($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function jp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function xu($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Fl($t,Lt){return Fl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Fl($t,Lt)}function Fp($t,Lt){if(Lt&&($l(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kr($t)}function Kr($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Ms($t){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Ms($t)}var er=ft.Y.get("Contact"),Vr=On.get(),es=new(Go()),Wl=Or.get(),Wp=["message","conversationInvitation","data","joinGroup","leaveGroup","whiteboardInvitation","fileSentSuccessfully","fileTransferInvitation","fileTransferProgress","dataChannelInvitation","incomingCall","newMediaAvailable","customEvent","fileTransferError","incomingScreenSharingCall","incomingScreenSharingCallInvitation"],Bl=new WeakMap,_u=new WeakMap,Vl=new Map,No=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&Fl(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Ms(jt);if(sn){var Nt=Ms(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return Fp(this,dt)});function Kt(dt){var gt,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return jp(this,Kt),gt=ln.call(this,er),er.debug("Create Contact with id "+dt),er.debug("Create Contact with userData :",Nt),_u.set(Kr(gt),dt.toString()),gt.groups=[],gt.previousMessages=[],gt.userData=new Io(Nt),gt.enterprise=null,gt.streams=new Map,gt.profile=null,gt.fileTransfers=[],gt.promises=[],Bl.set(Kr(gt),[]),Vr.onEvent("roomInvitation",function(Vt){if(Vt.detail.senderId!==null&&Vt.detail.senderId!==void 0&&Vt.detail.roomType==="whiteBoard"&&Vt.detail.senderId.toString()===gt.getId()){er.info("Received whiteboard invitation from "+gt.getUsername());var zt={};Vt.detail.cloudConvId&&(zt.cloudConvId=Vt.detail.cloudConvId),Vt.detail.webconf===!0&&(zt.webconf=!0),nn.get(Kr(gt)).emit("whiteboardInvitation",new vs(Kr(gt),Vt.detail.roomId,zt))}}).onEvent("receiveIMMessage",function(Vt){Vt.detail.senderId.toString()===gt.getId()&&(nn.get(Kr(gt)).emit("message",{content:Vt.detail.message,uuid:Vt.detail.UUCSeq,time:Vt.detail.time}),gt.addMessageToHistory(Vt.detail.message,Math.round(Vt.detail.time.getTime()/1e3),Vt.detail.UUCSeq,!0))}).onEvent("receiveData",function(Vt){if(Vt.detail.senderId.toString()===gt.getId()){er.debug("Received data e.detail.data : ",Vt.detail.data);var zt=Vt.detail.data,Xt=null,Zt=uo.get();if(zt.roomname!==void 0&&(Xt=Zt.isConference(zt.roomname)?Zt.getOrCreateConference(Zt.getNameFromTechnicalName(zt.roomname)):Zt.getOrCreateConversation(Zt.getNameFromTechnicalName(zt.roomname))),zt.apiRTCRequest===!0&&gt.manageApiRTCRequest(Vt.detail,Xt),zt.event!==void 0)switch(zt.event){case et.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER:case et.g.INVITATION_ANSWER_IDENTIFIER:break;case et.g.CONTACT_SEND_DATA_IDENTIFIER:er.trace("Received data from "+gt.getUsername(),zt.content),nn.get(Kr(gt)).emit("data",zt.content);break;case et.g.CONVERSATION_INVITATION_IDENTIFIER:if(Xt!==null){er.debug("Received conversation invitation from "+gt.getId());var on={};zt.hasOwnProperty("password")&&(on.password=zt.password),nn.get(Kr(gt)).emit("conversationInvitation",new Bt(Kr(gt),zt,Xt,on))}break;case et.g.CONTACT_SEND_FILEINFO_IDENTIFIER:er.debug("Received file info from "+gt.getUsername(),zt.fileInfo);var bn=zt.callId.toString();if(Wt.g._private.dataCallsFileInfo.set(bn,zt.fileInfo),Wt.g._private.dataCallsOnHold.has(bn)){var En=null;apiRTC.userAgentInstance.currentSession.invitationsMap.has(gt.getId()+"-sendfile-"+bn)?(En=apiRTC.userAgentInstance.currentSession.invitationsMap.get(gt.getId()+"-sendfile-"+bn),er.debug("invitation already exist :",En)):(En=new eo(Kr(gt),bn,zt.fileInfo),apiRTC.userAgentInstance.currentSession.invitationsMap.set(gt.getId()+"-sendfile-"+bn,En)),nn.get(Kr(gt)).emit("fileTransferInvitation",En)}break;case et.g.CONTACT_DATACHANNEL_INVITATION:er.debug("Received datachannel invitation from "+gt.getUsername()),Wt.g._private.dataChannelInvitations.set(zt.callId.toString(),!0),Wt.g._private.dataCallsOnHold.has(zt.callId.toString())&&nn.get(Kr(gt)).emit("dataChannelInvitation",new zo(Kr(gt),zt.callId.toString()));break;case et.g.CONTACT_NEW_MEDIA_IDENTIFIER:er.debug("New media available from "+gt.getUsername(),zt.fileinfo),nn.get(Kr(gt)).emit("newMediaAvailable",{media:zt.media});break;case et.g.CONTACT_EVENTCENTER_DATA_REQUEST:er.debug("New request for event center data from "+gt.getUsername());var Gn=apiRTC.eventCenter.getStoredData();if(Gn===void 0)return void er.error("Can't send event center stored data, it's undefined");er.debug("Sending requested event center data"),gt.sendCustomEvent(et.g.CONTACT_EVENTCENTER_DATA_ANSWER,{data:Gn});break;case et.g.CONTACT_EVENTCENTER_DATA_ANSWER:if(er.debug("New event center data from "+gt.getUsername()),zt.data===void 0)return void er.error("Can't handle remote event center data, it's undefined");apiRTC.eventCenter.handleDataAnswer(zt.data);break;case et.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_IDENTIFIER:er.debug("New getAudioFlowStatus from "+zt.requesterId+" on stream "+zt.streamId);var Kn=gt.getContact(zt.requesterId),cr=gt.getLocalStreamPublished();if(cr===null)return gt.sendToContactRemoteStreamError("No stream found on remote",Kn,zt);Kn.sendCustomEvent(et.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,audioFlowStatus:cr.getAudioFlowStatus()});break;case et.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_IDENTIFIER:er.debug("New getVideoFlowStatus from "+zt.requesterId+" on stream "+zt.streamId);var hr=gt.getContact(zt.requesterId),Ar=gt.getLocalStreamPublished();if(Ar===null)return gt.sendToContactRemoteStreamError("No stream found on remote",hr,zt);hr.sendCustomEvent(et.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,videoFlowStatus:Ar.getVideoFlowStatus()});break;case et.g.CONTACT_GET_SETTINGS_IDENTIFIER:er.debug("CONTACT_GET_SETTINGS_IDENTIFIER");var Xr,_i=gt.getContact(zt.requesterId);if((Xr=zt.mediaStreamId!==void 0?gt.getLocalStreamWithMediaStreamId(zt.mediaStreamId):gt.getLocalStreamWithCallId(zt.streamId))===null)return gt.sendToContactRemoteStreamError("No stream found on remote",_i,zt);Xr.getSettings().then(function(lo){_i.sendCustomEvent(et.g.CONTACT_GET_SETTINGS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,settings:lo})}).catch(function(lo){gt.sendToContactRemoteStreamError(lo.message,_i,zt)});break;case et.g.CONTACT_GET_CAPABILITIES_IDENTIFIER:er.debug("CONTACT_GET_CAPABILITIES_IDENTIFIER");var Vo,or=gt.getContact(zt.requesterId);if((Vo=zt.mediaStreamId!==void 0?gt.getLocalStreamWithMediaStreamId(zt.mediaStreamId):gt.getLocalStreamWithCallId(zt.streamId))===null)return gt.sendToContactRemoteStreamError("No stream found on remote",or,zt);Vo.getCapabilities().then(function(lo){or.sendCustomEvent(et.g.CONTACT_GET_CAPABILITIES_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,capabilities:lo})}).catch(function(lo){gt.sendToContactRemoteStreamError(lo.message,or,zt)});break;case et.g.CONTACT_GET_CONSTRAINTS_IDENTIFIER:er.debug("New getConstraints from "+zt.requesterId);var Zn=gt.getContact(zt.requesterId),Tr=gt.getLocalStreamPublished();if(Tr===null)return gt.sendToContactRemoteStreamError("No stream found on remote",Zn,zt);Tr.getConstraints().then(function(lo){Zn.sendCustomEvent(et.g.CONTACT_GET_CONSTRAINTS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,constraints:lo})}).catch(function(lo){gt.sendToContactRemoteStreamError(lo.message,Zn,zt)});break;case et.g.CONTACT_APPLY_CONSTRAINTS_IDENTIFIER:var kr;er.debug("CONTACT_APPLY_CONSTRAINTS_IDENTIFIER"),kr=zt.mediaStreamId!==void 0?gt.getLocalStreamWithMediaStreamId(zt.mediaStreamId):gt.getLocalStreamWithCallId(zt.streamId);var br=gt.getContact(zt.requesterId);if(kr===null)return gt.sendToContactRemoteStreamError("No stream found on remote",br,zt);kr.applyConstraints(zt.constraints).then(function(){br.sendCustomEvent(et.g.CONTACT_APPLY_CONSTRAINTS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout}),kr.emitConstraintsChanged(zt.constraints)}).catch(function(lo){gt.sendToContactRemoteStreamError(lo.message,br,zt)});break;case et.g.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER:var $a;er.debug("CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER from :"+zt.requesterId),($a=apiRTC.userAgentInstance.getStreamWithMediaStreamId(zt.mediaStreamId))!=="NOT_FOUND"&&$a.emitConstraintsChanged(zt.constraints);break;case et.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_RESULT_IDENTIFIER:er.debug("getRemoteAudioFlowStatus result :",zt);var to=gt.getRemoteStreamSubscribed(zt.callId,zt.streamId);to===null?er.error("Can't find the local stream to resolve the request.."):to.resolvePendingPromise(zt.timeout,zt.audioFlowStatus);break;case et.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_RESULT_IDENTIFIER:er.debug("getRemoteVideoFlowStatus result :",zt);var vo=gt.getRemoteStreamSubscribed(zt.callId,zt.streamId);vo===null?er.error("Can't find the local stream to resolve the request.."):vo.resolvePendingPromise(zt.timeout,zt.videoFlowStatus);break;case et.g.CONTACT_GET_SETTINGS_RESULT_IDENTIFIER:er.debug("remote getSettings result :",zt);var Oo=gt.getRemoteStreamSubscribed(zt.callId,zt.streamId);Oo===null?er.error("Can't find the local stream to resolve the request.."):Oo.resolvePendingPromise(zt.timeout,zt.settings);break;case et.g.CONTACT_GET_CAPABILITIES_RESULT_IDENTIFIER:er.debug("remote getCapabilities result :",zt);var Wr=gt.getRemoteStreamSubscribed(zt.callId,zt.streamId);Wr===null?er.error("Can't find the local stream to resolve the request.."):Wr.resolvePendingPromise(zt.timeout,zt.capabilities);break;case et.g.CONTACT_GET_CONSTRAINTS_RESULT_IDENTIFIER:er.debug("remote getConstraints result :",zt);var po=gt.getRemoteStreamSubscribed(zt.callId,zt.streamId);po===null?er.error("Can't find the local stream to resolve the request.."):po.resolvePendingPromise(zt.timeout,zt.constraints);break;case et.g.CONTACT_GET_REMOTE_ERROR:er.debug("remote stream request error:",zt);var So=gt.getRemoteStreamSubscribed(zt.callId,zt.streamId);So===null?er.error("Can't find the local stream to reject the request.."):So.rejectPendingPromise(zt.timeout,zt.message);break;case et.g.CONTACT_APPLY_CONSTRAINTS_RESULT_IDENTIFIER:er.debug("remote applyConstraints result :",zt);var ps=gt.getRemoteStreamSubscribed(zt.callId,zt.streamId);ps===null?er.error("Can't find the local stream to resolve the request.."):ps.resolvePendingPromise(zt.timeout,zt.constraints);break;default:var hs={event:zt.event,content:zt};Xt!==null&&(hs.conversation=Xt),nn.get(Kr(gt)).emit("customEvent",hs)}}}).onEvent("incomingCall",function(Vt){if(Vt.detail.callerId.toString()===gt.getId()){var zt=Vt.detail.callId.toString();if(Vt.detail.callType==="data")if(er.debug("Received file transfer invitation from "+gt.getUsername()),Wt.g._private.dataCallsFileInfo.has(zt)){var Xt=Wt.g._private.dataCallsFileInfo.get(zt),Zt=null;apiRTC.userAgentInstance.currentSession.invitationsMap.has(gt.getId()+"-sendfile-"+zt)?(Zt=apiRTC.userAgentInstance.currentSession.invitationsMap.get(gt.getId()+"-sendfile-"+zt),er.debug("invitation already exist :",Zt)):(Zt=new eo(Kr(gt),zt,Xt),apiRTC.userAgentInstance.currentSession.invitationsMap.set(gt.getId()+"-sendfile-"+zt,Zt)),nn.get(Kr(gt)).emit("fileTransferInvitation",Zt)}else Wt.g._private.dataChannelInvitations.has(zt)?nn.get(Kr(gt)).emit("dataChannelInvitation",new zo(Kr(gt),zt)):(er.info("File information has not been received yet, putting invitation on hold"),Wt.g._private.dataCallsOnHold.set(zt));else if(Vt.detail.callType==="screenSharing"||Vt.detail.callType==="screenSharingWithAudio")if(apiRTC.session.apiCCWebRTCClient.webRTCClient.userAcceptOnIncomingScreenSharingCall===!0){er.debug("Received screenSharingCallInvitation from "+gt.getUsername());var on=new Ir(Kr(gt),zt,Vt.detail.callType,{isRecorded:!!Vt.detail.hasOwnProperty("recordedCall")&&Vt.detail.recordedCall});nn.get(Kr(gt)).emit("incomingScreenSharingCallInvitation",on)}else{er.debug("Received screenSharingCall from "+gt.getUsername());var bn=Wl.getOrCreateCall(zt,Kr(gt),{started:!0,isRecorded:!!Vt.detail.hasOwnProperty("recordedCall")&&Vt.detail.recordedCall});nn.get(Kr(gt)).emit("incomingScreenSharingCall",bn)}else er.info("Received call invitation from "+gt.getUsername()),nn.get(Kr(gt)).emit("incomingCall",new Ir(Kr(gt),zt,Vt.detail.callType,{isRecorded:!!Vt.detail.hasOwnProperty("recordedCall")&&Vt.detail.recordedCall}))}}).onEvent("hangup",function(Vt){var zt=Vt.detail.callId.toString();gt.getId()===Vt.detail.remoteId.toString()&&(er.debug("hangup event :",Vt.detail),gt.fileTransfers.includes(zt)&&(er.info("File transfer finished from "+gt.getUsername()),gt.fileTransfers.splice(gt.fileTransfers.indexOf(zt),1)))}).onEvent("sendDataChannelError",function(Vt){var zt=Vt.detail.callId.toString();gt.getId()===Vt.detail.remoteId.toString()&&gt.fileTransfers.includes(zt)&&(er.info("File transfer error from "+gt.getUsername()),nn.get(Kr(gt)).emit("fileTransferError",{error:"sendDataChannelError",invitationId:zt}))}).onEvent("fetchUserDataAnswer",function(Vt){gt.getId()===Vt.detail.id.toString()&&(gt.userData=new Io(Vt.detail.userData),gt.promises.forEach(function(zt){Vt.detail.timeout===zt.timeout&&(clearTimeout(zt.timeout),zt.resolve(Vt.detail.userData))}))}),gt}return Lt=Kt,Yt=[{key:"getId",value:function(){return _u.get(this)}},{key:"id",get:function(){return er.warn("contact.id is deprecated, please use contact.getId() instead"),this.getId()}},{key:"fetchProfileInformation",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Promise(function(Vt,zt){gt.profile===null||Nt?es.getUserProfile(Vr.getActiveApiKey(),gt.getId(),dt).then(function(Xt){gt.profile=Xt,Vt(Xt)}).catch(zt):Vt(gt.profile)})}},{key:"getActiveStreams",value:function(){return this.streams.values()}},{key:"getLocalStreamWithCallId",value:function(dt){for(var gt=null,Nt=so.getLocalStreams(),Vt=Nt.next();!Vt.done;){for(var zt=Vt.value,Xt=zt.publishedInConversations.values(),Zt=Xt.next();!Zt.done;)Zt.value===dt&&(er.debug("Finding Stream in a conversation"),gt=zt),Zt=Xt.next();zt.callId===dt&&(er.debug("Finding Stream in a call"),gt=zt),Vt=Nt.next()}return gt}},{key:"getLocalStreamPublished",value:function(){var dt=so.getLocalStreams().next();return dt.value===void 0?null:dt.value}},{key:"getLocalStreamWithMediaStreamId",value:function(dt){for(var gt=null,Nt=so.getLocalStreams(),Vt=Nt.next();!Vt.done;){var zt=Vt.value;if(zt.data.id===dt)return zt;Vt=Nt.next()}return gt}},{key:"getRemoteStreamSubscribed",value:function(dt,gt){var Nt=Br.getActiveSession().getCall(dt);if(Nt){er.debug("remote stream is associated to a call");var Vt,zt=Au(Nt.getReceivedStreams());try{for(zt.s();!(Vt=zt.n()).done;){var Xt=Vt.value;if(Xt.getId()===gt)return Xt}}catch(cr){zt.e(cr)}finally{zt.f()}}else{var Zt=Br.getActiveSession().getActiveConversations(),on=Br.getActiveSession().getActiveConferences();for(var bn in Zt){var En=Zt[bn].getSubscribedStream(gt);if(En!==void 0)return er.debug("remote stream is associated to a conversation"),En}for(var Gn in on){var Kn=on[Gn].getSubscribedStream(gt);if(Kn!==void 0)return er.debug("remote stream is associated to a conference"),Kn}}return null}},{key:"addMessageToHistory",value:function(dt,gt,Nt,Vt){Bl.get(this).indexOf(Nt.toString())===-1&&(this.previousMessages.push({content:dt,timestamp:gt,uuid:Nt,fromContact:Vt}),Bl.get(this).push(Nt.toString()))}},{key:"getPreviousMessages",value:function(){return this.previousMessages.sort(function(dt,gt){return new Date(gt.timestamp)-new Date(dt.timestamp)}),this.previousMessages}},{key:"getUserData",value:function(){return this.userData}},{key:"getRemoteAccessSupport",value:function(){var dt=!1;return this.userData.remoteAccessUserSupport==="ON"&&(dt=!0),dt}},{key:"fetchUserData",value:function(){var dt=this;return new Promise(function(gt,Nt){var Vt=setTimeout(function(){Nt("Timeout error during fetchUserData() process")},5e3);dt.promises.push({timeout:Vt,resolve:gt}),apiRTC.session.fetchUserData({apiKey:Vr.getActiveApiKey(),id:dt.getId(),timeout:Vt})})}},{key:"getUsername",value:function(){return this.userData.get("username")!==null?this.userData.get("username"):this.userData.get("nickname")!==null?this.userData.get("nickname"):this.getId()}},{key:"getPhotoUrl",value:function(){return this.userData.get("photo_url")!==null?this.userData.get("photo_url"):this.userData.get("photoUrl")!==null?this.userData.get("photoUrl"):null}},{key:"fetchWebSessionInformation",value:function(dt){var gt=this;return new Promise(function(Nt,Vt){dt instanceof Br?Vl.has(gt.getId()+":"+dt.getId())?Nt(Vl.get(gt.getId()+":"+dt.getId())):es.getWebSession(dt,gt,Vr.getActiveApiKey()).then(function(zt){Vl.set(gt.getId()+":"+dt.getId(),zt),Nt(zt)}).catch(function(zt){Vt(Wt.g.createError(et.g.ERROR_OTHER,"fetchWebSessionInformation() - could not fetch web session information",er))}):Vt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"fetchWebSessionInformation() - parameter is not an instance of apiRTC.Session",er))})}},{key:"loadMessageHistory",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){gt.fetchWebSessionInformation(dt).then(function(Xt){return es.getSessionHistory(Xt.webSessionId,dt.getToken(),Nt)}).then(function(Xt){er.debug("loadMessageHistory() - got messages",Xt.messages);var Zt,on=Au(Xt.messages);try{for(on.s();!(Zt=on.n()).done;){var bn=Zt.value;gt.addMessageToHistory(bn.value,bn.timestamp,bn.uuid,bn.destId.toString()!==gt.getId())}}catch(En){on.e(En)}finally{on.f()}Vt()}).catch(function(Xt){zt(Wt.g.createError(et.g.ERROR_OTHER,"loadMessageHistory() - could not load session history",er))})})}},{key:"addToGroup",value:function(dt){this.inGroup(dt)||(this.groups.push(dt),nn.get(this).emit("joinGroup",dt))}},{key:"removeFromGroup",value:function(dt){this.inGroup(dt)&&(this.groups.splice(this.groups.indexOf(dt),1),nn.get(this).emit("leaveGroup",dt))}},{key:"inGroup",value:function(dt){return this.groups.includes(dt)}},{key:"isOnline",value:function(){return this.groups.length!==0}},{key:"sendData",value:function(dt){var gt=this;return this.isOnline()||er.warn("sendData() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Nt,Vt){Vr.sendData(gt.getId(),{event:et.g.CONTACT_SEND_DATA_IDENTIFIER,content:dt}).then(Nt).catch(function(zt){switch(zt){case et.g.ERROR_TIMED_OUT:Vt(Wt.g.createError(et.g.ERROR_TIMED_OUT,"sendData() - Data transmission timed out ",er));break;case et.g.ERROR_NOT_FOUND:Vt(Wt.g.createError(et.g.ERROR_NOT_FOUND,"sendData() - Contact was not found ",er));break;default:Vt(Wt.g.createError(et.g.ERROR_OTHER,"sendData() - Data default error ",er))}})})}},{key:"sendCustomEvent",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isOnline()||er.warn("sendCustomEvent() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Vt,zt){var Xt=Nt;Xt.event=dt,Vr.sendData(gt.getId(),Xt).then(Vt).catch(function(Zt){switch(Zt){case et.g.ERROR_TIMED_OUT:zt(Wt.g.createError(et.g.ERROR_TIMED_OUT,"sendCustomEvent() - Data transmission timed out ",er));break;case et.g.ERROR_NOT_FOUND:zt(Wt.g.createError(et.g.ERROR_NOT_FOUND,"sendCustomEvent() - Contact was not found ",er));break;default:zt(Wt.g.createError(et.g.ERROR_OTHER,"sendCustomEvent() - Data transmission timed out ",er))}})})}},{key:"sendRequest",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isOnline()||er.warn("sendRequest() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Vt,zt){var Xt=(Math.random()*new Date().getTime()).toString(36).replace(/\./g,"-");Vr.onceEvent("receiveData",function(on){er.debug("Received data e.detail.data : ",on.detail.data),on.detail.data.apiRTCAnswer===!0&&(on.detail.data.requestUUID===Xt?Vt():er.error("uuid is not correct"))});var Zt=Nt;Zt.apiRTCRequest=!0,Zt.requestType=dt,Zt.uuid=Xt,Vr.sendData(gt.getId(),Zt).then(function(){er.debug("sendData ok")}).catch(function(on){er.error("Error on sendData",on),zt()})})}},{key:"sendAnswer",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isOnline()||er.warn("sendRequest() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Vt,zt){var Xt=Nt;Xt.apiRTCAnswer=!0,Xt.answerType=dt,Vr.sendData(gt.getId(),Xt).then(function(){Vt()}).catch(function(Zt){er.error("Error on sendData",Zt),zt()})})}},{key:"sendDataAnswer",value:function(dt,gt,Nt){this.getContact(dt.senderId).sendAnswer(gt,Nt).then(function(){er.debug("sendAnswer OK")}).catch(function(Vt){er.error("Error on sendAnswer",Vt)})}},{key:"manageApiRTCStreamRequest",value:function(dt,gt){var Nt=this;er.debug("manageApiRTCStreamRequest : ",dt);var Vt=dt.data.requestType,zt={};zt.requestUUID=dt.data.uuid,zt.result="NOK";var Xt=null;if((Xt=apiRTC.userAgentInstance.getStreamWithRoomNameAndCallId(gt.getName(),dt.data.streamId))==="NOT_FOUND")zt.reason="STREAM_NOT_FOUND",this.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,zt);else if(Vt!==void 0)switch(Vt){case et.g.CONTACT_DISABLE_AUDIO_REQUEST:Xt.disableAudio().then(function(){zt.result="OK",Nt.sendDataAnswer(dt,et.g.CONTACT_DISABLE_AUDIO_ANSWER,zt)}).catch(function(){zt.reason="ERROR_ON_DISABLE_AUDIO",Nt.sendDataAnswer(dt,et.g.CONTACT_DISABLE_AUDIO_ANSWER,zt)});break;case et.g.CONTACT_ENABLE_AUDIO_REQUEST:Xt.enableAudio().then(function(){zt.result="OK",Nt.sendDataAnswer(dt,et.g.CONTACT_ENABLE_AUDIO_ANSWER,zt)}).catch(function(){zt.reason="ERROR_ON_ENABLE_AUDIO",Nt.sendDataAnswer(dt,et.g.CONTACT_ENABLE_AUDIO_ANSWER,zt)});break;case et.g.CONTACT_DISABLE_VIDEO_REQUEST:Xt.disableVideo().then(function(){zt.result="OK",Nt.sendDataAnswer(dt,et.g.CONTACT_DISABLE_VIDEO_ANSWER,zt)}).catch(function(){zt.reason="ERROR_ON_DISABLE_VIDEO",Nt.sendDataAnswer(dt,et.g.CONTACT_DISABLE_VIDEO_ANSWER,zt)});break;case et.g.CONTACT_ENABLE_VIDEO_REQUEST:Xt.enableVideo().then(function(){zt.result="OK",Nt.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,zt)}).catch(function(){zt.reason="ERROR_ON_ENABLE_VIDEO",Nt.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,zt)});break;default:er.error("not a defined apiRTC request :",Vt),zt.reason="ERROR_ON_REQUESTTYPE",this.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,zt)}else er.error("requestType is undefined :",Vt),zt.reason="ERROR_ON_REQUESTTYPE",this.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,zt)}},{key:"manageApiRTCRequest",value:function(dt,gt){er.debug("manageApiRTCRequest : ",dt);var Nt=dt.data.requestType,Vt={};if(Vt.requestUUID=dt.data.uuid,Vt.result="NOK",Nt!==void 0)switch(Nt){case et.g.CONTACT_DISABLE_AUDIO_REQUEST:case et.g.CONTACT_ENABLE_AUDIO_REQUEST:case et.g.CONTACT_DISABLE_VIDEO_REQUEST:case et.g.CONTACT_ENABLE_VIDEO_REQUEST:this.manageApiRTCStreamRequest(dt,gt);break;default:er.error("not a defined apiRTC request :",Nt),Vt.reason="ERROR_ON_REQUESTTYPE",this.sendDataAnswer(dt,et.g.CONTACT_ENABLE_VIDEO_ANSWER,Vt)}}},{key:"sendMessage",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.isOnline()||er.warn("sendMessage() - contact "+this.getUsername()+" does not seem to be connected.");var Vt=null,zt=function(){return new Promise(function(Xt,Zt){Nt.hasOwnProperty("session")?gt.fetchWebSessionInformation(Nt.session).then(function(on){Xt({save:!0,cloudSessionId:on.webSessionId,apiRTCId:Nt.session.getId()})}).catch(Zt):Xt({})})};return new Promise(function(Xt,Zt){return typeof dt!="string"?Zt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"sendMessage() - message parameter is not instance of string",er)):dt===""?Zt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"sendMessage() - message parameter is empty",er)):void zt().then(function(on){Vt=on,er.info("sendMessage() - with options :",Vt),Vr.sendMessage(gt.getId(),dt,Vt).then(function(bn){gt.addMessageToHistory(dt,Math.floor(Date.now()/1e3),bn,!1),Xt(bn)}).catch(function(bn){switch(bn){case et.g.ERROR_TIMED_OUT:Zt(Wt.g.createError(et.g.ERROR_TIMED_OUT,"sendMessage() - Data transmission timed out ",er));break;case et.g.ERROR_NOT_FOUND:Zt(Wt.g.createError(et.g.ERROR_NOT_FOUND,"sendMessage() - Contact was not found ",er));break;default:Zt(Wt.g.createError(et.g.ERROR_OTHER,"sendMessage() - Data transmission timed out ",er))}})},function(on){Zt(Wt.g.createError(et.g.ERROR_OTHER,"sendMessage() - Error occured when fetching options for sending message",er))})})}},{key:"inviteTo",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.sendConversationInvitation(dt,gt)}},{key:"sendConversationInvitation",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return dt instanceof jo?dt.sendInvitation(this,gt):(er.error("sendConversationInvitation() - Parameter is not a conversation"),null)}},{key:"sendWhiteboardInvitation",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Vr.whiteBoardClient.roomId!==dt&&(Vr.whiteBoardClient.leaveRoom(),Vr.whiteBoardClient.start(),Vr.whiteBoardClient.joinRoom(dt));var Nt=gt.context?gt.context:null,Vt={};gt.cloudConversationId&&(Vt.convId=gt.cloudConversationId),Vr.whiteBoardClient.inviteInRoom(dt,this.getId(),Nt,Vt);var zt=new Do(this,null);return zt.id="wb-"+dt,zt.type="whiteboard",zt}},{key:"call",value:function(dt){var gt,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{mediaTypeForOutgoingCall:"VIDEO",record:!1};this.isOnline()||er.warn("call() - contact "+this.getUsername()+" does not seem to be connected.");var Vt={},zt=Wt.g.assignObject({},Nt),Xt=!!Nt.hasOwnProperty("audioOnly")&&Nt.audioOnly;Nt.hasOwnProperty("record")&&(zt.record!==void 0&&zt.record!==null||(zt.record=Nt.record)),dt!==null&&dt instanceof so&&(zt.userMediaStreamId=dt.userMediaStreamId,dt.isScreensharing()&&(zt.forceCallType="screenSharing")),zt.cloudConversationId&&(Vt.cloudConvId=zt.cloudConversationId,delete zt.cloudConversationId),gt=Xt?Vr.webRTCClient.callAudio(this.getId(),Vt,zt):Vr.webRTCClient.call(this.getId(),Vt,zt);var Zt=Wl.getOrCreateCall(gt,this,{isRecorded:zt.record});return Zt}},{key:"shareScreen",value:function(){var dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.isOnline()||er.warn("call() - contact "+this.getUsername()+" does not seem to be connected.");var gt={},Nt=null,Vt=dt,zt=dt.captureSourceType;er.warn("call() - contact "+this.getUsername()+" does not seem to be connected."),Nt=Vr.webRTCClient.shareScreen(this.getId(),gt,zt);var Xt=Wl.getOrCreateCall(Nt,this,{isRecorded:Vt.record});return Xt}},{key:"startDataChannel",value:function(){if(this.isOnline()||er.warn("startDataChannel() - contact "+this.getUsername()+" does not seem to be connected."),!(pt.Xh==="Edge"&&pt.PR<79&&apiRTC.browserDetails.type!=="chrome")){var dt=Vr.webRTCClient.startDataChannel(this.getId());return Vr.sendData(this.getId(),{callId:dt,event:et.g.CONTACT_DATACHANNEL_INVITATION}),new ys(dt,this,{type:et.g.DATACHANNEL_TYPE_SEND})}er.warn("Cannot startDataChannel as it is not supported on Edge")}},{key:"sendFile",value:function(dt,gt){if(this.isOnline()||er.warn("sendFile() - contact "+this.getUsername()+" does not seem to be connected."),pt.Xh==="Edge"&&pt.PR<79&&apiRTC.browserDetails.type!=="chrome")return er.warn("Cannot sendFile as Datachannel is not supported on Edge"),null;var Nt=Vr.webRTCClient.startDataChannel(this.getId()),Vt=this;if(Nt===void 0)return er.warn("Error on startDataChannel"),null;Vr.sendData(this.getId(),{fileInfo:dt,callId:Nt,event:et.g.CONTACT_SEND_FILEINFO_IDENTIFIER}),Vr.onEvent("sendDataChannelOpen",function Xt(Zt){er.debug("sendFile() - DataChannel open",Zt.detail),Zt.detail.callId.toString()===Nt.toString()&&(Vr.webRTCClient.sendDataWithCallId(Nt,{file:gt,name:dt.name,type:dt.type},function(on){er.trace("sendFile() - progress : ",on);var bn={uuid:on.uuid,fileSize:on.fileSize,remainingSize:on.remainingSize,percentage:on.percentage,sendChunkNb:on.sendChunkNb,transferDuration:on.transferDuration,lastPacket:on.lastPacket};nn.get(Vt).emit("fileTransferProgress",{fileInfo:dt,transferInformation:bn}),on.transferEnded&&nn.get(Vt).emit("fileSentSuccessfully",{fileInfo:dt,transferInformation:bn})}),Vr.removeEventListener("sendDataChannelOpen",Xt))}),this.fileTransfers.push(Nt.toString());var zt=new Do(this,null);return zt.id=Nt.toString(),zt.type="sendFile",zt.on("response",function(){zt.getStatus()!==et.g.INVITATION_STATUS_ACCEPTED&&er.log("sendFile() - invitation has not been accepted, cleaning listeners")}),zt}},{key:"pushMedia",value:function(dt,gt){var Nt=this,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(zt,Xt){Nt.fetchWebSessionInformation(gt).then(function(Zt){return Vt.token=gt.token,es.pushConversationMedia(Zt.conversationId,dt,Vr.getActiveApiKey(),Vt)}).then(function(Zt){Vr.sendData(Nt.getId(),{event:et.g.CONTACT_NEW_MEDIA_IDENTIFIER,media:{url:Zt.url,id:Zt.id}}),zt({url:Zt.url,id:Zt.id})}).catch(function(Zt){Xt(Wt.g.createError(et.g.ERROR_OTHER,"pushMedia() - failed to push media",er))})})}},{key:"fetchMediaList",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return er.debug("fetchMediaList()"),new Promise(function(Vt,zt){gt.fetchWebSessionInformation(dt).then(function(Xt){return Nt.token=dt.getToken(),es.getConversationMediaList(Xt.conversationId,Vr.getActiveApiKey(),Nt)}).then(Vt).catch(function(Xt){zt(Wt.g.createError(et.g.ERROR_OTHER,"getMediaList() - failed to get media list",er))})})}},{key:"sendEventCenterDataRequest",value:function(){return this.sendCustomEvent(et.g.CONTACT_EVENTCENTER_DATA_REQUEST)}},{key:"getContact",value:function(dt){return Br.getActiveSession().getOrCreateContact(dt)}},{key:"sendToContactRemoteStreamError",value:function(dt,gt,Nt){er.debug("sendToContactRemoteStreamError",dt,gt,Nt),gt.sendCustomEvent(et.g.CONTACT_GET_REMOTE_ERROR,{callId:Nt.callId,streamId:Nt.streamId,timeout:Nt.timeout,message:dt})}},{key:"sendRemoteAccessInvitation",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){if(gt.isOnline()||er.warn("sendRemoteAccessInvitation() - contact "+gt.getUsername()+" does not seem to be connected."),apiRTC.session.remoteAccessInvitation!==null)return er.warn("sendRemoteAccessInvitation() already ongoing"),zt(new Error("sendRemoteAccessInvitation() already ongoing"));var Xt=new $p(gt,dt,Nt);apiRTC.session.remoteAccessInvitation=Xt,Xt.type=et.g.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER;var Zt={event:et.g.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER,invitationId:Xt.id,roomname:Xt.conversation._getTechnicalName(),sendTime:Xt.sendTime};Xt.send(Zt).then(function(){Vt(Xt)}).catch(function(on){return er.error("Contact#sendRemoteAccessInvitation send error:",on),zt(new Error(on))})})}}],kt=[{key:"getAvailableEvents",value:function(){return Wp}}],Yt&&xu(Lt.prototype,Yt),kt&&xu(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(fn);function zl($t){return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},zl($t)}function Bp($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Hl($t,Lt){return Hl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Hl($t,Lt)}function Vp($t,Lt){if(Lt&&(zl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}($t)}function xs($t){return xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},xs($t)}var ho=ft.Y.get("ConversationCall"),Fr=On.get(),Gl=function($t){(function(Kt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Kt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Kt,writable:!0,configurable:!0}}),Object.defineProperty(Kt,"prototype",{writable:!1}),dt&&Hl(Kt,dt)})(ln,$t);var Lt,Yt,kt,jt,sn=(kt=ln,jt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Kt,dt=xs(kt);if(jt){var gt=xs(this).constructor;Kt=Reflect.construct(dt,arguments,gt)}else Kt=dt.apply(this,arguments);return Vp(this,Kt)});function ln(Kt,dt,gt){var Nt;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,ln),(Nt=sn.call(this,ho)).conversation=Kt,Nt.callId=dt,Nt.stream=gt,Nt}return Lt=ln,Yt=[{key:"getConversation",value:function(){return this.conversation}},{key:"getCallId",value:function(){return this.callId}},{key:"getStream",value:function(){return this.stream}},{key:"isRecorded",value:function(){return!!this.recordingStatus}},{key:"getRecordingInfo",value:function(){return this.isRecorded()?this.recordingStatus:null}},{key:"isStreamed",value:function(){return!!this.streamingStatus}},{key:"getStreamingInfo",value:function(){return this.isStreamed()?this.streamingStatus:null}},{key:"startRecordingPublishedStream",value:function(Kt){var dt=this;return Kt||(Kt={}),new Promise(function(gt,Nt){if(dt.asyncCallbacks)return Nt(Wt.g.createError(et.g.ERROR_OTHER,"startRecordingPublishedStream() - busy",ho));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(Fr.removeEventListener("error",dt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),delete dt.asyncCallbacks),Nt(Wt.g.createError(et.g.ERROR_OTHER,"startRecordingPublishedStream() - timeout",ho))},et.g.CONVERSATION_RECORDING_STARTED_DELAY),dt.asyncCallbacks.error=function(Zt){if(String(Zt.detail.convId)===dt.conversation.getCloudConversationId()&&Zt.detail.callId===dt.callId&&Zt.detail.errorCode.indexOf("START_RECORD")>=0)return dt.asyncCallbacks&&(Fr.removeEventListener("error",dt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Nt(Wt.g.createError(et.g.ERROR_OTHER,"startRecordingPublishedStream() - "+Zt.detail.errorInfo,ho))},dt.asyncCallbacks.recordingStarted=function(Zt){if(String(Zt.detail.convId)===dt.conversation.getCloudConversationId()&&Zt.detail.callId===dt.callId){dt.asyncCallbacks&&(Fr.removeEventListener("error",dt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var on=Wt.g.parseRecordingEvent("MCURecordingStarted",Zt.detail);return gt(on)}},Fr.onEvent("error",dt.asyncCallbacks.error),Fr.onEvent("MCURecordingStarted",dt.asyncCallbacks.recordingStarted);var Vt="AUDIO-VIDEO";Kt.audioOnly===!0?Vt="AUDIO-ONLY":Kt.videoOnly===!0&&(Vt="VIDEO-ONLY");var zt="userStream";Wt.g.isPropertyTypeof(Kt,"customIdInFilename","string")&&(zt=Kt.customIdInFilename);var Xt={};Wt.g.isPropertyTypeof(Kt,"data","object")&&(Xt=Object.assign({},Kt.data)),Wt.g.isPropertyTypeof(Kt,"ttl","number")&&Kt.ttl>0&&(Xt.ttl=Kt.ttl),Fr.webRTCClient.startRecording(Vt,zt,dt.conversation.getCloudConversationId(),dt.callId,Xt)})}},{key:"stopRecordingPublishedStream",value:function(){var Kt=this;return new Promise(function(dt,gt){if(Kt.asyncCallbacks)return gt(Wt.g.createError(et.g.ERROR_OTHER,"stopRecordingPublishedStream() - busy",ho));Kt.asyncCallbacks={},Kt.asyncCallbacks.timeoutId=setTimeout(function(){return Kt.asyncCallbacks&&(Fr.removeEventListener("error",Kt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStopped",Kt.asyncCallbacks.recordingStopped),delete Kt.asyncCallbacks),dt(Kt.recordingStatus)},et.g.CONVERSATION_RECORDING_STOPPED_DELAY),Kt.asyncCallbacks.error=function(Nt){if(String(Nt.detail.convId)===Kt.conversation.getCloudConversationId()&&Nt.detail.callId===Kt.callId&&Nt.detail.errorCode.indexOf("STOP_RECORD")>=0)return Kt.asyncCallbacks&&(Fr.removeEventListener("error",Kt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStopped",Kt.asyncCallbacks.recordingStopped),clearTimeout(Kt.asyncCallbacks.timeoutId),delete Kt.asyncCallbacks),gt(Wt.g.createError(et.g.ERROR_OTHER,"stopRecordingPublishedStream() - "+Nt.detail.errorInfo,ho))},Kt.asyncCallbacks.recordingStopped=function(Nt){if(String(Nt.detail.convId)===Kt.conversation.getCloudConversationId()&&Nt.detail.callId===Kt.callId){Kt.asyncCallbacks&&(Fr.removeEventListener("error",Kt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStopped",Kt.asyncCallbacks.recordingStopped),clearTimeout(Kt.asyncCallbacks.timeoutId),delete Kt.asyncCallbacks);var Vt=Wt.g.parseRecordingEvent("MCURecordingStopped",Nt.detail);return dt(Vt)}},Fr.onEvent("error",Kt.asyncCallbacks.error),Fr.onEvent("MCURecordingStopped",Kt.asyncCallbacks.recordingStopped),Fr.webRTCClient.stopRecording(Kt.callId)})}},{key:"replacePublishedStream",value:function(Kt,dt){var gt=this;return new Promise(function(Nt,Vt){if(Kt===null){if(!Wt.g.isPropertyTypeof(dt,"getStream","function"))return Vt(new Error("replacePublishedStream() - Cannot replace stream, wrong arguments"));gt.stream.publishedInConversations.delete(gt.conversation.getName()),gt.conversation.conversationPublishedStreams.delete(gt.stream.userMediaStreamId);var zt={getUserMediaStreamId:function(){return dt.getStream().then(function(Zt){gt.stream=Zt,Zt.publishedInConversations.set(gt.conversation.getName(),gt.callId),gt.conversation.callIdToStreamId.set(gt.callId,Zt.userMediaStreamId);var on={contact:null,isRemote:!1,hasAudio:Zt.hasAudio(),hasVideo:Zt.hasVideo(),isScreensharing:Zt.isScreensharing(),streamId:Zt.userMediaStreamId,callId:gt.callId};return gt.conversation.conversationPublishedStreams.set(Zt.userMediaStreamId,on),Zt.userMediaStreamId}).catch(Vt)}};Fr.webRTCClient.webRTCClient.addMedia(gt.callId,!0,null,zt).then(function(Zt){return Nt(function(on){if(yo.has(on))return yo.get(on);var bn=apiCC.getUserMediaStream(on);if(bn){var En="audio";return bn.video===!0&&(En="video"),new so(bn.stream,{type:En,constructor:!0,userMediaStreamId:bn.userMediaStreamId})}return null}(Zt))}).catch(function(Zt){return Vt(new Error("replacePublishedStream() - "+Zt))})}else{gt.stream.publishedInConversations.delete(gt.conversation.getName()),gt.conversation.conversationPublishedStreams.delete(gt.stream.userMediaStreamId),Fr.webRTCClient.webRTCClient.addMedia(gt.callId,!0,Kt.userMediaStreamId).then(function(Zt){return Nt(Kt)}).catch(function(Zt){return Vt(new Error("replacePublishedStream() - "+Zt))}),gt.stream=Kt,Kt.publishedInConversations.set(gt.conversation.getName(),gt.callId),gt.conversation.callIdToStreamId.set(gt.callId,Kt.userMediaStreamId);var Xt={contact:null,isRemote:!1,hasAudio:Kt.hasAudio(),hasVideo:Kt.hasVideo(),isScreensharing:Kt.isScreensharing(),streamId:Kt.userMediaStreamId,callId:gt.callId};gt.conversation.conversationPublishedStreams.set(Kt.userMediaStreamId,Xt)}})}},{key:"startStreaming",value:function(){var Kt=this,dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(gt,Nt){return Kt.asyncCallbacks?Nt(Wt.g.createError(et.g.ERROR_OTHER,"startStreaming() - busy",ho)):Fr.webRTCClient.startStreaming(dt.service,dt.server,dt.streamKey,Kt.callId)?(Kt.asyncCallbacks={},Kt.asyncCallbacks.timeoutId=setTimeout(function(){return Kt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStarted",Kt.asyncCallbacks.streamingStarted),delete Kt.asyncCallbacks),Nt(Wt.g.createError(et.g.ERROR_OTHER,"startStreaming() - timeout",ho))},et.g.CONVERSATION_STREAMING_STARTED_DELAY),Kt.asyncCallbacks.streamingStarted=function(Vt){if(Vt.detail.roomName===Kt.conversation._getTechnicalName()&&Vt.detail.callId===Kt.callId){Kt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStarted",Kt.asyncCallbacks.streamingStarted),clearTimeout(Kt.asyncCallbacks.timeoutId),delete Kt.asyncCallbacks);var zt=js("MCUStreamingStarted",Vt.detail);return gt(zt)}},void Fr.onEvent("MCUStreamingStarted",Kt.asyncCallbacks.streamingStarted)):Nt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"startStreaming() - cannot start streaming",ho))})}},{key:"stopStreaming",value:function(){var Kt=this;return new Promise(function(dt,gt){return Kt.asyncCallbacks?gt(Wt.g.createError(et.g.ERROR_OTHER,"stopStreaming() - busy",ho)):Fr.webRTCClient.stopStreaming(Kt.callId)?(Kt.asyncCallbacks={},Kt.asyncCallbacks.timeoutId=setTimeout(function(){return Kt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStopped",Kt.asyncCallbacks.streamingStopped),delete Kt.asyncCallbacks),gt(Wt.g.createError(et.g.ERROR_OTHER,"stopStreaming() - timeout",ho))},et.g.CONVERSATION_STREAMING_STOPPED_DELAY),Kt.asyncCallbacks.streamingStopped=function(Nt){if(Nt.detail.roomName===Kt.conversation._getTechnicalName()&&Nt.detail.callId===Kt.callId){Kt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStopped",Kt.asyncCallbacks.streamingStopped),clearTimeout(Kt.asyncCallbacks.timeoutId),delete Kt.asyncCallbacks);var Vt=js("MCUStreamingStopped",Nt.detail);return dt(Vt)}},void Fr.onEvent("MCUStreamingStopped",Kt.asyncCallbacks.streamingStopped)):gt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"stopStreaming() - cannot stop streaming",ho))})}},{key:"changeStreamPriority",value:function(Kt){var dt=this;return new Promise(function(gt,Nt){return Fr.webRTCClient.changeStreamPriority(dt.callId,Kt)?(dt.conversation.changeStreamPriority(dt.stream.userMediaStreamId,!1,Kt),gt()):Nt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"changeStreamPriority() - cannot change stream priority",ho))})}},{key:"updatePublishedStream",value:function(Kt,dt){var gt=this;return new Promise(function(Nt,Vt){if(Kt!=="audio"&&Kt!=="video")return Vt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"updatePublishedStream() - wrong type",ho));var zt=dt?"sendonly":"inactive";return Fr.webRTCClient.webRTCClient.processUpdateStream(gt.callId,Kt,zt)?Nt():Vt(Wt.g.createError(et.g.ERROR_OTHER,"updatePublishedStream() - cannot update",ho))})}}],Yt&&Bp(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(fn);function Lo($t,Lt){var Yt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Yt){if(Array.isArray($t)||(Yt=function(dt,gt){if(dt){if(typeof dt=="string")return Pu(dt,gt);var Nt=Object.prototype.toString.call(dt).slice(8,-1);return Nt==="Object"&&dt.constructor&&(Nt=dt.constructor.name),Nt==="Map"||Nt==="Set"?Array.from(dt):Nt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Nt)?Pu(dt,gt):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Yt&&($t=Yt);var kt=0,jt=function(){};return{s:jt,n:function(){return kt>=$t.length?{done:!0}:{done:!1,value:$t[kt++]}},e:function(dt){throw dt},f:jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Kt=!1;return{s:function(){Yt=Yt.call($t)},n:function(){var dt=Yt.next();return ln=dt.done,dt},e:function(dt){Kt=!0,sn=dt},f:function(){try{ln||Yt.return==null||Yt.return()}finally{if(Kt)throw sn}}}}function Pu($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function Du($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}var no=ft.Y.get("ContactCatalog"),go=null,xo={},bo={leftGroup:{},joinedGroup:{},userDataChanged:[]},Ro=function(){function $t(){if(function(sn,ln){if(!(sn instanceof ln))throw new TypeError("Cannot call a class as a function")}(this,$t),go!==null)throw"Cannot construct singleton ContactCatalog";this.contactList=new Map,this.eventEmitter=new ht,go=this;var jt=On.get();jt.onEvent("connectedUsersListUpdate",function(sn){var ln=apiRTC.session.apiCCId.toString(),Kt={};switch(sn.detail.updateReason){case"newConnectionState":if(sn.detail.status==="online"){no.debug("new connection");var dt,gt=Lo(sn.detail.usersList);try{for(gt.s();!(dt=gt.n()).done;)(Kt={userId:dt.value,group:sn.detail.group}).userId.toString()!==ln&&Hp(Kt)}catch(bn){gt.e(bn)}finally{gt.f()}}else{no.debug("new disconnection");var Nt,Vt=Lo(sn.detail.usersList);try{for(Vt.s();!(Nt=Vt.n()).done;)Kt={userId:Nt.value,group:sn.detail.group},xo[Kt.group]===void 0&&(xo[Kt.group]={}),Kt.userId.toString()!==ln&&(xo[Kt.group][Kt.userId.toString()]=setTimeout(zp(Kt),jt.contactDisconnectionDelay))}catch(bn){Vt.e(bn)}finally{Vt.f()}}break;case"userDataUpdate":no.debug("userDataUpdate");var zt,Xt=Lo(sn.detail.usersList);try{for(Xt.s();!(zt=Xt.n()).done;)(Kt={userId:zt.value,group:sn.detail.group}).userId.toString()!==ln&&Nu(Kt)}catch(bn){Xt.e(bn)}finally{Xt.f()}break;case"callState":no.debug("callState change for user");var Zt,on=Lo(sn.detail.usersList);try{for(on.s();!(Zt=on.n()).done;)(Kt={userId:Zt.value,group:sn.detail.group}).userId.toString()!==ln&&Nu(Kt)}catch(bn){on.e(bn)}finally{on.f()}break;default:no.warn("default case for updateReason value")}}).onEvent("groupUnsubscribed",function(sn){var ln,Kt=go.getContacts(sn),dt=Lo(Kt.keys());try{for(dt.s();!(ln=dt.n()).done;){var gt=ln.value;Kt.get(gt).removeFromGroup(sn)}}catch(Nt){dt.e(Nt)}finally{dt.f()}})}var Lt,Yt,kt;return Lt=$t,Yt=[{key:"onUpdate",value:function(jt){this.eventEmitter.on("update",jt)}},{key:"removeUpdateListener",value:function(jt){this.eventEmitter.off("update",jt)}},{key:"getContact",value:function(jt){return jt!=null&&this.contactList.has(jt.toString())?this.contactList.get(jt.toString()):null}},{key:"getOrCreateContact",value:function(jt){var sn=null;if(jt!=null)if(this.contactList.has(jt.toString()))sn=this.contactList.get(jt.toString());else try{sn=new No(jt.toString(),{}),this.contactList.set(jt.toString(),sn)}catch(ln){no.debug("Contact not added : "+ln)}return sn}},{key:"getContacts",value:function(jt){if(jt==null)return this.contactList;var sn,ln=new Map,Kt=Lo(this.contactList.keys());try{for(Kt.s();!(sn=Kt.n()).done;){var dt=sn.value;this.contactList.get(dt).inGroup(jt)&&ln.set(dt,this.contactList.get(dt))}}catch(gt){Kt.e(gt)}finally{Kt.f()}return ln}},{key:"getOnlineContacts",value:function(jt){var sn=new Map;if(jt==null){var ln,Kt=Lo(this.contactList.keys());try{for(Kt.s();!(ln=Kt.n()).done;){var dt=ln.value;this.contactList.get(dt).isOnline()&&sn.set(dt,this.contactList.get(dt))}}catch(zt){Kt.e(zt)}finally{Kt.f()}}else{var gt,Nt=Lo(this.contactList.keys());try{for(Nt.s();!(gt=Nt.n()).done;){var Vt=gt.value;this.contactList.get(Vt).inGroup(jt)&&this.contactList.get(Vt).isOnline()&&sn.set(Vt,this.contactList.get(Vt))}}catch(zt){Nt.e(zt)}finally{Nt.f()}}return sn}}],kt=[{key:"get",value:function(){return go===null&&(go=new $t),go}}],Yt&&Du(Lt.prototype,Yt),kt&&Du(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function zp($t){return function(){var Lt=$t.userId.toString();if(no.info("Contact disconnected "+Lt+" from "+$t.group),go.contactList.has(Lt)){var Yt=go.contactList.get(Lt);if(Yt===void 0)return void no.debug("Contact not exist with userId :",Lt);Yt.removeFromGroup($t.group),function(kt,jt){no.debug("updateContactListOnUserDisconnect()"),bo.leftGroup[kt]===void 0&&(bo.leftGroup[kt]=[]),bo.leftGroup[kt].push(jt),Jl()}($t.group,Yt),xo[$t.group]!==void 0&&xo[$t.group][Lt]!==void 0&&delete xo[$t.group][Lt]}}}function Jl(){Object.keys(bo.leftGroup).length===0&&Object.keys(bo.joinedGroup).length===0&&bo.userDataChanged.length===0||(go.eventEmitter.emit("update",bo),bo={leftGroup:{},joinedGroup:{},userDataChanged:[]})}function Hp($t){no.debug("updateContactListOnUserConnection()");var Lt=$t.userId.toString(),Yt=null,kt=apiRTC.session.getConnectedUserInfo(Lt,"userData");no.debug("userData :",kt);try{$t.userData=JSON.parse(kt)}catch(jt){no.warn("userData parse error : "+jt)}if(go.contactList.has(Lt))Yt=go.contactList.get($t.userId),Io.equals(Yt.userData,$t.userData)||(Yt.userData=new Io($t.userData),bo.userDataChanged.push(Yt));else{try{Yt=new No(Lt,$t.userData),go.contactList.set(Lt,Yt)}catch(jt){no.debug("Contact not added : "+jt)}Yt=go.contactList.get(Lt)}Yt!==void 0?(xo[$t.group]!==void 0&&xo[$t.group][Lt]!==void 0&&(clearTimeout(xo[$t.group][Lt]),delete xo[$t.group][Lt]),Yt.inGroup($t.group)||(Yt.addToGroup($t.group),bo.joinedGroup[$t.group]===void 0&&(bo.joinedGroup[$t.group]=[]),bo.joinedGroup[$t.group].push(Yt)),Jl()):no.debug("Contact not exist with userId :",Lt)}function Nu($t){no.debug("updateContactListOnUserDataUpdate()");var Lt=$t.userId.toString(),Yt=go.contactList.get($t.userId);if(Yt!==void 0){var kt=apiRTC.session.getConnectedUserInfo(Lt,"userData");no.debug("userData :",kt);try{$t.userData=JSON.parse(kt)}catch(jt){no.warn("userData parse error : "+jt)}Io.equals(Yt.userData,$t.userData)||(Yt.userData=new Io($t.userData),bo.userDataChanged.push(Yt)),Jl()}else no.debug("Contact not exist with userId :",Lt)}function _s($t){return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},_s($t)}function co($t,Lt){var Yt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Yt){if(Array.isArray($t)||(Yt=function(dt,gt){if(dt){if(typeof dt=="string")return Lu(dt,gt);var Nt=Object.prototype.toString.call(dt).slice(8,-1);return Nt==="Object"&&dt.constructor&&(Nt=dt.constructor.name),Nt==="Map"||Nt==="Set"?Array.from(dt):Nt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Nt)?Lu(dt,gt):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Yt&&($t=Yt);var kt=0,jt=function(){};return{s:jt,n:function(){return kt>=$t.length?{done:!0}:{done:!1,value:$t[kt++]}},e:function(dt){throw dt},f:jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Kt=!1;return{s:function(){Yt=Yt.call($t)},n:function(){var dt=Yt.next();return ln=dt.done,dt},e:function(dt){Kt=!0,sn=dt},f:function(){try{ln||Yt.return==null||Yt.return()}finally{if(Kt)throw sn}}}}function Lu($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function Gp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Uu($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Kl($t,Lt){return Kl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},Kl($t,Lt)}function qp($t,Lt){if(Lt&&(_s(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ur($t)}function ur($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Ps($t){return Ps=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Ps($t)}var Ln=ft.Y.get("Conversation"),qn=On.get(),Eo=new(Go()),ro=Ro.get(),Jp=["adaptationTriggered","audioAmplitude","availableStreamsUpdated","bandwidthLimited","callStatsUpdate","compositeListChanged","contactJoined","contactJoinedWaitingRoom","contactLeft","contactLeftWaitingRoom","cpuLimited","customEvent","data","disconnectionWarning","entryAllowed","entryDenied","error","hangup","joined","left","localStreamUpdated","message","messageNotDelivered","moderatorConnected","newMediaAvailable","newWhiteboardSession","participantEjected","persistentDataUpdated","pointerLocationChanged","pointerSharingEnabled","recordingAvailable","recordingStarted","recordingStopped","remoteStreamUpdated","replayListChanged","roomModeChanged","simulcastFeedChanged","slowLink","streamAdded","streamListChanged","streamRemoved","streamingStarted","streamingStopped","transferPending","transferBegun","transferEnded","transferProgress","whiteboardRoomMemberUpdate","videoQualityChanged","waitingForModeratorAcceptance"],$u=new Set(["CHAT","CALL","GROUP_CHAT","WEBCONF","REPORT","REPORT_PART","TICKET","EVENT","OTHER","BOT"]),Kp=new Set(["audioSent","videoSent","audioReceived","videoReceived","quality"]),Yp=new Set(["CALL_ABORTED","SET_LOCAL_DESCRIPTION_FAILURE","SET_REMOTE_DESCRIPTION_FAILURE"]),ts=new WeakMap,ns=new WeakMap,qo=new WeakMap,Po=new WeakMap,Ds=new WeakMap,Ns=new WeakMap,Mo=new WeakMap,wo=new WeakMap,Yl=new WeakMap,Xl=new WeakMap,Ls=new WeakMap,Us=new WeakMap,$s=new WeakMap,jo=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&Kl(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Ps(jt);if(sn){var Nt=Ps(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return qp(this,dt)});function Kt(dt){var gt,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Gp(this,Kt),gt=ln.call(this,Ln),Ln.debug("Create Conversation"),dt==null?ts.set(ur(gt),Wt.g.guid().toString()):ts.set(ur(gt),dt.toString()),ns.set(ur(gt),"OTHER"),gt.active=!Object.prototype.hasOwnProperty.call(Nt,"active")||typeof Nt.active!="boolean"||Nt.active,gt.meshModeEnabled=Nt.meshModeEnabled===!0,gt.meshOnlyEnabled=Nt.meshOnlyEnabled===!0,gt.moderationEnabled=Nt.moderationEnabled===!0,gt.moderator=Nt.moderator===!0,gt.conversationCalls=new Map,gt.callIdToStreamId=new Map,gt.token=null,gt.sessionId=null,gt.webconfId=null,gt.conversationStreams=new Map,gt.conversationPublishedStreams=new Map,gt.groupChatStatus=et.g.CONVERSATION_STATUS_NOT_JOINED,gt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,gt.whiteboardStarted=et.g.CONVERSATION_WHITEBOARD_NOT_STARTED,gt.pointerSharingState=et.g.STATE_IDLE,gt.pointerSharingAutoInvite=!1,gt.pgroupWaitingRoomSubscribedTo=!1,Ds.set(ur(gt),null),Ns.set(ur(gt),null),Mo.set(ur(gt),new Map),Po.set(ur(gt),null),wo.set(ur(gt),null),qo.set(ur(gt),{}),Ls.set(ur(gt),new Map),$s.set(ur(gt),null),Us.set(ur(gt),null),gt.transferCallIds=[],gt.uploadCap=null,gt.downloadCap=null,gt.reservedStreams=[];var Vt={contactCatalog:{}};for(var zt in Vt.contactCatalog.onUpdate=function(Zt){Ln.debug("onUpdate: contactList",Zt);var on=gt._getTechnicalName();if(Zt.joinedGroup[on]!==void 0){var bn,En=co(Zt.joinedGroup[on]);try{for(En.s();!(bn=En.n()).done;){var Gn=bn.value;Ln.debug(Gn.getUsername()+" joined conversation "+gt.getName()),nn.get(ur(gt)).emit("contactJoined",Gn),gt.pointerSharingState===et.g.STATE_ACTIVE&&gt.pointerSharingAutoInvite===!0&&qn.pointerSharingClient.inviteInRoom(on,Gn.getId())}}catch(Zn){En.e(Zn)}finally{En.f()}}else Ln.debug("not an event joinedGroup for conversation");if(Zt.leftGroup[on]!==void 0){var Kn,cr=co(Zt.leftGroup[on]);try{for(cr.s();!(Kn=cr.n()).done;){var hr=Kn.value;Ln.debug(hr.getUsername()+" left conversation "+gt.getName()),nn.get(ur(gt)).emit("contactLeft",hr)}}catch(Zn){cr.e(Zn)}finally{cr.f()}}else Ln.debug("not an event leftGroup for conversation");if(gt.getRole()===et.g.CONVERSATION_ROLE_MODERATOR){var Ar,Xr=ro.getContacts(et.g.CONVERSATION_WAITING_ROOM_PREFIX+on),_i=co(Ls.get(ur(gt)).keys());try{for(_i.s();!(Ar=_i.n()).done;){var Vo=Ar.value;if(!Xr.has(Vo)){var or=ro.getContact(Vo);or!==null&&(Ln.debug(or.getUsername()+" left waiting room "+gt.getName()),nn.get(ur(gt)).emit("contactLeftWaitingRoom",or))}}}catch(Zn){_i.e(Zn)}finally{_i.f()}Xr.forEach(function(Zn,Tr){Ls.get(ur(gt)).has(Tr)||Zn===null||(Ln.debug(Zn.getUsername()+" joined waiting room "+gt.getName()),nn.get(ur(gt)).emit("contactJoinedWaitingRoom",Zn),qn.sendData(Tr,{event:et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected",roomname:on}).catch(function(kr){var br=Wt.g.createError(kr,"Notification not delivered",Ln);nn.get(ur(gt)).emit("messageNotDelivered",{error:br,contact:Zn,event:et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected"})}))}),Ls.set(ur(gt),Xr)}},ro.onUpdate(Vt.contactCatalog.onUpdate),nn.get(ur(gt)).on("contactJoined",function(Zt){gt.getRole()===et.g.CONVERSATION_ROLE_MODERATOR&&qn.sendData(Zt.getId(),{event:et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected",roomname:gt._getTechnicalName()}).catch(function(on){var bn=Wt.g.createError(on,"Notification not delivered",Ln);nn.get(ur(gt)).emit("messageNotDelivered",{error:bn,contact:Zt,event:et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected"})})}),Vt.apiRTCManager={},Vt.apiRTCManager.receiveData=function(Zt){var on=Zt.detail.data;if(on!==void 0){if(on.roomname===gt._getTechnicalName()){var bn=ro.getOrCreateContact(Zt.detail.senderId);if(on.event)switch(on.event){case et.g.CONVERSATION_SEND_DATA_IDENTIFIER:if(gt.status!==et.g.CONVERSATION_STATUS_JOINED)break;nn.get(ur(gt)).emit("data",{sender:bn,content:on.content});break;case et.g.CONVERSATION_NEW_MEDIA_IDENTIFIER:if(gt.status!==et.g.CONVERSATION_STATUS_JOINED)break;Ln.info("New media available in conversation",on.media),nn.get(ur(gt)).emit("newMediaAvailable",{sender:bn,media:on.media});break;case et.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER:if(gt.status!==et.g.CONVERSATION_STATUS_JOINED)break;gt.updateData();break;case et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER:nn.get(ur(gt)).emit("moderatorConnected",bn);break;case et.g.CONVERSATION_CLOSED_IDENTIFIER:on.instanceId===gt.getInstanceId()&&(Ln.info("Conference "+gt.getName()+" has been closed..."),nn.get(ur(gt)).emit("closed"),gt.leave());break;case et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER:if(on.access===void 0||on.access===null){Ln.error("Conversation join answer has no access data");break}nn.get(ur(gt)).emit(on.access?"entryAllowed":"entryDenied");break;default:nn.get(ur(gt)).emit("customEvent",{event:on.event,content:on,sender:bn})}else if(on.command==="new_snapshot"){if(gt.status!==et.g.CONVERSATION_STATUS_JOINED)return;Ln.info("New media available in conversation",on.value.snapshot),nn.get(ur(gt)).emit("newMediaAvailable",{sender:bn,media:on.value.snapshot})}else Ln.debug("Unprocessed conversation message",on)}}else Ln.debug("Received data undefined, leaving process")},Vt.apiRTCManager.receiveGroupChatMessage=function(Zt){if((gt.status===et.g.CONVERSATION_STATUS_JOINED||gt.groupChatStatus===et.g.CONVERSATION_STATUS_JOINED)&&Zt.detail.groupChatId.toString()===gt._getTechnicalName()){var on={sender:ro.getOrCreateContact(Zt.detail.senderId),sender_id:Zt.detail.senderId,content:Zt.detail.message,time:new Date};Wt.g.isTypeof(Zt.detail,"metadata","object")&&(on.metadata=Zt.detail.metadata),nn.get(ur(gt)).emit("message",on)}},Vt.apiRTCManager.receiveRoomMessage=function(Zt){if(Zt.detail.roomType==="pointerSharing"&&gt.pointerSharingState===et.g.STATE_ACTIVE&&Zt.detail.message.type==="pointerLocation"&&Zt.detail.roomId===gt._getTechnicalName()){var on={sender:ro.getOrCreateContact(Zt.detail.senderId),source:Zt.detail.message.source,x:Zt.detail.message.x,y:Zt.detail.message.y};Wt.g.isPropertyTypeof(Zt.detail.message,"data","object")&&(on.data=Zt.detail.message.data),nn.get(ur(gt)).emit("pointerLocationChanged",on)}},Vt.apiRTCManager.roomInvitation=function(Zt){if(Ln.info("roomInvitation event handler ",Zt),Zt.detail.roomId.toString()===gt._getTechnicalName())if(Ln.info("roomInvitation for actual conversation",Zt),Zt.detail.roomType==="whiteBoard"){if(gt.status===et.g.CONVERSATION_STATUS_JOINED){var on=ro.getOrCreateContact(Zt.detail.senderId);nn.get(ur(gt)).emit("newWhiteboardSession",{sender:on})}}else Zt.detail.roomType==="pointerSharing"&&Ql(ur(gt),!1,!0).then(function(){}).catch(function(bn){})},Vt.apiRTCManager.onFilePending=function(Zt){if(gt.transferCallIds.includes(Zt.detail.callId)){var on={id:Zt.detail.callId,name:Zt.detail.name,rank:Zt.detail.rank};nn.get(ur(gt)).emit("transferPending",on)}},Vt.apiRTCManager.onFileSending=function(Zt){if(gt.transferCallIds.includes(Zt.detail.callId)){var on={id:Zt.detail.callId,name:Zt.detail.name};nn.get(ur(gt)).emit("transferBegun",on)}},Vt.apiRTCManager.onFileProgress=function(Zt){if(gt.transferCallIds.includes(Zt.detail.callId)){var on={id:Zt.detail.callId,name:Zt.detail.name,size:Zt.detail.fileSize,remBytes:Zt.detail.remainingSize,percentage:Zt.detail.percentage};nn.get(ur(gt)).emit("transferProgress",on)}},Vt.apiRTCManager.onFileSended=function(Zt){var on=gt.transferCallIds.indexOf(Zt.detail.callId);if(on>=0){var bn={id:Zt.detail.callId,name:Zt.detail.name};Zt.detail.error&&(bn.error=Zt.detail.error),nn.get(ur(gt)).emit("transferEnded",bn),gt.transferCallIds.splice(on,1)}},Vt.apiRTCManager)qn.onEvent(zt,Vt.apiRTCManager[zt]);Yl.set(ur(gt),Vt);var Xt={MCUAvailableStream:function(Zt){var on,bn=co(Zt.detail.streams);try{for(bn.s();!(on=bn.n()).done;){var En=on.value;if(En.room===gt._getTechnicalName()){var Gn={contact:ro.getOrCreateContact(En.attributes.callerId),isRemote:Zt.detail.isRemoteStream,hasAudio:En.audio,hasVideo:En.video,isAudioMuted:En.audioMuted,isVideoMuted:En.videoMuted,isScreensharing:En.attributes.callType==="screenSharing"||En.attributes.callType==="screenSharingWithAudio",isSIP:En.sip===!0,isSimulcast:En.simulcast===!0,streamId:En.id,type:"regular",callId:En.attributes.callId,descriptor:En.attributes.descriptor,context:En.context};gt.conversationStreams.set(Gn.streamId,Gn);var Kn={listEventType:"added"};Wt.g.assignObject(Kn,Gn),nn.get(ur(gt)).emit("streamListChanged",Kn)}}}catch(_i){bn.e(_i)}finally{bn.f()}Ln.debug("Nb stream into conversation :"+gt.conversationStreams.size);var cr,hr={},Ar=co(gt.conversationStreams.keys());try{for(Ar.s();!(cr=Ar.n()).done;){var Xr=cr.value;hr[Xr]=gt.conversationStreams.get(Xr)}}catch(_i){Ar.e(_i)}finally{Ar.f()}nn.get(ur(gt)).emit("availableStreamsUpdated",hr)},MCUAvailableStreamUpdate:function(Zt){var on,bn=co(Zt.detail.streams);try{for(bn.s();!(on=bn.n()).done;){var En=on.value;if(En.room===gt._getTechnicalName()){var Gn=gt.conversationStreams.get(En.id);if(Gn&&Gn.type==="regular"){Gn.hasAudio=En.audio,Gn.hasVideo=En.video,Gn.isAudioMuted=En.audioMuted,Gn.isVideoMuted=En.videoMuted,Gn.descriptor=En.attributes.descriptor;var Kn={listEventType:"updated"};Wt.g.assignObject(Kn,Gn),nn.get(ur(gt)).emit("streamListChanged",Kn),Gn.descriptor&&Object.prototype.hasOwnProperty.call(Gn.descriptor,"priority")&&gt.changeStreamPriority(Gn.streamId,!0,Gn.descriptor.priority)}}}}catch(_i){bn.e(_i)}finally{bn.f()}Ln.debug("Nb stream into conversation :"+gt.conversationStreams.size);var cr,hr={},Ar=co(gt.conversationStreams.keys());try{for(Ar.s();!(cr=Ar.n()).done;){var Xr=cr.value;hr[Xr]=gt.conversationStreams.get(Xr)}}catch(_i){Ar.e(_i)}finally{Ar.f()}nn.get(ur(gt)).emit("availableStreamsUpdated",hr)},MCUAvailableComposite:function(Zt){var on,bn=co(Zt.detail.streams);try{for(bn.s();!(on=bn.n()).done;){var En=on.value;if(En.room===gt._getTechnicalName()){var Gn={isRemote:Zt.detail.isRemoteStream,hasAudio:En.audio,hasVideo:En.video,isAudioMuted:En.audioMuted,isVideoMuted:En.videoMuted,isScreensharing:En.attributes.callType==="screenSharing"||En.attributes.callType==="screenSharingWithAudio",isSIP:En.sip===!0,streamId:En.id,type:"composite",callId:En.attributes.callId,descriptor:En.attributes.descriptor,context:En.context};gt.conversationStreams.set(Gn.streamId,Gn);var Kn={listEventType:"added"};Wt.g.assignObject(Kn,Gn),nn.get(ur(gt)).emit("compositeListChanged",Kn)}}}catch(cr){bn.e(cr)}finally{bn.f()}},MCUAvailableReplay:function(Zt){var on,bn=co(Zt.detail.streams);try{for(bn.s();!(on=bn.n()).done;){var En=on.value;if(En.room===gt._getTechnicalName()){var Gn={contact:ro.getOrCreateContact(En.attributes.callerId),isRemote:Zt.detail.isRemoteStream,hasAudio:En.audio,hasVideo:En.video,isAudioMuted:En.audioMuted,isVideoMuted:En.videoMuted,isScreensharing:En.attributes.callType==="screenSharing"||En.attributes.callType==="screenSharingWithAudio",isSIP:En.sip===!0,streamId:En.id,type:"replay",callId:En.attributes.callId,descriptor:En.attributes.descriptor,context:En.context};gt.conversationStreams.set(Gn.streamId,Gn);var Kn={listEventType:"added"};Wt.g.assignObject(Kn,Gn),nn.get(ur(gt)).emit("replayListChanged",Kn)}}}catch(cr){bn.e(cr)}finally{bn.f()}},MCURemoveStream:function(Zt){if(gt.conversationStreams.has(Zt.detail.streamId)){var on={listEventType:"removed"};Wt.g.assignObject(on,gt.conversationStreams.get(Zt.detail.streamId)),on.type==="regular"?nn.get(ur(gt)).emit("streamListChanged",on):on.type==="composite"&&nn.get(ur(gt)).emit("compositeListChanged",on),gt.conversationStreams.delete(Zt.detail.streamId),Ln.debug("Nb stream into conversation :"+gt.conversationStreams.size);var bn,En={},Gn=co(gt.conversationStreams.keys());try{for(Gn.s();!(bn=Gn.n()).done;){var Kn=bn.value;En[Kn]=gt.conversationStreams.get(Kn)}}catch(cr){Gn.e(cr)}finally{Gn.f()}nn.get(ur(gt)).emit("availableStreamsUpdated",En)}else Ln.debug("Not a conversation's stream")},remoteStreamAdded:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){Ln.info("remoteStreamAdded",Zt.detail);var on=ro.getOrCreateContact(Zt.detail.remoteId),bn=gt.callIdToStreamId.get(Zt.detail.callId),En=Mo.get(ur(gt));En.has(bn)&&nn.get(ur(gt)).emit("streamRemoved",En.get(bn));var Gn=Zt.detail.callType==="audio"?"audio":"video",Kn=Zt.detail.callType==="screenSharing",cr=new so(Zt.detail.stream,{type:Gn,contact:on,streamId:bn,callId:Zt.detail.callId,callAudioAvailable:Zt.detail.audioIsAvailable,callAudioActive:Zt.detail.audioIsActive,callAudioMuted:Zt.detail.audioIsMuted,callVideoAvailable:Zt.detail.videoIsAvailable,callVideoActive:Zt.detail.videoIsActive,callVideoMuted:Zt.detail.videoIsMuted,screensharing:Kn,constructor:!0});cr.publishedInConversations.set(gt.getName(),Zt.detail.callId),Mo.get(ur(gt)).set(bn,cr),apiRTC.session.remoteAccessInvitation!==null&&apiRTC.session.remoteAccessInvitation.screenSharingStreamId===bn?(Ln.debug("This is screensharing stream for remoteAccess"),cr.screensharingRemoteAccessStream=!0,apiRTC.session.remoteAccessInvitation.setRemoteAccessStream(cr)):nn.get(ur(gt)).emit("streamAdded",cr)}},remoteStreamRemoved:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){var on=gt.callIdToStreamId.get(Zt.detail.callId),bn=Mo.get(ur(gt));bn.has(on)&&(nn.get(ur(gt)).emit("streamRemoved",bn.get(on)),bn.delete(on))}},roomMemberUpdate:function(Zt){Ln.info("roomMemberUpdate event handler ",Zt);var on,bn=[],En=co(Zt.detail.contactList);try{for(En.s();!(on=En.n()).done;){var Gn=on.value;bn.push(ro.getOrCreateContact(Gn.contactId))}}catch(Kn){En.e(Kn)}finally{En.f()}Zt.detail.roomType==="whiteBoard"&&(Ln.info("Received whiteboard room member update"),nn.get(ur(gt)).emit("whiteboardRoomMemberUpdate",{contacts:bn,roomId:Zt.detail.roomId,status:Zt.detail.status}))},slowLink:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){var on=gt.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on};Zt.detail.advice&&(bn.advice=Zt.detail.advice),nn.get(ur(gt)).emit("slowLink",bn)}},videoQualityChanged:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){var on=gt.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,hint:Zt.detail.hint,profileType:Zt.detail.profileType};Zt.detail.bitrate&&(bn.bitrate=Zt.detail.bitrate),Zt.detail.width&&Zt.detail.height&&(bn.width=Zt.detail.width,bn.height=Zt.detail.height),Zt.detail.frameRate&&(bn.frameRate=Zt.detail.frameRate),nn.get(ur(gt)).emit("videoQualityChanged",bn)}},simulcastFeedChanged:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){var on=gt.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,simulcast:Zt.detail.simulcast};nn.get(ur(gt)).emit("simulcastFeedChanged",bn)}},localStreamUpdated:function(Zt){if(Zt.detail.onCall&&gt.callIdToStreamId.has(Zt.detail.callId)){var on={callId:Zt.detail.callId,streamId:Zt.detail.userMediaStreamId,audio:Zt.detail.audioIsAvailable&&Zt.detail.audioIsActive,audioMuted:Zt.detail.audioIsMuted,audioSilent:Zt.detail.audioIsSilent,video:Zt.detail.videoIsAvailable&&Zt.detail.videoIsActive,videoMuted:Zt.detail.videoIsMuted,videoSilent:Zt.detail.videoIsSilent,cause:Zt.detail.cause};nn.get(ur(gt)).emit("localStreamUpdated",on)}},remoteStreamUpdated:function(Zt){var on=Zt.detail,bn=on.callId,En=on.cause;if(gt.callIdToStreamId.has(bn)&&(En==="adaptation"||En==="userAction")){var Gn={callId:bn,streamId:gt.callIdToStreamId.get(bn),audio:Zt.detail.audioIsAvailable&&Zt.detail.audioIsActive,audioMuted:Zt.detail.audioIsMuted,audioSilent:Zt.detail.audioIsSilent,video:Zt.detail.videoIsAvailable&&Zt.detail.videoIsActive,videoMuted:Zt.detail.videoIsMuted,videoSilent:Zt.detail.videoIsSilent,cause:En};setTimeout(function(){nn.get(ur(gt)).emit("remoteStreamUpdated",Gn)})}},MCURecordingStarted:function(Zt){if(Zt.detail.roomName===gt._getTechnicalName()){var on=Wt.g.parseRecordingEvent("MCURecordingStarted",Zt.detail);if(on.callId==="COMPOSITE")gt.recordingStatus=on;else{var bn=gt.conversationCalls.get(on.callId);bn&&(bn.recordingStatus=on)}nn.get(ur(gt)).emit("recordingStarted",on)}},MCURecordingStopped:function(Zt){if(Zt.detail.roomName===gt._getTechnicalName()){var on=Wt.g.parseRecordingEvent("MCURecordingStopped",Zt.detail);if(on.callId==="COMPOSITE")delete gt.recordingStatus;else{var bn=gt.conversationCalls.get(on.callId);bn&&delete bn.recordingStatus}nn.get(ur(gt)).emit("recordingStopped",on)}},MCURecordedStreamsAvailable:function(Zt){if(Zt.detail.roomName===gt._getTechnicalName()){var on=Wt.g.parseRecordingEvent("MCURecordedStreamsAvailable",Zt.detail);nn.get(ur(gt)).emit("recordingAvailable",on)}},MCUStreamingStarted:function(Zt){if(Zt.detail.roomName===gt._getTechnicalName()){var on=js("MCUStreamingStarted",Zt.detail),bn=gt.conversationCalls.get(on.callId);bn&&(bn.streamingStatus=on),nn.get(ur(gt)).emit("streamingStarted",on)}},MCUStreamingStopped:function(Zt){if(Zt.detail.roomName===gt._getTechnicalName()){var on=js("MCUStreamingStopped",Zt.detail),bn=gt.conversationCalls.get(on.callId);bn&&delete bn.streamingStatus,nn.get(ur(gt)).emit("streamingStopped",on)}},onCallStatsUpdate:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){var on=gt.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,stats:{}};Zt.detail.userId&&(bn.mesh=!0,bn.userId=Zt.detail.userId,bn.contact=ro.getOrCreateContact(Zt.detail.userId));for(var En=0,Gn=Object.keys(Zt.detail.stats);En<Gn.length;En++){var Kn=Gn[En];Kp.has(Kn)&&(bn.stats[Kn]=Zt.detail.stats[Kn])}nn.get(ur(gt)).emit("callStatsUpdate",bn)}},cpuLimited:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){var on=gt.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,encodeUsagePercent:Zt.detail.encodeUsagePercent};nn.get(ur(gt)).emit("cpuLimited",bn)}},bandwidthLimited:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){var on=gt.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,resolutionChanged:!0};nn.get(ur(gt)).emit("bandwidthLimited",bn)}},audioAmplitude:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){var on=gt.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,amplitude:Zt.detail.descriptor.amplitude,isSpeaking:Zt.detail.descriptor.isSpeaking,descriptor:{amplitude:Zt.detail.descriptor.amplitude,isSpeaking:Zt.detail.descriptor.isSpeaking}};nn.get(ur(gt)).emit("audioAmplitude",bn)}},hangup:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.callId)){var on=gt.callIdToStreamId.get(Zt.detail.callId),bn=Mo.get(ur(gt));bn.has(on)&&(nn.get(ur(gt)).emit("streamRemoved",bn.get(on)),bn.delete(on)),Zt.detail.reason!=="restarted"&&Zt.detail.reason!=="disconnected"&&Zt.detail.reason!=="Broken_by_MCU"&&Zt.detail.reason!=="RTC_Setup_Timeout"&&(gt.conversationCalls.has(Zt.detail.callId)?Bu(ur(gt),Zt.detail.callId):(gt.callIdToStreamId.delete(Zt.detail.callId),gt.releaseResources(on,{isRemote:!0,triggerAdaptation:!0})),nn.get(ur(gt)).emit("hangup",{from:Zt.detail.hangupType,reason:Zt.detail.reason,streamId:on}))}},callRestarting:function(Zt){if(gt.callIdToStreamId.has(Zt.detail.oldCallId)){var on=gt.callIdToStreamId.get(Zt.detail.oldCallId);gt.callIdToStreamId.delete(Zt.detail.oldCallId),gt.callIdToStreamId.set(Zt.detail.newCallId,on)}},MCUParticipantEjected:function(Zt){if(gt._getTechnicalName()===Zt.detail.roomId){var on=wo.get(ur(gt));if(Zt.detail.clientId===on.getId())gt.leave().catch(function(En){Ln.error("leave",En)}).then(function(){nn.get(ur(gt)).emit("participantEjected",{self:!0})});else{var bn=ro.getOrCreateContact(Zt.detail.clientId);nn.get(ur(gt)).emit("participantEjected",{self:!1,contact:bn})}}},MCURoomModeChanged:function(Zt){gt._getTechnicalName()===Zt.detail.roomId&&nn.get(ur(gt)).emit("roomModeChanged",{oldMode:Zt.detail.oldMode,newMode:Zt.detail.newMode,state:Zt.detail.state})}};return Xl.set(ur(gt),Xt),nn.get(ur(gt)).on("left",function(){gt.pgroupWaitingRoomSubscribedTo&&(qn.apiRTCSession.unsubscribePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+gt._getTechnicalName()]),gt.pgroupWaitingRoomSubscribedTo=!1),Ds.set(ur(gt),null),Ns.set(ur(gt),null),wo.set(ur(gt),null),$s.set(ur(gt),null)}),gt}return Lt=Kt,Yt=[{key:"destroy",value:function(){uo.get().deleteConversation(this.getName());var dt=Yl.get(this);if(dt){if(dt.apiRTCManager)for(var gt in dt.apiRTCManager)qn.removeEventListener(gt,dt.apiRTCManager[gt]);dt.contactCatalog&&ro.removeUpdateListener(dt.contactCatalog.onUpdate),Yl.delete(this)}}},{key:"getStatus",value:function(){return this.status}},{key:"getName",value:function(){return ts.get(this).toString()}},{key:"_getTechnicalName",value:function(){return ts.get(this).toString()}},{key:"getRole",value:function(){return Ds.get(this)}},{key:"getInstanceId",value:function(){return $s.get(this)}},{key:"getFriendlyName",value:function(){return null}},{key:"getModerator",value:function(){return Ns.get(this)}},{key:"getType",value:function(){return ns.get(this)}},{key:"setType",value:function(dt){return!this.isBound()&&!!$u.has(dt)&&(ns.set(this,dt),!0)}},{key:"getCloudConversationId",value:function(){var dt=Po.get(this);return dt?dt.toString():null}},{key:"getMedia",value:function(dt){return new Promise(function(gt,Nt){apiRTC.CloudApi.cloudFetchMedia(dt).then(function(Vt){gt(Vt)}).catch(function(Vt){Nt(Vt)})})}},{key:"bind",value:function(dt){var gt=this;dt||(dt={});var Nt=Po.get(this);return Nt!==null?Promise.resolve(String(Nt)):new Promise(function(Vt,zt){Fu(gt,dt).then(function(Xt){Vt(String(Xt.id))}).catch(function(Xt){zt(Wt.g.createError(et.g.ERROR_HTTP,"bind() - cannot bind conversation",Ln,{fromError:Xt}))})})}},{key:"isBound",value:function(){return Po.get(this)!==null}},{key:"isGroupChatJoined",value:function(){return this.groupChatStatus===et.g.CONVERSATION_STATUS_JOINED}},{key:"joinGroupChat",value:function(){var dt=this;return new Promise(function(gt,Nt){if(dt.groupChatStatus!==et.g.CONVERSATION_STATUS_NOT_JOINED)return Nt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"joinGroupChat() - cannot join group chat",Ln));dt.bind().then(function(){return new Promise(function(Vt,zt){if(dt.asyncCallbacks)return zt(Wt.g.createError(et.g.ERROR_OTHER,"joinGroupChat() - busy",Ln));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return qn.removeEventListener("groupChatMemberUpdate",dt.asyncCallbacks.groupChatMemberUpdate),delete dt.asyncCallbacks,zt(Wt.g.createError(et.g.ERROR_OTHER,"joinGroupChat() - timeout",Ln))},et.g.CONVERSATION_GROUP_CHAT_MEMBER_UPDATE_DELAY),dt.asyncCallbacks.groupChatMemberUpdate=function(Xt){if(Xt.detail.groupChatId===dt._getTechnicalName()&&Xt.detail.status==="online"&&function(Zt,on){for(var bn=Zt.length;--bn>=0;)if(Zt[bn].contactId===on)return!0;return!1}(Xt.detail.contactList,qn.getClientId()))return dt.asyncCallbacks&&(qn.removeEventListener("groupChatMemberUpdate",dt.asyncCallbacks.groupChatMemberUpdate),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Vt()},qn.onEvent("groupChatMemberUpdate",dt.asyncCallbacks.groupChatMemberUpdate),qn.joinGroupChat(dt._getTechnicalName())})}).then(function(){dt.groupChatStatus=et.g.CONVERSATION_STATUS_JOINED,qn.joinAndSubscribeToPresenceGroup(dt._getTechnicalName()),gt()}).catch(function(Vt){Nt(Wt.g.createError(et.g.ERROR_OTHER,"joinGroupChat() - cannot join group chat",Ln,{fromError:Vt}))})})}},{key:"leaveGroupChat",value:function(){var dt=this;return new Promise(function(gt,Nt){return dt.groupChatStatus!==et.g.CONVERSATION_STATUS_JOINED?Nt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"leaveGroupChat() - group chat not joined",Ln)):dt.status!==et.g.CONVERSATION_STATUS_NOT_JOINED?Nt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"leaveGroupChat() - webconf active",Ln)):void qn.leaveGroupChat(dt._getTechnicalName()).then(function(){dt.groupChatStatus=et.g.CONVERSATION_STATUS_NOT_JOINED,qn.leaveAndUnsubscribeToPresenceGroup(dt._getTechnicalName()),gt()}).catch(function(Vt){Nt(Wt.g.createError(et.g.ERROR_OTHER,"leaveGroupChat() - cannot leave group chat",Ln,{fromError:Vt}))})})}},{key:"isJoined",value:function(){return this.status===et.g.CONVERSATION_STATUS_JOINED}},{key:"isPublishedStream",value:function(dt){return dt.publishedInConversations.has(this.getName())}},{key:"publish",value:function(dt,gt){var Nt=this;return gt||(gt={}),new Promise(function(Vt,zt){if(Nt.status!==et.g.CONVERSATION_STATUS_JOINED)return zt(Wt.g.createError(et.g.ERROR_OTHER,"publish() - conversation not joined",Ln));if(!(dt instanceof so))return zt(Wt.g.createError(et.g.ERROR_OTHER,"publish() - No stream specified",Ln));if(Nt.isPublishedStream(dt))return zt(Wt.g.createError(et.g.ERROR_OTHER,"publish() - Stream is already published in this conversation!",Ln));var Xt={};Xt.userMediaStreamId=dt.userMediaStreamId,gt!==null&&_s(gt)==="object"&&(Xt.audioOnly=gt.audioOnly,Xt.videoOnly=gt.videoOnly,Xt.private=gt.private,Xt.record=gt.record,Xt.turnServerAddress=gt.turnServerAddress,Xt.profileType=gt.profileType,Xt.priority=gt.priority,Xt.downgradeProfileList=gt.downgradeProfileList,Xt.distributedBroadcastEnabled=gt.distributedBroadcastEnabled),Wt.g.isPropertyTypeof(gt,"mediaType","string")&&(Xt.mediaType=gt.mediaType,Xt.audioOnly&&(Xt.mediaType="AUDIOONLY"),Xt.videoOnly&&(Xt.mediaType="VIDEOONLY")),Wt.g.isPropertyTypeof(gt,"qos","object")&&(Xt.qos={},Wt.g.isPropertyTypeof(gt.qos,"videoMinBitrate","number")&&(Xt.qos.videoMinBitrate=gt.qos.videoMinBitrate),Wt.g.isPropertyTypeof(gt.qos,"videoMinQuality","string")&&(Xt.qos.videoMinQuality=gt.qos.videoMinQuality),Wt.g.isPropertyTypeof(gt.qos,"videoStartBitrate","number")&&(Xt.qos.videoStartBitrate=gt.qos.videoStartBitrate),Wt.g.isPropertyTypeof(gt.qos,"videoStartQuality","string")&&(Xt.qos.videoStartQuality=gt.qos.videoStartQuality),Wt.g.isPropertyTypeof(gt.qos,"videoForbidInactive","boolean")&&(Xt.qos.videoForbidInactive=gt.qos.videoForbidInactive)),Wt.g.isPropertyTypeof(gt,"simulcast","object")&&!Xt.audioOnly&&(Xt.simulcast={},Wt.g.isPropertyTypeof(gt.simulcast,"mode","string")&&["RID","SDP"].indexOf(gt.simulcast.mode)>=0&&(Xt.simulcast.mode=gt.simulcast.mode),Wt.g.isPropertyTypeof(gt.simulcast,"maxBitrate","number")?Xt.simulcast.maxBitrate=gt.simulcast.maxBitrate:Wt.g.isPropertyTypeof(gt.simulcast,"encodings","object")&&(Xt.simulcast.encodings=Object.assign({},gt.simulcast.encodings))),["audioLabels","videoLabels"].forEach(function(cr){Wt.g.isTypeof(gt,cr,"array")&&(Xt[cr]=[],gt[cr].forEach(function(hr){Wt.g.isTypeof(hr,"string")&&Xt[cr].push(hr)}))}),Wt.g.isPropertyTypeof(gt,"context","object")&&(Xt.context=gt.context);var Zt=null;if(dt.hasVideo()&&Nt.getNetworkCap({capacity:!0})&&gt.profileType&&gt.downgradeProfileList){for(var on=gt.downgradeProfileList.length;--on>=0;)if(gt.downgradeProfileList[on].name===gt.profileType){gt.downgradeProfileList[on].bitrate&&(Zt=gt.downgradeProfileList[on].bitrate);break}}if(Zt){if(!Nt.reserveResources(gt.profileType,Zt,dt.userMediaStreamId,!1,gt.priority,{isVideoOnly:!dt.hasAudio(),isVideoMuted:Xt.audioOnly,control:!0})&&!Nt.disableLowerPriorityVideo(!1,Zt,gt.priority)){if(!dt.hasAudio())return zt(Wt.g.createError(et.g.ERROR_OTHER,"publish() - not enough bandwidth",Ln));Xt.audioOnly=!0}Nt.reserveResources(gt.profileType,Zt,dt.userMediaStreamId,!1,gt.priority,{isVideoOnly:!dt.hasAudio(),isVideoMuted:Xt.audioOnly})}Ln.info("callConfiguration:",Xt);var bn=dt.isScreensharing(),En=qn.webRTCClient.publish(Nt.sessionId,Nt.sessionId,Nt.token,Xt,{},{forceScreenSharingCallType:bn});if(!En)return Nt.releaseResources(dt.userMediaStreamId),zt(Wt.g.createError(et.g.ERROR_OTHER,"publish() - failed to establish call",Ln));Nt.conversationCalls.set(En,new Gl(Nt,En,dt)),dt.publishedInConversations.set(Nt.getName(),En),Nt.callIdToStreamId.set(En,dt.userMediaStreamId);var Gn={contact:null,isRemote:!1,hasAudio:dt.hasAudio(),hasVideo:dt.hasVideo(),isScreensharing:dt.isScreensharing(),streamId:dt.userMediaStreamId,callId:En};Nt.conversationPublishedStreams.set(dt.userMediaStreamId,Gn);var Kn={callEstablishedHandler:function(cr){cr.detail.callId.toString()===En.toString()&&(qn.removeEventListener("callEstablished",Kn.callEstablishedHandler),Nt.removeListener("error",Kn.errorHandler),Vt(dt))}};qn.onEvent("callEstablished",Kn.callEstablishedHandler),Kn.errorHandler=function(cr){cr.callId===En&&(qn.removeEventListener("callEstablished",Kn.callEstablishedHandler),Nt.removeListener("error",Kn.errorHandler),Nt.releaseResources(dt.userMediaStreamId),zt(Wt.g.createError(et.g.ERROR_OTHER,"publish() - "+cr.errorInfo,Ln)))},Nt.on("error",Kn.errorHandler)})}},{key:"unpublish",value:function(dt,gt){if(gt||(gt={}),dt instanceof so)if(this.isPublishedStream(dt)){var Nt=dt.publishedInConversations.get(this.getName()),Vt=!gt.noTriggerAdaptation;Bu(this,Nt,{stream:dt,triggerAdaptation:Vt}),qn.webRTCClient&&qn.webRTCClient.unpublish(Nt)}else Ln.error("unpublish() - Stream is not published to conversation");else Ln.error("unpublish() - No stream specified",dt)}},{key:"getConversationCall",value:function(dt){if(!dt)return null;var gt=dt.publishedInConversations.get(this.getName());return gt?this.conversationCalls.get(gt):null}},{key:"replacePublishedStream",value:function(dt,gt,Nt){var Vt=this;return Ln.info("replacePublishedStream"),new Promise(function(zt,Xt){var Zt=Vt.getConversationCall(dt);if(Zt===null)return Xt(new Error("CALL_NOT_FOUND"));Zt.replacePublishedStream(gt,Nt).then(function(on){console.error("replacePublishedStream OK"),zt(on)}).catch(function(on){console.error("replacePublishedStream NOK"),Xt(on)})})}},{key:"getCallId",value:function(dt){return dt.publishedInConversations.get(this.getName())}},{key:"checkAccess",value:function(dt){var gt=this;return dt||(dt={}),new Promise(function(Nt,Vt){if(dt.force!==!0&&gt.accessStatus)return Nt(gt.accessStatus);dt.hasOwnProperty("session")||Br.getActiveSession()===null||(dt.session=Br.getActiveSession()),gt.bind(dt).then(function(zt){return dt.convId=zt,Eo.checkConferenceAccess(gt._getTechnicalName(),qn.getActiveApiKey(),dt)}).then(function(zt){return zt.access!==et.g.CONVERSATION_ACCESS_GRANTED&&zt.access!==et.g.CONVERSATION_NEED_MODERATOR_ACCEPTATION&&Ln.warn("checkAccess() - unknown access response:",zt.access),zt.role!==et.g.CONVERSATION_ROLE_MODERATOR&&zt.role!==et.g.CONVERSATION_ROLE_CONTRIBUTOR&&zt.role!==et.g.CONVERSATION_ROLE_GUEST&&Ln.warn("checkAccess() - unknown role response:",zt.role),zt.hasOwnProperty("webconfId")&&(gt.webconfId=zt.webconfId,delete zt.webconfId),gt.accessStatus=Wt.g.assignObject({},zt),Nt(gt.accessStatus)}).catch(function(zt){Vt(Wt.g.createError(et.g.ERROR_APIRTC_INITIALISATION_FAILED,"checkAccess() - cannot check access",Ln,{fromError:zt}))})})}},{key:"join",value:function(){var dt=this,gt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ln.debug("Joining "+this.getName()),new Promise(function(Nt,Vt){if(dt.status!==et.g.CONVERSATION_STATUS_NOT_JOINED)return Vt(Wt.g.createError(et.g.ERROR_OTHER,"join() - cannot join conversation",Ln));gt=Object.assign({},gt);var zt=!1;gt.qualityAdaptationEnabled&&(zt=!0,delete gt.qualityAdaptationEnabled);var Xt=null;gt.supportedVideoCodecs&&(Xt=gt.supportedVideoCodecs,delete gt.supportedVideoCodecs),dt.checkAccess(gt).then(function(Zt){if(!dt.conference){if(Zt.type!=="public")return Promise.reject(Wt.g.createError(et.g.ERROR_UNAUTHORIZED,"join() - wrong conference type",Ln));if(Zt.access!==et.g.CONVERSATION_ACCESS_GRANTED)return Promise.reject(Wt.g.createError(et.g.ERROR_UNAUTHORIZED,"join() - access to conference not granted",Ln))}return Qp(dt,Zt)}).then(function(Zt){if(Ds.set(dt,Zt.role),dt.status=et.g.CONVERSATION_STATUS_JOINING,dt.conference)return gt.hasOwnProperty("password")&&Us.set(dt,gt.password),dt.friendlyName=Zt.hasOwnProperty("friendlyName")?Zt.friendlyName:dt.friendlyName,$s.set(dt,Zt.instanceId),Zp(dt,wo.get(dt),qn.getActiveApiKey())}).then(function(){var Zt=dt,on=function Gn(Kn){if(Ln.debug("joinMCUSessionAnswer",Zt._getTechnicalName(),Kn.detail),Kn.detail.roomId.toString()===Zt._getTechnicalName()){if(Kn.detail.result&&Kn.detail.result.failed){Ln.error("Conversation "+Zt.getName()+" join failed",Kn.detail),this.status=et.g.CONVERSATION_STATUS_NOT_JOINED;var cr=Kn.detail.result.reason?Kn.detail.result.reason:"join failed";return Vt(Wt.g.createError(et.g.ERROR_UNAUTHORIZED,"join() - "+cr,Ln))}Ln.info("Conversation "+Zt.getName()+" joined",Kn.detail),qn.removeEventListener("joinMCUSessionAnswer",Gn),Zt.status=et.g.CONVERSATION_STATUS_JOINED,Zt.token=Kn.detail.token,Zt.sessionId=Kn.detail.sessionId,Zt.mode=Kn.detail.mode,Zt.conversationStreams=new Map;var hr=Xl.get(Zt);qn.onEvent("MCUAvailableStream",hr.MCUAvailableStream).onEvent("MCUAvailableStreamUpdate",hr.MCUAvailableStreamUpdate).onEvent("MCURemoveStream",hr.MCURemoveStream).onEvent("MCUAvailableComposite",hr.MCUAvailableComposite).onEvent("MCUAvailableReplay",hr.MCUAvailableReplay).onEvent("MCUParticipantEjected",hr.MCUParticipantEjected).onEvent("remoteStreamAdded",hr.remoteStreamAdded).onEvent("remoteStreamRemoved",hr.remoteStreamRemoved).onEvent("roomMemberUpdate",hr.roomMemberUpdate).onEvent("slowLink",hr.slowLink).onEvent("localStreamUpdated",hr.localStreamUpdated).onEvent("remoteStreamUpdated",hr.remoteStreamUpdated).onEvent("simulcastFeedChanged",hr.simulcastFeedChanged).onEvent("MCURecordingStarted",hr.MCURecordingStarted).onEvent("MCURecordingStopped",hr.MCURecordingStopped).onEvent("MCURecordedStreamsAvailable",hr.MCURecordedStreamsAvailable).onEvent("MCUStreamingStarted",hr.MCUStreamingStarted).onEvent("MCUStreamingStopped",hr.MCUStreamingStopped).onEvent("MCURoomModeChanged",hr.MCURoomModeChanged).onEvent("onCallStatsUpdate",hr.onCallStatsUpdate).onEvent("hangup",hr.hangup).onEvent("callRestarting",hr.callRestarting).onEvent("audioAmplitude",hr.audioAmplitude).onEvent("videoQualityChanged",hr.videoQualityChanged).onEvent("cpuLimited",hr.cpuLimited).onEvent("bandwidthLimited",hr.bandwidthLimited),Zt.conference&&Zt.updateData(),Zt.getRole()===et.g.CONVERSATION_ROLE_MODERATOR&&(qn.apiRTCSession.subscribePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+Zt._getTechnicalName()]),Zt.pgroupWaitingRoomSubscribedTo=!0),Zt.groupChatStatus!==et.g.CONVERSATION_STATUS_NOT_JOINED&&(Zt.groupChatStatus=et.g.CONVERSATION_STATUS_NOT_JOINED),nn.get(Zt).emit("joined");var Ar={};Kn.detail.mode==="mesh"&&(Ar.mode="mesh",Kn.detail.meshOnly===!0&&(Ar.meshOnly=!0)),Nt(Ar)}};qn.onEvent("joinMCUSessionAnswer",on);var bn={};bn.convId=dt.getCloudConversationId(),dt.meshModeEnabled&&(bn.meshModeEnabled=dt.meshModeEnabled),dt.meshOnlyEnabled&&(bn.meshOnlyEnabled=dt.meshOnlyEnabled),dt.conference||(dt.moderationEnabled&&(bn.moderationEnabled=!0),dt.getRole()===et.g.CONVERSATION_ROLE_MODERATOR&&(bn.moderator=!0)),zt&&(bn.qualityAdaptationEnabled=!0),Xt&&(bn.supportedVideoCodecs=Xt);var En=qn.webRTCClient.joinMCUSession(dt._getTechnicalName(),bn);if(En instanceof Error)return qn.removeEventListener("joinMCUSessionAnswer",on),Zt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Vt(Wt.g.createError(et.g.ERROR_OTHER,"join() - cannot join conversation :"+En.message,Ln))}).catch(function(Zt){return dt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Vt(Wt.g.createError(et.g.ERROR_OTHER,"join() - cannot join conversation",Ln,{fromError:Zt}))})})}},{key:"cancelJoin",value:function(){return this.cancelJoin0!==null&&typeof this.cancelJoin0=="function"&&this.cancelJoin0()}},{key:"eject",value:function(dt,gt){var Nt=this;return new Promise(function(Vt,zt){if(Nt.status!==et.g.CONVERSATION_STATUS_JOINED)return zt(Wt.g.createError(et.g.ERROR_OTHER,"eject() - conference not joined",Ln));if(Nt.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR)return zt(Wt.g.createError(et.g.ERROR_UNAUTHORIZED,"eject() - only moderator can eject a contact",Ln));var Xt={};Xt.timeoutId=setTimeout(function(){return Xt&&(qn.removeEventListener("MCUParticipantEjected",Xt.ejected),Xt=!1),zt(Wt.g.createError(et.g.ERROR_OTHER,"eject() - timeout",Ln))},et.g.CONVERSATION_PARTICIPANT_EJECTION_DELAY),Xt.ejected=function(Zt){if(Zt.detail.roomId===Nt._getTechnicalName()&&Zt.detail.clientId===dt.getId())return Xt&&(clearTimeout(Xt.timeoutId),qn.removeEventListener("MCUParticipantEjected",Xt.ejected),Xt=!1),Vt()},qn.onEvent("MCUParticipantEjected",Xt.ejected),qn.webRTCClient.ejectParticipantFromMCUSession(dt.getId(),gt)})}},{key:"allowEntry",value:function(dt,gt){var Nt=this;return gt||(gt={}),new Promise(function(Vt,zt){if(Nt.status!==et.g.CONVERSATION_STATUS_JOINED)return zt(Wt.g.createError(et.g.ERROR_OTHER,"allowEntry() - conference not joined",Ln));if(!(dt instanceof No))return zt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"allowEntry() - parameter is not an instance of apiRTC.Contact",Ln));if(Nt.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR)return zt(Wt.g.createError(et.g.ERROR_UNAUTHORIZED,"allowEntry() - only moderator can allow entry to a contact",Ln));var Xt={roomname:Nt._getTechnicalName(),event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,access:!0,command:"access",value:{access:!0}};if(gt.hasOwnProperty("invitationId")&&(Xt.invitationId=gt.invitationId),gt.hasOwnProperty("answer")&&(Xt.answer=gt.answer),qn.sendData(dt.getId(),Xt).catch(function(on){var bn=Wt.g.createError(on,"Notification not delivered",Ln);nn.get(Nt).emit("messageNotDelivered",{error:bn,contact:dt,event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,command:"access"})}),gt.ackEnabled===!0){var Zt=setInterval(function(){Xt.command="access-new",qn.sendData(dt.getId(),Xt).catch(function(on){var bn=Wt.g.createError(on,"Notification not delivered",Ln);nn.get(Nt).emit("messageNotDelivered",{error:bn,contact:dt,event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,command:"access"})})},et.g.CONVERSATION_JOIN_REQUEST_INTERVAL);qn.onEvent("receiveData",function on(bn){var En=ro.getOrCreateContact(bn.detail.senderId);bn.detail.hasOwnProperty("data")&&bn.detail.data.command==="access-ack"&&bn.detail.data.roomname===Nt._getTechnicalName()&&En.getId()===dt.getId()&&(clearInterval(Zt),qn.removeEventListener("receiveData",on))})}return Vt()})}},{key:"denyEntry",value:function(dt,gt){var Nt=this;return gt||(gt={}),new Promise(function(Vt,zt){if(Nt.status!==et.g.CONVERSATION_STATUS_JOINED)return zt(Wt.g.createError(et.g.ERROR_OTHER,"denyEntry() - conference not joined",Ln));if(!(dt instanceof No))return zt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"denyEntry() - parameter is not an instance of apiRTC.Contact",Ln));if(Nt.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR)return zt(Wt.g.createError(et.g.ERROR_UNAUTHORIZED,"denyEntry() - only moderator can deny entry to a contact",Ln));var Xt={roomname:Nt._getTechnicalName(),event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,access:!1,command:"access",value:{access:!1}};return gt.hasOwnProperty("invitationId")&&(Xt.invitationId=gt.invitationId),gt.hasOwnProperty("answer")&&(Xt.answer=gt.answer),gt.hasOwnProperty("reason")&&(Xt.reason=gt.reason),qn.sendData(dt.getId(),Xt).catch(function(Zt){var on=Wt.g.createError(Zt,"Notification not delivered",Ln);nn.get(Nt).emit("messageNotDelivered",{error:on,contact:dt,event:et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,command:"access"})}),Vt()})}},{key:"sendJoinRequest",value:function(){var dt=this;if(this.status===et.g.CONVERSATION_STATUS_WAITING){if(!this.joinRequestIntervalId){var gt=Xp(this);gt&&(qn.sendData(gt,{roomname:this._getTechnicalName(),event:et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,invitationId:this._getTechnicalName(),sendTime:Date.now(),command:"userWaiting",value:{username:ju()}}).catch(function(Nt){var Vt=Wt.g.createError(Nt,"Notification not delivered",Ln);nn.get(dt).emit("messageNotDelivered",{error:Vt,contact:dt.getModerator(),event:et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,command:"userWaiting"})}),this.joinRequestIntervalId=setInterval(function(){qn.sendData(gt,{roomname:dt._getTechnicalName(),event:et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,invitationId:dt._getTechnicalName(),sendTime:Date.now(),command:"userWaiting-new",value:{username:ju()}}).catch(function(Nt){var Vt=Wt.g.createError(Nt,"Notification not delivered",Ln);nn.get(dt).emit("messageNotDelivered",{error:Vt,contact:dt.getModerator(),event:et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,command:"userWaiting-new"})})},et.g.CONVERSATION_JOIN_REQUEST_INTERVAL))}}else Ln.error("sendJoinRequest() - Not in conversation's waiting room, cannot send join request")}},{key:"leave",value:function(){var dt=this;return new Promise(function(gt,Nt){if(dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Nt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"leave() - webconf not joined",Ln));for(var Vt=Xl.get(dt),zt=0,Xt=Object.keys(Vt);zt<Xt.length;zt++){var Zt=Xt[zt];Ln.info("Session, removing apiRTCManager event :",Zt);var on=Vt[Zt];qn.removeEventListener(Zt,on)}var bn,En=co(dt.conversationStreams.keys());try{for(En.s();!(bn=En.n()).done;){var Gn=bn.value;Ln.trace("Leave() - unsubscribe to "+Gn),qn.webRTCClient!==null&&qn.webRTCClient.unsubscribe(Gn)}}catch(Kn){En.e(Kn)}finally{En.f()}Ql(dt,!1,!1).then(function(){}).catch(function(Kn){}),qn.webRTCClient!==null&&qn.IMClient.leaveGroupChat(dt._getTechnicalName()),dt.whiteboardStarted===et.g.CONVERSATION_WHITEBOARD_STARTED&&qn.whiteBoardClient.roomId===dt._getTechnicalName()&&(qn.whiteBoardClient.leaveRoom(),qn.whiteBoardClient.stop(),dt.whiteboardStarted=et.g.CONVERSATION_WHITEBOARD_NOT_STARTED),qn.webRTCClient!==null&&qn.webRTCClient.leaveMCUSession(),dt.conversationStreams=new Map,dt.status=et.g.CONVERSATION_STATUS_NOT_JOINED,nn.get(dt).emit("left"),gt()})}},{key:"subscribeToStream",value:function(dt,gt){var Nt=this;if(gt||(gt={}),Ln.debug("subscribeToMedia",dt),!this.isJoined())return Promise.reject(Wt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - conversation not joined",Ln));var Vt={};gt.turnServerAddress!==null&&gt.turnServerAddress!==void 0&&(Vt.turnServerAddress=gt.turnServerAddress),Wt.g.isPropertyTypeof(gt,"qos","object")&&(Vt.qos={},Wt.g.isPropertyTypeof(gt.qos,"videoForbidInactive","boolean")&&(Vt.qos.videoForbidInactive=gt.qos.videoForbidInactive));var zt=Number(dt),Xt=qn.webRTCClient.getStreamFromList(zt),Zt=this.conversationStreams.get(zt);if(!Xt||!Zt)return Promise.reject(Wt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - no such stream",Ln));if(Wt.g.isPropertyTypeof(gt,"simulcast","object")){var on=["high","medium","low"];Vt.simulcast={},gt.simulcast.streamQuality&&(on.indexOf(gt.simulcast.streamQuality)>=0?Vt.simulcast.streamQuality=gt.simulcast.streamQuality:Vt.simulcast.streamQuality="default"),gt.simulcast.streamFrameRate&&(on.indexOf(gt.simulcast.streamFrameRate)>=0?Vt.simulcast.streamFrameRate=gt.simulcast.streamFrameRate:Vt.simulcast.streamFrameRate="default")}return new Promise(function(bn,En){var Gn="VIDEO";if(Zt.hasVideo&&Nt.getNetworkCap({capacity:!0})&&Wt.g.isPropertyTypeof(Zt,"descriptor","object")){var Kn=Zt.descriptor;if(!Nt.reserveResources(Kn.profileType,Kn.bitrate,zt,!0,Kn.priority,{isVideoOnly:!Zt.hasAudio,isVideoMuted:gt.audioOnly,control:!0})&&!Nt.disableLowerPriorityVideo(!0,Kn.bitrate,Kn.priority)){if(!Zt.hasAudio)return En(Wt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - not enough bandwidth",Ln));gt.audioOnly=!0}Nt.reserveResources(Kn.profileType,Kn.bitrate,zt,!0,Kn.priority,{isVideoOnly:!Zt.hasAudio,isVideoMuted:gt.audioOnly})}gt.audioOnly===!0?Gn="AUDIOONLY":gt.videoOnly===!0&&(Gn="VIDEOONLY");var cr=qn.webRTCClient.subscribe([Xt],Gn,{},Vt,gt)[0];if(!cr)return Nt.releaseResources(zt),En(Wt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - stream not available",Ln));Nt.callIdToStreamId.set(cr,zt),Ln.debug("Subscribed to stream "+dt+" through call "+cr);var hr={streamAddedHandler:function(Ar){Ar.streamId===zt&&(Nt.removeListener("streamAdded",hr.streamAddedHandler),Nt.removeListener("error",hr.errorHandler),bn(Ar))}};Nt.on("streamAdded",hr.streamAddedHandler),hr.errorHandler=function(Ar){Ar.callId===cr&&(Nt.removeListener("streamAdded",hr.streamAddedHandler),Nt.removeListener("error",hr.errorHandler),Nt.releaseResources(zt),En(Wt.g.createError(et.g.ERROR_OTHER,"subscribeToMedia() - "+Ar.errorInfo,Ln)))},Nt.on("error",hr.errorHandler)})}},{key:"updateSubscribedStream",value:function(dt,gt){gt||(gt={});var Nt=Number(dt);if(!Mo.get(this).has(Nt))return Ln.error("updateSubscribedStream() - Conversation stream "+dt+" does not exist or was not subscribed to"),Promise.reject("wrong streamId");var Vt=Mo.get(this).get(Nt);if(Wt.g.isTypeof(gt.simulcast,"object"))return qn.webRTCClient.webRTCClient.updateSimulcastFeedOnCall(Vt.callId,gt.simulcast);var zt="VIDEO";return gt.audioOnly===!0?zt="AUDIOONLY":gt.videoOnly===!0&&(zt="VIDEOONLY"),qn.webRTCClient.webRTCClient.updateMediaTypeOnCall(Vt.callId,zt)}},{key:"unsubscribeToStream",value:function(dt,gt){gt||(gt={});var Nt=Number(dt);qn.webRTCClient!==null&&qn.webRTCClient.unsubscribe(Nt);var Vt=!gt.noTriggerAdaptation;this.releaseResources(dt,{isRemote:!0,triggerAdaptation:Vt})}},{key:"subscribeToMedia",value:function(dt,gt){return this.subscribeToStream(dt,gt)}},{key:"unsubscribeToMedia",value:function(dt){this.unsubscribeToStream(dt)}},{key:"startRecording",value:function(dt){var gt=this;return dt||(dt={}),new Promise(function(Nt,Vt){if(gt.status!==et.g.CONVERSATION_STATUS_JOINED)return Vt(Wt.g.createError(et.g.ERROR_OTHER,"startRecording() - conversation not joined",Ln));if(gt.asyncCallbacks)return Vt(Wt.g.createError(et.g.ERROR_OTHER,"startRecording() - busy",Ln));gt.asyncCallbacks={},gt.asyncCallbacks.timeoutId=setTimeout(function(){return gt.asyncCallbacks&&(qn.removeEventListener("error",gt.asyncCallbacks.error),qn.removeEventListener("MCURecordingStarted",gt.asyncCallbacks.recordingStarted),delete gt.asyncCallbacks),Vt(Wt.g.createError(et.g.ERROR_OTHER,"startRecording() - timeout",Ln))},et.g.CONVERSATION_RECORDING_STARTED_DELAY),gt.asyncCallbacks.error=function(on){if(String(on.detail.convId)===gt.getCloudConversationId()&&on.detail.callId==="COMPOSITE"&&on.detail.errorCode.indexOf("START_RECORD")>=0)return gt.asyncCallbacks&&(qn.removeEventListener("error",gt.asyncCallbacks.error),qn.removeEventListener("MCURecordingStarted",gt.asyncCallbacks.recordingStarted),clearTimeout(gt.asyncCallbacks.timeoutId),delete gt.asyncCallbacks),Vt(Wt.g.createError(et.g.ERROR_OTHER,"startRecording() - "+on.detail.errorInfo,Ln))},gt.asyncCallbacks.recordingStarted=function(on){if(String(on.detail.convId)===gt.getCloudConversationId()&&on.detail.callId==="COMPOSITE"){gt.asyncCallbacks&&(qn.removeEventListener("error",gt.asyncCallbacks.error),qn.removeEventListener("MCURecordingStarted",gt.asyncCallbacks.recordingStarted),clearTimeout(gt.asyncCallbacks.timeoutId),delete gt.asyncCallbacks);var bn=Wt.g.parseRecordingEvent("MCURecordingStarted",on.detail);return Nt(bn)}},qn.onEvent("error",gt.asyncCallbacks.error),qn.onEvent("MCURecordingStarted",gt.asyncCallbacks.recordingStarted);var zt="AUDIO-VIDEO";dt.audioOnly===!0?zt="AUDIO-ONLY":dt.videoOnly===!0&&(zt="VIDEO-ONLY");var Xt="composite";Wt.g.isPropertyTypeof(dt,"customIdInFilename","string")&&(Xt=dt.customIdInFilename);var Zt={};Wt.g.isPropertyTypeof(dt,"data","object")&&(Zt=Wt.g.assignObject({},dt.data)),["complete","efficient","audioOnly"].indexOf(dt.mode)>=0?Zt.mode=dt.mode:Zt.mode="complete",Zt.labelEnabled=dt.labelEnabled===!0,Zt.labelEnabled===!0&&(Zt.labels=[],Wt.g.isTypeof(dt.labels,"array")&&dt.labels.forEach(function(on){Wt.g.isTypeof(on,"string")&&Zt.labels.push(on)})),Wt.g.isTypeof(dt,"ttl","number")&&dt.ttl>0&&(Zt.ttl=dt.ttl),qn.webRTCClient.startCompositeRecording(zt,Xt,gt.getCloudConversationId(),Zt)})}},{key:"stopRecording",value:function(){var dt=this;return new Promise(function(gt,Nt){if(dt.asyncCallbacks)return Nt(Wt.g.createError(et.g.ERROR_OTHER,"stopRecording() - busy",Ln));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(qn.removeEventListener("error",dt.asyncCallbacks.error),qn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),delete dt.asyncCallbacks),gt(dt.recordingStatus)},et.g.CONVERSATION_RECORDING_STOPPED_DELAY),dt.asyncCallbacks.error=function(Vt){if(String(Vt.detail.convId)===dt.getCloudConversationId()&&Vt.detail.callId==="COMPOSITE"&&Vt.detail.errorCode.indexOf("STOP_RECORD")>=0)return dt.asyncCallbacks&&(qn.removeEventListener("error",dt.asyncCallbacks.error),qn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Nt(Wt.g.createError(et.g.ERROR_OTHER,"stopRecording() - "+Vt.detail.errorInfo,Ln))},dt.asyncCallbacks.recordingStopped=function(Vt){if(String(Vt.detail.convId)===dt.getCloudConversationId()&&Vt.detail.callId==="COMPOSITE"){dt.asyncCallbacks&&(qn.removeEventListener("error",dt.asyncCallbacks.error),qn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var zt=Wt.g.parseRecordingEvent("MCURecordingStopped",Vt.detail);return gt(zt)}},qn.onEvent("error",dt.asyncCallbacks.error),qn.onEvent("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),qn.webRTCClient.stopCompositeRecording()})}},{key:"getContacts",value:function(){Ln.debug("getContacts()");var dt={};if(this.isBound()){var gt,Nt=Ro.get().getContacts(this._getTechnicalName()),Vt=co(Nt.keys());try{for(Vt.s();!(gt=Vt.n()).done;){var zt=gt.value;dt[zt]=Nt.get(zt)}}catch(Xt){Vt.e(Xt)}finally{Vt.f()}}else Ln.warn("getContacts() - Cannot get contacts as conversation is not joined");return dt}},{key:"getContactsArray",value:function(){Ln.debug("getContactsArray()");var dt=[];if(this.isBound()){var gt,Nt=Ro.get().getContacts(this._getTechnicalName()),Vt=co(Nt.keys());try{for(Vt.s();!(gt=Vt.n()).done;){var zt=gt.value;dt.push(Nt.get(zt))}}catch(Xt){Vt.e(Xt)}finally{Vt.f()}}else Ln.warn("getContacts() - Cannot get contacts as conversation is not joined");return dt}},{key:"getContactsNumber",value:function(){Ln.debug("getContactsNumber()");var dt=0;return this.isBound()?dt=Ro.get().getContacts(this._getTechnicalName()).size:Ln.warn("getContactsNumber() - Cannot get contacts as conversation is not joined"),dt}},{key:"getData",value:function(){return Ln.debug("getData()"),this.isBound()||Ln.warn("getData() - Cannot get most recent data as conversation is not joined, you may want to call Conversation.updateData() instead"),qo.get(this)}},{key:"setData",value:function(dt){var gt=this;return new Promise(function(Nt,Vt){gt.bind().then(function(){return Eo.setConversationData(Po.get(gt),JSON.stringify(dt),qn.getActiveApiKey(),{token:wo.get(gt).token})}).then(function(){qo.set(gt,dt),qn.dataClient.sendDataToGroup(gt._getTechnicalName(),{event:et.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER,roomname:gt._getTechnicalName()}),Nt()}).catch(function(){Vt(Wt.g.createError(et.g.ERROR_OTHER,"setData() - cannot set conversation data",Ln))})})}},{key:"updateData",value:function(){var dt=this;return new Promise(function(gt,Nt){(dt.isBound()?Fu(dt):dt.bind()).then(function(){gt(),nn.get(dt).emit("persistentDataUpdated",qo.get(dt))}).catch(function(Vt){Nt(Wt.g.createError(et.g.ERROR_OTHER,"updateData() - cannot update conversation data",Ln,{fromError:Vt}))})})}},{key:"getAvailableMediaList",value:function(){return Ln.warn("Function deprecated, please use Conversation.getAvailableStreamList() instead"),this.getAvailableStreamList()}},{key:"getAvailableStreamList",value:function(){var dt,gt=[],Nt=co(this.conversationStreams.keys());try{for(Nt.s();!(dt=Nt.n()).done;){var Vt=dt.value;gt.push(this.conversationStreams.get(Vt))}}catch(zt){Nt.e(zt)}finally{Nt.f()}return gt}},{key:"getStreamInfo",value:function(dt){return this.conversationStreams.get(dt)}},{key:"getSubscribedStream",value:function(dt){return Mo.get(this).get(Number(dt))}},{key:"linkWhiteboardClientToConversation",value:function(){Ln.warn("DEPRECATED : linkWhiteboardClientToConversation : no more needed")}},{key:"startNewWhiteboardSession",value:function(dt,gt){var Nt=this;return Ln.debug("startNewWhiteboardSession()"),new Promise(function(Vt,zt){Nt.bind().then(function(){if(Nt.asyncCallbacks)return zt(Wt.g.createError(et.g.ERROR_OTHER,"startNewWhiteboardSession() - busy",Ln));if(Nt.whiteboardStarted!==et.g.CONVERSATION_WHITEBOARD_NOT_STARTED)return Vt();qn.whiteBoardClient.start(),Nt.asyncCallbacks={},Nt.asyncCallbacks.ackHandler=function(Zt){var on=Zt.detail;on.roomId===Nt._getTechnicalName()&&on.roomType==="whiteBoard"&&(on.eventType==="roomCreation"&&on.status==="roomCreated"||on.eventType==="roomJoined"&&on.status==="roomJoined")&&(Nt.asyncCallbacks&&(qn.removeEventListener("roomCreation",Nt.asyncCallbacks.ackHandler),qn.removeEventListener("roomJoined",Nt.asyncCallbacks.ackHandler),clearTimeout(Nt.asyncCallbacks.timeoutId),delete Nt.asyncCallbacks),qn.whiteBoardClient.setCanvas(dt),gt!=null&&qn.whiteBoardClient.setUserCursorColor(gt),qn.whiteBoardClient.deleteHistory(),Nt.whiteboardStarted=et.g.CONVERSATION_WHITEBOARD_STARTED,Vt())},qn.onEvent("roomCreation",Nt.asyncCallbacks.ackHandler),qn.onEvent("roomJoined",Nt.asyncCallbacks.ackHandler),Nt.asyncCallbacks.timeoutId=setTimeout(function(){return Nt.asyncCallbacks&&(qn.removeEventListener("roomCreation",Nt.asyncCallbacks.ackHandler),qn.removeEventListener("roomJoined",Nt.asyncCallbacks.ackHandler),delete Nt.asyncCallbacks),zt(Wt.g.createError(et.g.ERROR_OTHER,"startNewWhiteboardSession() - timeout",Ln))},et.g.CONVERSATION_WHITEBOARD_START_DELAY);var Xt=Nt.getCloudConversationId();qn.whiteBoardClient.joinRoom(Nt._getTechnicalName(),{convId:Xt,webconf:!0})}).catch(function(Xt){zt(Wt.g.createError(et.g.ERROR_OTHER,"startNewWhiteboardSession() - cannot start whiteboard session",Ln,{fromError:Xt}))})})}},{key:"stopNewWhiteboardSession",value:function(){var dt=this;return Ln.debug("stopNewWhiteboardSession()"),new Promise(function(gt,Nt){dt.bind().then(function(){return dt.whiteboardStarted!==et.g.CONVERSATION_WHITEBOARD_STARTED?(Ln.error("Conversation is not joined!"),Nt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"stopWhiteBoard() - Conversation not joined",Ln))):qn.whiteBoardClient.roomId!==dt._getTechnicalName()?(Ln.error("Whiteboard session is not joined for this conversation!"),Nt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"stopWhiteBoard() - whiteboard not joined",Ln))):(qn.whiteBoardClient.leaveRoom(),qn.whiteBoardClient.stop(),dt.whiteboardStarted=et.g.CONVERSATION_WHITEBOARD_NOT_STARTED,void gt())}).catch(function(Vt){Nt(Wt.g.createError(et.g.ERROR_OTHER,"stopNewWhiteboardSession() - cannot stop whiteboard session",Ln,{fromError:Vt}))})})}},{key:"enablePointerSharing",value:function(dt){return Ql(this,!0,dt)}},{key:"sendPointerLocation",value:function(dt,gt,Nt,Vt){qn.pointerSharingClient.sendPointerLocation(this._getTechnicalName(),dt,gt,Nt,Vt)}},{key:"sendData",value:function(dt){var gt=this;return new Promise(function(Nt,Vt){gt.bind().then(function(){qn.dataClient.sendDataToGroup(gt._getTechnicalName(),{event:et.g.CONVERSATION_SEND_DATA_IDENTIFIER,content:dt,roomname:gt._getTechnicalName()}),Nt()}).catch(function(zt){Vt(Wt.g.createError(et.g.ERROR_OTHER,"sendData() - cannot send data",Ln))})})}},{key:"sendRawData",value:function(dt){var gt=this;return new Promise(function(Nt,Vt){gt.bind().then(function(){qn.dataClient.sendDataToGroup(gt._getTechnicalName(),dt),Nt()}).catch(function(zt){Vt(Wt.g.createError(et.g.ERROR_OTHER,"sendRawData() - cannot send data",Ln))})})}},{key:"sendCustomEvent",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){gt.bind().then(function(){var Xt=Nt;Xt.event=dt,Xt.roomname=gt._getTechnicalName(),qn.dataClient.sendDataToGroup(gt._getTechnicalName(),Xt),Vt()}).catch(function(Xt){zt(Wt.g.createError(et.g.ERROR_OTHER,"sendCustomEvent() - cannot send data",Ln))})})}},{key:"sendMessage",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=function(zt){return new Promise(function(Xt,Zt){var on=wo.get(gt);on!==null?Eo.saveGroupChatMessage(gt,on,qn.getActiveApiKey(),dt,zt,Nt).then(function(){Xt(zt)}).catch(Zt):Xt(zt)})};return new Promise(function(zt,Xt){if(gt.groupChatStatus!==et.g.CONVERSATION_STATUS_JOINED&&gt.status!==et.g.CONVERSATION_STATUS_JOINED)return Xt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"sendMessage() - group chat not joined",Ln));if(dt===null||typeof dt!="string")return Xt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"sendMessage() - wrong type of message",Ln));if(dt==="")return Xt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"sendMessage() - message parameter is empty",Ln));var Zt={};Wt.g.isTypeof(Nt,"metadata","object")&&(Zt.metadata=Nt.metadata),qn.sendMessageToGroupChat(gt._getTechnicalName(),dt,Zt).then(function(on){Vt(on).then(function(){zt(on)}).catch(function(bn){Xt(Wt.g.createError(et.g.ERROR_OTHER,"sendMessage() - error on save",Ln,{fromError:bn}))})}).catch(function(on){Xt(Wt.g.createError(et.g.ERROR_OTHER,"sendMessage() - cannot send message",Ln,{fromError:on}))})})}},{key:"pushMedia",value:function(dt,gt){var Nt=this;return gt||(gt={}),new Promise(function(Vt,zt){Nt.bind().then(function(){return gt.hasOwnProperty("token")||(gt.token=wo.get(Nt).token),Eo.pushConversationMedia(Po.get(Nt),dt,qn.getActiveApiKey(),gt)}).then(function(Xt){qn.dataClient.sendDataToGroup(Nt._getTechnicalName(),{event:et.g.CONVERSATION_NEW_MEDIA_IDENTIFIER,roomname:Nt._getTechnicalName(),media:{url:Xt.url,id:Xt.id},command:"new_snapshot",value:{snapshot:Xt.url}}),Vt({url:Xt.url,id:Xt.id})}).catch(function(Xt){zt(Wt.g.createError(et.g.ERROR_OTHER,"pushMedia() - cannot push media",Ln,{fromError:Xt}))})})}},{key:"pushData",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Nt=Wt.g.assignObject({},Nt),new Promise(function(Vt,zt){if(qn.webRTCClient.webRTCClient.dataChannelCapable!==!0||Nt.forceHTTP===!0){if(!dt.file)return zt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"pushData() - missing file",Ln));var Xt={};if(Wt.g.isTypeof(dt,"metadata","object"))try{Xt.metadata=JSON.stringify(dt.metadata)}catch(Zt){Ln.error("JSON.stringify",Zt)}Xt.asFile=!0,Wt.g.isTypeof(dt,"filename","string")?Xt.filename=dt.filename:Xt.filename=dt.file.name,dt.overwrite===!0&&(Xt.overwrite=!0),Wt.g.isTypeof(dt,"ttl","number")&&dt.ttl>0&&(Xt.ttl=dt.ttl),gt.pushMedia(dt.file,Xt).then(Vt).catch(zt)}else gt.bind().then(function(){var Zt=gt._getTechnicalName(),on={};Nt.hasOwnProperty("turnServerAddress")&&(on.turnServerAddress=Nt.turnServerAddress,delete Nt.turnServerAddress);var bn=qn.webRTCClient.webRTCClient.pushData(gt.getCloudConversationId(),dt,on,{success:function(En){if(En.state!=="complete")return zt(Wt.g.createError(et.g.ERROR_OTHER,"pushData() - cannot push data",Ln));qn.dataClient.sendDataToGroup(Zt,{event:et.g.CONVERSATION_NEW_MEDIA_IDENTIFIER,roomname:Zt,media:{url:En.mediaURL,id:En.mediaId},command:"new_snapshot",value:{snapshot:En.mediaURL}}),Vt({url:En.mediaURL,id:En.mediaId})},failure:function(En,Gn){if(En==="iceFailed"){var Kn=Wt.g.assignObject({},Nt);return Kn.forceHTTP=!0,void gt.pushData(dt,Kn).then(Vt).catch(zt)}if(En==="timeout"){if(Gn){var cr=gt.transferCallIds.indexOf(Gn);cr>=0&&gt.transferCallIds.splice(cr,1)}return zt(Wt.g.createError(et.g.ERROR_TIMED_OUT,"pushData() - push data timed out",Ln))}return zt(En==="canceled"?Wt.g.createError(et.g.ERROR_OPERATION_CANCELED,"pushData() - push data canceled",Ln):Wt.g.createError(et.g.ERROR_OTHER,"pushData() - cannot push data",Ln,{fromError:En}))}});if(!bn)return zt(Wt.g.createError(et.g.ERROR_OTHER,"pushData() - cannot push data",Ln));gt.transferCallIds.push(bn)}).catch(function(Zt){return zt(Wt.g.createError(et.g.ERROR_OTHER,"pushData() - cannot push data",Ln,{fromError:Zt}))})})}},{key:"cancelPushData",value:function(dt){var gt=this;return new Promise(function(Nt,Vt){if(!gt.transferCallIds.includes(dt))return Vt(Wt.g.createError(et.g.ERROR_OTHER,"cancelPushData() - no such push data",Ln));var zt=qn.webRTCClient.webRTCClient.cancelPushData(dt);if(zt)return Vt(Wt.g.createError(et.g.ERROR_OTHER,"cancelPushData() - "+zt,Ln));Nt()})}},{key:"fetchMediaList",value:function(dt,gt){var Nt=this;return gt||(gt={}),new Promise(function(Vt,zt){Nt.bind().then(function(){return Object.prototype.hasOwnProperty.call(gt,"token")||(Wt.g.isTypeof(dt,"object")&&dt instanceof Br?gt.token=dt.getToken():gt.token=wo.get(Nt).token),Eo.getConversationMediaList(Po.get(Nt),qn.getActiveApiKey(),gt)}).then(Vt).catch(function(Xt){zt(Wt.g.createError(et.g.ERROR_OTHER,"fetchMediaList() - cannot fetch media list",Ln,{fromError:Xt}))})})}},{key:"getWaitingRoomContacts",value:function(){Ln.debug("getWaitingRoomContacts()");var dt={};if(this.status!==et.g.CONVERSATION_STATUS_JOINED)Ln.error("getWaitingRoomContacts() - Conversation is not joined, cannot get waiting room contacts");else if(this.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR)Ln.error("getWaitingRoomContacts() - Role is not moderator, cannot get waiting room contacts");else{var gt,Nt=Ro.get().getContacts(et.g.CONVERSATION_WAITING_ROOM_PREFIX+this._getTechnicalName()),Vt=co(Nt.keys());try{for(Vt.s();!(gt=Vt.n()).done;){var zt=gt.value;dt[zt]=Nt.get(zt)}}catch(Xt){Vt.e(Xt)}finally{Vt.f()}}return dt}},{key:"fetchMessageHistory",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){gt.bind().then(function(){return Object.prototype.hasOwnProperty.call(Nt,"token")?Eo.loadGroupChatMessages(gt,null,Nt.token):(Wt.g.isTypeof(dt,"object")&&dt instanceof Br||(dt=wo.get(gt)),Eo.loadGroupChatMessages(gt,dt))}).then(function(Xt){var Zt=Xt.map(function(on){var bn={content:on.content,timestamp:1e3*on.created_at,date:new Date(1e3*on.created_at),sender_id:on.user_id,display_name:on.display_name};return on.user_id.toString()!==dt.getId()&&(bn.sender=dt.getOrCreateContact(on.user_id)),bn});Vt(Zt)}).catch(function(Xt){zt(Wt.g.createError(et.g.ERROR_OTHER,"fetchMessageHistory() - cannot fetch message history",Ln))})})}},{key:"sendInvitation",value:function(dt,gt){var Nt=this;if(gt||(gt={}),dt instanceof No){Ln.info("Invite "+dt.getId()+" to "+this._getTechnicalName()),dt.isOnline()||Ln.warn("sendInvitation() - contact "+dt.getUsername()+" does not seem to be connected.");var Vt={receiveNotifier:new ht};gt.hasOwnProperty("expirationTime")&&(Vt.expirationTime=gt.expirationTime);var zt=new Do(dt,this,Vt);zt.type="conversation";var Xt={event:et.g.CONVERSATION_INVITATION_IDENTIFIER,invitationId:zt.id,roomname:this._getTechnicalName(),sendTime:zt.sendTime,conversationTypes:[]};return this.status===et.g.CONVERSATION_STATUS_JOINED?Xt.conversationTypes.push("WEBCONF"):this.groupChatStatus===et.g.CONVERSATION_STATUS_JOINED&&Xt.conversationTypes.push("GROUP_CHAT"),qn.sendData(dt.getId(),Xt).then(function(){Vt.receiveNotifier.emit("receive")}).catch(function(Zt){var on=Wt.g.createError(Zt,"Invitation not delivered",Ln);nn.get(Nt).emit("messageNotDelivered",{error:on,contact:dt,event:et.g.CONVERSATION_INVITATION_IDENTIFIER})}),zt}return Ln.error("Parameter is not a contact"),null}},{key:"isRecorded",value:function(){return!!this.recordingStatus}},{key:"getRecordingInfo",value:function(){return this.isRecorded()?this.recordingStatus:null}},{key:"setNetworkCap",value:function(dt,gt){return typeof dt!="number"||typeof gt!="number"?(Ln.error("setNetworkCap - wrong cap",dt,gt),!1):dt<=0||gt<=0?(this.uploadCap=null,this.downloadCap=null,!0):(this.uploadCap=dt,this.downloadCap=gt,!0)}},{key:"getNetworkCap",value:function(){var dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.uploadCap||!this.downloadCap)return null;if(dt.capacity)return[this.uploadCap,this.downloadCap];for(var gt=this.uploadCap,Nt=this.downloadCap,Vt=this.reservedStreams.length;--Vt>=0;)this.reservedStreams[Vt].isVideoMuted||(this.reservedStreams[Vt].isRemote?Nt-=this.reservedStreams[Vt].resource:gt-=this.reservedStreams[Vt].resource);return[gt,Nt]}},{key:"getStreamResourceReservation",value:function(dt){for(var gt=this.reservedStreams.length;--gt>=0;)if(this.reservedStreams[gt].streamId===dt)return this.reservedStreams[gt];return null}},{key:"reserveResources",value:function(dt,gt,Nt,Vt,zt){var Xt=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(Ln.debug("reserveResources",Nt),this.getStreamResourceReservation(Nt))throw new Error("reserveResources - already reserved stream");var Zt=!1,on={streamId:Nt,profileType:dt,priority:zt,resource:gt,isRemote:Vt};if(on.isVideoOnly=!!Xt.isVideoOnly,Xt.isVideoMuted)on.isVideoMuted=!0,Zt=!0;else{on.isVideoMuted=!1;var bn=this.getNetworkCap();Zt=Vt?bn[1]>=on.resource:bn[0]>=on.resource}if(Xt.control)return Zt;if(!Zt)throw new Error("reserveResources - no such bandwidth availability");return this.reservedStreams.push(on),this.reservedStreams.sort(function(En,Gn){return En.priority>Gn.priority?-1:En.priority===Gn.priority?0:1}),Ln.debug("reservedStreams",this.reservedStreams),!0}},{key:"releaseResources",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.getNetworkCap({capacity:!0}))return!1;Ln.debug("releaseResources",dt);for(var Nt=!1,Vt=this.reservedStreams.length;--Vt>=0;)if(this.reservedStreams[Vt].streamId===dt){this.reservedStreams.splice(Vt,1),Nt=!0;break}return Ln.debug("reservedStreams",this.reservedStreams),Nt&&gt.triggerAdaptation&&this.enableHigherPriorityVideo(!!gt.isRemote),Nt}},{key:"changeStreamPriority",value:function(dt,gt,Nt){Ln.debug("changeStreamPriority",dt,gt,Nt);for(var Vt=null,zt=this.reservedStreams.length;--zt>=0;)if(this.reservedStreams[zt].isRemote===gt&&this.reservedStreams[zt].streamId===dt){Vt=this.reservedStreams[zt];break}return!(!Vt||Vt.priority===Nt||(Vt.priority=Nt,this.reservedStreams.sort(function(Xt,Zt){return Xt.priority>Zt.priority?-1:Xt.priority===Zt.priority?0:1}),Ln.debug("reservedStreams",this.reservedStreams),Vt.isVideoMuted?this.disableLowerPriorityVideo(Vt.isRemote,Vt.resource,Vt.priority)&&zu(this,Vt):this.enableHigherPriorityVideo(Vt.isRemote,{resource:Vt.resource,priority:Vt.priority,control:!0})&&(Vu(this,Vt),this.enableHigherPriorityVideo(Vt.isRemote)),0))}},{key:"disableLowerPriorityVideo",value:function(dt,gt,Nt){Ln.debug("disableLowerPriorityVideo",dt,gt,Nt);for(var Vt=[],zt=0,Xt=this.reservedStreams.length;--Xt>=0&&(this.reservedStreams[Xt].isRemote!==dt||this.reservedStreams[Xt].isVideoMuted||this.reservedStreams[Xt].priority>=Nt||(Vt.push(this.reservedStreams[Xt]),!((zt+=this.reservedStreams[Xt].resource)>=gt))););if(Vt.length===0||zt<gt)return!1;for(var Zt=Vt.length;--Zt>=0;)Vu(this,Vt[Zt]);return!0}},{key:"enableHigherPriorityVideo",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ln.debug("enableHigherPriorityVideo",dt);var Nt=this.getNetworkCap(),Vt=dt?Nt[1]:Nt[0];gt.resource&&gt.resource>0&&(Vt+=gt.resource);for(var zt=[],Xt=0;Xt<this.reservedStreams.length;Xt+=1)this.reservedStreams[Xt].isRemote===dt&&this.reservedStreams[Xt].isVideoMuted&&(Object.prototype.hasOwnProperty.call(gt,"priority")&&this.reservedStreams[Xt].priority<=gt.priority||this.reservedStreams[Xt].resource<=Vt&&(Vt-=this.reservedStreams[Xt].resource,zt.push(this.reservedStreams[Xt])));if(zt.length===0)return!1;if(gt.control)return!0;for(var Zt=zt.length;--Zt>=0;)zu(this,zt[Zt]);return!0}},{key:"startComposite",value:function(){var dt=this;return new Promise(function(gt,Nt){if(dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Nt(Wt.g.createError(et.g.ERROR_OTHER,"startComposite() - conversation not joined",Ln));qn.webRTCClient.startComposite(dt._getTechnicalName()),gt()})}},{key:"stopComposite",value:function(){var dt=this;return new Promise(function(gt,Nt){if(dt.status!==et.g.CONVERSATION_STATUS_JOINED)return Nt(Wt.g.createError(et.g.ERROR_OTHER,"stopComposite() - conversation not joined",Ln));qn.webRTCClient.stopComposite(dt._getTechnicalName()),gt()})}},{key:"callVoIP",value:function(dt){var gt=this;return new Promise(function(Nt,Vt){return dt&&typeof dt=="string"?gt.status!==et.g.CONVERSATION_STATUS_JOINED?Vt(Wt.g.createError(et.g.ERROR_OTHER,"callVoIP() - conversation not joined",Ln)):void qn.webRTCClient.webRTCClient.MCUClient.inviteVoIP(gt._getTechnicalName(),gt.getCloudConversationId(),dt).then(Nt).catch(function(zt){Vt(Wt.g.createError(et.g.ERROR_OTHER,"callVoIP() - "+zt.message,Ln))}):Vt(Wt.g.createError(et.g.ERROR_OTHER,"callVoIP() - wrong phoneNumber",Ln))})}},{key:"manageDisconnectionWarningEvent",value:function(dt){Ln.debug("manageDisconnectionWarningEvent",dt.detail);var gt={};if(this.callIdToStreamId.has(dt.detail.callId)){Ln.debug("call is linked with conversation");var Nt=this.callIdToStreamId.get(dt.detail.callId);gt=dt.detail.settingUpType==="publish"||dt.detail.settingUpType==="shareScreen"?this.conversationPublishedStreams.get(Nt):this.conversationStreams.get(Nt),nn.get(this).emit("disconnectionWarning",{streamInfo:gt})}else Ln.debug("call is not linked with conversation")}},{key:"manageErrorEvent",value:function(dt){if(Ln.debug("manageErrorEvent",dt.detail),dt.detail.errorCode==="DISTANT_ICE_CONNECTION_STATE_DISCONNECTED"||dt.detail.errorCode==="DISTANT_ICE_CONNECTION_STATE_FAILED")nn.get(this).emit("error",{errorCode:dt.detail.errorCode,errorInfo:dt.detail.errorInfo,descriptor:dt.detail.data});else if(this.callIdToStreamId.has(dt.detail.callId)){Ln.debug("call is linked with conversation");var gt=this.callIdToStreamId.get(dt.detail.callId),Nt={streamInfo:dt.detail.settingUpType==="publish"?this.conversationPublishedStreams.get(gt):this.conversationStreams.get(gt),errorCode:dt.detail.errorCode,errorInfo:dt.detail.errorInfo,callId:dt.detail.callId,streamId:gt};if(dt.detail.data&&(Nt.descriptor=dt.detail.data),nn.get(this).emit("error",Nt),Yp.has(dt.detail.errorCode)){var Vt=this.conversationCalls.get(dt.detail.callId);Vt?this.unpublish(Vt.stream):(this.unsubscribeToStream(gt),dt.detail.errorCode==="CALL_ABORTED"&&this.callIdToStreamId.delete(dt.detail.callId))}}else Ln.debug("call is not linked with conversation")}}],kt=[{key:"getAvailableEvents",value:function(){return Jp}}],Yt&&Uu(Lt.prototype,Yt),kt&&Uu(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(fn),ju=function(){var $t="guest";if(apiRTC.userAgentInstance){var Lt=apiRTC.userAgentInstance.getUsername();Lt&&($t=Lt)}return $t},Fu=function($t){var Lt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Yt,kt){var jt=null;if(Wt.g.isPropertyTypeof(Lt,"session","object")&&Lt.session instanceof Br)jt=Lt.session;else{if(Br.getActiveSession()===null)return kt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"getOrCreateConversation() - missing session",Ln));jt=Br.getActiveSession()}var sn={};sn.token=jt.getToken(),sn.active=$t.active,Eo.getOrCreateConversation($t,qn.getActiveApiKey(),sn).then(function(ln){Wt.g.isTypeof(ln,"public_id","string")&&(ln.id=ln.public_id,delete ln.public_id),Po.set($t,ln.id),qo.set($t,ln.data),Wt.g.isTypeof(ln.typeString,"string")&&$u.has(ln.typeString)&&ns.set($t,ln.typeString),wo.set($t,jt),Yt(ln)}).catch(function(ln){Po.set($t,null),qo.set($t,null),ns.set($t,null),kt(Wt.g.createError(et.g.ERROR_HTTP,"getOrCreateConversation() - cannot get/create conversation",Ln,{fromError:ln}))})})},Xp=function($t){var Lt=$t.getModerator();return Lt?Lt.getId():!$t.conference&&$t.moderationEnabled?"#":null},Qp=function($t,Lt){return new Promise(function(Yt,kt){if($t.conference){if(Lt.access===et.g.CONVERSATION_ACCESS_GRANTED)return Yt(Lt);if(Lt.access!==et.g.CONVERSATION_NEED_MODERATOR_ACCEPTATION)return kt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"You were not allowed to join the conference"));var jt=ro.getOrCreateContact(Lt.moderator);Ns.set($t,jt),Wu($t).then(function(){Yt(Lt)}).catch(kt)}else{if(!$t.moderationEnabled)return Yt(Object.assign(Lt,{access:et.g.CONVERSATION_ACCESS_GRANTED,role:et.g.CONVERSATION_ROLE_GUEST}));if($t.moderator)return Yt(Object.assign(Lt,{access:et.g.CONVERSATION_ACCESS_GRANTED,role:et.g.CONVERSATION_ROLE_MODERATOR}));Wu($t).then(function(){Yt(Object.assign(Lt,{access:et.g.CONVERSATION_NEED_MODERATOR_ACCEPTATION,role:et.g.CONVERSATION_ROLE_GUEST}))}).catch(kt)}})},Wu=function($t){return new Promise(function(Lt,Yt){var kt=$t.getModerator();$t.status=et.g.CONVERSATION_STATUS_WAITING;var jt=!1,sn=setTimeout(function(){qn.apiRTCSession.joinPresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+$t._getTechnicalName()],{doneByApiRTC:!0}),jt=!0},et.g.JOIN_WAITING_ROOM_PRESENCE_GROUP_TIMEOUT);kt&&nn.get($t).emit("waitingForModeratorAcceptance",kt);var ln=new Do(kt,$t);ln.id=$t._getTechnicalName(),ln.type=$t.conference?"conference":"conversation",$t.sendJoinRequest();var Kt=function dt(gt){Ln.debug("dataMessage (waitingRoom)",gt.detail);var Nt=gt.detail.data;if(Nt.roomname===$t._getTechnicalName()){var Vt=gt.detail.senderId.toString();Nt.command==="access"||Nt.command==="access-new"||Nt.event===et.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER?(delete $t.cancelJoin0,$t.joinRequestIntervalId&&(clearInterval($t.joinRequestIntervalId),delete $t.joinRequestIntervalId),qn.removeEventListener("receiveData",dt),jt===!0?qn.apiRTCSession.leavePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+$t._getTechnicalName()],{doneByApiRTC:!0}):sn&&clearTimeout(sn),Nt.value.hasOwnProperty("access")&&Nt.value.access||Nt.access?(qn.sendData(Vt,{roomname:$t._getTechnicalName(),command:"access-ack"}).catch(function(zt){var Xt=Wt.g.createError(zt,"Notification not delivered",Ln);nn.get($t).emit("messageNotDelivered",{error:Xt,contact:kt,command:"access-ack"})}),Lt()):($t.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Yt(Wt.g.createError(et.g.ERROR_NOT_ALLOWED,"You were not allowed to join the conversation",Ln)))):Nt.event===et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER&&Nt.roomname===$t._getTechnicalName()&&nn.get($t).emit("moderatorConnected",ro.getOrCreateContact(Vt))}};qn.onEvent("receiveData",Kt),ln.onResponse(function(dt){qn.removeEventListener("receiveData",Kt),jt===!0?qn.apiRTCSession.leavePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+$t._getTechnicalName()]):sn&&clearTimeout(sn),dt===et.g.INVITATION_STATUS_ACCEPTED?Lt():($t.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Yt(Wt.g.createError(et.g.ERROR_NOT_ALLOWED,"You were not allowed to join the conversation",Ln)))}),$t.cancelJoin0=function(){return delete $t.cancelJoin0,$t.joinRequestIntervalId&&(clearInterval($t.joinRequestIntervalId),delete $t.joinRequestIntervalId),qn.removeEventListener("receiveData",Kt),jt===!0?qn.apiRTCSession.leavePresenceGroup([et.g.CONVERSATION_WAITING_ROOM_PREFIX+$t._getTechnicalName()],{doneByApiRTC:!0}):sn&&clearTimeout(sn),$t.status=et.g.CONVERSATION_STATUS_NOT_JOINED,Yt(Wt.g.createError(et.g.ERROR_OPERATION_CANCELED,"Operation canceled",Ln)),!0}})},Zp=function($t,Lt,Yt){return new Promise(function(kt){Eo.updateConferencePresence($t,Lt,Yt).then(kt,function(jt){Ln.warn("updateConferencePresence",jt),kt()})})},Bu=function($t,Lt){var Yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},kt=Yt.stream;if(!kt){var jt=$t.conversationCalls.get(Lt);if(!jt)return!1;kt=jt.stream}return Yt.noTriggerAdaptation?$t.releaseResources(kt.userMediaStreamId):$t.releaseResources(kt.userMediaStreamId,{triggerAdaptation:!0}),kt.publishedInConversations.delete($t.getName()),$t.conversationPublishedStreams.delete(kt.userMediaStreamId),$t.callIdToStreamId.delete(Lt),$t.conversationCalls.delete(Lt),!0},Vu=function($t,Lt){var Yt={streamId:Lt.streamId,isRemote:Lt.isRemote};if(Lt.isRemote)if(Lt.isVideoOnly){Yt.action="hangup";var kt=Mo.get($t).get(Lt.streamId);kt&&(Yt.callId=kt.callId),Ln.debug("disableVideoTrack - hangup",Lt.streamId),$t.unsubscribeToStream(Lt.streamId,{noTriggerAdaptation:!0})}else{Yt.action="disableTrack",Yt.trackType="video";var jt=Mo.get($t).get(Lt.streamId);jt&&(Yt.callId=jt.callId),Ln.debug("disableVideoTrack - disable video track",Lt.streamId),$t.updateSubscribedStream(Lt.streamId,{audioOnly:!0}).catch(function(dt){Ln.error("disableVideoTrack - updateSubscribedStream",dt)}),Lt.isVideoMuted=!0}else if(Lt.isVideoOnly){Yt.action="hangup";var sn=yo.get(Lt.streamId),ln=$t.getConversationCall(sn);ln&&(Yt.callId=ln.callId),Ln.debug("disableVideoTrack - hangup",Lt.streamId),$t.unpublish(sn,{noTriggerAdaptation:!0})}else{var Kt=$t.getConversationCall(yo.get(Lt.streamId));Kt?(Yt.action="disableTrack",Yt.trackType="video",Yt.callId=Kt.callId,Ln.debug("disableVideoTrack - disable video track",Lt.streamId),Kt.updatePublishedStream("video",!1).catch(function(dt){Ln.error("disableVideoTrack - updatePublishedStream",dt)}),Lt.isVideoMuted=!0):Yt=null}Yt&&nn.get($t).emit("adaptationTriggered",Yt)},zu=function($t,Lt){var Yt={streamId:Lt.streamId,isRemote:Lt.isRemote,action:"enableTrack",trackType:"video"};if(Lt.isRemote){var kt=Mo.get($t).get(Lt.streamId);kt&&(Yt.callId=kt.callId),Ln.debug("enableVideoTrack - enable video track",Lt.streamId),$t.updateSubscribedStream(Lt.streamId,{audioOnly:!1}).catch(function(sn){Ln.error("enableVideoTrack - updateSubscribedStream",sn)}),Lt.isVideoMuted=!1}else{var jt=$t.getConversationCall(yo.get(Lt.streamId));jt?(Yt.callId=jt.callId,Ln.debug("enableVideoTrack - enable video track",Lt.streamId),jt.updatePublishedStream("video",!0).catch(function(sn){Ln.error("enableVideoTrack - updatePublishedStream",sn)}),Lt.isVideoMuted=!1):Yt=null}Yt&&nn.get($t).emit("adaptationTriggered",Yt)},Ql=function($t,Lt,Yt){return Yt===!0?$t.pointerSharingState===et.g.STATE_IDLE?($t.pointerSharingState=et.g.STATE_JOINING,new Promise(function(kt,jt){qn.pointerSharingClient.joinRoom($t._getTechnicalName(),{success:function(sn){$t.pointerSharingState=et.g.STATE_ACTIVE,Lt===!0&&($t.pointerSharingAutoInvite=!0);var ln={enabled:!0,roomId:sn};nn.get($t).emit("pointerSharingEnabled",ln),kt(),$t.pointerSharingAutoInvite===!0&&ro.getContacts($t._getTechnicalName()).forEach(function(Kt){qn.pointerSharingClient.inviteInRoom($t._getTechnicalName(),Kt.getId())})},failure:function(sn,ln){$t.pointerSharingState=et.g.STATE_IDLE,$t.pointerSharingAutoInvite=!1,jt(sn)}})})):Promise.reject(Wt.g.createError(et.g.ERROR_WRONG_STATE,"enablePointerSharing() - cannot enable pointer sharing")):Yt===!1?$t.pointerSharingState===et.g.STATE_ACTIVE?($t.pointerSharingState=et.g.STATE_LEAVING,new Promise(function(kt,jt){qn.pointerSharingClient.leaveRoom($t._getTechnicalName()),$t.pointerSharingState=et.g.STATE_IDLE,$t.pointerSharingAutoInvite=!1;var sn={enabled:!1,roomId:$t._getTechnicalName()};nn.get($t).emit("pointerSharingEnabled",sn),kt()})):Promise.reject(Wt.g.createError(et.g.ERROR_WRONG_STATE,"enablePointerSharing() - cannot disable pointer sharing")):Promise.reject(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"enablePointerSharing() - cannot enable/disable pointer sharing"))},js=function($t,Lt){var Yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return["roomName","callId","clientId"].forEach(function(kt){Lt.hasOwnProperty(kt)&&(Yt[kt]=String(Lt[kt]))}),Yt};function Zl($t){return Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Zl($t)}function _h($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Hu($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function _c(){return _c=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function($t,Lt,Yt){var kt=_f($t,Lt);if(kt){var jt=Object.getOwnPropertyDescriptor(kt,Lt);return jt.get?jt.get.call(arguments.length<3?$t:Yt):jt.value}},_c.apply(this,arguments)}function _f($t,Lt){for(;!Object.prototype.hasOwnProperty.call($t,Lt)&&($t=Jo($t))!==null;);return $t}function _d($t,Lt){return _d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},_d($t,Lt)}function em($t,Lt){if(Lt&&(Zl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}($t)}function Jo($t){return Jo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Jo($t)}var ba=ft.Y.get("Conference"),tm=jo.getAvailableEvents().concat(["closed"]),Fs=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&_d(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Jo(jt);if(sn){var Nt=Jo(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return em(this,dt)});function Kt(dt){var gt,Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _h(this,Kt),gt=ln.call(this,dt,Nt),ba.info("Create conference"),gt.conference=!0,gt.friendlyName=Nt.hasOwnProperty("friendlyName")?Nt.friendlyName:dt,gt}return Lt=Kt,kt=[{key:"getAvailableEvents",value:function(){return tm}}],(Yt=[{key:"destroy",value:function(){uo.get().deleteConference(this.getName()),_c(Jo(Kt.prototype),"destroy",this).call(this)}},{key:"_getTechnicalName",value:function(){return nm()+ts.get(this)}},{key:"getFriendlyName",value:function(){return this.friendlyName}},{key:"getInfo",value:function(){var dt=this;return new Promise(function(gt,Nt){var Vt={},zt=wo.get(dt);zt&&(Vt.token=zt.getToken()),Eo.getWebconf(dt._getTechnicalName(),Vt).then(function(Xt){return gt({dtmfCode:Xt.dtmfCode,endTime:Xt.end,hasPassword:Xt.hasPassword,sipNumber:Xt.sipNumber,startTime:Xt.start,state:Xt.state,type:Xt.type})}).catch(function(Xt){return Nt(Wt.g.createError(et.g.ERROR_OTHER,"getInfo() - Cannot get conference info",ba))})})}},{key:"close",value:function(){var dt=this;return ba.debug("Closing "+this.getName()),new Promise(function(gt,Nt){dt.status!==et.g.CONVERSATION_STATUS_JOINED?Nt(Wt.g.createError(et.g.ERROR_OTHER,"close() - Conversation has to be joined to be closed",ba)):dt.getRole()!==et.g.CONVERSATION_ROLE_MODERATOR?Nt(Wt.g.createError(et.g.ERROR_UNAUTHORIZED,"close() - Role has to be moderator to close the conversation",ba)):Eo.closeConferenceInstance(dt,wo.get(dt)).then(function(){ba.debug("Conversation closed successfully"),qn.dataClient.sendDataToGroup(dt._getTechnicalName(),{event:et.g.CONVERSATION_CLOSED_IDENTIFIER,instanceId:dt.getInstanceId(),roomname:dt._getTechnicalName()}),nn.get(dt).emit("closed"),dt.leave(),gt()}).catch(function(Vt){var zt="close() - An error occured when closing conversation",Xt={error:new Error(zt),code:et.g.ERROR_OTHER};ba.error(zt,Vt),Vt.hasOwnProperty("code")?Xt.code=Vt.code:Vt.hasOwnProperty("http_code")&&(Xt.code=Vt.http_code.toString().startsWith("4")?et.g.ERROR_UNAUTHORIZED:et.g.ERROR_SERVER_UNAVAILABLE),Nt(Xt)})})}},{key:"sendInvitation",value:function(dt,gt){var Nt=this;if(gt||(gt={}),dt instanceof No){ba.info("Invite "+dt.getId()+" to "+this._getTechnicalName()),dt.isOnline()||ba.warn("sendInvitation() - contact "+dt.getUsername()+" does not seem to be connected.");var Vt={receiveNotifier:new ht};gt.hasOwnProperty("expirationTime")&&(Vt.expirationTime=gt.expirationTime);var zt=new Do(dt,this,Vt),Xt={event:et.g.CONVERSATION_INVITATION_IDENTIFIER,invitationId:zt.id,roomname:this._getTechnicalName(),friendlyName:this.getFriendlyName(),sendTime:zt.sendTime};return zt.type="conference",Us.get(this)!==null&&(Xt.password=Us.get(this)),qn.sendData(dt.getId(),Xt).then(function(){Vt.receiveNotifier.emit("receive")}).catch(function(Zt){var on=Wt.g.createError(Zt,"Invitation not delivered",ba);nn.get(Nt).emit("messageNotDelivered",{error:on,contact:dt,event:et.g.CONVERSATION_INVITATION_IDENTIFIER})}),zt}return ba.error("Parameter is not a contact"),null}},{key:"getTags",value:function(){var dt=this;return new Promise(function(gt,Nt){var Vt=Br.getActiveSession();if(!Vt)return Nt(Wt.g.createError(et.g.ERROR_NOT_ALLOWED,"getTags() - no session found",ba));var zt=Vt.getUserAgent().getEnterprise();if(!zt)return Nt(Wt.g.createError(et.g.ERROR_NOT_ALLOWED,"getTags() - no enterprise found",ba));zt.getTags(dt).then(function(Xt){for(var Zt=[],on=0;on<Xt.length;on+=1)Xt[on].selected===!0&&Zt.push(Xt[on]);return gt(Zt)}).catch(function(Xt){return Nt(Wt.g.createError(et.g.ERROR_NOT_ALLOWED,"getTags() - cannot get tags",ba,{fromError:Xt}))})})}},{key:"setTags",value:function(dt){var gt=this;return new Promise(function(Nt,Vt){if(!Array.isArray(dt))return Vt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"setTags() - wrong tags",ba));if(!gt.webconfId)return Vt(Wt.g.createError(et.g.ERROR_NOT_ALLOWED,"setTags() - no webconf found",ba));var zt=Br.getActiveSession();if(!zt)return Vt(Wt.g.createError(et.g.ERROR_NOT_ALLOWED,"setTags() - no session found",ba));var Xt=zt.getUserAgent().getEnterprise();if(!Xt)return Vt(Wt.g.createError(et.g.ERROR_NOT_ALLOWED,"setTags() - no enterprise found",ba));var Zt=zt.getToken();if(!Zt)return Vt(Wt.g.createError(et.g.ERROR_NOT_ALLOWED,"setTags() - no token found",ba));for(var on=[],bn=0;bn<dt.length;bn+=1){if(!dt[bn].hasOwnProperty("id"))return Vt(Wt.g.createError(et.g.ERROR_BAD_PARAMETER,"setTags() - wrong tags",ba));on.push(dt[bn].id)}Eo.updateWebconfTags(Xt.getId(),gt.webconfId,on,Zt).then(function(){return Nt()}).catch(function(En){return Vt(Wt.g.createError(et.g.ERROR_OTHER,"setTags() - cannot set tags",ba,{fromError:En}))})})}}])&&Hu(Lt.prototype,Yt),kt&&Hu(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(jo),nm=function(){return qn.getActiveApiKey()+":"};function Gu($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}ft.Y.get("ConversationCatalog");var rs=null,uo=function(){function $t(){if(function(jt,sn){if(!(jt instanceof sn))throw new TypeError("Cannot call a class as a function")}(this,$t),rs!==null)throw"Cannot construct singleton ConversationCatalog";this.conversationList=new Map,this.conferenceList=new Map,rs=this}var Lt,Yt,kt;return Lt=$t,Yt=[{key:"deleteConversation",value:function(jt){return!!(Wt.g.isTypeof(jt,"string")&&jt.length>0)&&this.conversationList.delete(jt)}},{key:"deleteConference",value:function(jt){return!!(Wt.g.isTypeof(jt,"string")&&jt.length>0)&&this.conferenceList.delete(jt)}},{key:"getOrCreateConversation",value:function(jt){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ln=null;return jt!=null&&jt!==""?this.conversationList.has(jt.toString())?ln=this.conversationList.get(jt.toString()):(ln=new jo(jt.toString(),sn),this.conversationList.set(jt.toString(),ln)):(ln=new jo(null,sn),this.conversationList.set(ln.getName(),ln)),ln}},{key:"getOrCreateConference",value:function(jt){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ln=null;return jt!=null&&jt!==""?this.conferenceList.has(jt.toString())?ln=this.conferenceList.get(jt.toString()):(ln=new Fs(jt.toString(),sn),this.conferenceList.set(jt.toString(),ln)):(ln=new Fs(null,sn),this.conferenceList.set(ln.getName(),ln)),ln}},{key:"getConversations",value:function(){return this.conversationList}},{key:"getConferences",value:function(){return this.conferenceList}},{key:"isConference",value:function(jt){return qu(jt).hasOwnProperty("apiKey")}},{key:"getNameFromTechnicalName",value:function(jt){return qu(jt).name}}],kt=[{key:"get",value:function(){return rs===null&&(rs=new $t),rs}}],Yt&&Gu(Lt.prototype,Yt),kt&&Gu(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function qu($t){var Lt=$t.match(/^([^:]+)[:]([^:]+)$/);return Lt===null||Lt.length<3?{name:$t}:{apiKey:Lt[1],name:Lt[2]}}function eu($t){return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},eu($t)}function Ko($t,Lt){var Yt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Yt){if(Array.isArray($t)||(Yt=function(dt,gt){if(dt){if(typeof dt=="string")return Ju(dt,gt);var Nt=Object.prototype.toString.call(dt).slice(8,-1);return Nt==="Object"&&dt.constructor&&(Nt=dt.constructor.name),Nt==="Map"||Nt==="Set"?Array.from(dt):Nt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Nt)?Ju(dt,gt):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Yt&&($t=Yt);var kt=0,jt=function(){};return{s:jt,n:function(){return kt>=$t.length?{done:!0}:{done:!1,value:$t[kt++]}},e:function(dt){throw dt},f:jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Kt=!1;return{s:function(){Yt=Yt.call($t)},n:function(){var dt=Yt.next();return ln=dt.done,dt},e:function(dt){Kt=!0,sn=dt},f:function(){try{ln||Yt.return==null||Yt.return()}finally{if(Kt)throw sn}}}}function Ju($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function Ku($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function tu($t,Lt){return tu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},tu($t,Lt)}function rm($t,Lt){if(Lt&&(eu(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pr($t)}function Pr($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Ws($t){return Ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Ws($t)}var lr=ft.Y.get("Session"),zr=On.get(),Bs=new(Go()),ao=Or.get(),im=["rawData","whiteboardInvitation","fileTransferInvitation","conversationMessage","conversationData","dataChannelInvitation","contactMessage","contactData","customEvent","conversationInvitation","incomingCall","disconnect","error","contactListUpdate","reconnecting","reconnection","conversationJoinRequest","newMediaAvailableFromContact","whiteboardRoomMemberUpdate","incomingScreenSharingCall","pointerSharingInvitation","pointerLocationChanged","incomingScreenSharingCallInvitation","cloudEventOccurred","remoteAccessInvitation"],Yu=new WeakMap,as=new WeakMap,Vs=null,nu=new WeakMap,os=new WeakMap,Br=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&tu(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Ws(jt);if(sn){var Nt=Ws(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return rm(this,dt)});function Kt(dt){var gt;(function(Xt,Zt){if(!(Xt instanceof Zt))throw new TypeError("Cannot call a class as a function")})(this,Kt),gt=ln.call(this,lr),lr.debug("Create Session"),gt.id=null,gt.token=null,gt.ccsToken=null,Yu.set(Pr(gt),dt),as.set(Pr(gt),null),os.set(Pr(gt),{}),gt.isRecording=!1,gt.userData=new Io,gt.contactListUpdateListenerSetted=!1,gt.waitingContactListUpdateEvent=[];var Nt=Ro.get(),Vt=uo.get(),zt={};return gt.invitationsMap=new Map,zt.channelEvent=function(Xt){switch(Xt.detail.channelEvent){case"onChannelReconnecting":nn.get(Pr(gt)).emit("reconnecting",Xt);break;case"onChannelReconnect":nn.get(Pr(gt)).emit("reconnection",Xt);break;case"onChannelError":nn.get(Pr(gt)).emit("error",Xt);break;case"onChannelDisconnect":lr.error("Session :: onChannelDisconnect"),nn.get(Pr(gt)).emit("disconnect",Xt)}},zt.incomingCall=function(Xt){var Zt=Nt.getOrCreateContact(Xt.detail.callerId),on=Xt.detail.callId.toString();if(Xt.detail.callType==="data")if(lr.info("Received file transfer invitation from "+Zt.getUsername()),Wt.g._private.dataCallsFileInfo.has(on)){var bn=Wt.g._private.dataCallsFileInfo.get(on),En=null;gt.invitationsMap.has(Xt.detail.callerId+"-sendfile-"+on)?(En=gt.invitationsMap.get(Xt.detail.callerId+"-sendfile-"+on),lr.debug("invitation already exist :",En)):(En=new eo(Zt,on,bn),gt.invitationsMap.set(Xt.detail.callerId+"-sendfile-"+on,En)),nn.get(Pr(gt)).emit("fileTransferInvitation",En)}else Wt.g._private.dataChannelInvitations.has(on)?nn.get(Pr(gt)).emit("dataChannelInvitation",new zo(Zt,on)):(lr.debug("File information has not been received yet, putting invitation on hold"),Wt.g._private.dataCallsOnHold.set(on));else if(Xt.detail.callType==="screenSharing"||Xt.detail.callType==="screenSharingWithAudio")if(apiRTC.session.apiCCWebRTCClient.webRTCClient.userAcceptOnIncomingScreenSharingCall===!0){lr.debug("Received screenSharingCallInvitation from "+Zt.getUsername());var Gn=new Ir(Zt,on,Xt.detail.callType,{isRecorded:!!Xt.detail.hasOwnProperty("recordedCall")&&Xt.detail.recordedCall});nn.get(Pr(gt)).emit("incomingScreenSharingCallInvitation",Gn)}else{lr.debug("Received screenSharingCall from "+Zt.getUsername());var Kn=ao.getOrCreateCall(on,Zt,{started:!0,isRecorded:!!Xt.detail.hasOwnProperty("recordedCall")&&Xt.detail.recordedCall});nn.get(Pr(gt)).emit("incomingScreenSharingCall",Kn)}else{lr.info("Received call invitation from "+Zt.getUsername());var cr=new Ir(Zt,on,Xt.detail.callType,{isRecorded:!!Xt.detail.hasOwnProperty("recordedCall")&&Xt.detail.recordedCall});nn.get(Pr(gt)).emit("incomingCall",cr)}},zt.roomInvitation=function(Xt){var Zt=Nt.getOrCreateContact(Xt.detail.senderId);if(Xt.detail.roomType==="whiteBoard"){if(Zt!==null){lr.info("Received whiteboard invitation from "+Zt.getUsername());var on={};Xt.detail.cloudConvId&&(on.cloudConvId=Xt.detail.cloudConvId),Xt.detail.webconf===!0&&(on.webconf=!0),nn.get(Pr(gt)).emit("whiteboardInvitation",new vs(Zt,Xt.detail.roomId,on))}}else Xt.detail.roomType==="pointerSharing"&&(Zt===null||Vt.getConversations().has(Xt.detail.roomId)||Vt.getConferences().has(Xt.detail.roomId)||(lr.info("Received pointer sharing invitation from "+Zt.getUsername()),nn.get(Pr(gt)).emit("pointerSharingInvitation",new xl(Zt,Xt.detail.roomId,Pr(gt)))))},zt.roomMemberUpdate=function(Xt){var Zt,on=[],bn=Ko(Xt.detail.contactList);try{for(bn.s();!(Zt=bn.n()).done;){var En=Zt.value;on.push(Nt.getOrCreateContact(En.contactId))}}catch(Gn){bn.e(Gn)}finally{bn.f()}Xt.detail.roomType==="whiteBoard"&&(lr.info("Received whiteboard room member update"),nn.get(Pr(gt)).emit("whiteboardRoomMemberUpdate",{contacts:on,roomId:Xt.detail.roomId,status:Xt.detail.status}))},zt.receiveRoomMessage=function(Xt){if(lr.debug("receiveRoomMessage",Xt),Xt.detail.roomType==="pointerSharing"&&Xt.detail.message.type==="pointerLocation"&&os.get(Pr(gt)).hasOwnProperty(Xt.detail.roomId)){var Zt={sender:Nt.getOrCreateContact(Xt.detail.senderId),source:Xt.detail.message.source,x:Xt.detail.message.x,y:Xt.detail.message.y};Wt.g.isPropertyTypeof(Xt.detail.message,"data","object")&&(Zt.data=Xt.detail.message.data),nn.get(Pr(gt)).emit("pointerLocationChanged",Zt)}},zt.receiveIMMessage=function(Xt){var Zt=Nt.getOrCreateContact(Xt.detail.senderId);lr.debug("Received IM from "+Zt.getUsername()+" : ",Xt.detail.message),nn.get(Pr(gt)).emit("contactMessage",{sender:Zt,content:Xt.detail.message,uuid:Xt.detail.UUCSeq,time:Xt.detail.time})},zt.receiveData=function(Xt){var Zt=Nt.getOrCreateContact(Xt.detail.senderId),on=Xt.detail.data;if(on!==void 0){var bn=null;if(on.roomname!==void 0&&(bn=Vt.isConference(on.roomname)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(on.roomname)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(on.roomname))),lr.trace("Received data from "+Zt.getId(),Xt.detail),nn.get(Pr(gt)).emit("rawData",{sender:Zt,content:on}),on.event!==void 0)switch(on.event){case et.g.INVITATION_ANSWER_IDENTIFIER:case et.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER:break;case et.g.CONTACT_SEND_DATA_IDENTIFIER:lr.debug("Received contact data from "+Zt.getUsername(),on.content),nn.get(Pr(gt)).emit("contactData",{sender:Zt,content:on.content});break;case et.g.CONVERSATION_SEND_DATA_IDENTIFIER:on.roomname!==void 0&&(lr.debug("Received conversation data from "+Zt.getUsername(),on.content),nn.get(Pr(gt)).emit("conversationData",{sender:Zt,conversation:bn,content:on.content}));break;case et.g.CONTACT_NEW_MEDIA_IDENTIFIER:nn.get(Pr(gt)).emit("newMediaAvailableFromContact",{sender:Zt,media:on.media});break;case et.g.CONTACT_DATACHANNEL_INVITATION:lr.debug("Received datachannel invitation from "+Zt.getUsername()),Wt.g._private.dataChannelInvitations.set(on.callId.toString(),!0),Wt.g._private.dataCallsOnHold.has(on.callId.toString())&&nn.get(Pr(gt)).emit("dataChannelInvitation",new zo(Zt,on.callId.toString()));break;case et.g.CONTACT_SEND_FILEINFO_IDENTIFIER:lr.debug("Received file info from "+Zt.getUsername(),on.fileInfo);var En=on.callId.toString();if(Wt.g._private.dataCallsFileInfo.set(En,on.fileInfo),Wt.g._private.dataCallsOnHold.has(En)){var Gn=null;gt.invitationsMap.has(Zt.getId()+"-sendfile-"+En)?(Gn=gt.invitationsMap.get(Zt.getId()+"-sendfile-"+En),lr.debug("invitation already exist :",Gn)):(Gn=new eo(Zt,En,on.fileInfo),gt.invitationsMap.set(Xt.detail.callerId+"-sendfile-"+En,Gn)),nn.get(Pr(gt)).emit("fileTransferInvitation",Gn)}else lr.debug("no dataCallsOnHold");break;case et.g.CONVERSATION_INVITATION_IDENTIFIER:if(on.roomname!==void 0){lr.info("Received conversation invitation from "+Zt.getUsername());var Kn={session:Pr(gt)};on.hasOwnProperty("password")&&(Kn.password=on.password),bn?(on.hasOwnProperty("friendlyName")&&bn.name===bn.friendlyName&&(bn.friendlyName=on.friendlyName),nn.get(Pr(gt)).emit("conversationInvitation",new Bt(Zt,on,bn,Kn))):nn.get(Pr(gt)).emit("conversationInvitation",new Bt(Zt,on,null,Kn))}break;case et.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER:lr.info("Received conversation join request from "+Zt.getUsername()),bn?nn.get(Pr(gt)).emit("conversationJoinRequest",new Ho(Zt,bn,on.invitationId)):nn.get(Pr(gt)).emit("conversationJoinRequest",new Ho(Zt,null,null));break;case et.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER:case et.g.CONVERSATION_CLOSED_IDENTIFIER:break;case et.g.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER:if(lr.debug("Received remote access invitation"),apiRTC.session.remoteAccessInvitation===null){var cr=new kp(Zt,on,bn,{});apiRTC.session.remoteAccessInvitation=cr,nn.get(Pr(gt)).emit("remoteAccessInvitation",cr)}else lr.error("remoteAccess session is already ongoing");break;case et.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER:case et.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER:case et.g.CONTACT_REMOTEACCESS_APP_MESSAGE:case et.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE:break;default:var hr={event:on.event,content:on,sender:Zt};bn!==null&&(hr.conversation=bn),nn.get(Pr(gt)).emit("customEvent",hr)}else if(on.command!==void 0)switch(on.command){case"userWaiting":case"userWaiting-new":lr.info("Received conversation join request from "+Zt.getUsername()),bn?nn.get(Pr(gt)).emit("conversationJoinRequest",new Ho(Zt,bn,null)):nn.get(Pr(gt)).emit("conversationJoinRequest",new Ho(Zt,null,null))}}else lr.debug("Received data undefined, leaving process")},zt.receiveGroupChatMessage=function(Xt){var Zt=Nt.getOrCreateContact(Xt.detail.senderId),on=null,bn=Xt.detail.groupChatId.toString();if(bn!==void 0&&(on=Vt.isConference(bn)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(bn)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(bn))),on!==null){lr.debug("Received conversation message from "+Zt.getUsername(),Xt.detail.message);var En={sender:Zt,conversation:on,content:Xt.detail.message};Wt.g.isTypeof(Xt.detail,"metadata","object")&&(En.metadata=Xt.detail.metadata),nn.get(Pr(gt)).emit("conversationMessage",En)}},zt.cloudEventOccurred=function(Xt){var Zt={topic:Xt.detail.topic,target:Xt.detail.target};nn.get(Pr(gt)).emit("cloudEventOccurred",Zt)},zt.callEstablished=function(Xt){if(Xt.detail.callId!==void 0){var Zt=Xt.detail.callId.toString();lr.debug("callEstablished",Xt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&on.manageCallEstablishedEvent(Xt)}else lr.debug("callEstablished",Xt.detail)},zt.remoteStreamAdded=function(Xt){if(Xt.detail.callId!==void 0){var Zt=Xt.detail.callId.toString();lr.debug("remoteStreamAdded",Xt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&on.manageRemoteStreamAddedEvent(Xt)}else lr.debug("remoteStreamAdded",Xt.detail)},zt.remoteStreamRemoved=function(Xt){if(Xt.detail.callId!==void 0){var Zt=Xt.detail.callId.toString();lr.debug("remoteStreamRemoved",Xt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&on.manageRemoteStreamRemovedEvent(Xt)}else lr.debug("remoteStreamRemoved",Xt.detail)},zt.userMediaSuccess=function(Xt){var Zt=null;if(Xt.detail.callId!==void 0&&Xt.detail.callId!==null){Zt=Xt.detail.callId.toString(),lr.debug("userMediaSuccess",Xt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&on.manageUserMediaSuccessEvent(Xt)}else lr.debug("userMediaSuccess",Xt.detail)},zt.onCallStatsUpdate=function(Xt){if(Xt.detail.callId!==void 0){var Zt=Xt.detail.callId.toString(),on=ao.getCall(Zt,null,{});on!==null&&on.manageCallStatsUpdateEvent(Xt)}else lr.debug("onCallStatsUpdate",Xt.detail)},zt.error=function(Xt){if(lr.debug("error",Xt.detail),Xt.detail.roomName!==null&&Xt.detail.roomName!==void 0){lr.debug("error on conversation :",Xt.detail,Xt.detail.roomName,Xt.detail.callId);var Zt=null;Xt.detail.roomName!==void 0&&(Zt=Vt.isConference(Xt.detail.roomName)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(Xt.detail.roomName)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(Xt.detail.roomName)))!==null&&Zt.manageErrorEvent(Xt)}else if(Xt.detail.callId!==void 0){var on=Xt.detail.callId.toString();lr.debug("error",Xt.detail,on);var bn=ao.getCall(on,null,{});bn!==null&&(bn.manageErrorEvent(Xt),Xt.detail.errorCode==="RECORDING_FAILED"&&ao.removeCallFromList(bn.getId()))}else lr.debug("error",Xt.detail),nn.get(Pr(gt)).emit("error",Xt.detail)},zt.disconnectionWarning=function(Xt){if(Xt.detail.roomName!==null){lr.debug("disconnectionWarning on conversation :",Xt.detail,Xt.detail.roomName,Xt.detail.callId);var Zt=null;Xt.detail.roomName!==void 0&&(Zt=Vt.isConference(Xt.detail.roomName)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(Xt.detail.roomName)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(Xt.detail.roomName)))!==null&&Zt.manageDisconnectionWarningEvent(Xt)}else if(Xt.detail.callId){var on=Xt.detail.callId.toString();lr.debug("disconnectionWarning",Xt.detail,on);var bn=ao.getCall(on,null,{});bn!==null&&bn.manageDisconnectionWarningEvent(Xt)}else lr.debug("disconnectionWarning",Xt.detail)},zt.hangup=function(Xt){if(Xt.detail.callId){var Zt=Xt.detail.callId.toString();lr.debug("hangup",Xt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&(on.manageHangupEvent(Xt),on.isRecorded()===!1&&ao.removeCallFromList(on.getId()))}else lr.debug("hangup",Xt.detail)},zt.recordedStreamsAvailable=function(Xt){if(Xt.detail.userId2){var Zt=Nt.getOrCreateContact(Xt.detail.userId2),on=ao.getCall(null,Zt);on&&(on.manageRecordAvailableEvent(Xt),ao.removeCallFromList(on.getId()))}else lr.debug("recordedStreamsAvailable",Xt.detail)},zt.desktopCapture=function(Xt){if(Xt.detail.callId){var Zt=Xt.detail.callId.toString();lr.warn("desktopCapture",Xt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&(on.manageDesktopCaptureEvent(Xt),ao.removeCallFromList(on.getId()))}else lr.debug("desktopCapture",Xt.detail)},zt.userMediaError=function(Xt){if(Xt.detail.callId){var Zt=Xt.detail.callId.toString();lr.warn("userMediaError",Xt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&(on.manageUserMediaErrorEvent(Xt),Xt.detail.tryAudioCallActivated===!1&&ao.removeCallFromList(on.getId()))}else lr.debug("userMediaError",Xt.detail)},lr.debug("av apiRTCManager onEvent ..."),zr.onEvent("disconnectionWarning",zt.disconnectionWarning).onEvent("incomingCall",zt.incomingCall).onEvent("roomInvitation",zt.roomInvitation).onEvent("roomMemberUpdate",zt.roomMemberUpdate).onEvent("receiveRoomMessage",zt.receiveRoomMessage).onEvent("receiveIMMessage",zt.receiveIMMessage).onEvent("receiveData",zt.receiveData).onEvent("receiveGroupChatMessage",zt.receiveGroupChatMessage).onEvent("cloudEventOccurred",zt.cloudEventOccurred).onEvent("callEstablished",zt.callEstablished).onEvent("remoteStreamAdded",zt.remoteStreamAdded).onEvent("remoteStreamRemoved",zt.remoteStreamRemoved).onEvent("userMediaSuccess",zt.userMediaSuccess).onEvent("onCallStatsUpdate",zt.onCallStatsUpdate).onEvent("error",zt.error).onEvent("hangup",zt.hangup).onEvent("recordedStreamsAvailable",zt.recordedStreamsAvailable).onEvent("desktopCapture",zt.desktopCapture).onEvent("userMediaError",zt.userMediaError),apiRTC.addEventListener("channelEvent",zt.channelEvent),Nt.onUpdate(function(Xt){gt.contactListUpdateListenerSetted===!1&&(lr.debug("No listener for contactListUpdate, storing event ..."),gt.waitingContactListUpdateEvent.push(Xt)),nn.get(Pr(gt)).emit("contactListUpdate",Xt)}),nu.set(Pr(gt),zt),gt}return Lt=Kt,Yt=[{key:"getToken",value:function(){return this.token}},{key:"getApzToken",value:function(){var dt=null;return apiRTC.session!==void 0&&apiRTC.session!==null&&(dt=apiRTC.session.JWTApzToken),dt}},{key:"getId",value:function(){return this.id}},{key:"getUserAgent",value:function(){return Yu.get(this)}},{key:"getContact",value:function(dt){return lr.warn("getContact() - Method deprecated, use Session.getOrCreateContact() instead"),Ro.get().getOrCreateContact(dt)}},{key:"getOrCreateContact",value:function(dt){return Ro.get().getOrCreateContact(dt)}},{key:"createConversation",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return lr.warn("createConversation() - Method deprecated, use Session.getConversation() instead"),this.getConversation(dt,gt)}},{key:"getConversation",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return lr.trace("Getting conversation "+dt,gt),uo.get().getOrCreateConversation(dt)}},{key:"getConference",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return lr.trace("Getting conference "+dt,gt),uo.get().getOrCreateConference(dt)}},{key:"getOrCreateConversation",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Nt=uo.get().getNameFromTechnicalName(dt);return uo.get().isConference(dt)?uo.get().getOrCreateConference(Nt,gt):uo.get().getOrCreateConversation(Nt,gt)}},{key:"getOrCreateConference",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.getOrCreateConversation(dt,gt)}},{key:"getActiveConversations",value:function(){var dt,gt={},Nt=uo.get().getConversations(),Vt=Ko(Nt.keys());try{for(Vt.s();!(dt=Vt.n()).done;){var zt=dt.value,Xt=Nt.get(zt);Xt.isJoined()&&(gt[zt]=Xt)}}catch(Zt){Vt.e(Zt)}finally{Vt.f()}return gt}},{key:"getActiveConferences",value:function(){var dt,gt={},Nt=uo.get().getConferences(),Vt=Ko(Nt.keys());try{for(Vt.s();!(dt=Vt.n()).done;){var zt=dt.value,Xt=Nt.get(zt);Xt.isJoined()&&(gt[zt]=Xt)}}catch(Zt){Vt.e(Zt)}finally{Vt.f()}return gt}},{key:"getWhiteboardClient",value:function(){return lr.trace("getWhiteboardClient()"),zr.whiteBoardClient}},{key:"setUserData",value:function(dt){this.userData.setProps(dt).setToSession()}},{key:"setUsername",value:function(dt){this.userData.setProp("username",dt).setToSession()}},{key:"setPhotoUrl",value:function(dt){this.userData.setProp("photo_url",dt).setToSession()}},{key:"getUserData",value:function(){return this.userData}},{key:"getUsername",value:function(){return this.userData.get("username")!==null?this.userData.get("username"):this.userData.get("nickname")!==null?this.userData.get("nickname"):this.id.toString()}},{key:"getPhotoUrl",value:function(){return this.userData.get("photo_url")!==null?this.userData.get("photo_url"):this.userData.get("photoUrl")!==null?this.userData.get("photoUrl"):null}},{key:"subscribeToGroup",value:function(dt){if(this.getSubscribedPresenceGroup().includes(dt)){lr.debug("Already subscribed to this group");var gt=apiCC.session.subscribeToPresenceGroupAddedByApiRTC.indexOf(dt);gt!==-1&&apiCC.session.subscribeToPresenceGroupAddedByApiRTC.splice(gt,1)}else zr.apiRTCSession.subscribePresenceGroup([dt])}},{key:"unsubscribeToGroup",value:function(dt){this.getSubscribedPresenceGroup().includes(dt)?zr.unsubscribeToPresenceGroup(dt):lr.debug("Not subscribed to this group")}},{key:"joinGroup",value:function(dt){if(this.getPresenceGroup().includes(dt)){lr.debug("Already joined this group");var gt=apiCC.session.presenceGroupAddedByApiRTC.indexOf(dt);gt!==-1&&apiCC.session.presenceGroupAddedByApiRTC.splice(gt,1)}else zr.joinAndSubscribeToPresenceGroup(dt)}},{key:"leaveGroup",value:function(dt){this.getPresenceGroup().includes(dt)?zr.leaveAndUnsubscribeToPresenceGroup(dt):lr.debug("Group was not joined")}},{key:"subscribeToCloudEvent",value:function(dt,gt){zr.subscribeToCloudEvent(dt,gt)}},{key:"unsubscribeToCloudEvent",value:function(dt,gt){zr.unsubscribeToCloudEvent(dt,gt)}},{key:"joinConversationSpace",value:function(dt){zr.apiRTCSession.joinConversationSpace(dt)}},{key:"leaveConversationSpace",value:function(dt){zr.apiRTCSession.leaveConversationSpace(dt)}},{key:"getContacts",value:function(dt){lr.trace("getContacts()");var gt,Nt={},Vt=Ro.get().getContacts(dt),zt=Ko(Vt.keys());try{for(zt.s();!(gt=zt.n()).done;){var Xt=gt.value;Nt[Xt]=Vt.get(Xt)}}catch(Zt){zt.e(Zt)}finally{zt.f()}return Nt}},{key:"getContactsArray",value:function(dt){lr.log("getContactsArray");var gt=Ro.get().getContacts(dt);return Array.from(gt.values())}},{key:"getOnlineContactsArray",value:function(dt){lr.log("getOnlineContactsArray");var gt=Ro.get().getOnlineContacts(dt);return Array.from(gt.values())}},{key:"getCall",value:function(dt){return lr.trace("getCall()"),Or.get().getCall(dt)}},{key:"getCalls",value:function(){lr.trace("getCalls()");var dt,gt={},Nt=Or.get().getCalls(),Vt=Ko(Nt.keys());try{for(Vt.s();!(dt=Vt.n()).done;){var zt=dt.value;gt[zt]=Nt.get(zt)}}catch(Xt){Vt.e(Xt)}finally{Vt.f()}return gt}},{key:"disconnect",value:function(){var dt=this,gt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{invalidateUserToken:!0};return new Promise(function(Nt,Vt){if(lr.info("disconnect()"),dt.token===null&&dt.id===null)lr.error("disconnect() - Session is already disconnected"),Vt("disconnect() - Session is already disconnected");else{var zt,Xt=Ko(uo.get().getConversations().keys());try{for(Xt.s();!(zt=Xt.n()).done;){var Zt=zt.value;Zt.status===et.g.CONVERSATION_STATUS_JOINED&&Zt.leave()}}catch(cr){Xt.e(cr)}finally{Xt.f()}if(clearInterval(as.get(dt)),as.set(dt,null),dt.token!==null&&gt.hasOwnProperty("invalidateUserToken")&&gt.invalidateUserToken)Bs.invalidateUserToken(dt.token).then(function(){Vs=null,gt.invalidateApiCCId=!0,zr.disconnect(gt),dt.id=null,dt.token=null;for(var cr=nu.get(dt),hr=0,Ar=Object.keys(cr);hr<Ar.length;hr++){var Xr=Ar[hr];lr.info("Session, removing apiRTCManager event :",Xr);var _i=cr[Xr];zr.removeEventListener(Xr,_i)}Nt()}).catch(function(cr){lr.error("disconnect() - An error occured during disconnection",cr),Vt(new Error("disconnect() - An error occured during disconnection"))});else{Vs=null,zr.disconnect(gt),dt.id=null;for(var on=nu.get(dt),bn=0,En=Object.keys(on);bn<En.length;bn++){var Gn=En[bn];lr.info("Session, removing apiRTCManager event :",Gn);var Kn=on[Gn];zr.removeEventListener(Gn,Kn)}Nt()}}})}},{key:"cloudRequest",value:function(dt,gt,Nt){return Bs.cloudRequest(dt,gt,Nt)}},{key:"sendRawData",value:function(dt,gt){return new Promise(function(Nt,Vt){dt!=null?zr.sendData(dt.getId(),gt).then(Nt).catch(function(zt){switch(zt){case et.g.ERROR_TIMED_OUT:Vt(Wt.g.createError(et.g.ERROR_TIMED_OUT,"sendRawData() - Data transmission timed out ",lr));break;case et.g.ERROR_NOT_FOUND:Vt(Wt.g.createError(et.g.ERROR_NOT_FOUND,"sendRawData() - Contact was not found ",lr));break;default:Vt(Wt.g.createError(et.g.ERROR_OTHER,"sendRawData() - Data transmission timed out ",lr))}}):Vt(Wt.g.createError(et.g.ERROR_OTHER,"sendRawData() - Contact undefined",lr))})}},{key:"startRecordingOutgoingStream",value:function(dt,gt){this.isRecording?lr.error("startRecordingOutgoingStream() - already recording"):(zr.webRTCClient.startRecording(dt,gt),this.isRecording=!0)}},{key:"stopRecordingOutgoingStream",value:function(){var dt=this;return new Promise(function(gt,Nt){dt.isRecording?(dt.isRecording=!1,zr.onceEvent("MCURecordedStreamsAvailable",function(Vt){gt({filename:Vt.detail.recordedFileName,url:et.g.RECORD_PLAY_URL+Vt.detail.recordedFileName})}),zr.webRTCClient.stopRecording()):(lr.error("stopRecordingOutgoingStream() - not recording"),Nt(new Error("stopRecordingOutgoingStream() - not recording")))})}},{key:"init",value:function(dt){var gt=this;this.id=dt,Vs=this,as.get(this)===null&&as.set(this,setInterval(function(){am(gt)},3e4))}},{key:"setMCUServer",value:function(dt){zr.webRTCClient.setMCUConnector(dt)}},{key:"allowMultipleCalls",value:function(dt){zr.webRTCClient.setAllowMultipleCalls(dt)}},{key:"setCallStatsMonitoringEnabled",value:function(dt,gt){zr.webRTCClient.enableCallStatsMonitoring(dt,gt)}},{key:"setQualityEvaluatingEnabled",value:function(dt,gt){zr.webRTCClient.enableQualityEvaluating(dt,gt)}},{key:"getContactFromWebSession",value:function(dt){var gt=this;return new Promise(function(Nt,Vt){Bs.getSessionHistory(dt,gt.getToken()).then(function(zt){zt.exist.toString()!=="1"?Vt(Wt.g.createError(et.g.ERROR_NOT_FOUND,"No such web session",lr)):zt.user1.toString()===gt.getId()?Nt(gt.getContact(zt.user2)):zt.user2.toString()===gt.getId()?Nt(gt.getContact(zt.user1)):Vt(Wt.g.createError(et.g.ERROR_UNAUTHORIZED,"User has no access to this web session",lr))}).catch(function(zt){zt.hasOwnProperty("code")?Vt({code:zt.code,error:zt.error}):zt.hasOwnProperty("http_code")?zt.http_code.toString().startsWith("4")?Vt(Wt.g.createError(et.g.ERROR_OTHER,"Error while getting contact from websession",lr)):Vt(Wt.g.createError(et.g.ERROR_SERVER_UNAVAILABLE,"Error while getting contact from websession",lr)):Vt(Wt.g.createError(et.g.ERROR_OTHER,"Error while getting contact from websession",lr))})})}},{key:"joinPointerSharingRoom",value:function(dt){var gt=this;return new Promise(function(Nt,Vt){if(os.get(gt).hasOwnProperty(dt))return Vt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"joinPointerSharingRoom() - cannot join pointer sharing room again",lr));zr.pointerSharingClient.joinRoom(dt,{success:function(zt){var Xt=new ru(gt,zt);os.get(gt)[zt]=Xt,Nt(Xt)},failure:function(zt,Xt){Vt(zt==="timeout"?Wt.g.createError(et.g.ERROR_TIMED_OUT,"joinPointerSharingRoom() - cannot join pointer sharing room",lr):Wt.g.createError(et.g.ERROR_OTHER,"joinPointerSharingRoom() - cannot join pointer sharing room",lr))}})})}},{key:"getSubscribedPresenceGroup",value:function(){return apiCC!==void 0&&apiCC.session!==null&&apiCC.session!==void 0?apiCC.session.subscribeToPresenceGroup:[]}},{key:"getPresenceGroup",value:function(){return apiCC!==void 0&&apiCC.session!==null&&apiCC.session!==void 0?apiCC.session.presenceGroup:[]}}],kt=[{key:"getAvailableEvents",value:function(){return im}},{key:"getActiveSession",value:function(){return Vs}}],Yt&&Ku(Lt.prototype,Yt),kt&&Ku(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(fn),ru=function($t,Lt){this.session=$t,this.roomId=Lt,this.getRoomId=function(){return this.roomId},this.isActive=function(){return this.session!==null&&this.roomId!==null&&zr.pointerSharingClient.roomActive(this.roomId)},this.leaveRoom=function(){var Yt=this;return new Promise(function(kt,jt){if(Yt.session===null||Yt.roomId===null)return jt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"leaveRoom() - cannot leave room again",lr));zr.pointerSharingClient.leaveRoom(Yt.roomId),delete os.get(Yt.session)[Yt.roomId],Yt.session=null,Yt.roomId=null,kt()})},this.invite=function(Yt,kt){var jt=this;return new Promise(function(sn,ln){if(jt.session===null||jt.roomId===null)return ln(Wt.g.createError(et.g.ERROR_WRONG_STATE,"invite() - cannot invite",lr));zr.pointerSharingClient.inviteInRoom(jt.roomId,Yt.getId(),kt),sn()})},this.sendPointerLocation=function(Yt,kt,jt,sn){var ln=this;return new Promise(function(Kt,dt){return ln.session===null||ln.roomId===null?dt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"sendPointerLocation() - cannot send pointer location",lr)):zr.pointerSharingClient.sendPointerLocation(ln.roomId,Yt,kt,jt,sn)?void Kt():dt(Wt.g.createError(et.g.ERROR_WRONG_STATE,"sendPointerLocation() - cannot send pointer location",lr))})}},am=function($t){for(var Lt=$t.getActiveConferences(),Yt=0,kt=Object.keys(Lt);Yt<kt.length;Yt++){var jt=Lt[kt[Yt]];Bs.updateConferencePresence(jt,$t,zr.getActiveApiKey())}},iu=s(7618);function zs($t){var Lt=typeof Map=="function"?new Map:void 0;return zs=function(Yt){if(Yt===null||(kt=Yt,Function.toString.call(kt).indexOf("[native code]")===-1))return Yt;var kt;if(typeof Yt!="function")throw new TypeError("Super expression must either be null or a function");if(Lt!==void 0){if(Lt.has(Yt))return Lt.get(Yt);Lt.set(Yt,jt)}function jt(){return au(Yt,arguments,Fo(this).constructor)}return jt.prototype=Object.create(Yt.prototype,{constructor:{value:jt,enumerable:!1,writable:!0,configurable:!0}}),ls(jt,Yt)},zs($t)}function au($t,Lt,Yt){return au=ep()?Reflect.construct.bind():function(kt,jt,sn){var ln=[null];ln.push.apply(ln,jt);var Kt=new(Function.bind.apply(kt,ln));return sn&&ls(Kt,sn.prototype),Kt},au.apply(null,arguments)}function ou(){return ou=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function($t,Lt,Yt){var kt=om($t,Lt);if(kt){var jt=Object.getOwnPropertyDescriptor(kt,Lt);return jt.get?jt.get.call(arguments.length<3?$t:Yt):jt.value}},ou.apply(this,arguments)}function om($t,Lt){for(;!Object.prototype.hasOwnProperty.call($t,Lt)&&($t=Fo($t))!==null;);return $t}function ss($t){return ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},ss($t)}function oo(){oo=function(){return $t};var $t={},Lt=Object.prototype,Yt=Lt.hasOwnProperty,kt=typeof Symbol=="function"?Symbol:{},jt=kt.iterator||"@@iterator",sn=kt.asyncIterator||"@@asyncIterator",ln=kt.toStringTag||"@@toStringTag";function Kt(or,Zn,Tr){return Object.defineProperty(or,Zn,{value:Tr,enumerable:!0,configurable:!0,writable:!0}),or[Zn]}try{Kt({},"")}catch{Kt=function(Zn,Tr,kr){return Zn[Tr]=kr}}function dt(or,Zn,Tr,kr){var br=Zn&&Zn.prototype instanceof Vt?Zn:Vt,$a=Object.create(br.prototype),to=new Xr(kr||[]);return $a._invoke=function(vo,Oo,Wr){var po="suspendedStart";return function(So,ps){if(po==="executing")throw new Error("Generator is already running");if(po==="completed"){if(So==="throw")throw ps;return{value:void 0,done:!0}}for(Wr.method=So,Wr.arg=ps;;){var hs=Wr.delegate;if(hs){var lo=cr(hs,Wr);if(lo){if(lo===Nt)continue;return lo}}if(Wr.method==="next")Wr.sent=Wr._sent=Wr.arg;else if(Wr.method==="throw"){if(po==="suspendedStart")throw po="completed",Wr.arg;Wr.dispatchException(Wr.arg)}else Wr.method==="return"&&Wr.abrupt("return",Wr.arg);po="executing";var fs=gt(vo,Oo,Wr);if(fs.type==="normal"){if(po=Wr.done?"completed":"suspendedYield",fs.arg===Nt)continue;return{value:fs.arg,done:Wr.done}}fs.type==="throw"&&(po="completed",Wr.method="throw",Wr.arg=fs.arg)}}}(or,Tr,to),$a}function gt(or,Zn,Tr){try{return{type:"normal",arg:or.call(Zn,Tr)}}catch(kr){return{type:"throw",arg:kr}}}$t.wrap=dt;var Nt={};function Vt(){}function zt(){}function Xt(){}var Zt={};Kt(Zt,jt,function(){return this});var on=Object.getPrototypeOf,bn=on&&on(on(_i([])));bn&&bn!==Lt&&Yt.call(bn,jt)&&(Zt=bn);var En=Xt.prototype=Vt.prototype=Object.create(Zt);function Gn(or){["next","throw","return"].forEach(function(Zn){Kt(or,Zn,function(Tr){return this._invoke(Zn,Tr)})})}function Kn(or,Zn){function Tr(br,$a,to,vo){var Oo=gt(or[br],or,$a);if(Oo.type!=="throw"){var Wr=Oo.arg,po=Wr.value;return po&&ss(po)=="object"&&Yt.call(po,"__await")?Zn.resolve(po.__await).then(function(So){Tr("next",So,to,vo)},function(So){Tr("throw",So,to,vo)}):Zn.resolve(po).then(function(So){Wr.value=So,to(Wr)},function(So){return Tr("throw",So,to,vo)})}vo(Oo.arg)}var kr;this._invoke=function(br,$a){function to(){return new Zn(function(vo,Oo){Tr(br,$a,vo,Oo)})}return kr=kr?kr.then(to,to):to()}}function cr(or,Zn){var Tr=or.iterator[Zn.method];if(Tr===void 0){if(Zn.delegate=null,Zn.method==="throw"){if(or.iterator.return&&(Zn.method="return",Zn.arg=void 0,cr(or,Zn),Zn.method==="throw"))return Nt;Zn.method="throw",Zn.arg=new TypeError("The iterator does not provide a 'throw' method")}return Nt}var kr=gt(Tr,or.iterator,Zn.arg);if(kr.type==="throw")return Zn.method="throw",Zn.arg=kr.arg,Zn.delegate=null,Nt;var br=kr.arg;return br?br.done?(Zn[or.resultName]=br.value,Zn.next=or.nextLoc,Zn.method!=="return"&&(Zn.method="next",Zn.arg=void 0),Zn.delegate=null,Nt):br:(Zn.method="throw",Zn.arg=new TypeError("iterator result is not an object"),Zn.delegate=null,Nt)}function hr(or){var Zn={tryLoc:or[0]};1 in or&&(Zn.catchLoc=or[1]),2 in or&&(Zn.finallyLoc=or[2],Zn.afterLoc=or[3]),this.tryEntries.push(Zn)}function Ar(or){var Zn=or.completion||{};Zn.type="normal",delete Zn.arg,or.completion=Zn}function Xr(or){this.tryEntries=[{tryLoc:"root"}],or.forEach(hr,this),this.reset(!0)}function _i(or){if(or){var Zn=or[jt];if(Zn)return Zn.call(or);if(typeof or.next=="function")return or;if(!isNaN(or.length)){var Tr=-1,kr=function br(){for(;++Tr<or.length;)if(Yt.call(or,Tr))return br.value=or[Tr],br.done=!1,br;return br.value=void 0,br.done=!0,br};return kr.next=kr}}return{next:Vo}}function Vo(){return{value:void 0,done:!0}}return zt.prototype=Xt,Kt(En,"constructor",Xt),Kt(Xt,"constructor",zt),zt.displayName=Kt(Xt,ln,"GeneratorFunction"),$t.isGeneratorFunction=function(or){var Zn=typeof or=="function"&&or.constructor;return!!Zn&&(Zn===zt||(Zn.displayName||Zn.name)==="GeneratorFunction")},$t.mark=function(or){return Object.setPrototypeOf?Object.setPrototypeOf(or,Xt):(or.__proto__=Xt,Kt(or,ln,"GeneratorFunction")),or.prototype=Object.create(En),or},$t.awrap=function(or){return{__await:or}},Gn(Kn.prototype),Kt(Kn.prototype,sn,function(){return this}),$t.AsyncIterator=Kn,$t.async=function(or,Zn,Tr,kr,br){br===void 0&&(br=Promise);var $a=new Kn(dt(or,Zn,Tr,kr),br);return $t.isGeneratorFunction(Zn)?$a:$a.next().then(function(to){return to.done?to.value:$a.next()})},Gn(En),Kt(En,ln,"Generator"),Kt(En,jt,function(){return this}),Kt(En,"toString",function(){return"[object Generator]"}),$t.keys=function(or){var Zn=[];for(var Tr in or)Zn.push(Tr);return Zn.reverse(),function kr(){for(;Zn.length;){var br=Zn.pop();if(br in or)return kr.value=br,kr.done=!1,kr}return kr.done=!0,kr}},$t.values=_i,Xr.prototype={constructor:Xr,reset:function(or){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Ar),!or)for(var Zn in this)Zn.charAt(0)==="t"&&Yt.call(this,Zn)&&!isNaN(+Zn.slice(1))&&(this[Zn]=void 0)},stop:function(){this.done=!0;var or=this.tryEntries[0].completion;if(or.type==="throw")throw or.arg;return this.rval},dispatchException:function(or){if(this.done)throw or;var Zn=this;function Tr(Oo,Wr){return $a.type="throw",$a.arg=or,Zn.next=Oo,Wr&&(Zn.method="next",Zn.arg=void 0),!!Wr}for(var kr=this.tryEntries.length-1;kr>=0;--kr){var br=this.tryEntries[kr],$a=br.completion;if(br.tryLoc==="root")return Tr("end");if(br.tryLoc<=this.prev){var to=Yt.call(br,"catchLoc"),vo=Yt.call(br,"finallyLoc");if(to&&vo){if(this.prev<br.catchLoc)return Tr(br.catchLoc,!0);if(this.prev<br.finallyLoc)return Tr(br.finallyLoc)}else if(to){if(this.prev<br.catchLoc)return Tr(br.catchLoc,!0)}else{if(!vo)throw new Error("try statement without catch or finally");if(this.prev<br.finallyLoc)return Tr(br.finallyLoc)}}}},abrupt:function(or,Zn){for(var Tr=this.tryEntries.length-1;Tr>=0;--Tr){var kr=this.tryEntries[Tr];if(kr.tryLoc<=this.prev&&Yt.call(kr,"finallyLoc")&&this.prev<kr.finallyLoc){var br=kr;break}}br&&(or==="break"||or==="continue")&&br.tryLoc<=Zn&&Zn<=br.finallyLoc&&(br=null);var $a=br?br.completion:{};return $a.type=or,$a.arg=Zn,br?(this.method="next",this.next=br.finallyLoc,Nt):this.complete($a)},complete:function(or,Zn){if(or.type==="throw")throw or.arg;return or.type==="break"||or.type==="continue"?this.next=or.arg:or.type==="return"?(this.rval=this.arg=or.arg,this.method="return",this.next="end"):or.type==="normal"&&Zn&&(this.next=Zn),Nt},finish:function(or){for(var Zn=this.tryEntries.length-1;Zn>=0;--Zn){var Tr=this.tryEntries[Zn];if(Tr.finallyLoc===or)return this.complete(Tr.completion,Tr.afterLoc),Ar(Tr),Nt}},catch:function(or){for(var Zn=this.tryEntries.length-1;Zn>=0;--Zn){var Tr=this.tryEntries[Zn];if(Tr.tryLoc===or){var kr=Tr.completion;if(kr.type==="throw"){var br=kr.arg;Ar(Tr)}return br}}throw new Error("illegal catch attempt")},delegateYield:function(or,Zn,Tr){return this.delegate={iterator:_i(or),resultName:Zn,nextLoc:Tr},this.method==="next"&&(this.arg=void 0),Nt}},$t}function Xu($t,Lt,Yt,kt,jt,sn,ln){try{var Kt=$t[sn](ln),dt=Kt.value}catch(gt){return void Yt(gt)}Kt.done?Lt(dt):Promise.resolve(dt).then(kt,jt)}function Uo($t){return function(){var Lt=this,Yt=arguments;return new Promise(function(kt,jt){var sn=$t.apply(Lt,Yt);function ln(dt){Xu(sn,kt,jt,ln,Kt,"next",dt)}function Kt(dt){Xu(sn,kt,jt,ln,Kt,"throw",dt)}ln(void 0)})}}function $o($t,Lt){var Yt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Yt){if(Array.isArray($t)||(Yt=function(dt,gt){if(dt){if(typeof dt=="string")return Qu(dt,gt);var Nt=Object.prototype.toString.call(dt).slice(8,-1);return Nt==="Object"&&dt.constructor&&(Nt=dt.constructor.name),Nt==="Map"||Nt==="Set"?Array.from(dt):Nt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Nt)?Qu(dt,gt):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Yt&&($t=Yt);var kt=0,jt=function(){};return{s:jt,n:function(){return kt>=$t.length?{done:!0}:{done:!1,value:$t[kt++]}},e:function(dt){throw dt},f:jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Kt=!1;return{s:function(){Yt=Yt.call($t)},n:function(){var dt=Yt.next();return ln=dt.done,dt},e:function(dt){Kt=!0,sn=dt},f:function(){try{ln||Yt.return==null||Yt.return()}finally{if(Kt)throw sn}}}}function Qu($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function Hs($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Zu($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function Gs($t,Lt,Yt){return Lt&&Zu($t.prototype,Lt),Yt&&Zu($t,Yt),Object.defineProperty($t,"prototype",{writable:!1}),$t}function qs($t,Lt){if(typeof Lt!="function"&&Lt!==null)throw new TypeError("Super expression must either be null or a function");$t.prototype=Object.create(Lt&&Lt.prototype,{constructor:{value:$t,writable:!0,configurable:!0}}),Object.defineProperty($t,"prototype",{writable:!1}),Lt&&ls($t,Lt)}function ls($t,Lt){return ls=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},ls($t,Lt)}function Js($t){var Lt=ep();return function(){var Yt,kt=Fo($t);if(Lt){var jt=Fo(this).constructor;Yt=Reflect.construct(kt,arguments,jt)}else Yt=kt.apply(this,arguments);return sm(this,Yt)}}function sm($t,Lt){if(Lt&&(ss(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zr($t)}function Zr($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function ep(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fo($t){return Fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Fo($t)}var Un=ft.Y.get("Stream"),su=On.get(),lm=uo.get(),cm=["stopped","trackStopped","audioAmplitude","audioAmplitudeInfo","muteStateChange","activeStateChange","backgroundSubstractionStopVisibilityChange","backgroundSubstractionStopComputeTime","AIESnapshot","AIELog","flowStatusChanged","audioFlowStatusChanged","videoFlowStatusChanged","remoteAudioFlowStatusChanged","remoteVideoFlowStatusChanged","release","constraintsChanged"],yo=new Map,Ks=new WeakMap,cs=new WeakMap,ds=new WeakMap,lu=new WeakMap,Yo={},so=function($t){qs(Yt,$t);var Lt=Js(Yt);function Yt(kt){var jt,sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Hs(this,Yt),jt=Lt.call(this,Un),sn.constructor!==!0)throw new Error("Stream constructor should not be used directly, please use a static method of class Stream such as : createStreamFromUserMedia, createStreamFromMediaStream, createScreensharingStream");if(delete sn.constructor,!sn.hasOwnProperty("type"))throw new Error("Cannot create Stream with no type");if(Un.debug("Create Stream with options",sn),jt.data=kt,jt.audioInput=sn.hasOwnProperty("audioInput")?sn.audioInput:null,jt.videoInput=sn.hasOwnProperty("videoInput")?sn.videoInput:null,jt.audioFilterIsApplied=!1,jt.videoFilterIsApplied=!1,jt.audioAppliedFilter="none",jt.videoAppliedFilter="none",jt.originalMediaTrack=null,sn.hasOwnProperty("userMediaStreamId")?(jt.userMediaStreamId=sn.userMediaStreamId,jt.isRemote=!1,yo.set(jt.userMediaStreamId,Zr(jt))):(jt.userMediaStreamId=null,jt.isRemote=!0),Wt.g.isPropertyTypeof(sn,"streamId","number")?jt.streamId=sn.streamId:jt.userMediaStreamId!==null?jt.streamId=Number(jt.userMediaStreamId):Number.MAX_SAFE_INTEGER!==void 0?jt.streamId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER):jt.streamId=Math.floor(1024*Math.random()*1024*1024),jt.contact=sn.hasOwnProperty("contact")?sn.contact:null,sn.hasOwnProperty("callId")?(jt.callId=sn.callId,jt.callAudioAvailable=sn.callAudioAvailable,jt.callAudioActive=sn.callAudioActive,jt.callAudioMuted=sn.callAudioMuted,jt.callAudioSilent=sn.callAudioSilent,jt.callVideoAvailable=sn.callVideoAvailable,jt.callVideoActive=sn.callVideoActive,jt.callVideoMuted=sn.callVideoMuted,jt.callVideoSilent=sn.callVideoSilent):jt.callId=null,jt.publishedInConversations=new Map,jt.mediaRecorder=null,jt.recordedBlobs=[],Ks.set(Zr(jt),!!sn.hasOwnProperty("screensharing")&&sn.screensharing),cs.set(Zr(jt),null),ds.set(Zr(jt),null),jt.screensharingRemoteAccessStream=!1,apiRTC.userAgentInstance.apiRTCStreamsList.set(jt.streamId,Zr(jt)),jt.type=sn.type,apiRTC.browser!=="IE"&&jt.data!==null){var ln,Kt=function(on){on.addEventListener("ended",function(bn){Yo.hasOwnProperty(on.id)||(nn.get(Zr(jt)).emit("trackStopped",{type:on.kind,id:on.id,reason:"ended"}),Yo[on.id]=!0)})},dt=$o(jt.data.getVideoTracks());try{for(dt.s();!(ln=dt.n()).done;){var gt=ln.value;Kt(gt)}}catch(on){dt.e(on)}finally{dt.f()}var Nt,Vt=$o(jt.data.getAudioTracks());try{for(Vt.s();!(Nt=Vt.n()).done;){var zt=Nt.value;Kt(zt)}}catch(on){Vt.e(on)}finally{Vt.f()}}var Xt={};if(Wt.g.isTypeof(jt.userMediaStreamId,"string")?(Xt.userMediaStop=function(on){if(on.detail.userMediaStreamId===jt.userMediaStreamId){var bn={streamId:jt.streamId,userMediaStreamId:jt.userMediaStreamId};nn.get(Zr(jt)).emit("stopped",bn);var En=lu.get(Zr(jt));if(En)for(var Gn in En)apiRTC.removeEventListener(Gn,En[Gn])}},Xt.localStreamUpdated=function(on){if(on.detail.userMediaStreamId===jt.userMediaStreamId&&on.detail.callId===null){if(on.detail.changeList.indexOf("audioIsMuted")>=0){var bn={streamId:jt.streamId,userMediaStreamId:jt.userMediaStreamId,type:"audio",muted:on.detail.audioIsMuted};nn.get(Zr(jt)).emit("muteStateChange",bn),jt.sendAudioFlowStatusChanged(),jt.sendFlowStatusChanged("audio")}if(on.detail.changeList.indexOf("videoIsMuted")>=0){var En={streamId:jt.streamId,userMediaStreamId:jt.userMediaStreamId,type:"video",muted:on.detail.videoIsMuted};nn.get(Zr(jt)).emit("muteStateChange",En),jt.sendVideoFlowStatusChanged(),jt.sendFlowStatusChanged("video")}on.detail.changeList.indexOf("audioIsSilent")>=0&&(jt.sendAudioFlowStatusChanged(),jt.sendFlowStatusChanged("audio")),on.detail.changeList.indexOf("videoIsSilent")>=0&&(jt.sendVideoFlowStatusChanged(),jt.sendFlowStatusChanged("video"))}},Xt.backgroundSubstractionStopVisibilityChange=function(on){if(on.detail.userMediaStreamId===jt.userMediaStreamId){var bn={streamId:jt.streamId,userMediaStreamId:jt.userMediaStreamId};nn.get(Zr(jt)).emit("backgroundSubstractionStopVisibilityChange",bn)}},Xt.backgroundSubstractionStopComputeTime=function(on){if(on.detail.userMediaStreamId===jt.userMediaStreamId){var bn={streamId:jt.streamId,userMediaStreamId:jt.userMediaStreamId};nn.get(Zr(jt)).emit("backgroundSubstractionStopComputeTime",bn)}},Xt.AIESnapshot=function(on){if(on.detail.userMediaStreamId===jt.userMediaStreamId){var bn=on.detail.image;nn.get(Zr(jt)).emit("AIESnapshot",bn)}},Xt.AIELog=function(on){if(on.detail.userMediaStreamId===jt.userMediaStreamId){var bn=on.detail.log;nn.get(Zr(jt)).emit("AIELog",bn)}}):Wt.g.isTypeof(jt.callId,"string")&&(Xt.hangup=function(on){if(on.detail.hangupType==="remote"&&on.detail.callId===jt.callId){var bn={streamId:jt.streamId,callId:jt.callId};nn.get(Zr(jt)).emit("stopped",bn);var En=lu.get(Zr(jt));for(var Gn in En)apiRTC.removeEventListener(Gn,En[Gn])}},Xt.remoteStreamUpdated=function(on){if(on.detail.callId===jt.callId){if(on.detail.changeList.indexOf("audioIsActive")>=0){jt.callAudioActive=on.detail.audioIsActive;var bn={streamId:jt.streamId,callId:jt.callId,type:"audio",active:on.detail.audioIsActive};nn.get(Zr(jt)).emit("activeStateChange",bn)}if(on.detail.changeList.indexOf("audioIsMuted")>=0){jt.callAudioMuted=on.detail.audioIsMuted;var En={streamId:jt.streamId,callId:jt.callId,type:"audio",muted:on.detail.audioIsMuted};nn.get(Zr(jt)).emit("muteStateChange",En),jt.sendRemoteAudioFlowStatusChanged({enabled:!on.detail.audioIsMuted,muted:on.detail.audioIsSilent}),jt.sendFlowStatusChangedForRemote("audio",{enabled:!on.detail.audioIsMuted,muted:on.detail.audioIsSilent})}if(on.detail.changeList.indexOf("videoIsActive")>=0){jt.callVideoActive=on.detail.videoIsActive;var Gn={streamId:jt.streamId,callId:jt.callId,type:"video",active:on.detail.videoIsActive};nn.get(Zr(jt)).emit("activeStateChange",Gn)}if(on.detail.changeList.indexOf("videoIsMuted")>=0){jt.callVideoMuted=on.detail.videoIsMuted;var Kn={streamId:jt.streamId,callId:jt.callId,type:"video",muted:on.detail.videoIsMuted};nn.get(Zr(jt)).emit("muteStateChange",Kn),jt.sendRemoteVideoFlowStatusChanged({enabled:!on.detail.videoIsMuted,muted:on.detail.videoIsSilent}),jt.sendFlowStatusChangedForRemote("video",{enabled:!on.detail.videoIsMuted,muted:on.detail.videoIsSilent})}on.detail.changeList.indexOf("audioIsSilent")>=0&&(jt.callAudioSilent=on.detail.audioIsSilent,jt.sendRemoteAudioFlowStatusChanged({enabled:!on.detail.audioIsMuted,muted:on.detail.audioIsSilent}),jt.sendFlowStatusChangedForRemote("audio",{enabled:!on.detail.audioIsMuted,muted:on.detail.audioIsSilent})),on.detail.changeList.indexOf("videoIsSilent")>=0&&(jt.callVideoSilent=on.detail.videoIsSilent,jt.sendRemoteVideoFlowStatusChanged({enabled:!on.detail.videoIsMuted,muted:on.detail.videoIsSilent}),jt.sendFlowStatusChangedForRemote("video",{enabled:!on.detail.videoIsMuted,muted:on.detail.videoIsSilent})),on.detail.changeList.indexOf("audioIsSilentLocally")>=0&&(jt.sendAudioFlowStatusChanged(),jt.sendFlowStatusChanged("audio")),on.detail.changeList.indexOf("videoIsSilentLocally")>=0&&(jt.sendVideoFlowStatusChanged(),jt.sendFlowStatusChanged("video"))}}),Object.keys(Xt).length>0)for(var Zt in lu.set(Zr(jt),Xt),Xt)apiRTC.addEventListener(Zt,Xt[Zt]);return jt}return Gs(Yt,[{key:"getContact",value:function(){return this.contact}},{key:"getData",value:function(){return this.data}},{key:"getConversations",value:function(){var kt,jt=[],sn=$o(this.publishedInConversations.keys());try{for(sn.s();!(kt=sn.n()).done;){var ln=kt.value;jt.push(lm.getConversations(ln))}}catch(Kt){sn.e(Kt)}finally{sn.f()}return jt}},{key:"isScreensharing",value:function(){return Ks.get(this)}},{key:"isScreensharingRemoteAccess",value:function(){return this.screensharingRemoteAccessStream}},{key:"hasData",value:function(){return this.data!==null}},{key:"hasVideo",value:function(){return this.callId?this.callVideoAvailable&&this.callVideoActive:!!this.hasData()&&this.data.getVideoTracks().length>0}},{key:"hasAudio",value:function(){return this.callId?this.callAudioAvailable&&this.callAudioActive:!!this.hasData()&&this.data.getAudioTracks().length>0}},{key:"isVideoMuted",value:function(){if(this.callId)return this.callVideoSilent;if(this.hasData()){var kt=this.data.getVideoTracks();if(kt&&kt.length>0)return kt[0].muted}return!0}},{key:"isVideoEnabled",value:function(){if(this.callId)return!this.callVideoMuted;if(this.hasData()){var kt=this.data.getVideoTracks();return kt&&kt.length>0&&kt[0].enabled}return!1}},{key:"isAudioMuted",value:function(){if(this.callId)return this.callAudioSilent;if(this.hasData()){var kt=this.data.getAudioTracks();if(kt&&kt.length>0)return kt[0].muted}return!0}},{key:"isAudioEnabled",value:function(){if(this.callId)return!this.callAudioMuted;if(this.hasData()){var kt=this.data.getAudioTracks();return kt&&kt.length>0&&kt[0].enabled}return!1}},{key:"getType",value:function(){return this.type}},{key:"release",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.childType==="noiseReduction"&&this.parent!==void 0){apiCC.audioProcessor.stopAudioNodeCtx(this.parent.nodeCtx);var jt=apiCC.getUserMediaStream(this.parent.userMediaStreamId);apiCC.audioProcessor.listenToAudio(this.parent.data,jt)}this.hasData()&&(this.releaseAudio(),this.releaseVideo(),this.data=null,this.userMediaStreamId&&(apiCC.releaseUserMediaStream(this.userMediaStreamId),yo.delete(this.userMediaStreamId))),nn.get(this).emit("release",{streamId:this.streamId,userMediaStreamId:this.userMediaStreamId}),kt.releaseChildrenStream!==!1&&this.releaseAllChildren(),kt.releaseParentStream!==!1&&this.parent!==void 0&&(Un.debug("release parent is also requested"),this.parent.release(kt)),console.debug("Removing in apiRTCStreamsList :",this.streamId),apiRTC.userAgentInstance.apiRTCStreamsList.delete(this.streamId)}},{key:"releaseAudio",value:function(){var kt=this;this.hasData()&&(this.disableAudioAnalysis(),this.data.getAudioTracks().forEach(function(jt){jt.stop(),Yo.hasOwnProperty(jt.id)||(nn.get(kt).emit("trackStopped",{type:jt.kind,id:jt.id,reason:"releaseAudio"}),Yo[jt.id]=!0)}))}},{key:"releaseVideo",value:function(){var kt=this;this.hasData()&&this.data.getVideoTracks().forEach(function(jt){jt.stop(),Yo.hasOwnProperty(jt.id)||(nn.get(kt).emit("trackStopped",{type:jt.kind,id:jt.id,reason:"releaseVideo"}),Yo[jt.id]=!0)})}},{key:"muteAudio",value:function(){Un.warn("This method is deprecated now, please use Stream.disableAudio() instead"),this.disableAudio()}},{key:"muteVideo",value:function(){Un.warn("This method is deprecated now, please use Stream.disableVideo() instead"),this.disableVideo()}},{key:"unmuteAudio",value:function(){Un.warn("This method is deprecated now, please use Stream.enableAudio() instead"),this.enableAudio()}},{key:"unmuteVideo",value:function(){Un.warn("This method is deprecated now, please use Stream.enableVideo() instead"),this.enableVideo()}},{key:"sendStreamRequest",value:function(kt,jt,sn){var ln={};ln.streamId=this.streamId;var Kt=this.publishedInConversations.keys();ln.roomname=Kt.next().value,this.contact.sendRequest(kt,ln).then(function(){return jt()}).catch(function(dt){return Un.error("Error on sendRequest :",dt),sn()})}},{key:"enableAudio",value:function(){var kt=this,jt=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Uo(oo().mark(function ln(Kt,dt){var gt;return oo().wrap(function(Nt){for(;;)switch(Nt.prev=Nt.next){case 0:if(kt.isAudioEnabled()!==!0||kt.isRemote!==!1){Nt.next=3;break}return Un.debug("audio already enabled"),Nt.abrupt("return",Kt());case 3:if(!kt.userMediaStreamId){Nt.next=16;break}if(gt=apiCC.getUserMediaStream(kt.userMediaStreamId)){Nt.next=7;break}return Nt.abrupt("return",dt());case 7:if(gt.unMuteAudioOnStreams("enabled"),kt.parent===void 0){Nt.next=12;break}return Un.debug("this is a child stream, need to unmute parent if necessary"),Nt.next=12,kt.parent.enableAudio();case 12:return kt.childrens!==void 0&&kt.childrens.forEach(function(){var Vt=Uo(oo().mark(function zt(Xt,Zt){return oo().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return on.next=2,Xt.enableAudio();case 2:case"end":return on.stop()}},zt)}));return function(zt,Xt){return Vt.apply(this,arguments)}}()),Nt.abrupt("return",Kt());case 16:if(!kt.callId){Nt.next=29;break}if(jt!==!0){Nt.next=23;break}Un.debug("enableAudio remote with applyRemotely"),Un.debug("this.contact :",kt.contact),kt.sendStreamRequest(et.g.CONTACT_ENABLE_AUDIO_REQUEST,Kt,dt),Nt.next=28;break;case 23:if(kt.hasData()){Nt.next=25;break}return Nt.abrupt("return",dt());case 25:kt.data.getAudioTracks().forEach(function(Vt){Vt.enabled=!0}),kt.sendAudioFlowStatusChanged(),kt.sendFlowStatusChanged("audio");case 28:return Nt.abrupt("return",Kt());case 29:return Nt.abrupt("return",dt());case 30:case"end":return Nt.stop()}},ln)}));return function(ln,Kt){return sn.apply(this,arguments)}}())}},{key:"disableAudio",value:function(){var kt=this,jt=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Uo(oo().mark(function ln(Kt,dt){var gt;return oo().wrap(function(Nt){for(;;)switch(Nt.prev=Nt.next){case 0:if(kt.isAudioEnabled()!==!1||kt.isRemote!==!1){Nt.next=3;break}return Un.debug("audio already disabled"),Nt.abrupt("return",Kt());case 3:if(!kt.userMediaStreamId){Nt.next=16;break}if(gt=apiCC.getUserMediaStream(kt.userMediaStreamId)){Nt.next=7;break}return Nt.abrupt("return",dt());case 7:if(gt.muteAudioOnStreams("enabled"),kt.parent===void 0){Nt.next=12;break}return Un.debug("this is a child stream, need to mute parent if necessary"),Nt.next=12,kt.parent.disableAudio();case 12:return kt.childrens!==void 0&&kt.childrens.forEach(function(){var Vt=Uo(oo().mark(function zt(Xt,Zt){return oo().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return on.next=2,Xt.disableAudio();case 2:case"end":return on.stop()}},zt)}));return function(zt,Xt){return Vt.apply(this,arguments)}}()),Nt.abrupt("return",Kt());case 16:if(!kt.callId){Nt.next=29;break}if(jt!==!0){Nt.next=23;break}Un.debug("disableAudio remote with applyRemotely"),Un.debug("this.contact :",kt.contact),kt.sendStreamRequest(et.g.CONTACT_DISABLE_AUDIO_REQUEST,Kt,dt),Nt.next=28;break;case 23:if(kt.hasData()){Nt.next=25;break}return Nt.abrupt("return",dt());case 25:kt.data.getAudioTracks().forEach(function(Vt){Vt.enabled=!1}),kt.sendAudioFlowStatusChanged(),kt.sendFlowStatusChanged("audio");case 28:return Nt.abrupt("return",Kt());case 29:return Nt.abrupt("return",dt());case 30:case"end":return Nt.stop()}},ln)}));return function(ln,Kt){return sn.apply(this,arguments)}}())}},{key:"enableVideo",value:function(){var kt=this,jt=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Uo(oo().mark(function ln(Kt,dt){var gt;return oo().wrap(function(Nt){for(;;)switch(Nt.prev=Nt.next){case 0:if(kt.isVideoEnabled()!==!0||kt.isRemote!==!1){Nt.next=3;break}return Un.debug("video already enabled"),Nt.abrupt("return",Kt());case 3:if(!kt.userMediaStreamId){Nt.next=16;break}if(gt=apiCC.getUserMediaStream(kt.userMediaStreamId)){Nt.next=7;break}return Nt.abrupt("return",dt());case 7:if(gt.unMuteVideoOnStreams("enabled"),kt.parent===void 0){Nt.next=12;break}return Un.debug("this is a child stream, need to unmute parent if necessary"),Nt.next=12,kt.parent.enableVideo();case 12:return kt.childrens!==void 0&&kt.childrens.forEach(function(){var Vt=Uo(oo().mark(function zt(Xt,Zt){return oo().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return on.next=2,Xt.enableVideo();case 2:case"end":return on.stop()}},zt)}));return function(zt,Xt){return Vt.apply(this,arguments)}}()),Nt.abrupt("return",Kt());case 16:if(!kt.callId){Nt.next=29;break}if(jt!==!0){Nt.next=23;break}Un.debug("enableVideo remote with applyRemotely"),Un.debug("this.contact :",kt.contact),kt.sendStreamRequest(et.g.CONTACT_ENABLE_VIDEO_REQUEST,Kt,dt),Nt.next=28;break;case 23:if(kt.hasData()){Nt.next=25;break}return Nt.abrupt("return",dt());case 25:kt.data.getVideoTracks().forEach(function(Vt){Vt.enabled=!0}),kt.sendVideoFlowStatusChanged(),kt.sendFlowStatusChanged("video");case 28:return Nt.abrupt("return",Kt());case 29:return Nt.abrupt("return",dt());case 30:case"end":return Nt.stop()}},ln)}));return function(ln,Kt){return sn.apply(this,arguments)}}())}},{key:"disableVideo",value:function(){var kt=this,jt=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Uo(oo().mark(function ln(Kt,dt){var gt;return oo().wrap(function(Nt){for(;;)switch(Nt.prev=Nt.next){case 0:if(kt.isVideoEnabled()!==!1||kt.isRemote!==!1){Nt.next=3;break}return Un.debug("video already disabled"),Nt.abrupt("return",Kt());case 3:if(!kt.userMediaStreamId){Nt.next=16;break}if(gt=apiCC.getUserMediaStream(kt.userMediaStreamId)){Nt.next=7;break}return Nt.abrupt("return",dt());case 7:if(gt.muteVideoOnStreams("enabled"),kt.parent===void 0){Nt.next=12;break}return Un.debug("this is a child stream, need to mute parent if necessary"),Nt.next=12,kt.parent.disableVideo();case 12:return kt.childrens!==void 0&&kt.childrens.forEach(function(){var Vt=Uo(oo().mark(function zt(Xt,Zt){return oo().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return on.next=2,Xt.disableVideo();case 2:case"end":return on.stop()}},zt)}));return function(zt,Xt){return Vt.apply(this,arguments)}}()),Nt.abrupt("return",Kt());case 16:if(!kt.callId){Nt.next=29;break}if(jt!==!0){Nt.next=23;break}Un.debug("disableVideo remote with applyRemotely"),Un.debug("this.contact :",kt.contact),kt.sendStreamRequest(et.g.CONTACT_DISABLE_VIDEO_REQUEST,Kt,dt),Nt.next=28;break;case 23:if(kt.hasData()){Nt.next=25;break}return Nt.abrupt("return",dt());case 25:kt.data.getVideoTracks().forEach(function(Vt){Vt.enabled=!1}),kt.sendVideoFlowStatusChanged(),kt.sendFlowStatusChanged("video");case 28:return Nt.abrupt("return",Kt());case 29:return Nt.abrupt("return",dt());case 30:case"end":return Nt.stop()}},ln)}));return function(ln,Kt){return sn.apply(this,arguments)}}())}},{key:"getAudioFlowStatus",value:function(){var kt={};return this.data.getAudioTracks().forEach(function(jt){kt.enabled=jt.enabled,kt.muted=jt.muted}),kt}},{key:"getVideoFlowStatus",value:function(){var kt={};return this.data.getVideoTracks().forEach(function(jt){kt.enabled=jt.enabled,kt.muted=jt.muted}),kt}},{key:"getRemoteAudioFlowStatus",value:function(){var kt=this;return new Promise(function(jt,sn){if(!kt.isRemote)return sn("Please use this function on a remote Stream");if(Un.debug("getRemoteAudioFlowStatus()"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getRemoteAudioFlowStatus",jt,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"getRemoteVideoFlowStatus",value:function(){var kt=this;return new Promise(function(jt,sn){if(!kt.isRemote)return sn("Please use this function on a remote Stream");if(Un.debug("getRemoteVideoFlowStatus()"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getRemoteVideoFlowStatus",jt,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"attachToElement",value:function(kt){Un.debug("attachToElement"),su.attachMediaStream(kt,this.data)}},{key:"addInDiv",value:function(kt,jt,sn,ln,Kt){Un.debug("addInDiv"),su.addStreamInDiv(this.data,this.type,kt,jt,sn,ln,Kt)}},{key:"removeFromDiv",value:function(kt,jt){Un.debug("removeFromDiv"),su.removeElementFromDiv(kt,jt)}},{key:"startRecord",value:function(kt){return Un.info("startRecord :",kt),apiCC.recordMgr.record(this.data,kt)}},{key:"stopRecord",value:function(){return Un.info("stopRecord() - Stopping record"),apiCC.recordMgr.stop()}},{key:"pauseRecord",value:function(){return Un.info("pauseRecord() - Pausing record"),apiCC.recordMgr.pause()}},{key:"resumeRecord",value:function(){return Un.info("resumeRecord() - Resuming record"),apiCC.recordMgr.resume()}},{key:"enableAudioAnalysis",value:function(){var kt=this,jt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Un.info("enableAudioAnalysis()");var sn=Wt.g.getAudioContext(),ln=null,Kt=!1,dt=ds.get(this),gt=cs.get(this);sn?this.hasData()?dt!==null||gt!==null?Un.error("enableAudioAnalysis() - Audio analysis already enabled"):(dt=sn.createMediaStreamSource(this.data),(gt=sn.createScriptProcessor(2048,1,1)).connect(sn.destination),gt.onaudioprocess=function(){var Nt,Vt=new Uint8Array(gt.analyser.frequencyBinCount),zt=0;gt.analyser.getByteFrequencyData(Vt);var Xt,Zt=$o(Vt);try{for(Zt.s();!(Xt=Zt.n()).done;)zt+=Xt.value}catch(Gn){Zt.e(Gn)}finally{Zt.f()}Nt=zt/Vt.length,nn.get(kt).emit("audioAmplitude",Nt);var on=0;Vt.sort(function(Gn,Kn){return Kn-Gn}),Vt=Vt.slice(0,50);for(var bn=0;bn<Vt.length;bn++)on+=Vt[bn];Nt=on/Vt.length;var En=typeof jt.threshold=="number"?jt.threshold:et.g.STREAM_AUDIO_ANALYSIS_THRESHOLD;Nt>En&&(Kt||(Kt=!0,nn.get(kt).emit("audioAmplitudeInfo",{amplitude:Nt,isSpeaking:!0})),ln!==null&&clearTimeout(ln),ln=setTimeout(function(){nn.get(kt).emit("audioAmplitudeInfo",{amplitude:Nt,isSpeaking:!1}),Kt=!1},1e3))},gt.analyser=sn.createAnalyser(),gt.analyser.smoothingTimeConstant=.5,gt.analyser.fftSize=1024,dt.connect(gt.analyser),gt.analyser.connect(gt),cs.set(this,gt),ds.set(this,dt)):Un.error("enableAudioAnalysis() - Stream has no data, unable to enable audio analysis"):Un.error("enableAudioAnalysis() - AudioContext is not available, unable to enable audio analysis")}},{key:"disableAudioAnalysis",value:function(){Un.info("disableAudioAnalysis()");var kt=ds.get(this),jt=cs.get(this);kt!==null&&kt.disconnect(),jt!==null&&(jt.analyser.disconnect(),jt.disconnect()),cs.set(this,null),ds.set(this,null)}},{key:"takeSnapshot",value:function(){var kt=this,jt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Un.info("takeSnapshot()");var sn=null,ln=null;return new Promise(function(Kt,dt){if(kt.hasData()){kt.hasVideo()||Un.warn("takeSnapshot() - This stream does not have a video track"),sn=document.createElement("video"),ln=function(zt){if(gt.width=sn.videoWidth,gt.height=sn.videoHeight,jt.hasOwnProperty("width")&&(gt.width=jt.width),jt.hasOwnProperty("height")&&(gt.height=jt.height),jt.hasOwnProperty("filters")){for(var Xt=[],Zt=0,on=Object.keys(jt.filters);Zt<on.length;Zt++){var bn=on[Zt];Xt.push(bn+"("+jt.filters[bn]+")")}Nt.filter=Xt.join(" ")}Nt.drawImage(sn,0,0,gt.width,gt.height),zt===!0&&sn.remove(),jt.hasOwnProperty("output")&&jt.output==="blob"?jt.outputMimeType!==void 0?(Un.debug("options.outputMimeType is defined :",jt.outputMimeType),gt.toBlob(function(En){Kt(En)},jt.outputMimeType,jt.outputQualityArgument)):gt.toBlob(function(En){Kt(En)},"image/png"):jt.outputMimeType!==void 0?(Un.debug("options.outputMimeType is defined :",jt.outputMimeType),Kt(gt.toDataURL(jt.outputMimeType,jt.outputQualityArgument))):Kt(gt.toDataURL("image/png"))};var gt=document.createElement("canvas"),Nt=gt.getContext("2d");jt.divId===void 0||jt.divId===null?setTimeout(function(){kt.attachToElement(sn),sn.addEventListener("canplay",function(){ln(!0)}),sn.muted=!0,sn.play()},1e3):(sn=document.getElementById(jt.divId))===null?Un.error("divId not found for snapshot"):ln(!1)}else{var Vt="takeSnapshot() - Stream has no data, cannot get snapshot";Un.error(Vt),dt(new Error(Vt))}})}},{key:"getId",value:function(){return String(this.streamId)}},{key:"getOwner",value:function(){return this.contact?this.contact:Br.getActiveSession().getUserAgent()}},{key:"getLabels",value:function(){var kt={};return this.hasData()&&this.data.getAudioTracks().length>0&&(kt.audioSourceLabel="",this.data.getAudioTracks()[0].label&&(kt.audioSourceLabel=this.data.getAudioTracks()[0].label)),this.hasData()&&this.data.getVideoTracks().length>0&&(kt.videoSourceLabel="",this.data.getVideoTracks()[0].label&&(kt.videoSourceLabel=this.data.getVideoTracks()[0].label)),Un.debug("getLabels:",kt),kt}},{key:"checkImageCaptureCompatibility",value:function(){return typeof ImageCapture>"u"}},{key:"getLocalMediaStreamTrack",value:function(){var kt=null;return this.data.getVideoTracks().length===1&&(kt=this.data.getVideoTracks()[0]),kt}},{key:"getLocalMediaStreamAudioTrack",value:function(){var kt=null;return this.data.getAudioTracks().length===1&&(kt=this.data.getAudioTracks()[0]),kt}},{key:"applyConstraints",value:function(kt){var jt=this;return new Promise(function(sn,ln){if(jt.isRemote){if(Un.debug("applyConstraints() on a remote stream"),jt.contact===null)return ln("No contact associated");var Kt=jt.addPendingPromise("applyConstraints",sn,ln);jt.contact.sendCustomEvent(et.g.CONTACT_APPLY_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:jt.callId,streamId:jt.getId(),timeout:Kt,constraints:kt})}else{if(Un.debug("applyConstraints() local"),!MediaStreamTrack.prototype.hasOwnProperty("applyConstraints"))return ln("Navigator not compatible with this function");var dt=null,gt=null;if(kt===void 0)return ln("Missing argument");kt.audio!==void 0&&(dt=jt.getLocalMediaStreamAudioTrack().applyConstraints(kt.audio)),kt.video!==void 0&&(gt=jt.getLocalMediaStreamTrack().applyConstraints(kt.video)),Promise.all([dt,gt]).then(function(Nt){Un.debug("Constraints applied :",kt);var Vt,zt=uo.get().getConversations(),Xt=$o(zt.keys());try{for(Xt.s();!(Vt=Xt.n()).done;){var Zt=Vt.value,on=zt.get(Zt).getContactsArray(),bn=void 0;for(bn=0;bn<on.length;bn++)on[bn].sendCustomEvent(et.g.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:jt.callId,streamId:jt.getId(),constraints:kt,mediaStreamId:jt.data.id})}}catch(Gn){Xt.e(Gn)}finally{Xt.f()}if(jt.callId!==null){Un.debug("This stream is used in a call, send CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER to remote");var En=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(jt.callId);En!==null&&Br.getActiveSession().getOrCreateContact(En.remoteId).sendCustomEvent(et.g.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:jt.callId,streamId:jt.getId(),constraints:kt,mediaStreamId:jt.data.id})}return sn()}).catch(function(Nt){return Un.error("reject Promise all :",Nt),ln(Nt)})}})}},{key:"applyConstraint",value:function(kt,jt){Un.error("Due to a certain amount of problems with this function it has been desactivated, please use Stream.applyConstraints instead")}},{key:"setCapability",value:function(kt,jt){Un.error("Due to a certain amount of problems with this function it has been desactivated, please use Stream.applyConstraints instead")}},{key:"getSettings",value:function(){var kt=this;return new Promise(function(jt,sn){if(!kt.isRemote)return Un.debug("getSettings()"),MediaStreamTrack.prototype.hasOwnProperty("getSettings")?jt({audio:kt.getStreamTrackSettings(kt.getLocalMediaStreamAudioTrack()),video:kt.getStreamTrackSettings(kt.getLocalMediaStreamTrack())}):sn("Navigator not compatible with this function");if(Un.error("getSettings() on a remote stream"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getSettings",jt,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_SETTINGS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"getStreamTrackSettings",value:function(kt){if(kt!==null)return kt.getSettings()}},{key:"getCapabilities",value:function(){var kt=this;return new Promise(function(jt,sn){if(!kt.isRemote)return Un.debug("getCapabilities()"),MediaStreamTrack.prototype.hasOwnProperty("getCapabilities")?jt({audio:kt.getStreamTrackCapabilities(kt.getLocalMediaStreamAudioTrack()),video:kt.getStreamTrackCapabilities(kt.getLocalMediaStreamTrack())}):sn("Navigator not compatible with this function");if(Un.debug("getCapabilities() on a remote stream"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getCapabilities",jt,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_CAPABILITIES_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"getStreamTrackCapabilities",value:function(kt){return kt!==null?kt.getCapabilities():{}}},{key:"getConstraints",value:function(){var kt=this;return new Promise(function(jt,sn){if(!kt.isRemote)return Un.debug("getConstraints()"),MediaStreamTrack.prototype.hasOwnProperty("getConstraints")?jt({audio:kt.getStreamTrackConstraints(kt.getLocalMediaStreamAudioTrack()),video:kt.getStreamTrackConstraints(kt.getLocalMediaStreamTrack())}):sn("Navigator not compatible with this function");if(Un.debug("getConstraints() on a remote stream"),kt.contact===null)return sn("No contact associated");var ln=kt.addPendingPromise("getConstraints",jt,sn);kt.contact.sendCustomEvent(et.g.CONTACT_GET_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:kt.callId,streamId:kt.getId(),timeout:ln})})}},{key:"getStreamTrackConstraints",value:function(kt){return kt!==null?kt.getConstraints():{}}},{key:"takePhoto",value:function(){var kt=this;return new Promise(function(jt,sn){if(Un.debug("takePhoto()"),kt.checkImageCaptureCompatibility())sn("Your navigator is not compatible with takePhoto()");else{var ln=kt.getLocalMediaStreamTrack();ln!==null?new ImageCapture(ln).takePhoto().then(function(Kt){var dt=new Image;dt.src=URL.createObjectURL(Kt),jt(dt)}).catch(function(Kt){sn("takePhoto() error: ",Kt)}):sn("No local mediaStreamTrack found")}})}},{key:"activateAIAnnotations",value:function(){var kt=this.getStreamAIE();kt!==null&&kt.activateAnnotations()}},{key:"stopAIAnnotations",value:function(){var kt=this.getStreamAIE();kt!==null&&kt.stopAnnotations()}},{key:"activateAILogs",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(typeof kt!="number")return Un.error("minLogPeriod parameter must be an integer");var jt=this.getStreamAIE();jt!==null&&jt.activateLogs(kt)}},{key:"stopAILogs",value:function(){var kt=this.getStreamAIE();kt!==null&&kt.stopLogs()}},{key:"activateAISnapshots",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(typeof kt!="number")return Un.error("minSnapshotPeriod parameter must be an integer");var jt=this.getStreamAIE();jt!==null&&jt.activateSnapshots(kt)}},{key:"stopAISnapshots",value:function(){var kt=this.getStreamAIE();kt!==null&&kt.stopSnapshots()}},{key:"getStreamAIE",value:function(){var kt=null;if(apiCC!==void 0){var jt=apiCC.getUserMediaStream(this.userMediaStreamId);if(jt.mediaFilterManager!==null){var sn=jt.mediaFilterManager.filters;Object.values(sn).forEach(function(ln){ln.streamAIE!==null&&(kt=ln.streamAIE)}),kt===null&&Un.error("Applied filter is not an AI filter")}else Un.error("No filter applied on stream")}return kt}},{key:"addChildren",value:function(kt,jt){this.childrenTypeExists(jt)?Un.error("This stream already has a sub instance running for this"):(this.childrens===void 0&&(this.childrens=[]),this.childrens.push(kt))}},{key:"releaseChildren",value:function(kt){this.childrens!==void 0&&this.childrens.forEach(function(jt,sn){jt.childType===kt&&jt.release({releaseParentStream:!1})})}},{key:"releaseAllChildren",value:function(){Un.debug("releaseAllChildren"),this.childrens!==void 0&&this.childrens.forEach(function(kt,jt){kt.release({releaseParentStream:!1})})}},{key:"removeChildren",value:function(kt){var jt=this;this.childrens!==void 0&&this.childrens.forEach(function(sn,ln){if(sn.childType===kt)return jt.childrens.splice(ln,1)})}},{key:"childrenTypeExists",value:function(kt){var jt=!1;return this.childrens!==void 0&&this.childrens.forEach(function(sn){sn.childType===kt&&(jt=!0)}),jt}},{key:"createChildStreamFromStream",value:function(kt,jt){var sn=this,ln=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(Kt,dt){Un.debug("createChildStreamFromStream");var gt={};gt.type=et.g.STREAM_TYPE_NO_INPUT,kt.getAudioTracks().length>0&&(gt.type=et.g.STREAM_TYPE_AUDIO),kt.getVideoTracks().length>0&&(gt.type=et.g.STREAM_TYPE_VIDEO);var Nt=sn;apiRTC.createUserMediaStream({type:"media",stream:kt,success:function(Vt){Un.debug("[createChildStreamFromStream] success; userMediaStreamId: "+Vt.userMediaStreamId),gt.constructor=!0,gt.userMediaStreamId=Vt.userMediaStreamId;var zt=new dm(Vt.stream,gt,Nt,jt);zt.parentStreamCtx=ln,ln.audioFilterIsApplied===!0&&(zt.audioFilterIsApplied=ln.audioFilterIsApplied,zt.audioAppliedFilter=ln.audioAppliedFilter),ln.videoFilterIsApplied===!0&&(zt.videoFilterIsApplied=ln.videoFilterIsApplied,zt.videoAppliedFilter=ln.videoAppliedFilter),Kt(zt)},failure:function(Vt,zt){Un.debug("[createChildStreamFromStream] failure :",zt),dt()},childStreamType:jt})})}},{key:"applyMuteStatusFromParent",value:function(){var kt=this,jt=0;this.data.getAudioTracks().forEach(function(ln){ln.enabled=kt.parent.data.getAudioTracks()[jt].enabled,jt++});var sn=0;this.data.getVideoTracks().forEach(function(ln){ln.enabled=kt.parent.data.getVideoTracks()[sn].enabled,sn++})}},{key:"loadTFLiteModule",value:function(){return new Promise(function(kt,jt){var sn;if(sn=iu.feature.simd?"https://cdn.apizee.com/apiRTC/lib/tflite/tflite-simd.js":"https://cdn.apizee.com/apiRTC/lib/tflite/tflite.js",apiRTC.userAgentInstance.tFLiteModuleLoaded===!1){Un.debug("loading tflite");var ln={async:!0,numRetries:20,reqdelay:200,success:function(){Un.debug("loaded successfully",iu.feature.simd),iu.feature.simd?createTFLiteSIMDModule().then(function(Kt){apiRTC.userAgentInstance.tFLiteSIMDModule=Kt,apiRTC.userAgentInstance.tFLiteModuleLoaded=!0,kt(Kt)}):createTFLiteModule().then(function(Kt){apiRTC.userAgentInstance.tFLiteSIMDModule=Kt,apiRTC.userAgentInstance.tFLiteModuleLoaded=!0,kt(Kt)})},error:function(Kt){jt("Resources loading failed, depsNotFound: "+Kt)},retrycb:function(Kt,dt){Un.warn("Blur API module loading retry :"+Kt+" ,delay before retry :"+dt)}};apiCC.resourcesLoader.loadjs([sn],"blur-api",ln)}else Un.debug("tflite already loaded and TFLiteSIMDModule already created"),kt(apiRTC.userAgentInstance.tFLiteSIMDModule)})}},{key:"setupTFLiteModule",value:function(kt){return new Promise(function(jt,sn){Un.debug("setupTFLiteModule"),apiRTC.userAgentInstance.modelLoadedInModule===!1?(Un.debug("loading model landscape"),fetch("https://cdn.apizee.com/apiRTC/lib/tflite/models/selfie_segmentation_landscape.tflite").then(function(ln){if(!ln.ok)throw new Error("Failed to download tflite model!");Un.debug("loaded successfully");var Kt=kt._getModelBufferMemoryOffset();ln.arrayBuffer().then(function(dt){kt.HEAPU8.set(new Uint8Array(dt),Kt),kt._loadModel(dt.byteLength),Un.debug("module setup complete"),apiRTC.userAgentInstance.modelLoadedInModule=!0,apiRTC.userAgentInstance.tFLiteSIMDModule=kt,jt(kt)})}).catch(function(ln){Un.error("Something went wrong during tflite model loading..",ln)})):(Un.debug("model landscape already loaded in module"),jt(apiRTC.userAgentInstance.tFLiteSIMDModule))})}},{key:"onMaskFrameTimer",value:function(kt){kt.data.id===this.blurVariables.TIMEOUT_TICK&&this.renderMask()}},{key:"renderMask",value:function(){this.resizeSource(),this.runInference(),this.runPostProcessing(),this.blurVariables.maskFrameTimerWorker.postMessage({id:this.blurVariables.SET_TIMEOUT,timeMs:1e3/30})}},{key:"resizeSource",value:function(){this.blurVariables.segmentationMaskCtx.drawImage(this.blurVariables.inputVideoElement,0,0,this.blurVariables.inputVideoElement.width,this.blurVariables.inputVideoElement.height,0,0,this.blurVariables.width,this.blurVariables.height);for(var kt=this.blurVariables.segmentationMaskCtx.getImageData(0,0,this.blurVariables.width,this.blurVariables.height),jt=this.blurVariables.tfliteModel._getInputMemoryOffset()/4,sn=0;sn<this.blurVariables.segmentationPixelCount;sn++)this.blurVariables.tfliteModel.HEAPF32[jt+3*sn]=kt.data[4*sn]/255,this.blurVariables.tfliteModel.HEAPF32[jt+3*sn+1]=kt.data[4*sn+1]/255,this.blurVariables.tfliteModel.HEAPF32[jt+3*sn+2]=kt.data[4*sn+2]/255}},{key:"runInference",value:function(){this.blurVariables.tfliteModel._runInference();for(var kt=this.blurVariables.tfliteModel._getOutputMemoryOffset()/4,jt=0;jt<this.blurVariables.segmentationPixelCount;jt++){var sn=this.blurVariables.tfliteModel.HEAPF32[kt+jt];this.blurVariables.segmentationMask.data[4*jt+3]=255*sn}this.blurVariables.segmentationMaskCtx.putImageData(this.blurVariables.segmentationMask,0,0)}},{key:"runPostProcessing",value:function(){var kt=this.blurVariables.firstVideoTrack.getSettings?this.blurVariables.firstVideoTrack.getSettings():this.blurVariables.firstVideoTrack.getConstraints(),jt=kt.height,sn=kt.width;if(this.blurVariables.outputCanvasElement.height=jt,this.blurVariables.outputCanvasElement.width=sn,this.blurVariables.outputCanvasCtx.globalCompositeOperation="copy",this.blurVariables.outputCanvasCtx.filter=this.blurVariables.virtualBackground==="image"?"blur(4px)":"blur(8px)",this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.segmentationMaskCanvas,0,0,this.blurVariables.width,this.blurVariables.height,0,0,this.blurVariables.inputVideoElement.width,this.blurVariables.inputVideoElement.height),this.blurVariables.outputCanvasCtx.globalCompositeOperation="source-in",this.blurVariables.outputCanvasCtx.filter="none",this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.inputVideoElement,0,0),this.blurVariables.outputCanvasCtx.globalCompositeOperation="destination-over",this.blurVariables.virtualBackground==="image")if(this.blurVariables.outputCanvasElement.width/this.blurVariables.outputCanvasElement.height===this.blurVariables.imageRatio)this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.virtualImage,0,0,this.blurVariables.virtualImage.width,this.blurVariables.virtualImage.height,0,0,this.blurVariables.outputCanvasElement.width,this.blurVariables.outputCanvasElement.height);else if(this.blurVariables.imageRatio>1){var ln=this.blurVariables.virtualImage.height*(this.blurVariables.outputCanvasElement.width/this.blurVariables.outputCanvasElement.height),Kt=this.blurVariables.virtualImage.height,dt=Math.abs(this.blurVariables.virtualImage.width-ln)/2;ln>this.blurVariables.virtualImage.width&&(ln=this.blurVariables.virtualImage.width,dt=0),this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.virtualImage,dt,0,ln,Kt,0,0,this.blurVariables.outputCanvasElement.width,this.blurVariables.outputCanvasElement.height)}else{var gt=this.blurVariables.virtualImage.width,Nt=this.blurVariables.virtualImage.width/(this.blurVariables.outputCanvasElement.width/this.blurVariables.outputCanvasElement.height),Vt=Math.abs(this.blurVariables.virtualImage.height-Nt)/2;Nt>this.blurVariables.virtualImage.height&&(Nt=this.blurVariables.virtualImage.height,Vt=0),this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.virtualImage,0,Vt,gt,Nt,0,0,this.blurVariables.outputCanvasElement.width,this.blurVariables.outputCanvasElement.height)}else this.blurVariables.outputCanvasCtx.filter="blur(15px)",this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.inputVideoElement,0,0)}},{key:"startSelfieSegmentation",value:function(){var kt=this;return new Promise(function(jt,sn){Un.debug("startSelfieSegmentation"),kt.loadTFLiteModule().then(function(ln){kt.setupTFLiteModule(ln).then(function(Kt){if(kt.blurVariables.tfliteModel=Kt,kt.blurVariables.firstVideoTrack=kt.data.getVideoTracks()[0],kt.blurVariables.firstVideoTrack!==null&&kt.blurVariables.firstVideoTrack!==void 0){var dt=kt.blurVariables.firstVideoTrack.getSettings?kt.blurVariables.firstVideoTrack.getSettings():kt.blurVariables.firstVideoTrack.getConstraints(),gt=dt.height,Nt=dt.frameRate,Vt=dt.width;kt.blurVariables.height=144,kt.blurVariables.width=256,kt.blurVariables.frameRate=Nt,kt.blurVariables.segmentationPixelCount=kt.blurVariables.width*kt.blurVariables.height,kt.onMaskFrameTimer=kt.onMaskFrameTimer.bind(kt),kt.blurVariables.outputCanvasElement=document.createElement("canvas"),kt.blurVariables.outputCanvasElement.getContext("2d"),kt.blurVariables.inputVideoElement=document.createElement("video"),kt.blurVariables.SET_TIMEOUT=1,kt.blurVariables.CLEAR_TIMEOUT=2,kt.blurVariables.TIMEOUT_TICK=3,kt.blurVariables.maskFrameTimerWorker=new Worker(URL.createObjectURL(new Blob([`
                                        var timer;
                                        onmessage = function(request) {
                                            switch (request.data.id) {
                                            case `.concat(kt.blurVariables.SET_TIMEOUT,`: {
                                                timer = setTimeout(() => {
                                                    postMessage({ id: `).concat(kt.blurVariables.TIMEOUT_TICK,` });
                                                }, request.data.timeMs);
                                                break;
                                            }
                                            case `).concat(kt.blurVariables.CLEAR_TIMEOUT,`: {
                                                if (timer) {
                                                    clearTimeout(timer);
                                                }
                                                break;
                                            }
                                            }
                                        };
                                    `)],{type:"application/javascript"})),{name:"Blur effect worker"}),kt.blurVariables.maskFrameTimerWorker.onmessage=kt.onMaskFrameTimer,kt.blurVariables.segmentationMask=new ImageData(kt.blurVariables.width,kt.blurVariables.height),kt.blurVariables.segmentationMaskCanvas=document.createElement("canvas"),kt.blurVariables.segmentationMaskCanvas.width=kt.blurVariables.width,kt.blurVariables.segmentationMaskCanvas.height=kt.blurVariables.height,kt.blurVariables.segmentationMaskCtx=kt.blurVariables.segmentationMaskCanvas.getContext("2d"),kt.blurVariables.outputCanvasElement.width=parseInt(Vt,10),kt.blurVariables.outputCanvasElement.height=parseInt(gt,10),kt.blurVariables.outputCanvasCtx=kt.blurVariables.outputCanvasElement.getContext("2d"),kt.blurVariables.inputVideoElement.width=parseInt(Vt,10),kt.blurVariables.inputVideoElement.height=parseInt(gt,10),kt.blurVariables.inputVideoElement.autoplay=!0,kt.blurVariables.inputVideoElement.srcObject=kt.data,kt.blurVariables.inputVideoElement.onloadeddata=function(){kt.blurVariables.inputVideoElement.muted=!0,kt.blurVariables.maskFrameTimerWorker.postMessage({id:kt.blurVariables.SET_TIMEOUT,timeMs:1e3/30})},jt(kt.blurVariables.outputCanvasElement.captureStream(parseInt(kt.blurVariables.frameRate,10)))}else sn("No video track on stream")}).catch(function(){return Un.error("Catch on setupTFLiteModule"),sn("Catch on setupTFLiteModule")})}).catch(function(){return Un.error("Catch on loadTFLiteModule"),sn("Catch on loadTFLiteModule")})})}},{key:"stopSelfieSegmentation",value:function(){Un.debug("stopSelfieSegmentation"),this.blurVariables.maskFrameTimerWorker.postMessage({id:this.blurVariables.CLEAR_TIMEOUT}),this.blurVariables.maskFrameTimerWorker.terminate()}},{key:"checkChildTypeConditions",value:function(){return this.childType!==void 0&&this.videoFilterIsApplied?"This stream is already a childStream : need to remove previous applied effect : "+this.childType:this.childrenTypeExists("blur")?"This stream already has a blur sub instance running : need to unblur()":this.childrenTypeExists("backgroundImage")?"This stream already has a backgroundImage sub instance running : need to unBackgroundImage()":MediaStreamTrack.prototype.hasOwnProperty("getSettings")&&MediaStreamTrack.prototype.hasOwnProperty("getConstraints")?"OK":"Navigator not compatible with this function"}},{key:"blur",value:function(){var kt=this;return new Promise(function(jt,sn){var ln=kt.checkChildTypeConditions();if(ln!=="OK")return sn(ln);if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return sn("Navigator not compatible with this function");var Kt=kt;kt.blurVariables={},kt.blurVariables.virtualBackground="blur",kt.startSelfieSegmentation().then(function(dt){var gt,Nt=$o(Kt.data.getAudioTracks());try{for(Nt.s();!(gt=Nt.n()).done;){var Vt=gt.value;dt.addTrack(Vt.clone())}}catch(Xt){Nt.e(Xt)}finally{Nt.f()}var zt={audioFilterIsApplied:kt.audioFilterIsApplied,audioAppliedFilter:kt.audioAppliedFilter,videoFilterIsApplied:kt.videoFilterIsApplied,videoAppliedFilter:kt.videoAppliedFilter,childType:kt.childType};Kt.createChildStreamFromStream(dt,"blur",zt).then(function(Xt){return kt.addChildren(Xt,"blur"),Xt.applyMuteStatusFromParent(),jt(Xt)}).catch(function(){return Un.error("Catch on createChildStreamFromStream blur"),sn("error on createChildStreamFromStream")})}).catch(function(dt){return Un.error("Catch on startSelfieSegmentation blur : ",dt),sn(dt)})})}},{key:"unblur",value:function(){var kt=this;return new Promise(function(jt,sn){if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return sn("Navigator not compatible with this function");if(kt.childType==="blur"){Un.debug("This is the blurred stream : applying process with parent stream");var ln=kt.parent;return ln.stopSelfieSegmentation(),ln.releaseChildren("blur"),ln.removeChildren("blur"),jt(ln)}return kt.childrenTypeExists("blur")?(Un.debug("This is the parent stream : applying process with this stream"),kt.stopSelfieSegmentation(),kt.releaseChildren("blur"),kt.removeChildren("blur"),jt(kt)):(Un.debug("No blurred instance found for this stream"),sn("No blurred instance found for this stream"))})}},{key:"backgroundImage",value:function(kt){var jt=this;return Un.debug("backgroundImage",kt),new Promise(function(sn,ln){var Kt=jt.checkChildTypeConditions();if(Kt!=="OK")return ln(Kt);if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return ln("Navigator not compatible with this function");var dt=jt;jt.blurVariables={},jt.blurVariables.virtualBackground="image",jt.blurVariables.virtualImage=new Image,jt.blurVariables.virtualImage.crossOrigin="anonymous",jt.blurVariables.virtualImage.src=kt,jt.blurVariables.virtualImage.onload=function(){jt.blurVariables.imageRatio=jt.blurVariables.virtualImage.width/jt.blurVariables.virtualImage.height,jt.startSelfieSegmentation().then(function(gt){var Nt,Vt=$o(dt.data.getAudioTracks());try{for(Vt.s();!(Nt=Vt.n()).done;){var zt=Nt.value;gt.addTrack(zt.clone())}}catch(Zt){Vt.e(Zt)}finally{Vt.f()}var Xt={audioFilterIsApplied:jt.audioFilterIsApplied,audioAppliedFilter:jt.audioAppliedFilter,videoFilterIsApplied:jt.videoFilterIsApplied,videoAppliedFilter:jt.videoAppliedFilter,childType:jt.childType};dt.createChildStreamFromStream(gt,"backgroundImage",Xt).then(function(Zt){return jt.addChildren(Zt,"backgroundImage"),Zt.applyMuteStatusFromParent(),sn(Zt)}).catch(function(){return Un.error("Catch on createChildStreamFromStream bck"),ln("error on createChildStreamFromStream")})}).catch(function(gt){return Un.error("Catch on startSelfieSegmentation bck : ",gt),ln(gt)})},jt.blurVariables.virtualImage.onerror=function(){return Un.debug("Error on image loading"),ln("Error on image loading")}})}},{key:"unBackgroundImage",value:function(){var kt=this;return Un.debug("unBackgroundImage"),new Promise(function(jt,sn){if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return sn("Navigator not compatible with this function");if(kt.childType==="backgroundImage"){Un.debug("This is the backgroundImage stream : applying process with parent stream");var ln=kt.parent;return ln.stopSelfieSegmentation(),ln.releaseChildren("backgroundImage"),ln.removeChildren("backgroundImage"),jt(ln)}return kt.childrenTypeExists("backgroundImage")?(Un.debug("This is the parent stream : applying process with this stream"),kt.stopSelfieSegmentation(),kt.releaseChildren("backgroundImage"),kt.removeChildren("backgroundImage"),jt(kt)):(Un.debug("No background image instance found for this stream"),sn("No background image instance found for this stream"))})}},{key:"applyVideoProcessor",value:function(kt,jt){var sn=this;return new Promise(function(ln,Kt){if(kt!=="none"&&kt!=="blur"&&kt!=="backgroundImage")return Kt(new Gr("Requested videoProcessorType is not correct","none",sn));var dt=sn,gt="none",Nt=null,Vt=sn,zt=!1;if(sn.childType==="noiseReduction"&&sn.videoFilterIsApplied===!0&&(Un.debug("This is a noised reduced stream ... applying filter on parent"),Vt=sn.parent,sn.release({releaseParentStream:!1}),zt=!0),Vt.childType!==void 0&&Vt.videoFilterIsApplied===!0&&(Vt.childType==="blur"?gt="blur":Vt.childType==="backgroundImage"&&(gt="backgroundImage"),dt=Vt.parent,Nt=Vt),Vt.childrenTypeExists("blur")&&(gt="blur",Vt.childrens.forEach(function(on){Nt=on})),Vt.childrenTypeExists("backgroundImage")&&(gt="backgroundImage",Vt.childrens.forEach(function(on){Nt=on})),Un.debug("actual applied effect =",gt),kt==="none"&&gt==="none")return Kt(new Gr("Requested videoProcessorType none and no effect applied","none",dt));if(kt==="none"&&gt==="blur")Un.debug("need to unblur"),dt.unblur().then(function(on){if(zt!==!0)return ln(on);on.startNoiseReduction().then(function(bn){return ln(bn)}).catch(function(bn){return Un.error("Catch on startNoiseReduction :",bn),Kt(new Wo(bn,on.audioAppliedFilter,dt))})}).catch(function(on){return Un.error("Catch on unblur: ",on),Kt(new Gr(on,"none",dt))});else if(kt==="none"&&gt==="backgroundImage")Un.debug("need to unBackgroundImage"),dt.unBackgroundImage().then(function(on){if(zt!==!0)return ln(on);on.startNoiseReduction().then(function(bn){return ln(bn)}).catch(function(bn){return Un.error("Catch on startNoiseReduction :",bn),Kt(new Wo(bn,on.audioAppliedFilter,dt))})}).catch(function(on){return Un.error("Catch on unBackgroundImage :",on),Kt(new Gr(on,"none",dt))});else if(kt==="blur"&&gt==="none")Un.debug("need to blur"),dt.blur().then(function(on){if(zt!==!0)return ln(on);on.startNoiseReduction().then(function(bn){return ln(bn)}).catch(function(bn){return Un.error("Catch on startNoiseReduction :",bn),Kt(new Wo(bn,on.audioAppliedFilter,dt))})}).catch(function(on){return Un.error("Catch on blur :",on),Kt(new Gr(on,"none",dt))});else{if(kt==="blur"&&gt==="blur")return Kt(new Gr("Requested videoProcessorType blur and blur already applied","blur",Nt));if(kt==="blur"&&gt==="backgroundImage"){Un.debug("need to unBackgroundImage then blur");var Xt=dt.blurVariables.virtualImage.src;dt.unBackgroundImage().then(function(on){on.blur().then(function(bn){if(zt!==!0)return ln(bn);bn.startNoiseReduction().then(function(En){return ln(En)}).catch(function(En){return Un.error("Catch on startNoiseReduction :",En),Kt(new Wo(En,bn.audioAppliedFilter,dt))})}).catch(function(bn){Un.warn("Catch on blur - unBackgroundImage to blur :",bn),Un.debug("Reactivating previous effect : backgroundImage"),dt.backgroundImage(Xt).then(function(En){if(Un.warn("Could not apply blur effect, background restored"),zt!==!0)return Kt(new Gr("Could not apply blur effect, background restored","backgroundImage",En));En.startNoiseReduction().then(function(Gn){return Kt(new Gr("Could not apply blur effect, background restored","backgroundImage",Gn))}).catch(function(Gn){return Un.error("Catch on startNoiseReduction :",Gn),Kt(new Gr("Could not apply blur effect, background restored","backgroundImage",En))})}).catch(function(En){return Un.error("Could not apply blur effect and error in restoring background :",En),Kt(new Gr("Could not apply blur effect and error in restoring background","none",dt))})})}).catch(function(on){return Un.error("Catch on unBackgroundImage :",on),Kt(new Gr(on,"none",dt))})}else if(kt==="backgroundImage"&&gt==="none"){if(Un.debug("need to backgroundImage"),jt===void 0||jt.backgroundImageUrl===void 0)return Kt(new Gr("Error options.backgroundImageUrl is not defined","none",dt));dt.backgroundImage(jt.backgroundImageUrl).then(function(on){if(zt!==!0)return ln(on);on.startNoiseReduction().then(function(bn){return ln(bn)}).catch(function(bn){return Un.error("Catch on startNoiseReduction :",bn),Kt(new Gr("Could not apply blur effect, background restored","backgroundImage",on))})}).catch(function(on){return Un.error("Catch on backgroundImage :",on),Kt(new Gr(on,"none",dt))})}else if(kt==="backgroundImage"&&gt==="blur")Un.debug("need to unblur then backgroundImage"),dt.unblur().then(function(on){on.backgroundImage(jt.backgroundImageUrl).then(function(bn){if(zt!==!0)return ln(bn);bn.startNoiseReduction().then(function(En){return ln(En)}).catch(function(En){return Un.error("Catch on startNoiseReduction :",En),Kt(new Gr("Could not apply blur effect, background restored","backgroundImage",bn))})}).catch(function(bn){Un.warn("Catch on backgroundImage - unBackgroundImage to blur :",bn),Un.debug("Reactivating previous effect : blur"),dt.blur().then(function(En){if(zt!==!0)return Un.warn("Could not apply background effect, blur restored"),Kt(new Gr("Could not apply background effect, blur restored","blur",En));En.startNoiseReduction().then(function(Gn){return Kt(new Gr("Could not apply background effect, blur restored","blur",Gn))}).catch(function(Gn){return Un.error("Catch on startNoiseReduction :",Gn),Kt(new Gr("Could not apply background effect, blur restored","blur",En))})}).catch(function(En){return Un.error("Could not apply background effect and error in restoring blur :",En),Kt(new Gr("Could not apply background effect and error in restoring blur","none",dt))})})}).catch(function(on){return Un.error("Catch on unblur :",on),Kt(new Gr(on,"none",dt))});else if(kt==="backgroundImage"&&gt==="backgroundImage"){var Zt=dt.blurVariables.virtualImage.src;if(jt.backgroundImageUrl.startsWith("data:image")===!1&&Zt.substring(Zt.lastIndexOf("/")+1)===jt.backgroundImageUrl.substring(jt.backgroundImageUrl.lastIndexOf("/")+1))return Un.debug("Same background image is already applied"),Kt(new Gr("Requested videoProcessorType backgroundImage and backgroundImage with the same image already applied","backgroundImage",Nt));Un.debug("New background image is to be applied"),dt.unBackgroundImage().then(function(on){on.backgroundImage(jt.backgroundImageUrl).then(function(bn){if(zt!==!0)return ln(bn);bn.startNoiseReduction().then(function(En){return ln(En)}).catch(function(En){return Un.error("Catch on startNoiseReduction :",En),Kt(new Gr("Could not apply background effect, blur restored","blur",bn))})}).catch(function(bn){Un.warn("Catch on backgroundImage - change background image :",bn),Un.debug("Reactivating previous effect : backgroundImage"),dt.backgroundImage(Zt).then(function(En){if(zt!==!0)return Kt(new Gr("Could not apply new image on background, former background restored","backgroundImage",En));En.startNoiseReduction().then(function(Gn){return Un.warn("Could not apply new image on background, former background restored"),Kt(new Gr("Could not apply new image on background, former background restored","backgroundImage",Gn))}).catch(function(Gn){return Un.error("Catch on startNoiseReduction :",Gn),Kt(new Gr("Could not apply background effect, blur restored","blur",En))})}).catch(function(En){return Un.error("Could not apply new image on background and error in restoring former background :",En),Kt(new Gr("Could not apply new image on background and error in restoring former background","none",dt))})})}).catch(function(on){return Un.error("Catch on unBackgroundImage :",on),Kt(new Gr(on,"none",dt))})}}})}},{key:"checkAudioProcessorType",value:function(kt){return kt!=="none"&&kt!=="noiseReduction"?"Requested audioProcessorType is not correct":kt==="none"&&this.audioAppliedFilter!=="noiseReduction"?"Not a noised reduction stream":"OK"}},{key:"applyAudioProcessor",value:function(kt){var jt=this;return new Promise(function(sn,ln){var Kt=jt,dt="none",gt="none",Nt=jt.checkAudioProcessorType(kt);if(Nt!=="OK")return ln(new Wo(Nt,jt.audioAppliedFilter,jt));if(kt==="none"){if(jt.childType!=="noiseReduction"&&jt.parent.childType==="noiseReduction"?(Un.debug("applying process on parent stream as this one must be a video effect stream"),Kt=jt.parent,dt=jt.childType,jt.parent.blurVariables!==void 0&&jt.parent.blurVariables.virtualImage!==void 0&&(gt=jt.parent.blurVariables.virtualImage.src),jt.release({releaseParentStream:!1})):Un.debug("no noiseReduction applied"),Kt.stopNoiseReduction(),dt==="none"){Un.debug("Release noiseReduction stream");var Vt=jt.parent;return Kt.release({releaseParentStream:!1}),sn(Vt)}var zt={backgroundImageUrl:gt};Kt.parent.applyVideoProcessor(dt,zt).then(function(Xt){return Un.debug("Release noiseReduction stream"),Kt.release({releaseParentStream:!1}),sn(Xt)}).catch(function(Xt){return Un.error("Catch on applyVideoProcessor() - reapply effect : ",Xt),ln(new Wo("Error on restoring applied video filter",this.audioAppliedFilter,this))})}else kt==="noiseReduction"&&Kt.startNoiseReduction().then(function(Xt){return sn(Xt)}).catch(function(Xt){return Un.error("Catch on startNoiseReduction :",Xt),ln(new Wo(Xt,Kt.audioAppliedFilter,Kt))})})}},{key:"startNoiseReduction",value:function(){return apiCC.audioProcessor.startNoiseReduction(this)}},{key:"stopNoiseReduction",value:function(){apiCC.audioProcessor.stopAudioNodeCtx(this.parent.nodeCtx)}},{key:"createMediaStreamTrackProcessor",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(Un.debug("mediaStreamTrackProcessor kind: ".concat(kt?"audio":"video"," created")),kt){var jt=this.data.getAudioTracks();if(jt.length)return new MediaStreamTrackProcessor({track:jt[0]});throw new Error("No audio tracks found")}var sn=this.data.getVideoTracks();if(sn.length)return new MediaStreamTrackProcessor({track:sn[0]});throw new Error("No video tracks found")}},{key:"createMediaStreamTrackGenerator",value:function(){var kt=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return Un.debug("mediaStreamTrackGenerator kind: ".concat(kt?"audio":"video"," created")),kt?new MediaStreamTrackGenerator({kind:"audio"}):new MediaStreamTrackGenerator({kind:"video"})}},{key:"loadSegmentationAPI",value:function(){return new Promise(function(kt,jt){var sn={async:!0,numRetries:20,reqdelay:200,success:function(){Un.debug("Segmentation API loaded"),mergeReality.then(kt)},error:function(ln){jt("Resources loading failed, depsNotFound: "+ln)},retrycb:function(ln,Kt){Un.warn("Blur API model loading retry :"+ln+" ,delay before retry :"+Kt)}};apiCC.resourcesLoader.loadjs(["https://cdn.apizee.com/apiRTC/lib/mergereality/v1.0/merge_reality.js"],"merge-reality",sn)})}},{key:"startMergeReality",value:function(kt){var jt=this;this.mergeRealityData={},this.mergeRealityLib=kt,this.mergeRealityData.stop=!1,this.mergeRealityData.WIDTH=this.getSettings().width,this.mergeRealityData.HEIGHT=this.getSettings().height,this.mergeRealityData.WEBCAM_CANVAS=new OffscreenCanvas(this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.WEBCAM_CTX=this.mergeRealityData.WEBCAM_CANVAS.getContext("2d",{alpha:!1}),this.mergeRealityData.MASK_CANVAS=new OffscreenCanvas(this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.MASK_CTX=this.mergeRealityData.MASK_CANVAS.getContext("2d",{alpha:!0}),this.mergeRealityData.SCREEN_VIDEO=document.createElement("video"),this.mergeRealityData.BG_SUB=new this.mergeRealityLib.BackgroundSubtractor,this.mergeRealityData.background=new this.mergeRealityLib.BackgroundImage(this.mergeRealityData.WEBCAM_CTX.getImageData(0,0,this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.MSTP=this.createMediaStreamTrackProcessor().readable,this.mergeRealityData.MSTG=this.createMediaStreamTrackGenerator(),this.mergeRealityData.SINK=this.mergeRealityData.MSTG.writable,this.mergeRealityData.MASK_TRANSFORMER=new TransformStream({transform:function(sn,ln){jt.mergeRealityData.stop||(jt.mergeRealityData.MASK_CTX.save(),jt.mergeRealityData.MASK_CTX.clearRect(0,0,jt.mergeRealityData.WIDTH,jt.mergeRealityData.HEIGHT),jt.mergeRealityData.WEBCAM_CTX.clearRect(0,0,jt.mergeRealityData.WIDTH,jt.mergeRealityData.HEIGHT),jt.mergeRealityData.WEBCAM_CTX.drawImage(sn,0,0),jt.mergeRealityData.MASK_DATA=jt.mergeRealityData.BG_SUB.computeMask(jt.mergeRealityData.WEBCAM_CTX.getImageData(0,0,jt.mergeRealityData.WIDTH,jt.mergeRealityData.HEIGHT),jt.mergeRealityData.background),jt.mergeRealityData.RES=jt.mergeRealityData.BG_SUB.applyTransparency(jt.mergeRealityData.WEBCAM_CTX.getImageData(0,0,jt.mergeRealityData.WIDTH,jt.mergeRealityData.HEIGHT),jt.mergeRealityData.MASK_DATA),jt.mergeRealityData.MASK_CTX.putImageData(jt.mergeRealityData.RES,0,0),jt.mergeRealityData.MASK_CTX.globalCompositeOperation="destination-atop",jt.mergeRealityData.MASK_CTX.drawImage(jt.mergeRealityData.SCREEN_VIDEO,0,0,jt.mergeRealityData.WIDTH,jt.mergeRealityData.HEIGHT),jt.mergeRealityData.MASK_CTX.restore(),ln.enqueue(new VideoFrame(jt.mergeRealityData.MASK_CANVAS))),sn.close()}}),this.mergeRealityData.RES_MS=new MediaStream}},{key:"stopMergeReality",value:function(){this.mergeRealityData.stop=!0}},{key:"calibrateBackground",value:function(){this.childrenTypeExists("merge")?this.mergeRealityData.background=new this.mergeRealityLib.BackgroundImage(this.mergeRealityData.WEBCAM_CTX.getImageData(0,0,this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT):Un.error("No merged instance found for this stream")}},{key:"mergeReality",value:function(kt){var jt=this;return new Promise(function(sn,ln){return window.MediaStreamTrackGenerator===void 0||window.MediaStreamTrackProcessor===void 0||window.TransformStream===void 0?ln("Your browser does not support InsertableStreams"):jt.childrenTypeExists("merge")?ln("This stream already has a sub instance running for this"):void jt.loadSegmentationAPI().then(function(Kt){jt.startMergeReality(Kt),kt.attachToElement(jt.mergeRealityData.SCREEN_VIDEO),jt.mergeRealityData.SCREEN_VIDEO.autoplay=!0,jt.mergeRealityData.MSTP.pipeThrough(jt.mergeRealityData.MASK_TRANSFORMER).pipeTo(jt.mergeRealityData.SINK),jt.mergeRealityData.RES_MS.addTrack(jt.mergeRealityData.MSTG);var dt,gt=$o(jt.data.getAudioTracks());try{for(gt.s();!(dt=gt.n()).done;){var Nt=dt.value;jt.mergeRealityData.RES_MS.addTrack(Nt)}}catch(Xt){gt.e(Xt)}finally{gt.f()}var Vt=jt,zt={audioFilterIsApplied:jt.audioFilterIsApplied,audioAppliedFilter:jt.audioAppliedFilter,videoFilterIsApplied:jt.videoFilterIsApplied,videoAppliedFilter:jt.videoAppliedFilter,childType:jt.childType};jt.createChildStreamFromStream(jt.mergeRealityData.RES_MS,"merge",zt).then(function(Xt){Vt.addChildren(Xt,"merge"),Xt.applyMuteStatusFromParent(),sn(Xt)}).catch(function(){Un.error("Catch on createChildStreamFromStream mergeReality")})})})}},{key:"unmergeReality",value:function(){this.childrenTypeExists("merge")?(this.stopMergeReality(),this.releaseChildren("merge"),this.removeChildren("merge")):Un.error("No merged instance found for this stream")}},{key:"addPendingPromise",value:function(kt,jt,sn){var ln=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5e3;return apiCC.addPendingPromise(kt,jt,sn,ln)}},{key:"resolvePendingPromise",value:function(kt,jt){apiCC.resolvePendingPromise(kt,jt)}},{key:"rejectPendingPromise",value:function(kt,jt){apiCC.rejectPendingPromise(kt,jt)}},{key:"sendAudioFlowStatusChanged",value:function(){var kt=this.getAudioFlowStatus();nn.get(this).emit("audioFlowStatusChanged",kt)}},{key:"sendVideoFlowStatusChanged",value:function(){var kt=this.getVideoFlowStatus();nn.get(this).emit("videoFlowStatusChanged",kt)}},{key:"sendFlowStatusChanged",value:function(kt){var jt;kt==="audio"?jt=this.getAudioFlowStatus():kt==="video"&&(jt=this.getVideoFlowStatus()),jt.type=kt,nn.get(this).emit("flowStatusChanged",jt)}},{key:"sendFlowStatusChangedForRemote",value:function(kt,jt){jt.type=kt,nn.get(this).emit("flowStatusChanged",jt)}},{key:"sendRemoteAudioFlowStatusChanged",value:function(kt){nn.get(this).emit("remoteAudioFlowStatusChanged",kt)}},{key:"sendRemoteVideoFlowStatusChanged",value:function(kt){nn.get(this).emit("remoteVideoFlowStatusChanged",kt)}},{key:"emitConstraintsChanged",value:function(kt){nn.get(this).emit("constraintsChanged",kt)}}],[{key:"getAvailableEvents",value:function(){return cm}},{key:"createStreamFromUserMedia",value:function(kt,jt,sn){var ln=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Un.debug("createStreamFromUserMedia"),Un.debug("audioInput :",kt),Un.debug("videoInput :",jt),Un.debug("constraints :",sn),Un.debug("options :",ln),new Promise(function(Kt,dt){var gt=kt!==!1&&(kt!==null||sn===void 0||sn!==void 0&&sn.hasOwnProperty("audio")),Nt=jt!==!1&&(jt!==null||sn===void 0||sn!==void 0&&sn.hasOwnProperty("video")),Vt={type:et.g.STREAM_TYPE_NO_INPUT,audioInput:kt,videoInput:jt},zt="media";Nt?Vt.type=et.g.STREAM_TYPE_VIDEO:gt&&(Vt.type=et.g.STREAM_TYPE_AUDIO),gt&&!Nt?zt="audio":!gt&&Nt&&(zt="videoOnly"),gt&&ln.enhancedAudioActivated===!0&&(Un.debug("Enhanced Audio is activated"),apiRTC.browser!=="Chrome"?Un.debug("enhancedAudioActivated option is only available for Chrome"):(sn===void 0&&(sn={}),sn.audio&&ss(sn.audio)==="object"||(sn.audio={}),sn.video===void 0&&(sn.video={}),sn.audio.echoCancellation=!1,sn.audio.autoGainControl=!1,sn.audio.noiseSuppression=!1)),apiRTC.createUserMediaStream({audioSourceId:kt,videoSourceId:jt,facingMode:ln.facingMode,gum_config:sn,filters:ln.filters,type:zt,success:function(Xt){Un.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+Xt.userMediaStreamId),Vt.constructor=!0,Vt.userMediaStreamId=Xt.userMediaStreamId,Kt(new Yt(Xt.stream,Vt))},failure:function(Xt,Zt){Un.debug("[createStreamFromUserMedia] failure :",Zt),dt(Zt)}})})}},{key:"createStreamFromMediaStream",value:function(kt){return Un.debug("createStreamFromMediaStream"),new Promise(function(jt,sn){var ln={};ln.type=et.g.STREAM_TYPE_NO_INPUT,kt.getAudioTracks().length>0&&(ln.type=et.g.STREAM_TYPE_AUDIO),kt.getVideoTracks().length>0&&(ln.type=et.g.STREAM_TYPE_VIDEO),apiRTC.createUserMediaStream({type:"media",stream:kt,success:function(Kt){Un.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+Kt.userMediaStreamId),ln.constructor=!0,ln.userMediaStreamId=Kt.userMediaStreamId,jt(new Yt(Kt.stream,ln))},failure:function(Kt,dt){Un.debug("[createStreamFromUserMedia] failure :",dt),sn()}})})}},{key:"createScreensharingStream",value:function(kt){return new Promise(function(jt,sn){apiRTC.createUserMediaStream({type:"screenSharing",captureSourceType:kt,success:function(ln){Un.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+ln.userMediaStreamId);var Kt=new Yt(ln.stream,{constructor:!0,type:et.g.STREAM_TYPE_VIDEO,userMediaStreamId:ln.userMediaStreamId});Ks.set(Kt,!0),jt(Kt)},failure:function(ln,Kt){Un.debug("[createStreamFromUserMedia] failure :",Kt),sn(Kt)}})})}},{key:"createDisplayMediaStream",value:function(kt,jt){return new Promise(function(sn,ln){apiRTC.createUserMediaStream({type:"screenSharing",captureSourceType:kt,displayMediaStreamConstraints:kt,forceExtensionOnChrome:jt,success:function(Kt){Un.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+Kt.userMediaStreamId);var dt=new Yt(Kt.stream,{constructor:!0,type:et.g.STREAM_TYPE_VIDEO,userMediaStreamId:Kt.userMediaStreamId});Ks.set(dt,!0),sn(dt)},failure:function(Kt,dt){Un.debug("[createStreamFromUserMedia] failure :",dt),ln(dt)}})})}},{key:"getLocalStreams",value:function(){return yo.values()}},{key:"getStream",value:function(kt){return kt!=null&&yo.has(kt.toString())?yo.get(kt.toString()):null}}]),Yt}(fn),dm=function($t){qs(Yt,$t);var Lt=Js(Yt);function Yt(kt,jt,sn,ln){var Kt;return Hs(this,Yt),(Kt=Lt.call(this,kt,jt)).parent=sn,Kt.childType=ln,ln==="noiseReduction"&&(Kt.audioFilterIsApplied=!0,Kt.audioAppliedFilter=ln),ln!=="blur"&&ln!=="backgroundImage"||(Kt.videoFilterIsApplied=!0,Kt.videoAppliedFilter=ln),Kt}return Gs(Yt,[{key:"release",value:function(kt){this.childType!=="blur"&&this.childType!=="backgroundImage"||this.parent.stopSelfieSegmentation(),this.parent.removeChildren(this.childType),this.clonedStream!==void 0&&(Un.debug("to be released ..."),this.clonedStream.getAudioTracks().forEach(function(jt){jt.stop()}),this.clonedStream.getVideoTracks().forEach(function(jt){jt.stop()})),ou(Fo(Yt.prototype),"release",this).call(this,kt)}}]),Yt}(so),Gr=function($t){qs(Yt,$t);var Lt=Js(Yt);function Yt(kt,jt,sn){var ln;return Hs(this,Yt),(ln=Lt.call(this,kt)).name=ln.constructor.name,ln.appliedVideoProcessorType=jt,ln.stream=sn,ln}return Gs(Yt)}(zs(Error)),Wo=function($t){qs(Yt,$t);var Lt=Js(Yt);function Yt(kt,jt,sn){var ln;return Hs(this,Yt),(ln=Lt.call(this,kt)).name=ln.constructor.name,ln.appliedAudioProcessorType=jt,ln.stream=sn,ln}return Gs(Yt)}(zs(Error));function Ys($t,Lt){var Yt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Yt){if(Array.isArray($t)||(Yt=function(dt,gt){if(dt){if(typeof dt=="string")return tp(dt,gt);var Nt=Object.prototype.toString.call(dt).slice(8,-1);return Nt==="Object"&&dt.constructor&&(Nt=dt.constructor.name),Nt==="Map"||Nt==="Set"?Array.from(dt):Nt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Nt)?tp(dt,gt):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Yt&&($t=Yt);var kt=0,jt=function(){};return{s:jt,n:function(){return kt>=$t.length?{done:!0}:{done:!1,value:$t[kt++]}},e:function(dt){throw dt},f:jt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Kt=!1;return{s:function(){Yt=Yt.call($t)},n:function(){var dt=Yt.next();return ln=dt.done,dt},e:function(dt){Kt=!0,sn=dt},f:function(){try{ln||Yt.return==null||Yt.return()}finally{if(Kt)throw sn}}}}function tp($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Yt=0,kt=new Array(Lt);Yt<Lt;Yt++)kt[Yt]=$t[Yt];return kt}function np($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}var fo=ft.Y.get("Session"),um=On.get(),_o=new(Go()),cu=Ro.get(),du=uo.get(),pm=Symbol("ENTERPRISE_NOT_LOADED"),uu=Symbol("ENTERPRISE_LOADED"),rp=new WeakMap,ip=new WeakMap,ap=new WeakMap,Xs=function(){function $t(jt,sn,ln){if(function(Kt,dt){if(!(Kt instanceof dt))throw new TypeError("Cannot call a class as a function")}(this,$t),fo.info("Create Enterprise"),!(ln instanceof Br))throw"Cannot create Enterprise without a session";rp.set(this,ln),ap.set(this,sn),ip.set(this,jt),this.status=pm}var Lt,Yt,kt;return Lt=$t,Yt=[{key:"getSession",value:function(){return rp.get(this)}},{key:"getId",value:function(){return ip.get(this).toString()}},{key:"getApiKey",value:function(){return ap.get(this).toString()}},{key:"load",value:function(){var jt=this;return new Promise(function(sn,ln){_o.getEnterpriseUserList(jt.getId(),jt.getSession().getToken()).then(function(Kt){fo.info("Enterprise loaded!",Kt);var dt,gt=Ys(Kt.users);try{for(gt.s();!(dt=gt.n()).done;){var Nt=dt.value;if(jt.getSession().user.userId.toString()!==Nt.id.toString()){var Vt=cu.getOrCreateContact(Nt.id);Vt.profile=Nt,Vt.enterprise=jt,Vt.userData.get("username")===null&&Vt.userData.setProp("username",Nt.username),Vt.userData.get("photo_url")===null&&Vt.userData.setProp("photo_url",Nt.photo_url)}}}catch(zt){gt.e(zt)}finally{gt.f()}jt.status=uu,sn()}).catch(function(Kt){var dt="load() - Enterprise load error",gt={error:new Error(dt),code:et.g.ERROR_OTHER};Kt.hasOwnProperty("code")?gt.code=Kt.code:Kt.hasOwnProperty("http_code")&&(Kt.http_code.toString().startsWith("4")?gt.code=et.g.ERROR_INVALID_CREDENTIALS:gt.code=et.g.ERROR_SERVER_UNAVAILABLE),fo.error(dt,Kt),ln(gt)})})}},{key:"getContacts",value:function(){var jt={};if(this.status!==uu)fo.error("Enterprise is not loaded, unable to getContacts");else{var sn,ln=cu.getContacts(),Kt=Ys(ln.keys());try{for(Kt.s();!(sn=Kt.n()).done;){var dt=sn.value,gt=ln.get(dt);gt.enterprise!==null&&gt.enterprise.id.toString()===this.getId()&&(jt[gt.getId()]=gt)}}catch(Nt){Kt.e(Nt)}finally{Kt.f()}}return jt}},{key:"getConfiguration",value:function(){return null}},{key:"uploadFile",value:function(jt){var sn=this,ln=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Kt,dt){fo.info("uploadFile()"),sn.status===uu?_o.uploadFile(jt,sn.getSession().getToken(),ln).then(function(gt){Kt(gt.url)}).catch(function(gt){fo.error(gt),dt(gt)}):(fo.error("Enterprise is not loaded, cannot upload file"),dt(new Error("Enterprise is not loaded, cannot upload file")))})}},{key:"getAvailableConferences",value:function(){var jt=this;return fo.info("getAvailableConferences()"),new Promise(function(sn,ln){var Kt={};_o.getConferenceList(jt.getSession().getToken()).then(function(dt){var gt,Nt=Ys(dt);try{for(Nt.s();!(gt=Nt.n()).done;){var Vt=gt.value;Kt[Vt.hash]=du.getOrCreateConference(Vt.hash),Kt[Vt.hash].friendlyName=Vt.friendlyName}}catch(zt){Nt.e(zt)}finally{Nt.f()}sn(Kt)}).catch(function(dt){fo.error(dt),ln(dt)})})}},{key:"getConference",value:function(jt){var sn=this;return new Promise(function(ln,Kt){var dt={};dt.token=sn.getSession().getToken(),_o.getWebconf(jt,dt).then(function(gt){return ln(du.getOrCreateConference(gt.hash))}).catch(function(gt){return fo.error("getConference",gt),Kt(gt)})})}},{key:"createPrivateConference",value:function(){var jt=this,sn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return fo.info("createPrivateConference()"),new Promise(function(ln,Kt){var dt=sn.hasOwnProperty("friendlyName")?sn.friendlyName:Wt.g.guid(),gt=null,Nt=jt.getSession().getToken();_o.createConference(Nt,dt,sn).then(function(Vt){(gt=du.getOrCreateConference(Vt.hash)).friendlyName=dt;var zt=sn.hasOwnProperty("password")?sn.password:"";return gt.join({password:zt,session:jt.getSession()})}).then(function(){ln(gt)}).catch(function(Vt){var zt="createPrivateConference() - Could not create conference";fo.error(zt,Vt),Kt(new Error(zt))})})}},{key:"getTags",value:function(jt){var sn=this;return new Promise(function(ln,Kt){var dt={};jt&&jt.hasOwnProperty("webconfId")&&(dt.webconfId=jt.webconfId),_o.getEnterpriseTagList(sn.getId(),sn.getSession().getToken(),dt).then(function(gt){return gt.hasOwnProperty("tags")&&Array.isArray(gt.tags)?ln(gt.tags):Kt(Wt.g.createError(et.g.ERROR_OTHER,"getTags() - unexpected response",fo))}).catch(function(gt){return Kt(Wt.g.createError(et.g.ERROR_OTHER,"getTags() - cannot get tags",fo,{fromError:gt}))})})}}],kt=[{key:"fetchEnterpriseInformation",value:function(jt){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return sn.hasOwnProperty("cloudUrl")&&_o.setCloudURL(sn.cloudUrl),_o.getEnterpriseInformation(sn,jt)}},{key:"fetchSiteAgents",value:function(jt){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(ln,Kt){sn.hasOwnProperty("cloudUrl")&&_o.setCloudURL(sn.cloudUrl);var dt=[];_o.getSiteAgents(um.getActiveApiKey(),jt,sn).then(function(gt){var Nt,Vt=Ys(gt);try{for(Vt.s();!(Nt=Vt.n()).done;){var zt=Nt.value;dt.push({contact:cu.getOrCreateContact(zt.id),title:zt.title,nickname:zt.nickname,isPrefered:zt.isPrefered})}}catch(Xt){Vt.e(Xt)}finally{Vt.f()}ln(dt)}).catch(function(gt){Kt(Wt.g.createError(et.g.ERROR_OTHER,"fetchSiteAgents() - could not fetch site agents",fo))})})}}],Yt&&np(Lt.prototype,Yt),kt&&np(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function pu($t){return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},pu($t)}function hm($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function op($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}function hu($t,Lt){return hu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,kt){return Yt.__proto__=kt,Yt},hu($t,Lt)}function fm($t,Lt){if(Lt&&(pu(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bo($t)}function Bo($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Qs($t){return Qs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Qs($t)}s(3123);var mr=ft.Y.get("UserAgent"),vr=On.get(),ko=new(Go()),mm="apizee:",gm="apirtc:",vm="token:",Cm="apzkey:",bm="apiKey:",us=new WeakMap,ym=["mediaDeviceChanged","externalJsLoadingStatus","ccsConnectionStatus","userMediaError"],sp=function($t){(function(dt,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(gt&&gt.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),gt&&hu(dt,gt)})(Kt,$t);var Lt,Yt,kt,jt,sn,ln=(jt=Kt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,gt=Qs(jt);if(sn){var Nt=Qs(this).constructor;dt=Reflect.construct(gt,arguments,Nt)}else dt=gt.apply(this,arguments);return fm(this,dt)});function Kt(){var dt,gt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hm(this,Kt),dt=ln.call(this,mr),mr.debug("Create UserAgent"),dt.uri=gt.hasOwnProperty("uri")?gt.uri:null,dt.userId=null,dt.username=null,dt.profile=null,dt.preRegisterUserData=new Io,dt.callStatsMonitoringEnabled=null,dt.callStatsMonitoringInterval=null,dt.meshModeEnabled=null,dt.apiRTCMediaDeviceDetectionEnabled=!!gt.hasOwnProperty("apiRTCMediaDeviceDetectionEnabled")&&gt.apiRTCMediaDeviceDetectionEnabled,dt.apiRTCMediaDeviceDetectionDelay=gt.hasOwnProperty("apiRTCMediaDeviceDetectionDelay")?gt.apiRTCMediaDeviceDetectionDelay:et.g.APIRTC_MEDIA_DEVICE_DETECTION_DELAY,dt.targetBandwidthUsage=0,dt.videoBandwidthSettings={overallIncoming:3e3,overallOutgoing:3e3},dt.currentSession=null,dt.enterprise=null,dt.capabilities={whiteboardCursor:"ON",mediaDeviceChanged:"ON",webRTCCompliant:"ON",screenSharingCompliant:"ON",qoSStatCompliant:"ON",backgroundRemoval:"ON",streamCapabilities:"ON",noiseReduction:"ON",remoteAccessUser:"ON"},dt.browser=apiRTC.browser,dt.browser_major_version=apiRTC.browser_major_version,dt.browser_version=apiRTC.browser_version,dt.osName=apiRTC.osName,dt.osVersion=apiRTC.osVersion,dt.browserInfo=apiRTC.browserInfo,dt.browserDetails=apiRTC.browserDetails,dt.tFLiteModuleLoaded=!1,dt.tFLiteSIMDModule=null,dt.modelLoadedInModule=!1,dt.apiRTCStreamsList=new Map,us.set(Bo(dt),null),vr.createWhiteBoard(),apiCC.activateScreenSharing();var Nt=function(Zt){nn.get(Bo(dt)).emit("mediaDeviceChanged",{added:Zt.detail.diff.added,removed:Zt.detail.diff.removed,updated:Zt.detail.diff.updated,updateReason:Zt.detail.updateReason,firstMediaDeviceListInitialization:Zt.detail.firstMediaDeviceListInitialization})};apiRTC.addEventListener("mediaDeviceChanged",Nt,"UserAgent");var Vt=function(Zt){nn.get(Bo(dt)).emit("externalJsLoadingStatus",{extjs:Zt.detail.extjs,status:Zt.detail.status})};apiRTC.addEventListener("externalJsLoadingStatus",Vt,"UserAgent");var zt=function(Zt){var on=null;Zt.detail.channelEvent==="onChannelOpened"?on="connected":Zt.detail.channelEvent==="onChannelDisconnect"?on="disconnected":Zt.detail.channelEvent==="onChannelReconnecting"?on="retry":(Zt.detail.channelEvent==="onChannelConnectError"||Zt.detail.channelEvent==="onChannelError")&&(on="error"),on!==null&&nn.get(Bo(dt)).emit("ccsConnectionStatus",{status:on})};apiRTC.addEventListener("channelEvent",zt,"UserAgent");var Xt=function(Zt){var on={error:Zt.detail.error};Zt.detail.callType==="media"?(on.audio=!0,on.video=!0,on.screenSharing=!1):Zt.detail.callType==="audio"?(on.audio=!0,on.video=!1,on.screenSharing=!1):Zt.detail.callType==="videoOnly"?(on.audio=!1,on.video=!0,on.screenSharing=!1):Zt.detail.callType==="screenSharing"?(on.audio=!1,on.video=!0,on.screenSharing=!0):Zt.detail.callType==="screenSharingWithAudio"&&(on.audio=!0,on.video=!0,on.screenSharing=!0),nn.get(Bo(dt)).emit("userMediaError",on)};return apiRTC.addEventListener("userMediaError",Xt,"UserAgent"),dt.checkUACapabilities(),dt.capabilities.mediaDeviceChanged==="OFF"&&(mr.debug("mediaDeviceChanged is not supported"),dt.apiRTCMediaDeviceDetectionEnabled===!0&&(mr.debug("apiRTCMediaDeviceDetectionEnabled is activated, starting process"),setInterval(function(){apiCC.mediaDeviceMgr.getMediaDevices()},dt.apiRTCMediaDeviceDetectionDelay))),apiRTC.userAgentInstance=Bo(dt),dt}return Lt=Kt,Yt=[{key:"fetchUserMediaDevices",value:function(){return mr.warn("DEPRECATION WARNING : fetchUserMediaDevices() is now deprecated, use getUserMediaDevices() instead"),new Promise(function(dt,gt){apiCC.browser==="IE"&&apiCC.browser_version>8?(apiCC.getMediaDevicesWithCB(apiCC.mediaDeviceMgr.gotSources),dt(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray)):apiCC.getMediaDevices().then(function(Nt){apiCC.mediaDeviceMgr.gotSources(Nt),dt(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray)}).catch(function(){mr.log("Error on MediaDeviceManager::getMediaDevices"),apiCC.mediaDeviceMgr.gotSources(null),gt(Wt.g.createError(et.g.ERROR_OTHER,"fetchUserMediaDevices() - Could not get media devices",mr))})})}},{key:"getUserMediaDevices",value:function(){return apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray}},{key:"createStream",value:function(){var dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return mr.info("createStream() with option :",dt),so.createStreamFromUserMedia(dt.audioInputId,dt.videoInputId,dt.constraints,dt)}},{key:"createStreamFromMediaStream",value:function(dt){return mr.info("createStreamFromMediaStream()"),so.createStreamFromMediaStream(dt)}},{key:"fetchNetworkInformation_v2",value:function(dt,gt){mr.debug("fetchNetworkInformation Version 2 :",dt);var Nt=ko.cloudUrl;dt!=null&&(Nt=dt);var Vt={testServer:Nt,httpPing:{},upload:{},download:{}};return gt!=null&&Array.isArray(gt)?(apiRTC.bandwidthRatingThresholds=gt,mr.debug("New bandwidthRatingThresholds is defined :",apiRTC.bandwidthRatingThresholds)):mr.debug("Using default bandwidthRatingThresholds :",apiRTC.bandwidthRatingThresholds),apiRTC.bandwidthTestServer=Nt,mr.info("Start Network test"),new Promise(function(zt,Xt){apiRTC.testUserPing(function(Zt,on){Zt!==null?Xt(Zt):(Vt.httpPing=on,apiRTC.testUserUpload(25e4,function(bn,En){bn!==null?Xt(bn):(Vt.upload.kbps=8*En.kBPerSec,Vt.upload.rating=En.rating,apiRTC.testUserUploadLoop(5e5,Vt.upload,function(Gn,Kn){Gn!==null?Xt(Gn):(Vt.upload.kbps=8*Kn.kBPerSec,Vt.upload.rating=Kn.rating,apiRTC.testUserDownload(256,function(cr,hr){cr!==null?Xt(cr):(Vt.download.kbps=8*hr.kBPerSec,Vt.download.rating=hr.rating,apiRTC.testUserDownloadLoop(1e3,Vt.download,function(Ar,Xr){Ar!==null?Xt(Ar):(Vt.download.kbps=8*Xr.kBPerSec,Vt.download.rating=Xr.rating,zt(Vt))}))}))}))}))})})}},{key:"fetchNetworkInformation_v1",value:function(dt,gt){mr.debug("fetchNetworkInformation Version 1 :",dt);var Nt=ko.cloudUrl;dt!=null&&(Nt=dt);var Vt={testServer:Nt,httpPing:{},upload:{},download:{}};return gt!=null&&Array.isArray(gt)?(apiRTC.bandwidthRatingThresholds=gt,mr.debug("New bandwidthRatingThresholds is defined :",apiRTC.bandwidthRatingThresholds)):mr.debug("Using default bandwidthRatingThresholds :",apiRTC.bandwidthRatingThresholds),apiRTC.bandwidthTestServer=Nt,mr.info("Start Network test"),new Promise(function(zt,Xt){apiRTC.testUserPing(function(Zt,on){Zt!==null?Xt(Zt):(Vt.httpPing=on,apiRTC.testUserUpload(25e4,function(bn,En){bn!==null?Xt(bn):(Vt.upload.kbps=8*En.kBPerSec,Vt.upload.rating=En.rating,Vt.upload.kbps>=1e3&&apiRTC.testUserUpload(5e5,function(Gn,Kn){Gn!==null?Xt(Gn):(Vt.upload.kbps=8*Kn.kBPerSec,Vt.upload.rating=Kn.rating)}),apiRTC.testUserDownload(256,function(Gn,Kn){Gn!==null?Xt(Gn):(Vt.download.kbps=8*Kn.kBPerSec,Vt.download.rating=Kn.rating,Vt.download.kbps>=500&&Vt.download.kbps<1500?apiRTC.testUserDownload(500,function(cr,hr){cr!==null?Xt(cr):(Vt.download.kbps=8*hr.kBPerSec,Vt.download.rating=hr.rating,zt(Vt))}):Vt.download.kbps>=1500?apiRTC.testUserDownload(768,function(cr,hr){cr!==null?Xt(cr):(Vt.download.kbps=8*hr.kBPerSec,Vt.download.rating=hr.rating,zt(Vt))}):zt(Vt))}))}))})})}},{key:"fetchNetworkInformation",value:function(dt,gt){return this.fetchNetworkInformation_v1(dt,gt)}},{key:"fetchGeolocationInformation",value:function(dt){return dt==null&&(dt={enableHighAccuracy:!1,timeout:1/0,maximumAge:0}),new Promise(function(gt,Nt){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(Vt){gt(Vt)},function(Vt){Nt(Vt)},dt)})}},{key:"setUserData",value:function(dt){this.currentSession&&this.currentSession.setUserData(dt)}},{key:"setUsername",value:function(dt){this.currentSession?this.currentSession.setUsername(dt):this.preRegisterUserData.setProp("username",dt)}},{key:"setPhotoUrl",value:function(dt){this.currentSession?this.currentSession.setPhotoUrl(dt):this.preRegisterUserData.setProp("photo_url",dt)}},{key:"getUserData",value:function(){return this.currentSession?this.currentSession.getUserData():this.preRegisterUserData}},{key:"getUsername",value:function(){return this.currentSession?this.currentSession.getUsername():this.preRegisterUserData.get("username")!==null?this.preRegisterUserData.get("username"):this.preRegisterUserData.get("nickname")!==null?this.preRegisterUserData.get("nickname"):this.username}},{key:"getPhotoUrl",value:function(){return this.currentSession?this.currentSession.getPhotoUrl():this.preRegisterUserData.get("photo_url")!==null?this.preRegisterUserData.get("photo_url"):this.preRegisterUserData.get("photoUrl")!==null?this.preRegisterUserData.get("photoUrl"):null}},{key:"fetchProfileInformation",value:function(dt){var gt=this,Nt=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Promise(function(Vt,zt){var Xt=null;gt.profile===null||Nt?gt.userId&&(Xt=vr.getActiveApiKey())!==null?ko.getUserProfile(Xt,gt.userId,dt).then(function(Zt){gt.profile=Zt,Vt(Zt)}).catch(zt):zt("fetchProfileInformation() - missing registration"):Vt(gt.profile)})}},{key:"getEnterprise",value:function(){return us.get(this)}},{key:"getCurrentSession",value:function(){return this.currentSession}},{key:"getEventCenter",value:function(){return apiRTC.eventCenter}},{key:"startWhiteboard",value:function(dt,gt){mr.trace("startWhiteboard()"),vr.whiteBoardClient.start(),vr.whiteBoardClient.setCanvas(dt),gt!=null&&vr.whiteBoardClient.setUserCursorColor(gt)}},{key:"stopWhiteboard",value:function(){mr.trace("stopWhiteboard()"),vr.whiteBoardClient.stop()}},{key:"getWhiteboardClient",value:function(){return mr.trace("getWhiteboardClient()"),vr.whiteBoardClient}},{key:"register",value:function(){var dt=this,gt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(Nt,Vt){if(mr.info("Register "+dt.uri),gt.hasOwnProperty("uri")&&(dt.uri=gt.uri),gt.hasOwnProperty("cloudUrl")&&ko.setCloudURL(gt.cloudUrl),gt.hasOwnProperty("cloudFetchRetries")&&ko.setFetchRetries(gt.cloudFetchRetries),gt.hasOwnProperty("cloudFetchRetryDelay")&&ko.setFetchRetryDelay(gt.cloudFetchRetryDelay),dt.uri!==null)if(dt.currentSession)Vt(Wt.g.createError(et.g.ERROR_APIRTC_SESSION_ALREADY_ON,"register() - Session already ON",mr));else if(dt.uri.startsWith(vm))Tm(dt,gt,Nt,Vt);else if(dt.uri.startsWith(mm)||dt.uri.startsWith(gm))Sm(dt,gt,Nt,Vt);else if(dt.uri.startsWith(Cm)||dt.uri.startsWith(bm))Im(dt,gt,Nt,Vt);else{var zt=dt.uri.split(":")[0];Vt(Wt.g.createError(et.g.ERROR_REGISTRATION_URI_INVALID,"register() - prefix invalid used for uri :"+zt,mr))}else Vt(Wt.g.createError(et.g.ERROR_REGISTRATION_URI_INVALID,"register() - Cannot register UserAgent, no uri was specified",mr))})}},{key:"unregister",value:function(){var dt=this,gt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{invalidateUserToken:!0,unregister:!0};return new Promise(function(Nt,Vt){dt.currentSession!==null?dt.currentSession.disconnect(gt).then(function(){dt.currentSession=null,us.set(dt,null),Nt()}).catch(function(zt){Vt(Wt.g.createError(et.g.ERROR_OTHER,"unregister() - unregistration error",mr))}):Vt(Wt.g.createError(et.g.ERROR_OTHER,"unregister() - no current session",mr))})}},{key:"isRegistered",value:function(){return this.currentSession!==null}},{key:"getDefaultDevices",value:function(){return{audioInput:apiCC.mediaDeviceMgr.defaultAudioInput,audioOutput:apiCC.mediaDeviceMgr.defaultAudioOuput,videoInput:apiCC.mediaDeviceMgr.defaultVideoInput}}},{key:"enableCallStatsMonitoring",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};["chrome","firefox","safari"].indexOf(apiCC.browserDetails.type)<0?mr.warn("enableCallStatsMonitoring() is only supported on Chrome, Firefox and Safari, support on other browsers will be added soon"):dt===!0?(this.callStatsMonitoringEnabled=!0,Wt.g.isPropertyTypeof(gt,"interval","number")&&gt.interval>=1e3&&(this.callStatsMonitoringInterval=gt.interval),this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.enableCallStatsMonitoring(!0,this.callStatsMonitoringInterval)):(this.callStatsMonitoringEnabled=!1,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.enableCallStatsMonitoring(!1))}},{key:"enableActiveSpeakerDetecting",value:function(dt){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};dt===!0?Wt.g.isPropertyTypeof(gt,"threshold","number")&&gt.threshold>0?apiRTC.enableActiveSpeakerDetecting(!0,gt.threshold):apiRTC.enableActiveSpeakerDetecting(!0):apiRTC.enableActiveSpeakerDetecting(!1)}},{key:"enableMeshRoomMode",value:function(dt){dt===!1||dt===!0?(this.meshModeEnabled=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.enableMeshRoomMode(dt)):mr.error("Wrong value",dt)}},{key:"setTargetBandwidthUsage",value:function(dt){typeof dt!="number"&&!isNaN(dt)&&dt>0?(this.targetBandwidthUsage=dt,this.isRegistered&&vr.webRTCClient.setVideoBandwidth(dt)):mr.error("Unvalid target bandwidth usage value",dt)}},{key:"setOverallIncomingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.overallIncoming=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setOverallIncomingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.overallIncoming,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setOverallIncomingVideoBandwidth(0))}},{key:"setOverallOutgoingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.overallOutgoing=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setOverallOutgoingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.overallOutgoing,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setOverallOutgoingVideoBandwidth(0))}},{key:"setPerCallIncomingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.perCallIncoming=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setPerCallIncomingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.perCallIncoming,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setPerCallIncomingVideoBandwidth(0))}},{key:"setPerCallOutgoingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.perCallOutgoing=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setPerCallOutgoingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.perCallOutgoing,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setPerCallOutgoingVideoBandwidth(0))}},{key:"updateMediaOnCall",value:function(dt,gt){vr.webRTCClient.updateMediaDeviceOnCall(dt,gt)}},{key:"getCapabilities",value:function(){return this.capabilities}},{key:"getBrowser",value:function(){return this.browser}},{key:"getBrowserMajorVersion",value:function(){return this.browser_major_version}},{key:"getBrowserVersion",value:function(){return this.browser_version}},{key:"getOsName",value:function(){return this.osName}},{key:"getOsVersion",value:function(){return this.osVersion}},{key:"getBrowserInfo",value:function(){return this.browserInfo}},{key:"getBrowserDetails",value:function(){return this.browserDetails}},{key:"getCPUArchitecture",value:function(){return this.getUserData().cpuArchitecture}},{key:"getDeviceVendor",value:function(){return this.getUserData().deviceVendor}},{key:"getDeviceModel",value:function(){return this.getUserData().deviceModel}},{key:"getEngineName",value:function(){return this.getUserData().engineName}},{key:"getEngineVersion",value:function(){return this.getUserData().engineVersion}},{key:"checkUACapabilities",value:function(){mr.debug("checkUACapabilities"),apiRTC.osName==="iOS"&&(mr.debug("Deactivating whiteboardCursor for iOS"),this.capabilities.whiteboardCursor="OFF"),apiRTC.osName==="Android"&&apiRTC.browser==="Chrome"&&(mr.debug("mediaDeviceChanged not supported on Chrome/Android"),this.capabilities.mediaDeviceChanged="OFF"),pt.Xh!=="Safari"&&pt.Xh!=="Mobile Safari"||(mr.debug("mediaDeviceChanged not supported on Safari"),this.capabilities.mediaDeviceChanged="OFF"),apiRTC.webRTCCompliant===!1&&(mr.debug("WebRTC not compliant"),this.capabilities.webRTCCompliant="OFF"),apiRTC.screenSharingCompliant===!1&&(mr.debug("screenSharing not compliant"),this.capabilities.screenSharingCompliant="OFF"),apiRTC.qoSStatCompliant===!1&&(mr.debug("qoS Stat not compliant"),this.capabilities.qoSStatCompliant="OFF"),pt.Xh!=="Safari"&&pt.Xh!=="Mobile Safari"||(mr.debug("background removal not compliant"),this.capabilities.backgroundRemoval="ON",mr.debug("noiseReduction not compliant"),this.capabilities.noiseReduction="OFF"),"getCapabilities"in MediaStreamTrack.prototype||(mr.debug("Stream capabilities not compliant"),this.capabilities.streamCapabilities="OFF"),(apiRTC.osName!=="Windows"&&apiRTC.osVersion!=="10"||apiRTC.osName!=="Windows"&&apiRTC.osVersion!=="11")&&(mr.debug("remoteAccessUser not compliant"),this.capabilities.remoteAccessUser="OFF")}},{key:"startPrecallTest",value:function(dt,gt,Nt,Vt,zt){vr.webRTCClient.startPrecallTest(dt,gt,Nt,Vt,zt)}},{key:"sendLogToCloud",value:function(dt,gt,Nt,Vt){apiCC.sendLogToCloud(dt,gt,Nt,Vt)}},{key:"getStreamWithRoomNameAndCallId",value:function(dt,gt){mr.debug("getStreamWithRoomNameAndCallId");var Nt="NOT_FOUND";return apiRTC.userAgentInstance.apiRTCStreamsList.forEach(function(Vt){var zt=0;if((zt=Vt.publishedInConversations.get(dt))!==void 0&&zt.toString()===gt.toString())return mr.debug(" Stream is found"),Nt=Vt;mr.debug(" This is not the stream")}),Nt}},{key:"getStreamWithMediaStreamId",value:function(dt){mr.debug("getStreamWithMediaStreamId");var gt="NOT_FOUND";return apiRTC.userAgentInstance.apiRTCStreamsList.forEach(function(Nt){if(Nt.data.id===dt.toString())return mr.debug(" Stream is found"),gt=Nt;mr.debug(" This is not the stream")}),gt}}],kt=[{key:"getAvailableEvents",value:function(){return ym}}],Yt&&op(Lt.prototype,Yt),kt&&op(Lt,kt),Object.defineProperty(Lt,"prototype",{writable:!1}),Kt}(fn),Sm=function($t,Lt,Yt,kt){var jt=$t.uri.split(":");mr.debug("register() - Registration using prefix :"+jt[0]);var sn=jt[1];Lt.password!==null&&typeof Lt.password=="string"?ko.authentication(sn,Lt.password,Lt.captcha_token).then(function(ln){return lp($t,ln.token,Lt)}).then(function(ln){Yt(ln)}).catch(function(ln){mr.error("registerPrefixApizee err : ",ln.message);var Kt="register() - An error occured during cloud credentials registration :"+JSON.stringify(ln),dt=ln;dt.message=Kt,ln.hasOwnProperty("code")?dt.code=ln.code:ln.hasOwnProperty("http_code")&&(ln.http_code.toString().startsWith("4")?dt.code=et.g.ERROR_INVALID_CREDENTIALS:dt.code=et.g.ERROR_SERVER_UNAVAILABLE),kt(dt)}):kt(Wt.g.createError(et.g.ERROR_INVALID_CREDENTIALS,"register() - No password was specified for apizee: UserAgent registration",mr))},Tm=function($t,Lt,Yt,kt){mr.debug("register() - Registration using prefix :token:");var jt=$t.uri.split(":")[1];ko.checkUserToken(jt).then(function(sn){return lp($t,jt,Lt)}).then(Yt).catch(function(sn){kt(Wt.g.createError(et.g.ERROR_OTHER,"register() - An error occured during cloud token registration",mr))})},Im=function($t,Lt,Yt,kt){var jt=$t.uri.split(":");mr.debug("register() - Registration using prefix :"+jt[0]);var sn=jt[1];if(!sn||typeof sn!="string")return kt(Wt.g.createError(et.g.ERROR_OTHER,"register() - Wrong apiKey",mr));new Promise(function(ln,Kt){ko.getPreferredCCS(sn).then(function(dt){Lt.ccs&&Lt.ccs!==dt.ccs&&(mr.debug("Overloading CCS address with init option"),dt.ccs=Lt.ccs),ln(dt)}).catch(function(){Kt(Wt.g.createError(et.g.ERROR_OTHER,"register() - Could not get preferred CCS",mr))})}).then(function(ln){$t.currentSession=new Br($t),$t.currentSession.user=$t,$t.currentSession.token=null,Wt.g.isPropertyTypeof(Lt,"nickname","string")?$t.username=Lt.nickname:$t.username="guest-"+Wt.g.guid().substr(0,13),$t.preRegisterUserData.setProp("username",$t.username),$t.preRegisterUserData.setProp("userConfId",$t.username+Date.now()),Lt.userData&&$t.preRegisterUserData.setProps(Lt.userData);var Kt={apiKey:sn,MCUActivated:!0,mcu:Lt.hasOwnProperty("mcu")?Lt.mcu:et.g.DEFAULT_MCU,nickname:$t.username,ccsServer:ln.ccs,bandwidthTestServer:ko.cloudUrl,webRTCPluginActivated:!0,userData:$t.preRegisterUserData,tryAudioCallAfterUserMediaError:!0,extJsLoadingRetryNb:Lt.extJsLoadingRetryNb,extJsLoadingRetryDelay:Lt.extJsLoadingRetryDelay,ccsConnectionRetryNb:Lt.ccsConnectionRetryNb,ccsConnectionRetryDelay:Lt.ccsConnectionRetryDelay,turnServerAddress:Lt.turnServerAddress,userAcceptOnIncomingDataCall:Lt.userAcceptOnIncomingDataCall,userAcceptOnIncomingScreenSharingCall:Lt.userAcceptOnIncomingScreenSharingCall,cloudIsSecured:ln.secure};return Lt.hasOwnProperty("id")&&(Kt.apiCCId=Lt.id),Wt.g.isPropertyTypeof(Lt,"idPersistenceTimeout","number")&&Lt.idPersistenceTimeout>=0&&(Kt.apiCCIdPersistenceTimeout=Lt.idPersistenceTimeout),Lt.hasOwnProperty("groups")&&(Kt.presenceGroup=Lt.groups),Lt.hasOwnProperty("subscribeTo")&&(Kt.subscribeToPresenceGroup=Lt.subscribeTo),Lt.hasOwnProperty("contactDisconnectionDelay")&&(mr.debug("Setting contactDisconnectionDelay :",Lt.contactDisconnectionDelay),vr.contactDisconnectionDelay=Lt.contactDisconnectionDelay),Kt.idConversionActivated=!1,Lt.hasOwnProperty("idConversionActivated")&&(Kt.idConversionActivated=Lt.idConversionActivated),Lt.hasOwnProperty("conversationSpace")&&(Kt.conversationSpace=Lt.conversationSpace),Lt.hasOwnProperty("token")&&(Kt.token=Lt.token,$t.currentSession.ccsToken=Lt.token),vr.initializeApiRTC(Kt)}).then(function(ln){$t.callStatsMonitoringEnabled!==!1&&$t.callStatsMonitoringEnabled!==!0||vr.webRTCClient.enableCallStatsMonitoring($t.callStatsMonitoringEnabled,$t.callStatsMonitoringInterval),$t.meshModeEnabled!==!1&&$t.meshModeEnabled!==!0||vr.webRTCClient.enableMeshRoomMode($t.meshModeEnabled),$t.targetBandwidthUsage>0&&vr.webRTCClient.setVideoBandwidth($t.targetBandwidthUsage),$t.videoBandwidthSettings.overallIncoming>0&&vr.webRTCClient.setOverallIncomingVideoBandwidth($t.videoBandwidthSettings.overallIncoming),$t.videoBandwidthSettings.overallOutgoing>0&&vr.webRTCClient.setOverallOutgoingVideoBandwidth($t.videoBandwidthSettings.overallOutgoing),$t.videoBandwidthSettings.perCallIncoming>0&&vr.webRTCClient.setPerCallIncomingVideoBandwidth($t.videoBandwidthSettings.perCallIncoming),$t.videoBandwidthSettings.perCallOutgoing>0&&vr.webRTCClient.setPerCallOutgoingVideoBandwidth($t.videoBandwidthSettings.perCallOutgoing),$t.userId=ln,$t.currentSession.init(ln),mr.log("register() - APIRTC init OK",ln),vr.apiRTCSession.userData!==void 0&&vr.apiRTCSession.userData!==null&&($t.currentSession.userData=new Io(vr.apiRTCSession.userData)),Yt($t.currentSession)}).catch(function(ln){kt(Wt.g.createError(et.g.ERROR_APIRTC_INITIALISATION_FAILED,"register() - ApiRTC Initialization error : "+ln,mr)),delete $t.currentSession,$t.currentSession=null})},lp=function($t,Lt){var Yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},kt=null,jt=null;return mr.debug("initializeCloudUASession :",Yt),new Promise(function(sn,ln){ko.getConnectedUserInformation(Lt).then(function(Kt){if(jt=Kt,mr.debug("Connected user information : ",Kt),$t.currentSession=new Br($t),$t.currentSession.user=$t,$t.currentSession.token=Kt.token,Yt.hasOwnProperty("idPersistenceTimeout")&&($t.currentSession.idPersistenceTimeout=Yt.idPersistenceTimeout),$t.username=Kt.nickname,$t.preRegisterUserData.setProp("username",$t.username),$t.preRegisterUserData.setProp("nickname",$t.username),$t.preRegisterUserData.setProp("photo_url",Kt.photo_url),Kt.mail&&$t.preRegisterUserData.setProp("mail",Kt.mail),$t.preRegisterUserData.setProp("userConfId",$t.username+Date.now()),Yt.userData&&$t.preRegisterUserData.setProps(Yt.userData),!Yt.hasOwnProperty("overLoadedApiRTCKey")||Yt.overLoadedApiRTCKey===null||Yt.overLoadedApiRTCKey===void 0||Kt.apiKey===Yt.overLoadedApiRTCKey)return $t.userId=Kt.userId,kt=new Xs(Kt.enterpriseId,Kt.apiKey,$t.currentSession),us.set($t,kt),kt.load();mr.debug("overLoadedApiRTCKey is defined :",Yt.overLoadedApiRTCKey),kt=new Xs(Kt.enterpriseId,Yt.overLoadedApiRTCKey,$t.currentSession),delete Yt.id,$t.userId=null,us.set($t,kt),mr.debug("... no enterprise users data loading")}).then(function(){var Kt={apiKey:kt.getApiKey(),ccsServer:Yt.ccs||jt.ccs,MCUActivated:!0,mcu:Yt.hasOwnProperty("mcu")?Yt.mcu:et.g.DEFAULT_MCU,nickname:$t.username,bandwidthTestServer:ko.cloudUrl,webRTCPluginActivated:!0,apiCCId:Yt.hasOwnProperty("id")?Yt.id:$t.userId,userData:$t.preRegisterUserData,tryAudioCallAfterUserMediaError:!0,presenceGroup:["agent"],subscribeToPresenceGroup:["agent","visitor"],extJsLoadingRetryNb:Yt.extJsLoadingRetryNb,extJsLoadingRetryDelay:Yt.extJsLoadingRetryDelay,ccsConnectionRetryNb:Yt.ccsConnectionRetryNb,ccsConnectionRetryDelay:Yt.ccsConnectionRetryDelay,turnServerAddress:Yt.turnServerAddress,userAcceptOnIncomingDataCall:Yt.userAcceptOnIncomingDataCall,userAcceptOnIncomingScreenSharingCall:Yt.userAcceptOnIncomingScreenSharingCall};return Wt.g.isPropertyTypeof(Yt,"idPersistenceTimeout","number")&&Yt.idPersistenceTimeout>=0&&(Kt.apiCCIdPersistenceTimeout=Yt.idPersistenceTimeout),Yt.hasOwnProperty("groups")&&(Kt.presenceGroup=Yt.groups),Yt.hasOwnProperty("subscribeTo")&&(Kt.subscribeToPresenceGroup=Yt.subscribeTo),Yt.hasOwnProperty("contactDisconnectionDelay")&&(mr.debug("Setting contactDisconnectionDelay :",Yt.contactDisconnectionDelay),vr.contactDisconnectionDelay=Yt.contactDisconnectionDelay),Kt.idConversionActivated=!1,Yt.hasOwnProperty("idConversionActivated")&&(Kt.idConversionActivated=Yt.idConversionActivated),Yt.hasOwnProperty("conversationSpace")&&(Kt.conversationSpace=Yt.conversationSpace),vr.initializeApiRTC(Kt)}).then(function(Kt){$t.callStatsMonitoringEnabled!==!1&&$t.callStatsMonitoringEnabled!==!0||vr.webRTCClient.enableCallStatsMonitoring($t.callStatsMonitoringEnabled,$t.callStatsMonitoringInterval),$t.meshModeEnabled!==!1&&$t.meshModeEnabled!==!0||vr.webRTCClient.enableMeshRoomMode($t.meshModeEnabled),$t.targetBandwidthUsage>0&&vr.webRTCClient.setVideoBandwidth($t.targetBandwidthUsage),$t.videoBandwidthSettings.overallIncoming>0&&vr.webRTCClient.setOverallIncomingVideoBandwidth($t.videoBandwidthSettings.overallIncoming),$t.videoBandwidthSettings.overallOutgoing>0&&vr.webRTCClient.setOverallOutgoingVideoBandwidth($t.videoBandwidthSettings.overallOutgoing),$t.videoBandwidthSettings.perCallIncoming>0&&vr.webRTCClient.setPerCallIncomingVideoBandwidth($t.videoBandwidthSettings.perCallIncoming),$t.videoBandwidthSettings.perCallOutgoing>0&&vr.webRTCClient.setPerCallOutgoingVideoBandwidth($t.videoBandwidthSettings.perCallOutgoing),$t.currentSession.init(Kt),mr.info("APIRTC init OK",Kt),vr.apiRTCSession.userData!==void 0&&vr.apiRTCSession.userData!==null&&($t.currentSession.userData=new Io(vr.apiRTCSession.userData)),sn($t.currentSession)}).catch(function(Kt){mr.error(Kt),ln(Kt)})})};function Rm($t,Lt){for(var Yt=0;Yt<Lt.length;Yt++){var kt=Lt[Yt];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty($t,kt.key,kt)}}var Xo=ft.Y.get("ResourcesLoader"),Em=function(){function $t(){(function(kt,jt){if(!(kt instanceof jt))throw new TypeError("Cannot call a class as a function")})(this,$t),this.loadedJsLinks=[]}var Lt,Yt;return Lt=$t,Yt=[{key:"loadjs",value:function(kt){function jt(sn,ln,Kt){return kt.apply(this,arguments)}return jt.toString=function(){return kt.toString()},jt}(function(kt,jt,sn){var ln=this;Xo.info("Load js resources",kt),Xo.debug("Already loaded js",this.loadedJsLinks);var Kt=sn.success;if((kt=kt.filter(function(dt){return!ln.loadedJsLinks.includes(dt)})).length===0)return Xo.debug("Skip resources loading, all resources previously loaded"),void(Kt instanceof Function&&Kt());Xo.debug("Filtered resources to load",kt),sn.success=function(){ln.loadedJsLinks.push.apply(ln.loadedJsLinks,kt),Kt instanceof Function&&Kt()},_e(kt,jt,sn)})},{key:"unloadjs",value:function(kt){var jt=this;Xo.info("Unload js",kt),kt.forEach(function(sn){var ln=document.querySelector('script[src="'+sn+'"]');ln!==void 0&&(ln.remove(),jt.loadedJsLinks=jt.loadedJsLinks.filter(function(Kt){return Kt!==sn}))}),Xo.debug("Scripts unloaded, currently loaded js",this.loadedJsLinks)}},{key:"reset",value:function(){unloadjs(this.loadedJsLinks),this.loadedJsLinks=[]}}],Yt&&Rm(Lt.prototype,Yt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}(),Mr=ft.Y.get("Init"),_a=ft.Y.get("MediaDeviceManager");function fu($t){return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},fu($t)}it=s.hmd(it),console!=null&&(typeof apiRTC_React<"u"?console.info&&console.info("Loading APIRTC_REACT_NATIVE_MODULE"):console.info&&console.info("Loading APIRTC_MODULE")),window.Prototype&&delete Array.prototype.toJSON;var cp=new(Go());It.version="5.0.14",It.utils={},It.eventCenter=new Mt,It.resourcesLoader=new Em;for(var mu=0,dp=Object.keys(et.g);mu<dp.length;mu++){var up=dp[mu];It[up]=et.g[up]}It.utils.EventEmitter=ht,It.utils.EventCenter=Mt,It.MediaDevice=Ht,It.Stream=so,It.Call=qr,It.Conversation=jo,It.ConversationCall=Gl,It.Conference=Fs,It.Contact=No,It.Enterprise=Xs,It.SentInvitation=Do,It.ReceivedInvitation=Rn,It.ReceivedCallInvitation=Ir,It.ReceivedConversationJoinRequest=Ho,It.ReceivedConversationInvitation=Bt,It.ReceivedFileTransferInvitation=eo,It.ReceivedWhiteboardInvitation=vs,It.ReceivedDataChannelInvitation=zo,It.ReceivedPointerSharingInvitation=xl,It.PointerSharingRoom=ru,It.Session=Br,It.UserAgent=sp,It.UserData=Io,It.CloudApi=cp,It.DataChannel=ys,It.Observable=fn,It.setLogLevel=function($t){ft.Y.setLogLevel($t)};var pp=!1;window.apiRTC===void 0?(fu(it)==="object"&&it.exports&&(it.exports=It),window.apiRTC2=window.apiRTC=window.apiCC=window.CC=It,pp=!0):console.info("APIRTC_MODULE already loaded with version :",apiRTC.version),s(4170),pp===!0&&(It.init=function($t){var Lt,Yt;if(Mr.info("apiRTC initialization, version is :"+apiCC.version),Mr.info("osName :"+apiCC.osName),Mr.info("osVersion :"+apiCC.osVersion),Mr.info("browser :"+apiCC.browser),Mr.info("browser_version :"+apiCC.browser_version),Lt=$t.apiKey,Yt=!0,Mr.info("apiKey :",Lt),Lt.indexOf("[")!==-1&&(Yt=!1),Yt===!0)if($t.hasOwnProperty("apiCCId")&&$t.apiCCId!==null&&$t.apiCCId!==""&&function(ln){if(ln!==null){var Kt=ln;if(typeof Kt=="number"&&(Kt=String(Kt)),typeof Kt=="string")return Kt.length<=128}return!1}($t.apiCCId)!==!0)Mr.error("apiCCId format is not correct, leaving connection process");else{var kt="";if(kt=window!==void 0&&window.location!==void 0&&window.location.protocol!==void 0&&window.location.protocol!="https:"?"http":"https",pt.ag.name!=="iOS"&&pt.ag.name!=="Android"||(Mr.log(pt.ag.name+" detected forcing protocol to https"),kt="https"),$t.ccsServer===void 0?(Mr.debug("Setting ccsServer"),window!==void 0&&window.location!==void 0&&window.location.protocol!==void 0?window.location.protocol=="https:"||pt.ag.name==="iOS"||pt.ag.name==="Android"?$t.ccsServer="ccs5.apizee.com:443":$t.ccsServer="ccs5.apizee.com:80":$t.ccsServer="ccs5.apizee.com:443"):Mr.log("ccsServer is defined on init()"),$t.bandwidthTestServer!==null&&$t.bandwidthTestServer!==void 0?(Mr.log("bandwidthTestServer is defined :",$t.bandwidthTestServer),apiCC.bandwidthTestServer=$t.bandwidthTestServer):Mr.log("bandwidthTestServer is not defined"),$t.userData!==void 0&&Mr.log("userData :",$t.userData),apiCC.extJsLoadingRetryNb=$t.extJsLoadingRetryNb,apiCC.extJsLoadingRetryDelay=$t.extJsLoadingRetryDelay,apiCC.jsLoaded===!1){apiCC.initApiKey=$t.apiKey,apiCC.initApiCCId=$t.apiCCId;var jt=function(){Mr.log("sio loaded"),apiCC.jsLoaded=!0,apiCC.session=new apiCC.ApiCCSession($t),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("sio","loaded")},sn={success:jt,error:function(){Mr.error("sio loading error"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("sio","error")},retrycb:function(){Mr.warn("sio retry"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("sio","retry")}};apiCC.sioEmbedded?(window.rtcio=io,jt()):apiRTC_sioLoader.load(kt,$t,sn)}else Mr.log("apiRTC JS Librairies already loaded"),Mr.log("initParameters have changed, need to reload session connection"),apiCC.addEventListener("sessionReady",$t.onReady),Mr.log("initParameters.userData :",$t.userData),$t.apiCCId!==void 0&&$t.apiCCId!==""&&$t.apiCCId!==null||(Mr.log("keeping apiCCId defined by apiRTC :"+$t.apiCCId),$t.apiCCId=apiCC.session.apiCCId),Mr.log("initParameters.apiCCId :"+$t.apiCCId),$t.userData!==null&&$t.userData!==void 0?(Mr.log("userData is defined :",$t.userData),apiCC.session.userData=$t.userData):Mr.log("userData is not defined"),Mr.log("apiCC.session.userData :",apiCC.session.userData),$t.token!==null&&$t.token!==void 0?(Mr.log("token is defined :"+$t.token),apiCC.session.token=$t.token):(Mr.log("token is not defined"),apiCC.session.token=null),$t.conversationSpace!==null&&$t.conversationSpace!==void 0?(Mr.log("conversationSpace is defined :"+$t.conversationSpace),apiCC.session.conversationSpace=$t.conversationSpace):(Mr.log("conversationSpace is not defined"),apiCC.session.conversationSpace=null),apiCC.session.reOpenChannel($t.apiCCId,$t.apiKey),$t.nickname!==null&&$t.nickname!==void 0?(Mr.log("Nickname is defined :"+$t.nickname),apiCC.session.nickname=$t.nickname):(Mr.log("Nickname is not defined, setting to apiCCId value :"+apiCC.session.apiCCId),apiCC.session.nickname=apiCC.session.apiCCId),$t.photoURL!==null&&$t.photoURL!==void 0?(Mr.log("photoURL is defined :"+$t.photoURL),apiCC.session.photoURL=$t.photoURL):(Mr.log("photoURL is not defined"),apiCC.session.photoURL=null),$t.presenceGroup!==null&&$t.presenceGroup!==void 0?(Mr.log("presenceGroup is defined :"+$t.presenceGroup),JSON.stringify(apiCC.session.presenceGroup)!==JSON.stringify($t.presenceGroup)&&(Mr.log("presenceGroup updated on initParameters"),apiCC.session.channel.updatePresenceGroupIsNeeded=!0,apiCC.session.channel.oldPresenceGroup===null&&(apiCC.session.channel.oldPresenceGroup=apiCC.session.presenceGroup),apiCC.session.channel.newPresenceGroup=$t.presenceGroup,apiCC.session.presenceGroup=$t.presenceGroup)):(Mr.log('presenceGroup is not defined, setting to ["default"]'),JSON.stringify(apiCC.session.presenceGroup)!==JSON.stringify(["default"])&&(Mr.log("presenceGroup updated on initParameters"),apiCC.session.channel.updatePresenceGroupIsNeeded=!0,apiCC.session.channel.oldPresenceGroup===null&&(apiCC.session.channel.oldPresenceGroup=apiCC.session.presenceGroup),apiCC.session.channel.newPresenceGroup=["default"],apiCC.session.presenceGroup=["default"])),$t.subscribeToPresenceGroup!==null&&$t.subscribeToPresenceGroup!==void 0?(Mr.log("subscribeToPresenceGroup is defined :"+$t.subscribeToPresenceGroup),JSON.stringify(apiCC.session.subscribeToPresenceGroup)!==JSON.stringify($t.subscribeToPresenceGroup)&&(Mr.log("subscribeToPresenceGroup updated on initParameters"),apiCC.session.channel.updateSubscribeToPresenceGroupIsNeeded=!0,apiCC.session.channel.oldSubscribeToPresenceGroup===null&&(apiCC.session.channel.oldSubscribeToPresenceGroup=apiCC.session.subscribeToPresenceGroup),apiCC.session.channel.newSubscribeToPresenceGroup=$t.subscribeToPresenceGroup,apiCC.session.subscribeToPresenceGroup=$t.subscribeToPresenceGroup)):(Mr.log('subscribeToPresenceGroup is not defined, setting to ["default"]'),JSON.stringify(apiCC.session.subscribeToPresenceGroup)!==JSON.stringify(["default"])&&(Mr.log("subscribeToPresenceGroup updated on initParameters"),apiCC.session.channel.updateSubscribeToPresenceGroupIsNeeded=!0,apiCC.session.channel.oldSubscribeToPresenceGroup===null&&(apiCC.session.channel.oldSubscribeToPresenceGroup=apiCC.session.subscribeToPresenceGroup),apiCC.session.channel.newSubscribeToPresenceGroup=["default"],apiCC.session.subscribeToPresenceGroup=["default"])),apiCC.initApiKey=$t.apiKey,apiCC.initApiCCId=$t.apiCCId}else Mr.error("Apikey format is not correct, leaving connection process")},s(8560),It.mediaDeviceMgr=new function(){this.audioDevicePresent=!0,this.videoDevicePresent=!0,this.audioOutputPresent=!0,this.mediaSourceInfos=null,this.mediaDeviceChangedDetected=!1,this.mediaDeviceSourceInfosArray={audioinput:{},audiooutput:{},videoinput:{}},this.mediaDeviceSourceInfosArrayBeforeGotSources=null,this.defaultVideoInput=null,this.defaultAudioInput=null,this.defaultAudioOuput=null,this.realMediaDevicesListInitialization=!1,this.realMediaDevicesListInitializationWasAlreadyDone=!1,_a.debug("MediaDeviceManager"),navigator.mediaDevices!==null&&navigator.mediaDevices!==void 0&&(navigator.mediaDevices.ondevicechange=function($t){_a.debug("Media device have changed"),apiCC.mediaDeviceMgr.getMediaDevices("updatedOnDeviceChange")}),this.gotSources=function($t,Lt){_a.debug("gotSources : sourceInfos :",$t),apiCC.mediaDeviceMgr.audioDevicePresent=!1,apiCC.mediaDeviceMgr.videoDevicePresent=!1,apiCC.mediaDeviceMgr.audioOutputPresent=!1;var Yt=!1;apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources=apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray;var kt={},jt=!1;(0,St.fS)(apiCC.mediaDeviceMgr.mediaSourceInfos,$t)||(_a.debug("MediaDevices change detected"),Yt=!0);var sn,ln=null,Kt=0,dt=0,gt=0,Nt=null;if(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray={audioinput:{},audiooutput:{},videoinput:{}},apiCC.mediaDeviceMgr.mediaSourceInfos=$t,$t!==null)for(sn=0;sn!==$t.length;++sn)(ln=$t[sn]).deviceId!==null&&ln.deviceId!==""?(Nt=new Ht(ln.deviceId,ln.kind),ln.label!==null&&ln.label!==void 0&&(this.realMediaDevicesListInitialization=!0)):(_a.debug("MediaDevices change but deviceId is not correct, using fakedeviceId :",sn),Nt=new Ht(sn,ln.kind)),ln.kind==="audio"||ln.kind==="audioinput"?(apiCC.mediaDeviceMgr.audioDevicePresent||(apiCC.mediaDeviceMgr.audioDevicePresent=!0),Nt.label=ln.label||"microphone "+ ++Kt,apiCC.mediaDeviceMgr.defaultAudioInput===null&&(apiCC.mediaDeviceMgr.defaultAudioInput=Nt),ln.getCapabilities!==null&&ln.getCapabilities!==void 0?Nt.capabilities=ln.getCapabilities():_a.debug("getCapabilities not defined")):ln.kind==="video"||ln.kind==="videoinput"?(apiCC.mediaDeviceMgr.videoDevicePresent||(apiCC.mediaDeviceMgr.videoDevicePresent=!0),Nt.label=ln.label||"camera "+ ++dt,apiCC.mediaDeviceMgr.defaultVideoInput===null&&(apiCC.mediaDeviceMgr.defaultVideoInput=Nt),ln.getCapabilities!==null&&ln.getCapabilities!==void 0?Nt.capabilities=ln.getCapabilities():_a.debug("getCapabilities not defined")):ln.kind==="audiooutput"?(apiCC.mediaDeviceMgr.audioOutputPresent||(apiCC.mediaDeviceMgr.audioOutputPresent=!0),Nt.label=ln.label||"audio output "+ ++gt,apiCC.mediaDeviceMgr.defaultAudioOuput===null&&(apiCC.mediaDeviceMgr.defaultAudioOuput=Nt)):(Nt.label=ln.label||"other source "+ln.deviceId,_a.trace("Detected some other kind of source : "+ln.kind)),_a.trace("Local device : "+Nt.label+" - "+Nt.id),apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray[Nt.type]===void 0&&(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray[Nt.type]={}),apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray[Nt.type][Nt.id]=Nt;else _a.warn("Media detection is not supported by browser, considering micro and camera present"),apiCC.mediaDeviceMgr.audioDevicePresent=!0,apiCC.mediaDeviceMgr.videoDevicePresent=!0,apiCC.mediaDeviceMgr.audioOutputPresent=!0;if(_a.log("Audio device detected :"+apiCC.mediaDeviceMgr.audioDevicePresent),_a.log("Video device detected :"+apiCC.mediaDeviceMgr.videoDevicePresent),_a.log("audio Output device detected :"+apiCC.mediaDeviceMgr.audioOutputPresent),_a.debug("mediaDeviceSourceInfosArray :",apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray),apiCC.mediaDeviceMgr.audioDevicePresent===!1?apiCC.mediaDeviceMgr.videoDevicePresent===!1?apiCC.myWebRTC_Event.createErrorEvent("Video device is not present","NO_AUDIO_NO_VIDEO_DEVICE"):apiCC.myWebRTC_Event.createErrorEvent("Audio device is not present","NO_AUDIO_DEVICE"):apiCC.mediaDeviceMgr.videoDevicePresent===!1&&apiCC.myWebRTC_Event.createErrorEvent("Video device is not present","NO_VIDEO_DEVICE"),(0,St.fS)(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray,apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources)||(_a.debug("mediaDeviceSourceInfosArray change detected"),Yt=!0),Yt===!0){_a.debug("fireMediaChangedEvent :",Yt);var Vt=this.getMediaDeviceListsDiff(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray,apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources);this.realMediaDevicesListInitialization===!0&&this.realMediaDevicesListInitializationWasAlreadyDone===!1&&(_a.debug("This is the first real initialization of media device list"),jt=!0),this.realMediaDevicesListInitialization===!0&&(this.realMediaDevicesListInitializationWasAlreadyDone=!0),this.mediaDeviceChangedDetected=!0,apiCC.myWebRTC_Event!==null&&apiCC.myWebRTC_Event.createMediaDeviceChangedEvent(Vt,Lt,jt),_a.debug("fireMediaChangedEvent :",apiCC.mediaDeviceMgr.mediaSourceInfos)}apiCC.session&&apiCC.session.apiCCWebRTCClient&&(apiCC.session.apiCCWebRTCClient.webRTCClient.setGumConfigWithDevicePresent(),kt.audioDevicePresent=apiCC.mediaDeviceMgr.audioDevicePresent,kt.videoDevicePresent=apiCC.mediaDeviceMgr.videoDevicePresent,apiCC.session.setUserData(kt))},this.getMediaDevices=function($t){_a.debug("MediaDeviceManager::getMediaDevices : updateReason :",$t),apiCC.browser==="IE"&&apiCC.browser_version>8?apiCC.getMediaDevicesWithCB(apiCC.mediaDeviceMgr.gotSources):apiCC.getMediaDevices().then(function(Lt){apiCC.mediaDeviceMgr.gotSources(Lt,$t)}).catch(function(){_a.log("Error on MediaDeviceManager::getMediaDevices"),apiCC.mediaDeviceMgr.gotSources(null,$t)})},this.getMediaDeviceListsDiff=function($t,Lt){Lt!==void 0&&Lt||(Lt={}),$t!==void 0&&$t||($t={});for(var Yt=[],kt=[],jt=[],sn=0,ln=Object.keys(Lt);sn<ln.length;sn++){var Kt=ln[sn];if($t[Kt]===void 0)kt[Kt]=Lt[Kt];else for(var dt=0,gt=Object.keys(Lt[Kt]);dt<gt.length;dt++){var Nt=gt[dt];$t[Kt][Nt]===void 0&&(kt[Kt]===void 0&&(kt[Kt]={}),kt[Kt][Nt]=Lt[Kt][Nt])}}for(var Vt=0,zt=Object.keys($t);Vt<zt.length;Vt++)for(var Xt=zt[Vt],Zt=0,on=Object.keys($t[Xt]);Zt<on.length;Zt++){var bn=on[Zt];Lt[Xt]!==void 0&&Lt[Xt][bn]!==void 0||(Yt[Xt]===void 0&&(Yt[Xt]={}),Yt[Xt][bn]=$t[Xt][bn]),Lt[Xt]!==void 0&&Lt[Xt][bn]!==void 0&&$t[Xt][bn].label!==Lt[Xt][bn].label&&(jt[Xt]===void 0&&(jt[Xt]={}),jt[Xt][bn]=$t[Xt][bn])}return{added:Object.keys(Yt).length>0?Yt:null,removed:Object.keys(kt).length>0?kt:null,updated:Object.keys(jt).length>0?jt:null}}},It.mediaDeviceMgr.getMediaDevices(),It.webRTCCompliant=It.isWebRTCCompliant(),It.qoSStatCompliant=It.isQoSStatCompliant(),It.screenSharingCompliant=It.isScreenSharingCompliant());const wm=apiRTC},1549:(it,ut,s)=>{s.d(ut,{Y:()=>mt}),s(6992),s(1532),s(1539),s(8783),s(3948),s(2772),s(4916),s(5306),s(2222),s(5268),s(3710),s(3161),s(9653),s(9070),s(9753),s(2526),s(1817),s(2165),s(1038),s(7042),s(8309);var et=s(3173);function ot(rt){return function(pt){if(Array.isArray(pt))return st(pt)}(rt)||function(pt){if(typeof Symbol<"u"&&pt[Symbol.iterator]!=null||pt["@@iterator"]!=null)return Array.from(pt)}(rt)||function(pt,ft){if(pt){if(typeof pt=="string")return st(pt,ft);var St=Object.prototype.toString.call(pt).slice(8,-1);return St==="Object"&&pt.constructor&&(St=pt.constructor.name),St==="Map"||St==="Set"?Array.from(pt):St==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(St)?st(pt,ft):void 0}}(rt)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function st(rt,pt){(pt==null||pt>rt.length)&&(pt=rt.length);for(var ft=0,St=new Array(pt);ft<pt;ft++)St[ft]=rt[ft];return St}function Rt(rt,pt){for(var ft=0;ft<pt.length;ft++){var St=pt[ft];St.enumerable=St.enumerable||!1,St.configurable=!0,"value"in St&&(St.writable=!0),Object.defineProperty(rt,St.key,St)}}var ht=new Map,bt=et.g.LOG_LEVEL_WARN,ct=function(rt){var pt,ft=null,St=null;for(pt=0;pt<rt.length;pt++)typeof rt[pt]=="string"&&(rt[pt].indexOf('"type":"invite"')!==-1?rt[pt].indexOf("candidate")===-1?rt[pt].indexOf("S->C:")===-1?rt[pt]="invite C->S: without candidate":rt[pt]="invite S->C: without candidate":rt[pt].indexOf("S->C:")===-1?rt[pt]="invite C->S: with candidate":rt[pt]="invite S->C: with candidate":rt[pt].indexOf('"type":"200OK"')!==-1?rt[pt].indexOf("candidate")===-1?rt[pt].indexOf("S->C:")===-1?rt[pt]="200OK C->S: without candidate":rt[pt]="200OK S->C: without candidate":rt[pt].indexOf("S->C:")===-1?rt[pt]="200OK C->S: with candidate":rt[pt]="200OK S->C: with candidate":rt[pt].indexOf('"type":"candidate"')!==-1&&(rt[pt].indexOf("S->C:")===-1?(ft=rt[pt].replace(/C->S: /g,""),St=JSON.parse(ft),rt[pt]="candidate C->S:"+St.candidate):(ft=rt[pt].replace(/onChannelMessage S->C: /g,""),St=JSON.parse(ft),rt[pt]="candidate S->C:"+St.candidate)));return rt},mt=function(){function rt(It){if(function(xt,At){if(!(xt instanceof At))throw new TypeError("Cannot call a class as a function")}(this,rt),ht.has(It))throw new Error("Cannot construct singleton Logger");this.category=It,ht.set(It,this)}var pt,ft,St;return pt=rt,ft=[{key:"trace",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_TRACE].concat(xt))}},{key:"log",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_DEBUG].concat(xt))}},{key:"debug",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_DEBUG].concat(xt))}},{key:"info",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_INFO].concat(xt))}},{key:"warn",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_WARN].concat(xt))}},{key:"error",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[et.g.LOG_LEVEL_ERROR].concat(xt))}},{key:"logMessage",value:function(It){for(var xt=arguments.length,At=new Array(xt>1?xt-1:0),Dt=1;Dt<xt;Dt++)At[Dt-1]=arguments[Dt];if(console!=null){if(It<=bt){var wt="[".concat(new Date().toISOString(),"]");switch(It in et.g.LOG_LEVEL_LABELS&&(wt+="[".concat(et.g.LOG_LEVEL_LABELS[It],"]")),wt+=et.g.LOG_PREFIX+"(".concat(this.category,")"),It){case et.g.LOG_LEVEL_ERROR:var Mt;console.error&&(Mt=console).error.apply(Mt,[wt].concat(ot(At)));break;case et.g.LOG_LEVEL_WARN:var vt;console.warn&&(vt=console).warn.apply(vt,[wt].concat(ot(At)));break;case et.g.LOG_LEVEL_INFO:var Ft;console.info&&(Ft=console).info.apply(Ft,[wt].concat(ot(At)));break;default:var Ht;console.log&&(Ht=console).log.apply(Ht,[wt].concat(ot(At)))}}typeof apiCC<"u"&&apiCC.logStorageActivated&&It<=apiCC.logStorageLevel&&(At=ct(At),apiCC.logStorage.push(JSON.stringify({name:"log",args:{0:"(".concat(this.category,")")+":"+At}})))}}}],St=[{key:"get",value:function(It){return ht.has(It)?ht.get(It):new rt(It)}},{key:"setLogLevel",value:function(It){if(!Number.isInteger(It)||It<0)throw"Log level invalid";bt=It}},{key:"getLogLevel",value:function(){return bt}}],ft&&Rt(pt.prototype,ft),St&&Rt(pt,St),Object.defineProperty(pt,"prototype",{writable:!1}),rt}()},3173:(it,ut,s)=>{s.d(ut,{g:()=>et}),s(2526),s(1817),s(1539);var et={LOG_PREFIX:"apiRTC",LOG_LEVEL_OFF:0,LOG_LEVEL_ERROR:1,LOG_LEVEL_WARN:2,LOG_LEVEL_INFO:3,LOG_LEVEL_DEBUG:4,LOG_LEVEL_TRACE:5,LOG_LEVEL_LABELS:{}};et.LOG_LEVEL_LABELS[et.LOG_LEVEL_ERROR]="ERROR",et.LOG_LEVEL_LABELS[et.LOG_LEVEL_WARN]="WARN",et.LOG_LEVEL_LABELS[et.LOG_LEVEL_INFO]="INFO",et.LOG_LEVEL_LABELS[et.LOG_LEVEL_DEBUG]="DEBUG",et.LOG_LEVEL_LABELS[et.LOG_LEVEL_TRACE]="TRACE",et.ERROR_OTHER=0,et.ERROR_INVALID_CREDENTIALS=1,et.ERROR_NETWORK_UNAVAILABLE=2,et.ERROR_SERVER_UNAVAILABLE=3,et.ERROR_UNAUTHORIZED=4,et.ERROR_APIRTC_INITIALISATION_FAILED=5,et.ERROR_APIRTC_SESSION_ALREADY_ON=6,et.ERROR_REGISTRATION_URI_INVALID=7,et.ERROR_NOT_FOUND=8,et.ERROR_BAD_PARAMETER=9,et.ERROR_INVITATION_STATE_INVALID=10,et.ERROR_TIMED_OUT=11,et.ERROR_STREAM_RECORD=12,et.ERROR_HTTP=13,et.ERROR_NOT_ALLOWED=14,et.ERROR_OPERATION_CANCELED=15,et.ERROR_WRONG_STATE=16,et.MEDIA_TYPE_PHOTO=0,et.MEDIA_TYPE_VIDEO=1,et.MEDIA_TYPE_AUDIO=2,et.MEDIA_TYPE_DOC=3,et.CONTACT_SEND_DATA_IDENTIFIER="contact_data",et.CONTACT_NEW_MEDIA_IDENTIFIER="contact_new_media",et.CONTACT_SEND_FILEINFO_IDENTIFIER="contact_file_info",et.CONTACT_DATACHANNEL_INVITATION="contact_datachannel_invitation",et.CONTACT_EVENTCENTER_DATA_REQUEST="contact_event_center_data_request",et.CONTACT_EVENTCENTER_DATA_ANSWER="contact_event_center_data_answer",et.CONTACT_GET_CAPABILITIES_IDENTIFIER="contact_get_capabilities",et.CONTACT_GET_CAPABILITIES_RESULT_IDENTIFIER="contact_get_capabilities_result",et.CONTACT_GET_SETTINGS_IDENTIFIER="contact_get_settings",et.CONTACT_GET_SETTINGS_RESULT_IDENTIFIER="contact_get_settings_result",et.CONTACT_GET_CONSTRAINTS_IDENTIFIER="contact_get_constraints",et.CONTACT_GET_CONSTRAINTS_RESULT_IDENTIFIER="contact_get_constraints_result",et.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER="contact_changed_constraints",et.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_IDENTIFIER="contact_get_remote_audio_flow_status",et.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_IDENTIFIER="contact_get_remote_video_flow_status",et.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_RESULT_IDENTIFIER="contact_get_remote_audio_flow_status_result",et.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_RESULT_IDENTIFIER="contact_get_remote_video_flow_status_result",et.CONTACT_GET_REMOTE_ERROR="contact_get_remote_error",et.CONTACT_APPLY_CONSTRAINTS_IDENTIFIER="contact_apply_constraints_identifier",et.CONTACT_APPLY_CONSTRAINTS_RESULT_IDENTIFIER="contact_apply_constraints_result_identifier",et.CONTACT_DISABLE_AUDIO_REQUEST="contact_disable_audio_request",et.CONTACT_DISABLE_AUDIO_ANSWER="contact_disable_audio_answer",et.CONTACT_ENABLE_AUDIO_REQUEST="contact_enable_audio_request",et.CONTACT_ENABLE_AUDIO_ANSWER="contact_enable_audio_answer",et.CONTACT_DISABLE_VIDEO_REQUEST="contact_disable_video_request",et.CONTACT_DISABLE_VIDEO_ANSWER="contact_disable_video_answer",et.CONTACT_ENABLE_VIDEO_REQUEST="contact_enable_video_request",et.CONTACT_ENABLE_VIDEO_ANSWER="contact_enable_video_answer",et.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER="contact_remote_access_invite",et.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER="contact_remote_access_answer",et.CONTACT_REMOTEACCESS_STOP_IDENTIFIER="contact_remote_access_stop",et.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE="contact_remote_access_app_status_message",et.CONTACT_REMOTEACCESS_APP_MESSAGE="contact_remote_access_app_message",et.CONVERSATION_ACCESS_GRANTED="GRANTED",et.CONVERSATION_NEED_MODERATOR_ACCEPTATION="NEED_MODERATOR_ACCEPTATION",et.CONVERSATION_ROLE_MODERATOR="moderator",et.CONVERSATION_ROLE_CONTRIBUTOR="contributor",et.CONVERSATION_ROLE_GUEST="guest",et.CONVERSATION_WAITING_ROOM_PREFIX="waiting-room-",et.CONVERSATION_SEND_DATA_IDENTIFIER="conv_data",et.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER="conv_persistent_data_update",et.CONVERSATION_JOIN_REQUEST_IDENTIFIER="conv_join_req",et.CONVERSATION_JOIN_ANSWER_IDENTIFIER="conv_join_ans",et.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER="conv_moderator_connected",et.CONVERSATION_NEW_MEDIA_IDENTIFIER="conv_new_media",et.CONVERSATION_CLOSED_IDENTIFIER="conv_closed",et.CONVERSATION_INVITATION_IDENTIFIER="conv_invite",et.INVITATION_ANSWER_IDENTIFIER="invite_ans",et.RECORD_BASE_URL="https://data2.apizee.com:10000/videoManager",et.RECORD_PLAY_URL=et.RECORD_BASE_URL+"?action=play&recordedFileName=",et.DEFAULT_MCU="mcu4.apizee.com",et.DEFAULT_TURNADDRESS="mp1.apizee.com",et.CALL_STATUS_WAITING_FOR_CALLEE=Symbol("CALL_STATUS_WAITING_FOR_CALLEE"),et.CALL_STATUS_ONGOING=Symbol("CALL_STATUS_ONGOING"),et.CALL_STATUS_ENDED=Symbol("CALL_STATUS_ENDED"),et.DATACHANNEL_STATUS_WAITING=Symbol("DATACHANNEL_STATUS_WAITING"),et.DATACHANNEL_STATUS_ONGOING=Symbol("DATACHANNEL_STATUS_ONGOING"),et.DATACHANNEL_STATUS_ENDED=Symbol("DATACHANNEL_STATUS_ENDED"),et.DATACHANNEL_TYPE_RECEIVE=Symbol("DATACHANNEL_TYPE_RECEIVE"),et.DATACHANNEL_TYPE_SEND=Symbol("DATACHANNEL_TYPE_SEND"),et.CONVERSATION_STATUS_JOINED=Symbol("CONVERSATION_STATUS_JOINED"),et.CONVERSATION_STATUS_NOT_JOINED=Symbol("CONVERSATION_STATUS_NOT_JOINED"),et.CONVERSATION_STATUS_WAITING=Symbol("CONVERSATION_STATUS_WAITING"),et.CONVERSATION_STATUS_JOINING=Symbol("CONVERSATION_STATUS_JOINING"),et.CONVERSATION_WHITEBOARD_STARTED=Symbol("CONVERSATION_WHITEBOARD_STARTED"),et.CONVERSATION_WHITEBOARD_NOT_STARTED=Symbol("CONVERSATION_WHITEBOARD_NOT_STARTED"),et.STATE_IDLE=Symbol("STATE_IDLE"),et.STATE_JOINING=Symbol("STATE_JOINING"),et.STATE_ACTIVE=Symbol("STATE_ACTIVE"),et.STATE_LEAVING=Symbol("STATE_LEAVING"),et.INVITATION_STATUS_ACCEPTED=Symbol("INVITATION_STATUS_ACCEPTED"),et.INVITATION_STATUS_DECLINED=Symbol("INVITATION_STATUS_DECLINED"),et.INVITATION_STATUS_STANDBY=Symbol("INVITATION_STATUS_STANDBY"),et.INVITATION_STATUS_EXPIRED=Symbol("INVITATION_STATUS_EXPIRED"),et.INVITATION_STATUS_CANCELLED=Symbol("INVITATION_STATUS_CANCELLED"),et.INVITATION_STATUS_ENDED=Symbol("INVITATION_STATUS_ENDED"),et.STREAM_TYPE_NO_INPUT="no_input",et.STREAM_TYPE_AUDIO="audio",et.STREAM_TYPE_VIDEO="video",et.STREAM_AUDIO_ANALYSIS_THRESHOLD=100,et.STREAM_AUDIO_NOISE_REDUCTION_VAI={soft:.7,medium:.8,hard:.9},et.CONTACT_DISCONNECTION_DELAY=1e4,et.CONVERSATION_JOIN_REQUEST_INTERVAL=5e3,et.APIRTC_MEDIA_DEVICE_DETECTION_DELAY=1e4,et.CONVERSATION_GROUP_CHAT_MEMBER_UPDATE_DELAY=5e3,et.CONVERSATION_WHITEBOARD_START_DELAY=5e3,et.CONVERSATION_RECORDING_STARTED_DELAY=1e4,et.CONVERSATION_RECORDING_STOPPED_DELAY=5e3,et.CONVERSATION_STREAMING_STARTED_DELAY=1e4,et.CONVERSATION_STREAMING_STOPPED_DELAY=1e4,et.CONVERSATION_PARTICIPANT_EJECTION_DELAY=5e3,et.JOIN_WAITING_ROOM_PRESENCE_GROUP_TIMEOUT=3e3},1215:(it,ut,s)=>{function et(ht){return et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(bt){return typeof bt}:function(bt){return bt&&typeof Symbol=="function"&&bt.constructor===Symbol&&bt!==Symbol.prototype?"symbol":typeof bt},et(ht)}function ot(ht,bt){return arguments.length===3?st(arguments[0],arguments[1],arguments[2]):bt==="null"?ht===null:bt==="array"?ht!==null&&et(ht)==="object"&&Array.isArray(ht):ht!==null&&et(ht)===bt}function st(ht,bt,ct){if(bt!==null&&et(bt)==="object"&&Array.isArray(bt)&&bt.length>=1){var mt=bt[0];if(bt.length>1)return ot(ht,"object")&&ot(mt,"string")&&ht.hasOwnProperty(mt)&&ot(ht[mt],"object")&&st(ht[mt],bt.slice(1),ct);bt=mt}return ct==="undefined"?ot(ht,"object")&&ot(bt,"string")&&!ht.hasOwnProperty(bt)&&ot(ht[bt],ct):ot(ht,"object")&&ot(bt,"string")&&ht.hasOwnProperty(bt)&&ot(ht[bt],ct)}s.d(ut,{g:()=>Rt}),s(4916),s(5306),s(3710),s(1539),s(9714),s(7941),s(9575),s(6716),s(9554),s(6992),s(1532),s(8783),s(3948),s(9753),s(7042),s(3843),s(2564),s(2526),s(1817),s(2165);var Rt={assignObject:function(ht,bt){var ct,mt,rt;for(ht==null&&(ht={}),ct=1;ct<arguments.length;ct+=1)for(mt in rt=arguments[ct])rt.hasOwnProperty(mt)&&(ht[mt]=rt[mt]);return ht},throttle:function(ht,bt){var ct,mt,rt,pt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ft=null,St=0,It=function(){St=pt.leading===!1?0:Date.now(),ft=null,rt=ht.apply(ct,mt),ft||(ct=mt=null)};return function(){var xt=Date.now();St||pt.leading!==!1||(St=xt);var At=bt-(xt-St);return ct=this,mt=arguments,At<=0||At>bt?(ft&&(clearTimeout(ft),ft=null),St=xt,rt=ht.apply(ct,mt),ft||(ct=mt=null)):ft||pt.trailing===!1||(ft=setTimeout(It,At)),rt}},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(ht){var bt=16*Math.random()|0;return(ht==="x"?bt:3&bt|8).toString(16)})},hashString:function(ht){for(var bt=0,ct=0,mt=ht.length;ct<mt;)bt=(bt<<5)-bt+ht.charCodeAt(ct++)<<0;return Math.abs(bt)},arrayBuffertoString:function(ht){var bt=new DataView(ht);return new TextDecoder("utf-8").decode(bt)},getAudioContext:function(){return apiRTC.audioProcessor.getOrCreateAudioContext()},parseRecordingEvent:function(ht,bt){var ct=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return["roomName","callId","recordType","convId","mediaId","mediaURL","recordedFileName"].forEach(function(mt){bt.hasOwnProperty(mt)&&(ct[mt]=String(bt[mt]))}),bt.mediaType==="AUDIO-ONLY"?(ct.audioOnly=!0,ct.videoOnly=!1):bt.mediaType==="VIDEO-ONLY"?(ct.audioOnly=!1,ct.videoOnly=!0):(ct.audioOnly=!1,ct.videoOnly=!1),ct.recordType==="composite"&&(bt.hasOwnProperty("mode")?ct.mode=bt.mode:ct.mode="complete",bt.hasOwnProperty("labelEnabled")?(ct.labelEnabled=bt.labelEnabled===!0,ct.labelEnabled===!0&&bt.hasOwnProperty("labels")&&(ct.labels=bt.labels)):ct.labelEnabled=!1),ct},paramsToQueryString:function(ht){for(var bt="",ct=0,mt=Object.keys(ht);ct<mt.length;ct++){var rt=mt[ct];bt+=bt===""?"?":"&",ht[rt]===null||ht[rt]===void 0?console.warn("apiRTC Utils - paramsToQueryString : "+rt+" is undefined!"):bt+=rt+"="+ht[rt].toString()}return bt},createError:function(ht,bt,ct){var mt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};ct&&ct.error(bt);var rt={code:ht};return bt instanceof String?rt.error=new Error(bt):bt instanceof Error?rt.error=bt:rt.error=new Error(String(bt)),ot(mt,"object")&&(mt.hasOwnProperty("fromError")&&(rt.fromError=mt.fromError),mt.hasOwnProperty("httpCode")&&(rt.httpCode=mt.httpCode)),rt},isSet:function(ht){return ht!=null},isTypeof:ot,isPropertyTypeof:st,_private:{dataCallsOnHold:new Map,dataChannelInvitations:new Map,dataCallsFileInfo:new Map}}},9662:(it,ut,s)=>{var et=s(614),ot=s(6330),st=TypeError;it.exports=function(Rt){if(et(Rt))return Rt;throw st(ot(Rt)+" is not a function")}},9483:(it,ut,s)=>{var et=s(4411),ot=s(6330),st=TypeError;it.exports=function(Rt){if(et(Rt))return Rt;throw st(ot(Rt)+" is not a constructor")}},6077:(it,ut,s)=>{var et=s(614),ot=String,st=TypeError;it.exports=function(Rt){if(typeof Rt=="object"||et(Rt))return Rt;throw st("Can't set "+ot(Rt)+" as a prototype")}},1223:(it,ut,s)=>{var et=s(5112),ot=s(30),st=s(3070).f,Rt=et("unscopables"),ht=Array.prototype;ht[Rt]==null&&st(ht,Rt,{configurable:!0,value:ot(null)}),it.exports=function(bt){ht[Rt][bt]=!0}},1530:(it,ut,s)=>{var et=s(8710).charAt;it.exports=function(ot,st,Rt){return st+(Rt?et(ot,st).length:1)}},5787:(it,ut,s)=>{var et=s(7976),ot=TypeError;it.exports=function(st,Rt){if(et(Rt,st))return st;throw ot("Incorrect invocation")}},9670:(it,ut,s)=>{var et=s(111),ot=String,st=TypeError;it.exports=function(Rt){if(et(Rt))return Rt;throw st(ot(Rt)+" is not an object")}},4019:it=>{it.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},7556:(it,ut,s)=>{var et=s(7293);it.exports=et(function(){if(typeof ArrayBuffer=="function"){var ot=new ArrayBuffer(8);Object.isExtensible(ot)&&Object.defineProperty(ot,"a",{value:8})}})},260:(it,ut,s)=>{var et,ot,st,Rt=s(4019),ht=s(9781),bt=s(7854),ct=s(614),mt=s(111),rt=s(2597),pt=s(648),ft=s(6330),St=s(8880),It=s(8052),xt=s(3070).f,At=s(7976),Dt=s(9518),wt=s(7674),Mt=s(5112),vt=s(9711),Ft=s(9909),Ht=Ft.enforce,Wt=Ft.get,tn=bt.Int8Array,gn=tn&&tn.prototype,nn=bt.Uint8ClampedArray,qt=nn&&nn.prototype,fn=tn&&Dt(tn),Cn=gn&&Dt(gn),Tn=Object.prototype,un=bt.TypeError,mn=Mt("toStringTag"),yn=vt("TYPED_ARRAY_TAG"),pn=Rt&&!!wt&&pt(bt.opera)!=="Opera",In=!1,kn={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Mn={BigInt64Array:8,BigUint64Array:8},xn=function(On){var Dn=Dt(On);if(mt(Dn)){var Fn=Wt(Dn);return Fn&&rt(Fn,"TypedArrayConstructor")?Fn.TypedArrayConstructor:xn(Dn)}},Pn=function(On){if(!mt(On))return!1;var Dn=pt(On);return rt(kn,Dn)||rt(Mn,Dn)};for(et in kn)(st=(ot=bt[et])&&ot.prototype)?Ht(st).TypedArrayConstructor=ot:pn=!1;for(et in Mn)(st=(ot=bt[et])&&ot.prototype)&&(Ht(st).TypedArrayConstructor=ot);if((!pn||!ct(fn)||fn===Function.prototype)&&(fn=function(){throw un("Incorrect invocation")},pn))for(et in kn)bt[et]&&wt(bt[et],fn);if((!pn||!Cn||Cn===Tn)&&(Cn=fn.prototype,pn))for(et in kn)bt[et]&&wt(bt[et].prototype,Cn);if(pn&&Dt(qt)!==Cn&&wt(qt,Cn),ht&&!rt(Cn,mn))for(et in In=!0,xt(Cn,mn,{get:function(){return mt(this)?this[yn]:void 0}}),kn)bt[et]&&St(bt[et],yn,et);it.exports={NATIVE_ARRAY_BUFFER_VIEWS:pn,TYPED_ARRAY_TAG:In&&yn,aTypedArray:function(On){if(Pn(On))return On;throw un("Target is not a typed array")},aTypedArrayConstructor:function(On){if(ct(On)&&(!wt||At(fn,On)))return On;throw un(ft(On)+" is not a typed array constructor")},exportTypedArrayMethod:function(On,Dn,Fn,dr){if(ht){if(Fn)for(var ir in kn){var Xn=bt[ir];if(Xn&&rt(Xn.prototype,On))try{delete Xn.prototype[On]}catch{try{Xn.prototype[On]=Dn}catch{}}}Cn[On]&&!Fn||It(Cn,On,Fn?Dn:pn&&gn[On]||Dn,dr)}},exportTypedArrayStaticMethod:function(On,Dn,Fn){var dr,ir;if(ht){if(wt){if(Fn){for(dr in kn)if((ir=bt[dr])&&rt(ir,On))try{delete ir[On]}catch{}}if(fn[On]&&!Fn)return;try{return It(fn,On,Fn?Dn:pn&&fn[On]||Dn)}catch{}}for(dr in kn)!(ir=bt[dr])||ir[On]&&!Fn||It(ir,On,Dn)}},getTypedArrayConstructor:xn,isView:function(On){if(!mt(On))return!1;var Dn=pt(On);return Dn==="DataView"||rt(kn,Dn)||rt(Mn,Dn)},isTypedArray:Pn,TypedArray:fn,TypedArrayPrototype:Cn}},3331:(it,ut,s)=>{var et=s(7854),ot=s(1702),st=s(9781),Rt=s(4019),ht=s(6530),bt=s(8880),ct=s(9190),mt=s(7293),rt=s(5787),pt=s(9303),ft=s(7466),St=s(7067),It=s(1179),xt=s(9518),At=s(7674),Dt=s(8006).f,wt=s(3070).f,Mt=s(1285),vt=s(1589),Ft=s(8003),Ht=s(9909),Wt=ht.PROPER,tn=ht.CONFIGURABLE,gn=Ht.get,nn=Ht.set,qt="ArrayBuffer",fn="Wrong index",Cn=et.ArrayBuffer,Tn=Cn,un=Tn&&Tn.prototype,mn=et.DataView,yn=mn&&mn.prototype,pn=Object.prototype,In=et.Array,kn=et.RangeError,Mn=ot(Mt),xn=ot([].reverse),Pn=It.pack,On=It.unpack,Dn=function(vn){return[255&vn]},Fn=function(vn){return[255&vn,vn>>8&255]},dr=function(vn){return[255&vn,vn>>8&255,vn>>16&255,vn>>24&255]},ir=function(vn){return vn[3]<<24|vn[2]<<16|vn[1]<<8|vn[0]},Xn=function(vn){return Pn(vn,23,4)},tr=function(vn){return Pn(vn,52,8)},cn=function(vn,Rn){wt(vn.prototype,Rn,{get:function(){return gn(this)[Rn]}})},Jn=function(vn,Rn,Gt,Tt){var nt=St(Gt),Ct=gn(vn);if(nt+Rn>Ct.byteLength)throw kn(fn);var yt=gn(Ct.buffer).bytes,Pt=nt+Ct.byteOffset,Et=vt(yt,Pt,Pt+Rn);return Tt?Et:xn(Et)},Qn=function(vn,Rn,Gt,Tt,nt,Ct){var yt=St(Gt),Pt=gn(vn);if(yt+Rn>Pt.byteLength)throw kn(fn);for(var Et=gn(Pt.buffer).bytes,Ut=yt+Pt.byteOffset,Ot=Tt(+nt),Bt=0;Bt<Rn;Bt++)Et[Ut+Bt]=Ot[Ct?Bt:Rn-Bt-1]};if(Rt){var sr=Wt&&Cn.name!==qt;if(mt(function(){Cn(1)})&&mt(function(){new Cn(-1)})&&!mt(function(){return new Cn,new Cn(1.5),new Cn(NaN),sr&&!tn}))sr&&tn&&bt(Cn,"name",qt);else{(Tn=function(vn){return rt(this,un),new Cn(St(vn))}).prototype=un;for(var Bn,rr=Dt(Cn),nr=0;rr.length>nr;)(Bn=rr[nr++])in Tn||bt(Tn,Bn,Cn[Bn]);un.constructor=Tn}At&&xt(yn)!==pn&&At(yn,pn);var Nn=new mn(new Tn(2)),Wn=ot(yn.setInt8);Nn.setInt8(0,2147483648),Nn.setInt8(1,2147483649),!Nn.getInt8(0)&&Nn.getInt8(1)||ct(yn,{setInt8:function(vn,Rn){Wn(this,vn,Rn<<24>>24)},setUint8:function(vn,Rn){Wn(this,vn,Rn<<24>>24)}},{unsafe:!0})}else un=(Tn=function(vn){rt(this,un);var Rn=St(vn);nn(this,{bytes:Mn(In(Rn),0),byteLength:Rn}),st||(this.byteLength=Rn)}).prototype,yn=(mn=function(vn,Rn,Gt){rt(this,yn),rt(vn,un);var Tt=gn(vn).byteLength,nt=pt(Rn);if(nt<0||nt>Tt)throw kn("Wrong offset");if(nt+(Gt=Gt===void 0?Tt-nt:ft(Gt))>Tt)throw kn("Wrong length");nn(this,{buffer:vn,byteLength:Gt,byteOffset:nt}),st||(this.buffer=vn,this.byteLength=Gt,this.byteOffset=nt)}).prototype,st&&(cn(Tn,"byteLength"),cn(mn,"buffer"),cn(mn,"byteLength"),cn(mn,"byteOffset")),ct(yn,{getInt8:function(vn){return Jn(this,1,vn)[0]<<24>>24},getUint8:function(vn){return Jn(this,1,vn)[0]},getInt16:function(vn){var Rn=Jn(this,2,vn,arguments.length>1?arguments[1]:void 0);return(Rn[1]<<8|Rn[0])<<16>>16},getUint16:function(vn){var Rn=Jn(this,2,vn,arguments.length>1?arguments[1]:void 0);return Rn[1]<<8|Rn[0]},getInt32:function(vn){return ir(Jn(this,4,vn,arguments.length>1?arguments[1]:void 0))},getUint32:function(vn){return ir(Jn(this,4,vn,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(vn){return On(Jn(this,4,vn,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(vn){return On(Jn(this,8,vn,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(vn,Rn){Qn(this,1,vn,Dn,Rn)},setUint8:function(vn,Rn){Qn(this,1,vn,Dn,Rn)},setInt16:function(vn,Rn){Qn(this,2,vn,Fn,Rn,arguments.length>2?arguments[2]:void 0)},setUint16:function(vn,Rn){Qn(this,2,vn,Fn,Rn,arguments.length>2?arguments[2]:void 0)},setInt32:function(vn,Rn){Qn(this,4,vn,dr,Rn,arguments.length>2?arguments[2]:void 0)},setUint32:function(vn,Rn){Qn(this,4,vn,dr,Rn,arguments.length>2?arguments[2]:void 0)},setFloat32:function(vn,Rn){Qn(this,4,vn,Xn,Rn,arguments.length>2?arguments[2]:void 0)},setFloat64:function(vn,Rn){Qn(this,8,vn,tr,Rn,arguments.length>2?arguments[2]:void 0)}});Ft(Tn,qt),Ft(mn,"DataView"),it.exports={ArrayBuffer:Tn,DataView:mn}},1048:(it,ut,s)=>{var et=s(7908),ot=s(1400),st=s(6244),Rt=s(5117),ht=Math.min;it.exports=[].copyWithin||function(bt,ct){var mt=et(this),rt=st(mt),pt=ot(bt,rt),ft=ot(ct,rt),St=arguments.length>2?arguments[2]:void 0,It=ht((St===void 0?rt:ot(St,rt))-ft,rt-pt),xt=1;for(ft<pt&&pt<ft+It&&(xt=-1,ft+=It-1,pt+=It-1);It-- >0;)ft in mt?mt[pt]=mt[ft]:Rt(mt,pt),pt+=xt,ft+=xt;return mt}},1285:(it,ut,s)=>{var et=s(7908),ot=s(1400),st=s(6244);it.exports=function(Rt){for(var ht=et(this),bt=st(ht),ct=arguments.length,mt=ot(ct>1?arguments[1]:void 0,bt),rt=ct>2?arguments[2]:void 0,pt=rt===void 0?bt:ot(rt,bt);pt>mt;)ht[mt++]=Rt;return ht}},8533:(it,ut,s)=>{var et=s(2092).forEach,ot=s(9341)("forEach");it.exports=ot?[].forEach:function(st){return et(this,st,arguments.length>1?arguments[1]:void 0)}},7745:(it,ut,s)=>{var et=s(6244);it.exports=function(ot,st){for(var Rt=0,ht=et(st),bt=new ot(ht);ht>Rt;)bt[Rt]=st[Rt++];return bt}},8457:(it,ut,s)=>{var et=s(9974),ot=s(6916),st=s(7908),Rt=s(3411),ht=s(7659),bt=s(4411),ct=s(6244),mt=s(6135),rt=s(8554),pt=s(1246),ft=Array;it.exports=function(St){var It=st(St),xt=bt(this),At=arguments.length,Dt=At>1?arguments[1]:void 0,wt=Dt!==void 0;wt&&(Dt=et(Dt,At>2?arguments[2]:void 0));var Mt,vt,Ft,Ht,Wt,tn,gn=pt(It),nn=0;if(!gn||this===ft&&ht(gn))for(Mt=ct(It),vt=xt?new this(Mt):ft(Mt);Mt>nn;nn++)tn=wt?Dt(It[nn],nn):It[nn],mt(vt,nn,tn);else for(Wt=(Ht=rt(It,gn)).next,vt=xt?new this:[];!(Ft=ot(Wt,Ht)).done;nn++)tn=wt?Rt(Ht,Dt,[Ft.value,nn],!0):Ft.value,mt(vt,nn,tn);return vt.length=nn,vt}},1318:(it,ut,s)=>{var et=s(5656),ot=s(1400),st=s(6244),Rt=function(ht){return function(bt,ct,mt){var rt,pt=et(bt),ft=st(pt),St=ot(mt,ft);if(ht&&ct!=ct){for(;ft>St;)if((rt=pt[St++])!=rt)return!0}else for(;ft>St;St++)if((ht||St in pt)&&pt[St]===ct)return ht||St||0;return!ht&&-1}};it.exports={includes:Rt(!0),indexOf:Rt(!1)}},2092:(it,ut,s)=>{var et=s(9974),ot=s(1702),st=s(8361),Rt=s(7908),ht=s(6244),bt=s(5417),ct=ot([].push),mt=function(rt){var pt=rt==1,ft=rt==2,St=rt==3,It=rt==4,xt=rt==6,At=rt==7,Dt=rt==5||xt;return function(wt,Mt,vt,Ft){for(var Ht,Wt,tn=Rt(wt),gn=st(tn),nn=et(Mt,vt),qt=ht(gn),fn=0,Cn=Ft||bt,Tn=pt?Cn(wt,qt):ft||At?Cn(wt,0):void 0;qt>fn;fn++)if((Dt||fn in gn)&&(Wt=nn(Ht=gn[fn],fn,tn),rt))if(pt)Tn[fn]=Wt;else if(Wt)switch(rt){case 3:return!0;case 5:return Ht;case 6:return fn;case 2:ct(Tn,Ht)}else switch(rt){case 4:return!1;case 7:ct(Tn,Ht)}return xt?-1:St||It?It:Tn}};it.exports={forEach:mt(0),map:mt(1),filter:mt(2),some:mt(3),every:mt(4),find:mt(5),findIndex:mt(6),filterReject:mt(7)}},6583:(it,ut,s)=>{var et=s(2104),ot=s(5656),st=s(9303),Rt=s(6244),ht=s(9341),bt=Math.min,ct=[].lastIndexOf,mt=!!ct&&1/[1].lastIndexOf(1,-0)<0,rt=ht("lastIndexOf"),pt=mt||!rt;it.exports=pt?function(ft){if(mt)return et(ct,this,arguments)||0;var St=ot(this),It=Rt(St),xt=It-1;for(arguments.length>1&&(xt=bt(xt,st(arguments[1]))),xt<0&&(xt=It+xt);xt>=0;xt--)if(xt in St&&St[xt]===ft)return xt||0;return-1}:ct},1194:(it,ut,s)=>{var et=s(7293),ot=s(5112),st=s(7392),Rt=ot("species");it.exports=function(ht){return st>=51||!et(function(){var bt=[];return(bt.constructor={})[Rt]=function(){return{foo:1}},bt[ht](Boolean).foo!==1})}},9341:(it,ut,s)=>{var et=s(7293);it.exports=function(ot,st){var Rt=[][ot];return!!Rt&&et(function(){Rt.call(null,st||function(){return 1},1)})}},3671:(it,ut,s)=>{var et=s(9662),ot=s(7908),st=s(8361),Rt=s(6244),ht=TypeError,bt=function(ct){return function(mt,rt,pt,ft){et(rt);var St=ot(mt),It=st(St),xt=Rt(St),At=ct?xt-1:0,Dt=ct?-1:1;if(pt<2)for(;;){if(At in It){ft=It[At],At+=Dt;break}if(At+=Dt,ct?At<0:xt<=At)throw ht("Reduce of empty array with no initial value")}for(;ct?At>=0:xt>At;At+=Dt)At in It&&(ft=rt(ft,It[At],At,St));return ft}};it.exports={left:bt(!1),right:bt(!0)}},1589:(it,ut,s)=>{var et=s(1400),ot=s(6244),st=s(6135),Rt=Array,ht=Math.max;it.exports=function(bt,ct,mt){for(var rt=ot(bt),pt=et(ct,rt),ft=et(mt===void 0?rt:mt,rt),St=Rt(ht(ft-pt,0)),It=0;pt<ft;pt++,It++)st(St,It,bt[pt]);return St.length=It,St}},206:(it,ut,s)=>{var et=s(1702);it.exports=et([].slice)},4362:(it,ut,s)=>{var et=s(1589),ot=Math.floor,st=function(bt,ct){var mt=bt.length,rt=ot(mt/2);return mt<8?Rt(bt,ct):ht(bt,st(et(bt,0,rt),ct),st(et(bt,rt),ct),ct)},Rt=function(bt,ct){for(var mt,rt,pt=bt.length,ft=1;ft<pt;){for(rt=ft,mt=bt[ft];rt&&ct(bt[rt-1],mt)>0;)bt[rt]=bt[--rt];rt!==ft++&&(bt[rt]=mt)}return bt},ht=function(bt,ct,mt,rt){for(var pt=ct.length,ft=mt.length,St=0,It=0;St<pt||It<ft;)bt[St+It]=St<pt&&It<ft?rt(ct[St],mt[It])<=0?ct[St++]:mt[It++]:St<pt?ct[St++]:mt[It++];return bt};it.exports=st},7475:(it,ut,s)=>{var et=s(3157),ot=s(4411),st=s(111),Rt=s(5112)("species"),ht=Array;it.exports=function(bt){var ct;return et(bt)&&(ct=bt.constructor,(ot(ct)&&(ct===ht||et(ct.prototype))||st(ct)&&(ct=ct[Rt])===null)&&(ct=void 0)),ct===void 0?ht:ct}},5417:(it,ut,s)=>{var et=s(7475);it.exports=function(ot,st){return new(et(ot))(st===0?0:st)}},3411:(it,ut,s)=>{var et=s(9670),ot=s(9212);it.exports=function(st,Rt,ht,bt){try{return bt?Rt(et(ht)[0],ht[1]):Rt(ht)}catch(ct){ot(st,"throw",ct)}}},7072:(it,ut,s)=>{var et=s(5112)("iterator"),ot=!1;try{var st=0,Rt={next:function(){return{done:!!st++}},return:function(){ot=!0}};Rt[et]=function(){return this},Array.from(Rt,function(){throw 2})}catch{}it.exports=function(ht,bt){if(!bt&&!ot)return!1;var ct=!1;try{var mt={};mt[et]=function(){return{next:function(){return{done:ct=!0}}}},ht(mt)}catch{}return ct}},4326:(it,ut,s)=>{var et=s(1702),ot=et({}.toString),st=et("".slice);it.exports=function(Rt){return st(ot(Rt),8,-1)}},648:(it,ut,s)=>{var et=s(1694),ot=s(614),st=s(4326),Rt=s(5112)("toStringTag"),ht=Object,bt=st(function(){return arguments}())=="Arguments";it.exports=et?st:function(ct){var mt,rt,pt;return ct===void 0?"Undefined":ct===null?"Null":typeof(rt=function(ft,St){try{return ft[St]}catch{}}(mt=ht(ct),Rt))=="string"?rt:bt?st(mt):(pt=st(mt))=="Object"&&ot(mt.callee)?"Arguments":pt}},5631:(it,ut,s)=>{var et=s(3070).f,ot=s(30),st=s(9190),Rt=s(9974),ht=s(5787),bt=s(408),ct=s(654),mt=s(6340),rt=s(9781),pt=s(2423).fastKey,ft=s(9909),St=ft.set,It=ft.getterFor;it.exports={getConstructor:function(xt,At,Dt,wt){var Mt=xt(function(tn,gn){ht(tn,vt),St(tn,{type:At,index:ot(null),first:void 0,last:void 0,size:0}),rt||(tn.size=0),gn!=null&&bt(gn,tn[wt],{that:tn,AS_ENTRIES:Dt})}),vt=Mt.prototype,Ft=It(At),Ht=function(tn,gn,nn){var qt,fn,Cn=Ft(tn),Tn=Wt(tn,gn);return Tn?Tn.value=nn:(Cn.last=Tn={index:fn=pt(gn,!0),key:gn,value:nn,previous:qt=Cn.last,next:void 0,removed:!1},Cn.first||(Cn.first=Tn),qt&&(qt.next=Tn),rt?Cn.size++:tn.size++,fn!=="F"&&(Cn.index[fn]=Tn)),tn},Wt=function(tn,gn){var nn,qt=Ft(tn),fn=pt(gn);if(fn!=="F")return qt.index[fn];for(nn=qt.first;nn;nn=nn.next)if(nn.key==gn)return nn};return st(vt,{clear:function(){for(var tn=Ft(this),gn=tn.index,nn=tn.first;nn;)nn.removed=!0,nn.previous&&(nn.previous=nn.previous.next=void 0),delete gn[nn.index],nn=nn.next;tn.first=tn.last=void 0,rt?tn.size=0:this.size=0},delete:function(tn){var gn=this,nn=Ft(gn),qt=Wt(gn,tn);if(qt){var fn=qt.next,Cn=qt.previous;delete nn.index[qt.index],qt.removed=!0,Cn&&(Cn.next=fn),fn&&(fn.previous=Cn),nn.first==qt&&(nn.first=fn),nn.last==qt&&(nn.last=Cn),rt?nn.size--:gn.size--}return!!qt},forEach:function(tn){for(var gn,nn=Ft(this),qt=Rt(tn,arguments.length>1?arguments[1]:void 0);gn=gn?gn.next:nn.first;)for(qt(gn.value,gn.key,this);gn&&gn.removed;)gn=gn.previous},has:function(tn){return!!Wt(this,tn)}}),st(vt,Dt?{get:function(tn){var gn=Wt(this,tn);return gn&&gn.value},set:function(tn,gn){return Ht(this,tn===0?0:tn,gn)}}:{add:function(tn){return Ht(this,tn=tn===0?0:tn,tn)}}),rt&&et(vt,"size",{get:function(){return Ft(this).size}}),Mt},setStrong:function(xt,At,Dt){var wt=At+" Iterator",Mt=It(At),vt=It(wt);ct(xt,At,function(Ft,Ht){St(this,{type:wt,target:Ft,state:Mt(Ft),kind:Ht,last:void 0})},function(){for(var Ft=vt(this),Ht=Ft.kind,Wt=Ft.last;Wt&&Wt.removed;)Wt=Wt.previous;return Ft.target&&(Ft.last=Wt=Wt?Wt.next:Ft.state.first)?Ht=="keys"?{value:Wt.key,done:!1}:Ht=="values"?{value:Wt.value,done:!1}:{value:[Wt.key,Wt.value],done:!1}:(Ft.target=void 0,{value:void 0,done:!0})},Dt?"entries":"values",!Dt,!0),mt(At)}}},9320:(it,ut,s)=>{var et=s(1702),ot=s(9190),st=s(2423).getWeakData,Rt=s(9670),ht=s(111),bt=s(5787),ct=s(408),mt=s(2092),rt=s(2597),pt=s(9909),ft=pt.set,St=pt.getterFor,It=mt.find,xt=mt.findIndex,At=et([].splice),Dt=0,wt=function(Ft){return Ft.frozen||(Ft.frozen=new Mt)},Mt=function(){this.entries=[]},vt=function(Ft,Ht){return It(Ft.entries,function(Wt){return Wt[0]===Ht})};Mt.prototype={get:function(Ft){var Ht=vt(this,Ft);if(Ht)return Ht[1]},has:function(Ft){return!!vt(this,Ft)},set:function(Ft,Ht){var Wt=vt(this,Ft);Wt?Wt[1]=Ht:this.entries.push([Ft,Ht])},delete:function(Ft){var Ht=xt(this.entries,function(Wt){return Wt[0]===Ft});return~Ht&&At(this.entries,Ht,1),!!~Ht}},it.exports={getConstructor:function(Ft,Ht,Wt,tn){var gn=Ft(function(Cn,Tn){bt(Cn,nn),ft(Cn,{type:Ht,id:Dt++,frozen:void 0}),Tn!=null&&ct(Tn,Cn[tn],{that:Cn,AS_ENTRIES:Wt})}),nn=gn.prototype,qt=St(Ht),fn=function(Cn,Tn,un){var mn=qt(Cn),yn=st(Rt(Tn),!0);return yn===!0?wt(mn).set(Tn,un):yn[mn.id]=un,Cn};return ot(nn,{delete:function(Cn){var Tn=qt(this);if(!ht(Cn))return!1;var un=st(Cn);return un===!0?wt(Tn).delete(Cn):un&&rt(un,Tn.id)&&delete un[Tn.id]},has:function(Cn){var Tn=qt(this);if(!ht(Cn))return!1;var un=st(Cn);return un===!0?wt(Tn).has(Cn):un&&rt(un,Tn.id)}}),ot(nn,Wt?{get:function(Cn){var Tn=qt(this);if(ht(Cn)){var un=st(Cn);return un===!0?wt(Tn).get(Cn):un?un[Tn.id]:void 0}},set:function(Cn,Tn){return fn(this,Cn,Tn)}}:{add:function(Cn){return fn(this,Cn,!0)}}),gn}}},7710:(it,ut,s)=>{var et=s(2109),ot=s(7854),st=s(1702),Rt=s(4705),ht=s(8052),bt=s(2423),ct=s(408),mt=s(5787),rt=s(614),pt=s(111),ft=s(7293),St=s(7072),It=s(8003),xt=s(9587);it.exports=function(At,Dt,wt){var Mt=At.indexOf("Map")!==-1,vt=At.indexOf("Weak")!==-1,Ft=Mt?"set":"add",Ht=ot[At],Wt=Ht&&Ht.prototype,tn=Ht,gn={},nn=function(mn){var yn=st(Wt[mn]);ht(Wt,mn,mn=="add"?function(pn){return yn(this,pn===0?0:pn),this}:mn=="delete"?function(pn){return!(vt&&!pt(pn))&&yn(this,pn===0?0:pn)}:mn=="get"?function(pn){return vt&&!pt(pn)?void 0:yn(this,pn===0?0:pn)}:mn=="has"?function(pn){return!(vt&&!pt(pn))&&yn(this,pn===0?0:pn)}:function(pn,In){return yn(this,pn===0?0:pn,In),this})};if(Rt(At,!rt(Ht)||!(vt||Wt.forEach&&!ft(function(){new Ht().entries().next()}))))tn=wt.getConstructor(Dt,At,Mt,Ft),bt.enable();else if(Rt(At,!0)){var qt=new tn,fn=qt[Ft](vt?{}:-0,1)!=qt,Cn=ft(function(){qt.has(1)}),Tn=St(function(mn){new Ht(mn)}),un=!vt&&ft(function(){for(var mn=new Ht,yn=5;yn--;)mn[Ft](yn,yn);return!mn.has(-0)});Tn||((tn=Dt(function(mn,yn){mt(mn,Wt);var pn=xt(new Ht,mn,tn);return yn!=null&&ct(yn,pn[Ft],{that:pn,AS_ENTRIES:Mt}),pn})).prototype=Wt,Wt.constructor=tn),(Cn||un)&&(nn("delete"),nn("has"),Mt&&nn("get")),(un||fn)&&nn(Ft),vt&&Wt.clear&&delete Wt.clear}return gn[At]=tn,et({global:!0,constructor:!0,forced:tn!=Ht},gn),It(tn,At),vt||wt.setStrong(tn,At,Mt),tn}},9920:(it,ut,s)=>{var et=s(2597),ot=s(3887),st=s(1236),Rt=s(3070);it.exports=function(ht,bt,ct){for(var mt=ot(bt),rt=Rt.f,pt=st.f,ft=0;ft<mt.length;ft++){var St=mt[ft];et(ht,St)||ct&&et(ct,St)||rt(ht,St,pt(bt,St))}}},4964:(it,ut,s)=>{var et=s(5112)("match");it.exports=function(ot){var st=/./;try{"/./"[ot](st)}catch{try{return st[et]=!1,"/./"[ot](st)}catch{}}return!1}},8544:(it,ut,s)=>{var et=s(7293);it.exports=!et(function(){function ot(){}return ot.prototype.constructor=null,Object.getPrototypeOf(new ot)!==ot.prototype})},4994:(it,ut,s)=>{var et=s(3383).IteratorPrototype,ot=s(30),st=s(9114),Rt=s(8003),ht=s(7497),bt=function(){return this};it.exports=function(ct,mt,rt,pt){var ft=mt+" Iterator";return ct.prototype=ot(et,{next:st(+!pt,rt)}),Rt(ct,ft,!1,!0),ht[ft]=bt,ct}},8880:(it,ut,s)=>{var et=s(9781),ot=s(3070),st=s(9114);it.exports=et?function(Rt,ht,bt){return ot.f(Rt,ht,st(1,bt))}:function(Rt,ht,bt){return Rt[ht]=bt,Rt}},9114:it=>{it.exports=function(ut,s){return{enumerable:!(1&ut),configurable:!(2&ut),writable:!(4&ut),value:s}}},6135:(it,ut,s)=>{var et=s(4948),ot=s(3070),st=s(9114);it.exports=function(Rt,ht,bt){var ct=et(ht);ct in Rt?ot.f(Rt,ct,st(0,bt)):Rt[ct]=bt}},5573:(it,ut,s)=>{var et=s(1702),ot=s(7293),st=s(6650).start,Rt=RangeError,ht=Math.abs,bt=Date.prototype,ct=bt.toISOString,mt=et(bt.getTime),rt=et(bt.getUTCDate),pt=et(bt.getUTCFullYear),ft=et(bt.getUTCHours),St=et(bt.getUTCMilliseconds),It=et(bt.getUTCMinutes),xt=et(bt.getUTCMonth),At=et(bt.getUTCSeconds);it.exports=ot(function(){return ct.call(new Date(-50000000000001))!="0385-07-25T07:06:39.999Z"})||!ot(function(){ct.call(new Date(NaN))})?function(){if(!isFinite(mt(this)))throw Rt("Invalid time value");var Dt=this,wt=pt(Dt),Mt=St(Dt),vt=wt<0?"-":wt>9999?"+":"";return vt+st(ht(wt),vt?6:4,0)+"-"+st(xt(Dt)+1,2,0)+"-"+st(rt(Dt),2,0)+"T"+st(ft(Dt),2,0)+":"+st(It(Dt),2,0)+":"+st(At(Dt),2,0)+"."+st(Mt,3,0)+"Z"}:ct},7045:(it,ut,s)=>{var et=s(6339),ot=s(3070);it.exports=function(st,Rt,ht){return ht.get&&et(ht.get,Rt,{getter:!0}),ht.set&&et(ht.set,Rt,{setter:!0}),ot.f(st,Rt,ht)}},8052:(it,ut,s)=>{var et=s(614),ot=s(3070),st=s(6339),Rt=s(3072);it.exports=function(ht,bt,ct,mt){mt||(mt={});var rt=mt.enumerable,pt=mt.name!==void 0?mt.name:bt;if(et(ct)&&st(ct,pt,mt),mt.global)rt?ht[bt]=ct:Rt(bt,ct);else{try{mt.unsafe?ht[bt]&&(rt=!0):delete ht[bt]}catch{}rt?ht[bt]=ct:ot.f(ht,bt,{value:ct,enumerable:!1,configurable:!mt.nonConfigurable,writable:!mt.nonWritable})}return ht}},9190:(it,ut,s)=>{var et=s(8052);it.exports=function(ot,st,Rt){for(var ht in st)et(ot,ht,st[ht],Rt);return ot}},3072:(it,ut,s)=>{var et=s(7854),ot=Object.defineProperty;it.exports=function(st,Rt){try{ot(et,st,{value:Rt,configurable:!0,writable:!0})}catch{et[st]=Rt}return Rt}},654:(it,ut,s)=>{var et=s(2109),ot=s(6916),st=s(1913),Rt=s(6530),ht=s(614),bt=s(4994),ct=s(9518),mt=s(7674),rt=s(8003),pt=s(8880),ft=s(8052),St=s(5112),It=s(7497),xt=s(3383),At=Rt.PROPER,Dt=Rt.CONFIGURABLE,wt=xt.IteratorPrototype,Mt=xt.BUGGY_SAFARI_ITERATORS,vt=St("iterator"),Ft="keys",Ht="values",Wt="entries",tn=function(){return this};it.exports=function(gn,nn,qt,fn,Cn,Tn,un){bt(qt,nn,fn);var mn,yn,pn,In=function(Fn){if(Fn===Cn&&On)return On;if(!Mt&&Fn in xn)return xn[Fn];switch(Fn){case Ft:case Ht:case Wt:return function(){return new qt(this,Fn)}}return function(){return new qt(this)}},kn=nn+" Iterator",Mn=!1,xn=gn.prototype,Pn=xn[vt]||xn["@@iterator"]||Cn&&xn[Cn],On=!Mt&&Pn||In(Cn),Dn=nn=="Array"&&xn.entries||Pn;if(Dn&&(mn=ct(Dn.call(new gn)))!==Object.prototype&&mn.next&&(st||ct(mn)===wt||(mt?mt(mn,wt):ht(mn[vt])||ft(mn,vt,tn)),rt(mn,kn,!0,!0),st&&(It[kn]=tn)),At&&Cn==Ht&&Pn&&Pn.name!==Ht&&(!st&&Dt?pt(xn,"name",Ht):(Mn=!0,On=function(){return ot(Pn,this)})),Cn)if(yn={values:In(Ht),keys:Tn?On:In(Ft),entries:In(Wt)},un)for(pn in yn)(Mt||Mn||!(pn in xn))&&ft(xn,pn,yn[pn]);else et({target:nn,proto:!0,forced:Mt||Mn},yn);return st&&!un||xn[vt]===On||ft(xn,vt,On,{name:Cn}),It[nn]=On,yn}},7235:(it,ut,s)=>{var et=s(857),ot=s(2597),st=s(6061),Rt=s(3070).f;it.exports=function(ht){var bt=et.Symbol||(et.Symbol={});ot(bt,ht)||Rt(bt,ht,{value:st.f(ht)})}},5117:(it,ut,s)=>{var et=s(6330),ot=TypeError;it.exports=function(st,Rt){if(!delete st[Rt])throw ot("Cannot delete property "+et(Rt)+" of "+et(st))}},9781:(it,ut,s)=>{var et=s(7293);it.exports=!et(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},317:(it,ut,s)=>{var et=s(7854),ot=s(111),st=et.document,Rt=ot(st)&&ot(st.createElement);it.exports=function(ht){return Rt?st.createElement(ht):{}}},7207:it=>{var ut=TypeError;it.exports=function(s){if(s>9007199254740991)throw ut("Maximum allowed index exceeded");return s}},8324:it=>{it.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(it,ut,s)=>{var et=s(317)("span").classList,ot=et&&et.constructor&&et.constructor.prototype;it.exports=ot===Object.prototype?void 0:ot},8886:(it,ut,s)=>{var et=s(8113).match(/firefox\/(\d+)/i);it.exports=!!et&&+et[1]},7871:it=>{it.exports=typeof window=="object"&&typeof Deno!="object"},256:(it,ut,s)=>{var et=s(8113);it.exports=/MSIE|Trident/.test(et)},1528:(it,ut,s)=>{var et=s(8113),ot=s(7854);it.exports=/ipad|iphone|ipod/i.test(et)&&ot.Pebble!==void 0},6833:(it,ut,s)=>{var et=s(8113);it.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(et)},2805:(it,ut,s)=>{var et=s(4326),ot=s(7854);it.exports=et(ot.process)=="process"},1036:(it,ut,s)=>{var et=s(8113);it.exports=/web0s(?!.*chrome)/i.test(et)},8113:(it,ut,s)=>{var et=s(5005);it.exports=et("navigator","userAgent")||""},7392:(it,ut,s)=>{var et,ot,st=s(7854),Rt=s(8113),ht=st.process,bt=st.Deno,ct=ht&&ht.versions||bt&&bt.version,mt=ct&&ct.v8;mt&&(ot=(et=mt.split("."))[0]>0&&et[0]<4?1:+(et[0]+et[1])),!ot&&Rt&&(!(et=Rt.match(/Edge\/(\d+)/))||et[1]>=74)&&(et=Rt.match(/Chrome\/(\d+)/))&&(ot=+et[1]),it.exports=ot},8008:(it,ut,s)=>{var et=s(8113).match(/AppleWebKit\/(\d+)\./);it.exports=!!et&&+et[1]},748:it=>{it.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:(it,ut,s)=>{var et=s(7854),ot=s(1236).f,st=s(8880),Rt=s(8052),ht=s(3072),bt=s(9920),ct=s(4705);it.exports=function(mt,rt){var pt,ft,St,It,xt,At=mt.target,Dt=mt.global,wt=mt.stat;if(pt=Dt?et:wt?et[At]||ht(At,{}):(et[At]||{}).prototype)for(ft in rt){if(It=rt[ft],St=mt.dontCallGetSet?(xt=ot(pt,ft))&&xt.value:pt[ft],!ct(Dt?ft:At+(wt?".":"#")+ft,mt.forced)&&St!==void 0){if(typeof It==typeof St)continue;bt(It,St)}(mt.sham||St&&St.sham)&&st(It,"sham",!0),Rt(pt,ft,It,mt)}}},7293:it=>{it.exports=function(ut){try{return!!ut()}catch{return!0}}},7007:(it,ut,s)=>{s(4916);var et=s(1702),ot=s(8052),st=s(2261),Rt=s(7293),ht=s(5112),bt=s(8880),ct=ht("species"),mt=RegExp.prototype;it.exports=function(rt,pt,ft,St){var It=ht(rt),xt=!Rt(function(){var Mt={};return Mt[It]=function(){return 7},""[rt](Mt)!=7}),At=xt&&!Rt(function(){var Mt=!1,vt=/a/;return rt==="split"&&((vt={}).constructor={},vt.constructor[ct]=function(){return vt},vt.flags="",vt[It]=/./[It]),vt.exec=function(){return Mt=!0,null},vt[It](""),!Mt});if(!xt||!At||ft){var Dt=et(/./[It]),wt=pt(It,""[rt],function(Mt,vt,Ft,Ht,Wt){var tn=et(Mt),gn=vt.exec;return gn===st||gn===mt.exec?xt&&!Wt?{done:!0,value:Dt(vt,Ft,Ht)}:{done:!0,value:tn(Ft,vt,Ht)}:{done:!1}});ot(String.prototype,rt,wt[0]),ot(mt,It,wt[1])}St&&bt(mt[It],"sham",!0)}},6677:(it,ut,s)=>{var et=s(7293);it.exports=!et(function(){return Object.isExtensible(Object.preventExtensions({}))})},2104:(it,ut,s)=>{var et=s(4374),ot=Function.prototype,st=ot.apply,Rt=ot.call;it.exports=typeof Reflect=="object"&&Reflect.apply||(et?Rt.bind(st):function(){return Rt.apply(st,arguments)})},9974:(it,ut,s)=>{var et=s(1702),ot=s(9662),st=s(4374),Rt=et(et.bind);it.exports=function(ht,bt){return ot(ht),bt===void 0?ht:st?Rt(ht,bt):function(){return ht.apply(bt,arguments)}}},4374:(it,ut,s)=>{var et=s(7293);it.exports=!et(function(){var ot=(function(){}).bind();return typeof ot!="function"||ot.hasOwnProperty("prototype")})},7065:(it,ut,s)=>{var et=s(1702),ot=s(9662),st=s(111),Rt=s(2597),ht=s(206),bt=s(4374),ct=Function,mt=et([].concat),rt=et([].join),pt={},ft=function(St,It,xt){if(!Rt(pt,It)){for(var At=[],Dt=0;Dt<It;Dt++)At[Dt]="a["+Dt+"]";pt[It]=ct("C,a","return new C("+rt(At,",")+")")}return pt[It](St,xt)};it.exports=bt?ct.bind:function(St){var It=ot(this),xt=It.prototype,At=ht(arguments,1),Dt=function(){var wt=mt(At,ht(arguments));return this instanceof Dt?ft(It,wt.length,wt):It.apply(St,wt)};return st(xt)&&(Dt.prototype=xt),Dt}},6916:(it,ut,s)=>{var et=s(4374),ot=Function.prototype.call;it.exports=et?ot.bind(ot):function(){return ot.apply(ot,arguments)}},6530:(it,ut,s)=>{var et=s(9781),ot=s(2597),st=Function.prototype,Rt=et&&Object.getOwnPropertyDescriptor,ht=ot(st,"name"),bt=ht&&(function(){}).name==="something",ct=ht&&(!et||et&&Rt(st,"name").configurable);it.exports={EXISTS:ht,PROPER:bt,CONFIGURABLE:ct}},1702:(it,ut,s)=>{var et=s(4374),ot=Function.prototype,st=ot.bind,Rt=ot.call,ht=et&&st.bind(Rt,Rt);it.exports=et?function(bt){return bt&&ht(bt)}:function(bt){return bt&&function(){return Rt.apply(bt,arguments)}}},5005:(it,ut,s)=>{var et=s(7854),ot=s(614),st=function(Rt){return ot(Rt)?Rt:void 0};it.exports=function(Rt,ht){return arguments.length<2?st(et[Rt]):et[Rt]&&et[Rt][ht]}},1246:(it,ut,s)=>{var et=s(648),ot=s(8173),st=s(7497),Rt=s(5112)("iterator");it.exports=function(ht){if(ht!=null)return ot(ht,Rt)||ot(ht,"@@iterator")||st[et(ht)]}},8554:(it,ut,s)=>{var et=s(6916),ot=s(9662),st=s(9670),Rt=s(6330),ht=s(1246),bt=TypeError;it.exports=function(ct,mt){var rt=arguments.length<2?ht(ct):mt;if(ot(rt))return st(et(rt,ct));throw bt(Rt(ct)+" is not iterable")}},8173:(it,ut,s)=>{var et=s(9662);it.exports=function(ot,st){var Rt=ot[st];return Rt==null?void 0:et(Rt)}},647:(it,ut,s)=>{var et=s(1702),ot=s(7908),st=Math.floor,Rt=et("".charAt),ht=et("".replace),bt=et("".slice),ct=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,mt=/\$([$&'`]|\d{1,2})/g;it.exports=function(rt,pt,ft,St,It,xt){var At=ft+rt.length,Dt=St.length,wt=mt;return It!==void 0&&(It=ot(It),wt=ct),ht(xt,wt,function(Mt,vt){var Ft;switch(Rt(vt,0)){case"$":return"$";case"&":return rt;case"`":return bt(pt,0,ft);case"'":return bt(pt,At);case"<":Ft=It[bt(vt,1,-1)];break;default:var Ht=+vt;if(Ht===0)return Mt;if(Ht>Dt){var Wt=st(Ht/10);return Wt===0?Mt:Wt<=Dt?St[Wt-1]===void 0?Rt(vt,1):St[Wt-1]+Rt(vt,1):Mt}Ft=St[Ht-1]}return Ft===void 0?"":Ft})}},7854:(it,ut,s)=>{var et=function(ot){return ot&&ot.Math==Math&&ot};it.exports=et(typeof globalThis=="object"&&globalThis)||et(typeof window=="object"&&window)||et(typeof self=="object"&&self)||et(typeof s.g=="object"&&s.g)||function(){return this}()||Function("return this")()},2597:(it,ut,s)=>{var et=s(1702),ot=s(7908),st=et({}.hasOwnProperty);it.exports=Object.hasOwn||function(Rt,ht){return st(ot(Rt),ht)}},3501:it=>{it.exports={}},842:(it,ut,s)=>{var et=s(7854);it.exports=function(ot,st){var Rt=et.console;Rt&&Rt.error&&(arguments.length==1?Rt.error(ot):Rt.error(ot,st))}},490:(it,ut,s)=>{var et=s(5005);it.exports=et("document","documentElement")},4664:(it,ut,s)=>{var et=s(9781),ot=s(7293),st=s(317);it.exports=!et&&!ot(function(){return Object.defineProperty(st("div"),"a",{get:function(){return 7}}).a!=7})},1179:it=>{var ut=Array,s=Math.abs,et=Math.pow,ot=Math.floor,st=Math.log,Rt=Math.LN2;it.exports={pack:function(ht,bt,ct){var mt,rt,pt,ft=ut(ct),St=8*ct-bt-1,It=(1<<St)-1,xt=It>>1,At=bt===23?et(2,-24)-et(2,-77):0,Dt=ht<0||ht===0&&1/ht<0?1:0,wt=0;for((ht=s(ht))!=ht||ht===1/0?(rt=ht!=ht?1:0,mt=It):(mt=ot(st(ht)/Rt),ht*(pt=et(2,-mt))<1&&(mt--,pt*=2),(ht+=mt+xt>=1?At/pt:At*et(2,1-xt))*pt>=2&&(mt++,pt/=2),mt+xt>=It?(rt=0,mt=It):mt+xt>=1?(rt=(ht*pt-1)*et(2,bt),mt+=xt):(rt=ht*et(2,xt-1)*et(2,bt),mt=0));bt>=8;)ft[wt++]=255&rt,rt/=256,bt-=8;for(mt=mt<<bt|rt,St+=bt;St>0;)ft[wt++]=255&mt,mt/=256,St-=8;return ft[--wt]|=128*Dt,ft},unpack:function(ht,bt){var ct,mt=ht.length,rt=8*mt-bt-1,pt=(1<<rt)-1,ft=pt>>1,St=rt-7,It=mt-1,xt=ht[It--],At=127&xt;for(xt>>=7;St>0;)At=256*At+ht[It--],St-=8;for(ct=At&(1<<-St)-1,At>>=-St,St+=bt;St>0;)ct=256*ct+ht[It--],St-=8;if(At===0)At=1-ft;else{if(At===pt)return ct?NaN:xt?-1/0:1/0;ct+=et(2,bt),At-=ft}return(xt?-1:1)*ct*et(2,At-bt)}}},8361:(it,ut,s)=>{var et=s(1702),ot=s(7293),st=s(4326),Rt=Object,ht=et("".split);it.exports=ot(function(){return!Rt("z").propertyIsEnumerable(0)})?function(bt){return st(bt)=="String"?ht(bt,""):Rt(bt)}:Rt},9587:(it,ut,s)=>{var et=s(614),ot=s(111),st=s(7674);it.exports=function(Rt,ht,bt){var ct,mt;return st&&et(ct=ht.constructor)&&ct!==bt&&ot(mt=ct.prototype)&&mt!==bt.prototype&&st(Rt,mt),Rt}},2788:(it,ut,s)=>{var et=s(1702),ot=s(614),st=s(5465),Rt=et(Function.toString);ot(st.inspectSource)||(st.inspectSource=function(ht){return Rt(ht)}),it.exports=st.inspectSource},2423:(it,ut,s)=>{var et=s(2109),ot=s(1702),st=s(3501),Rt=s(111),ht=s(2597),bt=s(3070).f,ct=s(8006),mt=s(1156),rt=s(2050),pt=s(9711),ft=s(6677),St=!1,It=pt("meta"),xt=0,At=function(wt){bt(wt,It,{value:{objectID:"O"+xt++,weakData:{}}})},Dt=it.exports={enable:function(){Dt.enable=function(){},St=!0;var wt=ct.f,Mt=ot([].splice),vt={};vt[It]=1,wt(vt).length&&(ct.f=function(Ft){for(var Ht=wt(Ft),Wt=0,tn=Ht.length;Wt<tn;Wt++)if(Ht[Wt]===It){Mt(Ht,Wt,1);break}return Ht},et({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:mt.f}))},fastKey:function(wt,Mt){if(!Rt(wt))return typeof wt=="symbol"?wt:(typeof wt=="string"?"S":"P")+wt;if(!ht(wt,It)){if(!rt(wt))return"F";if(!Mt)return"E";At(wt)}return wt[It].objectID},getWeakData:function(wt,Mt){if(!ht(wt,It)){if(!rt(wt))return!0;if(!Mt)return!1;At(wt)}return wt[It].weakData},onFreeze:function(wt){return ft&&St&&rt(wt)&&!ht(wt,It)&&At(wt),wt}};st[It]=!0},9909:(it,ut,s)=>{var et,ot,st,Rt=s(8536),ht=s(7854),bt=s(1702),ct=s(111),mt=s(8880),rt=s(2597),pt=s(5465),ft=s(6200),St=s(3501),It="Object already initialized",xt=ht.TypeError,At=ht.WeakMap;if(Rt||pt.state){var Dt=pt.state||(pt.state=new At),wt=bt(Dt.get),Mt=bt(Dt.has),vt=bt(Dt.set);et=function(Ht,Wt){if(Mt(Dt,Ht))throw new xt(It);return Wt.facade=Ht,vt(Dt,Ht,Wt),Wt},ot=function(Ht){return wt(Dt,Ht)||{}},st=function(Ht){return Mt(Dt,Ht)}}else{var Ft=ft("state");St[Ft]=!0,et=function(Ht,Wt){if(rt(Ht,Ft))throw new xt(It);return Wt.facade=Ht,mt(Ht,Ft,Wt),Wt},ot=function(Ht){return rt(Ht,Ft)?Ht[Ft]:{}},st=function(Ht){return rt(Ht,Ft)}}it.exports={set:et,get:ot,has:st,enforce:function(Ht){return st(Ht)?ot(Ht):et(Ht,{})},getterFor:function(Ht){return function(Wt){var tn;if(!ct(Wt)||(tn=ot(Wt)).type!==Ht)throw xt("Incompatible receiver, "+Ht+" required");return tn}}}},7659:(it,ut,s)=>{var et=s(5112),ot=s(7497),st=et("iterator"),Rt=Array.prototype;it.exports=function(ht){return ht!==void 0&&(ot.Array===ht||Rt[st]===ht)}},3157:(it,ut,s)=>{var et=s(4326);it.exports=Array.isArray||function(ot){return et(ot)=="Array"}},614:it=>{it.exports=function(ut){return typeof ut=="function"}},4411:(it,ut,s)=>{var et=s(1702),ot=s(7293),st=s(614),Rt=s(648),ht=s(5005),bt=s(2788),ct=function(){},mt=[],rt=ht("Reflect","construct"),pt=/^\s*(?:class|function)\b/,ft=et(pt.exec),St=!pt.exec(ct),It=function(At){if(!st(At))return!1;try{return rt(ct,mt,At),!0}catch{return!1}},xt=function(At){if(!st(At))return!1;switch(Rt(At)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return St||!!ft(pt,bt(At))}catch{return!0}};xt.sham=!0,it.exports=!rt||ot(function(){var At;return It(It.call)||!It(Object)||!It(function(){At=!0})||At})?xt:It},5032:(it,ut,s)=>{var et=s(2597);it.exports=function(ot){return ot!==void 0&&(et(ot,"value")||et(ot,"writable"))}},4705:(it,ut,s)=>{var et=s(7293),ot=s(614),st=/#|\.prototype\./,Rt=function(rt,pt){var ft=bt[ht(rt)];return ft==mt||ft!=ct&&(ot(pt)?et(pt):!!pt)},ht=Rt.normalize=function(rt){return String(rt).replace(st,".").toLowerCase()},bt=Rt.data={},ct=Rt.NATIVE="N",mt=Rt.POLYFILL="P";it.exports=Rt},5988:(it,ut,s)=>{var et=s(111),ot=Math.floor;it.exports=Number.isInteger||function(st){return!et(st)&&isFinite(st)&&ot(st)===st}},111:(it,ut,s)=>{var et=s(614);it.exports=function(ot){return typeof ot=="object"?ot!==null:et(ot)}},1913:it=>{it.exports=!1},7850:(it,ut,s)=>{var et=s(111),ot=s(4326),st=s(5112)("match");it.exports=function(Rt){var ht;return et(Rt)&&((ht=Rt[st])!==void 0?!!ht:ot(Rt)=="RegExp")}},2190:(it,ut,s)=>{var et=s(5005),ot=s(614),st=s(7976),Rt=s(3307),ht=Object;it.exports=Rt?function(bt){return typeof bt=="symbol"}:function(bt){var ct=et("Symbol");return ot(ct)&&st(ct.prototype,ht(bt))}},408:(it,ut,s)=>{var et=s(9974),ot=s(6916),st=s(9670),Rt=s(6330),ht=s(7659),bt=s(6244),ct=s(7976),mt=s(8554),rt=s(1246),pt=s(9212),ft=TypeError,St=function(xt,At){this.stopped=xt,this.result=At},It=St.prototype;it.exports=function(xt,At,Dt){var wt,Mt,vt,Ft,Ht,Wt,tn,gn=Dt&&Dt.that,nn=!(!Dt||!Dt.AS_ENTRIES),qt=!(!Dt||!Dt.IS_RECORD),fn=!(!Dt||!Dt.IS_ITERATOR),Cn=!(!Dt||!Dt.INTERRUPTED),Tn=et(At,gn),un=function(yn){return wt&&pt(wt,"normal",yn),new St(!0,yn)},mn=function(yn){return nn?(st(yn),Cn?Tn(yn[0],yn[1],un):Tn(yn[0],yn[1])):Cn?Tn(yn,un):Tn(yn)};if(qt)wt=xt.iterator;else if(fn)wt=xt;else{if(!(Mt=rt(xt)))throw ft(Rt(xt)+" is not iterable");if(ht(Mt)){for(vt=0,Ft=bt(xt);Ft>vt;vt++)if((Ht=mn(xt[vt]))&&ct(It,Ht))return Ht;return new St(!1)}wt=mt(xt,Mt)}for(Wt=qt?xt.next:wt.next;!(tn=ot(Wt,wt)).done;){try{Ht=mn(tn.value)}catch(yn){pt(wt,"throw",yn)}if(typeof Ht=="object"&&Ht&&ct(It,Ht))return Ht}return new St(!1)}},9212:(it,ut,s)=>{var et=s(6916),ot=s(9670),st=s(8173);it.exports=function(Rt,ht,bt){var ct,mt;ot(Rt);try{if(!(ct=st(Rt,"return"))){if(ht==="throw")throw bt;return bt}ct=et(ct,Rt)}catch(rt){mt=!0,ct=rt}if(ht==="throw")throw bt;if(mt)throw ct;return ot(ct),bt}},3383:(it,ut,s)=>{var et,ot,st,Rt=s(7293),ht=s(614),bt=s(30),ct=s(9518),mt=s(8052),rt=s(5112),pt=s(1913),ft=rt("iterator"),St=!1;[].keys&&("next"in(st=[].keys())?(ot=ct(ct(st)))!==Object.prototype&&(et=ot):St=!0),et==null||Rt(function(){var It={};return et[ft].call(It)!==It})?et={}:pt&&(et=bt(et)),ht(et[ft])||mt(et,ft,function(){return this}),it.exports={IteratorPrototype:et,BUGGY_SAFARI_ITERATORS:St}},7497:it=>{it.exports={}},6244:(it,ut,s)=>{var et=s(7466);it.exports=function(ot){return et(ot.length)}},6339:(it,ut,s)=>{var et=s(7293),ot=s(614),st=s(2597),Rt=s(9781),ht=s(6530).CONFIGURABLE,bt=s(2788),ct=s(9909),mt=ct.enforce,rt=ct.get,pt=Object.defineProperty,ft=Rt&&!et(function(){return pt(function(){},"length",{value:8}).length!==8}),St=String(String).split("String"),It=it.exports=function(xt,At,Dt){String(At).slice(0,7)==="Symbol("&&(At="["+String(At).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),Dt&&Dt.getter&&(At="get "+At),Dt&&Dt.setter&&(At="set "+At),(!st(xt,"name")||ht&&xt.name!==At)&&(Rt?pt(xt,"name",{value:At,configurable:!0}):xt.name=At),ft&&Dt&&st(Dt,"arity")&&xt.length!==Dt.arity&&pt(xt,"length",{value:Dt.arity});try{Dt&&st(Dt,"constructor")&&Dt.constructor?Rt&&pt(xt,"prototype",{writable:!1}):xt.prototype&&(xt.prototype=void 0)}catch{}var wt=mt(xt);return st(wt,"source")||(wt.source=St.join(typeof At=="string"?At:"")),xt};Function.prototype.toString=It(function(){return ot(this)&&rt(this).source||bt(this)},"toString")},403:it=>{var ut=Math.log,s=Math.LOG10E;it.exports=Math.log10||function(et){return ut(et)*s}},4758:it=>{var ut=Math.ceil,s=Math.floor;it.exports=Math.trunc||function(et){var ot=+et;return(ot>0?s:ut)(ot)}},5948:(it,ut,s)=>{var et,ot,st,Rt,ht,bt,ct,mt,rt=s(7854),pt=s(9974),ft=s(1236).f,St=s(261).set,It=s(6833),xt=s(1528),At=s(1036),Dt=s(2805),wt=rt.MutationObserver||rt.WebKitMutationObserver,Mt=rt.document,vt=rt.process,Ft=rt.Promise,Ht=ft(rt,"queueMicrotask"),Wt=Ht&&Ht.value;Wt||(et=function(){var tn,gn;for(Dt&&(tn=vt.domain)&&tn.exit();ot;){gn=ot.fn,ot=ot.next;try{gn()}catch(nn){throw ot?Rt():st=void 0,nn}}st=void 0,tn&&tn.enter()},It||Dt||At||!wt||!Mt?!xt&&Ft&&Ft.resolve?((ct=Ft.resolve(void 0)).constructor=Ft,mt=pt(ct.then,ct),Rt=function(){mt(et)}):Dt?Rt=function(){vt.nextTick(et)}:(St=pt(St,rt),Rt=function(){St(et)}):(ht=!0,bt=Mt.createTextNode(""),new wt(et).observe(bt,{characterData:!0}),Rt=function(){bt.data=ht=!ht})),it.exports=Wt||function(tn){var gn={fn:tn,next:void 0};st&&(st.next=gn),ot||(ot=gn,Rt()),st=gn}},735:(it,ut,s)=>{var et=s(133);it.exports=et&&!!Symbol.for&&!!Symbol.keyFor},133:(it,ut,s)=>{var et=s(7392),ot=s(7293);it.exports=!!Object.getOwnPropertySymbols&&!ot(function(){var st=Symbol();return!String(st)||!(Object(st)instanceof Symbol)||!Symbol.sham&&et&&et<41})},590:(it,ut,s)=>{var et=s(7293),ot=s(5112),st=s(1913),Rt=ot("iterator");it.exports=!et(function(){var ht=new URL("b?a=1&b=2&c=3","http://a"),bt=ht.searchParams,ct="";return ht.pathname="c%20d",bt.forEach(function(mt,rt){bt.delete("b"),ct+=rt+mt}),st&&!ht.toJSON||!bt.sort||ht.href!=="http://a/c%20d?a=1&c=3"||bt.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!bt[Rt]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||ct!=="a1c3"||new URL("http://x",void 0).host!=="x"})},8536:(it,ut,s)=>{var et=s(7854),ot=s(614),st=s(2788),Rt=et.WeakMap;it.exports=ot(Rt)&&/native code/.test(st(Rt))},8523:(it,ut,s)=>{var et=s(9662),ot=function(st){var Rt,ht;this.promise=new st(function(bt,ct){if(Rt!==void 0||ht!==void 0)throw TypeError("Bad Promise constructor");Rt=bt,ht=ct}),this.resolve=et(Rt),this.reject=et(ht)};it.exports.f=function(st){return new ot(st)}},3929:(it,ut,s)=>{var et=s(7850),ot=TypeError;it.exports=function(st){if(et(st))throw ot("The method doesn't accept regular expressions");return st}},3009:(it,ut,s)=>{var et=s(7854),ot=s(7293),st=s(1702),Rt=s(1340),ht=s(3111).trim,bt=s(1361),ct=et.parseInt,mt=et.Symbol,rt=mt&&mt.iterator,pt=/^[+-]?0x/i,ft=st(pt.exec),St=ct(bt+"08")!==8||ct(bt+"0x16")!==22||rt&&!ot(function(){ct(Object(rt))});it.exports=St?function(It,xt){var At=ht(Rt(It));return ct(At,xt>>>0||(ft(pt,At)?16:10))}:ct},1574:(it,ut,s)=>{var et=s(9781),ot=s(1702),st=s(6916),Rt=s(7293),ht=s(1956),bt=s(5181),ct=s(5296),mt=s(7908),rt=s(8361),pt=Object.assign,ft=Object.defineProperty,St=ot([].concat);it.exports=!pt||Rt(function(){if(et&&pt({b:1},pt(ft({},"a",{enumerable:!0,get:function(){ft(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var It={},xt={},At=Symbol(),Dt="abcdefghijklmnopqrst";return It[At]=7,Dt.split("").forEach(function(wt){xt[wt]=wt}),pt({},It)[At]!=7||ht(pt({},xt)).join("")!=Dt})?function(It,xt){for(var At=mt(It),Dt=arguments.length,wt=1,Mt=bt.f,vt=ct.f;Dt>wt;)for(var Ft,Ht=rt(arguments[wt++]),Wt=Mt?St(ht(Ht),Mt(Ht)):ht(Ht),tn=Wt.length,gn=0;tn>gn;)Ft=Wt[gn++],et&&!st(vt,Ht,Ft)||(At[Ft]=Ht[Ft]);return At}:pt},30:(it,ut,s)=>{var et,ot=s(9670),st=s(6048),Rt=s(748),ht=s(3501),bt=s(490),ct=s(317),mt=s(6200)("IE_PROTO"),rt=function(){},pt=function(It){return"<script>"+It+"<\/script>"},ft=function(It){It.write(pt("")),It.close();var xt=It.parentWindow.Object;return It=null,xt},St=function(){try{et=new ActiveXObject("htmlfile")}catch{}var It,xt;St=typeof document<"u"?document.domain&&et?ft(et):((xt=ct("iframe")).style.display="none",bt.appendChild(xt),xt.src="javascript:",(It=xt.contentWindow.document).open(),It.write(pt("document.F=Object")),It.close(),It.F):ft(et);for(var At=Rt.length;At--;)delete St.prototype[Rt[At]];return St()};ht[mt]=!0,it.exports=Object.create||function(It,xt){var At;return It!==null?(rt.prototype=ot(It),At=new rt,rt.prototype=null,At[mt]=It):At=St(),xt===void 0?At:st.f(At,xt)}},6048:(it,ut,s)=>{var et=s(9781),ot=s(3353),st=s(3070),Rt=s(9670),ht=s(5656),bt=s(1956);ut.f=et&&!ot?Object.defineProperties:function(ct,mt){Rt(ct);for(var rt,pt=ht(mt),ft=bt(mt),St=ft.length,It=0;St>It;)st.f(ct,rt=ft[It++],pt[rt]);return ct}},3070:(it,ut,s)=>{var et=s(9781),ot=s(4664),st=s(3353),Rt=s(9670),ht=s(4948),bt=TypeError,ct=Object.defineProperty,mt=Object.getOwnPropertyDescriptor;ut.f=et?st?function(rt,pt,ft){if(Rt(rt),pt=ht(pt),Rt(ft),typeof rt=="function"&&pt==="prototype"&&"value"in ft&&"writable"in ft&&!ft.writable){var St=mt(rt,pt);St&&St.writable&&(rt[pt]=ft.value,ft={configurable:"configurable"in ft?ft.configurable:St.configurable,enumerable:"enumerable"in ft?ft.enumerable:St.enumerable,writable:!1})}return ct(rt,pt,ft)}:ct:function(rt,pt,ft){if(Rt(rt),pt=ht(pt),Rt(ft),ot)try{return ct(rt,pt,ft)}catch{}if("get"in ft||"set"in ft)throw bt("Accessors not supported");return"value"in ft&&(rt[pt]=ft.value),rt}},1236:(it,ut,s)=>{var et=s(9781),ot=s(6916),st=s(5296),Rt=s(9114),ht=s(5656),bt=s(4948),ct=s(2597),mt=s(4664),rt=Object.getOwnPropertyDescriptor;ut.f=et?rt:function(pt,ft){if(pt=ht(pt),ft=bt(ft),mt)try{return rt(pt,ft)}catch{}if(ct(pt,ft))return Rt(!ot(st.f,pt,ft),pt[ft])}},1156:(it,ut,s)=>{var et=s(4326),ot=s(5656),st=s(8006).f,Rt=s(1589),ht=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];it.exports.f=function(bt){return ht&&et(bt)=="Window"?function(ct){try{return st(ct)}catch{return Rt(ht)}}(bt):st(ot(bt))}},8006:(it,ut,s)=>{var et=s(6324),ot=s(748).concat("length","prototype");ut.f=Object.getOwnPropertyNames||function(st){return et(st,ot)}},5181:(it,ut)=>{ut.f=Object.getOwnPropertySymbols},9518:(it,ut,s)=>{var et=s(2597),ot=s(614),st=s(7908),Rt=s(6200),ht=s(8544),bt=Rt("IE_PROTO"),ct=Object,mt=ct.prototype;it.exports=ht?ct.getPrototypeOf:function(rt){var pt=st(rt);if(et(pt,bt))return pt[bt];var ft=pt.constructor;return ot(ft)&&pt instanceof ft?ft.prototype:pt instanceof ct?mt:null}},2050:(it,ut,s)=>{var et=s(7293),ot=s(111),st=s(4326),Rt=s(7556),ht=Object.isExtensible,bt=et(function(){});it.exports=bt||Rt?function(ct){return!!ot(ct)&&(!Rt||st(ct)!="ArrayBuffer")&&(!ht||ht(ct))}:ht},7976:(it,ut,s)=>{var et=s(1702);it.exports=et({}.isPrototypeOf)},6324:(it,ut,s)=>{var et=s(1702),ot=s(2597),st=s(5656),Rt=s(1318).indexOf,ht=s(3501),bt=et([].push);it.exports=function(ct,mt){var rt,pt=st(ct),ft=0,St=[];for(rt in pt)!ot(ht,rt)&&ot(pt,rt)&&bt(St,rt);for(;mt.length>ft;)ot(pt,rt=mt[ft++])&&(~Rt(St,rt)||bt(St,rt));return St}},1956:(it,ut,s)=>{var et=s(6324),ot=s(748);it.exports=Object.keys||function(st){return et(st,ot)}},5296:(it,ut)=>{var s={}.propertyIsEnumerable,et=Object.getOwnPropertyDescriptor,ot=et&&!s.call({1:2},1);ut.f=ot?function(st){var Rt=et(this,st);return!!Rt&&Rt.enumerable}:s},7674:(it,ut,s)=>{var et=s(1702),ot=s(9670),st=s(6077);it.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var Rt,ht=!1,bt={};try{(Rt=et(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(bt,[]),ht=bt instanceof Array}catch{}return function(ct,mt){return ot(ct),st(mt),ht?Rt(ct,mt):ct.__proto__=mt,ct}}():void 0)},4699:(it,ut,s)=>{var et=s(9781),ot=s(1702),st=s(1956),Rt=s(5656),ht=ot(s(5296).f),bt=ot([].push),ct=function(mt){return function(rt){for(var pt,ft=Rt(rt),St=st(ft),It=St.length,xt=0,At=[];It>xt;)pt=St[xt++],et&&!ht(ft,pt)||bt(At,mt?[pt,ft[pt]]:ft[pt]);return At}};it.exports={entries:ct(!0),values:ct(!1)}},288:(it,ut,s)=>{var et=s(1694),ot=s(648);it.exports=et?{}.toString:function(){return"[object "+ot(this)+"]"}},2140:(it,ut,s)=>{var et=s(6916),ot=s(614),st=s(111),Rt=TypeError;it.exports=function(ht,bt){var ct,mt;if(bt==="string"&&ot(ct=ht.toString)&&!st(mt=et(ct,ht))||ot(ct=ht.valueOf)&&!st(mt=et(ct,ht))||bt!=="string"&&ot(ct=ht.toString)&&!st(mt=et(ct,ht)))return mt;throw Rt("Can't convert object to primitive value")}},3887:(it,ut,s)=>{var et=s(5005),ot=s(1702),st=s(8006),Rt=s(5181),ht=s(9670),bt=ot([].concat);it.exports=et("Reflect","ownKeys")||function(ct){var mt=st.f(ht(ct)),rt=Rt.f;return rt?bt(mt,rt(ct)):mt}},857:(it,ut,s)=>{var et=s(7854);it.exports=et},2534:it=>{it.exports=function(ut){try{return{error:!1,value:ut()}}catch(s){return{error:!0,value:s}}}},3702:(it,ut,s)=>{var et=s(7854),ot=s(2492),st=s(614),Rt=s(4705),ht=s(2788),bt=s(5112),ct=s(7871),mt=s(1913),rt=s(7392),pt=ot&&ot.prototype,ft=bt("species"),St=!1,It=st(et.PromiseRejectionEvent),xt=Rt("Promise",function(){var At=ht(ot),Dt=At!==String(ot);if(!Dt&&rt===66||mt&&(!pt.catch||!pt.finally))return!0;if(rt>=51&&/native code/.test(At))return!1;var wt=new ot(function(vt){vt(1)}),Mt=function(vt){vt(function(){},function(){})};return(wt.constructor={})[ft]=Mt,!(St=wt.then(function(){})instanceof Mt)||!Dt&&ct&&!It});it.exports={CONSTRUCTOR:xt,REJECTION_EVENT:It,SUBCLASSING:St}},2492:(it,ut,s)=>{var et=s(7854);it.exports=et.Promise},9478:(it,ut,s)=>{var et=s(9670),ot=s(111),st=s(8523);it.exports=function(Rt,ht){if(et(Rt),ot(ht)&&ht.constructor===Rt)return ht;var bt=st.f(Rt);return(0,bt.resolve)(ht),bt.promise}},612:(it,ut,s)=>{var et=s(2492),ot=s(7072),st=s(3702).CONSTRUCTOR;it.exports=st||!ot(function(Rt){et.all(Rt).then(void 0,function(){})})},2626:(it,ut,s)=>{var et=s(3070).f;it.exports=function(ot,st,Rt){Rt in ot||et(ot,Rt,{configurable:!0,get:function(){return st[Rt]},set:function(ht){st[Rt]=ht}})}},8572:it=>{var ut=function(){this.head=null,this.tail=null};ut.prototype={add:function(s){var et={item:s,next:null};this.head?this.tail.next=et:this.head=et,this.tail=et},get:function(){var s=this.head;if(s)return this.head=s.next,this.tail===s&&(this.tail=null),s.item}},it.exports=ut},7651:(it,ut,s)=>{var et=s(6916),ot=s(9670),st=s(614),Rt=s(4326),ht=s(2261),bt=TypeError;it.exports=function(ct,mt){var rt=ct.exec;if(st(rt)){var pt=et(rt,ct,mt);return pt!==null&&ot(pt),pt}if(Rt(ct)==="RegExp")return et(ht,ct,mt);throw bt("RegExp#exec called on incompatible receiver")}},2261:(it,ut,s)=>{var et,ot,st=s(6916),Rt=s(1702),ht=s(1340),bt=s(7066),ct=s(2999),mt=s(2309),rt=s(30),pt=s(9909).get,ft=s(9441),St=s(7168),It=mt("native-string-replace",String.prototype.replace),xt=RegExp.prototype.exec,At=xt,Dt=Rt("".charAt),wt=Rt("".indexOf),Mt=Rt("".replace),vt=Rt("".slice),Ft=(ot=/b*/g,st(xt,et=/a/,"a"),st(xt,ot,"a"),et.lastIndex!==0||ot.lastIndex!==0),Ht=ct.BROKEN_CARET,Wt=/()??/.exec("")[1]!==void 0;(Ft||Wt||Ht||ft||St)&&(At=function(tn){var gn,nn,qt,fn,Cn,Tn,un,mn=this,yn=pt(mn),pn=ht(tn),In=yn.raw;if(In)return In.lastIndex=mn.lastIndex,gn=st(At,In,pn),mn.lastIndex=In.lastIndex,gn;var kn=yn.groups,Mn=Ht&&mn.sticky,xn=st(bt,mn),Pn=mn.source,On=0,Dn=pn;if(Mn&&(xn=Mt(xn,"y",""),wt(xn,"g")===-1&&(xn+="g"),Dn=vt(pn,mn.lastIndex),mn.lastIndex>0&&(!mn.multiline||mn.multiline&&Dt(pn,mn.lastIndex-1)!==`
`)&&(Pn="(?: "+Pn+")",Dn=" "+Dn,On++),nn=new RegExp("^(?:"+Pn+")",xn)),Wt&&(nn=new RegExp("^"+Pn+"$(?!\\s)",xn)),Ft&&(qt=mn.lastIndex),fn=st(xt,Mn?nn:mn,Dn),Mn?fn?(fn.input=vt(fn.input,On),fn[0]=vt(fn[0],On),fn.index=mn.lastIndex,mn.lastIndex+=fn[0].length):mn.lastIndex=0:Ft&&fn&&(mn.lastIndex=mn.global?fn.index+fn[0].length:qt),Wt&&fn&&fn.length>1&&st(It,fn[0],nn,function(){for(Cn=1;Cn<arguments.length-2;Cn++)arguments[Cn]===void 0&&(fn[Cn]=void 0)}),fn&&kn)for(fn.groups=Tn=rt(null),Cn=0;Cn<kn.length;Cn++)Tn[(un=kn[Cn])[0]]=fn[un[1]];return fn}),it.exports=At},7066:(it,ut,s)=>{var et=s(9670);it.exports=function(){var ot=et(this),st="";return ot.hasIndices&&(st+="d"),ot.global&&(st+="g"),ot.ignoreCase&&(st+="i"),ot.multiline&&(st+="m"),ot.dotAll&&(st+="s"),ot.unicode&&(st+="u"),ot.unicodeSets&&(st+="v"),ot.sticky&&(st+="y"),st}},4706:(it,ut,s)=>{var et=s(6916),ot=s(2597),st=s(7976),Rt=s(7066),ht=RegExp.prototype;it.exports=function(bt){var ct=bt.flags;return ct!==void 0||"flags"in ht||ot(bt,"flags")||!st(ht,bt)?ct:et(Rt,bt)}},2999:(it,ut,s)=>{var et=s(7293),ot=s(7854).RegExp,st=et(function(){var bt=ot("a","y");return bt.lastIndex=2,bt.exec("abcd")!=null}),Rt=st||et(function(){return!ot("a","y").sticky}),ht=st||et(function(){var bt=ot("^r","gy");return bt.lastIndex=2,bt.exec("str")!=null});it.exports={BROKEN_CARET:ht,MISSED_STICKY:Rt,UNSUPPORTED_Y:st}},9441:(it,ut,s)=>{var et=s(7293),ot=s(7854).RegExp;it.exports=et(function(){var st=ot(".","s");return!(st.dotAll&&st.exec(`
`)&&st.flags==="s")})},7168:(it,ut,s)=>{var et=s(7293),ot=s(7854).RegExp;it.exports=et(function(){var st=ot("(?<a>b)","g");return st.exec("b").groups.a!=="b"||"b".replace(st,"$<a>c")!=="bc"})},4488:it=>{var ut=TypeError;it.exports=function(s){if(s==null)throw ut("Can't call method on "+s);return s}},1150:it=>{it.exports=Object.is||function(ut,s){return ut===s?ut!==0||1/ut==1/s:ut!=ut&&s!=s}},7152:(it,ut,s)=>{var et=s(7854),ot=s(2104),st=s(614),Rt=s(8113),ht=s(206),bt=s(8053),ct=/MSIE .\./.test(Rt),mt=et.Function,rt=function(pt){return ct?function(ft,St){var It=bt(arguments.length,1)>2,xt=st(ft)?ft:mt(ft),At=It?ht(arguments,2):void 0;return pt(It?function(){ot(xt,this,At)}:xt,St)}:pt};it.exports={setTimeout:rt(et.setTimeout),setInterval:rt(et.setInterval)}},6340:(it,ut,s)=>{var et=s(5005),ot=s(3070),st=s(5112),Rt=s(9781),ht=st("species");it.exports=function(bt){var ct=et(bt),mt=ot.f;Rt&&ct&&!ct[ht]&&mt(ct,ht,{configurable:!0,get:function(){return this}})}},8003:(it,ut,s)=>{var et=s(3070).f,ot=s(2597),st=s(5112)("toStringTag");it.exports=function(Rt,ht,bt){Rt&&!bt&&(Rt=Rt.prototype),Rt&&!ot(Rt,st)&&et(Rt,st,{configurable:!0,value:ht})}},6200:(it,ut,s)=>{var et=s(2309),ot=s(9711),st=et("keys");it.exports=function(Rt){return st[Rt]||(st[Rt]=ot(Rt))}},5465:(it,ut,s)=>{var et=s(7854),ot=s(3072),st="__core-js_shared__",Rt=et[st]||ot(st,{});it.exports=Rt},2309:(it,ut,s)=>{var et=s(1913),ot=s(5465);(it.exports=function(st,Rt){return ot[st]||(ot[st]=Rt!==void 0?Rt:{})})("versions",[]).push({version:"3.23.4",mode:et?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.4/LICENSE",source:"https://github.com/zloirock/core-js"})},6707:(it,ut,s)=>{var et=s(9670),ot=s(9483),st=s(5112)("species");it.exports=function(Rt,ht){var bt,ct=et(Rt).constructor;return ct===void 0||(bt=et(ct)[st])==null?ht:ot(bt)}},8710:(it,ut,s)=>{var et=s(1702),ot=s(9303),st=s(1340),Rt=s(4488),ht=et("".charAt),bt=et("".charCodeAt),ct=et("".slice),mt=function(rt){return function(pt,ft){var St,It,xt=st(Rt(pt)),At=ot(ft),Dt=xt.length;return At<0||At>=Dt?rt?"":void 0:(St=bt(xt,At))<55296||St>56319||At+1===Dt||(It=bt(xt,At+1))<56320||It>57343?rt?ht(xt,At):St:rt?ct(xt,At,At+2):It-56320+(St-55296<<10)+65536}};it.exports={codeAt:mt(!1),charAt:mt(!0)}},6650:(it,ut,s)=>{var et=s(1702),ot=s(7466),st=s(1340),Rt=s(8415),ht=s(4488),bt=et(Rt),ct=et("".slice),mt=Math.ceil,rt=function(pt){return function(ft,St,It){var xt,At,Dt=st(ht(ft)),wt=ot(St),Mt=Dt.length,vt=It===void 0?" ":st(It);return wt<=Mt||vt==""?Dt:((At=bt(vt,mt((xt=wt-Mt)/vt.length))).length>xt&&(At=ct(At,0,xt)),pt?Dt+At:At+Dt)}};it.exports={start:rt(!1),end:rt(!0)}},3197:(it,ut,s)=>{var et=s(1702),ot=2147483647,st=/[^\0-\u007E]/,Rt=/[.\u3002\uFF0E\uFF61]/g,ht="Overflow: input needs wider integers to process",bt=RangeError,ct=et(Rt.exec),mt=Math.floor,rt=String.fromCharCode,pt=et("".charCodeAt),ft=et([].join),St=et([].push),It=et("".replace),xt=et("".split),At=et("".toLowerCase),Dt=function(vt){return vt+22+75*(vt<26)},wt=function(vt,Ft,Ht){var Wt=0;for(vt=Ht?mt(vt/700):vt>>1,vt+=mt(vt/Ft);vt>455;)vt=mt(vt/35),Wt+=36;return mt(Wt+36*vt/(vt+38))},Mt=function(vt){var Ft=[];vt=function(Mn){for(var xn=[],Pn=0,On=Mn.length;Pn<On;){var Dn=pt(Mn,Pn++);if(Dn>=55296&&Dn<=56319&&Pn<On){var Fn=pt(Mn,Pn++);(64512&Fn)==56320?St(xn,((1023&Dn)<<10)+(1023&Fn)+65536):(St(xn,Dn),Pn--)}else St(xn,Dn)}return xn}(vt);var Ht,Wt,tn=vt.length,gn=128,nn=0,qt=72;for(Ht=0;Ht<vt.length;Ht++)(Wt=vt[Ht])<128&&St(Ft,rt(Wt));var fn=Ft.length,Cn=fn;for(fn&&St(Ft,"-");Cn<tn;){var Tn=ot;for(Ht=0;Ht<vt.length;Ht++)(Wt=vt[Ht])>=gn&&Wt<Tn&&(Tn=Wt);var un=Cn+1;if(Tn-gn>mt((ot-nn)/un))throw bt(ht);for(nn+=(Tn-gn)*un,gn=Tn,Ht=0;Ht<vt.length;Ht++){if((Wt=vt[Ht])<gn&&++nn>ot)throw bt(ht);if(Wt==gn){for(var mn=nn,yn=36;;){var pn=yn<=qt?1:yn>=qt+26?26:yn-qt;if(mn<pn)break;var In=mn-pn,kn=36-pn;St(Ft,rt(Dt(pn+In%kn))),mn=mt(In/kn),yn+=36}St(Ft,rt(Dt(mn))),qt=wt(nn,un,Cn==fn),nn=0,Cn++}}nn++,gn++}return ft(Ft,"")};it.exports=function(vt){var Ft,Ht,Wt=[],tn=xt(It(At(vt),Rt,"."),".");for(Ft=0;Ft<tn.length;Ft++)Ht=tn[Ft],St(Wt,ct(st,Ht)?"xn--"+Mt(Ht):Ht);return ft(Wt,".")}},8415:(it,ut,s)=>{var et=s(9303),ot=s(1340),st=s(4488),Rt=RangeError;it.exports=function(ht){var bt=ot(st(this)),ct="",mt=et(ht);if(mt<0||mt==1/0)throw Rt("Wrong number of repetitions");for(;mt>0;(mt>>>=1)&&(bt+=bt))1&mt&&(ct+=bt);return ct}},3111:(it,ut,s)=>{var et=s(1702),ot=s(4488),st=s(1340),Rt=s(1361),ht=et("".replace),bt="["+Rt+"]",ct=RegExp("^"+bt+bt+"*"),mt=RegExp(bt+bt+"*$"),rt=function(pt){return function(ft){var St=st(ot(ft));return 1&pt&&(St=ht(St,ct,"")),2&pt&&(St=ht(St,mt,"")),St}};it.exports={start:rt(1),end:rt(2),trim:rt(3)}},6532:(it,ut,s)=>{var et=s(6916),ot=s(5005),st=s(5112),Rt=s(8052);it.exports=function(){var ht=ot("Symbol"),bt=ht&&ht.prototype,ct=bt&&bt.valueOf,mt=st("toPrimitive");bt&&!bt[mt]&&Rt(bt,mt,function(rt){return et(ct,this)},{arity:1})}},261:(it,ut,s)=>{var et,ot,st,Rt,ht=s(7854),bt=s(2104),ct=s(9974),mt=s(614),rt=s(2597),pt=s(7293),ft=s(490),St=s(206),It=s(317),xt=s(8053),At=s(6833),Dt=s(2805),wt=ht.setImmediate,Mt=ht.clearImmediate,vt=ht.process,Ft=ht.Dispatch,Ht=ht.Function,Wt=ht.MessageChannel,tn=ht.String,gn=0,nn={};try{et=ht.location}catch{}var qt=function(un){if(rt(nn,un)){var mn=nn[un];delete nn[un],mn()}},fn=function(un){return function(){qt(un)}},Cn=function(un){qt(un.data)},Tn=function(un){ht.postMessage(tn(un),et.protocol+"//"+et.host)};wt&&Mt||(wt=function(un){xt(arguments.length,1);var mn=mt(un)?un:Ht(un),yn=St(arguments,1);return nn[++gn]=function(){bt(mn,void 0,yn)},ot(gn),gn},Mt=function(un){delete nn[un]},Dt?ot=function(un){vt.nextTick(fn(un))}:Ft&&Ft.now?ot=function(un){Ft.now(fn(un))}:Wt&&!At?(Rt=(st=new Wt).port2,st.port1.onmessage=Cn,ot=ct(Rt.postMessage,Rt)):ht.addEventListener&&mt(ht.postMessage)&&!ht.importScripts&&et&&et.protocol!=="file:"&&!pt(Tn)?(ot=Tn,ht.addEventListener("message",Cn,!1)):ot="onreadystatechange"in It("script")?function(un){ft.appendChild(It("script")).onreadystatechange=function(){ft.removeChild(this),qt(un)}}:function(un){setTimeout(fn(un),0)}),it.exports={set:wt,clear:Mt}},863:(it,ut,s)=>{var et=s(1702);it.exports=et(1 .valueOf)},1400:(it,ut,s)=>{var et=s(9303),ot=Math.max,st=Math.min;it.exports=function(Rt,ht){var bt=et(Rt);return bt<0?ot(bt+ht,0):st(bt,ht)}},4599:(it,ut,s)=>{var et=s(7593),ot=TypeError;it.exports=function(st){var Rt=et(st,"number");if(typeof Rt=="number")throw ot("Can't convert number to bigint");return BigInt(Rt)}},7067:(it,ut,s)=>{var et=s(9303),ot=s(7466),st=RangeError;it.exports=function(Rt){if(Rt===void 0)return 0;var ht=et(Rt),bt=ot(ht);if(ht!==bt)throw st("Wrong length or index");return bt}},5656:(it,ut,s)=>{var et=s(8361),ot=s(4488);it.exports=function(st){return et(ot(st))}},9303:(it,ut,s)=>{var et=s(4758);it.exports=function(ot){var st=+ot;return st!=st||st===0?0:et(st)}},7466:(it,ut,s)=>{var et=s(9303),ot=Math.min;it.exports=function(st){return st>0?ot(et(st),9007199254740991):0}},7908:(it,ut,s)=>{var et=s(4488),ot=Object;it.exports=function(st){return ot(et(st))}},4590:(it,ut,s)=>{var et=s(3002),ot=RangeError;it.exports=function(st,Rt){var ht=et(st);if(ht%Rt)throw ot("Wrong offset");return ht}},3002:(it,ut,s)=>{var et=s(9303),ot=RangeError;it.exports=function(st){var Rt=et(st);if(Rt<0)throw ot("The argument can't be less than 0");return Rt}},7593:(it,ut,s)=>{var et=s(6916),ot=s(111),st=s(2190),Rt=s(8173),ht=s(2140),bt=s(5112),ct=TypeError,mt=bt("toPrimitive");it.exports=function(rt,pt){if(!ot(rt)||st(rt))return rt;var ft,St=Rt(rt,mt);if(St){if(pt===void 0&&(pt="default"),ft=et(St,rt,pt),!ot(ft)||st(ft))return ft;throw ct("Can't convert object to primitive value")}return pt===void 0&&(pt="number"),ht(rt,pt)}},4948:(it,ut,s)=>{var et=s(7593),ot=s(2190);it.exports=function(st){var Rt=et(st,"string");return ot(Rt)?Rt:Rt+""}},1694:(it,ut,s)=>{var et={};et[s(5112)("toStringTag")]="z",it.exports=String(et)==="[object z]"},1340:(it,ut,s)=>{var et=s(648),ot=String;it.exports=function(st){if(et(st)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return ot(st)}},6330:it=>{var ut=String;it.exports=function(s){try{return ut(s)}catch{return"Object"}}},9843:(it,ut,s)=>{var et=s(2109),ot=s(7854),st=s(6916),Rt=s(9781),ht=s(3832),bt=s(260),ct=s(3331),mt=s(5787),rt=s(9114),pt=s(8880),ft=s(5988),St=s(7466),It=s(7067),xt=s(4590),At=s(4948),Dt=s(2597),wt=s(648),Mt=s(111),vt=s(2190),Ft=s(30),Ht=s(7976),Wt=s(7674),tn=s(8006).f,gn=s(7321),nn=s(2092).forEach,qt=s(6340),fn=s(3070),Cn=s(1236),Tn=s(9909),un=s(9587),mn=Tn.get,yn=Tn.set,pn=Tn.enforce,In=fn.f,kn=Cn.f,Mn=Math.round,xn=ot.RangeError,Pn=ct.ArrayBuffer,On=Pn.prototype,Dn=ct.DataView,Fn=bt.NATIVE_ARRAY_BUFFER_VIEWS,dr=bt.TYPED_ARRAY_TAG,ir=bt.TypedArray,Xn=bt.TypedArrayPrototype,tr=bt.aTypedArrayConstructor,cn=bt.isTypedArray,Jn="BYTES_PER_ELEMENT",Qn="Wrong length",sr=function(vn,Rn){tr(vn);for(var Gt=0,Tt=Rn.length,nt=new vn(Tt);Tt>Gt;)nt[Gt]=Rn[Gt++];return nt},Bn=function(vn,Rn){In(vn,Rn,{get:function(){return mn(this)[Rn]}})},rr=function(vn){var Rn;return Ht(On,vn)||(Rn=wt(vn))=="ArrayBuffer"||Rn=="SharedArrayBuffer"},nr=function(vn,Rn){return cn(vn)&&!vt(Rn)&&Rn in vn&&ft(+Rn)&&Rn>=0},Nn=function(vn,Rn){return Rn=At(Rn),nr(vn,Rn)?rt(2,vn[Rn]):kn(vn,Rn)},Wn=function(vn,Rn,Gt){return Rn=At(Rn),!(nr(vn,Rn)&&Mt(Gt)&&Dt(Gt,"value"))||Dt(Gt,"get")||Dt(Gt,"set")||Gt.configurable||Dt(Gt,"writable")&&!Gt.writable||Dt(Gt,"enumerable")&&!Gt.enumerable?In(vn,Rn,Gt):(vn[Rn]=Gt.value,vn)};Rt?(Fn||(Cn.f=Nn,fn.f=Wn,Bn(Xn,"buffer"),Bn(Xn,"byteOffset"),Bn(Xn,"byteLength"),Bn(Xn,"length")),et({target:"Object",stat:!0,forced:!Fn},{getOwnPropertyDescriptor:Nn,defineProperty:Wn}),it.exports=function(vn,Rn,Gt){var Tt=vn.match(/\d+$/)[0]/8,nt=vn+(Gt?"Clamped":"")+"Array",Ct="get"+vn,yt="set"+vn,Pt=ot[nt],Et=Pt,Ut=Et&&Et.prototype,Ot={},Bt=function(en,Jt){In(en,Jt,{get:function(){return function(an,hn){var rn=mn(an);return rn.view[Ct](hn*Tt+rn.byteOffset,!0)}(this,Jt)},set:function(an){return function(hn,rn,dn){var Sn=mn(hn);Gt&&(dn=(dn=Mn(dn))<0?0:dn>255?255:255&dn),Sn.view[yt](rn*Tt+Sn.byteOffset,dn,!0)}(this,Jt,an)},enumerable:!0})};Fn?ht&&(Et=Rn(function(en,Jt,an,hn){return mt(en,Ut),un(Mt(Jt)?rr(Jt)?hn!==void 0?new Pt(Jt,xt(an,Tt),hn):an!==void 0?new Pt(Jt,xt(an,Tt)):new Pt(Jt):cn(Jt)?sr(Et,Jt):st(gn,Et,Jt):new Pt(It(Jt)),en,Et)}),Wt&&Wt(Et,ir),nn(tn(Pt),function(en){en in Et||pt(Et,en,Pt[en])}),Et.prototype=Ut):(Et=Rn(function(en,Jt,an,hn){mt(en,Ut);var rn,dn,Sn,wn=0,An=0;if(Mt(Jt)){if(!rr(Jt))return cn(Jt)?sr(Et,Jt):st(gn,Et,Jt);rn=Jt,An=xt(an,Tt);var _n=Jt.byteLength;if(hn===void 0){if(_n%Tt||(dn=_n-An)<0)throw xn(Qn)}else if((dn=St(hn)*Tt)+An>_n)throw xn(Qn);Sn=dn/Tt}else Sn=It(Jt),rn=new Pn(dn=Sn*Tt);for(yn(en,{buffer:rn,byteOffset:An,byteLength:dn,length:Sn,view:new Dn(rn)});wn<Sn;)Bt(en,wn++)}),Wt&&Wt(Et,ir),Ut=Et.prototype=Ft(Xn)),Ut.constructor!==Et&&pt(Ut,"constructor",Et),pn(Ut).TypedArrayConstructor=Et,dr&&pt(Ut,dr,nt);var Qt=Et!=Pt;Ot[nt]=Et,et({global:!0,constructor:!0,forced:Qt,sham:!Fn},Ot),Jn in Et||pt(Et,Jn,Tt),Jn in Ut||pt(Ut,Jn,Tt),qt(nt)}):it.exports=function(){}},3832:(it,ut,s)=>{var et=s(7854),ot=s(7293),st=s(7072),Rt=s(260).NATIVE_ARRAY_BUFFER_VIEWS,ht=et.ArrayBuffer,bt=et.Int8Array;it.exports=!Rt||!ot(function(){bt(1)})||!ot(function(){new bt(-1)})||!st(function(ct){new bt,new bt(null),new bt(1.5),new bt(ct)},!0)||ot(function(){return new bt(new ht(2),1,void 0).length!==1})},3074:(it,ut,s)=>{var et=s(7745),ot=s(6304);it.exports=function(st,Rt){return et(ot(st),Rt)}},7321:(it,ut,s)=>{var et=s(9974),ot=s(6916),st=s(9483),Rt=s(7908),ht=s(6244),bt=s(8554),ct=s(1246),mt=s(7659),rt=s(260).aTypedArrayConstructor;it.exports=function(pt){var ft,St,It,xt,At,Dt,wt=st(this),Mt=Rt(pt),vt=arguments.length,Ft=vt>1?arguments[1]:void 0,Ht=Ft!==void 0,Wt=ct(Mt);if(Wt&&!mt(Wt))for(Dt=(At=bt(Mt,Wt)).next,Mt=[];!(xt=ot(Dt,At)).done;)Mt.push(xt.value);for(Ht&&vt>2&&(Ft=et(Ft,arguments[2])),St=ht(Mt),It=new(rt(wt))(St),ft=0;St>ft;ft++)It[ft]=Ht?Ft(Mt[ft],ft):Mt[ft];return It}},6304:(it,ut,s)=>{var et=s(260),ot=s(6707),st=et.aTypedArrayConstructor,Rt=et.getTypedArrayConstructor;it.exports=function(ht){return st(ot(ht,Rt(ht)))}},9711:(it,ut,s)=>{var et=s(1702),ot=0,st=Math.random(),Rt=et(1 .toString);it.exports=function(ht){return"Symbol("+(ht===void 0?"":ht)+")_"+Rt(++ot+st,36)}},3307:(it,ut,s)=>{var et=s(133);it.exports=et&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3353:(it,ut,s)=>{var et=s(9781),ot=s(7293);it.exports=et&&ot(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},8053:it=>{var ut=TypeError;it.exports=function(s,et){if(s<et)throw ut("Not enough arguments");return s}},6061:(it,ut,s)=>{var et=s(5112);ut.f=et},5112:(it,ut,s)=>{var et=s(7854),ot=s(2309),st=s(2597),Rt=s(9711),ht=s(133),bt=s(3307),ct=ot("wks"),mt=et.Symbol,rt=mt&&mt.for,pt=bt?mt:mt&&mt.withoutSetter||Rt;it.exports=function(ft){if(!st(ct,ft)||!ht&&typeof ct[ft]!="string"){var St="Symbol."+ft;ht&&st(mt,ft)?ct[ft]=mt[ft]:ct[ft]=bt&&rt?rt(St):pt(St)}return ct[ft]}},1361:it=>{it.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},8264:(it,ut,s)=>{var et=s(2109),ot=s(7854),st=s(3331),Rt=s(6340),ht=st.ArrayBuffer;et({global:!0,constructor:!0,forced:ot.ArrayBuffer!==ht},{ArrayBuffer:ht}),Rt("ArrayBuffer")},9575:(it,ut,s)=>{var et=s(2109),ot=s(1702),st=s(7293),Rt=s(3331),ht=s(9670),bt=s(1400),ct=s(7466),mt=s(6707),rt=Rt.ArrayBuffer,pt=Rt.DataView,ft=pt.prototype,St=ot(rt.prototype.slice),It=ot(ft.getUint8),xt=ot(ft.setUint8);et({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:st(function(){return!new rt(2).slice(1,void 0).byteLength})},{slice:function(At,Dt){if(St&&Dt===void 0)return St(ht(this),At);for(var wt=ht(this).byteLength,Mt=bt(At,wt),vt=bt(Dt===void 0?wt:Dt,wt),Ft=new(mt(this,rt))(ct(vt-Mt)),Ht=new pt(this),Wt=new pt(Ft),tn=0;Mt<vt;)xt(Wt,tn++,It(Ht,Mt++));return Ft}})},2222:(it,ut,s)=>{var et=s(2109),ot=s(7293),st=s(3157),Rt=s(111),ht=s(7908),bt=s(6244),ct=s(7207),mt=s(6135),rt=s(5417),pt=s(1194),ft=s(5112),St=s(7392),It=ft("isConcatSpreadable"),xt=St>=51||!ot(function(){var wt=[];return wt[It]=!1,wt.concat()[0]!==wt}),At=pt("concat"),Dt=function(wt){if(!Rt(wt))return!1;var Mt=wt[It];return Mt!==void 0?!!Mt:st(wt)};et({target:"Array",proto:!0,arity:1,forced:!xt||!At},{concat:function(wt){var Mt,vt,Ft,Ht,Wt,tn=ht(this),gn=rt(tn,0),nn=0;for(Mt=-1,Ft=arguments.length;Mt<Ft;Mt++)if(Dt(Wt=Mt===-1?tn:arguments[Mt]))for(Ht=bt(Wt),ct(nn+Ht),vt=0;vt<Ht;vt++,nn++)vt in Wt&&mt(gn,nn,Wt[vt]);else ct(nn+1),mt(gn,nn++,Wt);return gn.length=nn,gn}})},3290:(it,ut,s)=>{var et=s(2109),ot=s(1285),st=s(1223);et({target:"Array",proto:!0},{fill:ot}),st("fill")},7327:(it,ut,s)=>{var et=s(2109),ot=s(2092).filter;et({target:"Array",proto:!0,forced:!s(1194)("filter")},{filter:function(st){return ot(this,st,arguments.length>1?arguments[1]:void 0)}})},4553:(it,ut,s)=>{var et=s(2109),ot=s(2092).findIndex,st=s(1223),Rt="findIndex",ht=!0;Rt in[]&&Array(1).findIndex(function(){ht=!1}),et({target:"Array",proto:!0,forced:ht},{findIndex:function(bt){return ot(this,bt,arguments.length>1?arguments[1]:void 0)}}),st(Rt)},9826:(it,ut,s)=>{var et=s(2109),ot=s(2092).find,st=s(1223),Rt="find",ht=!0;Rt in[]&&Array(1).find(function(){ht=!1}),et({target:"Array",proto:!0,forced:ht},{find:function(bt){return ot(this,bt,arguments.length>1?arguments[1]:void 0)}}),st(Rt)},9554:(it,ut,s)=>{var et=s(2109),ot=s(8533);et({target:"Array",proto:!0,forced:[].forEach!=ot},{forEach:ot})},1038:(it,ut,s)=>{var et=s(2109),ot=s(8457);et({target:"Array",stat:!0,forced:!s(7072)(function(st){Array.from(st)})},{from:ot})},6699:(it,ut,s)=>{var et=s(2109),ot=s(1318).includes,st=s(7293),Rt=s(1223);et({target:"Array",proto:!0,forced:st(function(){return!Array(1).includes()})},{includes:function(ht){return ot(this,ht,arguments.length>1?arguments[1]:void 0)}}),Rt("includes")},2772:(it,ut,s)=>{var et=s(2109),ot=s(1702),st=s(1318).indexOf,Rt=s(9341),ht=ot([].indexOf),bt=!!ht&&1/ht([1],1,-0)<0,ct=Rt("indexOf");et({target:"Array",proto:!0,forced:bt||!ct},{indexOf:function(mt){var rt=arguments.length>1?arguments[1]:void 0;return bt?ht(this,mt,rt)||0:st(this,mt,rt)}})},9753:(it,ut,s)=>{s(2109)({target:"Array",stat:!0},{isArray:s(3157)})},6992:(it,ut,s)=>{var et=s(5656),ot=s(1223),st=s(7497),Rt=s(9909),ht=s(3070).f,bt=s(654),ct=s(1913),mt=s(9781),rt="Array Iterator",pt=Rt.set,ft=Rt.getterFor(rt);it.exports=bt(Array,"Array",function(It,xt){pt(this,{type:rt,target:et(It),index:0,kind:xt})},function(){var It=ft(this),xt=It.target,At=It.kind,Dt=It.index++;return!xt||Dt>=xt.length?(It.target=void 0,{value:void 0,done:!0}):At=="keys"?{value:Dt,done:!1}:At=="values"?{value:xt[Dt],done:!1}:{value:[Dt,xt[Dt]],done:!1}},"values");var St=st.Arguments=st.Array;if(ot("keys"),ot("values"),ot("entries"),!ct&&mt&&St.name!=="values")try{ht(St,"name",{value:"values"})}catch{}},9600:(it,ut,s)=>{var et=s(2109),ot=s(1702),st=s(8361),Rt=s(5656),ht=s(9341),bt=ot([].join),ct=st!=Object,mt=ht("join",",");et({target:"Array",proto:!0,forced:ct||!mt},{join:function(rt){return bt(Rt(this),rt===void 0?",":rt)}})},4986:(it,ut,s)=>{var et=s(2109),ot=s(6583);et({target:"Array",proto:!0,forced:ot!==[].lastIndexOf},{lastIndexOf:ot})},1249:(it,ut,s)=>{var et=s(2109),ot=s(2092).map;et({target:"Array",proto:!0,forced:!s(1194)("map")},{map:function(st){return ot(this,st,arguments.length>1?arguments[1]:void 0)}})},7042:(it,ut,s)=>{var et=s(2109),ot=s(3157),st=s(4411),Rt=s(111),ht=s(1400),bt=s(6244),ct=s(5656),mt=s(6135),rt=s(5112),pt=s(1194),ft=s(206),St=pt("slice"),It=rt("species"),xt=Array,At=Math.max;et({target:"Array",proto:!0,forced:!St},{slice:function(Dt,wt){var Mt,vt,Ft,Ht=ct(this),Wt=bt(Ht),tn=ht(Dt,Wt),gn=ht(wt===void 0?Wt:wt,Wt);if(ot(Ht)&&(Mt=Ht.constructor,(st(Mt)&&(Mt===xt||ot(Mt.prototype))||Rt(Mt)&&(Mt=Mt[It])===null)&&(Mt=void 0),Mt===xt||Mt===void 0))return ft(Ht,tn,gn);for(vt=new(Mt===void 0?xt:Mt)(At(gn-tn,0)),Ft=0;tn<gn;tn++,Ft++)tn in Ht&&mt(vt,Ft,Ht[tn]);return vt.length=Ft,vt}})},2707:(it,ut,s)=>{var et=s(2109),ot=s(1702),st=s(9662),Rt=s(7908),ht=s(6244),bt=s(5117),ct=s(1340),mt=s(7293),rt=s(4362),pt=s(9341),ft=s(8886),St=s(256),It=s(7392),xt=s(8008),At=[],Dt=ot(At.sort),wt=ot(At.push),Mt=mt(function(){At.sort(void 0)}),vt=mt(function(){At.sort(null)}),Ft=pt("sort"),Ht=!mt(function(){if(It)return It<70;if(!(ft&&ft>3)){if(St)return!0;if(xt)return xt<603;var Wt,tn,gn,nn,qt="";for(Wt=65;Wt<76;Wt++){switch(tn=String.fromCharCode(Wt),Wt){case 66:case 69:case 70:case 72:gn=3;break;case 68:case 71:gn=4;break;default:gn=2}for(nn=0;nn<47;nn++)At.push({k:tn+nn,v:gn})}for(At.sort(function(fn,Cn){return Cn.v-fn.v}),nn=0;nn<At.length;nn++)tn=At[nn].k.charAt(0),qt.charAt(qt.length-1)!==tn&&(qt+=tn);return qt!=="DGBEFHACIJK"}});et({target:"Array",proto:!0,forced:Mt||!vt||!Ft||!Ht},{sort:function(Wt){Wt!==void 0&&st(Wt);var tn=Rt(this);if(Ht)return Wt===void 0?Dt(tn):Dt(tn,Wt);var gn,nn,qt=[],fn=ht(tn);for(nn=0;nn<fn;nn++)nn in tn&&wt(qt,tn[nn]);for(rt(qt,function(Cn){return function(Tn,un){return un===void 0?-1:Tn===void 0?1:Cn!==void 0?+Cn(Tn,un)||0:ct(Tn)>ct(un)?1:-1}}(Wt)),gn=qt.length,nn=0;nn<gn;)tn[nn]=qt[nn++];for(;nn<fn;)bt(tn,nn++);return tn}})},561:(it,ut,s)=>{var et=s(2109),ot=s(7908),st=s(1400),Rt=s(9303),ht=s(6244),bt=s(7207),ct=s(5417),mt=s(6135),rt=s(5117),pt=s(1194)("splice"),ft=Math.max,St=Math.min;et({target:"Array",proto:!0,forced:!pt},{splice:function(It,xt){var At,Dt,wt,Mt,vt,Ft,Ht=ot(this),Wt=ht(Ht),tn=st(It,Wt),gn=arguments.length;for(gn===0?At=Dt=0:gn===1?(At=0,Dt=Wt-tn):(At=gn-2,Dt=St(ft(Rt(xt),0),Wt-tn)),bt(Wt+At-Dt),wt=ct(Ht,Dt),Mt=0;Mt<Dt;Mt++)(vt=tn+Mt)in Ht&&mt(wt,Mt,Ht[vt]);if(wt.length=Dt,At<Dt){for(Mt=tn;Mt<Wt-Dt;Mt++)Ft=Mt+At,(vt=Mt+Dt)in Ht?Ht[Ft]=Ht[vt]:rt(Ht,Ft);for(Mt=Wt;Mt>Wt-Dt+At;Mt--)rt(Ht,Mt-1)}else if(At>Dt)for(Mt=Wt-Dt;Mt>tn;Mt--)Ft=Mt+At-1,(vt=Mt+Dt-1)in Ht?Ht[Ft]=Ht[vt]:rt(Ht,Ft);for(Mt=0;Mt<At;Mt++)Ht[Mt+tn]=arguments[Mt+2];return Ht.length=Wt-Dt+At,wt}})},3690:(it,ut,s)=>{var et=s(2109),ot=s(3331);et({global:!0,constructor:!0,forced:!s(4019)},{DataView:ot.DataView})},6716:(it,ut,s)=>{s(3690)},3843:(it,ut,s)=>{var et=s(2109),ot=s(1702),st=Date,Rt=ot(st.prototype.getTime);et({target:"Date",stat:!0},{now:function(){return Rt(new st)}})},5268:(it,ut,s)=>{var et=s(2109),ot=s(5573);et({target:"Date",proto:!0,forced:Date.prototype.toISOString!==ot},{toISOString:ot})},5735:(it,ut,s)=>{var et=s(2109),ot=s(7293),st=s(7908),Rt=s(7593);et({target:"Date",proto:!0,arity:1,forced:ot(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1})},{toJSON:function(ht){var bt=st(this),ct=Rt(bt,"number");return typeof ct!="number"||isFinite(ct)?bt.toISOString():null}})},3710:(it,ut,s)=>{var et=s(1702),ot=s(8052),st=Date.prototype,Rt="Invalid Date",ht=et(st.toString),bt=et(st.getTime);String(new Date(NaN))!=Rt&&ot(st,"toString",function(){var ct=bt(this);return ct==ct?ht(this):Rt})},4812:(it,ut,s)=>{var et=s(2109),ot=s(7065);et({target:"Function",proto:!0,forced:Function.bind!==ot},{bind:ot})},8309:(it,ut,s)=>{var et=s(9781),ot=s(6530).EXISTS,st=s(1702),Rt=s(3070).f,ht=Function.prototype,bt=st(ht.toString),ct=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,mt=st(ct.exec);et&&!ot&&Rt(ht,"name",{configurable:!0,get:function(){try{return mt(ct,bt(this))[1]}catch{return""}}})},8862:(it,ut,s)=>{var et=s(2109),ot=s(5005),st=s(2104),Rt=s(6916),ht=s(1702),bt=s(7293),ct=s(3157),mt=s(614),rt=s(111),pt=s(2190),ft=s(206),St=s(133),It=ot("JSON","stringify"),xt=ht(/./.exec),At=ht("".charAt),Dt=ht("".charCodeAt),wt=ht("".replace),Mt=ht(1 .toString),vt=/[\uD800-\uDFFF]/g,Ft=/^[\uD800-\uDBFF]$/,Ht=/^[\uDC00-\uDFFF]$/,Wt=!St||bt(function(){var qt=ot("Symbol")();return It([qt])!="[null]"||It({a:qt})!="{}"||It(Object(qt))!="{}"}),tn=bt(function(){return It("\uDF06\uD834")!=='"\\udf06\\ud834"'||It("\uDEAD")!=='"\\udead"'}),gn=function(qt,fn){var Cn=ft(arguments),Tn=fn;if((rt(fn)||qt!==void 0)&&!pt(qt))return ct(fn)||(fn=function(un,mn){if(mt(Tn)&&(mn=Rt(Tn,this,un,mn)),!pt(mn))return mn}),Cn[1]=fn,st(It,null,Cn)},nn=function(qt,fn,Cn){var Tn=At(Cn,fn-1),un=At(Cn,fn+1);return xt(Ft,qt)&&!xt(Ht,un)||xt(Ht,qt)&&!xt(Ft,Tn)?"\\u"+Mt(Dt(qt,0),16):qt};It&&et({target:"JSON",stat:!0,arity:3,forced:Wt||tn},{stringify:function(qt,fn,Cn){var Tn=ft(arguments),un=st(Wt?gn:It,null,Tn);return tn&&typeof un=="string"?wt(un,vt,nn):un}})},3706:(it,ut,s)=>{var et=s(7854);s(8003)(et.JSON,"JSON",!0)},9098:(it,ut,s)=>{s(7710)("Map",function(et){return function(){return et(this,arguments.length?arguments[0]:void 0)}},s(5631))},1532:(it,ut,s)=>{s(9098)},658:(it,ut,s)=>{s(2109)({target:"Math",stat:!0},{log10:s(403)})},2703:(it,ut,s)=>{s(8003)(Math,"Math",!0)},9653:(it,ut,s)=>{var et=s(9781),ot=s(7854),st=s(1702),Rt=s(4705),ht=s(8052),bt=s(2597),ct=s(9587),mt=s(7976),rt=s(2190),pt=s(7593),ft=s(7293),St=s(8006).f,It=s(1236).f,xt=s(3070).f,At=s(863),Dt=s(3111).trim,wt="Number",Mt=ot.Number,vt=Mt.prototype,Ft=ot.TypeError,Ht=st("".slice),Wt=st("".charCodeAt),tn=function(Tn){var un=pt(Tn,"number");return typeof un=="bigint"?un:gn(un)},gn=function(Tn){var un,mn,yn,pn,In,kn,Mn,xn,Pn=pt(Tn,"number");if(rt(Pn))throw Ft("Cannot convert a Symbol value to a number");if(typeof Pn=="string"&&Pn.length>2){if(Pn=Dt(Pn),(un=Wt(Pn,0))===43||un===45){if((mn=Wt(Pn,2))===88||mn===120)return NaN}else if(un===48){switch(Wt(Pn,1)){case 66:case 98:yn=2,pn=49;break;case 79:case 111:yn=8,pn=55;break;default:return+Pn}for(kn=(In=Ht(Pn,2)).length,Mn=0;Mn<kn;Mn++)if((xn=Wt(In,Mn))<48||xn>pn)return NaN;return parseInt(In,yn)}}return+Pn};if(Rt(wt,!Mt(" 0o1")||!Mt("0b1")||Mt("+0x1"))){for(var nn,qt=function(Tn){var un=arguments.length<1?0:Mt(tn(Tn)),mn=this;return mt(vt,mn)&&ft(function(){At(mn)})?ct(Object(un),mn,qt):un},fn=et?St(Mt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Cn=0;fn.length>Cn;Cn++)bt(Mt,nn=fn[Cn])&&!bt(qt,nn)&&xt(qt,nn,It(Mt,nn));qt.prototype=vt,vt.constructor=qt,ht(ot,wt,qt,{constructor:!0})}},3161:(it,ut,s)=>{s(2109)({target:"Number",stat:!0},{isInteger:s(5988)})},4363:(it,ut,s)=>{s(2109)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},9601:(it,ut,s)=>{var et=s(2109),ot=s(1574);et({target:"Object",stat:!0,arity:2,forced:Object.assign!==ot},{assign:ot})},8011:(it,ut,s)=>{s(2109)({target:"Object",stat:!0,sham:!s(9781)},{create:s(30)})},9070:(it,ut,s)=>{var et=s(2109),ot=s(9781),st=s(3070).f;et({target:"Object",stat:!0,forced:Object.defineProperty!==st,sham:!ot},{defineProperty:st})},9720:(it,ut,s)=>{var et=s(2109),ot=s(4699).entries;et({target:"Object",stat:!0},{entries:function(st){return ot(st)}})},5003:(it,ut,s)=>{var et=s(2109),ot=s(7293),st=s(5656),Rt=s(1236).f,ht=s(9781),bt=ot(function(){Rt(1)});et({target:"Object",stat:!0,forced:!ht||bt,sham:!ht},{getOwnPropertyDescriptor:function(ct,mt){return Rt(st(ct),mt)}})},9660:(it,ut,s)=>{var et=s(2109),ot=s(133),st=s(7293),Rt=s(5181),ht=s(7908);et({target:"Object",stat:!0,forced:!ot||st(function(){Rt.f(1)})},{getOwnPropertySymbols:function(bt){var ct=Rt.f;return ct?ct(ht(bt)):[]}})},489:(it,ut,s)=>{var et=s(2109),ot=s(7293),st=s(7908),Rt=s(9518),ht=s(8544);et({target:"Object",stat:!0,forced:ot(function(){Rt(1)}),sham:!ht},{getPrototypeOf:function(bt){return Rt(st(bt))}})},7941:(it,ut,s)=>{var et=s(2109),ot=s(7908),st=s(1956);et({target:"Object",stat:!0,forced:s(7293)(function(){st(1)})},{keys:function(Rt){return st(ot(Rt))}})},8304:(it,ut,s)=>{s(2109)({target:"Object",stat:!0},{setPrototypeOf:s(7674)})},1539:(it,ut,s)=>{var et=s(1694),ot=s(8052),st=s(288);et||ot(Object.prototype,"toString",st,{unsafe:!0})},2479:(it,ut,s)=>{var et=s(2109),ot=s(4699).values;et({target:"Object",stat:!0},{values:function(st){return ot(st)}})},1058:(it,ut,s)=>{var et=s(2109),ot=s(3009);et({global:!0,forced:parseInt!=ot},{parseInt:ot})},821:(it,ut,s)=>{var et=s(2109),ot=s(6916),st=s(9662),Rt=s(8523),ht=s(2534),bt=s(408);et({target:"Promise",stat:!0,forced:s(612)},{all:function(ct){var mt=this,rt=Rt.f(mt),pt=rt.resolve,ft=rt.reject,St=ht(function(){var It=st(mt.resolve),xt=[],At=0,Dt=1;bt(ct,function(wt){var Mt=At++,vt=!1;Dt++,ot(It,mt,wt).then(function(Ft){vt||(vt=!0,xt[Mt]=Ft,--Dt||pt(xt))},ft)}),--Dt||pt(xt)});return St.error&&ft(St.value),rt.promise}})},4164:(it,ut,s)=>{var et=s(2109),ot=s(1913),st=s(3702).CONSTRUCTOR,Rt=s(2492),ht=s(5005),bt=s(614),ct=s(8052),mt=Rt&&Rt.prototype;if(et({target:"Promise",proto:!0,forced:st,real:!0},{catch:function(pt){return this.then(void 0,pt)}}),!ot&&bt(Rt)){var rt=ht("Promise").prototype.catch;mt.catch!==rt&&ct(mt,"catch",rt,{unsafe:!0})}},3401:(it,ut,s)=>{var et,ot,st,Rt=s(2109),ht=s(1913),bt=s(2805),ct=s(7854),mt=s(6916),rt=s(8052),pt=s(7674),ft=s(8003),St=s(6340),It=s(9662),xt=s(614),At=s(111),Dt=s(5787),wt=s(6707),Mt=s(261).set,vt=s(5948),Ft=s(842),Ht=s(2534),Wt=s(8572),tn=s(9909),gn=s(2492),nn=s(3702),qt=s(8523),fn="Promise",Cn=nn.CONSTRUCTOR,Tn=nn.REJECTION_EVENT,un=nn.SUBCLASSING,mn=tn.getterFor(fn),yn=tn.set,pn=gn&&gn.prototype,In=gn,kn=pn,Mn=ct.TypeError,xn=ct.document,Pn=ct.process,On=qt.f,Dn=On,Fn=!!(xn&&xn.createEvent&&ct.dispatchEvent),dr="unhandledrejection",ir=function(Nn){var Wn;return!(!At(Nn)||!xt(Wn=Nn.then))&&Wn},Xn=function(Nn,Wn){var vn,Rn,Gt,Tt=Wn.value,nt=Wn.state==1,Ct=nt?Nn.ok:Nn.fail,yt=Nn.resolve,Pt=Nn.reject,Et=Nn.domain;try{Ct?(nt||(Wn.rejection===2&&sr(Wn),Wn.rejection=1),Ct===!0?vn=Tt:(Et&&Et.enter(),vn=Ct(Tt),Et&&(Et.exit(),Gt=!0)),vn===Nn.promise?Pt(Mn("Promise-chain cycle")):(Rn=ir(vn))?mt(Rn,vn,yt,Pt):yt(vn)):Pt(Tt)}catch(Ut){Et&&!Gt&&Et.exit(),Pt(Ut)}},tr=function(Nn,Wn){Nn.notified||(Nn.notified=!0,vt(function(){for(var vn,Rn=Nn.reactions;vn=Rn.get();)Xn(vn,Nn);Nn.notified=!1,Wn&&!Nn.rejection&&Jn(Nn)}))},cn=function(Nn,Wn,vn){var Rn,Gt;Fn?((Rn=xn.createEvent("Event")).promise=Wn,Rn.reason=vn,Rn.initEvent(Nn,!1,!0),ct.dispatchEvent(Rn)):Rn={promise:Wn,reason:vn},!Tn&&(Gt=ct["on"+Nn])?Gt(Rn):Nn===dr&&Ft("Unhandled promise rejection",vn)},Jn=function(Nn){mt(Mt,ct,function(){var Wn,vn=Nn.facade,Rn=Nn.value;if(Qn(Nn)&&(Wn=Ht(function(){bt?Pn.emit("unhandledRejection",Rn,vn):cn(dr,vn,Rn)}),Nn.rejection=bt||Qn(Nn)?2:1,Wn.error))throw Wn.value})},Qn=function(Nn){return Nn.rejection!==1&&!Nn.parent},sr=function(Nn){mt(Mt,ct,function(){var Wn=Nn.facade;bt?Pn.emit("rejectionHandled",Wn):cn("rejectionhandled",Wn,Nn.value)})},Bn=function(Nn,Wn,vn){return function(Rn){Nn(Wn,Rn,vn)}},rr=function(Nn,Wn,vn){Nn.done||(Nn.done=!0,vn&&(Nn=vn),Nn.value=Wn,Nn.state=2,tr(Nn,!0))},nr=function(Nn,Wn,vn){if(!Nn.done){Nn.done=!0,vn&&(Nn=vn);try{if(Nn.facade===Wn)throw Mn("Promise can't be resolved itself");var Rn=ir(Wn);Rn?vt(function(){var Gt={done:!1};try{mt(Rn,Wn,Bn(nr,Gt,Nn),Bn(rr,Gt,Nn))}catch(Tt){rr(Gt,Tt,Nn)}}):(Nn.value=Wn,Nn.state=1,tr(Nn,!1))}catch(Gt){rr({done:!1},Gt,Nn)}}};if(Cn&&(kn=(In=function(Nn){Dt(this,kn),It(Nn),mt(et,this);var Wn=mn(this);try{Nn(Bn(nr,Wn),Bn(rr,Wn))}catch(vn){rr(Wn,vn)}}).prototype,(et=function(Nn){yn(this,{type:fn,done:!1,notified:!1,parent:!1,reactions:new Wt,rejection:!1,state:0,value:void 0})}).prototype=rt(kn,"then",function(Nn,Wn){var vn=mn(this),Rn=On(wt(this,In));return vn.parent=!0,Rn.ok=!xt(Nn)||Nn,Rn.fail=xt(Wn)&&Wn,Rn.domain=bt?Pn.domain:void 0,vn.state==0?vn.reactions.add(Rn):vt(function(){Xn(Rn,vn)}),Rn.promise}),ot=function(){var Nn=new et,Wn=mn(Nn);this.promise=Nn,this.resolve=Bn(nr,Wn),this.reject=Bn(rr,Wn)},qt.f=On=function(Nn){return Nn===In||Nn===void 0?new ot(Nn):Dn(Nn)},!ht&&xt(gn)&&pn!==Object.prototype)){st=pn.then,un||rt(pn,"then",function(Nn,Wn){var vn=this;return new In(function(Rn,Gt){mt(st,vn,Rn,Gt)}).then(Nn,Wn)},{unsafe:!0});try{delete pn.constructor}catch{}pt&&pt(pn,kn)}Rt({global:!0,constructor:!0,wrap:!0,forced:Cn},{Promise:In}),ft(In,fn,!1,!0),St(fn)},8674:(it,ut,s)=>{s(3401),s(821),s(4164),s(6027),s(683),s(6294)},6027:(it,ut,s)=>{var et=s(2109),ot=s(6916),st=s(9662),Rt=s(8523),ht=s(2534),bt=s(408);et({target:"Promise",stat:!0,forced:s(612)},{race:function(ct){var mt=this,rt=Rt.f(mt),pt=rt.reject,ft=ht(function(){var St=st(mt.resolve);bt(ct,function(It){ot(St,mt,It).then(rt.resolve,pt)})});return ft.error&&pt(ft.value),rt.promise}})},683:(it,ut,s)=>{var et=s(2109),ot=s(6916),st=s(8523);et({target:"Promise",stat:!0,forced:s(3702).CONSTRUCTOR},{reject:function(Rt){var ht=st.f(this);return ot(ht.reject,void 0,Rt),ht.promise}})},6294:(it,ut,s)=>{var et=s(2109),ot=s(5005),st=s(1913),Rt=s(2492),ht=s(3702).CONSTRUCTOR,bt=s(9478),ct=ot("Promise"),mt=st&&!ht;et({target:"Promise",stat:!0,forced:st||ht},{resolve:function(rt){return bt(mt&&this===ct?Rt:this,rt)}})},2419:(it,ut,s)=>{var et=s(2109),ot=s(5005),st=s(2104),Rt=s(7065),ht=s(9483),bt=s(9670),ct=s(111),mt=s(30),rt=s(7293),pt=ot("Reflect","construct"),ft=Object.prototype,St=[].push,It=rt(function(){function Dt(){}return!(pt(function(){},[],Dt)instanceof Dt)}),xt=!rt(function(){pt(function(){})}),At=It||xt;et({target:"Reflect",stat:!0,forced:At,sham:At},{construct:function(Dt,wt){ht(Dt),bt(wt);var Mt=arguments.length<3?Dt:ht(arguments[2]);if(xt&&!It)return pt(Dt,wt,Mt);if(Dt==Mt){switch(wt.length){case 0:return new Dt;case 1:return new Dt(wt[0]);case 2:return new Dt(wt[0],wt[1]);case 3:return new Dt(wt[0],wt[1],wt[2]);case 4:return new Dt(wt[0],wt[1],wt[2],wt[3])}var vt=[null];return st(St,vt,wt),new(st(Rt,Dt,vt))}var Ft=Mt.prototype,Ht=mt(ct(Ft)?Ft:ft),Wt=st(Dt,Ht,wt);return ct(Wt)?Wt:Ht}})},4819:(it,ut,s)=>{var et=s(2109),ot=s(6916),st=s(111),Rt=s(9670),ht=s(5032),bt=s(1236),ct=s(9518);et({target:"Reflect",stat:!0},{get:function mt(rt,pt){var ft,St,It=arguments.length<3?rt:arguments[2];return Rt(rt)===It?rt[pt]:(ft=bt.f(rt,pt))?ht(ft)?ft.value:ft.get===void 0?void 0:ot(ft.get,It):st(St=ct(rt))?mt(St,pt,It):void 0}})},4603:(it,ut,s)=>{var et=s(9781),ot=s(7854),st=s(1702),Rt=s(4705),ht=s(9587),bt=s(8880),ct=s(8006).f,mt=s(7976),rt=s(7850),pt=s(1340),ft=s(4706),St=s(2999),It=s(2626),xt=s(8052),At=s(7293),Dt=s(2597),wt=s(9909).enforce,Mt=s(6340),vt=s(5112),Ft=s(9441),Ht=s(7168),Wt=vt("match"),tn=ot.RegExp,gn=tn.prototype,nn=ot.SyntaxError,qt=st(gn.exec),fn=st("".charAt),Cn=st("".replace),Tn=st("".indexOf),un=st("".slice),mn=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,yn=/a/g,pn=/a/g,In=new tn(yn)!==yn,kn=St.MISSED_STICKY,Mn=St.UNSUPPORTED_Y;if(Rt("RegExp",et&&(!In||kn||Ft||Ht||At(function(){return pn[Wt]=!1,tn(yn)!=yn||tn(pn)==pn||tn(yn,"i")!="/a/i"})))){for(var xn=function(Dn,Fn){var dr,ir,Xn,tr,cn,Jn,Qn=mt(gn,this),sr=rt(Dn),Bn=Fn===void 0,rr=[],nr=Dn;if(!Qn&&sr&&Bn&&Dn.constructor===xn)return Dn;if((sr||mt(gn,Dn))&&(Dn=Dn.source,Bn&&(Fn=ft(nr))),Dn=Dn===void 0?"":pt(Dn),Fn=Fn===void 0?"":pt(Fn),nr=Dn,Ft&&"dotAll"in yn&&(ir=!!Fn&&Tn(Fn,"s")>-1)&&(Fn=Cn(Fn,/s/g,"")),dr=Fn,kn&&"sticky"in yn&&(Xn=!!Fn&&Tn(Fn,"y")>-1)&&Mn&&(Fn=Cn(Fn,/y/g,"")),Ht&&(tr=function(Nn){for(var Wn,vn=Nn.length,Rn=0,Gt="",Tt=[],nt={},Ct=!1,yt=!1,Pt=0,Et="";Rn<=vn;Rn++){if((Wn=fn(Nn,Rn))==="\\")Wn+=fn(Nn,++Rn);else if(Wn==="]")Ct=!1;else if(!Ct)switch(!0){case Wn==="[":Ct=!0;break;case Wn==="(":qt(mn,un(Nn,Rn+1))&&(Rn+=2,yt=!0),Gt+=Wn,Pt++;continue;case(Wn===">"&&yt):if(Et===""||Dt(nt,Et))throw new nn("Invalid capture group name");nt[Et]=!0,Tt[Tt.length]=[Et,Pt],yt=!1,Et="";continue}yt?Et+=Wn:Gt+=Wn}return[Gt,Tt]}(Dn),Dn=tr[0],rr=tr[1]),cn=ht(tn(Dn,Fn),Qn?this:gn,xn),(ir||Xn||rr.length)&&(Jn=wt(cn),ir&&(Jn.dotAll=!0,Jn.raw=xn(function(Nn){for(var Wn,vn=Nn.length,Rn=0,Gt="",Tt=!1;Rn<=vn;Rn++)(Wn=fn(Nn,Rn))!=="\\"?Tt||Wn!=="."?(Wn==="["?Tt=!0:Wn==="]"&&(Tt=!1),Gt+=Wn):Gt+="[\\s\\S]":Gt+=Wn+fn(Nn,++Rn);return Gt}(Dn),dr)),Xn&&(Jn.sticky=!0),rr.length&&(Jn.groups=rr)),Dn!==nr)try{bt(cn,"source",nr===""?"(?:)":nr)}catch{}return cn},Pn=ct(tn),On=0;Pn.length>On;)It(xn,tn,Pn[On++]);gn.constructor=xn,xn.prototype=gn,xt(ot,"RegExp",xn,{constructor:!0})}Mt("RegExp")},4916:(it,ut,s)=>{var et=s(2109),ot=s(2261);et({target:"RegExp",proto:!0,forced:/./.exec!==ot},{exec:ot})},9714:(it,ut,s)=>{var et=s(6530).PROPER,ot=s(8052),st=s(9670),Rt=s(1340),ht=s(7293),bt=s(4706),ct="toString",mt=RegExp.prototype.toString,rt=ht(function(){return mt.call({source:"a",flags:"b"})!="/a/b"}),pt=et&&mt.name!=ct;(rt||pt)&&ot(RegExp.prototype,ct,function(){var ft=st(this);return"/"+Rt(ft.source)+"/"+Rt(bt(ft))},{unsafe:!0})},7227:(it,ut,s)=>{s(7710)("Set",function(et){return function(){return et(this,arguments.length?arguments[0]:void 0)}},s(5631))},189:(it,ut,s)=>{s(7227)},2023:(it,ut,s)=>{var et=s(2109),ot=s(1702),st=s(3929),Rt=s(4488),ht=s(1340),bt=s(4964),ct=ot("".indexOf);et({target:"String",proto:!0,forced:!bt("includes")},{includes:function(mt){return!!~ct(ht(Rt(this)),ht(st(mt)),arguments.length>1?arguments[1]:void 0)}})},8783:(it,ut,s)=>{var et=s(8710).charAt,ot=s(1340),st=s(9909),Rt=s(654),ht="String Iterator",bt=st.set,ct=st.getterFor(ht);Rt(String,"String",function(mt){bt(this,{type:ht,string:ot(mt),index:0})},function(){var mt,rt=ct(this),pt=rt.string,ft=rt.index;return ft>=pt.length?{value:void 0,done:!0}:(mt=et(pt,ft),rt.index+=mt.length,{value:mt,done:!1})})},4723:(it,ut,s)=>{var et=s(6916),ot=s(7007),st=s(9670),Rt=s(7466),ht=s(1340),bt=s(4488),ct=s(8173),mt=s(1530),rt=s(7651);ot("match",function(pt,ft,St){return[function(It){var xt=bt(this),At=It==null?void 0:ct(It,pt);return At?et(At,It,xt):new RegExp(It)[pt](ht(xt))},function(It){var xt=st(this),At=ht(It),Dt=St(ft,xt,At);if(Dt.done)return Dt.value;if(!xt.global)return rt(xt,At);var wt=xt.unicode;xt.lastIndex=0;for(var Mt,vt=[],Ft=0;(Mt=rt(xt,At))!==null;){var Ht=ht(Mt[0]);vt[Ft]=Ht,Ht===""&&(xt.lastIndex=mt(At,Rt(xt.lastIndex),wt)),Ft++}return Ft===0?null:vt}]})},5306:(it,ut,s)=>{var et=s(2104),ot=s(6916),st=s(1702),Rt=s(7007),ht=s(7293),bt=s(9670),ct=s(614),mt=s(9303),rt=s(7466),pt=s(1340),ft=s(4488),St=s(1530),It=s(8173),xt=s(647),At=s(7651),Dt=s(5112)("replace"),wt=Math.max,Mt=Math.min,vt=st([].concat),Ft=st([].push),Ht=st("".indexOf),Wt=st("".slice),tn="a".replace(/./,"$0")==="$0",gn=!!/./[Dt]&&/./[Dt]("a","$0")==="";Rt("replace",function(nn,qt,fn){var Cn=gn?"$":"$0";return[function(Tn,un){var mn=ft(this),yn=Tn==null?void 0:It(Tn,Dt);return yn?ot(yn,Tn,mn,un):ot(qt,pt(mn),Tn,un)},function(Tn,un){var mn=bt(this),yn=pt(Tn);if(typeof un=="string"&&Ht(un,Cn)===-1&&Ht(un,"$<")===-1){var pn=fn(qt,mn,yn,un);if(pn.done)return pn.value}var In=ct(un);In||(un=pt(un));var kn=mn.global;if(kn){var Mn=mn.unicode;mn.lastIndex=0}for(var xn=[];;){var Pn=At(mn,yn);if(Pn===null||(Ft(xn,Pn),!kn))break;pt(Pn[0])===""&&(mn.lastIndex=St(yn,rt(mn.lastIndex),Mn))}for(var On,Dn="",Fn=0,dr=0;dr<xn.length;dr++){for(var ir=pt((Pn=xn[dr])[0]),Xn=wt(Mt(mt(Pn.index),yn.length),0),tr=[],cn=1;cn<Pn.length;cn++)Ft(tr,(On=Pn[cn])===void 0?On:String(On));var Jn=Pn.groups;if(In){var Qn=vt([ir],tr,Xn,yn);Jn!==void 0&&Ft(Qn,Jn);var sr=pt(et(un,void 0,Qn))}else sr=xt(ir,yn,Xn,tr,Jn,un);Xn>=Fn&&(Dn+=Wt(yn,Fn,Xn)+sr,Fn=Xn+ir.length)}return Dn+Wt(yn,Fn)}]},!!ht(function(){var nn=/./;return nn.exec=function(){var qt=[];return qt.groups={a:"7"},qt},"".replace(nn,"$<a>")!=="7"})||!tn||gn)},4765:(it,ut,s)=>{var et=s(6916),ot=s(7007),st=s(9670),Rt=s(4488),ht=s(1150),bt=s(1340),ct=s(8173),mt=s(7651);ot("search",function(rt,pt,ft){return[function(St){var It=Rt(this),xt=St==null?void 0:ct(St,rt);return xt?et(xt,St,It):new RegExp(St)[rt](bt(It))},function(St){var It=st(this),xt=bt(St),At=ft(pt,It,xt);if(At.done)return At.value;var Dt=It.lastIndex;ht(Dt,0)||(It.lastIndex=0);var wt=mt(It,xt);return ht(It.lastIndex,Dt)||(It.lastIndex=Dt),wt===null?-1:wt.index}]})},3123:(it,ut,s)=>{var et=s(2104),ot=s(6916),st=s(1702),Rt=s(7007),ht=s(7850),bt=s(9670),ct=s(4488),mt=s(6707),rt=s(1530),pt=s(7466),ft=s(1340),St=s(8173),It=s(1589),xt=s(7651),At=s(2261),Dt=s(2999),wt=s(7293),Mt=Dt.UNSUPPORTED_Y,vt=4294967295,Ft=Math.min,Ht=[].push,Wt=st(/./.exec),tn=st(Ht),gn=st("".slice);Rt("split",function(nn,qt,fn){var Cn;return Cn="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?function(Tn,un){var mn=ft(ct(this)),yn=un===void 0?vt:un>>>0;if(yn===0)return[];if(Tn===void 0)return[mn];if(!ht(Tn))return ot(qt,mn,Tn,yn);for(var pn,In,kn,Mn=[],xn=(Tn.ignoreCase?"i":"")+(Tn.multiline?"m":"")+(Tn.unicode?"u":"")+(Tn.sticky?"y":""),Pn=0,On=new RegExp(Tn.source,xn+"g");(pn=ot(At,On,mn))&&!((In=On.lastIndex)>Pn&&(tn(Mn,gn(mn,Pn,pn.index)),pn.length>1&&pn.index<mn.length&&et(Ht,Mn,It(pn,1)),kn=pn[0].length,Pn=In,Mn.length>=yn));)On.lastIndex===pn.index&&On.lastIndex++;return Pn===mn.length?!kn&&Wt(On,"")||tn(Mn,""):tn(Mn,gn(mn,Pn)),Mn.length>yn?It(Mn,0,yn):Mn}:"0".split(void 0,0).length?function(Tn,un){return Tn===void 0&&un===0?[]:ot(qt,this,Tn,un)}:qt,[function(Tn,un){var mn=ct(this),yn=Tn==null?void 0:St(Tn,nn);return yn?ot(yn,Tn,mn,un):ot(Cn,ft(mn),Tn,un)},function(Tn,un){var mn=bt(this),yn=ft(Tn),pn=fn(Cn,mn,yn,un,Cn!==qt);if(pn.done)return pn.value;var In=mt(mn,RegExp),kn=mn.unicode,Mn=(mn.ignoreCase?"i":"")+(mn.multiline?"m":"")+(mn.unicode?"u":"")+(Mt?"g":"y"),xn=new In(Mt?"^(?:"+mn.source+")":mn,Mn),Pn=un===void 0?vt:un>>>0;if(Pn===0)return[];if(yn.length===0)return xt(xn,yn)===null?[yn]:[];for(var On=0,Dn=0,Fn=[];Dn<yn.length;){xn.lastIndex=Mt?0:Dn;var dr,ir=xt(xn,Mt?gn(yn,Dn):yn);if(ir===null||(dr=Ft(pt(xn.lastIndex+(Mt?Dn:0)),yn.length))===On)Dn=rt(yn,Dn,kn);else{if(tn(Fn,gn(yn,On,Dn)),Fn.length===Pn)return Fn;for(var Xn=1;Xn<=ir.length-1;Xn++)if(tn(Fn,ir[Xn]),Fn.length===Pn)return Fn;Dn=On=dr}}return tn(Fn,gn(yn,On)),Fn}]},!!wt(function(){var nn=/(?:)/,qt=nn.exec;nn.exec=function(){return qt.apply(this,arguments)};var fn="ab".split(nn);return fn.length!==2||fn[0]!=="a"||fn[1]!=="b"}),Mt)},6755:(it,ut,s)=>{var et,ot=s(2109),st=s(1702),Rt=s(1236).f,ht=s(7466),bt=s(1340),ct=s(3929),mt=s(4488),rt=s(4964),pt=s(1913),ft=st("".startsWith),St=st("".slice),It=Math.min,xt=rt("startsWith");ot({target:"String",proto:!0,forced:!(!pt&&!xt&&(et=Rt(String.prototype,"startsWith"),et&&!et.writable)||xt)},{startsWith:function(At){var Dt=bt(mt(this));ct(At);var wt=ht(It(arguments.length>1?arguments[1]:void 0,Dt.length)),Mt=bt(At);return ft?ft(Dt,Mt,wt):St(Dt,wt,wt+Mt.length)===Mt}})},2443:(it,ut,s)=>{s(7235)("asyncIterator")},4032:(it,ut,s)=>{var et=s(2109),ot=s(7854),st=s(6916),Rt=s(1702),ht=s(1913),bt=s(9781),ct=s(133),mt=s(7293),rt=s(2597),pt=s(7976),ft=s(9670),St=s(5656),It=s(4948),xt=s(1340),At=s(9114),Dt=s(30),wt=s(1956),Mt=s(8006),vt=s(1156),Ft=s(5181),Ht=s(1236),Wt=s(3070),tn=s(6048),gn=s(5296),nn=s(8052),qt=s(2309),fn=s(6200),Cn=s(3501),Tn=s(9711),un=s(5112),mn=s(6061),yn=s(7235),pn=s(6532),In=s(8003),kn=s(9909),Mn=s(2092).forEach,xn=fn("hidden"),Pn="Symbol",On=kn.set,Dn=kn.getterFor(Pn),Fn=Object.prototype,dr=ot.Symbol,ir=dr&&dr.prototype,Xn=ot.TypeError,tr=ot.QObject,cn=Ht.f,Jn=Wt.f,Qn=vt.f,sr=gn.f,Bn=Rt([].push),rr=qt("symbols"),nr=qt("op-symbols"),Nn=qt("wks"),Wn=!tr||!tr.prototype||!tr.prototype.findChild,vn=bt&&mt(function(){return Dt(Jn({},"a",{get:function(){return Jn(this,"a",{value:7}).a}})).a!=7})?function(Et,Ut,Ot){var Bt=cn(Fn,Ut);Bt&&delete Fn[Ut],Jn(Et,Ut,Ot),Bt&&Et!==Fn&&Jn(Fn,Ut,Bt)}:Jn,Rn=function(Et,Ut){var Ot=rr[Et]=Dt(ir);return On(Ot,{type:Pn,tag:Et,description:Ut}),bt||(Ot.description=Ut),Ot},Gt=function(Et,Ut,Ot){Et===Fn&&Gt(nr,Ut,Ot),ft(Et);var Bt=It(Ut);return ft(Ot),rt(rr,Bt)?(Ot.enumerable?(rt(Et,xn)&&Et[xn][Bt]&&(Et[xn][Bt]=!1),Ot=Dt(Ot,{enumerable:At(0,!1)})):(rt(Et,xn)||Jn(Et,xn,At(1,{})),Et[xn][Bt]=!0),vn(Et,Bt,Ot)):Jn(Et,Bt,Ot)},Tt=function(Et,Ut){ft(Et);var Ot=St(Ut),Bt=wt(Ot).concat(Pt(Ot));return Mn(Bt,function(Qt){bt&&!st(nt,Ot,Qt)||Gt(Et,Qt,Ot[Qt])}),Et},nt=function(Et){var Ut=It(Et),Ot=st(sr,this,Ut);return!(this===Fn&&rt(rr,Ut)&&!rt(nr,Ut))&&(!(Ot||!rt(this,Ut)||!rt(rr,Ut)||rt(this,xn)&&this[xn][Ut])||Ot)},Ct=function(Et,Ut){var Ot=St(Et),Bt=It(Ut);if(Ot!==Fn||!rt(rr,Bt)||rt(nr,Bt)){var Qt=cn(Ot,Bt);return!Qt||!rt(rr,Bt)||rt(Ot,xn)&&Ot[xn][Bt]||(Qt.enumerable=!0),Qt}},yt=function(Et){var Ut=Qn(St(Et)),Ot=[];return Mn(Ut,function(Bt){rt(rr,Bt)||rt(Cn,Bt)||Bn(Ot,Bt)}),Ot},Pt=function(Et){var Ut=Et===Fn,Ot=Qn(Ut?nr:St(Et)),Bt=[];return Mn(Ot,function(Qt){!rt(rr,Qt)||Ut&&!rt(Fn,Qt)||Bn(Bt,rr[Qt])}),Bt};ct||(nn(ir=(dr=function(){if(pt(ir,this))throw Xn("Symbol is not a constructor");var Et=arguments.length&&arguments[0]!==void 0?xt(arguments[0]):void 0,Ut=Tn(Et),Ot=function(Bt){this===Fn&&st(Ot,nr,Bt),rt(this,xn)&&rt(this[xn],Ut)&&(this[xn][Ut]=!1),vn(this,Ut,At(1,Bt))};return bt&&Wn&&vn(Fn,Ut,{configurable:!0,set:Ot}),Rn(Ut,Et)}).prototype,"toString",function(){return Dn(this).tag}),nn(dr,"withoutSetter",function(Et){return Rn(Tn(Et),Et)}),gn.f=nt,Wt.f=Gt,tn.f=Tt,Ht.f=Ct,Mt.f=vt.f=yt,Ft.f=Pt,mn.f=function(Et){return Rn(un(Et),Et)},bt&&(Jn(ir,"description",{configurable:!0,get:function(){return Dn(this).description}}),ht||nn(Fn,"propertyIsEnumerable",nt,{unsafe:!0}))),et({global:!0,constructor:!0,wrap:!0,forced:!ct,sham:!ct},{Symbol:dr}),Mn(wt(Nn),function(Et){yn(Et)}),et({target:Pn,stat:!0,forced:!ct},{useSetter:function(){Wn=!0},useSimple:function(){Wn=!1}}),et({target:"Object",stat:!0,forced:!ct,sham:!bt},{create:function(Et,Ut){return Ut===void 0?Dt(Et):Tt(Dt(Et),Ut)},defineProperty:Gt,defineProperties:Tt,getOwnPropertyDescriptor:Ct}),et({target:"Object",stat:!0,forced:!ct},{getOwnPropertyNames:yt}),pn(),In(dr,Pn),Cn[xn]=!0},1817:(it,ut,s)=>{var et=s(2109),ot=s(9781),st=s(7854),Rt=s(1702),ht=s(2597),bt=s(614),ct=s(7976),mt=s(1340),rt=s(3070).f,pt=s(9920),ft=st.Symbol,St=ft&&ft.prototype;if(ot&&bt(ft)&&(!("description"in St)||ft().description!==void 0)){var It={},xt=function(){var Ht=arguments.length<1||arguments[0]===void 0?void 0:mt(arguments[0]),Wt=ct(St,this)?new ft(Ht):Ht===void 0?ft():ft(Ht);return Ht===""&&(It[Wt]=!0),Wt};pt(xt,ft),xt.prototype=St,St.constructor=xt;var At=String(ft("test"))=="Symbol(test)",Dt=Rt(St.toString),wt=Rt(St.valueOf),Mt=/^Symbol\((.*)\)[^)]+$/,vt=Rt("".replace),Ft=Rt("".slice);rt(St,"description",{configurable:!0,get:function(){var Ht=wt(this),Wt=Dt(Ht);if(ht(It,Ht))return"";var tn=At?Ft(Wt,7,-1):vt(Wt,Mt,"$1");return tn===""?void 0:tn}}),et({global:!0,constructor:!0,forced:!0},{Symbol:xt})}},763:(it,ut,s)=>{var et=s(2109),ot=s(5005),st=s(2597),Rt=s(1340),ht=s(2309),bt=s(735),ct=ht("string-to-symbol-registry"),mt=ht("symbol-to-string-registry");et({target:"Symbol",stat:!0,forced:!bt},{for:function(rt){var pt=Rt(rt);if(st(ct,pt))return ct[pt];var ft=ot("Symbol")(pt);return ct[pt]=ft,mt[ft]=pt,ft}})},2165:(it,ut,s)=>{s(7235)("iterator")},2526:(it,ut,s)=>{s(4032),s(763),s(6620),s(8862),s(9660)},6620:(it,ut,s)=>{var et=s(2109),ot=s(2597),st=s(2190),Rt=s(6330),ht=s(2309),bt=s(735),ct=ht("symbol-to-string-registry");et({target:"Symbol",stat:!0,forced:!bt},{keyFor:function(mt){if(!st(mt))throw TypeError(Rt(mt)+" is not a symbol");if(ot(ct,mt))return ct[mt]}})},3680:(it,ut,s)=>{var et=s(5005),ot=s(7235),st=s(8003);ot("toStringTag"),st(et("Symbol"),"Symbol")},2990:(it,ut,s)=>{var et=s(1702),ot=s(260),st=et(s(1048)),Rt=ot.aTypedArray;(0,ot.exportTypedArrayMethod)("copyWithin",function(ht,bt){return st(Rt(this),ht,bt,arguments.length>2?arguments[2]:void 0)})},8927:(it,ut,s)=>{var et=s(260),ot=s(2092).every,st=et.aTypedArray;(0,et.exportTypedArrayMethod)("every",function(Rt){return ot(st(this),Rt,arguments.length>1?arguments[1]:void 0)})},3105:(it,ut,s)=>{var et=s(260),ot=s(1285),st=s(4599),Rt=s(648),ht=s(6916),bt=s(1702),ct=s(7293),mt=et.aTypedArray,rt=et.exportTypedArrayMethod,pt=bt("".slice);rt("fill",function(ft){var St=arguments.length;mt(this);var It=pt(Rt(this),0,3)==="Big"?st(ft):+ft;return ht(ot,this,It,St>1?arguments[1]:void 0,St>2?arguments[2]:void 0)},ct(function(){var ft=0;return new Int8Array(2).fill({valueOf:function(){return ft++}}),ft!==1}))},5035:(it,ut,s)=>{var et=s(260),ot=s(2092).filter,st=s(3074),Rt=et.aTypedArray;(0,et.exportTypedArrayMethod)("filter",function(ht){var bt=ot(Rt(this),ht,arguments.length>1?arguments[1]:void 0);return st(this,bt)})},7174:(it,ut,s)=>{var et=s(260),ot=s(2092).findIndex,st=et.aTypedArray;(0,et.exportTypedArrayMethod)("findIndex",function(Rt){return ot(st(this),Rt,arguments.length>1?arguments[1]:void 0)})},4345:(it,ut,s)=>{var et=s(260),ot=s(2092).find,st=et.aTypedArray;(0,et.exportTypedArrayMethod)("find",function(Rt){return ot(st(this),Rt,arguments.length>1?arguments[1]:void 0)})},2846:(it,ut,s)=>{var et=s(260),ot=s(2092).forEach,st=et.aTypedArray;(0,et.exportTypedArrayMethod)("forEach",function(Rt){ot(st(this),Rt,arguments.length>1?arguments[1]:void 0)})},4731:(it,ut,s)=>{var et=s(260),ot=s(1318).includes,st=et.aTypedArray;(0,et.exportTypedArrayMethod)("includes",function(Rt){return ot(st(this),Rt,arguments.length>1?arguments[1]:void 0)})},7209:(it,ut,s)=>{var et=s(260),ot=s(1318).indexOf,st=et.aTypedArray;(0,et.exportTypedArrayMethod)("indexOf",function(Rt){return ot(st(this),Rt,arguments.length>1?arguments[1]:void 0)})},6319:(it,ut,s)=>{var et=s(7854),ot=s(7293),st=s(1702),Rt=s(260),ht=s(6992),bt=s(5112)("iterator"),ct=et.Uint8Array,mt=st(ht.values),rt=st(ht.keys),pt=st(ht.entries),ft=Rt.aTypedArray,St=Rt.exportTypedArrayMethod,It=ct&&ct.prototype,xt=!ot(function(){It[bt].call([1])}),At=!!It&&It.values&&It[bt]===It.values&&It.values.name==="values",Dt=function(){return mt(ft(this))};St("entries",function(){return pt(ft(this))},xt),St("keys",function(){return rt(ft(this))},xt),St("values",Dt,xt||!At,{name:"values"}),St(bt,Dt,xt||!At,{name:"values"})},8867:(it,ut,s)=>{var et=s(260),ot=s(1702),st=et.aTypedArray,Rt=et.exportTypedArrayMethod,ht=ot([].join);Rt("join",function(bt){return ht(st(this),bt)})},7789:(it,ut,s)=>{var et=s(260),ot=s(2104),st=s(6583),Rt=et.aTypedArray;(0,et.exportTypedArrayMethod)("lastIndexOf",function(ht){var bt=arguments.length;return ot(st,Rt(this),bt>1?[ht,arguments[1]]:[ht])})},3739:(it,ut,s)=>{var et=s(260),ot=s(2092).map,st=s(6304),Rt=et.aTypedArray;(0,et.exportTypedArrayMethod)("map",function(ht){return ot(Rt(this),ht,arguments.length>1?arguments[1]:void 0,function(bt,ct){return new(st(bt))(ct)})})},4483:(it,ut,s)=>{var et=s(260),ot=s(3671).right,st=et.aTypedArray;(0,et.exportTypedArrayMethod)("reduceRight",function(Rt){var ht=arguments.length;return ot(st(this),Rt,ht,ht>1?arguments[1]:void 0)})},9368:(it,ut,s)=>{var et=s(260),ot=s(3671).left,st=et.aTypedArray;(0,et.exportTypedArrayMethod)("reduce",function(Rt){var ht=arguments.length;return ot(st(this),Rt,ht,ht>1?arguments[1]:void 0)})},2056:(it,ut,s)=>{var et=s(260),ot=et.aTypedArray,st=et.exportTypedArrayMethod,Rt=Math.floor;st("reverse",function(){for(var ht,bt=this,ct=ot(bt).length,mt=Rt(ct/2),rt=0;rt<mt;)ht=bt[rt],bt[rt++]=bt[--ct],bt[ct]=ht;return bt})},3462:(it,ut,s)=>{var et=s(7854),ot=s(6916),st=s(260),Rt=s(6244),ht=s(4590),bt=s(7908),ct=s(7293),mt=et.RangeError,rt=et.Int8Array,pt=rt&&rt.prototype,ft=pt&&pt.set,St=st.aTypedArray,It=st.exportTypedArrayMethod,xt=!ct(function(){var Dt=new Uint8ClampedArray(2);return ot(ft,Dt,{length:1,0:3},1),Dt[1]!==3}),At=xt&&st.NATIVE_ARRAY_BUFFER_VIEWS&&ct(function(){var Dt=new rt(2);return Dt.set(1),Dt.set("2",1),Dt[0]!==0||Dt[1]!==2});It("set",function(Dt){St(this);var wt=ht(arguments.length>1?arguments[1]:void 0,1),Mt=bt(Dt);if(xt)return ot(ft,this,Mt,wt);var vt=this.length,Ft=Rt(Mt),Ht=0;if(Ft+wt>vt)throw mt("Wrong length");for(;Ht<Ft;)this[wt+Ht]=Mt[Ht++]},!xt||At)},678:(it,ut,s)=>{var et=s(260),ot=s(6304),st=s(7293),Rt=s(206),ht=et.aTypedArray;(0,et.exportTypedArrayMethod)("slice",function(bt,ct){for(var mt=Rt(ht(this),bt,ct),rt=ot(this),pt=0,ft=mt.length,St=new rt(ft);ft>pt;)St[pt]=mt[pt++];return St},st(function(){new Int8Array(1).slice()}))},7462:(it,ut,s)=>{var et=s(260),ot=s(2092).some,st=et.aTypedArray;(0,et.exportTypedArrayMethod)("some",function(Rt){return ot(st(this),Rt,arguments.length>1?arguments[1]:void 0)})},3824:(it,ut,s)=>{var et=s(7854),ot=s(1702),st=s(7293),Rt=s(9662),ht=s(4362),bt=s(260),ct=s(8886),mt=s(256),rt=s(7392),pt=s(8008),ft=bt.aTypedArray,St=bt.exportTypedArrayMethod,It=et.Uint16Array,xt=It&&ot(It.prototype.sort),At=!(!xt||st(function(){xt(new It(2),null)})&&st(function(){xt(new It(2),{})})),Dt=!!xt&&!st(function(){if(rt)return rt<74;if(ct)return ct<67;if(mt)return!0;if(pt)return pt<602;var wt,Mt,vt=new It(516),Ft=Array(516);for(wt=0;wt<516;wt++)Mt=wt%4,vt[wt]=515-wt,Ft[wt]=wt-2*Mt+3;for(xt(vt,function(Ht,Wt){return(Ht/4|0)-(Wt/4|0)}),wt=0;wt<516;wt++)if(vt[wt]!==Ft[wt])return!0});St("sort",function(wt){return wt!==void 0&&Rt(wt),Dt?xt(this,wt):ht(ft(this),function(Mt){return function(vt,Ft){return Mt!==void 0?+Mt(vt,Ft)||0:Ft!=Ft?-1:vt!=vt?1:vt===0&&Ft===0?1/vt>0&&1/Ft<0?1:-1:vt>Ft}}(wt))},!Dt||At)},5021:(it,ut,s)=>{var et=s(260),ot=s(7466),st=s(1400),Rt=s(6304),ht=et.aTypedArray;(0,et.exportTypedArrayMethod)("subarray",function(bt,ct){var mt=ht(this),rt=mt.length,pt=st(bt,rt);return new(Rt(mt))(mt.buffer,mt.byteOffset+pt*mt.BYTES_PER_ELEMENT,ot((ct===void 0?rt:st(ct,rt))-pt))})},2974:(it,ut,s)=>{var et=s(7854),ot=s(2104),st=s(260),Rt=s(7293),ht=s(206),bt=et.Int8Array,ct=st.aTypedArray,mt=st.exportTypedArrayMethod,rt=[].toLocaleString,pt=!!bt&&Rt(function(){rt.call(new bt(1))});mt("toLocaleString",function(){return ot(rt,pt?ht(ct(this)):ct(this),ht(arguments))},Rt(function(){return[1,2].toLocaleString()!=new bt([1,2]).toLocaleString()})||!Rt(function(){bt.prototype.toLocaleString.call([1,2])}))},5016:(it,ut,s)=>{var et=s(260).exportTypedArrayMethod,ot=s(7293),st=s(7854),Rt=s(1702),ht=st.Uint8Array,bt=ht&&ht.prototype||{},ct=[].toString,mt=Rt([].join);ot(function(){ct.call({})})&&(ct=function(){return mt(this)});var rt=bt.toString!=ct;et("toString",ct,rt)},2472:(it,ut,s)=>{s(9843)("Uint8",function(et){return function(ot,st,Rt){return et(this,ot,st,Rt)}})},9743:(it,ut,s)=>{s(9843)("Uint8",function(et){return function(ot,st,Rt){return et(this,ot,st,Rt)}},!0)},1202:(it,ut,s)=>{var et,ot=s(7854),st=s(1702),Rt=s(9190),ht=s(2423),bt=s(7710),ct=s(9320),mt=s(111),rt=s(2050),pt=s(9909).enforce,ft=s(8536),St=!ot.ActiveXObject&&"ActiveXObject"in ot,It=function(Ft){return function(){return Ft(this,arguments.length?arguments[0]:void 0)}},xt=bt("WeakMap",It,ct);if(ft&&St){et=ct.getConstructor(It,"WeakMap",!0),ht.enable();var At=xt.prototype,Dt=st(At.delete),wt=st(At.has),Mt=st(At.get),vt=st(At.set);Rt(At,{delete:function(Ft){if(mt(Ft)&&!rt(Ft)){var Ht=pt(this);return Ht.frozen||(Ht.frozen=new et),Dt(this,Ft)||Ht.frozen.delete(Ft)}return Dt(this,Ft)},has:function(Ft){if(mt(Ft)&&!rt(Ft)){var Ht=pt(this);return Ht.frozen||(Ht.frozen=new et),wt(this,Ft)||Ht.frozen.has(Ft)}return wt(this,Ft)},get:function(Ft){if(mt(Ft)&&!rt(Ft)){var Ht=pt(this);return Ht.frozen||(Ht.frozen=new et),wt(this,Ft)?Mt(this,Ft):Ht.frozen.get(Ft)}return Mt(this,Ft)},set:function(Ft,Ht){if(mt(Ft)&&!rt(Ft)){var Wt=pt(this);Wt.frozen||(Wt.frozen=new et),wt(this,Ft)?vt(this,Ft,Ht):Wt.frozen.set(Ft,Ht)}else vt(this,Ft,Ht);return this}})}},4129:(it,ut,s)=>{s(1202)},4747:(it,ut,s)=>{var et=s(7854),ot=s(8324),st=s(8509),Rt=s(8533),ht=s(8880),bt=function(mt){if(mt&&mt.forEach!==Rt)try{ht(mt,"forEach",Rt)}catch{mt.forEach=Rt}};for(var ct in ot)ot[ct]&&bt(et[ct]&&et[ct].prototype);bt(st)},3948:(it,ut,s)=>{var et=s(7854),ot=s(8324),st=s(8509),Rt=s(6992),ht=s(8880),bt=s(5112),ct=bt("iterator"),mt=bt("toStringTag"),rt=Rt.values,pt=function(St,It){if(St){if(St[ct]!==rt)try{ht(St,ct,rt)}catch{St[ct]=rt}if(St[mt]||ht(St,mt,It),ot[It]){for(var xt in Rt)if(St[xt]!==Rt[xt])try{ht(St,xt,Rt[xt])}catch{St[xt]=Rt[xt]}}}};for(var ft in ot)pt(et[ft]&&et[ft].prototype,ft);pt(st,"DOMTokenList")},6815:(it,ut,s)=>{var et=s(2109),ot=s(7854),st=s(7152).setInterval;et({global:!0,bind:!0,forced:ot.setInterval!==st},{setInterval:st})},8417:(it,ut,s)=>{var et=s(2109),ot=s(7854),st=s(7152).setTimeout;et({global:!0,bind:!0,forced:ot.setTimeout!==st},{setTimeout:st})},2564:(it,ut,s)=>{s(6815),s(8417)},5556:(it,ut,s)=>{s(6992);var et=s(2109),ot=s(7854),st=s(6916),Rt=s(1702),ht=s(9781),bt=s(590),ct=s(8052),mt=s(9190),rt=s(8003),pt=s(4994),ft=s(9909),St=s(5787),It=s(614),xt=s(2597),At=s(9974),Dt=s(648),wt=s(9670),Mt=s(111),vt=s(1340),Ft=s(30),Ht=s(9114),Wt=s(8554),tn=s(1246),gn=s(8053),nn=s(5112),qt=s(4362),fn=nn("iterator"),Cn="URLSearchParams",Tn="URLSearchParamsIterator",un=ft.set,mn=ft.getterFor(Cn),yn=ft.getterFor(Tn),pn=Object.getOwnPropertyDescriptor,In=function(Jt){if(!ht)return ot[Jt];var an=pn(ot,Jt);return an&&an.value},kn=In("fetch"),Mn=In("Request"),xn=In("Headers"),Pn=Mn&&Mn.prototype,On=xn&&xn.prototype,Dn=ot.RegExp,Fn=ot.TypeError,dr=ot.decodeURIComponent,ir=ot.encodeURIComponent,Xn=Rt("".charAt),tr=Rt([].join),cn=Rt([].push),Jn=Rt("".replace),Qn=Rt([].shift),sr=Rt([].splice),Bn=Rt("".split),rr=Rt("".slice),nr=/\+/g,Nn=Array(4),Wn=function(Jt){return Nn[Jt-1]||(Nn[Jt-1]=Dn("((?:%[\\da-f]{2}){"+Jt+"})","gi"))},vn=function(Jt){try{return dr(Jt)}catch{return Jt}},Rn=function(Jt){var an=Jn(Jt,nr," "),hn=4;try{return dr(an)}catch{for(;hn;)an=Jn(an,Wn(hn--),vn);return an}},Gt=/[!'()~]|%20/g,Tt={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},nt=function(Jt){return Tt[Jt]},Ct=function(Jt){return Jn(ir(Jt),Gt,nt)},yt=pt(function(Jt,an){un(this,{type:Tn,iterator:Wt(mn(Jt).entries),kind:an})},"Iterator",function(){var Jt=yn(this),an=Jt.kind,hn=Jt.iterator.next(),rn=hn.value;return hn.done||(hn.value=an==="keys"?rn.key:an==="values"?rn.value:[rn.key,rn.value]),hn},!0),Pt=function(Jt){this.entries=[],this.url=null,Jt!==void 0&&(Mt(Jt)?this.parseObject(Jt):this.parseQuery(typeof Jt=="string"?Xn(Jt,0)==="?"?rr(Jt,1):Jt:vt(Jt)))};Pt.prototype={type:Cn,bindURL:function(Jt){this.url=Jt,this.update()},parseObject:function(Jt){var an,hn,rn,dn,Sn,wn,An,_n=tn(Jt);if(_n)for(hn=(an=Wt(Jt,_n)).next;!(rn=st(hn,an)).done;){if(Sn=(dn=Wt(wt(rn.value))).next,(wn=st(Sn,dn)).done||(An=st(Sn,dn)).done||!st(Sn,dn).done)throw Fn("Expected sequence with length 2");cn(this.entries,{key:vt(wn.value),value:vt(An.value)})}else for(var jn in Jt)xt(Jt,jn)&&cn(this.entries,{key:jn,value:vt(Jt[jn])})},parseQuery:function(Jt){if(Jt)for(var an,hn,rn=Bn(Jt,"&"),dn=0;dn<rn.length;)(an=rn[dn++]).length&&(hn=Bn(an,"="),cn(this.entries,{key:Rn(Qn(hn)),value:Rn(tr(hn,"="))}))},serialize:function(){for(var Jt,an=this.entries,hn=[],rn=0;rn<an.length;)Jt=an[rn++],cn(hn,Ct(Jt.key)+"="+Ct(Jt.value));return tr(hn,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Et=function(){St(this,Ut);var Jt=arguments.length>0?arguments[0]:void 0;un(this,new Pt(Jt))},Ut=Et.prototype;if(mt(Ut,{append:function(Jt,an){gn(arguments.length,2);var hn=mn(this);cn(hn.entries,{key:vt(Jt),value:vt(an)}),hn.updateURL()},delete:function(Jt){gn(arguments.length,1);for(var an=mn(this),hn=an.entries,rn=vt(Jt),dn=0;dn<hn.length;)hn[dn].key===rn?sr(hn,dn,1):dn++;an.updateURL()},get:function(Jt){gn(arguments.length,1);for(var an=mn(this).entries,hn=vt(Jt),rn=0;rn<an.length;rn++)if(an[rn].key===hn)return an[rn].value;return null},getAll:function(Jt){gn(arguments.length,1);for(var an=mn(this).entries,hn=vt(Jt),rn=[],dn=0;dn<an.length;dn++)an[dn].key===hn&&cn(rn,an[dn].value);return rn},has:function(Jt){gn(arguments.length,1);for(var an=mn(this).entries,hn=vt(Jt),rn=0;rn<an.length;)if(an[rn++].key===hn)return!0;return!1},set:function(Jt,an){gn(arguments.length,1);for(var hn,rn=mn(this),dn=rn.entries,Sn=!1,wn=vt(Jt),An=vt(an),_n=0;_n<dn.length;_n++)(hn=dn[_n]).key===wn&&(Sn?sr(dn,_n--,1):(Sn=!0,hn.value=An));Sn||cn(dn,{key:wn,value:An}),rn.updateURL()},sort:function(){var Jt=mn(this);qt(Jt.entries,function(an,hn){return an.key>hn.key?1:-1}),Jt.updateURL()},forEach:function(Jt){for(var an,hn=mn(this).entries,rn=At(Jt,arguments.length>1?arguments[1]:void 0),dn=0;dn<hn.length;)rn((an=hn[dn++]).value,an.key,this)},keys:function(){return new yt(this,"keys")},values:function(){return new yt(this,"values")},entries:function(){return new yt(this,"entries")}},{enumerable:!0}),ct(Ut,fn,Ut.entries,{name:"entries"}),ct(Ut,"toString",function(){return mn(this).serialize()},{enumerable:!0}),rt(Et,Cn),et({global:!0,constructor:!0,forced:!bt},{URLSearchParams:Et}),!bt&&It(xn)){var Ot=Rt(On.has),Bt=Rt(On.set),Qt=function(Jt){if(Mt(Jt)){var an,hn=Jt.body;if(Dt(hn)===Cn)return an=Jt.headers?new xn(Jt.headers):new xn,Ot(an,"content-type")||Bt(an,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Ft(Jt,{body:Ht(0,vt(hn)),headers:Ht(0,an)})}return Jt};if(It(kn)&&et({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(Jt){return kn(Jt,arguments.length>1?Qt(arguments[1]):{})}}),It(Mn)){var en=function(Jt){return St(this,Pn),new Mn(Jt,arguments.length>1?Qt(arguments[1]):{})};Pn.constructor=en,en.prototype=Pn,et({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:en})}}it.exports={URLSearchParams:Et,getState:mn}},1637:(it,ut,s)=>{s(5556)},8789:(it,ut,s)=>{s(8783);var et,ot=s(2109),st=s(9781),Rt=s(590),ht=s(7854),bt=s(9974),ct=s(1702),mt=s(8052),rt=s(7045),pt=s(5787),ft=s(2597),St=s(1574),It=s(8457),xt=s(1589),At=s(8710).codeAt,Dt=s(3197),wt=s(1340),Mt=s(8003),vt=s(8053),Ft=s(5556),Ht=s(9909),Wt=Ht.set,tn=Ht.getterFor("URL"),gn=Ft.URLSearchParams,nn=Ft.getState,qt=ht.URL,fn=ht.TypeError,Cn=ht.parseInt,Tn=Math.floor,un=Math.pow,mn=ct("".charAt),yn=ct(/./.exec),pn=ct([].join),In=ct(1 .toString),kn=ct([].pop),Mn=ct([].push),xn=ct("".replace),Pn=ct([].shift),On=ct("".split),Dn=ct("".slice),Fn=ct("".toLowerCase),dr=ct([].unshift),ir="Invalid scheme",Xn="Invalid host",tr="Invalid port",cn=/[a-z]/i,Jn=/[\d+-.a-z]/i,Qn=/\d/,sr=/^0x/i,Bn=/^[0-7]+$/,rr=/^\d+$/,nr=/^[\da-f]+$/i,Nn=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Wn=/[\0\t\n\r #/:<>?@[\\\]^|]/,vn=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,Rn=/[\t\n\r]/g,Gt=function(Vn){var zn,Yn,Rr,Hn;if(typeof Vn=="number"){for(zn=[],Yn=0;Yn<4;Yn++)dr(zn,Vn%256),Vn=Tn(Vn/256);return pn(zn,".")}if(typeof Vn=="object"){for(zn="",Rr=function(jr){for(var xr=null,Ir=1,$n=null,pr=0,_r=0;_r<8;_r++)jr[_r]!==0?(pr>Ir&&(xr=$n,Ir=pr),$n=null,pr=0):($n===null&&($n=_r),++pr);return pr>Ir&&(xr=$n,Ir=pr),xr}(Vn),Yn=0;Yn<8;Yn++)Hn&&Vn[Yn]===0||(Hn&&(Hn=!1),Rr===Yn?(zn+=Yn?":":"::",Hn=!0):(zn+=In(Vn[Yn],16),Yn<7&&(zn+=":")));return"["+zn+"]"}return Vn},Tt={},nt=St({},Tt,{" ":1,'"':1,"<":1,">":1,"`":1}),Ct=St({},nt,{"#":1,"?":1,"{":1,"}":1}),yt=St({},Ct,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Pt=function(Vn,zn){var Yn=At(Vn,0);return Yn>32&&Yn<127&&!ft(zn,Vn)?Vn:encodeURIComponent(Vn)},Et={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Ut=function(Vn,zn){var Yn;return Vn.length==2&&yn(cn,mn(Vn,0))&&((Yn=mn(Vn,1))==":"||!zn&&Yn=="|")},Ot=function(Vn){var zn;return Vn.length>1&&Ut(Dn(Vn,0,2))&&(Vn.length==2||(zn=mn(Vn,2))==="/"||zn==="\\"||zn==="?"||zn==="#")},Bt=function(Vn){return Vn==="."||Fn(Vn)==="%2e"},Qt={},en={},Jt={},an={},hn={},rn={},dn={},Sn={},wn={},An={},_n={},jn={},ar={},fr={},Cr={},gr={},Er={},Nr={},qr={},Qr={},Sr={},Dr=function(Vn,zn,Yn){var Rr,Hn,jr,xr=wt(Vn);if(zn){if(Hn=this.parse(xr))throw fn(Hn);this.searchParams=null}else{if(Yn!==void 0&&(Rr=new Dr(Yn,!0)),Hn=this.parse(xr,null,Rr))throw fn(Hn);(jr=nn(new gn)).bindURL(this),this.searchParams=jr}};Dr.prototype={type:"URL",parse:function(Vn,zn,Yn){var Rr,Hn,jr,xr,Ir,$n=this,pr=zn||Qt,_r=0,yr="",Jr=!1,$r=!1,Co=!1;for(Vn=wt(Vn),zn||($n.scheme="",$n.username="",$n.password="",$n.host=null,$n.port=null,$n.path=[],$n.query=null,$n.fragment=null,$n.cannotBeABaseURL=!1,Vn=xn(Vn,vn,"")),Vn=xn(Vn,Rn,""),Rr=It(Vn);_r<=Rr.length;){switch(Hn=Rr[_r],pr){case Qt:if(!Hn||!yn(cn,Hn)){if(zn)return ir;pr=Jt;continue}yr+=Fn(Hn),pr=en;break;case en:if(Hn&&(yn(Jn,Hn)||Hn=="+"||Hn=="-"||Hn=="."))yr+=Fn(Hn);else{if(Hn!=":"){if(zn)return ir;yr="",pr=Jt,_r=0;continue}if(zn&&($n.isSpecial()!=ft(Et,yr)||yr=="file"&&($n.includesCredentials()||$n.port!==null)||$n.scheme=="file"&&!$n.host))return;if($n.scheme=yr,zn)return void($n.isSpecial()&&Et[$n.scheme]==$n.port&&($n.port=null));yr="",$n.scheme=="file"?pr=fr:$n.isSpecial()&&Yn&&Yn.scheme==$n.scheme?pr=an:$n.isSpecial()?pr=Sn:Rr[_r+1]=="/"?(pr=hn,_r++):($n.cannotBeABaseURL=!0,Mn($n.path,""),pr=qr)}break;case Jt:if(!Yn||Yn.cannotBeABaseURL&&Hn!="#")return ir;if(Yn.cannotBeABaseURL&&Hn=="#"){$n.scheme=Yn.scheme,$n.path=xt(Yn.path),$n.query=Yn.query,$n.fragment="",$n.cannotBeABaseURL=!0,pr=Sr;break}pr=Yn.scheme=="file"?fr:rn;continue;case an:if(Hn!="/"||Rr[_r+1]!="/"){pr=rn;continue}pr=wn,_r++;break;case hn:if(Hn=="/"){pr=An;break}pr=Nr;continue;case rn:if($n.scheme=Yn.scheme,Hn==et)$n.username=Yn.username,$n.password=Yn.password,$n.host=Yn.host,$n.port=Yn.port,$n.path=xt(Yn.path),$n.query=Yn.query;else if(Hn=="/"||Hn=="\\"&&$n.isSpecial())pr=dn;else if(Hn=="?")$n.username=Yn.username,$n.password=Yn.password,$n.host=Yn.host,$n.port=Yn.port,$n.path=xt(Yn.path),$n.query="",pr=Qr;else{if(Hn!="#"){$n.username=Yn.username,$n.password=Yn.password,$n.host=Yn.host,$n.port=Yn.port,$n.path=xt(Yn.path),$n.path.length--,pr=Nr;continue}$n.username=Yn.username,$n.password=Yn.password,$n.host=Yn.host,$n.port=Yn.port,$n.path=xt(Yn.path),$n.query=Yn.query,$n.fragment="",pr=Sr}break;case dn:if(!$n.isSpecial()||Hn!="/"&&Hn!="\\"){if(Hn!="/"){$n.username=Yn.username,$n.password=Yn.password,$n.host=Yn.host,$n.port=Yn.port,pr=Nr;continue}pr=An}else pr=wn;break;case Sn:if(pr=wn,Hn!="/"||mn(yr,_r+1)!="/")continue;_r++;break;case wn:if(Hn!="/"&&Hn!="\\"){pr=An;continue}break;case An:if(Hn=="@"){Jr&&(yr="%40"+yr),Jr=!0,jr=It(yr);for(var eo=0;eo<jr.length;eo++){var ga=jr[eo];if(ga!=":"||Co){var ms=Pt(ga,yt);Co?$n.password+=ms:$n.username+=ms}else Co=!0}yr=""}else if(Hn==et||Hn=="/"||Hn=="?"||Hn=="#"||Hn=="\\"&&$n.isSpecial()){if(Jr&&yr=="")return"Invalid authority";_r-=It(yr).length+1,yr="",pr=_n}else yr+=Hn;break;case _n:case jn:if(zn&&$n.scheme=="file"){pr=gr;continue}if(Hn!=":"||$r){if(Hn==et||Hn=="/"||Hn=="?"||Hn=="#"||Hn=="\\"&&$n.isSpecial()){if($n.isSpecial()&&yr=="")return Xn;if(zn&&yr==""&&($n.includesCredentials()||$n.port!==null))return;if(xr=$n.parseHost(yr))return xr;if(yr="",pr=Er,zn)return;continue}Hn=="["?$r=!0:Hn=="]"&&($r=!1),yr+=Hn}else{if(yr=="")return Xn;if(xr=$n.parseHost(yr))return xr;if(yr="",pr=ar,zn==jn)return}break;case ar:if(!yn(Qn,Hn)){if(Hn==et||Hn=="/"||Hn=="?"||Hn=="#"||Hn=="\\"&&$n.isSpecial()||zn){if(yr!=""){var Qo=Cn(yr,10);if(Qo>65535)return tr;$n.port=$n.isSpecial()&&Qo===Et[$n.scheme]?null:Qo,yr=""}if(zn)return;pr=Er;continue}return tr}yr+=Hn;break;case fr:if($n.scheme="file",Hn=="/"||Hn=="\\")pr=Cr;else{if(!Yn||Yn.scheme!="file"){pr=Nr;continue}if(Hn==et)$n.host=Yn.host,$n.path=xt(Yn.path),$n.query=Yn.query;else if(Hn=="?")$n.host=Yn.host,$n.path=xt(Yn.path),$n.query="",pr=Qr;else{if(Hn!="#"){Ot(pn(xt(Rr,_r),""))||($n.host=Yn.host,$n.path=xt(Yn.path),$n.shortenPath()),pr=Nr;continue}$n.host=Yn.host,$n.path=xt(Yn.path),$n.query=Yn.query,$n.fragment="",pr=Sr}}break;case Cr:if(Hn=="/"||Hn=="\\"){pr=gr;break}Yn&&Yn.scheme=="file"&&!Ot(pn(xt(Rr,_r),""))&&(Ut(Yn.path[0],!0)?Mn($n.path,Yn.path[0]):$n.host=Yn.host),pr=Nr;continue;case gr:if(Hn==et||Hn=="/"||Hn=="\\"||Hn=="?"||Hn=="#"){if(!zn&&Ut(yr))pr=Nr;else if(yr==""){if($n.host="",zn)return;pr=Er}else{if(xr=$n.parseHost(yr))return xr;if($n.host=="localhost"&&($n.host=""),zn)return;yr="",pr=Er}continue}yr+=Hn;break;case Er:if($n.isSpecial()){if(pr=Nr,Hn!="/"&&Hn!="\\")continue}else if(zn||Hn!="?")if(zn||Hn!="#"){if(Hn!=et&&(pr=Nr,Hn!="/"))continue}else $n.fragment="",pr=Sr;else $n.query="",pr=Qr;break;case Nr:if(Hn==et||Hn=="/"||Hn=="\\"&&$n.isSpecial()||!zn&&(Hn=="?"||Hn=="#")){if((Ir=Fn(Ir=yr))===".."||Ir==="%2e."||Ir===".%2e"||Ir==="%2e%2e"?($n.shortenPath(),Hn=="/"||Hn=="\\"&&$n.isSpecial()||Mn($n.path,"")):Bt(yr)?Hn=="/"||Hn=="\\"&&$n.isSpecial()||Mn($n.path,""):($n.scheme=="file"&&!$n.path.length&&Ut(yr)&&($n.host&&($n.host=""),yr=mn(yr,0)+":"),Mn($n.path,yr)),yr="",$n.scheme=="file"&&(Hn==et||Hn=="?"||Hn=="#"))for(;$n.path.length>1&&$n.path[0]==="";)Pn($n.path);Hn=="?"?($n.query="",pr=Qr):Hn=="#"&&($n.fragment="",pr=Sr)}else yr+=Pt(Hn,Ct);break;case qr:Hn=="?"?($n.query="",pr=Qr):Hn=="#"?($n.fragment="",pr=Sr):Hn!=et&&($n.path[0]+=Pt(Hn,Tt));break;case Qr:zn||Hn!="#"?Hn!=et&&(Hn=="'"&&$n.isSpecial()?$n.query+="%27":$n.query+=Hn=="#"?"%23":Pt(Hn,Tt)):($n.fragment="",pr=Sr);break;case Sr:Hn!=et&&($n.fragment+=Pt(Hn,nt))}_r++}},parseHost:function(Vn){var zn,Yn,Rr;if(mn(Vn,0)=="["){if(mn(Vn,Vn.length-1)!="]"||(zn=function(Hn){var jr,xr,Ir,$n,pr,_r,yr,Jr=[0,0,0,0,0,0,0,0],$r=0,Co=null,eo=0,ga=function(){return mn(Hn,eo)};if(ga()==":"){if(mn(Hn,1)!=":")return;eo+=2,Co=++$r}for(;ga();){if($r==8)return;if(ga()!=":"){for(jr=xr=0;xr<4&&yn(nr,ga());)jr=16*jr+Cn(ga(),16),eo++,xr++;if(ga()=="."){if(xr==0||(eo-=xr,$r>6))return;for(Ir=0;ga();){if($n=null,Ir>0){if(!(ga()=="."&&Ir<4))return;eo++}if(!yn(Qn,ga()))return;for(;yn(Qn,ga());){if(pr=Cn(ga(),10),$n===null)$n=pr;else{if($n==0)return;$n=10*$n+pr}if($n>255)return;eo++}Jr[$r]=256*Jr[$r]+$n,++Ir!=2&&Ir!=4||$r++}if(Ir!=4)return;break}if(ga()==":"){if(eo++,!ga())return}else if(ga())return;Jr[$r++]=jr}else{if(Co!==null)return;eo++,Co=++$r}}if(Co!==null)for(_r=$r-Co,$r=7;$r!=0&&_r>0;)yr=Jr[$r],Jr[$r--]=Jr[Co+_r-1],Jr[Co+--_r]=yr;else if($r!=8)return;return Jr}(Dn(Vn,1,-1)),!zn))return Xn;this.host=zn}else if(this.isSpecial()){if(Vn=Dt(Vn),yn(Nn,Vn)||(zn=function(Hn){var jr,xr,Ir,$n,pr,_r,yr,Jr=On(Hn,".");if(Jr.length&&Jr[Jr.length-1]==""&&Jr.length--,(jr=Jr.length)>4)return Hn;for(xr=[],Ir=0;Ir<jr;Ir++){if(($n=Jr[Ir])=="")return Hn;if(pr=10,$n.length>1&&mn($n,0)=="0"&&(pr=yn(sr,$n)?16:8,$n=Dn($n,pr==8?1:2)),$n==="")_r=0;else{if(!yn(pr==10?rr:pr==8?Bn:nr,$n))return Hn;_r=Cn($n,pr)}Mn(xr,_r)}for(Ir=0;Ir<jr;Ir++)if(_r=xr[Ir],Ir==jr-1){if(_r>=un(256,5-jr))return null}else if(_r>255)return null;for(yr=kn(xr),Ir=0;Ir<xr.length;Ir++)yr+=xr[Ir]*un(256,3-Ir);return yr}(Vn),zn===null))return Xn;this.host=zn}else{if(yn(Wn,Vn))return Xn;for(zn="",Yn=It(Vn),Rr=0;Rr<Yn.length;Rr++)zn+=Pt(Yn[Rr],Tt);this.host=zn}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return ft(Et,this.scheme)},shortenPath:function(){var Vn=this.path,zn=Vn.length;!zn||this.scheme=="file"&&zn==1&&Ut(Vn[0],!0)||Vn.length--},serialize:function(){var Vn=this,zn=Vn.scheme,Yn=Vn.username,Rr=Vn.password,Hn=Vn.host,jr=Vn.port,xr=Vn.path,Ir=Vn.query,$n=Vn.fragment,pr=zn+":";return Hn!==null?(pr+="//",Vn.includesCredentials()&&(pr+=Yn+(Rr?":"+Rr:"")+"@"),pr+=Gt(Hn),jr!==null&&(pr+=":"+jr)):zn=="file"&&(pr+="//"),pr+=Vn.cannotBeABaseURL?xr[0]:xr.length?"/"+pn(xr,"/"):"",Ir!==null&&(pr+="?"+Ir),$n!==null&&(pr+="#"+$n),pr},setHref:function(Vn){var zn=this.parse(Vn);if(zn)throw fn(zn);this.searchParams.update()},getOrigin:function(){var Vn=this.scheme,zn=this.port;if(Vn=="blob")try{return new wr(Vn.path[0]).origin}catch{return"null"}return Vn!="file"&&this.isSpecial()?Vn+"://"+Gt(this.host)+(zn!==null?":"+zn:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(Vn){this.parse(wt(Vn)+":",Qt)},getUsername:function(){return this.username},setUsername:function(Vn){var zn=It(wt(Vn));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var Yn=0;Yn<zn.length;Yn++)this.username+=Pt(zn[Yn],yt)}},getPassword:function(){return this.password},setPassword:function(Vn){var zn=It(wt(Vn));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var Yn=0;Yn<zn.length;Yn++)this.password+=Pt(zn[Yn],yt)}},getHost:function(){var Vn=this.host,zn=this.port;return Vn===null?"":zn===null?Gt(Vn):Gt(Vn)+":"+zn},setHost:function(Vn){this.cannotBeABaseURL||this.parse(Vn,_n)},getHostname:function(){var Vn=this.host;return Vn===null?"":Gt(Vn)},setHostname:function(Vn){this.cannotBeABaseURL||this.parse(Vn,jn)},getPort:function(){var Vn=this.port;return Vn===null?"":wt(Vn)},setPort:function(Vn){this.cannotHaveUsernamePasswordPort()||((Vn=wt(Vn))==""?this.port=null:this.parse(Vn,ar))},getPathname:function(){var Vn=this.path;return this.cannotBeABaseURL?Vn[0]:Vn.length?"/"+pn(Vn,"/"):""},setPathname:function(Vn){this.cannotBeABaseURL||(this.path=[],this.parse(Vn,Er))},getSearch:function(){var Vn=this.query;return Vn?"?"+Vn:""},setSearch:function(Vn){(Vn=wt(Vn))==""?this.query=null:(mn(Vn,0)=="?"&&(Vn=Dn(Vn,1)),this.query="",this.parse(Vn,Qr)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var Vn=this.fragment;return Vn?"#"+Vn:""},setHash:function(Vn){(Vn=wt(Vn))!=""?(mn(Vn,0)=="#"&&(Vn=Dn(Vn,1)),this.fragment="",this.parse(Vn,Sr)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var wr=function(Vn){var zn=pt(this,Or),Yn=vt(arguments.length,1)>1?arguments[1]:void 0,Rr=Wt(zn,new Dr(Vn,!1,Yn));st||(zn.href=Rr.serialize(),zn.origin=Rr.getOrigin(),zn.protocol=Rr.getProtocol(),zn.username=Rr.getUsername(),zn.password=Rr.getPassword(),zn.host=Rr.getHost(),zn.hostname=Rr.getHostname(),zn.port=Rr.getPort(),zn.pathname=Rr.getPathname(),zn.search=Rr.getSearch(),zn.searchParams=Rr.getSearchParams(),zn.hash=Rr.getHash())},Or=wr.prototype,Ur=function(Vn,zn){return{get:function(){return tn(this)[Vn]()},set:zn&&function(Yn){return tn(this)[zn](Yn)},configurable:!0,enumerable:!0}};if(st&&(rt(Or,"href",Ur("serialize","setHref")),rt(Or,"origin",Ur("getOrigin")),rt(Or,"protocol",Ur("getProtocol","setProtocol")),rt(Or,"username",Ur("getUsername","setUsername")),rt(Or,"password",Ur("getPassword","setPassword")),rt(Or,"host",Ur("getHost","setHost")),rt(Or,"hostname",Ur("getHostname","setHostname")),rt(Or,"port",Ur("getPort","setPort")),rt(Or,"pathname",Ur("getPathname","setPathname")),rt(Or,"search",Ur("getSearch","setSearch")),rt(Or,"searchParams",Ur("getSearchParams")),rt(Or,"hash",Ur("getHash","setHash"))),mt(Or,"toJSON",function(){return tn(this).serialize()},{enumerable:!0}),mt(Or,"toString",function(){return tn(this).serialize()},{enumerable:!0}),qt){var Hr=qt.createObjectURL,na=qt.revokeObjectURL;Hr&&mt(wr,"createObjectURL",bt(Hr,qt)),na&&mt(wr,"revokeObjectURL",bt(na,qt))}Mt(wr,"URL"),ot({global:!0,constructor:!0,forced:!Rt,sham:!st},{URL:wr})},285:(it,ut,s)=>{s(8789)},3753:(it,ut,s)=>{var et=s(2109),ot=s(6916);et({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return ot(URL.prototype.toString,this)}})},7987:function(it,ut,s){var et,ot;et=function(st){var Rt,ht,bt={template:"[%t] %l:",levelFormatter:function(rt){return rt.toUpperCase()},nameFormatter:function(rt){return rt||"root"},timestampFormatter:function(rt){return rt.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")},format:void 0},ct={},mt={reg:function(rt){if(!rt||!rt.getLogger)throw new TypeError("Argument is not a root logger");Rt=rt},apply:function(rt,pt){if(!rt||!rt.setLevel)throw new TypeError("Argument is not a logger");var ft=rt.methodFactory,St=rt.name||"",It=ct[St]||ct[""]||bt;return ct[St]||(rt.methodFactory=function(xt,At,Dt){var wt=ft(xt,At,Dt),Mt=ct[Dt]||ct[""],vt=Mt.template.indexOf("%t")!==-1,Ft=Mt.template.indexOf("%l")!==-1,Ht=Mt.template.indexOf("%n")!==-1;return function(){for(var Wt="",tn=arguments.length,gn=Array(tn),nn=0;nn<tn;nn++)gn[nn]=arguments[nn];if(St||!ct[Dt]){var qt=Mt.timestampFormatter(new Date),fn=Mt.levelFormatter(xt),Cn=Mt.nameFormatter(Dt);Mt.format?Wt+=Mt.format(fn,Cn,qt):(Wt+=Mt.template,vt&&(Wt=Wt.replace(/%t/,qt)),Ft&&(Wt=Wt.replace(/%l/,fn)),Ht&&(Wt=Wt.replace(/%n/,Cn))),gn.length&&typeof gn[0]=="string"?gn[0]=Wt+" "+gn[0]:gn.unshift(Wt)}wt.apply(void 0,gn)}}),(pt=pt||{}).template&&(pt.format=void 0),ct[St]=function(xt){for(var At,Dt=1,wt=arguments.length;Dt<wt;Dt++)for(At in arguments[Dt])Object.prototype.hasOwnProperty.call(arguments[Dt],At)&&(xt[At]=arguments[Dt][At]);return xt}({},It,pt),rt.setLevel(rt.getLevel()),Rt||rt.warn("It is necessary to call the function reg() of loglevel-plugin-prefix before calling apply. From the next release, it will throw an error. See more: https://github.com/kutuluk/loglevel-plugin-prefix/blob/master/README.md"),rt}};return st&&(ht=st.prefix,mt.noConflict=function(){return st.prefix===mt&&(st.prefix=ht),mt}),mt},(ot=et.call(ut,s,ut,it))===void 0||(it.exports=ot)},2043:function(it,ut,s){var et,ot;(function(st,Rt){et=function(){var ht=function(){},bt="undefined",ct=typeof window!==bt&&typeof window.navigator!==bt&&/Trident\/|MSIE /.test(window.navigator.userAgent),mt=["trace","debug","info","warn","error"];function rt(vt,Ft){var Ht=vt[Ft];if(typeof Ht.bind=="function")return Ht.bind(vt);try{return Function.prototype.bind.call(Ht,vt)}catch{return function(){return Function.prototype.apply.apply(Ht,[vt,arguments])}}}function pt(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function ft(vt){return vt==="debug"&&(vt="log"),typeof console!==bt&&(vt==="trace"&&ct?pt:console[vt]!==void 0?rt(console,vt):console.log!==void 0?rt(console,"log"):ht)}function St(vt,Ft){for(var Ht=0;Ht<mt.length;Ht++){var Wt=mt[Ht];this[Wt]=Ht<vt?ht:this.methodFactory(Wt,vt,Ft)}this.log=this.debug}function It(vt,Ft,Ht){return function(){typeof console!==bt&&(St.call(this,Ft,Ht),this[vt].apply(this,arguments))}}function xt(vt,Ft,Ht){return ft(vt)||It.apply(this,arguments)}function At(vt,Ft,Ht){var Wt,tn=this;Ft=Ft??"WARN";var gn="loglevel";function nn(){var fn;if(typeof window!==bt&&gn){try{fn=window.localStorage[gn]}catch{}if(typeof fn===bt)try{var Cn=window.document.cookie,Tn=Cn.indexOf(encodeURIComponent(gn)+"=");Tn!==-1&&(fn=/^([^;]+)/.exec(Cn.slice(Tn))[1])}catch{}return tn.levels[fn]===void 0&&(fn=void 0),fn}}typeof vt=="string"?gn+=":"+vt:typeof vt=="symbol"&&(gn=void 0),tn.name=vt,tn.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},tn.methodFactory=Ht||xt,tn.getLevel=function(){return Wt},tn.setLevel=function(fn,Cn){if(typeof fn=="string"&&tn.levels[fn.toUpperCase()]!==void 0&&(fn=tn.levels[fn.toUpperCase()]),!(typeof fn=="number"&&fn>=0&&fn<=tn.levels.SILENT))throw"log.setLevel() called with invalid level: "+fn;if(Wt=fn,Cn!==!1&&function(Tn){var un=(mt[Tn]||"silent").toUpperCase();if(typeof window!==bt&&gn){try{return void(window.localStorage[gn]=un)}catch{}try{window.document.cookie=encodeURIComponent(gn)+"="+un+";"}catch{}}}(fn),St.call(tn,fn,vt),typeof console===bt&&fn<tn.levels.SILENT)return"No console available for logging"},tn.setDefaultLevel=function(fn){Ft=fn,nn()||tn.setLevel(fn,!1)},tn.resetLevel=function(){tn.setLevel(Ft,!1),function(){if(typeof window!==bt&&gn){try{return void window.localStorage.removeItem(gn)}catch{}try{window.document.cookie=encodeURIComponent(gn)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}()},tn.enableAll=function(fn){tn.setLevel(tn.levels.TRACE,fn)},tn.disableAll=function(fn){tn.setLevel(tn.levels.SILENT,fn)};var qt=nn();qt==null&&(qt=Ft),tn.setLevel(qt,!1)}var Dt=new At,wt={};Dt.getLogger=function(vt){if(typeof vt!="symbol"&&typeof vt!="string"||vt==="")throw new TypeError("You must supply a name when creating a logger.");var Ft=wt[vt];return Ft||(Ft=wt[vt]=new At(vt,Dt.getLevel(),Dt.methodFactory)),Ft};var Mt=typeof window!==bt?window.log:void 0;return Dt.noConflict=function(){return typeof window!==bt&&window.log===Dt&&(window.log=Mt),Dt},Dt.getLoggers=function(){return wt},Dt.default=Dt,Dt},(ot=et.call(ut,s,ut,it))===void 0||(it.exports=ot)})()},7618:it=>{function ut(Wt,tn){if(!et)return!1;const gn=Wt.buffer;let nn=rt.get(gn);if(nn==null){if((nn=s.validate(gn))&&tn)try{new s.Instance(new s.Module(gn)).exports[0]()}catch{nn=!1}rt.set(gn,nn)}return nn}const s=globalThis.WebAssembly,et=typeof s=="object",ot=Wt=>Wt!==void 0,st=(...Wt)=>Uint8Array.of(0,97,115,109,1,0,0,0,...Wt),Rt=(...Wt)=>Uint32Array.of(1836278016,1,...Wt),ht=(...Wt)=>Rt(1610679297,33751040,...Wt,40239360,259),bt=(...Wt)=>st(1,4,1,96,0,0,3,2,1,0,...Wt,11,0,10,4,110,97,109,101,2,3,1,0,0),ct=(...Wt)=>Uint16Array.of(24832,28019,1,0,1025,24577,0,515,1,...Wt),mt=(...Wt)=>ct(...Wt,2842,4096,28164,28001,357,260,256,560,259,0),rt=new WeakMap,pt=Rt(1610679553,58589440,117440770,805372165,101318656,1107297281,268438272,1835101700,17039717,36700416,259),ft=st(5,3,1,4,1,0,8,4,110,97,109,101,2,1,0),St=ct(773,1,2561,269,11,65,65,65,3068,2816,2560,28164,28001,613,259,0),It=Rt(1610679297,33751040,134873089,100664833,185276736),xt=st(2,8,1,1,97,1,98,3,127,1,6,6,1,127,1,65,0,11,7,5,1,1,97,3,1,0,8,4,110,97,109,101,2,1,0),At=Uint16Array.of(24832,28019,1,0,1537,24577,512,32639,515,1,2058,1537,16640,16640,2816,2560,28164,28001,613,259,0),Dt=mt(3082,2561,17152,0,0,252),wt=mt(2058,1537,16640,49152),Mt=ht(101318657,301990913,268438272,1835101700,17039717),vt=bt(5,4,1,3,1,1,10,7,1,5,0,254,3,0),Ft=ht(84344833,6357249,17369600,4259847,186257917,1845758464),Ht=bt(10,7,1,5,0,208,112,26);it.exports={support:(Wt=1)=>et&&ut(Uint32Array.of(1836278016,Wt)),get supportStreaming(){return et&&ot(s.instantiateStreaming)},feature:{get bigInt(){return ut(pt,!0)},get bulk(){return ut(St)},get exceptions(){return ut(It)},get memory64(){return ut(ft)},get mutableGlobal(){return ut(xt)},get multiValue(){return ut(At)},get saturateConversions(){return ut(Dt)},get signExtensions(){return ut(wt)},get tailCall(){return ut(Mt)},get threads(){return ut(vt)},get simd(){return ut(Ft)},get references(){return ut(Ht)},get typeReflection(){return et&&ot(s.Memory.type)},get funcReferences(){return et&&ot(s.Function)}}}}},at={};function lt(it){var ut=at[it];if(ut!==void 0)return ut.exports;var s=at[it]={id:it,loaded:!1,exports:{}};return tt[it].call(s.exports,s,s.exports,lt),s.loaded=!0,s.exports}return lt.amdO={},lt.n=it=>{var ut=it&&it.__esModule?()=>it.default:()=>it;return lt.d(ut,{a:ut}),ut},lt.d=(it,ut)=>{for(var s in ut)lt.o(ut,s)&&!lt.o(it,s)&&Object.defineProperty(it,s,{enumerable:!0,get:ut[s]})},lt.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),lt.hmd=it=>((it=Object.create(it)).children||(it.children=[]),Object.defineProperty(it,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+it.id)}}),it),lt.o=(it,ut)=>Object.prototype.hasOwnProperty.call(it,ut),lt.r=it=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(it,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(it,"__esModule",{value:!0})},lt(1256)})())})(apiRTC_min,apiRTC_min.exports);var apiRTC_minExports=apiRTC_min.exports;function _objectWithoutPropertiesLoose(a,o){if(a==null)return{};var _e={},tt=Object.keys(a),at,lt;for(lt=0;lt<tt.length;lt++)at=tt[lt],!(o.indexOf(at)>=0)&&(_e[at]=a[at]);return _e}function _extends(){return _extends=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var tt in _e)Object.prototype.hasOwnProperty.call(_e,tt)&&(a[tt]=_e[tt])}return a},_extends.apply(this,arguments)}function r$1(a){var o,_e,tt="";if(typeof a=="string"||typeof a=="number")tt+=a;else if(typeof a=="object")if(Array.isArray(a))for(o=0;o<a.length;o++)a[o]&&(_e=r$1(a[o]))&&(tt&&(tt+=" "),tt+=_e);else for(o in a)a[o]&&(tt&&(tt+=" "),tt+=o);return tt}function clsx(){for(var a,o,_e=0,tt="";_e<arguments.length;)(a=arguments[_e++])&&(o=r$1(a))&&(tt&&(tt+=" "),tt+=o);return tt}function isPlainObject(a){return a!==null&&typeof a=="object"&&a.constructor===Object}function deepClone(a){if(!isPlainObject(a))return a;const o={};return Object.keys(a).forEach(_e=>{o[_e]=deepClone(a[_e])}),o}function deepmerge(a,o,_e={clone:!0}){const tt=_e.clone?_extends({},a):a;return isPlainObject(a)&&isPlainObject(o)&&Object.keys(o).forEach(at=>{at!=="__proto__"&&(isPlainObject(o[at])&&at in a&&isPlainObject(a[at])?tt[at]=deepmerge(a[at],o[at],_e):_e.clone?tt[at]=isPlainObject(o[at])?deepClone(o[at]):o[at]:tt[at]=o[at])}),tt}function formatMuiErrorMessage(a){let o="https://mui.com/production-error/?code="+a;for(let _e=1;_e<arguments.length;_e+=1)o+="&args[]="+encodeURIComponent(arguments[_e]);return"Minified MUI error #"+a+"; visit "+o+" for the full message."}var reactIs_production_min$1={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b$2=Symbol.for("react.element"),c$2=Symbol.for("react.portal"),d$3=Symbol.for("react.fragment"),e$1=Symbol.for("react.strict_mode"),f$1=Symbol.for("react.profiler"),g$2=Symbol.for("react.provider"),h$2=Symbol.for("react.context"),k$2=Symbol.for("react.server_context"),l$1=Symbol.for("react.forward_ref"),m$2=Symbol.for("react.suspense"),n$1=Symbol.for("react.suspense_list"),p$1=Symbol.for("react.memo"),q$2=Symbol.for("react.lazy"),t$1=Symbol.for("react.offscreen"),u;u=Symbol.for("react.module.reference");function v$2(a){if(typeof a=="object"&&a!==null){var o=a.$$typeof;switch(o){case b$2:switch(a=a.type,a){case d$3:case f$1:case e$1:case m$2:case n$1:return a;default:switch(a=a&&a.$$typeof,a){case k$2:case h$2:case l$1:case q$2:case p$1:case g$2:return a;default:return o}}case c$2:return o}}}reactIs_production_min$1.ContextConsumer=h$2;reactIs_production_min$1.ContextProvider=g$2;reactIs_production_min$1.Element=b$2;reactIs_production_min$1.ForwardRef=l$1;reactIs_production_min$1.Fragment=d$3;reactIs_production_min$1.Lazy=q$2;reactIs_production_min$1.Memo=p$1;reactIs_production_min$1.Portal=c$2;reactIs_production_min$1.Profiler=f$1;reactIs_production_min$1.StrictMode=e$1;reactIs_production_min$1.Suspense=m$2;reactIs_production_min$1.SuspenseList=n$1;reactIs_production_min$1.isAsyncMode=function(){return!1};reactIs_production_min$1.isConcurrentMode=function(){return!1};reactIs_production_min$1.isContextConsumer=function(a){return v$2(a)===h$2};reactIs_production_min$1.isContextProvider=function(a){return v$2(a)===g$2};reactIs_production_min$1.isElement=function(a){return typeof a=="object"&&a!==null&&a.$$typeof===b$2};reactIs_production_min$1.isForwardRef=function(a){return v$2(a)===l$1};reactIs_production_min$1.isFragment=function(a){return v$2(a)===d$3};reactIs_production_min$1.isLazy=function(a){return v$2(a)===q$2};reactIs_production_min$1.isMemo=function(a){return v$2(a)===p$1};reactIs_production_min$1.isPortal=function(a){return v$2(a)===c$2};reactIs_production_min$1.isProfiler=function(a){return v$2(a)===f$1};reactIs_production_min$1.isStrictMode=function(a){return v$2(a)===e$1};reactIs_production_min$1.isSuspense=function(a){return v$2(a)===m$2};reactIs_production_min$1.isSuspenseList=function(a){return v$2(a)===n$1};reactIs_production_min$1.isValidElementType=function(a){return typeof a=="string"||typeof a=="function"||a===d$3||a===f$1||a===e$1||a===m$2||a===n$1||a===t$1||typeof a=="object"&&a!==null&&(a.$$typeof===q$2||a.$$typeof===p$1||a.$$typeof===g$2||a.$$typeof===h$2||a.$$typeof===l$1||a.$$typeof===u||a.getModuleId!==void 0)};reactIs_production_min$1.typeOf=v$2;function capitalize(a){if(typeof a!="string")throw new Error(formatMuiErrorMessage(7));return a.charAt(0).toUpperCase()+a.slice(1)}function createChainedFunction(...a){return a.reduce((o,_e)=>_e==null?o:function(...at){o.apply(this,at),_e.apply(this,at)},()=>{})}function debounce$1(a,o=166){let _e;function tt(...at){const lt=()=>{a.apply(this,at)};clearTimeout(_e),_e=setTimeout(lt,o)}return tt.clear=()=>{clearTimeout(_e)},tt}function ownerDocument(a){return a&&a.ownerDocument||document}function ownerWindow(a){return ownerDocument(a).defaultView||window}function setRef(a,o){typeof a=="function"?a(o):a&&(a.current=o)}const useEnhancedEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,useEnhancedEffect$1=useEnhancedEffect;let globalId=0;function useGlobalId(a){const[o,_e]=reactExports.useState(a),tt=a||o;return reactExports.useEffect(()=>{o==null&&(globalId+=1,_e(`mui-${globalId}`))},[o]),tt}const maybeReactUseId=React$1["useId"];function useId(a){if(maybeReactUseId!==void 0){const o=maybeReactUseId();return a??o}return useGlobalId(a)}function useControlled({controlled:a,default:o,name:_e,state:tt="value"}){const{current:at}=reactExports.useRef(a!==void 0),[lt,it]=reactExports.useState(o),ut=at?a:lt,s=reactExports.useCallback(et=>{at||it(et)},[]);return[ut,s]}function useEventCallback(a){const o=reactExports.useRef(a);return useEnhancedEffect$1(()=>{o.current=a}),reactExports.useCallback((..._e)=>(0,o.current)(..._e),[])}function useForkRef(...a){return reactExports.useMemo(()=>a.every(o=>o==null)?null:o=>{a.forEach(_e=>{setRef(_e,o)})},a)}let hadKeyboardEvent=!0,hadFocusVisibleRecently=!1,hadFocusVisibleRecentlyTimeout;const inputTypesWhitelist={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function focusTriggersKeyboardModality(a){const{type:o,tagName:_e}=a;return!!(_e==="INPUT"&&inputTypesWhitelist[o]&&!a.readOnly||_e==="TEXTAREA"&&!a.readOnly||a.isContentEditable)}function handleKeyDown(a){a.metaKey||a.altKey||a.ctrlKey||(hadKeyboardEvent=!0)}function handlePointerDown(){hadKeyboardEvent=!1}function handleVisibilityChange(){this.visibilityState==="hidden"&&hadFocusVisibleRecently&&(hadKeyboardEvent=!0)}function prepare(a){a.addEventListener("keydown",handleKeyDown,!0),a.addEventListener("mousedown",handlePointerDown,!0),a.addEventListener("pointerdown",handlePointerDown,!0),a.addEventListener("touchstart",handlePointerDown,!0),a.addEventListener("visibilitychange",handleVisibilityChange,!0)}function isFocusVisible(a){const{target:o}=a;try{return o.matches(":focus-visible")}catch{}return hadKeyboardEvent||focusTriggersKeyboardModality(o)}function useIsFocusVisible(){const a=reactExports.useCallback(at=>{at!=null&&prepare(at.ownerDocument)},[]),o=reactExports.useRef(!1);function _e(){return o.current?(hadFocusVisibleRecently=!0,window.clearTimeout(hadFocusVisibleRecentlyTimeout),hadFocusVisibleRecentlyTimeout=window.setTimeout(()=>{hadFocusVisibleRecently=!1},100),o.current=!1,!0):!1}function tt(at){return isFocusVisible(at)?(o.current=!0,!0):!1}return{isFocusVisibleRef:o,onFocus:tt,onBlur:_e,ref:a}}function getScrollbarSize(a){const o=a.documentElement.clientWidth;return Math.abs(window.innerWidth-o)}function resolveProps(a,o){const _e=_extends({},o);return Object.keys(a).forEach(tt=>{if(tt.toString().match(/^(components|slots)$/))_e[tt]=_extends({},a[tt],_e[tt]);else if(tt.toString().match(/^(componentsProps|slotProps)$/)){const at=a[tt]||{},lt=o[tt];_e[tt]={},!lt||!Object.keys(lt)?_e[tt]=at:!at||!Object.keys(at)?_e[tt]=lt:(_e[tt]=_extends({},lt),Object.keys(at).forEach(it=>{_e[tt][it]=resolveProps(at[it],lt[it])}))}else _e[tt]===void 0&&(_e[tt]=a[tt])}),_e}function composeClasses(a,o,_e=void 0){const tt={};return Object.keys(a).forEach(at=>{tt[at]=a[at].reduce((lt,it)=>{if(it){const ut=o(it);ut!==""&&lt.push(ut),_e&&_e[it]&&lt.push(_e[it])}return lt},[]).join(" ")}),tt}const defaultGenerator=a=>a,createClassNameGenerator=()=>{let a=defaultGenerator;return{configure(o){a=o},generate(o){return a(o)},reset(){a=defaultGenerator}}},ClassNameGenerator=createClassNameGenerator(),ClassNameGenerator$1=ClassNameGenerator,globalStateClassesMapping={active:"active",checked:"checked",completed:"completed",disabled:"disabled",readOnly:"readOnly",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function generateUtilityClass(a,o,_e="Mui"){const tt=globalStateClassesMapping[o];return tt?`${_e}-${tt}`:`${ClassNameGenerator$1.generate(a)}-${o}`}function generateUtilityClasses(a,o,_e="Mui"){const tt={};return o.forEach(at=>{tt[at]=generateUtilityClass(a,at,_e)}),tt}function memoize$1(a){var o=Object.create(null);return function(_e){return o[_e]===void 0&&(o[_e]=a(_e)),o[_e]}}var reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=memoize$1(function(a){return reactPropsRegex.test(a)||a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&a.charCodeAt(2)<91});function sheetForTag(a){if(a.sheet)return a.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===a)return document.styleSheets[o]}function createStyleElement(a){var o=document.createElement("style");return o.setAttribute("data-emotion",a.key),a.nonce!==void 0&&o.setAttribute("nonce",a.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var StyleSheet=function(){function a(_e){var tt=this;this._insertTag=function(at){var lt;tt.tags.length===0?tt.insertionPoint?lt=tt.insertionPoint.nextSibling:tt.prepend?lt=tt.container.firstChild:lt=tt.before:lt=tt.tags[tt.tags.length-1].nextSibling,tt.container.insertBefore(at,lt),tt.tags.push(at)},this.isSpeedy=_e.speedy===void 0?!0:_e.speedy,this.tags=[],this.ctr=0,this.nonce=_e.nonce,this.key=_e.key,this.container=_e.container,this.prepend=_e.prepend,this.insertionPoint=_e.insertionPoint,this.before=null}var o=a.prototype;return o.hydrate=function(tt){tt.forEach(this._insertTag)},o.insert=function(tt){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(createStyleElement(this));var at=this.tags[this.tags.length-1];if(this.isSpeedy){var lt=sheetForTag(at);try{lt.insertRule(tt,lt.cssRules.length)}catch{}}else at.appendChild(document.createTextNode(tt));this.ctr++},o.flush=function(){this.tags.forEach(function(tt){return tt.parentNode&&tt.parentNode.removeChild(tt)}),this.tags=[],this.ctr=0},a}(),MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",abs=Math.abs,from=String.fromCharCode,assign=Object.assign;function hash$2(a,o){return charat(a,0)^45?(((o<<2^charat(a,0))<<2^charat(a,1))<<2^charat(a,2))<<2^charat(a,3):0}function trim(a){return a.trim()}function match(a,o){return(a=o.exec(a))?a[0]:a}function replace(a,o,_e){return a.replace(o,_e)}function indexof(a,o){return a.indexOf(o)}function charat(a,o){return a.charCodeAt(o)|0}function substr(a,o,_e){return a.slice(o,_e)}function strlen(a){return a.length}function sizeof(a){return a.length}function append(a,o){return o.push(a),a}function combine(a,o){return a.map(o).join("")}var line=1,column=1,length=0,position=0,character=0,characters="";function node(a,o,_e,tt,at,lt,it){return{value:a,root:o,parent:_e,type:tt,props:at,children:lt,line,column,length:it,return:""}}function copy(a,o){return assign(node("",null,null,"",null,null,0),a,{length:-a.length},o)}function char(){return character}function prev(){return character=position>0?charat(characters,--position):0,column--,character===10&&(column=1,line--),character}function next(){return character=position<length?charat(characters,position++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position)}function caret(){return position}function slice(a,o){return substr(characters,a,o)}function token(a){switch(a){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(a){return line=column=1,length=strlen(characters=a),position=0,[]}function dealloc(a){return characters="",a}function delimit(a){return trim(slice(position-1,delimiter(a===91?a+2:a===40?a+1:a)))}function whitespace(a){for(;(character=peek())&&character<33;)next();return token(a)>2||token(character)>3?"":" "}function escaping(a,o){for(;--o&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice(a,caret()+(o<6&&peek()==32&&next()==32))}function delimiter(a){for(;next();)switch(character){case a:return position;case 34:case 39:a!==34&&a!==39&&delimiter(character);break;case 40:a===41&&delimiter(a);break;case 92:next();break}return position}function commenter(a,o){for(;next()&&a+character!==47+10;)if(a+character===42+42&&peek()===47)break;return"/*"+slice(o,position-1)+"*"+from(a===47?a:next())}function identifier(a){for(;!token(peek());)next();return slice(a,position)}function compile(a){return dealloc(parse("",null,null,null,[""],a=alloc(a),0,[0],a))}function parse(a,o,_e,tt,at,lt,it,ut,s){for(var et=0,ot=0,st=it,Rt=0,ht=0,bt=0,ct=1,mt=1,rt=1,pt=0,ft="",St=at,It=lt,xt=tt,At=ft;mt;)switch(bt=pt,pt=next()){case 40:if(bt!=108&&charat(At,st-1)==58){indexof(At+=replace(delimit(pt),"&","&\f"),"&\f")!=-1&&(rt=-1);break}case 34:case 39:case 91:At+=delimit(pt);break;case 9:case 10:case 13:case 32:At+=whitespace(bt);break;case 92:At+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),o,_e),s);break;default:At+="/"}break;case 123*ct:ut[et++]=strlen(At)*rt;case 125*ct:case 59:case 0:switch(pt){case 0:case 125:mt=0;case 59+ot:rt==-1&&(At=replace(At,/\f/g,"")),ht>0&&strlen(At)-st&&append(ht>32?declaration(At+";",tt,_e,st-1):declaration(replace(At," ","")+";",tt,_e,st-2),s);break;case 59:At+=";";default:if(append(xt=ruleset(At,o,_e,et,ot,at,ut,ft,St=[],It=[],st),lt),pt===123)if(ot===0)parse(At,o,xt,xt,St,lt,st,ut,It);else switch(Rt===99&&charat(At,3)===110?100:Rt){case 100:case 109:case 115:parse(a,xt,xt,tt&&append(ruleset(a,xt,xt,0,0,at,ut,ft,at,St=[],st),It),at,It,st,ut,tt?St:It);break;default:parse(At,xt,xt,xt,[""],It,0,ut,It)}}et=ot=ht=0,ct=rt=1,ft=At="",st=it;break;case 58:st=1+strlen(At),ht=bt;default:if(ct<1){if(pt==123)--ct;else if(pt==125&&ct++==0&&prev()==125)continue}switch(At+=from(pt),pt*ct){case 38:rt=ot>0?1:(At+="\f",-1);break;case 44:ut[et++]=(strlen(At)-1)*rt,rt=1;break;case 64:peek()===45&&(At+=delimit(next())),Rt=peek(),ot=st=strlen(ft=At+=identifier(caret())),pt++;break;case 45:bt===45&&strlen(At)==2&&(ct=0)}}return lt}function ruleset(a,o,_e,tt,at,lt,it,ut,s,et,ot){for(var st=at-1,Rt=at===0?lt:[""],ht=sizeof(Rt),bt=0,ct=0,mt=0;bt<tt;++bt)for(var rt=0,pt=substr(a,st+1,st=abs(ct=it[bt])),ft=a;rt<ht;++rt)(ft=trim(ct>0?Rt[rt]+" "+pt:replace(pt,/&\f/g,Rt[rt])))&&(s[mt++]=ft);return node(a,o,_e,at===0?RULESET:ut,s,et,ot)}function comment(a,o,_e){return node(a,o,_e,COMMENT,from(char()),substr(a,2,-2),0)}function declaration(a,o,_e,tt){return node(a,o,_e,DECLARATION,substr(a,0,tt),substr(a,tt+1,-1),tt)}function serialize(a,o){for(var _e="",tt=sizeof(a),at=0;at<tt;at++)_e+=o(a[at],at,a,o)||"";return _e}function stringify(a,o,_e,tt){switch(a.type){case IMPORT:case DECLARATION:return a.return=a.return||a.value;case COMMENT:return"";case KEYFRAMES:return a.return=a.value+"{"+serialize(a.children,tt)+"}";case RULESET:a.value=a.props.join(",")}return strlen(_e=serialize(a.children,tt))?a.return=a.value+"{"+_e+"}":""}function middleware(a){var o=sizeof(a);return function(_e,tt,at,lt){for(var it="",ut=0;ut<o;ut++)it+=a[ut](_e,tt,at,lt)||"";return it}}function rulesheet(a){return function(o){o.root||(o=o.return)&&a(o)}}var identifierWithPointTracking=function(o,_e,tt){for(var at=0,lt=0;at=lt,lt=peek(),at===38&&lt===12&&(_e[tt]=1),!token(lt);)next();return slice(o,position)},toRules=function(o,_e){var tt=-1,at=44;do switch(token(at)){case 0:at===38&&peek()===12&&(_e[tt]=1),o[tt]+=identifierWithPointTracking(position-1,_e,tt);break;case 2:o[tt]+=delimit(at);break;case 4:if(at===44){o[++tt]=peek()===58?"&\f":"",_e[tt]=o[tt].length;break}default:o[tt]+=from(at)}while(at=next());return o},getRules=function(o,_e){return dealloc(toRules(alloc(o),_e))},fixedElements=new WeakMap,compat=function(o){if(!(o.type!=="rule"||!o.parent||o.length<1)){for(var _e=o.value,tt=o.parent,at=o.column===tt.column&&o.line===tt.line;tt.type!=="rule";)if(tt=tt.parent,!tt)return;if(!(o.props.length===1&&_e.charCodeAt(0)!==58&&!fixedElements.get(tt))&&!at){fixedElements.set(o,!0);for(var lt=[],it=getRules(_e,lt),ut=tt.props,s=0,et=0;s<it.length;s++)for(var ot=0;ot<ut.length;ot++,et++)o.props[et]=lt[s]?it[s].replace(/&\f/g,ut[ot]):ut[ot]+" "+it[s]}}},removeLabel=function(o){if(o.type==="decl"){var _e=o.value;_e.charCodeAt(0)===108&&_e.charCodeAt(2)===98&&(o.return="",o.value="")}};function prefix(a,o){switch(hash$2(a,o)){case 5103:return WEBKIT+"print-"+a+a;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+a+a;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+a+MOZ+a+MS+a+a;case 6828:case 4268:return WEBKIT+a+MS+a+a;case 6165:return WEBKIT+a+MS+"flex-"+a+a;case 5187:return WEBKIT+a+replace(a,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+a;case 5443:return WEBKIT+a+MS+"flex-item-"+replace(a,/flex-|-self/,"")+a;case 4675:return WEBKIT+a+MS+"flex-line-pack"+replace(a,/align-content|flex-|-self/,"")+a;case 5548:return WEBKIT+a+MS+replace(a,"shrink","negative")+a;case 5292:return WEBKIT+a+MS+replace(a,"basis","preferred-size")+a;case 6060:return WEBKIT+"box-"+replace(a,"-grow","")+WEBKIT+a+MS+replace(a,"grow","positive")+a;case 4554:return WEBKIT+replace(a,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+a;case 6187:return replace(replace(replace(a,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),a,"")+a;case 5495:case 3959:return replace(a,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace(replace(a,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+a+a;case 4095:case 3583:case 4068:case 2532:return replace(a,/(.+)-inline(.+)/,WEBKIT+"$1$2")+a;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(a)-1-o>6)switch(charat(a,o+1)){case 109:if(charat(a,o+4)!==45)break;case 102:return replace(a,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(a,o+3)==108?"$3":"$2-$3"))+a;case 115:return~indexof(a,"stretch")?prefix(replace(a,"stretch","fill-available"),o)+a:a}break;case 4949:if(charat(a,o+1)!==115)break;case 6444:switch(charat(a,strlen(a)-3-(~indexof(a,"!important")&&10))){case 107:return replace(a,":",":"+WEBKIT)+a;case 101:return replace(a,/(.+:)([^;!]+)(;|!.+)?/,"$1"+WEBKIT+(charat(a,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+a}break;case 5936:switch(charat(a,o+11)){case 114:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"tb")+a;case 108:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"tb-rl")+a;case 45:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"lr")+a}return WEBKIT+a+MS+a+a}return a}var prefixer=function(o,_e,tt,at){if(o.length>-1&&!o.return)switch(o.type){case DECLARATION:o.return=prefix(o.value,o.length);break;case KEYFRAMES:return serialize([copy(o,{value:replace(o.value,"@","@"+WEBKIT)})],at);case RULESET:if(o.length)return combine(o.props,function(lt){switch(match(lt,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return serialize([copy(o,{props:[replace(lt,/:(read-\w+)/,":"+MOZ+"$1")]})],at);case"::placeholder":return serialize([copy(o,{props:[replace(lt,/:(plac\w+)/,":"+WEBKIT+"input-$1")]}),copy(o,{props:[replace(lt,/:(plac\w+)/,":"+MOZ+"$1")]}),copy(o,{props:[replace(lt,/:(plac\w+)/,MS+"input-$1")]})],at)}return""})}},defaultStylisPlugins=[prefixer],createCache=function(o){var _e=o.key;if(_e==="css"){var tt=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(tt,function(ct){var mt=ct.getAttribute("data-emotion");mt.indexOf(" ")!==-1&&(document.head.appendChild(ct),ct.setAttribute("data-s",""))})}var at=o.stylisPlugins||defaultStylisPlugins,lt={},it,ut=[];it=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+_e+' "]'),function(ct){for(var mt=ct.getAttribute("data-emotion").split(" "),rt=1;rt<mt.length;rt++)lt[mt[rt]]=!0;ut.push(ct)});var s,et=[compat,removeLabel];{var ot,st=[stringify,rulesheet(function(ct){ot.insert(ct)})],Rt=middleware(et.concat(at,st)),ht=function(mt){return serialize(compile(mt),Rt)};s=function(mt,rt,pt,ft){ot=pt,ht(mt?mt+"{"+rt.styles+"}":rt.styles),ft&&(bt.inserted[rt.name]=!0)}}var bt={key:_e,sheet:new StyleSheet({key:_e,container:it,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend,insertionPoint:o.insertionPoint}),nonce:o.nonce,inserted:lt,registered:{},insert:s};return bt.sheet.hydrate(ut),bt},reactIs$1={exports:{}},reactIs_production_min={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b$1=typeof Symbol=="function"&&Symbol.for,c$1=b$1?Symbol.for("react.element"):60103,d$2=b$1?Symbol.for("react.portal"):60106,e=b$1?Symbol.for("react.fragment"):60107,f=b$1?Symbol.for("react.strict_mode"):60108,g$1=b$1?Symbol.for("react.profiler"):60114,h$1=b$1?Symbol.for("react.provider"):60109,k$1=b$1?Symbol.for("react.context"):60110,l=b$1?Symbol.for("react.async_mode"):60111,m$1=b$1?Symbol.for("react.concurrent_mode"):60111,n=b$1?Symbol.for("react.forward_ref"):60112,p=b$1?Symbol.for("react.suspense"):60113,q$1=b$1?Symbol.for("react.suspense_list"):60120,r=b$1?Symbol.for("react.memo"):60115,t=b$1?Symbol.for("react.lazy"):60116,v$1=b$1?Symbol.for("react.block"):60121,w$2=b$1?Symbol.for("react.fundamental"):60117,x$1=b$1?Symbol.for("react.responder"):60118,y$2=b$1?Symbol.for("react.scope"):60119;function z$1(a){if(typeof a=="object"&&a!==null){var o=a.$$typeof;switch(o){case c$1:switch(a=a.type,a){case l:case m$1:case e:case g$1:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k$1:case n:case t:case r:case h$1:return a;default:return o}}case d$2:return o}}}function A$1(a){return z$1(a)===m$1}reactIs_production_min.AsyncMode=l;reactIs_production_min.ConcurrentMode=m$1;reactIs_production_min.ContextConsumer=k$1;reactIs_production_min.ContextProvider=h$1;reactIs_production_min.Element=c$1;reactIs_production_min.ForwardRef=n;reactIs_production_min.Fragment=e;reactIs_production_min.Lazy=t;reactIs_production_min.Memo=r;reactIs_production_min.Portal=d$2;reactIs_production_min.Profiler=g$1;reactIs_production_min.StrictMode=f;reactIs_production_min.Suspense=p;reactIs_production_min.isAsyncMode=function(a){return A$1(a)||z$1(a)===l};reactIs_production_min.isConcurrentMode=A$1;reactIs_production_min.isContextConsumer=function(a){return z$1(a)===k$1};reactIs_production_min.isContextProvider=function(a){return z$1(a)===h$1};reactIs_production_min.isElement=function(a){return typeof a=="object"&&a!==null&&a.$$typeof===c$1};reactIs_production_min.isForwardRef=function(a){return z$1(a)===n};reactIs_production_min.isFragment=function(a){return z$1(a)===e};reactIs_production_min.isLazy=function(a){return z$1(a)===t};reactIs_production_min.isMemo=function(a){return z$1(a)===r};reactIs_production_min.isPortal=function(a){return z$1(a)===d$2};reactIs_production_min.isProfiler=function(a){return z$1(a)===g$1};reactIs_production_min.isStrictMode=function(a){return z$1(a)===f};reactIs_production_min.isSuspense=function(a){return z$1(a)===p};reactIs_production_min.isValidElementType=function(a){return typeof a=="string"||typeof a=="function"||a===e||a===m$1||a===g$1||a===f||a===p||a===q$1||typeof a=="object"&&a!==null&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h$1||a.$$typeof===k$1||a.$$typeof===n||a.$$typeof===w$2||a.$$typeof===x$1||a.$$typeof===y$2||a.$$typeof===v$1)};reactIs_production_min.typeOf=z$1;reactIs$1.exports=reactIs_production_min;var reactIsExports=reactIs$1.exports,reactIs=reactIsExports,FORWARD_REF_STATICS={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MEMO_STATICS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TYPE_STATICS={};TYPE_STATICS[reactIs.ForwardRef]=FORWARD_REF_STATICS;TYPE_STATICS[reactIs.Memo]=MEMO_STATICS;var isBrowser=!0;function getRegisteredStyles(a,o,_e){var tt="";return _e.split(" ").forEach(function(at){a[at]!==void 0?o.push(a[at]+";"):tt+=at+" "}),tt}var registerStyles=function(o,_e,tt){var at=o.key+"-"+_e.name;(tt===!1||isBrowser===!1)&&o.registered[at]===void 0&&(o.registered[at]=_e.styles)},insertStyles=function(o,_e,tt){registerStyles(o,_e,tt);var at=o.key+"-"+_e.name;if(o.inserted[_e.name]===void 0){var lt=_e;do o.insert(_e===lt?"."+at:"",lt,o.sheet,!0),lt=lt.next;while(lt!==void 0)}};function murmur2(a){for(var o=0,_e,tt=0,at=a.length;at>=4;++tt,at-=4)_e=a.charCodeAt(tt)&255|(a.charCodeAt(++tt)&255)<<8|(a.charCodeAt(++tt)&255)<<16|(a.charCodeAt(++tt)&255)<<24,_e=(_e&65535)*1540483477+((_e>>>16)*59797<<16),_e^=_e>>>24,o=(_e&65535)*1540483477+((_e>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(at){case 3:o^=(a.charCodeAt(tt+2)&255)<<16;case 2:o^=(a.charCodeAt(tt+1)&255)<<8;case 1:o^=a.charCodeAt(tt)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var unitlessKeys={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function(o){return o.charCodeAt(1)===45},isProcessableValue=function(o){return o!=null&&typeof o!="boolean"},processStyleName=memoize$1(function(a){return isCustomProperty(a)?a:a.replace(hyphenateRegex,"-$&").toLowerCase()}),processStyleValue=function(o,_e){switch(o){case"animation":case"animationName":if(typeof _e=="string")return _e.replace(animationRegex,function(tt,at,lt){return cursor={name:at,styles:lt,next:cursor},at})}return unitlessKeys[o]!==1&&!isCustomProperty(o)&&typeof _e=="number"&&_e!==0?_e+"px":_e},noComponentSelectorMessage="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function handleInterpolation(a,o,_e){if(_e==null)return"";if(_e.__emotion_styles!==void 0)return _e;switch(typeof _e){case"boolean":return"";case"object":{if(_e.anim===1)return cursor={name:_e.name,styles:_e.styles,next:cursor},_e.name;if(_e.styles!==void 0){var tt=_e.next;if(tt!==void 0)for(;tt!==void 0;)cursor={name:tt.name,styles:tt.styles,next:cursor},tt=tt.next;var at=_e.styles+";";return at}return createStringFromObject(a,o,_e)}case"function":{if(a!==void 0){var lt=cursor,it=_e(a);return cursor=lt,handleInterpolation(a,o,it)}break}}if(o==null)return _e;var ut=o[_e];return ut!==void 0?ut:_e}function createStringFromObject(a,o,_e){var tt="";if(Array.isArray(_e))for(var at=0;at<_e.length;at++)tt+=handleInterpolation(a,o,_e[at])+";";else for(var lt in _e){var it=_e[lt];if(typeof it!="object")o!=null&&o[it]!==void 0?tt+=lt+"{"+o[it]+"}":isProcessableValue(it)&&(tt+=processStyleName(lt)+":"+processStyleValue(lt,it)+";");else if(Array.isArray(it)&&typeof it[0]=="string"&&(o==null||o[it[0]]===void 0))for(var ut=0;ut<it.length;ut++)isProcessableValue(it[ut])&&(tt+=processStyleName(lt)+":"+processStyleValue(lt,it[ut])+";");else{var s=handleInterpolation(a,o,it);switch(lt){case"animation":case"animationName":{tt+=processStyleName(lt)+":"+s+";";break}default:tt+=lt+"{"+s+"}"}}}return tt}var labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g,cursor,serializeStyles=function(o,_e,tt){if(o.length===1&&typeof o[0]=="object"&&o[0]!==null&&o[0].styles!==void 0)return o[0];var at=!0,lt="";cursor=void 0;var it=o[0];it==null||it.raw===void 0?(at=!1,lt+=handleInterpolation(tt,_e,it)):lt+=it[0];for(var ut=1;ut<o.length;ut++)lt+=handleInterpolation(tt,_e,o[ut]),at&&(lt+=it[ut]);labelPattern.lastIndex=0;for(var s="",et;(et=labelPattern.exec(lt))!==null;)s+="-"+et[1];var ot=murmur2(lt)+s;return{name:ot,styles:lt,next:cursor}},syncFallback=function(o){return o()},useInsertionEffect=React$1["useInsertionEffect"]?React$1["useInsertionEffect"]:!1,useInsertionEffectAlwaysWithSyncFallback=useInsertionEffect||syncFallback,useInsertionEffectWithLayoutFallback=useInsertionEffect||reactExports.useLayoutEffect,EmotionCacheContext=reactExports.createContext(typeof HTMLElement<"u"?createCache({key:"css"}):null);EmotionCacheContext.Provider;var withEmotionCache=function(o){return reactExports.forwardRef(function(_e,tt){var at=reactExports.useContext(EmotionCacheContext);return o(_e,at,tt)})},ThemeContext$2=reactExports.createContext({}),Global=withEmotionCache(function(a,o){var _e=a.styles,tt=serializeStyles([_e],void 0,reactExports.useContext(ThemeContext$2)),at=reactExports.useRef();return useInsertionEffectWithLayoutFallback(function(){var lt=o.key+"-global",it=new o.sheet.constructor({key:lt,nonce:o.sheet.nonce,container:o.sheet.container,speedy:o.sheet.isSpeedy}),ut=!1,s=document.querySelector('style[data-emotion="'+lt+" "+tt.name+'"]');return o.sheet.tags.length&&(it.before=o.sheet.tags[0]),s!==null&&(ut=!0,s.setAttribute("data-emotion",lt),it.hydrate([s])),at.current=[it,ut],function(){it.flush()}},[o]),useInsertionEffectWithLayoutFallback(function(){var lt=at.current,it=lt[0],ut=lt[1];if(ut){lt[1]=!1;return}if(tt.next!==void 0&&insertStyles(o,tt.next,!0),it.tags.length){var s=it.tags[it.tags.length-1].nextElementSibling;it.before=s,it.flush()}o.insert("",tt,it,!1)},[o,tt.name]),null});function css(){for(var a=arguments.length,o=new Array(a),_e=0;_e<a;_e++)o[_e]=arguments[_e];return serializeStyles(o)}var keyframes=function(){var o=css.apply(void 0,arguments),_e="animation-"+o.name;return{name:_e,styles:"@keyframes "+_e+"{"+o.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},testOmitPropsOnStringTag=isPropValid,testOmitPropsOnComponent=function(o){return o!=="theme"},getDefaultShouldForwardProp=function(o){return typeof o=="string"&&o.charCodeAt(0)>96?testOmitPropsOnStringTag:testOmitPropsOnComponent},composeShouldForwardProps=function(o,_e,tt){var at;if(_e){var lt=_e.shouldForwardProp;at=o.__emotion_forwardProp&&lt?function(it){return o.__emotion_forwardProp(it)&&lt(it)}:lt}return typeof at!="function"&&tt&&(at=o.__emotion_forwardProp),at},Insertion=function(o){var _e=o.cache,tt=o.serialized,at=o.isStringTag;return registerStyles(_e,tt,at),useInsertionEffectAlwaysWithSyncFallback(function(){return insertStyles(_e,tt,at)}),null},createStyled$1=function a(o,_e){var tt=o.__emotion_real===o,at=tt&&o.__emotion_base||o,lt,it;_e!==void 0&&(lt=_e.label,it=_e.target);var ut=composeShouldForwardProps(o,_e,tt),s=ut||getDefaultShouldForwardProp(at),et=!s("as");return function(){var ot=arguments,st=tt&&o.__emotion_styles!==void 0?o.__emotion_styles.slice(0):[];if(lt!==void 0&&st.push("label:"+lt+";"),ot[0]==null||ot[0].raw===void 0)st.push.apply(st,ot);else{st.push(ot[0][0]);for(var Rt=ot.length,ht=1;ht<Rt;ht++)st.push(ot[ht],ot[0][ht])}var bt=withEmotionCache(function(ct,mt,rt){var pt=et&&ct.as||at,ft="",St=[],It=ct;if(ct.theme==null){It={};for(var xt in ct)It[xt]=ct[xt];It.theme=reactExports.useContext(ThemeContext$2)}typeof ct.className=="string"?ft=getRegisteredStyles(mt.registered,St,ct.className):ct.className!=null&&(ft=ct.className+" ");var At=serializeStyles(st.concat(St),mt.registered,It);ft+=mt.key+"-"+At.name,it!==void 0&&(ft+=" "+it);var Dt=et&&ut===void 0?getDefaultShouldForwardProp(pt):s,wt={};for(var Mt in ct)et&&Mt==="as"||Dt(Mt)&&(wt[Mt]=ct[Mt]);return wt.className=ft,wt.ref=rt,reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(Insertion,{cache:mt,serialized:At,isStringTag:typeof pt=="string"}),reactExports.createElement(pt,wt))});return bt.displayName=lt!==void 0?lt:"Styled("+(typeof at=="string"?at:at.displayName||at.name||"Component")+")",bt.defaultProps=o.defaultProps,bt.__emotion_real=bt,bt.__emotion_base=at,bt.__emotion_styles=st,bt.__emotion_forwardProp=ut,Object.defineProperty(bt,"toString",{value:function(){return"."+it}}),bt.withComponent=function(ct,mt){return a(ct,_extends({},_e,mt,{shouldForwardProp:composeShouldForwardProps(bt,mt,!0)})).apply(void 0,st)},bt}};const createStyled$2=createStyled$1;var tags=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],newStyled=createStyled$2.bind();tags.forEach(function(a){newStyled[a]=newStyled(a)});const emStyled=newStyled;function isEmpty$4(a){return a==null||Object.keys(a).length===0}function GlobalStyles$2(a){const{styles:o,defaultTheme:_e={}}=a,tt=typeof o=="function"?at=>o(isEmpty$4(at)?_e:at):o;return jsxRuntimeExports.jsx(Global,{styles:tt})}/**
 * @mui/styled-engine v5.12.3
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function styled$3(a,o){return emStyled(a,o)}const internal_processStyles=(a,o)=>{Array.isArray(a.__emotion_styles)&&(a.__emotion_styles=o(a.__emotion_styles))},_excluded$U=["values","unit","step"],sortBreakpointsValues=a=>{const o=Object.keys(a).map(_e=>({key:_e,val:a[_e]}))||[];return o.sort((_e,tt)=>_e.val-tt.val),o.reduce((_e,tt)=>_extends({},_e,{[tt.key]:tt.val}),{})};function createBreakpoints(a){const{values:o={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:_e="px",step:tt=5}=a,at=_objectWithoutPropertiesLoose(a,_excluded$U),lt=sortBreakpointsValues(o),it=Object.keys(lt);function ut(Rt){return`@media (min-width:${typeof o[Rt]=="number"?o[Rt]:Rt}${_e})`}function s(Rt){return`@media (max-width:${(typeof o[Rt]=="number"?o[Rt]:Rt)-tt/100}${_e})`}function et(Rt,ht){const bt=it.indexOf(ht);return`@media (min-width:${typeof o[Rt]=="number"?o[Rt]:Rt}${_e}) and (max-width:${(bt!==-1&&typeof o[it[bt]]=="number"?o[it[bt]]:ht)-tt/100}${_e})`}function ot(Rt){return it.indexOf(Rt)+1<it.length?et(Rt,it[it.indexOf(Rt)+1]):ut(Rt)}function st(Rt){const ht=it.indexOf(Rt);return ht===0?ut(it[1]):ht===it.length-1?s(it[ht]):et(Rt,it[it.indexOf(Rt)+1]).replace("@media","@media not all and")}return _extends({keys:it,values:lt,up:ut,down:s,between:et,only:ot,not:st,unit:_e},at)}const shape={borderRadius:4},shape$1=shape;function merge(a,o){return o?deepmerge(a,o,{clone:!1}):a}const values$1={xs:0,sm:600,md:900,lg:1200,xl:1536},defaultBreakpoints={keys:["xs","sm","md","lg","xl"],up:a=>`@media (min-width:${values$1[a]}px)`};function handleBreakpoints(a,o,_e){const tt=a.theme||{};if(Array.isArray(o)){const lt=tt.breakpoints||defaultBreakpoints;return o.reduce((it,ut,s)=>(it[lt.up(lt.keys[s])]=_e(o[s]),it),{})}if(typeof o=="object"){const lt=tt.breakpoints||defaultBreakpoints;return Object.keys(o).reduce((it,ut)=>{if(Object.keys(lt.values||values$1).indexOf(ut)!==-1){const s=lt.up(ut);it[s]=_e(o[ut],ut)}else{const s=ut;it[s]=o[s]}return it},{})}return _e(o)}function createEmptyBreakpointObject(a={}){var o;return((o=a.keys)==null?void 0:o.reduce((tt,at)=>{const lt=a.up(at);return tt[lt]={},tt},{}))||{}}function removeUnusedBreakpoints(a,o){return a.reduce((_e,tt)=>{const at=_e[tt];return(!at||Object.keys(at).length===0)&&delete _e[tt],_e},o)}function mergeBreakpointsInOrder(a,...o){const _e=createEmptyBreakpointObject(a),tt=[_e,...o].reduce((at,lt)=>deepmerge(at,lt),{});return removeUnusedBreakpoints(Object.keys(_e),tt)}function computeBreakpointsBase(a,o){if(typeof a!="object")return{};const _e={},tt=Object.keys(o);return Array.isArray(a)?tt.forEach((at,lt)=>{lt<a.length&&(_e[at]=!0)}):tt.forEach(at=>{a[at]!=null&&(_e[at]=!0)}),_e}function resolveBreakpointValues({values:a,breakpoints:o,base:_e}){const tt=_e||computeBreakpointsBase(a,o),at=Object.keys(tt);if(at.length===0)return a;let lt;return at.reduce((it,ut,s)=>(Array.isArray(a)?(it[ut]=a[s]!=null?a[s]:a[lt],lt=s):typeof a=="object"?(it[ut]=a[ut]!=null?a[ut]:a[lt],lt=ut):it[ut]=a,it),{})}function getPath(a,o,_e=!0){if(!o||typeof o!="string")return null;if(a&&a.vars&&_e){const tt=`vars.${o}`.split(".").reduce((at,lt)=>at&&at[lt]?at[lt]:null,a);if(tt!=null)return tt}return o.split(".").reduce((tt,at)=>tt&&tt[at]!=null?tt[at]:null,a)}function getStyleValue$1(a,o,_e,tt=_e){let at;return typeof a=="function"?at=a(_e):Array.isArray(a)?at=a[_e]||tt:at=getPath(a,_e)||tt,o&&(at=o(at,tt,a)),at}function style$2(a){const{prop:o,cssProperty:_e=a.prop,themeKey:tt,transform:at}=a,lt=it=>{if(it[o]==null)return null;const ut=it[o],s=it.theme,et=getPath(s,tt)||{};return handleBreakpoints(it,ut,st=>{let Rt=getStyleValue$1(et,at,st);return st===Rt&&typeof st=="string"&&(Rt=getStyleValue$1(et,at,`${o}${st==="default"?"":capitalize(st)}`,st)),_e===!1?Rt:{[_e]:Rt}})};return lt.propTypes={},lt.filterProps=[o],lt}function memoize(a){const o={};return _e=>(o[_e]===void 0&&(o[_e]=a(_e)),o[_e])}const properties={m:"margin",p:"padding"},directions={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},aliases={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},getCssProperties=memoize(a=>{if(a.length>2)if(aliases[a])a=aliases[a];else return[a];const[o,_e]=a.split(""),tt=properties[o],at=directions[_e]||"";return Array.isArray(at)?at.map(lt=>tt+lt):[tt+at]}),marginKeys=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],paddingKeys=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...marginKeys,...paddingKeys];function createUnaryUnit(a,o,_e,tt){var at;const lt=(at=getPath(a,o,!1))!=null?at:_e;return typeof lt=="number"?it=>typeof it=="string"?it:lt*it:Array.isArray(lt)?it=>typeof it=="string"?it:lt[it]:typeof lt=="function"?lt:()=>{}}function createUnarySpacing(a){return createUnaryUnit(a,"spacing",8)}function getValue(a,o){if(typeof o=="string"||o==null)return o;const _e=Math.abs(o),tt=a(_e);return o>=0?tt:typeof tt=="number"?-tt:`-${tt}`}function getStyleFromPropValue(a,o){return _e=>a.reduce((tt,at)=>(tt[at]=getValue(o,_e),tt),{})}function resolveCssProperty(a,o,_e,tt){if(o.indexOf(_e)===-1)return null;const at=getCssProperties(_e),lt=getStyleFromPropValue(at,tt),it=a[_e];return handleBreakpoints(a,it,lt)}function style$1(a,o){const _e=createUnarySpacing(a.theme);return Object.keys(a).map(tt=>resolveCssProperty(a,o,tt,_e)).reduce(merge,{})}function margin(a){return style$1(a,marginKeys)}margin.propTypes={};margin.filterProps=marginKeys;function padding(a){return style$1(a,paddingKeys)}padding.propTypes={};padding.filterProps=paddingKeys;function createSpacing(a=8){if(a.mui)return a;const o=createUnarySpacing({spacing:a}),_e=(...tt)=>(tt.length===0?[1]:tt).map(lt=>{const it=o(lt);return typeof it=="number"?`${it}px`:it}).join(" ");return _e.mui=!0,_e}function compose(...a){const o=a.reduce((tt,at)=>(at.filterProps.forEach(lt=>{tt[lt]=at}),tt),{}),_e=tt=>Object.keys(tt).reduce((at,lt)=>o[lt]?merge(at,o[lt](tt)):at,{});return _e.propTypes={},_e.filterProps=a.reduce((tt,at)=>tt.concat(at.filterProps),[]),_e}function borderTransform(a){return typeof a!="number"?a:`${a}px solid`}const border=style$2({prop:"border",themeKey:"borders",transform:borderTransform}),borderTop=style$2({prop:"borderTop",themeKey:"borders",transform:borderTransform}),borderRight=style$2({prop:"borderRight",themeKey:"borders",transform:borderTransform}),borderBottom=style$2({prop:"borderBottom",themeKey:"borders",transform:borderTransform}),borderLeft=style$2({prop:"borderLeft",themeKey:"borders",transform:borderTransform}),borderColor=style$2({prop:"borderColor",themeKey:"palette"}),borderTopColor=style$2({prop:"borderTopColor",themeKey:"palette"}),borderRightColor=style$2({prop:"borderRightColor",themeKey:"palette"}),borderBottomColor=style$2({prop:"borderBottomColor",themeKey:"palette"}),borderLeftColor=style$2({prop:"borderLeftColor",themeKey:"palette"}),borderRadius=a=>{if(a.borderRadius!==void 0&&a.borderRadius!==null){const o=createUnaryUnit(a.theme,"shape.borderRadius",4),_e=tt=>({borderRadius:getValue(o,tt)});return handleBreakpoints(a,a.borderRadius,_e)}return null};borderRadius.propTypes={};borderRadius.filterProps=["borderRadius"];compose(border,borderTop,borderRight,borderBottom,borderLeft,borderColor,borderTopColor,borderRightColor,borderBottomColor,borderLeftColor,borderRadius);const gap=a=>{if(a.gap!==void 0&&a.gap!==null){const o=createUnaryUnit(a.theme,"spacing",8),_e=tt=>({gap:getValue(o,tt)});return handleBreakpoints(a,a.gap,_e)}return null};gap.propTypes={};gap.filterProps=["gap"];const columnGap=a=>{if(a.columnGap!==void 0&&a.columnGap!==null){const o=createUnaryUnit(a.theme,"spacing",8),_e=tt=>({columnGap:getValue(o,tt)});return handleBreakpoints(a,a.columnGap,_e)}return null};columnGap.propTypes={};columnGap.filterProps=["columnGap"];const rowGap=a=>{if(a.rowGap!==void 0&&a.rowGap!==null){const o=createUnaryUnit(a.theme,"spacing",8),_e=tt=>({rowGap:getValue(o,tt)});return handleBreakpoints(a,a.rowGap,_e)}return null};rowGap.propTypes={};rowGap.filterProps=["rowGap"];const gridColumn=style$2({prop:"gridColumn"}),gridRow=style$2({prop:"gridRow"}),gridAutoFlow=style$2({prop:"gridAutoFlow"}),gridAutoColumns=style$2({prop:"gridAutoColumns"}),gridAutoRows=style$2({prop:"gridAutoRows"}),gridTemplateColumns=style$2({prop:"gridTemplateColumns"}),gridTemplateRows=style$2({prop:"gridTemplateRows"}),gridTemplateAreas=style$2({prop:"gridTemplateAreas"}),gridArea=style$2({prop:"gridArea"});compose(gap,columnGap,rowGap,gridColumn,gridRow,gridAutoFlow,gridAutoColumns,gridAutoRows,gridTemplateColumns,gridTemplateRows,gridTemplateAreas,gridArea);function paletteTransform(a,o){return o==="grey"?o:a}const color=style$2({prop:"color",themeKey:"palette",transform:paletteTransform}),bgcolor=style$2({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:paletteTransform}),backgroundColor=style$2({prop:"backgroundColor",themeKey:"palette",transform:paletteTransform});compose(color,bgcolor,backgroundColor);function sizingTransform(a){return a<=1&&a!==0?`${a*100}%`:a}const width=style$2({prop:"width",transform:sizingTransform}),maxWidth=a=>{if(a.maxWidth!==void 0&&a.maxWidth!==null){const o=_e=>{var tt,at,lt;return{maxWidth:((tt=a.theme)==null||(at=tt.breakpoints)==null||(lt=at.values)==null?void 0:lt[_e])||values$1[_e]||sizingTransform(_e)}};return handleBreakpoints(a,a.maxWidth,o)}return null};maxWidth.filterProps=["maxWidth"];const minWidth=style$2({prop:"minWidth",transform:sizingTransform}),height=style$2({prop:"height",transform:sizingTransform}),maxHeight=style$2({prop:"maxHeight",transform:sizingTransform}),minHeight=style$2({prop:"minHeight",transform:sizingTransform});style$2({prop:"size",cssProperty:"width",transform:sizingTransform});style$2({prop:"size",cssProperty:"height",transform:sizingTransform});const boxSizing=style$2({prop:"boxSizing"});compose(width,maxWidth,minWidth,height,maxHeight,minHeight,boxSizing);const defaultSxConfig={border:{themeKey:"borders",transform:borderTransform},borderTop:{themeKey:"borders",transform:borderTransform},borderRight:{themeKey:"borders",transform:borderTransform},borderBottom:{themeKey:"borders",transform:borderTransform},borderLeft:{themeKey:"borders",transform:borderTransform},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:borderRadius},color:{themeKey:"palette",transform:paletteTransform},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:paletteTransform},backgroundColor:{themeKey:"palette",transform:paletteTransform},p:{style:padding},pt:{style:padding},pr:{style:padding},pb:{style:padding},pl:{style:padding},px:{style:padding},py:{style:padding},padding:{style:padding},paddingTop:{style:padding},paddingRight:{style:padding},paddingBottom:{style:padding},paddingLeft:{style:padding},paddingX:{style:padding},paddingY:{style:padding},paddingInline:{style:padding},paddingInlineStart:{style:padding},paddingInlineEnd:{style:padding},paddingBlock:{style:padding},paddingBlockStart:{style:padding},paddingBlockEnd:{style:padding},m:{style:margin},mt:{style:margin},mr:{style:margin},mb:{style:margin},ml:{style:margin},mx:{style:margin},my:{style:margin},margin:{style:margin},marginTop:{style:margin},marginRight:{style:margin},marginBottom:{style:margin},marginLeft:{style:margin},marginX:{style:margin},marginY:{style:margin},marginInline:{style:margin},marginInlineStart:{style:margin},marginInlineEnd:{style:margin},marginBlock:{style:margin},marginBlockStart:{style:margin},marginBlockEnd:{style:margin},displayPrint:{cssProperty:!1,transform:a=>({"@media print":{display:a}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:gap},rowGap:{style:rowGap},columnGap:{style:columnGap},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:sizingTransform},maxWidth:{style:maxWidth},minWidth:{transform:sizingTransform},height:{transform:sizingTransform},maxHeight:{transform:sizingTransform},minHeight:{transform:sizingTransform},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},defaultSxConfig$1=defaultSxConfig;function objectsHaveSameKeys(...a){const o=a.reduce((tt,at)=>tt.concat(Object.keys(at)),[]),_e=new Set(o);return a.every(tt=>_e.size===Object.keys(tt).length)}function callIfFn(a,o){return typeof a=="function"?a(o):a}function unstable_createStyleFunctionSx(){function a(_e,tt,at,lt){const it={[_e]:tt,theme:at},ut=lt[_e];if(!ut)return{[_e]:tt};const{cssProperty:s=_e,themeKey:et,transform:ot,style:st}=ut;if(tt==null)return null;if(et==="typography"&&tt==="inherit")return{[_e]:tt};const Rt=getPath(at,et)||{};return st?st(it):handleBreakpoints(it,tt,bt=>{let ct=getStyleValue$1(Rt,ot,bt);return bt===ct&&typeof bt=="string"&&(ct=getStyleValue$1(Rt,ot,`${_e}${bt==="default"?"":capitalize(bt)}`,bt)),s===!1?ct:{[s]:ct}})}function o(_e){var tt;const{sx:at,theme:lt={}}=_e||{};if(!at)return null;const it=(tt=lt.unstable_sxConfig)!=null?tt:defaultSxConfig$1;function ut(s){let et=s;if(typeof s=="function")et=s(lt);else if(typeof s!="object")return s;if(!et)return null;const ot=createEmptyBreakpointObject(lt.breakpoints),st=Object.keys(ot);let Rt=ot;return Object.keys(et).forEach(ht=>{const bt=callIfFn(et[ht],lt);if(bt!=null)if(typeof bt=="object")if(it[ht])Rt=merge(Rt,a(ht,bt,lt,it));else{const ct=handleBreakpoints({theme:lt},bt,mt=>({[ht]:mt}));objectsHaveSameKeys(ct,bt)?Rt[ht]=o({sx:bt,theme:lt}):Rt=merge(Rt,ct)}else Rt=merge(Rt,a(ht,bt,lt,it))}),removeUnusedBreakpoints(st,Rt)}return Array.isArray(at)?at.map(ut):ut(at)}return o}const styleFunctionSx=unstable_createStyleFunctionSx();styleFunctionSx.filterProps=["sx"];const styleFunctionSx$1=styleFunctionSx,_excluded$T=["breakpoints","palette","spacing","shape"];function createTheme$1(a={},...o){const{breakpoints:_e={},palette:tt={},spacing:at,shape:lt={}}=a,it=_objectWithoutPropertiesLoose(a,_excluded$T),ut=createBreakpoints(_e),s=createSpacing(at);let et=deepmerge({breakpoints:ut,direction:"ltr",components:{},palette:_extends({mode:"light"},tt),spacing:s,shape:_extends({},shape$1,lt)},it);return et=o.reduce((ot,st)=>deepmerge(ot,st),et),et.unstable_sxConfig=_extends({},defaultSxConfig$1,it==null?void 0:it.unstable_sxConfig),et.unstable_sx=function(st){return styleFunctionSx$1({sx:st,theme:this})},et}function isObjectEmpty(a){return Object.keys(a).length===0}function useTheme$3(a=null){const o=reactExports.useContext(ThemeContext$2);return!o||isObjectEmpty(o)?a:o}const systemDefaultTheme$1=createTheme$1();function useTheme$2(a=systemDefaultTheme$1){return useTheme$3(a)}function GlobalStyles$1({styles:a,themeId:o,defaultTheme:_e={}}){const tt=useTheme$2(_e),at=typeof a=="function"?a(o&&tt[o]||tt):a;return jsxRuntimeExports.jsx(GlobalStyles$2,{styles:at})}const _excluded$S=["sx"],splitProps=a=>{var o,_e;const tt={systemProps:{},otherProps:{}},at=(o=a==null||(_e=a.theme)==null?void 0:_e.unstable_sxConfig)!=null?o:defaultSxConfig$1;return Object.keys(a).forEach(lt=>{at[lt]?tt.systemProps[lt]=a[lt]:tt.otherProps[lt]=a[lt]}),tt};function extendSxProp(a){const{sx:o}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$S),{systemProps:tt,otherProps:at}=splitProps(_e);let lt;return Array.isArray(o)?lt=[tt,...o]:typeof o=="function"?lt=(...it)=>{const ut=o(...it);return isPlainObject(ut)?_extends({},tt,ut):tt}:lt=_extends({},tt,o),_extends({},at,{sx:lt})}const _excluded$R=["className","component"];function createBox(a={}){const{themeId:o,defaultTheme:_e,defaultClassName:tt="MuiBox-root",generateClassName:at}=a,lt=styled$3("div",{shouldForwardProp:ut=>ut!=="theme"&&ut!=="sx"&&ut!=="as"})(styleFunctionSx$1);return reactExports.forwardRef(function(s,et){const ot=useTheme$2(_e),st=extendSxProp(s),{className:Rt,component:ht="div"}=st,bt=_objectWithoutPropertiesLoose(st,_excluded$R);return jsxRuntimeExports.jsx(lt,_extends({as:ht,ref:et,className:clsx(Rt,at?at(tt):tt),theme:o&&ot[o]||ot},bt))})}const _excluded$Q=["variant"];function isEmpty$3(a){return a.length===0}function propsToClassKey(a){const{variant:o}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$Q);let tt=o||"";return Object.keys(_e).sort().forEach(at=>{at==="color"?tt+=isEmpty$3(tt)?a[at]:capitalize(a[at]):tt+=`${isEmpty$3(tt)?at:capitalize(at)}${capitalize(a[at].toString())}`}),tt}const _excluded$P=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function isEmpty$2(a){return Object.keys(a).length===0}function isStringTag(a){return typeof a=="string"&&a.charCodeAt(0)>96}const getStyleOverrides=(a,o)=>o.components&&o.components[a]&&o.components[a].styleOverrides?o.components[a].styleOverrides:null,getVariantStyles=(a,o)=>{let _e=[];o&&o.components&&o.components[a]&&o.components[a].variants&&(_e=o.components[a].variants);const tt={};return _e.forEach(at=>{const lt=propsToClassKey(at.props);tt[lt]=at.style}),tt},variantsResolver=(a,o,_e,tt)=>{var at,lt;const{ownerState:it={}}=a,ut=[],s=_e==null||(at=_e.components)==null||(lt=at[tt])==null?void 0:lt.variants;return s&&s.forEach(et=>{let ot=!0;Object.keys(et.props).forEach(st=>{it[st]!==et.props[st]&&a[st]!==et.props[st]&&(ot=!1)}),ot&&ut.push(o[propsToClassKey(et.props)])}),ut};function shouldForwardProp(a){return a!=="ownerState"&&a!=="theme"&&a!=="sx"&&a!=="as"}const systemDefaultTheme=createTheme$1();function resolveTheme({defaultTheme:a,theme:o,themeId:_e}){return isEmpty$2(o)?a:o[_e]||o}function createStyled(a={}){const{themeId:o,defaultTheme:_e=systemDefaultTheme,rootShouldForwardProp:tt=shouldForwardProp,slotShouldForwardProp:at=shouldForwardProp}=a,lt=it=>styleFunctionSx$1(_extends({},it,{theme:resolveTheme(_extends({},it,{defaultTheme:_e,themeId:o}))}));return lt.__mui_systemSx=!0,(it,ut={})=>{internal_processStyles(it,St=>St.filter(It=>!(It!=null&&It.__mui_systemSx)));const{name:s,slot:et,skipVariantsResolver:ot,skipSx:st,overridesResolver:Rt}=ut,ht=_objectWithoutPropertiesLoose(ut,_excluded$P),bt=ot!==void 0?ot:et&&et!=="Root"||!1,ct=st||!1;let mt,rt=shouldForwardProp;et==="Root"?rt=tt:et?rt=at:isStringTag(it)&&(rt=void 0);const pt=styled$3(it,_extends({shouldForwardProp:rt,label:mt},ht)),ft=(St,...It)=>{const xt=It?It.map(Mt=>typeof Mt=="function"&&Mt.__emotion_real!==Mt?vt=>Mt(_extends({},vt,{theme:resolveTheme(_extends({},vt,{defaultTheme:_e,themeId:o}))})):Mt):[];let At=St;s&&Rt&&xt.push(Mt=>{const vt=resolveTheme(_extends({},Mt,{defaultTheme:_e,themeId:o})),Ft=getStyleOverrides(s,vt);if(Ft){const Ht={};return Object.entries(Ft).forEach(([Wt,tn])=>{Ht[Wt]=typeof tn=="function"?tn(_extends({},Mt,{theme:vt})):tn}),Rt(Mt,Ht)}return null}),s&&!bt&&xt.push(Mt=>{const vt=resolveTheme(_extends({},Mt,{defaultTheme:_e,themeId:o}));return variantsResolver(Mt,getVariantStyles(s,vt),vt,s)}),ct||xt.push(lt);const Dt=xt.length-It.length;if(Array.isArray(St)&&Dt>0){const Mt=new Array(Dt).fill("");At=[...St,...Mt],At.raw=[...St.raw,...Mt]}else typeof St=="function"&&St.__emotion_real!==St&&(At=Mt=>St(_extends({},Mt,{theme:resolveTheme(_extends({},Mt,{defaultTheme:_e,themeId:o}))})));const wt=pt(At,...xt);return it.muiName&&(wt.muiName=it.muiName),wt};return pt.withConfig&&(ft.withConfig=pt.withConfig),ft}}const styled$2=createStyled(),systemStyled=styled$2;function getThemeProps(a){const{theme:o,name:_e,props:tt}=a;return!o||!o.components||!o.components[_e]||!o.components[_e].defaultProps?tt:resolveProps(o.components[_e].defaultProps,tt)}function useThemeProps$1({props:a,name:o,defaultTheme:_e,themeId:tt}){let at=useTheme$2(_e);return tt&&(at=at[tt]||at),getThemeProps({theme:at,name:o,props:a})}function clamp(a,o=0,_e=1){return Math.min(Math.max(o,a),_e)}function hexToRgb(a){a=a.slice(1);const o=new RegExp(`.{1,${a.length>=6?2:1}}`,"g");let _e=a.match(o);return _e&&_e[0].length===1&&(_e=_e.map(tt=>tt+tt)),_e?`rgb${_e.length===4?"a":""}(${_e.map((tt,at)=>at<3?parseInt(tt,16):Math.round(parseInt(tt,16)/255*1e3)/1e3).join(", ")})`:""}function decomposeColor(a){if(a.type)return a;if(a.charAt(0)==="#")return decomposeColor(hexToRgb(a));const o=a.indexOf("("),_e=a.substring(0,o);if(["rgb","rgba","hsl","hsla","color"].indexOf(_e)===-1)throw new Error(formatMuiErrorMessage(9,a));let tt=a.substring(o+1,a.length-1),at;if(_e==="color"){if(tt=tt.split(" "),at=tt.shift(),tt.length===4&&tt[3].charAt(0)==="/"&&(tt[3]=tt[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(at)===-1)throw new Error(formatMuiErrorMessage(10,at))}else tt=tt.split(",");return tt=tt.map(lt=>parseFloat(lt)),{type:_e,values:tt,colorSpace:at}}function recomposeColor(a){const{type:o,colorSpace:_e}=a;let{values:tt}=a;return o.indexOf("rgb")!==-1?tt=tt.map((at,lt)=>lt<3?parseInt(at,10):at):o.indexOf("hsl")!==-1&&(tt[1]=`${tt[1]}%`,tt[2]=`${tt[2]}%`),o.indexOf("color")!==-1?tt=`${_e} ${tt.join(" ")}`:tt=`${tt.join(", ")}`,`${o}(${tt})`}function hslToRgb(a){a=decomposeColor(a);const{values:o}=a,_e=o[0],tt=o[1]/100,at=o[2]/100,lt=tt*Math.min(at,1-at),it=(et,ot=(et+_e/30)%12)=>at-lt*Math.max(Math.min(ot-3,9-ot,1),-1);let ut="rgb";const s=[Math.round(it(0)*255),Math.round(it(8)*255),Math.round(it(4)*255)];return a.type==="hsla"&&(ut+="a",s.push(o[3])),recomposeColor({type:ut,values:s})}function getLuminance(a){a=decomposeColor(a);let o=a.type==="hsl"||a.type==="hsla"?decomposeColor(hslToRgb(a)).values:a.values;return o=o.map(_e=>(a.type!=="color"&&(_e/=255),_e<=.03928?_e/12.92:((_e+.055)/1.055)**2.4)),Number((.2126*o[0]+.7152*o[1]+.0722*o[2]).toFixed(3))}function getContrastRatio(a,o){const _e=getLuminance(a),tt=getLuminance(o);return(Math.max(_e,tt)+.05)/(Math.min(_e,tt)+.05)}function alpha(a,o){return a=decomposeColor(a),o=clamp(o),(a.type==="rgb"||a.type==="hsl")&&(a.type+="a"),a.type==="color"?a.values[3]=`/${o}`:a.values[3]=o,recomposeColor(a)}function darken(a,o){if(a=decomposeColor(a),o=clamp(o),a.type.indexOf("hsl")!==-1)a.values[2]*=1-o;else if(a.type.indexOf("rgb")!==-1||a.type.indexOf("color")!==-1)for(let _e=0;_e<3;_e+=1)a.values[_e]*=1-o;return recomposeColor(a)}function lighten(a,o){if(a=decomposeColor(a),o=clamp(o),a.type.indexOf("hsl")!==-1)a.values[2]+=(100-a.values[2])*o;else if(a.type.indexOf("rgb")!==-1)for(let _e=0;_e<3;_e+=1)a.values[_e]+=(255-a.values[_e])*o;else if(a.type.indexOf("color")!==-1)for(let _e=0;_e<3;_e+=1)a.values[_e]+=(1-a.values[_e])*o;return recomposeColor(a)}const ThemeContext=reactExports.createContext(null),ThemeContext$1=ThemeContext;function useTheme$1(){return reactExports.useContext(ThemeContext$1)}const hasSymbol=typeof Symbol=="function"&&Symbol.for,nested=hasSymbol?Symbol.for("mui.nested"):"__THEME_NESTED__";function mergeOuterLocalTheme(a,o){return typeof o=="function"?o(a):_extends({},a,o)}function ThemeProvider$2(a){const{children:o,theme:_e}=a,tt=useTheme$1(),at=reactExports.useMemo(()=>{const lt=tt===null?_e:mergeOuterLocalTheme(tt,_e);return lt!=null&&(lt[nested]=tt!==null),lt},[_e,tt]);return jsxRuntimeExports.jsx(ThemeContext$1.Provider,{value:at,children:o})}const EMPTY_THEME={};function useThemeScoping(a,o,_e,tt=!1){return reactExports.useMemo(()=>{const at=a&&o[a]||o;if(typeof _e=="function"){const lt=_e(at),it=a?_extends({},o,{[a]:lt}):lt;return tt?()=>it:it}return a?_extends({},o,{[a]:_e}):_extends({},o,_e)},[a,o,_e,tt])}function ThemeProvider$1(a){const{children:o,theme:_e,themeId:tt}=a,at=useTheme$3(EMPTY_THEME),lt=useTheme$1()||EMPTY_THEME,it=useThemeScoping(tt,at,_e),ut=useThemeScoping(tt,lt,_e,!0);return jsxRuntimeExports.jsx(ThemeProvider$2,{theme:ut,children:jsxRuntimeExports.jsx(ThemeContext$2.Provider,{value:it,children:o})})}const _excluded$O=["className","component","disableGutters","fixed","maxWidth","classes"],defaultTheme$4=createTheme$1(),defaultCreateStyledComponent$1=systemStyled("div",{name:"MuiContainer",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[`maxWidth${capitalize(String(_e.maxWidth))}`],_e.fixed&&o.fixed,_e.disableGutters&&o.disableGutters]}}),useThemePropsDefault$1=a=>useThemeProps$1({props:a,name:"MuiContainer",defaultTheme:defaultTheme$4}),useUtilityClasses$z=(a,o)=>{const _e=s=>generateUtilityClass(o,s),{classes:tt,fixed:at,disableGutters:lt,maxWidth:it}=a,ut={root:["root",it&&`maxWidth${capitalize(String(it))}`,at&&"fixed",lt&&"disableGutters"]};return composeClasses(ut,_e,tt)};function createContainer(a={}){const{createStyledComponent:o=defaultCreateStyledComponent$1,useThemeProps:_e=useThemePropsDefault$1,componentName:tt="MuiContainer"}=a,at=o(({theme:it,ownerState:ut})=>_extends({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!ut.disableGutters&&{paddingLeft:it.spacing(2),paddingRight:it.spacing(2),[it.breakpoints.up("sm")]:{paddingLeft:it.spacing(3),paddingRight:it.spacing(3)}}),({theme:it,ownerState:ut})=>ut.fixed&&Object.keys(it.breakpoints.values).reduce((s,et)=>{const ot=et,st=it.breakpoints.values[ot];return st!==0&&(s[it.breakpoints.up(ot)]={maxWidth:`${st}${it.breakpoints.unit}`}),s},{}),({theme:it,ownerState:ut})=>_extends({},ut.maxWidth==="xs"&&{[it.breakpoints.up("xs")]:{maxWidth:Math.max(it.breakpoints.values.xs,444)}},ut.maxWidth&&ut.maxWidth!=="xs"&&{[it.breakpoints.up(ut.maxWidth)]:{maxWidth:`${it.breakpoints.values[ut.maxWidth]}${it.breakpoints.unit}`}}));return reactExports.forwardRef(function(ut,s){const et=_e(ut),{className:ot,component:st="div",disableGutters:Rt=!1,fixed:ht=!1,maxWidth:bt="lg"}=et,ct=_objectWithoutPropertiesLoose(et,_excluded$O),mt=_extends({},et,{component:st,disableGutters:Rt,fixed:ht,maxWidth:bt}),rt=useUtilityClasses$z(mt,tt);return jsxRuntimeExports.jsx(at,_extends({as:st,ownerState:mt,className:clsx(rt.root,ot),ref:s},ct))})}const _excluded$N=["component","direction","spacing","divider","children","className","useFlexGap"],defaultTheme$3=createTheme$1(),defaultCreateStyledComponent=systemStyled("div",{name:"MuiStack",slot:"Root",overridesResolver:(a,o)=>o.root});function useThemePropsDefault(a){return useThemeProps$1({props:a,name:"MuiStack",defaultTheme:defaultTheme$3})}function joinChildren(a,o){const _e=reactExports.Children.toArray(a).filter(Boolean);return _e.reduce((tt,at,lt)=>(tt.push(at),lt<_e.length-1&&tt.push(reactExports.cloneElement(o,{key:`separator-${lt}`})),tt),[])}const getSideFromDirection=a=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[a],style=({ownerState:a,theme:o})=>{let _e=_extends({display:"flex",flexDirection:"column"},handleBreakpoints({theme:o},resolveBreakpointValues({values:a.direction,breakpoints:o.breakpoints.values}),tt=>({flexDirection:tt})));if(a.spacing){const tt=createUnarySpacing(o),at=Object.keys(o.breakpoints.values).reduce((s,et)=>((typeof a.spacing=="object"&&a.spacing[et]!=null||typeof a.direction=="object"&&a.direction[et]!=null)&&(s[et]=!0),s),{}),lt=resolveBreakpointValues({values:a.direction,base:at}),it=resolveBreakpointValues({values:a.spacing,base:at});typeof lt=="object"&&Object.keys(lt).forEach((s,et,ot)=>{if(!lt[s]){const Rt=et>0?lt[ot[et-1]]:"column";lt[s]=Rt}}),_e=deepmerge(_e,handleBreakpoints({theme:o},it,(s,et)=>a.useFlexGap?{gap:getValue(tt,s)}:{"& > :not(style) + :not(style)":{margin:0,[`margin${getSideFromDirection(et?lt[et]:a.direction)}`]:getValue(tt,s)}}))}return _e=mergeBreakpointsInOrder(o.breakpoints,_e),_e};function createStack(a={}){const{createStyledComponent:o=defaultCreateStyledComponent,useThemeProps:_e=useThemePropsDefault,componentName:tt="MuiStack"}=a,at=()=>composeClasses({root:["root"]},s=>generateUtilityClass(tt,s),{}),lt=o(style);return reactExports.forwardRef(function(s,et){const ot=_e(s),st=extendSxProp(ot),{component:Rt="div",direction:ht="column",spacing:bt=0,divider:ct,children:mt,className:rt,useFlexGap:pt=!1}=st,ft=_objectWithoutPropertiesLoose(st,_excluded$N),St={direction:ht,spacing:bt,useFlexGap:pt},It=at();return jsxRuntimeExports.jsx(lt,_extends({as:Rt,ownerState:St,ref:et,className:clsx(It.root,rt)},ft,{children:ct?joinChildren(mt,ct):mt}))})}function isHostComponent(a){return typeof a=="string"}function appendOwnerState(a,o,_e){return a===void 0||isHostComponent(a)?o:_extends({},o,{ownerState:_extends({},o.ownerState,_e)})}const defaultContextValue={disableDefaultClasses:!1},ClassNameConfiguratorContext=reactExports.createContext(defaultContextValue);function useClassNamesOverride(a){const{disableDefaultClasses:o}=reactExports.useContext(ClassNameConfiguratorContext);return _e=>o?"":a(_e)}function extractEventHandlers(a,o=[]){if(a===void 0)return{};const _e={};return Object.keys(a).filter(tt=>tt.match(/^on[A-Z]/)&&typeof a[tt]=="function"&&!o.includes(tt)).forEach(tt=>{_e[tt]=a[tt]}),_e}function resolveComponentProps(a,o){return typeof a=="function"?a(o):a}function omitEventHandlers(a){if(a===void 0)return{};const o={};return Object.keys(a).filter(_e=>!(_e.match(/^on[A-Z]/)&&typeof a[_e]=="function")).forEach(_e=>{o[_e]=a[_e]}),o}function mergeSlotProps(a){const{getSlotProps:o,additionalProps:_e,externalSlotProps:tt,externalForwardedProps:at,className:lt}=a;if(!o){const ht=clsx(at==null?void 0:at.className,tt==null?void 0:tt.className,lt,_e==null?void 0:_e.className),bt=_extends({},_e==null?void 0:_e.style,at==null?void 0:at.style,tt==null?void 0:tt.style),ct=_extends({},_e,at,tt);return ht.length>0&&(ct.className=ht),Object.keys(bt).length>0&&(ct.style=bt),{props:ct,internalRef:void 0}}const it=extractEventHandlers(_extends({},at,tt)),ut=omitEventHandlers(tt),s=omitEventHandlers(at),et=o(it),ot=clsx(et==null?void 0:et.className,_e==null?void 0:_e.className,lt,at==null?void 0:at.className,tt==null?void 0:tt.className),st=_extends({},et==null?void 0:et.style,_e==null?void 0:_e.style,at==null?void 0:at.style,tt==null?void 0:tt.style),Rt=_extends({},et,_e,s,ut);return ot.length>0&&(Rt.className=ot),Object.keys(st).length>0&&(Rt.style=st),{props:Rt,internalRef:et.ref}}const _excluded$M=["elementType","externalSlotProps","ownerState"];function useSlotProps(a){var o;const{elementType:_e,externalSlotProps:tt,ownerState:at}=a,lt=_objectWithoutPropertiesLoose(a,_excluded$M),it=resolveComponentProps(tt,at),{props:ut,internalRef:s}=mergeSlotProps(_extends({},lt,{externalSlotProps:it})),et=useForkRef(s,it==null?void 0:it.ref,(o=a.additionalProps)==null?void 0:o.ref);return appendOwnerState(_e,_extends({},ut,{ref:et}),at)}const candidatesSelector=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function getTabIndex(a){const o=parseInt(a.getAttribute("tabindex")||"",10);return Number.isNaN(o)?a.contentEditable==="true"||(a.nodeName==="AUDIO"||a.nodeName==="VIDEO"||a.nodeName==="DETAILS")&&a.getAttribute("tabindex")===null?0:a.tabIndex:o}function isNonTabbableRadio(a){if(a.tagName!=="INPUT"||a.type!=="radio"||!a.name)return!1;const o=tt=>a.ownerDocument.querySelector(`input[type="radio"]${tt}`);let _e=o(`[name="${a.name}"]:checked`);return _e||(_e=o(`[name="${a.name}"]`)),_e!==a}function isNodeMatchingSelectorFocusable(a){return!(a.disabled||a.tagName==="INPUT"&&a.type==="hidden"||isNonTabbableRadio(a))}function defaultGetTabbable(a){const o=[],_e=[];return Array.from(a.querySelectorAll(candidatesSelector)).forEach((tt,at)=>{const lt=getTabIndex(tt);lt===-1||!isNodeMatchingSelectorFocusable(tt)||(lt===0?o.push(tt):_e.push({documentOrder:at,tabIndex:lt,node:tt}))}),_e.sort((tt,at)=>tt.tabIndex===at.tabIndex?tt.documentOrder-at.documentOrder:tt.tabIndex-at.tabIndex).map(tt=>tt.node).concat(o)}function defaultIsEnabled(){return!0}function FocusTrap(a){const{children:o,disableAutoFocus:_e=!1,disableEnforceFocus:tt=!1,disableRestoreFocus:at=!1,getTabbable:lt=defaultGetTabbable,isEnabled:it=defaultIsEnabled,open:ut}=a,s=reactExports.useRef(!1),et=reactExports.useRef(null),ot=reactExports.useRef(null),st=reactExports.useRef(null),Rt=reactExports.useRef(null),ht=reactExports.useRef(!1),bt=reactExports.useRef(null),ct=useForkRef(o.ref,bt),mt=reactExports.useRef(null);reactExports.useEffect(()=>{!ut||!bt.current||(ht.current=!_e)},[_e,ut]),reactExports.useEffect(()=>{if(!ut||!bt.current)return;const ft=ownerDocument(bt.current);return bt.current.contains(ft.activeElement)||(bt.current.hasAttribute("tabIndex")||bt.current.setAttribute("tabIndex","-1"),ht.current&&bt.current.focus()),()=>{at||(st.current&&st.current.focus&&(s.current=!0,st.current.focus()),st.current=null)}},[ut]),reactExports.useEffect(()=>{if(!ut||!bt.current)return;const ft=ownerDocument(bt.current),St=At=>{const{current:Dt}=bt;if(Dt!==null){if(!ft.hasFocus()||tt||!it()||s.current){s.current=!1;return}if(!Dt.contains(ft.activeElement)){if(At&&Rt.current!==At.target||ft.activeElement!==Rt.current)Rt.current=null;else if(Rt.current!==null)return;if(!ht.current)return;let vt=[];if((ft.activeElement===et.current||ft.activeElement===ot.current)&&(vt=lt(bt.current)),vt.length>0){var wt,Mt;const Ft=!!((wt=mt.current)!=null&&wt.shiftKey&&((Mt=mt.current)==null?void 0:Mt.key)==="Tab"),Ht=vt[0],Wt=vt[vt.length-1];typeof Ht!="string"&&typeof Wt!="string"&&(Ft?Wt.focus():Ht.focus())}else Dt.focus()}}},It=At=>{mt.current=At,!(tt||!it()||At.key!=="Tab")&&ft.activeElement===bt.current&&At.shiftKey&&(s.current=!0,ot.current&&ot.current.focus())};ft.addEventListener("focusin",St),ft.addEventListener("keydown",It,!0);const xt=setInterval(()=>{ft.activeElement&&ft.activeElement.tagName==="BODY"&&St(null)},50);return()=>{clearInterval(xt),ft.removeEventListener("focusin",St),ft.removeEventListener("keydown",It,!0)}},[_e,tt,at,it,ut,lt]);const rt=ft=>{st.current===null&&(st.current=ft.relatedTarget),ht.current=!0,Rt.current=ft.target;const St=o.props.onFocus;St&&St(ft)},pt=ft=>{st.current===null&&(st.current=ft.relatedTarget),ht.current=!0};return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{tabIndex:ut?0:-1,onFocus:pt,ref:et,"data-testid":"sentinelStart"}),reactExports.cloneElement(o,{ref:ct,onFocus:rt}),jsxRuntimeExports.jsx("div",{tabIndex:ut?0:-1,onFocus:pt,ref:ot,"data-testid":"sentinelEnd"})]})}var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(a,o){return a.concat([o+"-"+start,o+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(a,o){return a.concat([o,o+"-"+start,o+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(a){return a?(a.nodeName||"").toLowerCase():null}function getWindow(a){if(a==null)return window;if(a.toString()!=="[object Window]"){var o=a.ownerDocument;return o&&o.defaultView||window}return a}function isElement(a){var o=getWindow(a).Element;return a instanceof o||a instanceof Element}function isHTMLElement$1(a){var o=getWindow(a).HTMLElement;return a instanceof o||a instanceof HTMLElement}function isShadowRoot(a){if(typeof ShadowRoot>"u")return!1;var o=getWindow(a).ShadowRoot;return a instanceof o||a instanceof ShadowRoot}function applyStyles(a){var o=a.state;Object.keys(o.elements).forEach(function(_e){var tt=o.styles[_e]||{},at=o.attributes[_e]||{},lt=o.elements[_e];!isHTMLElement$1(lt)||!getNodeName(lt)||(Object.assign(lt.style,tt),Object.keys(at).forEach(function(it){var ut=at[it];ut===!1?lt.removeAttribute(it):lt.setAttribute(it,ut===!0?"":ut)}))})}function effect$2(a){var o=a.state,_e={popper:{position:o.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(o.elements.popper.style,_e.popper),o.styles=_e,o.elements.arrow&&Object.assign(o.elements.arrow.style,_e.arrow),function(){Object.keys(o.elements).forEach(function(tt){var at=o.elements[tt],lt=o.attributes[tt]||{},it=Object.keys(o.styles.hasOwnProperty(tt)?o.styles[tt]:_e[tt]),ut=it.reduce(function(s,et){return s[et]="",s},{});!isHTMLElement$1(at)||!getNodeName(at)||(Object.assign(at.style,ut),Object.keys(lt).forEach(function(s){at.removeAttribute(s)}))})}}const applyStyles$1={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect:effect$2,requires:["computeStyles"]};function getBasePlacement(a){return a.split("-")[0]}var max=Math.max,min=Math.min,round$2=Math.round;function getUAString(){var a=navigator.userAgentData;return a!=null&&a.brands&&Array.isArray(a.brands)?a.brands.map(function(o){return o.brand+"/"+o.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(a,o,_e){o===void 0&&(o=!1),_e===void 0&&(_e=!1);var tt=a.getBoundingClientRect(),at=1,lt=1;o&&isHTMLElement$1(a)&&(at=a.offsetWidth>0&&round$2(tt.width)/a.offsetWidth||1,lt=a.offsetHeight>0&&round$2(tt.height)/a.offsetHeight||1);var it=isElement(a)?getWindow(a):window,ut=it.visualViewport,s=!isLayoutViewport()&&_e,et=(tt.left+(s&&ut?ut.offsetLeft:0))/at,ot=(tt.top+(s&&ut?ut.offsetTop:0))/lt,st=tt.width/at,Rt=tt.height/lt;return{width:st,height:Rt,top:ot,right:et+st,bottom:ot+Rt,left:et,x:et,y:ot}}function getLayoutRect(a){var o=getBoundingClientRect(a),_e=a.offsetWidth,tt=a.offsetHeight;return Math.abs(o.width-_e)<=1&&(_e=o.width),Math.abs(o.height-tt)<=1&&(tt=o.height),{x:a.offsetLeft,y:a.offsetTop,width:_e,height:tt}}function contains(a,o){var _e=o.getRootNode&&o.getRootNode();if(a.contains(o))return!0;if(_e&&isShadowRoot(_e)){var tt=o;do{if(tt&&a.isSameNode(tt))return!0;tt=tt.parentNode||tt.host}while(tt)}return!1}function getComputedStyle$1(a){return getWindow(a).getComputedStyle(a)}function isTableElement(a){return["table","td","th"].indexOf(getNodeName(a))>=0}function getDocumentElement(a){return((isElement(a)?a.ownerDocument:a.document)||window.document).documentElement}function getParentNode(a){return getNodeName(a)==="html"?a:a.assignedSlot||a.parentNode||(isShadowRoot(a)?a.host:null)||getDocumentElement(a)}function getTrueOffsetParent(a){return!isHTMLElement$1(a)||getComputedStyle$1(a).position==="fixed"?null:a.offsetParent}function getContainingBlock(a){var o=/firefox/i.test(getUAString()),_e=/Trident/i.test(getUAString());if(_e&&isHTMLElement$1(a)){var tt=getComputedStyle$1(a);if(tt.position==="fixed")return null}var at=getParentNode(a);for(isShadowRoot(at)&&(at=at.host);isHTMLElement$1(at)&&["html","body"].indexOf(getNodeName(at))<0;){var lt=getComputedStyle$1(at);if(lt.transform!=="none"||lt.perspective!=="none"||lt.contain==="paint"||["transform","perspective"].indexOf(lt.willChange)!==-1||o&&lt.willChange==="filter"||o&&lt.filter&&lt.filter!=="none")return at;at=at.parentNode}return null}function getOffsetParent(a){for(var o=getWindow(a),_e=getTrueOffsetParent(a);_e&&isTableElement(_e)&&getComputedStyle$1(_e).position==="static";)_e=getTrueOffsetParent(_e);return _e&&(getNodeName(_e)==="html"||getNodeName(_e)==="body"&&getComputedStyle$1(_e).position==="static")?o:_e||getContainingBlock(a)||o}function getMainAxisFromPlacement(a){return["top","bottom"].indexOf(a)>=0?"x":"y"}function within(a,o,_e){return max(a,min(o,_e))}function withinMaxClamp(a,o,_e){var tt=within(a,o,_e);return tt>_e?_e:tt}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(a){return Object.assign({},getFreshSideObject(),a)}function expandToHashMap(a,o){return o.reduce(function(_e,tt){return _e[tt]=a,_e},{})}var toPaddingObject=function(o,_e){return o=typeof o=="function"?o(Object.assign({},_e.rects,{placement:_e.placement})):o,mergePaddingObject(typeof o!="number"?o:expandToHashMap(o,basePlacements))};function arrow(a){var o,_e=a.state,tt=a.name,at=a.options,lt=_e.elements.arrow,it=_e.modifiersData.popperOffsets,ut=getBasePlacement(_e.placement),s=getMainAxisFromPlacement(ut),et=[left,right].indexOf(ut)>=0,ot=et?"height":"width";if(!(!lt||!it)){var st=toPaddingObject(at.padding,_e),Rt=getLayoutRect(lt),ht=s==="y"?top:left,bt=s==="y"?bottom:right,ct=_e.rects.reference[ot]+_e.rects.reference[s]-it[s]-_e.rects.popper[ot],mt=it[s]-_e.rects.reference[s],rt=getOffsetParent(lt),pt=rt?s==="y"?rt.clientHeight||0:rt.clientWidth||0:0,ft=ct/2-mt/2,St=st[ht],It=pt-Rt[ot]-st[bt],xt=pt/2-Rt[ot]/2+ft,At=within(St,xt,It),Dt=s;_e.modifiersData[tt]=(o={},o[Dt]=At,o.centerOffset=At-xt,o)}}function effect$1(a){var o=a.state,_e=a.options,tt=_e.element,at=tt===void 0?"[data-popper-arrow]":tt;at!=null&&(typeof at=="string"&&(at=o.elements.popper.querySelector(at),!at)||contains(o.elements.popper,at)&&(o.elements.arrow=at))}const arrow$1={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect$1,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(a){return a.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(a,o){var _e=a.x,tt=a.y,at=o.devicePixelRatio||1;return{x:round$2(_e*at)/at||0,y:round$2(tt*at)/at||0}}function mapToStyles(a){var o,_e=a.popper,tt=a.popperRect,at=a.placement,lt=a.variation,it=a.offsets,ut=a.position,s=a.gpuAcceleration,et=a.adaptive,ot=a.roundOffsets,st=a.isFixed,Rt=it.x,ht=Rt===void 0?0:Rt,bt=it.y,ct=bt===void 0?0:bt,mt=typeof ot=="function"?ot({x:ht,y:ct}):{x:ht,y:ct};ht=mt.x,ct=mt.y;var rt=it.hasOwnProperty("x"),pt=it.hasOwnProperty("y"),ft=left,St=top,It=window;if(et){var xt=getOffsetParent(_e),At="clientHeight",Dt="clientWidth";if(xt===getWindow(_e)&&(xt=getDocumentElement(_e),getComputedStyle$1(xt).position!=="static"&&ut==="absolute"&&(At="scrollHeight",Dt="scrollWidth")),xt=xt,at===top||(at===left||at===right)&&lt===end){St=bottom;var wt=st&&xt===It&&It.visualViewport?It.visualViewport.height:xt[At];ct-=wt-tt.height,ct*=s?1:-1}if(at===left||(at===top||at===bottom)&&lt===end){ft=right;var Mt=st&&xt===It&&It.visualViewport?It.visualViewport.width:xt[Dt];ht-=Mt-tt.width,ht*=s?1:-1}}var vt=Object.assign({position:ut},et&&unsetSides),Ft=ot===!0?roundOffsetsByDPR({x:ht,y:ct},getWindow(_e)):{x:ht,y:ct};if(ht=Ft.x,ct=Ft.y,s){var Ht;return Object.assign({},vt,(Ht={},Ht[St]=pt?"0":"",Ht[ft]=rt?"0":"",Ht.transform=(It.devicePixelRatio||1)<=1?"translate("+ht+"px, "+ct+"px)":"translate3d("+ht+"px, "+ct+"px, 0)",Ht))}return Object.assign({},vt,(o={},o[St]=pt?ct+"px":"",o[ft]=rt?ht+"px":"",o.transform="",o))}function computeStyles(a){var o=a.state,_e=a.options,tt=_e.gpuAcceleration,at=tt===void 0?!0:tt,lt=_e.adaptive,it=lt===void 0?!0:lt,ut=_e.roundOffsets,s=ut===void 0?!0:ut,et={placement:getBasePlacement(o.placement),variation:getVariation(o.placement),popper:o.elements.popper,popperRect:o.rects.popper,gpuAcceleration:at,isFixed:o.options.strategy==="fixed"};o.modifiersData.popperOffsets!=null&&(o.styles.popper=Object.assign({},o.styles.popper,mapToStyles(Object.assign({},et,{offsets:o.modifiersData.popperOffsets,position:o.options.strategy,adaptive:it,roundOffsets:s})))),o.modifiersData.arrow!=null&&(o.styles.arrow=Object.assign({},o.styles.arrow,mapToStyles(Object.assign({},et,{offsets:o.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:s})))),o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-placement":o.placement})}const computeStyles$1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};var passive={passive:!0};function effect(a){var o=a.state,_e=a.instance,tt=a.options,at=tt.scroll,lt=at===void 0?!0:at,it=tt.resize,ut=it===void 0?!0:it,s=getWindow(o.elements.popper),et=[].concat(o.scrollParents.reference,o.scrollParents.popper);return lt&&et.forEach(function(ot){ot.addEventListener("scroll",_e.update,passive)}),ut&&s.addEventListener("resize",_e.update,passive),function(){lt&&et.forEach(function(ot){ot.removeEventListener("scroll",_e.update,passive)}),ut&&s.removeEventListener("resize",_e.update,passive)}}const eventListeners={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect,data:{}};var hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(a){return a.replace(/left|right|bottom|top/g,function(o){return hash$1[o]})}var hash={start:"end",end:"start"};function getOppositeVariationPlacement(a){return a.replace(/start|end/g,function(o){return hash[o]})}function getWindowScroll(a){var o=getWindow(a),_e=o.pageXOffset,tt=o.pageYOffset;return{scrollLeft:_e,scrollTop:tt}}function getWindowScrollBarX(a){return getBoundingClientRect(getDocumentElement(a)).left+getWindowScroll(a).scrollLeft}function getViewportRect(a,o){var _e=getWindow(a),tt=getDocumentElement(a),at=_e.visualViewport,lt=tt.clientWidth,it=tt.clientHeight,ut=0,s=0;if(at){lt=at.width,it=at.height;var et=isLayoutViewport();(et||!et&&o==="fixed")&&(ut=at.offsetLeft,s=at.offsetTop)}return{width:lt,height:it,x:ut+getWindowScrollBarX(a),y:s}}function getDocumentRect(a){var o,_e=getDocumentElement(a),tt=getWindowScroll(a),at=(o=a.ownerDocument)==null?void 0:o.body,lt=max(_e.scrollWidth,_e.clientWidth,at?at.scrollWidth:0,at?at.clientWidth:0),it=max(_e.scrollHeight,_e.clientHeight,at?at.scrollHeight:0,at?at.clientHeight:0),ut=-tt.scrollLeft+getWindowScrollBarX(a),s=-tt.scrollTop;return getComputedStyle$1(at||_e).direction==="rtl"&&(ut+=max(_e.clientWidth,at?at.clientWidth:0)-lt),{width:lt,height:it,x:ut,y:s}}function isScrollParent(a){var o=getComputedStyle$1(a),_e=o.overflow,tt=o.overflowX,at=o.overflowY;return/auto|scroll|overlay|hidden/.test(_e+at+tt)}function getScrollParent(a){return["html","body","#document"].indexOf(getNodeName(a))>=0?a.ownerDocument.body:isHTMLElement$1(a)&&isScrollParent(a)?a:getScrollParent(getParentNode(a))}function listScrollParents(a,o){var _e;o===void 0&&(o=[]);var tt=getScrollParent(a),at=tt===((_e=a.ownerDocument)==null?void 0:_e.body),lt=getWindow(tt),it=at?[lt].concat(lt.visualViewport||[],isScrollParent(tt)?tt:[]):tt,ut=o.concat(it);return at?ut:ut.concat(listScrollParents(getParentNode(it)))}function rectToClientRect(a){return Object.assign({},a,{left:a.x,top:a.y,right:a.x+a.width,bottom:a.y+a.height})}function getInnerBoundingClientRect(a,o){var _e=getBoundingClientRect(a,!1,o==="fixed");return _e.top=_e.top+a.clientTop,_e.left=_e.left+a.clientLeft,_e.bottom=_e.top+a.clientHeight,_e.right=_e.left+a.clientWidth,_e.width=a.clientWidth,_e.height=a.clientHeight,_e.x=_e.left,_e.y=_e.top,_e}function getClientRectFromMixedType(a,o,_e){return o===viewport?rectToClientRect(getViewportRect(a,_e)):isElement(o)?getInnerBoundingClientRect(o,_e):rectToClientRect(getDocumentRect(getDocumentElement(a)))}function getClippingParents(a){var o=listScrollParents(getParentNode(a)),_e=["absolute","fixed"].indexOf(getComputedStyle$1(a).position)>=0,tt=_e&&isHTMLElement$1(a)?getOffsetParent(a):a;return isElement(tt)?o.filter(function(at){return isElement(at)&&contains(at,tt)&&getNodeName(at)!=="body"}):[]}function getClippingRect(a,o,_e,tt){var at=o==="clippingParents"?getClippingParents(a):[].concat(o),lt=[].concat(at,[_e]),it=lt[0],ut=lt.reduce(function(s,et){var ot=getClientRectFromMixedType(a,et,tt);return s.top=max(ot.top,s.top),s.right=min(ot.right,s.right),s.bottom=min(ot.bottom,s.bottom),s.left=max(ot.left,s.left),s},getClientRectFromMixedType(a,it,tt));return ut.width=ut.right-ut.left,ut.height=ut.bottom-ut.top,ut.x=ut.left,ut.y=ut.top,ut}function computeOffsets(a){var o=a.reference,_e=a.element,tt=a.placement,at=tt?getBasePlacement(tt):null,lt=tt?getVariation(tt):null,it=o.x+o.width/2-_e.width/2,ut=o.y+o.height/2-_e.height/2,s;switch(at){case top:s={x:it,y:o.y-_e.height};break;case bottom:s={x:it,y:o.y+o.height};break;case right:s={x:o.x+o.width,y:ut};break;case left:s={x:o.x-_e.width,y:ut};break;default:s={x:o.x,y:o.y}}var et=at?getMainAxisFromPlacement(at):null;if(et!=null){var ot=et==="y"?"height":"width";switch(lt){case start:s[et]=s[et]-(o[ot]/2-_e[ot]/2);break;case end:s[et]=s[et]+(o[ot]/2-_e[ot]/2);break}}return s}function detectOverflow(a,o){o===void 0&&(o={});var _e=o,tt=_e.placement,at=tt===void 0?a.placement:tt,lt=_e.strategy,it=lt===void 0?a.strategy:lt,ut=_e.boundary,s=ut===void 0?clippingParents:ut,et=_e.rootBoundary,ot=et===void 0?viewport:et,st=_e.elementContext,Rt=st===void 0?popper:st,ht=_e.altBoundary,bt=ht===void 0?!1:ht,ct=_e.padding,mt=ct===void 0?0:ct,rt=mergePaddingObject(typeof mt!="number"?mt:expandToHashMap(mt,basePlacements)),pt=Rt===popper?reference:popper,ft=a.rects.popper,St=a.elements[bt?pt:Rt],It=getClippingRect(isElement(St)?St:St.contextElement||getDocumentElement(a.elements.popper),s,ot,it),xt=getBoundingClientRect(a.elements.reference),At=computeOffsets({reference:xt,element:ft,strategy:"absolute",placement:at}),Dt=rectToClientRect(Object.assign({},ft,At)),wt=Rt===popper?Dt:xt,Mt={top:It.top-wt.top+rt.top,bottom:wt.bottom-It.bottom+rt.bottom,left:It.left-wt.left+rt.left,right:wt.right-It.right+rt.right},vt=a.modifiersData.offset;if(Rt===popper&&vt){var Ft=vt[at];Object.keys(Mt).forEach(function(Ht){var Wt=[right,bottom].indexOf(Ht)>=0?1:-1,tn=[top,bottom].indexOf(Ht)>=0?"y":"x";Mt[Ht]+=Ft[tn]*Wt})}return Mt}function computeAutoPlacement(a,o){o===void 0&&(o={});var _e=o,tt=_e.placement,at=_e.boundary,lt=_e.rootBoundary,it=_e.padding,ut=_e.flipVariations,s=_e.allowedAutoPlacements,et=s===void 0?placements:s,ot=getVariation(tt),st=ot?ut?variationPlacements:variationPlacements.filter(function(bt){return getVariation(bt)===ot}):basePlacements,Rt=st.filter(function(bt){return et.indexOf(bt)>=0});Rt.length===0&&(Rt=st);var ht=Rt.reduce(function(bt,ct){return bt[ct]=detectOverflow(a,{placement:ct,boundary:at,rootBoundary:lt,padding:it})[getBasePlacement(ct)],bt},{});return Object.keys(ht).sort(function(bt,ct){return ht[bt]-ht[ct]})}function getExpandedFallbackPlacements(a){if(getBasePlacement(a)===auto)return[];var o=getOppositePlacement(a);return[getOppositeVariationPlacement(a),o,getOppositeVariationPlacement(o)]}function flip(a){var o=a.state,_e=a.options,tt=a.name;if(!o.modifiersData[tt]._skip){for(var at=_e.mainAxis,lt=at===void 0?!0:at,it=_e.altAxis,ut=it===void 0?!0:it,s=_e.fallbackPlacements,et=_e.padding,ot=_e.boundary,st=_e.rootBoundary,Rt=_e.altBoundary,ht=_e.flipVariations,bt=ht===void 0?!0:ht,ct=_e.allowedAutoPlacements,mt=o.options.placement,rt=getBasePlacement(mt),pt=rt===mt,ft=s||(pt||!bt?[getOppositePlacement(mt)]:getExpandedFallbackPlacements(mt)),St=[mt].concat(ft).reduce(function(yn,pn){return yn.concat(getBasePlacement(pn)===auto?computeAutoPlacement(o,{placement:pn,boundary:ot,rootBoundary:st,padding:et,flipVariations:bt,allowedAutoPlacements:ct}):pn)},[]),It=o.rects.reference,xt=o.rects.popper,At=new Map,Dt=!0,wt=St[0],Mt=0;Mt<St.length;Mt++){var vt=St[Mt],Ft=getBasePlacement(vt),Ht=getVariation(vt)===start,Wt=[top,bottom].indexOf(Ft)>=0,tn=Wt?"width":"height",gn=detectOverflow(o,{placement:vt,boundary:ot,rootBoundary:st,altBoundary:Rt,padding:et}),nn=Wt?Ht?right:left:Ht?bottom:top;It[tn]>xt[tn]&&(nn=getOppositePlacement(nn));var qt=getOppositePlacement(nn),fn=[];if(lt&&fn.push(gn[Ft]<=0),ut&&fn.push(gn[nn]<=0,gn[qt]<=0),fn.every(function(yn){return yn})){wt=vt,Dt=!1;break}At.set(vt,fn)}if(Dt)for(var Cn=bt?3:1,Tn=function(pn){var In=St.find(function(kn){var Mn=At.get(kn);if(Mn)return Mn.slice(0,pn).every(function(xn){return xn})});if(In)return wt=In,"break"},un=Cn;un>0;un--){var mn=Tn(un);if(mn==="break")break}o.placement!==wt&&(o.modifiersData[tt]._skip=!0,o.placement=wt,o.reset=!0)}}const flip$1={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(a,o,_e){return _e===void 0&&(_e={x:0,y:0}),{top:a.top-o.height-_e.y,right:a.right-o.width+_e.x,bottom:a.bottom-o.height+_e.y,left:a.left-o.width-_e.x}}function isAnySideFullyClipped(a){return[top,right,bottom,left].some(function(o){return a[o]>=0})}function hide(a){var o=a.state,_e=a.name,tt=o.rects.reference,at=o.rects.popper,lt=o.modifiersData.preventOverflow,it=detectOverflow(o,{elementContext:"reference"}),ut=detectOverflow(o,{altBoundary:!0}),s=getSideOffsets(it,tt),et=getSideOffsets(ut,at,lt),ot=isAnySideFullyClipped(s),st=isAnySideFullyClipped(et);o.modifiersData[_e]={referenceClippingOffsets:s,popperEscapeOffsets:et,isReferenceHidden:ot,hasPopperEscaped:st},o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-reference-hidden":ot,"data-popper-escaped":st})}const hide$1={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(a,o,_e){var tt=getBasePlacement(a),at=[left,top].indexOf(tt)>=0?-1:1,lt=typeof _e=="function"?_e(Object.assign({},o,{placement:a})):_e,it=lt[0],ut=lt[1];return it=it||0,ut=(ut||0)*at,[left,right].indexOf(tt)>=0?{x:ut,y:it}:{x:it,y:ut}}function offset(a){var o=a.state,_e=a.options,tt=a.name,at=_e.offset,lt=at===void 0?[0,0]:at,it=placements.reduce(function(ot,st){return ot[st]=distanceAndSkiddingToXY(st,o.rects,lt),ot},{}),ut=it[o.placement],s=ut.x,et=ut.y;o.modifiersData.popperOffsets!=null&&(o.modifiersData.popperOffsets.x+=s,o.modifiersData.popperOffsets.y+=et),o.modifiersData[tt]=it}const offset$1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(a){var o=a.state,_e=a.name;o.modifiersData[_e]=computeOffsets({reference:o.rects.reference,element:o.rects.popper,strategy:"absolute",placement:o.placement})}const popperOffsets$1={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(a){return a==="x"?"y":"x"}function preventOverflow(a){var o=a.state,_e=a.options,tt=a.name,at=_e.mainAxis,lt=at===void 0?!0:at,it=_e.altAxis,ut=it===void 0?!1:it,s=_e.boundary,et=_e.rootBoundary,ot=_e.altBoundary,st=_e.padding,Rt=_e.tether,ht=Rt===void 0?!0:Rt,bt=_e.tetherOffset,ct=bt===void 0?0:bt,mt=detectOverflow(o,{boundary:s,rootBoundary:et,padding:st,altBoundary:ot}),rt=getBasePlacement(o.placement),pt=getVariation(o.placement),ft=!pt,St=getMainAxisFromPlacement(rt),It=getAltAxis(St),xt=o.modifiersData.popperOffsets,At=o.rects.reference,Dt=o.rects.popper,wt=typeof ct=="function"?ct(Object.assign({},o.rects,{placement:o.placement})):ct,Mt=typeof wt=="number"?{mainAxis:wt,altAxis:wt}:Object.assign({mainAxis:0,altAxis:0},wt),vt=o.modifiersData.offset?o.modifiersData.offset[o.placement]:null,Ft={x:0,y:0};if(xt){if(lt){var Ht,Wt=St==="y"?top:left,tn=St==="y"?bottom:right,gn=St==="y"?"height":"width",nn=xt[St],qt=nn+mt[Wt],fn=nn-mt[tn],Cn=ht?-Dt[gn]/2:0,Tn=pt===start?At[gn]:Dt[gn],un=pt===start?-Dt[gn]:-At[gn],mn=o.elements.arrow,yn=ht&&mn?getLayoutRect(mn):{width:0,height:0},pn=o.modifiersData["arrow#persistent"]?o.modifiersData["arrow#persistent"].padding:getFreshSideObject(),In=pn[Wt],kn=pn[tn],Mn=within(0,At[gn],yn[gn]),xn=ft?At[gn]/2-Cn-Mn-In-Mt.mainAxis:Tn-Mn-In-Mt.mainAxis,Pn=ft?-At[gn]/2+Cn+Mn+kn+Mt.mainAxis:un+Mn+kn+Mt.mainAxis,On=o.elements.arrow&&getOffsetParent(o.elements.arrow),Dn=On?St==="y"?On.clientTop||0:On.clientLeft||0:0,Fn=(Ht=vt==null?void 0:vt[St])!=null?Ht:0,dr=nn+xn-Fn-Dn,ir=nn+Pn-Fn,Xn=within(ht?min(qt,dr):qt,nn,ht?max(fn,ir):fn);xt[St]=Xn,Ft[St]=Xn-nn}if(ut){var tr,cn=St==="x"?top:left,Jn=St==="x"?bottom:right,Qn=xt[It],sr=It==="y"?"height":"width",Bn=Qn+mt[cn],rr=Qn-mt[Jn],nr=[top,left].indexOf(rt)!==-1,Nn=(tr=vt==null?void 0:vt[It])!=null?tr:0,Wn=nr?Bn:Qn-At[sr]-Dt[sr]-Nn+Mt.altAxis,vn=nr?Qn+At[sr]+Dt[sr]-Nn-Mt.altAxis:rr,Rn=ht&&nr?withinMaxClamp(Wn,Qn,vn):within(ht?Wn:Bn,Qn,ht?vn:rr);xt[It]=Rn,Ft[It]=Rn-Qn}o.modifiersData[tt]=Ft}}const preventOverflow$1={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(a){return{scrollLeft:a.scrollLeft,scrollTop:a.scrollTop}}function getNodeScroll(a){return a===getWindow(a)||!isHTMLElement$1(a)?getWindowScroll(a):getHTMLElementScroll(a)}function isElementScaled(a){var o=a.getBoundingClientRect(),_e=round$2(o.width)/a.offsetWidth||1,tt=round$2(o.height)/a.offsetHeight||1;return _e!==1||tt!==1}function getCompositeRect(a,o,_e){_e===void 0&&(_e=!1);var tt=isHTMLElement$1(o),at=isHTMLElement$1(o)&&isElementScaled(o),lt=getDocumentElement(o),it=getBoundingClientRect(a,at,_e),ut={scrollLeft:0,scrollTop:0},s={x:0,y:0};return(tt||!tt&&!_e)&&((getNodeName(o)!=="body"||isScrollParent(lt))&&(ut=getNodeScroll(o)),isHTMLElement$1(o)?(s=getBoundingClientRect(o,!0),s.x+=o.clientLeft,s.y+=o.clientTop):lt&&(s.x=getWindowScrollBarX(lt))),{x:it.left+ut.scrollLeft-s.x,y:it.top+ut.scrollTop-s.y,width:it.width,height:it.height}}function order(a){var o=new Map,_e=new Set,tt=[];a.forEach(function(lt){o.set(lt.name,lt)});function at(lt){_e.add(lt.name);var it=[].concat(lt.requires||[],lt.requiresIfExists||[]);it.forEach(function(ut){if(!_e.has(ut)){var s=o.get(ut);s&&at(s)}}),tt.push(lt)}return a.forEach(function(lt){_e.has(lt.name)||at(lt)}),tt}function orderModifiers(a){var o=order(a);return modifierPhases.reduce(function(_e,tt){return _e.concat(o.filter(function(at){return at.phase===tt}))},[])}function debounce(a){var o;return function(){return o||(o=new Promise(function(_e){Promise.resolve().then(function(){o=void 0,_e(a())})})),o}}function mergeByName(a){var o=a.reduce(function(_e,tt){var at=_e[tt.name];return _e[tt.name]=at?Object.assign({},at,tt,{options:Object.assign({},at.options,tt.options),data:Object.assign({},at.data,tt.data)}):tt,_e},{});return Object.keys(o).map(function(_e){return o[_e]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var a=arguments.length,o=new Array(a),_e=0;_e<a;_e++)o[_e]=arguments[_e];return!o.some(function(tt){return!(tt&&typeof tt.getBoundingClientRect=="function")})}function popperGenerator(a){a===void 0&&(a={});var o=a,_e=o.defaultModifiers,tt=_e===void 0?[]:_e,at=o.defaultOptions,lt=at===void 0?DEFAULT_OPTIONS:at;return function(ut,s,et){et===void 0&&(et=lt);var ot={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,lt),modifiersData:{},elements:{reference:ut,popper:s},attributes:{},styles:{}},st=[],Rt=!1,ht={state:ot,setOptions:function(rt){var pt=typeof rt=="function"?rt(ot.options):rt;ct(),ot.options=Object.assign({},lt,ot.options,pt),ot.scrollParents={reference:isElement(ut)?listScrollParents(ut):ut.contextElement?listScrollParents(ut.contextElement):[],popper:listScrollParents(s)};var ft=orderModifiers(mergeByName([].concat(tt,ot.options.modifiers)));return ot.orderedModifiers=ft.filter(function(St){return St.enabled}),bt(),ht.update()},forceUpdate:function(){if(!Rt){var rt=ot.elements,pt=rt.reference,ft=rt.popper;if(areValidElements(pt,ft)){ot.rects={reference:getCompositeRect(pt,getOffsetParent(ft),ot.options.strategy==="fixed"),popper:getLayoutRect(ft)},ot.reset=!1,ot.placement=ot.options.placement,ot.orderedModifiers.forEach(function(Mt){return ot.modifiersData[Mt.name]=Object.assign({},Mt.data)});for(var St=0;St<ot.orderedModifiers.length;St++){if(ot.reset===!0){ot.reset=!1,St=-1;continue}var It=ot.orderedModifiers[St],xt=It.fn,At=It.options,Dt=At===void 0?{}:At,wt=It.name;typeof xt=="function"&&(ot=xt({state:ot,options:Dt,name:wt,instance:ht})||ot)}}}},update:debounce(function(){return new Promise(function(mt){ht.forceUpdate(),mt(ot)})}),destroy:function(){ct(),Rt=!0}};if(!areValidElements(ut,s))return ht;ht.setOptions(et).then(function(mt){!Rt&&et.onFirstUpdate&&et.onFirstUpdate(mt)});function bt(){ot.orderedModifiers.forEach(function(mt){var rt=mt.name,pt=mt.options,ft=pt===void 0?{}:pt,St=mt.effect;if(typeof St=="function"){var It=St({state:ot,name:rt,instance:ht,options:ft}),xt=function(){};st.push(It||xt)}})}function ct(){st.forEach(function(mt){return mt()}),st=[]}return ht}}var defaultModifiers=[eventListeners,popperOffsets$1,computeStyles$1,applyStyles$1,offset$1,flip$1,preventOverflow$1,arrow$1,hide$1],createPopper=popperGenerator({defaultModifiers});function getContainer$1(a){return typeof a=="function"?a():a}const Portal=reactExports.forwardRef(function(o,_e){const{children:tt,container:at,disablePortal:lt=!1}=o,[it,ut]=reactExports.useState(null),s=useForkRef(reactExports.isValidElement(tt)?tt.ref:null,_e);if(useEnhancedEffect$1(()=>{lt||ut(getContainer$1(at)||document.body)},[at,lt]),useEnhancedEffect$1(()=>{if(it&&!lt)return setRef(_e,it),()=>{setRef(_e,null)}},[_e,it,lt]),lt){if(reactExports.isValidElement(tt)){const et={ref:s};return reactExports.cloneElement(tt,et)}return jsxRuntimeExports.jsx(reactExports.Fragment,{children:tt})}return jsxRuntimeExports.jsx(reactExports.Fragment,{children:it&&reactDomExports.createPortal(tt,it)})}),Portal$1=Portal;function getPopperUtilityClass(a){return generateUtilityClass("MuiPopper",a)}generateUtilityClasses("MuiPopper",["root"]);const _excluded$L=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],_excluded2$2=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function flipPlacement(a,o){if(o==="ltr")return a;switch(a){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return a}}function resolveAnchorEl$1(a){return typeof a=="function"?a():a}function isHTMLElement(a){return a.nodeType!==void 0}const useUtilityClasses$y=()=>composeClasses({root:["root"]},useClassNamesOverride(getPopperUtilityClass)),defaultPopperOptions={},PopperTooltip=reactExports.forwardRef(function(o,_e){var tt;const{anchorEl:at,children:lt,direction:it,disablePortal:ut,modifiers:s,open:et,placement:ot,popperOptions:st,popperRef:Rt,slotProps:ht={},slots:bt={},TransitionProps:ct}=o,mt=_objectWithoutPropertiesLoose(o,_excluded$L),rt=reactExports.useRef(null),pt=useForkRef(rt,_e),ft=reactExports.useRef(null),St=useForkRef(ft,Rt),It=reactExports.useRef(St);useEnhancedEffect$1(()=>{It.current=St},[St]),reactExports.useImperativeHandle(Rt,()=>ft.current,[]);const xt=flipPlacement(ot,it),[At,Dt]=reactExports.useState(xt),[wt,Mt]=reactExports.useState(resolveAnchorEl$1(at));reactExports.useEffect(()=>{ft.current&&ft.current.forceUpdate()}),reactExports.useEffect(()=>{at&&Mt(resolveAnchorEl$1(at))},[at]),useEnhancedEffect$1(()=>{if(!wt||!et)return;const tn=qt=>{Dt(qt.placement)};let gn=[{name:"preventOverflow",options:{altBoundary:ut}},{name:"flip",options:{altBoundary:ut}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:qt})=>{tn(qt)}}];s!=null&&(gn=gn.concat(s)),st&&st.modifiers!=null&&(gn=gn.concat(st.modifiers));const nn=createPopper(wt,rt.current,_extends({placement:xt},st,{modifiers:gn}));return It.current(nn),()=>{nn.destroy(),It.current(null)}},[wt,ut,s,et,st,xt]);const vt={placement:At};ct!==null&&(vt.TransitionProps=ct);const Ft=useUtilityClasses$y(),Ht=(tt=bt.root)!=null?tt:"div",Wt=useSlotProps({elementType:Ht,externalSlotProps:ht.root,externalForwardedProps:mt,additionalProps:{role:"tooltip",ref:pt},ownerState:o,className:Ft.root});return jsxRuntimeExports.jsx(Ht,_extends({},Wt,{children:typeof lt=="function"?lt(vt):lt}))}),Popper$2=reactExports.forwardRef(function(o,_e){const{anchorEl:tt,children:at,container:lt,direction:it="ltr",disablePortal:ut=!1,keepMounted:s=!1,modifiers:et,open:ot,placement:st="bottom",popperOptions:Rt=defaultPopperOptions,popperRef:ht,style:bt,transition:ct=!1,slotProps:mt={},slots:rt={}}=o,pt=_objectWithoutPropertiesLoose(o,_excluded2$2),[ft,St]=reactExports.useState(!0),It=()=>{St(!1)},xt=()=>{St(!0)};if(!s&&!ot&&(!ct||ft))return null;let At;if(lt)At=lt;else if(tt){const Mt=resolveAnchorEl$1(tt);At=Mt&&isHTMLElement(Mt)?ownerDocument(Mt).body:ownerDocument(null).body}const Dt=!ot&&s&&(!ct||ft)?"none":void 0,wt=ct?{in:ot,onEnter:It,onExited:xt}:void 0;return jsxRuntimeExports.jsx(Portal$1,{disablePortal:ut,container:At,children:jsxRuntimeExports.jsx(PopperTooltip,_extends({anchorEl:tt,direction:it,disablePortal:ut,modifiers:et,ref:_e,open:ct?!ft:ot,placement:st,popperOptions:Rt,popperRef:ht,slotProps:mt,slots:rt},pt,{style:_extends({position:"fixed",top:0,left:0,display:Dt},bt),TransitionProps:wt,children:at}))})}),BasePopper=Popper$2;function isOverflowing(a){const o=ownerDocument(a);return o.body===a?ownerWindow(a).innerWidth>o.documentElement.clientWidth:a.scrollHeight>a.clientHeight}function ariaHidden(a,o){o?a.setAttribute("aria-hidden","true"):a.removeAttribute("aria-hidden")}function getPaddingRight(a){return parseInt(ownerWindow(a).getComputedStyle(a).paddingRight,10)||0}function isAriaHiddenForbiddenOnElement(a){const _e=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(a.tagName)!==-1,tt=a.tagName==="INPUT"&&a.getAttribute("type")==="hidden";return _e||tt}function ariaHiddenSiblings(a,o,_e,tt,at){const lt=[o,_e,...tt];[].forEach.call(a.children,it=>{const ut=lt.indexOf(it)===-1,s=!isAriaHiddenForbiddenOnElement(it);ut&&s&&ariaHidden(it,at)})}function findIndexOf(a,o){let _e=-1;return a.some((tt,at)=>o(tt)?(_e=at,!0):!1),_e}function handleContainer(a,o){const _e=[],tt=a.container;if(!o.disableScrollLock){if(isOverflowing(tt)){const it=getScrollbarSize(ownerDocument(tt));_e.push({value:tt.style.paddingRight,property:"padding-right",el:tt}),tt.style.paddingRight=`${getPaddingRight(tt)+it}px`;const ut=ownerDocument(tt).querySelectorAll(".mui-fixed");[].forEach.call(ut,s=>{_e.push({value:s.style.paddingRight,property:"padding-right",el:s}),s.style.paddingRight=`${getPaddingRight(s)+it}px`})}let lt;if(tt.parentNode instanceof DocumentFragment)lt=ownerDocument(tt).body;else{const it=tt.parentElement,ut=ownerWindow(tt);lt=(it==null?void 0:it.nodeName)==="HTML"&&ut.getComputedStyle(it).overflowY==="scroll"?it:tt}_e.push({value:lt.style.overflow,property:"overflow",el:lt},{value:lt.style.overflowX,property:"overflow-x",el:lt},{value:lt.style.overflowY,property:"overflow-y",el:lt}),lt.style.overflow="hidden"}return()=>{_e.forEach(({value:lt,el:it,property:ut})=>{lt?it.style.setProperty(ut,lt):it.style.removeProperty(ut)})}}function getHiddenSiblings(a){const o=[];return[].forEach.call(a.children,_e=>{_e.getAttribute("aria-hidden")==="true"&&o.push(_e)}),o}class ModalManager{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(o,_e){let tt=this.modals.indexOf(o);if(tt!==-1)return tt;tt=this.modals.length,this.modals.push(o),o.modalRef&&ariaHidden(o.modalRef,!1);const at=getHiddenSiblings(_e);ariaHiddenSiblings(_e,o.mount,o.modalRef,at,!0);const lt=findIndexOf(this.containers,it=>it.container===_e);return lt!==-1?(this.containers[lt].modals.push(o),tt):(this.containers.push({modals:[o],container:_e,restore:null,hiddenSiblings:at}),tt)}mount(o,_e){const tt=findIndexOf(this.containers,lt=>lt.modals.indexOf(o)!==-1),at=this.containers[tt];at.restore||(at.restore=handleContainer(at,_e))}remove(o,_e=!0){const tt=this.modals.indexOf(o);if(tt===-1)return tt;const at=findIndexOf(this.containers,it=>it.modals.indexOf(o)!==-1),lt=this.containers[at];if(lt.modals.splice(lt.modals.indexOf(o),1),this.modals.splice(tt,1),lt.modals.length===0)lt.restore&&lt.restore(),o.modalRef&&ariaHidden(o.modalRef,_e),ariaHiddenSiblings(lt.container,o.mount,o.modalRef,lt.hiddenSiblings,!1),this.containers.splice(at,1);else{const it=lt.modals[lt.modals.length-1];it.modalRef&&ariaHidden(it.modalRef,!1)}return tt}isTopModal(o){return this.modals.length>0&&this.modals[this.modals.length-1]===o}}function getModalUtilityClass(a){return generateUtilityClass("MuiModal",a)}generateUtilityClasses("MuiModal",["root","hidden","backdrop"]);const _excluded$K=["children","closeAfterTransition","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onKeyDown","open","onTransitionEnter","onTransitionExited","slotProps","slots"],useUtilityClasses$x=a=>{const{open:o,exited:_e}=a;return composeClasses({root:["root",!o&&_e&&"hidden"],backdrop:["backdrop"]},useClassNamesOverride(getModalUtilityClass))};function getContainer(a){return typeof a=="function"?a():a}function getHasTransition(a){return a?a.props.hasOwnProperty("in"):!1}const defaultManager=new ModalManager,Modal$2=reactExports.forwardRef(function(o,_e){var tt,at;const{children:lt,closeAfterTransition:it=!1,container:ut,disableAutoFocus:s=!1,disableEnforceFocus:et=!1,disableEscapeKeyDown:ot=!1,disablePortal:st=!1,disableRestoreFocus:Rt=!1,disableScrollLock:ht=!1,hideBackdrop:bt=!1,keepMounted:ct=!1,manager:mt=defaultManager,onBackdropClick:rt,onClose:pt,onKeyDown:ft,open:St,onTransitionEnter:It,onTransitionExited:xt,slotProps:At={},slots:Dt={}}=o,wt=_objectWithoutPropertiesLoose(o,_excluded$K),Mt=mt,[vt,Ft]=reactExports.useState(!St),Ht=reactExports.useRef({}),Wt=reactExports.useRef(null),tn=reactExports.useRef(null),gn=useForkRef(tn,_e),nn=getHasTransition(lt),qt=(tt=o["aria-hidden"])!=null?tt:!0,fn=()=>ownerDocument(Wt.current),Cn=()=>(Ht.current.modalRef=tn.current,Ht.current.mountNode=Wt.current,Ht.current),Tn=()=>{Mt.mount(Cn(),{disableScrollLock:ht}),tn.current&&(tn.current.scrollTop=0)},un=useEventCallback(()=>{const tr=getContainer(ut)||fn().body;Mt.add(Cn(),tr),tn.current&&Tn()}),mn=reactExports.useCallback(()=>Mt.isTopModal(Cn()),[Mt]),yn=useEventCallback(tr=>{Wt.current=tr,!(!tr||!tn.current)&&(St&&mn()?Tn():ariaHidden(tn.current,qt))}),pn=reactExports.useCallback(()=>{Mt.remove(Cn(),qt)},[Mt,qt]);reactExports.useEffect(()=>()=>{pn()},[pn]),reactExports.useEffect(()=>{St?un():(!nn||!it)&&pn()},[St,pn,nn,it,un]);const In=_extends({},o,{closeAfterTransition:it,disableAutoFocus:s,disableEnforceFocus:et,disableEscapeKeyDown:ot,disablePortal:st,disableRestoreFocus:Rt,disableScrollLock:ht,exited:vt,hideBackdrop:bt,keepMounted:ct}),kn=useUtilityClasses$x(In),Mn=()=>{Ft(!1),It&&It()},xn=()=>{Ft(!0),xt&&xt(),it&&pn()},Pn=tr=>{tr.target===tr.currentTarget&&(rt&&rt(tr),pt&&pt(tr,"backdropClick"))},On=tr=>{ft&&ft(tr),!(tr.key!=="Escape"||!mn())&&(ot||(tr.stopPropagation(),pt&&pt(tr,"escapeKeyDown")))},Dn={};lt.props.tabIndex===void 0&&(Dn.tabIndex="-1"),nn&&(Dn.onEnter=createChainedFunction(Mn,lt.props.onEnter),Dn.onExited=createChainedFunction(xn,lt.props.onExited));const Fn=(at=Dt.root)!=null?at:"div",dr=useSlotProps({elementType:Fn,externalSlotProps:At.root,externalForwardedProps:wt,additionalProps:{ref:gn,role:"presentation",onKeyDown:On},className:kn.root,ownerState:In}),ir=Dt.backdrop,Xn=useSlotProps({elementType:ir,externalSlotProps:At.backdrop,additionalProps:{"aria-hidden":!0,onClick:Pn,open:St},className:kn.backdrop,ownerState:In});return!ct&&!St&&(!nn||vt)?null:jsxRuntimeExports.jsx(Portal$1,{ref:yn,container:ut,disablePortal:st,children:jsxRuntimeExports.jsxs(Fn,_extends({},dr,{children:[!bt&&ir?jsxRuntimeExports.jsx(ir,_extends({},Xn)):null,jsxRuntimeExports.jsx(FocusTrap,{disableEnforceFocus:et,disableAutoFocus:s,disableRestoreFocus:Rt,isEnabled:mn,open:St,children:reactExports.cloneElement(lt,Dn)})]}))})}),ModalUnstyled=Modal$2,_excluded$J=["onChange","maxRows","minRows","style","value"];function getStyleValue(a){return parseInt(a,10)||0}const styles$2={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function isEmpty$1(a){return a==null||Object.keys(a).length===0||a.outerHeightStyle===0&&!a.overflow}const TextareaAutosize=reactExports.forwardRef(function(o,_e){const{onChange:tt,maxRows:at,minRows:lt=1,style:it,value:ut}=o,s=_objectWithoutPropertiesLoose(o,_excluded$J),{current:et}=reactExports.useRef(ut!=null),ot=reactExports.useRef(null),st=useForkRef(_e,ot),Rt=reactExports.useRef(null),ht=reactExports.useRef(0),[bt,ct]=reactExports.useState({outerHeightStyle:0}),mt=reactExports.useCallback(()=>{const It=ot.current,At=ownerWindow(It).getComputedStyle(It);if(At.width==="0px")return{outerHeightStyle:0};const Dt=Rt.current;Dt.style.width=At.width,Dt.value=It.value||o.placeholder||"x",Dt.value.slice(-1)===`
`&&(Dt.value+=" ");const wt=At.boxSizing,Mt=getStyleValue(At.paddingBottom)+getStyleValue(At.paddingTop),vt=getStyleValue(At.borderBottomWidth)+getStyleValue(At.borderTopWidth),Ft=Dt.scrollHeight;Dt.value="x";const Ht=Dt.scrollHeight;let Wt=Ft;lt&&(Wt=Math.max(Number(lt)*Ht,Wt)),at&&(Wt=Math.min(Number(at)*Ht,Wt)),Wt=Math.max(Wt,Ht);const tn=Wt+(wt==="border-box"?Mt+vt:0),gn=Math.abs(Wt-Ft)<=1;return{outerHeightStyle:tn,overflow:gn}},[at,lt,o.placeholder]),rt=(It,xt)=>{const{outerHeightStyle:At,overflow:Dt}=xt;return ht.current<20&&(At>0&&Math.abs((It.outerHeightStyle||0)-At)>1||It.overflow!==Dt)?(ht.current+=1,{overflow:Dt,outerHeightStyle:At}):It},pt=reactExports.useCallback(()=>{const It=mt();isEmpty$1(It)||ct(xt=>rt(xt,It))},[mt]),ft=()=>{const It=mt();isEmpty$1(It)||reactDomExports.flushSync(()=>{ct(xt=>rt(xt,It))})};reactExports.useEffect(()=>{const It=debounce$1(()=>{ht.current=0,ot.current&&ft()});let xt;const At=ot.current,Dt=ownerWindow(At);return Dt.addEventListener("resize",It),typeof ResizeObserver<"u"&&(xt=new ResizeObserver(It),xt.observe(At)),()=>{It.clear(),Dt.removeEventListener("resize",It),xt&&xt.disconnect()}}),useEnhancedEffect$1(()=>{pt()}),reactExports.useEffect(()=>{ht.current=0},[ut]);const St=It=>{ht.current=0,et||pt(),tt&&tt(It)};return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("textarea",_extends({value:ut,onChange:St,ref:st,rows:lt,style:_extends({height:bt.outerHeightStyle,overflow:bt.overflow?"hidden":void 0},it)},s)),jsxRuntimeExports.jsx("textarea",{"aria-hidden":!0,className:o.className,readOnly:!0,ref:Rt,tabIndex:-1,style:_extends({},styles$2.shadow,it,{padding:0})})]})}),TextareaAutosize$1=TextareaAutosize;function createMixins(a,o){return _extends({toolbar:{minHeight:56,[a.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[a.up("sm")]:{minHeight:64}}},o)}const common={black:"#000",white:"#fff"},common$1=common,grey={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},grey$1=grey,purple={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},purple$1=purple,red={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},red$1=red,orange={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},orange$1=orange,blue={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},blue$1=blue,lightBlue={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},lightBlue$1=lightBlue,green={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},green$1=green,_excluded$I=["mode","contrastThreshold","tonalOffset"],light={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:common$1.white,default:common$1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},dark={text:{primary:common$1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:common$1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function addLightOrDark(a,o,_e,tt){const at=tt.light||tt,lt=tt.dark||tt*1.5;a[o]||(a.hasOwnProperty(_e)?a[o]=a[_e]:o==="light"?a.light=lighten(a.main,at):o==="dark"&&(a.dark=darken(a.main,lt)))}function getDefaultPrimary(a="light"){return a==="dark"?{main:blue$1[200],light:blue$1[50],dark:blue$1[400]}:{main:blue$1[700],light:blue$1[400],dark:blue$1[800]}}function getDefaultSecondary(a="light"){return a==="dark"?{main:purple$1[200],light:purple$1[50],dark:purple$1[400]}:{main:purple$1[500],light:purple$1[300],dark:purple$1[700]}}function getDefaultError(a="light"){return a==="dark"?{main:red$1[500],light:red$1[300],dark:red$1[700]}:{main:red$1[700],light:red$1[400],dark:red$1[800]}}function getDefaultInfo(a="light"){return a==="dark"?{main:lightBlue$1[400],light:lightBlue$1[300],dark:lightBlue$1[700]}:{main:lightBlue$1[700],light:lightBlue$1[500],dark:lightBlue$1[900]}}function getDefaultSuccess(a="light"){return a==="dark"?{main:green$1[400],light:green$1[300],dark:green$1[700]}:{main:green$1[800],light:green$1[500],dark:green$1[900]}}function getDefaultWarning(a="light"){return a==="dark"?{main:orange$1[400],light:orange$1[300],dark:orange$1[700]}:{main:"#ed6c02",light:orange$1[500],dark:orange$1[900]}}function createPalette(a){const{mode:o="light",contrastThreshold:_e=3,tonalOffset:tt=.2}=a,at=_objectWithoutPropertiesLoose(a,_excluded$I),lt=a.primary||getDefaultPrimary(o),it=a.secondary||getDefaultSecondary(o),ut=a.error||getDefaultError(o),s=a.info||getDefaultInfo(o),et=a.success||getDefaultSuccess(o),ot=a.warning||getDefaultWarning(o);function st(ct){return getContrastRatio(ct,dark.text.primary)>=_e?dark.text.primary:light.text.primary}const Rt=({color:ct,name:mt,mainShade:rt=500,lightShade:pt=300,darkShade:ft=700})=>{if(ct=_extends({},ct),!ct.main&&ct[rt]&&(ct.main=ct[rt]),!ct.hasOwnProperty("main"))throw new Error(formatMuiErrorMessage(11,mt?` (${mt})`:"",rt));if(typeof ct.main!="string")throw new Error(formatMuiErrorMessage(12,mt?` (${mt})`:"",JSON.stringify(ct.main)));return addLightOrDark(ct,"light",pt,tt),addLightOrDark(ct,"dark",ft,tt),ct.contrastText||(ct.contrastText=st(ct.main)),ct},ht={dark,light};return deepmerge(_extends({common:_extends({},common$1),mode:o,primary:Rt({color:lt,name:"primary"}),secondary:Rt({color:it,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:Rt({color:ut,name:"error"}),warning:Rt({color:ot,name:"warning"}),info:Rt({color:s,name:"info"}),success:Rt({color:et,name:"success"}),grey:grey$1,contrastThreshold:_e,getContrastText:st,augmentColor:Rt,tonalOffset:tt},ht[o]),at)}const _excluded$H=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function round$1(a){return Math.round(a*1e5)/1e5}const caseAllCaps={textTransform:"uppercase"},defaultFontFamily='"Roboto", "Helvetica", "Arial", sans-serif';function createTypography(a,o){const _e=typeof o=="function"?o(a):o,{fontFamily:tt=defaultFontFamily,fontSize:at=14,fontWeightLight:lt=300,fontWeightRegular:it=400,fontWeightMedium:ut=500,fontWeightBold:s=700,htmlFontSize:et=16,allVariants:ot,pxToRem:st}=_e,Rt=_objectWithoutPropertiesLoose(_e,_excluded$H),ht=at/14,bt=st||(rt=>`${rt/et*ht}rem`),ct=(rt,pt,ft,St,It)=>_extends({fontFamily:tt,fontWeight:rt,fontSize:bt(pt),lineHeight:ft},tt===defaultFontFamily?{letterSpacing:`${round$1(St/pt)}em`}:{},It,ot),mt={h1:ct(lt,96,1.167,-1.5),h2:ct(lt,60,1.2,-.5),h3:ct(it,48,1.167,0),h4:ct(it,34,1.235,.25),h5:ct(it,24,1.334,0),h6:ct(ut,20,1.6,.15),subtitle1:ct(it,16,1.75,.15),subtitle2:ct(ut,14,1.57,.1),body1:ct(it,16,1.5,.15),body2:ct(it,14,1.43,.15),button:ct(ut,14,1.75,.4,caseAllCaps),caption:ct(it,12,1.66,.4),overline:ct(it,12,2.66,1,caseAllCaps),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return deepmerge(_extends({htmlFontSize:et,pxToRem:bt,fontFamily:tt,fontSize:at,fontWeightLight:lt,fontWeightRegular:it,fontWeightMedium:ut,fontWeightBold:s},mt),Rt,{clone:!1})}const shadowKeyUmbraOpacity=.2,shadowKeyPenumbraOpacity=.14,shadowAmbientShadowOpacity=.12;function createShadow(...a){return[`${a[0]}px ${a[1]}px ${a[2]}px ${a[3]}px rgba(0,0,0,${shadowKeyUmbraOpacity})`,`${a[4]}px ${a[5]}px ${a[6]}px ${a[7]}px rgba(0,0,0,${shadowKeyPenumbraOpacity})`,`${a[8]}px ${a[9]}px ${a[10]}px ${a[11]}px rgba(0,0,0,${shadowAmbientShadowOpacity})`].join(",")}const shadows=["none",createShadow(0,2,1,-1,0,1,1,0,0,1,3,0),createShadow(0,3,1,-2,0,2,2,0,0,1,5,0),createShadow(0,3,3,-2,0,3,4,0,0,1,8,0),createShadow(0,2,4,-1,0,4,5,0,0,1,10,0),createShadow(0,3,5,-1,0,5,8,0,0,1,14,0),createShadow(0,3,5,-1,0,6,10,0,0,1,18,0),createShadow(0,4,5,-2,0,7,10,1,0,2,16,1),createShadow(0,5,5,-3,0,8,10,1,0,3,14,2),createShadow(0,5,6,-3,0,9,12,1,0,3,16,2),createShadow(0,6,6,-3,0,10,14,1,0,4,18,3),createShadow(0,6,7,-4,0,11,15,1,0,4,20,3),createShadow(0,7,8,-4,0,12,17,2,0,5,22,4),createShadow(0,7,8,-4,0,13,19,2,0,5,24,4),createShadow(0,7,9,-4,0,14,21,2,0,5,26,4),createShadow(0,8,9,-5,0,15,22,2,0,6,28,5),createShadow(0,8,10,-5,0,16,24,2,0,6,30,5),createShadow(0,8,11,-5,0,17,26,2,0,6,32,5),createShadow(0,9,11,-5,0,18,28,2,0,7,34,6),createShadow(0,9,12,-6,0,19,29,2,0,7,36,6),createShadow(0,10,13,-6,0,20,31,3,0,8,38,7),createShadow(0,10,13,-6,0,21,33,3,0,8,40,7),createShadow(0,10,14,-6,0,22,35,3,0,8,42,7),createShadow(0,11,14,-7,0,23,36,3,0,9,44,8),createShadow(0,11,15,-7,0,24,38,3,0,9,46,8)],shadows$1=shadows,_excluded$G=["duration","easing","delay"],easing={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},duration={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function formatMs(a){return`${Math.round(a)}ms`}function getAutoHeightDuration(a){if(!a)return 0;const o=a/36;return Math.round((4+15*o**.25+o/5)*10)}function createTransitions(a){const o=_extends({},easing,a.easing),_e=_extends({},duration,a.duration);return _extends({getAutoHeightDuration,create:(at=["all"],lt={})=>{const{duration:it=_e.standard,easing:ut=o.easeInOut,delay:s=0}=lt;return _objectWithoutPropertiesLoose(lt,_excluded$G),(Array.isArray(at)?at:[at]).map(et=>`${et} ${typeof it=="string"?it:formatMs(it)} ${ut} ${typeof s=="string"?s:formatMs(s)}`).join(",")}},a,{easing:o,duration:_e})}const zIndex={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},zIndex$1=zIndex,_excluded$F=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function createTheme(a={},...o){const{mixins:_e={},palette:tt={},transitions:at={},typography:lt={}}=a,it=_objectWithoutPropertiesLoose(a,_excluded$F);if(a.vars)throw new Error(formatMuiErrorMessage(18));const ut=createPalette(tt),s=createTheme$1(a);let et=deepmerge(s,{mixins:createMixins(s.breakpoints,_e),palette:ut,shadows:shadows$1.slice(),typography:createTypography(ut,lt),transitions:createTransitions(at),zIndex:_extends({},zIndex$1)});return et=deepmerge(et,it),et=o.reduce((ot,st)=>deepmerge(ot,st),et),et.unstable_sxConfig=_extends({},defaultSxConfig$1,it==null?void 0:it.unstable_sxConfig),et.unstable_sx=function(st){return styleFunctionSx$1({sx:st,theme:this})},et}const defaultTheme$1=createTheme(),defaultTheme$2=defaultTheme$1,THEME_ID="$$material",rootShouldForwardProp=a=>shouldForwardProp(a)&&a!=="classes",slotShouldForwardProp=shouldForwardProp,styled=createStyled({themeId:THEME_ID,defaultTheme:defaultTheme$2,rootShouldForwardProp}),styled$1=styled;function useThemeProps({props:a,name:o}){return useThemeProps$1({props:a,name:o,defaultTheme:defaultTheme$2,themeId:THEME_ID})}function useTheme(){const a=useTheme$2(defaultTheme$2);return a[THEME_ID]||a}const GridContext=reactExports.createContext(),GridContext$1=GridContext;function getGridUtilityClass(a){return generateUtilityClass("MuiGrid",a)}const SPACINGS=[0,1,2,3,4,5,6,7,8,9,10],DIRECTIONS=["column-reverse","column","row-reverse","row"],WRAPS=["nowrap","wrap-reverse","wrap"],GRID_SIZES=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],gridClasses=generateUtilityClasses("MuiGrid",["root","container","item","zeroMinWidth",...SPACINGS.map(a=>`spacing-xs-${a}`),...DIRECTIONS.map(a=>`direction-xs-${a}`),...WRAPS.map(a=>`wrap-xs-${a}`),...GRID_SIZES.map(a=>`grid-xs-${a}`),...GRID_SIZES.map(a=>`grid-sm-${a}`),...GRID_SIZES.map(a=>`grid-md-${a}`),...GRID_SIZES.map(a=>`grid-lg-${a}`),...GRID_SIZES.map(a=>`grid-xl-${a}`)]),gridClasses$1=gridClasses,_excluded$E=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function getOffset(a){const o=parseFloat(a);return`${o}${String(a).replace(String(o),"")||"px"}`}function generateGrid({theme:a,ownerState:o}){let _e;return a.breakpoints.keys.reduce((tt,at)=>{let lt={};if(o[at]&&(_e=o[at]),!_e)return tt;if(_e===!0)lt={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(_e==="auto")lt={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const it=resolveBreakpointValues({values:o.columns,breakpoints:a.breakpoints.values}),ut=typeof it=="object"?it[at]:it;if(ut==null)return tt;const s=`${Math.round(_e/ut*1e8)/1e6}%`;let et={};if(o.container&&o.item&&o.columnSpacing!==0){const ot=a.spacing(o.columnSpacing);if(ot!=="0px"){const st=`calc(${s} + ${getOffset(ot)})`;et={flexBasis:st,maxWidth:st}}}lt=_extends({flexBasis:s,flexGrow:0,maxWidth:s},et)}return a.breakpoints.values[at]===0?Object.assign(tt,lt):tt[a.breakpoints.up(at)]=lt,tt},{})}function generateDirection({theme:a,ownerState:o}){const _e=resolveBreakpointValues({values:o.direction,breakpoints:a.breakpoints.values});return handleBreakpoints({theme:a},_e,tt=>{const at={flexDirection:tt};return tt.indexOf("column")===0&&(at[`& > .${gridClasses$1.item}`]={maxWidth:"none"}),at})}function extractZeroValueBreakpointKeys({breakpoints:a,values:o}){let _e="";Object.keys(o).forEach(at=>{_e===""&&o[at]!==0&&(_e=at)});const tt=Object.keys(a).sort((at,lt)=>a[at]-a[lt]);return tt.slice(0,tt.indexOf(_e))}function generateRowGap({theme:a,ownerState:o}){const{container:_e,rowSpacing:tt}=o;let at={};if(_e&&tt!==0){const lt=resolveBreakpointValues({values:tt,breakpoints:a.breakpoints.values});let it;typeof lt=="object"&&(it=extractZeroValueBreakpointKeys({breakpoints:a.breakpoints.values,values:lt})),at=handleBreakpoints({theme:a},lt,(ut,s)=>{var et;const ot=a.spacing(ut);return ot!=="0px"?{marginTop:`-${getOffset(ot)}`,[`& > .${gridClasses$1.item}`]:{paddingTop:getOffset(ot)}}:(et=it)!=null&&et.includes(s)?{}:{marginTop:0,[`& > .${gridClasses$1.item}`]:{paddingTop:0}}})}return at}function generateColumnGap({theme:a,ownerState:o}){const{container:_e,columnSpacing:tt}=o;let at={};if(_e&&tt!==0){const lt=resolveBreakpointValues({values:tt,breakpoints:a.breakpoints.values});let it;typeof lt=="object"&&(it=extractZeroValueBreakpointKeys({breakpoints:a.breakpoints.values,values:lt})),at=handleBreakpoints({theme:a},lt,(ut,s)=>{var et;const ot=a.spacing(ut);return ot!=="0px"?{width:`calc(100% + ${getOffset(ot)})`,marginLeft:`-${getOffset(ot)}`,[`& > .${gridClasses$1.item}`]:{paddingLeft:getOffset(ot)}}:(et=it)!=null&&et.includes(s)?{}:{width:"100%",marginLeft:0,[`& > .${gridClasses$1.item}`]:{paddingLeft:0}}})}return at}function resolveSpacingStyles(a,o,_e={}){if(!a||a<=0)return[];if(typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number")return[_e[`spacing-xs-${String(a)}`]];const tt=[];return o.forEach(at=>{const lt=a[at];Number(lt)>0&&tt.push(_e[`spacing-${at}-${String(lt)}`])}),tt}const GridRoot=styled$1("div",{name:"MuiGrid",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a,{container:tt,direction:at,item:lt,spacing:it,wrap:ut,zeroMinWidth:s,breakpoints:et}=_e;let ot=[];tt&&(ot=resolveSpacingStyles(it,et,o));const st=[];return et.forEach(Rt=>{const ht=_e[Rt];ht&&st.push(o[`grid-${Rt}-${String(ht)}`])}),[o.root,tt&&o.container,lt&&o.item,s&&o.zeroMinWidth,...ot,at!=="row"&&o[`direction-xs-${String(at)}`],ut!=="wrap"&&o[`wrap-xs-${String(ut)}`],...st]}})(({ownerState:a})=>_extends({boxSizing:"border-box"},a.container&&{display:"flex",flexWrap:"wrap",width:"100%"},a.item&&{margin:0},a.zeroMinWidth&&{minWidth:0},a.wrap!=="wrap"&&{flexWrap:a.wrap}),generateDirection,generateRowGap,generateColumnGap,generateGrid);function resolveSpacingClasses(a,o){if(!a||a<=0)return[];if(typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number")return[`spacing-xs-${String(a)}`];const _e=[];return o.forEach(tt=>{const at=a[tt];if(Number(at)>0){const lt=`spacing-${tt}-${String(at)}`;_e.push(lt)}}),_e}const useUtilityClasses$w=a=>{const{classes:o,container:_e,direction:tt,item:at,spacing:lt,wrap:it,zeroMinWidth:ut,breakpoints:s}=a;let et=[];_e&&(et=resolveSpacingClasses(lt,s));const ot=[];s.forEach(Rt=>{const ht=a[Rt];ht&&ot.push(`grid-${Rt}-${String(ht)}`)});const st={root:["root",_e&&"container",at&&"item",ut&&"zeroMinWidth",...et,tt!=="row"&&`direction-xs-${String(tt)}`,it!=="wrap"&&`wrap-xs-${String(it)}`,...ot]};return composeClasses(st,getGridUtilityClass,o)},Grid=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiGrid"}),{breakpoints:at}=useTheme(),lt=extendSxProp(tt),{className:it,columns:ut,columnSpacing:s,component:et="div",container:ot=!1,direction:st="row",item:Rt=!1,rowSpacing:ht,spacing:bt=0,wrap:ct="wrap",zeroMinWidth:mt=!1}=lt,rt=_objectWithoutPropertiesLoose(lt,_excluded$E),pt=ht||bt,ft=s||bt,St=reactExports.useContext(GridContext$1),It=ot?ut||12:St,xt={},At=_extends({},rt);at.keys.forEach(Mt=>{rt[Mt]!=null&&(xt[Mt]=rt[Mt],delete At[Mt])});const Dt=_extends({},lt,{columns:It,container:ot,direction:st,item:Rt,rowSpacing:pt,columnSpacing:ft,wrap:ct,zeroMinWidth:mt,spacing:bt},xt,{breakpoints:at.keys}),wt=useUtilityClasses$w(Dt);return jsxRuntimeExports.jsx(GridContext$1.Provider,{value:It,children:jsxRuntimeExports.jsx(GridRoot,_extends({ownerState:Dt,className:clsx(wt.root,it),as:et,ref:_e},At))})}),d$1=Grid,ListContext=reactExports.createContext({}),ListContext$1=ListContext;function _setPrototypeOf(a,o){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(tt,at){return tt.__proto__=at,tt},_setPrototypeOf(a,o)}function _inheritsLoose(a,o){a.prototype=Object.create(o.prototype),a.prototype.constructor=a,_setPrototypeOf(a,o)}const config={disabled:!1},TransitionGroupContext=React.createContext(null);var forceReflow=function(o){return o.scrollTop},UNMOUNTED="unmounted",EXITED="exited",ENTERING="entering",ENTERED="entered",EXITING="exiting",Transition=function(a){_inheritsLoose(o,a);function o(tt,at){var lt;lt=a.call(this,tt,at)||this;var it=at,ut=it&&!it.isMounting?tt.enter:tt.appear,s;return lt.appearStatus=null,tt.in?ut?(s=EXITED,lt.appearStatus=ENTERING):s=ENTERED:tt.unmountOnExit||tt.mountOnEnter?s=UNMOUNTED:s=EXITED,lt.state={status:s},lt.nextCallback=null,lt}o.getDerivedStateFromProps=function(at,lt){var it=at.in;return it&&lt.status===UNMOUNTED?{status:EXITED}:null};var _e=o.prototype;return _e.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},_e.componentDidUpdate=function(at){var lt=null;if(at!==this.props){var it=this.state.status;this.props.in?it!==ENTERING&&it!==ENTERED&&(lt=ENTERING):(it===ENTERING||it===ENTERED)&&(lt=EXITING)}this.updateStatus(!1,lt)},_e.componentWillUnmount=function(){this.cancelNextCallback()},_e.getTimeouts=function(){var at=this.props.timeout,lt,it,ut;return lt=it=ut=at,at!=null&&typeof at!="number"&&(lt=at.exit,it=at.enter,ut=at.appear!==void 0?at.appear:it),{exit:lt,enter:it,appear:ut}},_e.updateStatus=function(at,lt){if(at===void 0&&(at=!1),lt!==null)if(this.cancelNextCallback(),lt===ENTERING){if(this.props.unmountOnExit||this.props.mountOnEnter){var it=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this);it&&forceReflow(it)}this.performEnter(at)}else this.performExit();else this.props.unmountOnExit&&this.state.status===EXITED&&this.setState({status:UNMOUNTED})},_e.performEnter=function(at){var lt=this,it=this.props.enter,ut=this.context?this.context.isMounting:at,s=this.props.nodeRef?[ut]:[ReactDOM.findDOMNode(this),ut],et=s[0],ot=s[1],st=this.getTimeouts(),Rt=ut?st.appear:st.enter;if(!at&&!it||config.disabled){this.safeSetState({status:ENTERED},function(){lt.props.onEntered(et)});return}this.props.onEnter(et,ot),this.safeSetState({status:ENTERING},function(){lt.props.onEntering(et,ot),lt.onTransitionEnd(Rt,function(){lt.safeSetState({status:ENTERED},function(){lt.props.onEntered(et,ot)})})})},_e.performExit=function(){var at=this,lt=this.props.exit,it=this.getTimeouts(),ut=this.props.nodeRef?void 0:ReactDOM.findDOMNode(this);if(!lt||config.disabled){this.safeSetState({status:EXITED},function(){at.props.onExited(ut)});return}this.props.onExit(ut),this.safeSetState({status:EXITING},function(){at.props.onExiting(ut),at.onTransitionEnd(it.exit,function(){at.safeSetState({status:EXITED},function(){at.props.onExited(ut)})})})},_e.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},_e.safeSetState=function(at,lt){lt=this.setNextCallback(lt),this.setState(at,lt)},_e.setNextCallback=function(at){var lt=this,it=!0;return this.nextCallback=function(ut){it&&(it=!1,lt.nextCallback=null,at(ut))},this.nextCallback.cancel=function(){it=!1},this.nextCallback},_e.onTransitionEnd=function(at,lt){this.setNextCallback(lt);var it=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this),ut=at==null&&!this.props.addEndListener;if(!it||ut){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var s=this.props.nodeRef?[this.nextCallback]:[it,this.nextCallback],et=s[0],ot=s[1];this.props.addEndListener(et,ot)}at!=null&&setTimeout(this.nextCallback,at)},_e.render=function(){var at=this.state.status;if(at===UNMOUNTED)return null;var lt=this.props,it=lt.children;lt.in,lt.mountOnEnter,lt.unmountOnExit,lt.appear,lt.enter,lt.exit,lt.timeout,lt.addEndListener,lt.onEnter,lt.onEntering,lt.onEntered,lt.onExit,lt.onExiting,lt.onExited,lt.nodeRef;var ut=_objectWithoutPropertiesLoose(lt,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React.createElement(TransitionGroupContext.Provider,{value:null},typeof it=="function"?it(at,ut):React.cloneElement(React.Children.only(it),ut))},o}(React.Component);Transition.contextType=TransitionGroupContext;Transition.propTypes={};function noop(){}Transition.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:noop,onEntering:noop,onEntered:noop,onExit:noop,onExiting:noop,onExited:noop};Transition.UNMOUNTED=UNMOUNTED;Transition.EXITED=EXITED;Transition.ENTERING=ENTERING;Transition.ENTERED=ENTERED;Transition.EXITING=EXITING;const Transition$1=Transition;function _assertThisInitialized(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function getChildMapping(a,o){var _e=function(lt){return o&&reactExports.isValidElement(lt)?o(lt):lt},tt=Object.create(null);return a&&reactExports.Children.map(a,function(at){return at}).forEach(function(at){tt[at.key]=_e(at)}),tt}function mergeChildMappings(a,o){a=a||{},o=o||{};function _e(ot){return ot in o?o[ot]:a[ot]}var tt=Object.create(null),at=[];for(var lt in a)lt in o?at.length&&(tt[lt]=at,at=[]):at.push(lt);var it,ut={};for(var s in o){if(tt[s])for(it=0;it<tt[s].length;it++){var et=tt[s][it];ut[tt[s][it]]=_e(et)}ut[s]=_e(s)}for(it=0;it<at.length;it++)ut[at[it]]=_e(at[it]);return ut}function getProp(a,o,_e){return _e[o]!=null?_e[o]:a.props[o]}function getInitialChildMapping(a,o){return getChildMapping(a.children,function(_e){return reactExports.cloneElement(_e,{onExited:o.bind(null,_e),in:!0,appear:getProp(_e,"appear",a),enter:getProp(_e,"enter",a),exit:getProp(_e,"exit",a)})})}function getNextChildMapping(a,o,_e){var tt=getChildMapping(a.children),at=mergeChildMappings(o,tt);return Object.keys(at).forEach(function(lt){var it=at[lt];if(reactExports.isValidElement(it)){var ut=lt in o,s=lt in tt,et=o[lt],ot=reactExports.isValidElement(et)&&!et.props.in;s&&(!ut||ot)?at[lt]=reactExports.cloneElement(it,{onExited:_e.bind(null,it),in:!0,exit:getProp(it,"exit",a),enter:getProp(it,"enter",a)}):!s&&ut&&!ot?at[lt]=reactExports.cloneElement(it,{in:!1}):s&&ut&&reactExports.isValidElement(et)&&(at[lt]=reactExports.cloneElement(it,{onExited:_e.bind(null,it),in:et.props.in,exit:getProp(it,"exit",a),enter:getProp(it,"enter",a)}))}}),at}var values=Object.values||function(a){return Object.keys(a).map(function(o){return a[o]})},defaultProps={component:"div",childFactory:function(o){return o}},TransitionGroup=function(a){_inheritsLoose(o,a);function o(tt,at){var lt;lt=a.call(this,tt,at)||this;var it=lt.handleExited.bind(_assertThisInitialized(lt));return lt.state={contextValue:{isMounting:!0},handleExited:it,firstRender:!0},lt}var _e=o.prototype;return _e.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},_e.componentWillUnmount=function(){this.mounted=!1},o.getDerivedStateFromProps=function(at,lt){var it=lt.children,ut=lt.handleExited,s=lt.firstRender;return{children:s?getInitialChildMapping(at,ut):getNextChildMapping(at,it,ut),firstRender:!1}},_e.handleExited=function(at,lt){var it=getChildMapping(this.props.children);at.key in it||(at.props.onExited&&at.props.onExited(lt),this.mounted&&this.setState(function(ut){var s=_extends({},ut.children);return delete s[at.key],{children:s}}))},_e.render=function(){var at=this.props,lt=at.component,it=at.childFactory,ut=_objectWithoutPropertiesLoose(at,["component","childFactory"]),s=this.state.contextValue,et=values(this.state.children).map(it);return delete ut.appear,delete ut.enter,delete ut.exit,lt===null?React.createElement(TransitionGroupContext.Provider,{value:s},et):React.createElement(TransitionGroupContext.Provider,{value:s},React.createElement(lt,ut,et))},o}(React.Component);TransitionGroup.propTypes={};TransitionGroup.defaultProps=defaultProps;const TransitionGroup$1=TransitionGroup;function Ripple(a){const{className:o,classes:_e,pulsate:tt=!1,rippleX:at,rippleY:lt,rippleSize:it,in:ut,onExited:s,timeout:et}=a,[ot,st]=reactExports.useState(!1),Rt=clsx(o,_e.ripple,_e.rippleVisible,tt&&_e.ripplePulsate),ht={width:it,height:it,top:-(it/2)+lt,left:-(it/2)+at},bt=clsx(_e.child,ot&&_e.childLeaving,tt&&_e.childPulsate);return!ut&&!ot&&st(!0),reactExports.useEffect(()=>{if(!ut&&s!=null){const ct=setTimeout(s,et);return()=>{clearTimeout(ct)}}},[s,ut,et]),jsxRuntimeExports.jsx("span",{className:Rt,style:ht,children:jsxRuntimeExports.jsx("span",{className:bt})})}const touchRippleClasses=generateUtilityClasses("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),touchRippleClasses$1=touchRippleClasses,_excluded$D=["center","classes","className"];let _$3=a=>a,_t$2,_t2$2,_t3$2,_t4$2;const DURATION=550,DELAY_RIPPLE=80,enterKeyframe=keyframes(_t$2||(_t$2=_$3`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),exitKeyframe=keyframes(_t2$2||(_t2$2=_$3`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),pulsateKeyframe=keyframes(_t3$2||(_t3$2=_$3`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),TouchRippleRoot=styled$1("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),TouchRippleRipple=styled$1(Ripple,{name:"MuiTouchRipple",slot:"Ripple"})(_t4$2||(_t4$2=_$3`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),touchRippleClasses$1.rippleVisible,enterKeyframe,DURATION,({theme:a})=>a.transitions.easing.easeInOut,touchRippleClasses$1.ripplePulsate,({theme:a})=>a.transitions.duration.shorter,touchRippleClasses$1.child,touchRippleClasses$1.childLeaving,exitKeyframe,DURATION,({theme:a})=>a.transitions.easing.easeInOut,touchRippleClasses$1.childPulsate,pulsateKeyframe,({theme:a})=>a.transitions.easing.easeInOut),TouchRipple=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiTouchRipple"}),{center:at=!1,classes:lt={},className:it}=tt,ut=_objectWithoutPropertiesLoose(tt,_excluded$D),[s,et]=reactExports.useState([]),ot=reactExports.useRef(0),st=reactExports.useRef(null);reactExports.useEffect(()=>{st.current&&(st.current(),st.current=null)},[s]);const Rt=reactExports.useRef(!1),ht=reactExports.useRef(null),bt=reactExports.useRef(null),ct=reactExports.useRef(null);reactExports.useEffect(()=>()=>{clearTimeout(ht.current)},[]);const mt=reactExports.useCallback(St=>{const{pulsate:It,rippleX:xt,rippleY:At,rippleSize:Dt,cb:wt}=St;et(Mt=>[...Mt,jsxRuntimeExports.jsx(TouchRippleRipple,{classes:{ripple:clsx(lt.ripple,touchRippleClasses$1.ripple),rippleVisible:clsx(lt.rippleVisible,touchRippleClasses$1.rippleVisible),ripplePulsate:clsx(lt.ripplePulsate,touchRippleClasses$1.ripplePulsate),child:clsx(lt.child,touchRippleClasses$1.child),childLeaving:clsx(lt.childLeaving,touchRippleClasses$1.childLeaving),childPulsate:clsx(lt.childPulsate,touchRippleClasses$1.childPulsate)},timeout:DURATION,pulsate:It,rippleX:xt,rippleY:At,rippleSize:Dt},ot.current)]),ot.current+=1,st.current=wt},[lt]),rt=reactExports.useCallback((St={},It={},xt=()=>{})=>{const{pulsate:At=!1,center:Dt=at||It.pulsate,fakeElement:wt=!1}=It;if((St==null?void 0:St.type)==="mousedown"&&Rt.current){Rt.current=!1;return}(St==null?void 0:St.type)==="touchstart"&&(Rt.current=!0);const Mt=wt?null:ct.current,vt=Mt?Mt.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ft,Ht,Wt;if(Dt||St===void 0||St.clientX===0&&St.clientY===0||!St.clientX&&!St.touches)Ft=Math.round(vt.width/2),Ht=Math.round(vt.height/2);else{const{clientX:tn,clientY:gn}=St.touches&&St.touches.length>0?St.touches[0]:St;Ft=Math.round(tn-vt.left),Ht=Math.round(gn-vt.top)}if(Dt)Wt=Math.sqrt((2*vt.width**2+vt.height**2)/3),Wt%2===0&&(Wt+=1);else{const tn=Math.max(Math.abs((Mt?Mt.clientWidth:0)-Ft),Ft)*2+2,gn=Math.max(Math.abs((Mt?Mt.clientHeight:0)-Ht),Ht)*2+2;Wt=Math.sqrt(tn**2+gn**2)}St!=null&&St.touches?bt.current===null&&(bt.current=()=>{mt({pulsate:At,rippleX:Ft,rippleY:Ht,rippleSize:Wt,cb:xt})},ht.current=setTimeout(()=>{bt.current&&(bt.current(),bt.current=null)},DELAY_RIPPLE)):mt({pulsate:At,rippleX:Ft,rippleY:Ht,rippleSize:Wt,cb:xt})},[at,mt]),pt=reactExports.useCallback(()=>{rt({},{pulsate:!0})},[rt]),ft=reactExports.useCallback((St,It)=>{if(clearTimeout(ht.current),(St==null?void 0:St.type)==="touchend"&&bt.current){bt.current(),bt.current=null,ht.current=setTimeout(()=>{ft(St,It)});return}bt.current=null,et(xt=>xt.length>0?xt.slice(1):xt),st.current=It},[]);return reactExports.useImperativeHandle(_e,()=>({pulsate:pt,start:rt,stop:ft}),[pt,rt,ft]),jsxRuntimeExports.jsx(TouchRippleRoot,_extends({className:clsx(touchRippleClasses$1.root,lt.root,it),ref:ct},ut,{children:jsxRuntimeExports.jsx(TransitionGroup$1,{component:null,exit:!0,children:s})}))}),TouchRipple$1=TouchRipple;function getButtonBaseUtilityClass(a){return generateUtilityClass("MuiButtonBase",a)}const buttonBaseClasses=generateUtilityClasses("MuiButtonBase",["root","disabled","focusVisible"]),buttonBaseClasses$1=buttonBaseClasses,_excluded$C=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],useUtilityClasses$v=a=>{const{disabled:o,focusVisible:_e,focusVisibleClassName:tt,classes:at}=a,it=composeClasses({root:["root",o&&"disabled",_e&&"focusVisible"]},getButtonBaseUtilityClass,at);return _e&&tt&&(it.root+=` ${tt}`),it},ButtonBaseRoot=styled$1("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(a,o)=>o.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${buttonBaseClasses$1.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),ButtonBase=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiButtonBase"}),{action:at,centerRipple:lt=!1,children:it,className:ut,component:s="button",disabled:et=!1,disableRipple:ot=!1,disableTouchRipple:st=!1,focusRipple:Rt=!1,LinkComponent:ht="a",onBlur:bt,onClick:ct,onContextMenu:mt,onDragLeave:rt,onFocus:pt,onFocusVisible:ft,onKeyDown:St,onKeyUp:It,onMouseDown:xt,onMouseLeave:At,onMouseUp:Dt,onTouchEnd:wt,onTouchMove:Mt,onTouchStart:vt,tabIndex:Ft=0,TouchRippleProps:Ht,touchRippleRef:Wt,type:tn}=tt,gn=_objectWithoutPropertiesLoose(tt,_excluded$C),nn=reactExports.useRef(null),qt=reactExports.useRef(null),fn=useForkRef(qt,Wt),{isFocusVisibleRef:Cn,onFocus:Tn,onBlur:un,ref:mn}=useIsFocusVisible(),[yn,pn]=reactExports.useState(!1);et&&yn&&pn(!1),reactExports.useImperativeHandle(at,()=>({focusVisible:()=>{pn(!0),nn.current.focus()}}),[]);const[In,kn]=reactExports.useState(!1);reactExports.useEffect(()=>{kn(!0)},[]);const Mn=In&&!ot&&!et;reactExports.useEffect(()=>{yn&&Rt&&!ot&&In&&qt.current.pulsate()},[ot,Rt,yn,In]);function xn(Gt,Tt,nt=st){return useEventCallback(Ct=>(Tt&&Tt(Ct),!nt&&qt.current&&qt.current[Gt](Ct),!0))}const Pn=xn("start",xt),On=xn("stop",mt),Dn=xn("stop",rt),Fn=xn("stop",Dt),dr=xn("stop",Gt=>{yn&&Gt.preventDefault(),At&&At(Gt)}),ir=xn("start",vt),Xn=xn("stop",wt),tr=xn("stop",Mt),cn=xn("stop",Gt=>{un(Gt),Cn.current===!1&&pn(!1),bt&&bt(Gt)},!1),Jn=useEventCallback(Gt=>{nn.current||(nn.current=Gt.currentTarget),Tn(Gt),Cn.current===!0&&(pn(!0),ft&&ft(Gt)),pt&&pt(Gt)}),Qn=()=>{const Gt=nn.current;return s&&s!=="button"&&!(Gt.tagName==="A"&&Gt.href)},sr=reactExports.useRef(!1),Bn=useEventCallback(Gt=>{Rt&&!sr.current&&yn&&qt.current&&Gt.key===" "&&(sr.current=!0,qt.current.stop(Gt,()=>{qt.current.start(Gt)})),Gt.target===Gt.currentTarget&&Qn()&&Gt.key===" "&&Gt.preventDefault(),St&&St(Gt),Gt.target===Gt.currentTarget&&Qn()&&Gt.key==="Enter"&&!et&&(Gt.preventDefault(),ct&&ct(Gt))}),rr=useEventCallback(Gt=>{Rt&&Gt.key===" "&&qt.current&&yn&&!Gt.defaultPrevented&&(sr.current=!1,qt.current.stop(Gt,()=>{qt.current.pulsate(Gt)})),It&&It(Gt),ct&&Gt.target===Gt.currentTarget&&Qn()&&Gt.key===" "&&!Gt.defaultPrevented&&ct(Gt)});let nr=s;nr==="button"&&(gn.href||gn.to)&&(nr=ht);const Nn={};nr==="button"?(Nn.type=tn===void 0?"button":tn,Nn.disabled=et):(!gn.href&&!gn.to&&(Nn.role="button"),et&&(Nn["aria-disabled"]=et));const Wn=useForkRef(_e,mn,nn),vn=_extends({},tt,{centerRipple:lt,component:s,disabled:et,disableRipple:ot,disableTouchRipple:st,focusRipple:Rt,tabIndex:Ft,focusVisible:yn}),Rn=useUtilityClasses$v(vn);return jsxRuntimeExports.jsxs(ButtonBaseRoot,_extends({as:nr,className:clsx(Rn.root,ut),ownerState:vn,onBlur:cn,onClick:ct,onContextMenu:On,onFocus:Jn,onKeyDown:Bn,onKeyUp:rr,onMouseDown:Pn,onMouseLeave:dr,onMouseUp:Fn,onDragLeave:Dn,onTouchEnd:Xn,onTouchMove:tr,onTouchStart:ir,ref:Wn,tabIndex:et?-1:Ft,type:tn},Nn,gn,{children:[it,Mn?jsxRuntimeExports.jsx(TouchRipple$1,_extends({ref:fn,center:lt},Ht)):null]}))}),ButtonBase$1=ButtonBase,dividerClasses=generateUtilityClasses("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),dividerClasses$1=dividerClasses,listItemIconClasses=generateUtilityClasses("MuiListItemIcon",["root","alignItemsFlexStart"]),listItemIconClasses$1=listItemIconClasses;function getTypographyUtilityClass(a){return generateUtilityClass("MuiTypography",a)}generateUtilityClasses("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const _excluded$B=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],useUtilityClasses$u=a=>{const{align:o,gutterBottom:_e,noWrap:tt,paragraph:at,variant:lt,classes:it}=a,ut={root:["root",lt,a.align!=="inherit"&&`align${capitalize(o)}`,_e&&"gutterBottom",tt&&"noWrap",at&&"paragraph"]};return composeClasses(ut,getTypographyUtilityClass,it)},TypographyRoot=styled$1("span",{name:"MuiTypography",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.variant&&o[_e.variant],_e.align!=="inherit"&&o[`align${capitalize(_e.align)}`],_e.noWrap&&o.noWrap,_e.gutterBottom&&o.gutterBottom,_e.paragraph&&o.paragraph]}})(({theme:a,ownerState:o})=>_extends({margin:0},o.variant&&a.typography[o.variant],o.align!=="inherit"&&{textAlign:o.align},o.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},o.gutterBottom&&{marginBottom:"0.35em"},o.paragraph&&{marginBottom:16})),defaultVariantMapping={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},colorTransformations$1={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},transformDeprecatedColors$1=a=>colorTransformations$1[a]||a,Typography=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiTypography"}),at=transformDeprecatedColors$1(tt.color),lt=extendSxProp(_extends({},tt,{color:at})),{align:it="inherit",className:ut,component:s,gutterBottom:et=!1,noWrap:ot=!1,paragraph:st=!1,variant:Rt="body1",variantMapping:ht=defaultVariantMapping}=lt,bt=_objectWithoutPropertiesLoose(lt,_excluded$B),ct=_extends({},lt,{align:it,color:at,className:ut,component:s,gutterBottom:et,noWrap:ot,paragraph:st,variant:Rt,variantMapping:ht}),mt=s||(st?"p":ht[Rt]||defaultVariantMapping[Rt])||"span",rt=useUtilityClasses$u(ct);return jsxRuntimeExports.jsx(TypographyRoot,_extends({as:mt,ref:_e,ownerState:ct,className:clsx(rt.root,ut)},bt))}),Typography$1=Typography,listItemTextClasses=generateUtilityClasses("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),listItemTextClasses$1=listItemTextClasses;function getMenuItemUtilityClass(a){return generateUtilityClass("MuiMenuItem",a)}const menuItemClasses=generateUtilityClasses("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),menuItemClasses$1=menuItemClasses,_excluded$A=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],overridesResolver=(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.dense&&o.dense,_e.divider&&o.divider,!_e.disableGutters&&o.gutters]},useUtilityClasses$t=a=>{const{disabled:o,dense:_e,divider:tt,disableGutters:at,selected:lt,classes:it}=a,s=composeClasses({root:["root",_e&&"dense",o&&"disabled",!at&&"gutters",tt&&"divider",lt&&"selected"]},getMenuItemUtilityClass,it);return _extends({},it,s)},MenuItemRoot=styled$1(ButtonBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver})(({theme:a,ownerState:o})=>_extends({},a.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!o.disableGutters&&{paddingLeft:16,paddingRight:16},o.divider&&{borderBottom:`1px solid ${(a.vars||a).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(a.vars||a).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${menuItemClasses$1.selected}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.selectedOpacity})`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity),[`&.${menuItemClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},[`&.${menuItemClasses$1.selected}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.selectedOpacity})`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity)}},[`&.${menuItemClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${menuItemClasses$1.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},[`& + .${dividerClasses$1.root}`]:{marginTop:a.spacing(1),marginBottom:a.spacing(1)},[`& + .${dividerClasses$1.inset}`]:{marginLeft:52},[`& .${listItemTextClasses$1.root}`]:{marginTop:0,marginBottom:0},[`& .${listItemTextClasses$1.inset}`]:{paddingLeft:36},[`& .${listItemIconClasses$1.root}`]:{minWidth:36}},!o.dense&&{[a.breakpoints.up("sm")]:{minHeight:"auto"}},o.dense&&_extends({minHeight:32,paddingTop:4,paddingBottom:4},a.typography.body2,{[`& .${listItemIconClasses$1.root} svg`]:{fontSize:"1.25rem"}}))),MenuItem=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiMenuItem"}),{autoFocus:at=!1,component:lt="li",dense:it=!1,divider:ut=!1,disableGutters:s=!1,focusVisibleClassName:et,role:ot="menuitem",tabIndex:st,className:Rt}=tt,ht=_objectWithoutPropertiesLoose(tt,_excluded$A),bt=reactExports.useContext(ListContext$1),ct=reactExports.useMemo(()=>({dense:it||bt.dense||!1,disableGutters:s}),[bt.dense,it,s]),mt=reactExports.useRef(null);useEnhancedEffect$1(()=>{at&&mt.current&&mt.current.focus()},[at]);const rt=_extends({},tt,{dense:ct.dense,divider:ut,disableGutters:s}),pt=useUtilityClasses$t(tt),ft=useForkRef(mt,_e);let St;return tt.disabled||(St=st!==void 0?st:-1),jsxRuntimeExports.jsx(ListContext$1.Provider,{value:ct,children:jsxRuntimeExports.jsx(MenuItemRoot,_extends({ref:ft,role:ot,tabIndex:St,component:lt,focusVisibleClassName:clsx(pt.focusVisible,et),className:clsx(pt.root,Rt)},ht,{ownerState:rt,classes:pt}))})}),MenuItem$1=MenuItem;function getListUtilityClass(a){return generateUtilityClass("MuiList",a)}generateUtilityClasses("MuiList",["root","padding","dense","subheader"]);const _excluded$z=["children","className","component","dense","disablePadding","subheader"],useUtilityClasses$s=a=>{const{classes:o,disablePadding:_e,dense:tt,subheader:at}=a;return composeClasses({root:["root",!_e&&"padding",tt&&"dense",at&&"subheader"]},getListUtilityClass,o)},ListRoot=styled$1("ul",{name:"MuiList",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,!_e.disablePadding&&o.padding,_e.dense&&o.dense,_e.subheader&&o.subheader]}})(({ownerState:a})=>_extends({listStyle:"none",margin:0,padding:0,position:"relative"},!a.disablePadding&&{paddingTop:8,paddingBottom:8},a.subheader&&{paddingTop:0})),List=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiList"}),{children:at,className:lt,component:it="ul",dense:ut=!1,disablePadding:s=!1,subheader:et}=tt,ot=_objectWithoutPropertiesLoose(tt,_excluded$z),st=reactExports.useMemo(()=>({dense:ut}),[ut]),Rt=_extends({},tt,{component:it,dense:ut,disablePadding:s}),ht=useUtilityClasses$s(Rt);return jsxRuntimeExports.jsx(ListContext$1.Provider,{value:st,children:jsxRuntimeExports.jsxs(ListRoot,_extends({as:it,className:clsx(ht.root,lt),ref:_e,ownerState:Rt},ot,{children:[et,at]}))})}),List$1=List,_excluded$y=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function nextItem(a,o,_e){return a===o?a.firstChild:o&&o.nextElementSibling?o.nextElementSibling:_e?null:a.firstChild}function previousItem(a,o,_e){return a===o?_e?a.firstChild:a.lastChild:o&&o.previousElementSibling?o.previousElementSibling:_e?null:a.lastChild}function textCriteriaMatches(a,o){if(o===void 0)return!0;let _e=a.innerText;return _e===void 0&&(_e=a.textContent),_e=_e.trim().toLowerCase(),_e.length===0?!1:o.repeating?_e[0]===o.keys[0]:_e.indexOf(o.keys.join(""))===0}function moveFocus(a,o,_e,tt,at,lt){let it=!1,ut=at(a,o,o?_e:!1);for(;ut;){if(ut===a.firstChild){if(it)return!1;it=!0}const s=tt?!1:ut.disabled||ut.getAttribute("aria-disabled")==="true";if(!ut.hasAttribute("tabindex")||!textCriteriaMatches(ut,lt)||s)ut=at(a,ut,_e);else return ut.focus(),!0}return!1}const MenuList=reactExports.forwardRef(function(o,_e){const{actions:tt,autoFocus:at=!1,autoFocusItem:lt=!1,children:it,className:ut,disabledItemsFocusable:s=!1,disableListWrap:et=!1,onKeyDown:ot,variant:st="selectedMenu"}=o,Rt=_objectWithoutPropertiesLoose(o,_excluded$y),ht=reactExports.useRef(null),bt=reactExports.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});useEnhancedEffect$1(()=>{at&&ht.current.focus()},[at]),reactExports.useImperativeHandle(tt,()=>({adjustStyleForScrollbar:(ft,St)=>{const It=!ht.current.style.width;if(ft.clientHeight<ht.current.clientHeight&&It){const xt=`${getScrollbarSize(ownerDocument(ft))}px`;ht.current.style[St.direction==="rtl"?"paddingLeft":"paddingRight"]=xt,ht.current.style.width=`calc(100% + ${xt})`}return ht.current}}),[]);const ct=ft=>{const St=ht.current,It=ft.key,xt=ownerDocument(St).activeElement;if(It==="ArrowDown")ft.preventDefault(),moveFocus(St,xt,et,s,nextItem);else if(It==="ArrowUp")ft.preventDefault(),moveFocus(St,xt,et,s,previousItem);else if(It==="Home")ft.preventDefault(),moveFocus(St,null,et,s,nextItem);else if(It==="End")ft.preventDefault(),moveFocus(St,null,et,s,previousItem);else if(It.length===1){const At=bt.current,Dt=It.toLowerCase(),wt=performance.now();At.keys.length>0&&(wt-At.lastTime>500?(At.keys=[],At.repeating=!0,At.previousKeyMatched=!0):At.repeating&&Dt!==At.keys[0]&&(At.repeating=!1)),At.lastTime=wt,At.keys.push(Dt);const Mt=xt&&!At.repeating&&textCriteriaMatches(xt,At);At.previousKeyMatched&&(Mt||moveFocus(St,xt,!1,s,nextItem,At))?ft.preventDefault():At.previousKeyMatched=!1}ot&&ot(ft)},mt=useForkRef(ht,_e);let rt=-1;reactExports.Children.forEach(it,(ft,St)=>{reactExports.isValidElement(ft)&&(ft.props.disabled||(st==="selectedMenu"&&ft.props.selected||rt===-1)&&(rt=St),rt===St&&(ft.props.disabled||ft.props.muiSkipListHighlight||ft.type.muiSkipListHighlight)&&(rt+=1,rt>=it.length&&(rt=-1)))});const pt=reactExports.Children.map(it,(ft,St)=>{if(St===rt){const It={};return lt&&(It.autoFocus=!0),ft.props.tabIndex===void 0&&st==="selectedMenu"&&(It.tabIndex=0),reactExports.cloneElement(ft,It)}return ft});return jsxRuntimeExports.jsx(List$1,_extends({role:"menu",ref:mt,className:ut,onKeyDown:ct,tabIndex:at?0:-1},Rt,{children:pt}))}),MenuList$1=MenuList,getOverlayAlpha=a=>{let o;return a<1?o=5.11916*a**2:o=4.5*Math.log(a+1)+2,(o/100).toFixed(2)},getOverlayAlpha$1=getOverlayAlpha;function getPaperUtilityClass(a){return generateUtilityClass("MuiPaper",a)}generateUtilityClasses("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const _excluded$x=["className","component","elevation","square","variant"],useUtilityClasses$r=a=>{const{square:o,elevation:_e,variant:tt,classes:at}=a,lt={root:["root",tt,!o&&"rounded",tt==="elevation"&&`elevation${_e}`]};return composeClasses(lt,getPaperUtilityClass,at)},PaperRoot=styled$1("div",{name:"MuiPaper",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],!_e.square&&o.rounded,_e.variant==="elevation"&&o[`elevation${_e.elevation}`]]}})(({theme:a,ownerState:o})=>{var _e;return _extends({backgroundColor:(a.vars||a).palette.background.paper,color:(a.vars||a).palette.text.primary,transition:a.transitions.create("box-shadow")},!o.square&&{borderRadius:a.shape.borderRadius},o.variant==="outlined"&&{border:`1px solid ${(a.vars||a).palette.divider}`},o.variant==="elevation"&&_extends({boxShadow:(a.vars||a).shadows[o.elevation]},!a.vars&&a.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${alpha("#fff",getOverlayAlpha$1(o.elevation))}, ${alpha("#fff",getOverlayAlpha$1(o.elevation))})`},a.vars&&{backgroundImage:(_e=a.vars.overlays)==null?void 0:_e[o.elevation]}))}),Paper=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiPaper"}),{className:at,component:lt="div",elevation:it=1,square:ut=!1,variant:s="elevation"}=tt,et=_objectWithoutPropertiesLoose(tt,_excluded$x),ot=_extends({},tt,{component:lt,elevation:it,square:ut,variant:s}),st=useUtilityClasses$r(ot);return jsxRuntimeExports.jsx(PaperRoot,_extends({as:lt,ownerState:ot,className:clsx(st.root,at),ref:_e},et))}),Paper$1=Paper,reflow=a=>a.scrollTop;function getTransitionProps(a,o){var _e,tt;const{timeout:at,easing:lt,style:it={}}=a;return{duration:(_e=it.transitionDuration)!=null?_e:typeof at=="number"?at:at[o.mode]||0,easing:(tt=it.transitionTimingFunction)!=null?tt:typeof lt=="object"?lt[o.mode]:lt,delay:it.transitionDelay}}const _excluded$w=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function getScale(a){return`scale(${a}, ${a**2})`}const styles$1={entering:{opacity:1,transform:getScale(1)},entered:{opacity:1,transform:"none"}},isWebKit154=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Grow=reactExports.forwardRef(function(o,_e){const{addEndListener:tt,appear:at=!0,children:lt,easing:it,in:ut,onEnter:s,onEntered:et,onEntering:ot,onExit:st,onExited:Rt,onExiting:ht,style:bt,timeout:ct="auto",TransitionComponent:mt=Transition$1}=o,rt=_objectWithoutPropertiesLoose(o,_excluded$w),pt=reactExports.useRef(),ft=reactExports.useRef(),St=useTheme(),It=reactExports.useRef(null),xt=useForkRef(It,lt.ref,_e),At=tn=>gn=>{if(tn){const nn=It.current;gn===void 0?tn(nn):tn(nn,gn)}},Dt=At(ot),wt=At((tn,gn)=>{reflow(tn);const{duration:nn,delay:qt,easing:fn}=getTransitionProps({style:bt,timeout:ct,easing:it},{mode:"enter"});let Cn;ct==="auto"?(Cn=St.transitions.getAutoHeightDuration(tn.clientHeight),ft.current=Cn):Cn=nn,tn.style.transition=[St.transitions.create("opacity",{duration:Cn,delay:qt}),St.transitions.create("transform",{duration:isWebKit154?Cn:Cn*.666,delay:qt,easing:fn})].join(","),s&&s(tn,gn)}),Mt=At(et),vt=At(ht),Ft=At(tn=>{const{duration:gn,delay:nn,easing:qt}=getTransitionProps({style:bt,timeout:ct,easing:it},{mode:"exit"});let fn;ct==="auto"?(fn=St.transitions.getAutoHeightDuration(tn.clientHeight),ft.current=fn):fn=gn,tn.style.transition=[St.transitions.create("opacity",{duration:fn,delay:nn}),St.transitions.create("transform",{duration:isWebKit154?fn:fn*.666,delay:isWebKit154?nn:nn||fn*.333,easing:qt})].join(","),tn.style.opacity=0,tn.style.transform=getScale(.75),st&&st(tn)}),Ht=At(Rt),Wt=tn=>{ct==="auto"&&(pt.current=setTimeout(tn,ft.current||0)),tt&&tt(It.current,tn)};return reactExports.useEffect(()=>()=>{clearTimeout(pt.current)},[]),jsxRuntimeExports.jsx(mt,_extends({appear:at,in:ut,nodeRef:It,onEnter:wt,onEntered:Mt,onEntering:Dt,onExit:Ft,onExited:Ht,onExiting:vt,addEndListener:Wt,timeout:ct==="auto"?null:ct},rt,{children:(tn,gn)=>reactExports.cloneElement(lt,_extends({style:_extends({opacity:0,transform:getScale(.75),visibility:tn==="exited"&&!ut?"hidden":void 0},styles$1[tn],bt,lt.props.style),ref:xt},gn))}))});Grow.muiSupportAuto=!0;const Grow$1=Grow,_excluded$v=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],styles={entering:{opacity:1},entered:{opacity:1}},Fade=reactExports.forwardRef(function(o,_e){const tt=useTheme(),at={enter:tt.transitions.duration.enteringScreen,exit:tt.transitions.duration.leavingScreen},{addEndListener:lt,appear:it=!0,children:ut,easing:s,in:et,onEnter:ot,onEntered:st,onEntering:Rt,onExit:ht,onExited:bt,onExiting:ct,style:mt,timeout:rt=at,TransitionComponent:pt=Transition$1}=o,ft=_objectWithoutPropertiesLoose(o,_excluded$v),St=reactExports.useRef(null),It=useForkRef(St,ut.ref,_e),xt=Wt=>tn=>{if(Wt){const gn=St.current;tn===void 0?Wt(gn):Wt(gn,tn)}},At=xt(Rt),Dt=xt((Wt,tn)=>{reflow(Wt);const gn=getTransitionProps({style:mt,timeout:rt,easing:s},{mode:"enter"});Wt.style.webkitTransition=tt.transitions.create("opacity",gn),Wt.style.transition=tt.transitions.create("opacity",gn),ot&&ot(Wt,tn)}),wt=xt(st),Mt=xt(ct),vt=xt(Wt=>{const tn=getTransitionProps({style:mt,timeout:rt,easing:s},{mode:"exit"});Wt.style.webkitTransition=tt.transitions.create("opacity",tn),Wt.style.transition=tt.transitions.create("opacity",tn),ht&&ht(Wt)}),Ft=xt(bt),Ht=Wt=>{lt&&lt(St.current,Wt)};return jsxRuntimeExports.jsx(pt,_extends({appear:it,in:et,nodeRef:St,onEnter:Dt,onEntered:wt,onEntering:At,onExit:vt,onExited:Ft,onExiting:Mt,addEndListener:Ht,timeout:rt},ft,{children:(Wt,tn)=>reactExports.cloneElement(ut,_extends({style:_extends({opacity:0,visibility:Wt==="exited"&&!et?"hidden":void 0},styles[Wt],mt,ut.props.style),ref:It},tn))}))}),Fade$1=Fade;function getBackdropUtilityClass(a){return generateUtilityClass("MuiBackdrop",a)}generateUtilityClasses("MuiBackdrop",["root","invisible"]);const _excluded$u=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],useUtilityClasses$q=a=>{const{classes:o,invisible:_e}=a;return composeClasses({root:["root",_e&&"invisible"]},getBackdropUtilityClass,o)},BackdropRoot=styled$1("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.invisible&&o.invisible]}})(({ownerState:a})=>_extends({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},a.invisible&&{backgroundColor:"transparent"})),Backdrop=reactExports.forwardRef(function(o,_e){var tt,at,lt;const it=useThemeProps({props:o,name:"MuiBackdrop"}),{children:ut,className:s,component:et="div",components:ot={},componentsProps:st={},invisible:Rt=!1,open:ht,slotProps:bt={},slots:ct={},TransitionComponent:mt=Fade$1,transitionDuration:rt}=it,pt=_objectWithoutPropertiesLoose(it,_excluded$u),ft=_extends({},it,{component:et,invisible:Rt}),St=useUtilityClasses$q(ft),It=(tt=bt.root)!=null?tt:st.root;return jsxRuntimeExports.jsx(mt,_extends({in:ht,timeout:rt},pt,{children:jsxRuntimeExports.jsx(BackdropRoot,_extends({"aria-hidden":!0},It,{as:(at=(lt=ct.root)!=null?lt:ot.Root)!=null?at:et,className:clsx(St.root,s,It==null?void 0:It.className),ownerState:_extends({},ft,It==null?void 0:It.ownerState),classes:St,ref:_e,children:ut}))}))}),Backdrop$1=Backdrop,_excluded$t=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","open","slotProps","slots","theme"],ModalRoot=styled$1("div",{name:"MuiModal",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,!_e.open&&_e.exited&&o.hidden]}})(({theme:a,ownerState:o})=>_extends({position:"fixed",zIndex:(a.vars||a).zIndex.modal,right:0,bottom:0,top:0,left:0},!o.open&&o.exited&&{visibility:"hidden"})),ModalBackdrop=styled$1(Backdrop$1,{name:"MuiModal",slot:"Backdrop",overridesResolver:(a,o)=>o.backdrop})({zIndex:-1}),Modal=reactExports.forwardRef(function(o,_e){var tt,at,lt,it,ut,s;const et=useThemeProps({name:"MuiModal",props:o}),{BackdropComponent:ot=ModalBackdrop,BackdropProps:st,classes:Rt,className:ht,closeAfterTransition:bt=!1,children:ct,container:mt,component:rt,components:pt={},componentsProps:ft={},disableAutoFocus:St=!1,disableEnforceFocus:It=!1,disableEscapeKeyDown:xt=!1,disablePortal:At=!1,disableRestoreFocus:Dt=!1,disableScrollLock:wt=!1,hideBackdrop:Mt=!1,keepMounted:vt=!1,onBackdropClick:Ft,onClose:Ht,open:Wt,slotProps:tn,slots:gn,theme:nn}=et,qt=_objectWithoutPropertiesLoose(et,_excluded$t),[fn,Cn]=reactExports.useState(!0),Tn={container:mt,closeAfterTransition:bt,disableAutoFocus:St,disableEnforceFocus:It,disableEscapeKeyDown:xt,disablePortal:At,disableRestoreFocus:Dt,disableScrollLock:wt,hideBackdrop:Mt,keepMounted:vt,onBackdropClick:Ft,onClose:Ht,open:Wt},un=_extends({},et,Tn,{exited:fn}),mn=(tt=(at=gn==null?void 0:gn.root)!=null?at:pt.Root)!=null?tt:ModalRoot,yn=(lt=(it=gn==null?void 0:gn.backdrop)!=null?it:pt.Backdrop)!=null?lt:ot,pn=(ut=tn==null?void 0:tn.root)!=null?ut:ft.root,In=(s=tn==null?void 0:tn.backdrop)!=null?s:ft.backdrop;return jsxRuntimeExports.jsx(ModalUnstyled,_extends({slots:{root:mn,backdrop:yn},slotProps:{root:()=>_extends({},resolveComponentProps(pn,un),!isHostComponent(mn)&&{as:rt,theme:nn},{className:clsx(ht,pn==null?void 0:pn.className,Rt==null?void 0:Rt.root,!un.open&&un.exited&&(Rt==null?void 0:Rt.hidden))}),backdrop:()=>_extends({},st,resolveComponentProps(In,un),{className:clsx(In==null?void 0:In.className,Rt==null?void 0:Rt.backdrop)})},onTransitionEnter:()=>Cn(!1),onTransitionExited:()=>Cn(!0),ref:_e},qt,Tn,{children:ct}))}),Modal$1=Modal;function getPopoverUtilityClass(a){return generateUtilityClass("MuiPopover",a)}generateUtilityClasses("MuiPopover",["root","paper"]);const _excluded$s=["onEntering"],_excluded2$1=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"];function getOffsetTop(a,o){let _e=0;return typeof o=="number"?_e=o:o==="center"?_e=a.height/2:o==="bottom"&&(_e=a.height),_e}function getOffsetLeft(a,o){let _e=0;return typeof o=="number"?_e=o:o==="center"?_e=a.width/2:o==="right"&&(_e=a.width),_e}function getTransformOriginValue(a){return[a.horizontal,a.vertical].map(o=>typeof o=="number"?`${o}px`:o).join(" ")}function resolveAnchorEl(a){return typeof a=="function"?a():a}const useUtilityClasses$p=a=>{const{classes:o}=a;return composeClasses({root:["root"],paper:["paper"]},getPopoverUtilityClass,o)},PopoverRoot=styled$1(Modal$1,{name:"MuiPopover",slot:"Root",overridesResolver:(a,o)=>o.root})({}),PopoverPaper=styled$1(Paper$1,{name:"MuiPopover",slot:"Paper",overridesResolver:(a,o)=>o.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Popover=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiPopover"}),{action:at,anchorEl:lt,anchorOrigin:it={vertical:"top",horizontal:"left"},anchorPosition:ut,anchorReference:s="anchorEl",children:et,className:ot,container:st,elevation:Rt=8,marginThreshold:ht=16,open:bt,PaperProps:ct={},transformOrigin:mt={vertical:"top",horizontal:"left"},TransitionComponent:rt=Grow$1,transitionDuration:pt="auto",TransitionProps:{onEntering:ft}={}}=tt,St=_objectWithoutPropertiesLoose(tt.TransitionProps,_excluded$s),It=_objectWithoutPropertiesLoose(tt,_excluded2$1),xt=reactExports.useRef(),At=useForkRef(xt,ct.ref),Dt=_extends({},tt,{anchorOrigin:it,anchorReference:s,elevation:Rt,marginThreshold:ht,PaperProps:ct,transformOrigin:mt,TransitionComponent:rt,transitionDuration:pt,TransitionProps:St}),wt=useUtilityClasses$p(Dt),Mt=reactExports.useCallback(()=>{if(s==="anchorPosition")return ut;const Cn=resolveAnchorEl(lt),un=(Cn&&Cn.nodeType===1?Cn:ownerDocument(xt.current).body).getBoundingClientRect();return{top:un.top+getOffsetTop(un,it.vertical),left:un.left+getOffsetLeft(un,it.horizontal)}},[lt,it.horizontal,it.vertical,ut,s]),vt=reactExports.useCallback(Cn=>({vertical:getOffsetTop(Cn,mt.vertical),horizontal:getOffsetLeft(Cn,mt.horizontal)}),[mt.horizontal,mt.vertical]),Ft=reactExports.useCallback(Cn=>{const Tn={width:Cn.offsetWidth,height:Cn.offsetHeight},un=vt(Tn);if(s==="none")return{top:null,left:null,transformOrigin:getTransformOriginValue(un)};const mn=Mt();let yn=mn.top-un.vertical,pn=mn.left-un.horizontal;const In=yn+Tn.height,kn=pn+Tn.width,Mn=ownerWindow(resolveAnchorEl(lt)),xn=Mn.innerHeight-ht,Pn=Mn.innerWidth-ht;if(yn<ht){const On=yn-ht;yn-=On,un.vertical+=On}else if(In>xn){const On=In-xn;yn-=On,un.vertical+=On}if(pn<ht){const On=pn-ht;pn-=On,un.horizontal+=On}else if(kn>Pn){const On=kn-Pn;pn-=On,un.horizontal+=On}return{top:`${Math.round(yn)}px`,left:`${Math.round(pn)}px`,transformOrigin:getTransformOriginValue(un)}},[lt,s,Mt,vt,ht]),[Ht,Wt]=reactExports.useState(bt),tn=reactExports.useCallback(()=>{const Cn=xt.current;if(!Cn)return;const Tn=Ft(Cn);Tn.top!==null&&(Cn.style.top=Tn.top),Tn.left!==null&&(Cn.style.left=Tn.left),Cn.style.transformOrigin=Tn.transformOrigin,Wt(!0)},[Ft]),gn=(Cn,Tn)=>{ft&&ft(Cn,Tn),tn()},nn=()=>{Wt(!1)};reactExports.useEffect(()=>{bt&&tn()}),reactExports.useImperativeHandle(at,()=>bt?{updatePosition:()=>{tn()}}:null,[bt,tn]),reactExports.useEffect(()=>{if(!bt)return;const Cn=debounce$1(()=>{tn()}),Tn=ownerWindow(lt);return Tn.addEventListener("resize",Cn),()=>{Cn.clear(),Tn.removeEventListener("resize",Cn)}},[lt,bt,tn]);let qt=pt;pt==="auto"&&!rt.muiSupportAuto&&(qt=void 0);const fn=st||(lt?ownerDocument(resolveAnchorEl(lt)).body:void 0);return jsxRuntimeExports.jsx(PopoverRoot,_extends({BackdropProps:{invisible:!0},className:clsx(wt.root,ot),container:fn,open:bt,ref:_e,ownerState:Dt},It,{children:jsxRuntimeExports.jsx(rt,_extends({appear:!0,in:bt,onEntering:gn,onExited:nn,timeout:qt},St,{children:jsxRuntimeExports.jsx(PopoverPaper,_extends({elevation:Rt},ct,{ref:At,className:clsx(wt.paper,ct.className)},Ht?void 0:{style:_extends({},ct.style,{opacity:0})},{ownerState:Dt,children:et}))}))}))}),Popover$1=Popover;function getMenuUtilityClass(a){return generateUtilityClass("MuiMenu",a)}generateUtilityClasses("MuiMenu",["root","paper","list"]);const _excluded$r=["onEntering"],_excluded2=["autoFocus","children","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant"],RTL_ORIGIN={vertical:"top",horizontal:"right"},LTR_ORIGIN={vertical:"top",horizontal:"left"},useUtilityClasses$o=a=>{const{classes:o}=a;return composeClasses({root:["root"],paper:["paper"],list:["list"]},getMenuUtilityClass,o)},MenuRoot=styled$1(Popover$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(a,o)=>o.root})({}),MenuPaper=styled$1(Paper$1,{name:"MuiMenu",slot:"Paper",overridesResolver:(a,o)=>o.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),MenuMenuList=styled$1(MenuList$1,{name:"MuiMenu",slot:"List",overridesResolver:(a,o)=>o.list})({outline:0}),Menu=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiMenu"}),{autoFocus:at=!0,children:lt,disableAutoFocusItem:it=!1,MenuListProps:ut={},onClose:s,open:et,PaperProps:ot={},PopoverClasses:st,transitionDuration:Rt="auto",TransitionProps:{onEntering:ht}={},variant:bt="selectedMenu"}=tt,ct=_objectWithoutPropertiesLoose(tt.TransitionProps,_excluded$r),mt=_objectWithoutPropertiesLoose(tt,_excluded2),rt=useTheme(),pt=rt.direction==="rtl",ft=_extends({},tt,{autoFocus:at,disableAutoFocusItem:it,MenuListProps:ut,onEntering:ht,PaperProps:ot,transitionDuration:Rt,TransitionProps:ct,variant:bt}),St=useUtilityClasses$o(ft),It=at&&!it&&et,xt=reactExports.useRef(null),At=(Mt,vt)=>{xt.current&&xt.current.adjustStyleForScrollbar(Mt,rt),ht&&ht(Mt,vt)},Dt=Mt=>{Mt.key==="Tab"&&(Mt.preventDefault(),s&&s(Mt,"tabKeyDown"))};let wt=-1;return reactExports.Children.map(lt,(Mt,vt)=>{reactExports.isValidElement(Mt)&&(Mt.props.disabled||(bt==="selectedMenu"&&Mt.props.selected||wt===-1)&&(wt=vt))}),jsxRuntimeExports.jsx(MenuRoot,_extends({onClose:s,anchorOrigin:{vertical:"bottom",horizontal:pt?"right":"left"},transformOrigin:pt?RTL_ORIGIN:LTR_ORIGIN,PaperProps:_extends({as:MenuPaper},ot,{classes:_extends({},ot.classes,{root:St.paper})}),className:St.root,open:et,ref:_e,transitionDuration:Rt,TransitionProps:_extends({onEntering:At},ct),ownerState:ft},mt,{classes:st,children:jsxRuntimeExports.jsx(MenuMenuList,_extends({onKeyDown:Dt,actions:xt,autoFocus:at&&(wt===-1||it),autoFocusItem:It,variant:bt},ut,{className:clsx(St.list,ut.className),children:lt}))}))}),Menu$1=Menu;function getNativeSelectUtilityClasses(a){return generateUtilityClass("MuiNativeSelect",a)}const nativeSelectClasses=generateUtilityClasses("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),nativeSelectClasses$1=nativeSelectClasses,_excluded$q=["className","disabled","error","IconComponent","inputRef","variant"],useUtilityClasses$n=a=>{const{classes:o,variant:_e,disabled:tt,multiple:at,open:lt,error:it}=a,ut={select:["select",_e,tt&&"disabled",at&&"multiple",it&&"error"],icon:["icon",`icon${capitalize(_e)}`,lt&&"iconOpen",tt&&"disabled"]};return composeClasses(ut,getNativeSelectUtilityClasses,o)},nativeSelectSelectStyles=({ownerState:a,theme:o})=>_extends({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":_extends({},o.vars?{backgroundColor:`rgba(${o.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:o.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${nativeSelectClasses$1.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(o.vars||o).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},a.variant==="filled"&&{"&&&":{paddingRight:32}},a.variant==="outlined"&&{borderRadius:(o.vars||o).shape.borderRadius,"&:focus":{borderRadius:(o.vars||o).shape.borderRadius},"&&&":{paddingRight:32}}),NativeSelectSelect=styled$1("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:rootShouldForwardProp,overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.select,o[_e.variant],_e.error&&o.error,{[`&.${nativeSelectClasses$1.multiple}`]:o.multiple}]}})(nativeSelectSelectStyles),nativeSelectIconStyles=({ownerState:a,theme:o})=>_extends({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(o.vars||o).palette.action.active,[`&.${nativeSelectClasses$1.disabled}`]:{color:(o.vars||o).palette.action.disabled}},a.open&&{transform:"rotate(180deg)"},a.variant==="filled"&&{right:7},a.variant==="outlined"&&{right:7}),NativeSelectIcon=styled$1("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.icon,_e.variant&&o[`icon${capitalize(_e.variant)}`],_e.open&&o.iconOpen]}})(nativeSelectIconStyles),NativeSelectInput=reactExports.forwardRef(function(o,_e){const{className:tt,disabled:at,error:lt,IconComponent:it,inputRef:ut,variant:s="standard"}=o,et=_objectWithoutPropertiesLoose(o,_excluded$q),ot=_extends({},o,{disabled:at,variant:s,error:lt}),st=useUtilityClasses$n(ot);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(NativeSelectSelect,_extends({ownerState:ot,className:clsx(st.select,tt),disabled:at,ref:ut||_e},et)),o.multiple?null:jsxRuntimeExports.jsx(NativeSelectIcon,{as:it,ownerState:ot,className:st.icon})]})}),NativeSelectInput$1=NativeSelectInput;function hasValue(a){return a!=null&&!(Array.isArray(a)&&a.length===0)}function isFilled(a,o=!1){return a&&(hasValue(a.value)&&a.value!==""||o&&hasValue(a.defaultValue)&&a.defaultValue!=="")}function getSelectUtilityClasses(a){return generateUtilityClass("MuiSelect",a)}const selectClasses=generateUtilityClasses("MuiSelect",["select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),selectClasses$1=selectClasses;var _span$1;const _excluded$p=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],SelectSelect=styled$1("div",{name:"MuiSelect",slot:"Select",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[{[`&.${selectClasses$1.select}`]:o.select},{[`&.${selectClasses$1.select}`]:o[_e.variant]},{[`&.${selectClasses$1.error}`]:o.error},{[`&.${selectClasses$1.multiple}`]:o.multiple}]}})(nativeSelectSelectStyles,{[`&.${selectClasses$1.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),SelectIcon=styled$1("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.icon,_e.variant&&o[`icon${capitalize(_e.variant)}`],_e.open&&o.iconOpen]}})(nativeSelectIconStyles),SelectNativeInput=styled$1("input",{shouldForwardProp:a=>slotShouldForwardProp(a)&&a!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(a,o)=>o.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function areEqualValues(a,o){return typeof o=="object"&&o!==null?a===o:String(a)===String(o)}function isEmpty(a){return a==null||typeof a=="string"&&!a.trim()}const useUtilityClasses$m=a=>{const{classes:o,variant:_e,disabled:tt,multiple:at,open:lt,error:it}=a,ut={select:["select",_e,tt&&"disabled",at&&"multiple",it&&"error"],icon:["icon",`icon${capitalize(_e)}`,lt&&"iconOpen",tt&&"disabled"],nativeInput:["nativeInput"]};return composeClasses(ut,getSelectUtilityClasses,o)},SelectInput=reactExports.forwardRef(function(o,_e){const{"aria-describedby":tt,"aria-label":at,autoFocus:lt,autoWidth:it,children:ut,className:s,defaultOpen:et,defaultValue:ot,disabled:st,displayEmpty:Rt,error:ht=!1,IconComponent:bt,inputRef:ct,labelId:mt,MenuProps:rt={},multiple:pt,name:ft,onBlur:St,onChange:It,onClose:xt,onFocus:At,onOpen:Dt,open:wt,readOnly:Mt,renderValue:vt,SelectDisplayProps:Ft={},tabIndex:Ht,value:Wt,variant:tn="standard"}=o,gn=_objectWithoutPropertiesLoose(o,_excluded$p),[nn,qt]=useControlled({controlled:Wt,default:ot,name:"Select"}),[fn,Cn]=useControlled({controlled:wt,default:et,name:"Select"}),Tn=reactExports.useRef(null),un=reactExports.useRef(null),[mn,yn]=reactExports.useState(null),{current:pn}=reactExports.useRef(wt!=null),[In,kn]=reactExports.useState(),Mn=useForkRef(_e,ct),xn=reactExports.useCallback(Tt=>{un.current=Tt,Tt&&yn(Tt)},[]),Pn=mn==null?void 0:mn.parentNode;reactExports.useImperativeHandle(Mn,()=>({focus:()=>{un.current.focus()},node:Tn.current,value:nn}),[nn]),reactExports.useEffect(()=>{et&&fn&&mn&&!pn&&(kn(it?null:Pn.clientWidth),un.current.focus())},[mn,it]),reactExports.useEffect(()=>{lt&&un.current.focus()},[lt]),reactExports.useEffect(()=>{if(!mt)return;const Tt=ownerDocument(un.current).getElementById(mt);if(Tt){const nt=()=>{getSelection().isCollapsed&&un.current.focus()};return Tt.addEventListener("click",nt),()=>{Tt.removeEventListener("click",nt)}}},[mt]);const On=(Tt,nt)=>{Tt?Dt&&Dt(nt):xt&&xt(nt),pn||(kn(it?null:Pn.clientWidth),Cn(Tt))},Dn=Tt=>{Tt.button===0&&(Tt.preventDefault(),un.current.focus(),On(!0,Tt))},Fn=Tt=>{On(!1,Tt)},dr=reactExports.Children.toArray(ut),ir=Tt=>{const nt=dr.map(yt=>yt.props.value).indexOf(Tt.target.value);if(nt===-1)return;const Ct=dr[nt];qt(Ct.props.value),It&&It(Tt,Ct)},Xn=Tt=>nt=>{let Ct;if(nt.currentTarget.hasAttribute("tabindex")){if(pt){Ct=Array.isArray(nn)?nn.slice():[];const yt=nn.indexOf(Tt.props.value);yt===-1?Ct.push(Tt.props.value):Ct.splice(yt,1)}else Ct=Tt.props.value;if(Tt.props.onClick&&Tt.props.onClick(nt),nn!==Ct&&(qt(Ct),It)){const yt=nt.nativeEvent||nt,Pt=new yt.constructor(yt.type,yt);Object.defineProperty(Pt,"target",{writable:!0,value:{value:Ct,name:ft}}),It(Pt,Tt)}pt||On(!1,nt)}},tr=Tt=>{Mt||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Tt.key)!==-1&&(Tt.preventDefault(),On(!0,Tt))},cn=mn!==null&&fn,Jn=Tt=>{!cn&&St&&(Object.defineProperty(Tt,"target",{writable:!0,value:{value:nn,name:ft}}),St(Tt))};delete gn["aria-invalid"];let Qn,sr;const Bn=[];let rr=!1;(isFilled({value:nn})||Rt)&&(vt?Qn=vt(nn):rr=!0);const nr=dr.map(Tt=>{if(!reactExports.isValidElement(Tt))return null;let nt;if(pt){if(!Array.isArray(nn))throw new Error(formatMuiErrorMessage(2));nt=nn.some(Ct=>areEqualValues(Ct,Tt.props.value)),nt&&rr&&Bn.push(Tt.props.children)}else nt=areEqualValues(nn,Tt.props.value),nt&&rr&&(sr=Tt.props.children);return reactExports.cloneElement(Tt,{"aria-selected":nt?"true":"false",onClick:Xn(Tt),onKeyUp:Ct=>{Ct.key===" "&&Ct.preventDefault(),Tt.props.onKeyUp&&Tt.props.onKeyUp(Ct)},role:"option",selected:nt,value:void 0,"data-value":Tt.props.value})});rr&&(pt?Bn.length===0?Qn=null:Qn=Bn.reduce((Tt,nt,Ct)=>(Tt.push(nt),Ct<Bn.length-1&&Tt.push(", "),Tt),[]):Qn=sr);let Nn=In;!it&&pn&&mn&&(Nn=Pn.clientWidth);let Wn;typeof Ht<"u"?Wn=Ht:Wn=st?null:0;const vn=Ft.id||(ft?`mui-component-select-${ft}`:void 0),Rn=_extends({},o,{variant:tn,value:nn,open:cn,error:ht}),Gt=useUtilityClasses$m(Rn);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(SelectSelect,_extends({ref:xn,tabIndex:Wn,role:"button","aria-disabled":st?"true":void 0,"aria-expanded":cn?"true":"false","aria-haspopup":"listbox","aria-label":at,"aria-labelledby":[mt,vn].filter(Boolean).join(" ")||void 0,"aria-describedby":tt,onKeyDown:tr,onMouseDown:st||Mt?null:Dn,onBlur:Jn,onFocus:At},Ft,{ownerState:Rn,className:clsx(Ft.className,Gt.select,s),id:vn,children:isEmpty(Qn)?_span$1||(_span$1=jsxRuntimeExports.jsx("span",{className:"notranslate",children:"​"})):Qn})),jsxRuntimeExports.jsx(SelectNativeInput,_extends({"aria-invalid":ht,value:Array.isArray(nn)?nn.join(","):nn,name:ft,ref:Tn,"aria-hidden":!0,onChange:ir,tabIndex:-1,disabled:st,className:Gt.nativeInput,autoFocus:lt,ownerState:Rn},gn)),jsxRuntimeExports.jsx(SelectIcon,{as:bt,className:Gt.icon,ownerState:Rn}),jsxRuntimeExports.jsx(Menu$1,_extends({id:`menu-${ft||""}`,anchorEl:Pn,open:cn,onClose:Fn,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},rt,{MenuListProps:_extends({"aria-labelledby":mt,role:"listbox",disableListWrap:!0},rt.MenuListProps),PaperProps:_extends({},rt.PaperProps,{style:_extends({minWidth:Nn},rt.PaperProps!=null?rt.PaperProps.style:null)}),children:nr}))]})}),SelectInput$1=SelectInput;function formControlState({props:a,states:o,muiFormControl:_e}){return o.reduce((tt,at)=>(tt[at]=a[at],_e&&typeof a[at]>"u"&&(tt[at]=_e[at]),tt),{})}const FormControlContext=reactExports.createContext(void 0),FormControlContext$1=FormControlContext;function useFormControl(){return reactExports.useContext(FormControlContext$1)}function getSvgIconUtilityClass(a){return generateUtilityClass("MuiSvgIcon",a)}generateUtilityClasses("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _excluded$o=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],useUtilityClasses$l=a=>{const{color:o,fontSize:_e,classes:tt}=a,at={root:["root",o!=="inherit"&&`color${capitalize(o)}`,`fontSize${capitalize(_e)}`]};return composeClasses(at,getSvgIconUtilityClass,tt)},SvgIconRoot=styled$1("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.color!=="inherit"&&o[`color${capitalize(_e.color)}`],o[`fontSize${capitalize(_e.fontSize)}`]]}})(({theme:a,ownerState:o})=>{var _e,tt,at,lt,it,ut,s,et,ot,st,Rt,ht,bt,ct,mt,rt,pt;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:(_e=a.transitions)==null||(tt=_e.create)==null?void 0:tt.call(_e,"fill",{duration:(at=a.transitions)==null||(lt=at.duration)==null?void 0:lt.shorter}),fontSize:{inherit:"inherit",small:((it=a.typography)==null||(ut=it.pxToRem)==null?void 0:ut.call(it,20))||"1.25rem",medium:((s=a.typography)==null||(et=s.pxToRem)==null?void 0:et.call(s,24))||"1.5rem",large:((ot=a.typography)==null||(st=ot.pxToRem)==null?void 0:st.call(ot,35))||"2.1875rem"}[o.fontSize],color:(Rt=(ht=(a.vars||a).palette)==null||(bt=ht[o.color])==null?void 0:bt.main)!=null?Rt:{action:(ct=(a.vars||a).palette)==null||(mt=ct.action)==null?void 0:mt.active,disabled:(rt=(a.vars||a).palette)==null||(pt=rt.action)==null?void 0:pt.disabled,inherit:void 0}[o.color]}}),SvgIcon=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiSvgIcon"}),{children:at,className:lt,color:it="inherit",component:ut="svg",fontSize:s="medium",htmlColor:et,inheritViewBox:ot=!1,titleAccess:st,viewBox:Rt="0 0 24 24"}=tt,ht=_objectWithoutPropertiesLoose(tt,_excluded$o),bt=_extends({},tt,{color:it,component:ut,fontSize:s,instanceFontSize:o.fontSize,inheritViewBox:ot,viewBox:Rt}),ct={};ot||(ct.viewBox=Rt);const mt=useUtilityClasses$l(bt);return jsxRuntimeExports.jsxs(SvgIconRoot,_extends({as:ut,className:clsx(mt.root,lt),focusable:"false",color:et,"aria-hidden":st?void 0:!0,role:st?"img":void 0,ref:_e},ct,ht,{ownerState:bt,children:[at,st?jsxRuntimeExports.jsx("title",{children:st}):null]}))});SvgIcon.muiName="SvgIcon";const SvgIcon$1=SvgIcon;function createSvgIcon(a,o){function _e(tt,at){return jsxRuntimeExports.jsx(SvgIcon$1,_extends({"data-testid":`${o}Icon`,ref:at},tt,{children:a}))}return _e.muiName=SvgIcon$1.muiName,reactExports.memo(reactExports.forwardRef(_e))}const ArrowDropDownIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown");function GlobalStyles(a){return jsxRuntimeExports.jsx(GlobalStyles$1,_extends({},a,{defaultTheme:defaultTheme$2,themeId:THEME_ID}))}function getInputBaseUtilityClass(a){return generateUtilityClass("MuiInputBase",a)}const inputBaseClasses=generateUtilityClasses("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),inputBaseClasses$1=inputBaseClasses,_excluded$n=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],rootOverridesResolver=(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.formControl&&o.formControl,_e.startAdornment&&o.adornedStart,_e.endAdornment&&o.adornedEnd,_e.error&&o.error,_e.size==="small"&&o.sizeSmall,_e.multiline&&o.multiline,_e.color&&o[`color${capitalize(_e.color)}`],_e.fullWidth&&o.fullWidth,_e.hiddenLabel&&o.hiddenLabel]},inputOverridesResolver=(a,o)=>{const{ownerState:_e}=a;return[o.input,_e.size==="small"&&o.inputSizeSmall,_e.multiline&&o.inputMultiline,_e.type==="search"&&o.inputTypeSearch,_e.startAdornment&&o.inputAdornedStart,_e.endAdornment&&o.inputAdornedEnd,_e.hiddenLabel&&o.inputHiddenLabel]},useUtilityClasses$k=a=>{const{classes:o,color:_e,disabled:tt,error:at,endAdornment:lt,focused:it,formControl:ut,fullWidth:s,hiddenLabel:et,multiline:ot,readOnly:st,size:Rt,startAdornment:ht,type:bt}=a,ct={root:["root",`color${capitalize(_e)}`,tt&&"disabled",at&&"error",s&&"fullWidth",it&&"focused",ut&&"formControl",Rt==="small"&&"sizeSmall",ot&&"multiline",ht&&"adornedStart",lt&&"adornedEnd",et&&"hiddenLabel",st&&"readOnly"],input:["input",tt&&"disabled",bt==="search"&&"inputTypeSearch",ot&&"inputMultiline",Rt==="small"&&"inputSizeSmall",et&&"inputHiddenLabel",ht&&"inputAdornedStart",lt&&"inputAdornedEnd",st&&"readOnly"]};return composeClasses(ct,getInputBaseUtilityClass,o)},InputBaseRoot=styled$1("div",{name:"MuiInputBase",slot:"Root",overridesResolver:rootOverridesResolver})(({theme:a,ownerState:o})=>_extends({},a.typography.body1,{color:(a.vars||a).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${inputBaseClasses$1.disabled}`]:{color:(a.vars||a).palette.text.disabled,cursor:"default"}},o.multiline&&_extends({padding:"4px 0 5px"},o.size==="small"&&{paddingTop:1}),o.fullWidth&&{width:"100%"})),InputBaseComponent=styled$1("input",{name:"MuiInputBase",slot:"Input",overridesResolver:inputOverridesResolver})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light",tt=_extends({color:"currentColor"},a.vars?{opacity:a.vars.opacity.inputPlaceholder}:{opacity:_e?.42:.5},{transition:a.transitions.create("opacity",{duration:a.transitions.duration.shorter})}),at={opacity:"0 !important"},lt=a.vars?{opacity:a.vars.opacity.inputPlaceholder}:{opacity:_e?.42:.5};return _extends({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":tt,"&::-moz-placeholder":tt,"&:-ms-input-placeholder":tt,"&::-ms-input-placeholder":tt,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${inputBaseClasses$1.formControl} &`]:{"&::-webkit-input-placeholder":at,"&::-moz-placeholder":at,"&:-ms-input-placeholder":at,"&::-ms-input-placeholder":at,"&:focus::-webkit-input-placeholder":lt,"&:focus::-moz-placeholder":lt,"&:focus:-ms-input-placeholder":lt,"&:focus::-ms-input-placeholder":lt},[`&.${inputBaseClasses$1.disabled}`]:{opacity:1,WebkitTextFillColor:(a.vars||a).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},o.size==="small"&&{paddingTop:1},o.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},o.type==="search"&&{MozAppearance:"textfield"})}),inputGlobalStyles=jsxRuntimeExports.jsx(GlobalStyles,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),InputBase=reactExports.forwardRef(function(o,_e){var tt;const at=useThemeProps({props:o,name:"MuiInputBase"}),{"aria-describedby":lt,autoComplete:it,autoFocus:ut,className:s,components:et={},componentsProps:ot={},defaultValue:st,disabled:Rt,disableInjectingGlobalStyles:ht,endAdornment:bt,fullWidth:ct=!1,id:mt,inputComponent:rt="input",inputProps:pt={},inputRef:ft,maxRows:St,minRows:It,multiline:xt=!1,name:At,onBlur:Dt,onChange:wt,onClick:Mt,onFocus:vt,onKeyDown:Ft,onKeyUp:Ht,placeholder:Wt,readOnly:tn,renderSuffix:gn,rows:nn,slotProps:qt={},slots:fn={},startAdornment:Cn,type:Tn="text",value:un}=at,mn=_objectWithoutPropertiesLoose(at,_excluded$n),yn=pt.value!=null?pt.value:un,{current:pn}=reactExports.useRef(yn!=null),In=reactExports.useRef(),kn=reactExports.useCallback(Rn=>{},[]),Mn=useForkRef(In,ft,pt.ref,kn),[xn,Pn]=reactExports.useState(!1),On=useFormControl(),Dn=formControlState({props:at,muiFormControl:On,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Dn.focused=On?On.focused:xn,reactExports.useEffect(()=>{!On&&Rt&&xn&&(Pn(!1),Dt&&Dt())},[On,Rt,xn,Dt]);const Fn=On&&On.onFilled,dr=On&&On.onEmpty,ir=reactExports.useCallback(Rn=>{isFilled(Rn)?Fn&&Fn():dr&&dr()},[Fn,dr]);useEnhancedEffect$1(()=>{pn&&ir({value:yn})},[yn,ir,pn]);const Xn=Rn=>{if(Dn.disabled){Rn.stopPropagation();return}vt&&vt(Rn),pt.onFocus&&pt.onFocus(Rn),On&&On.onFocus?On.onFocus(Rn):Pn(!0)},tr=Rn=>{Dt&&Dt(Rn),pt.onBlur&&pt.onBlur(Rn),On&&On.onBlur?On.onBlur(Rn):Pn(!1)},cn=(Rn,...Gt)=>{if(!pn){const Tt=Rn.target||In.current;if(Tt==null)throw new Error(formatMuiErrorMessage(1));ir({value:Tt.value})}pt.onChange&&pt.onChange(Rn,...Gt),wt&&wt(Rn,...Gt)};reactExports.useEffect(()=>{ir(In.current)},[]);const Jn=Rn=>{In.current&&Rn.currentTarget===Rn.target&&In.current.focus(),Mt&&!Dn.disabled&&Mt(Rn)};let Qn=rt,sr=pt;xt&&Qn==="input"&&(nn?sr=_extends({type:void 0,minRows:nn,maxRows:nn},sr):sr=_extends({type:void 0,maxRows:St,minRows:It},sr),Qn=TextareaAutosize$1);const Bn=Rn=>{ir(Rn.animationName==="mui-auto-fill-cancel"?In.current:{value:"x"})};reactExports.useEffect(()=>{On&&On.setAdornedStart(!!Cn)},[On,Cn]);const rr=_extends({},at,{color:Dn.color||"primary",disabled:Dn.disabled,endAdornment:bt,error:Dn.error,focused:Dn.focused,formControl:On,fullWidth:ct,hiddenLabel:Dn.hiddenLabel,multiline:xt,size:Dn.size,startAdornment:Cn,type:Tn}),nr=useUtilityClasses$k(rr),Nn=fn.root||et.Root||InputBaseRoot,Wn=qt.root||ot.root||{},vn=fn.input||et.Input||InputBaseComponent;return sr=_extends({},sr,(tt=qt.input)!=null?tt:ot.input),jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[!ht&&inputGlobalStyles,jsxRuntimeExports.jsxs(Nn,_extends({},Wn,!isHostComponent(Nn)&&{ownerState:_extends({},rr,Wn.ownerState)},{ref:_e,onClick:Jn},mn,{className:clsx(nr.root,Wn.className,s,tn&&"MuiInputBase-readOnly"),children:[Cn,jsxRuntimeExports.jsx(FormControlContext$1.Provider,{value:null,children:jsxRuntimeExports.jsx(vn,_extends({ownerState:rr,"aria-invalid":Dn.error,"aria-describedby":lt,autoComplete:it,autoFocus:ut,defaultValue:st,disabled:Dn.disabled,id:mt,onAnimationStart:Bn,name:At,placeholder:Wt,readOnly:tn,required:Dn.required,rows:nn,value:yn,onKeyDown:Ft,onKeyUp:Ht,type:Tn},sr,!isHostComponent(vn)&&{as:Qn,ownerState:_extends({},rr,sr.ownerState)},{ref:Mn,className:clsx(nr.input,sr.className,tn&&"MuiInputBase-readOnly"),onBlur:tr,onChange:cn,onFocus:Xn}))}),bt,gn?gn(_extends({},Dn,{startAdornment:Cn})):null]}))]})}),InputBase$1=InputBase;function getInputUtilityClass(a){return generateUtilityClass("MuiInput",a)}const inputClasses=_extends({},inputBaseClasses$1,generateUtilityClasses("MuiInput",["root","underline","input"])),inputClasses$1=inputClasses,_excluded$m=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],useUtilityClasses$j=a=>{const{classes:o,disableUnderline:_e}=a,at=composeClasses({root:["root",!_e&&"underline"],input:["input"]},getInputUtilityClass,o);return _extends({},o,at)},InputRoot=styled$1(InputBaseRoot,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiInput",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[...rootOverridesResolver(a,o),!_e.disableUnderline&&o.underline]}})(({theme:a,ownerState:o})=>{let tt=a.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return a.vars&&(tt=`rgba(${a.vars.palette.common.onBackgroundChannel} / ${a.vars.opacity.inputUnderline})`),_extends({position:"relative"},o.formControl&&{"label + &":{marginTop:16}},!o.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(a.vars||a).palette[o.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${inputClasses$1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${inputClasses$1.error}`]:{"&:before, &:after":{borderBottomColor:(a.vars||a).palette.error.main}},"&:before":{borderBottom:`1px solid ${tt}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:a.transitions.create("border-bottom-color",{duration:a.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${inputClasses$1.disabled}, .${inputClasses$1.error}):before`]:{borderBottom:`2px solid ${(a.vars||a).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${tt}`}},[`&.${inputClasses$1.disabled}:before`]:{borderBottomStyle:"dotted"}})}),InputInput=styled$1(InputBaseComponent,{name:"MuiInput",slot:"Input",overridesResolver:inputOverridesResolver})({}),Input=reactExports.forwardRef(function(o,_e){var tt,at,lt,it;const ut=useThemeProps({props:o,name:"MuiInput"}),{disableUnderline:s,components:et={},componentsProps:ot,fullWidth:st=!1,inputComponent:Rt="input",multiline:ht=!1,slotProps:bt,slots:ct={},type:mt="text"}=ut,rt=_objectWithoutPropertiesLoose(ut,_excluded$m),pt=useUtilityClasses$j(ut),St={root:{ownerState:{disableUnderline:s}}},It=bt??ot?deepmerge(bt??ot,St):St,xt=(tt=(at=ct.root)!=null?at:et.Root)!=null?tt:InputRoot,At=(lt=(it=ct.input)!=null?it:et.Input)!=null?lt:InputInput;return jsxRuntimeExports.jsx(InputBase$1,_extends({slots:{root:xt,input:At},slotProps:It,fullWidth:st,inputComponent:Rt,multiline:ht,ref:_e,type:mt},rt,{classes:pt}))});Input.muiName="Input";const Input$1=Input;function getFilledInputUtilityClass(a){return generateUtilityClass("MuiFilledInput",a)}const filledInputClasses=_extends({},inputBaseClasses$1,generateUtilityClasses("MuiFilledInput",["root","underline","input"])),filledInputClasses$1=filledInputClasses,_excluded$l=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],useUtilityClasses$i=a=>{const{classes:o,disableUnderline:_e}=a,at=composeClasses({root:["root",!_e&&"underline"],input:["input"]},getFilledInputUtilityClass,o);return _extends({},o,at)},FilledInputRoot=styled$1(InputBaseRoot,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[...rootOverridesResolver(a,o),!_e.disableUnderline&&o.underline]}})(({theme:a,ownerState:o})=>{var _e;const tt=a.palette.mode==="light",at=tt?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",lt=tt?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",it=tt?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",ut=tt?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return _extends({position:"relative",backgroundColor:a.vars?a.vars.palette.FilledInput.bg:lt,borderTopLeftRadius:(a.vars||a).shape.borderRadius,borderTopRightRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create("background-color",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),"&:hover":{backgroundColor:a.vars?a.vars.palette.FilledInput.hoverBg:it,"@media (hover: none)":{backgroundColor:a.vars?a.vars.palette.FilledInput.bg:lt}},[`&.${filledInputClasses$1.focused}`]:{backgroundColor:a.vars?a.vars.palette.FilledInput.bg:lt},[`&.${filledInputClasses$1.disabled}`]:{backgroundColor:a.vars?a.vars.palette.FilledInput.disabledBg:ut}},!o.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(_e=(a.vars||a).palette[o.color||"primary"])==null?void 0:_e.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${filledInputClasses$1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${filledInputClasses$1.error}`]:{"&:before, &:after":{borderBottomColor:(a.vars||a).palette.error.main}},"&:before":{borderBottom:`1px solid ${a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / ${a.vars.opacity.inputUnderline})`:at}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:a.transitions.create("border-bottom-color",{duration:a.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${filledInputClasses$1.disabled}, .${filledInputClasses$1.error}):before`]:{borderBottom:`1px solid ${(a.vars||a).palette.text.primary}`},[`&.${filledInputClasses$1.disabled}:before`]:{borderBottomStyle:"dotted"}},o.startAdornment&&{paddingLeft:12},o.endAdornment&&{paddingRight:12},o.multiline&&_extends({padding:"25px 12px 8px"},o.size==="small"&&{paddingTop:21,paddingBottom:4},o.hiddenLabel&&{paddingTop:16,paddingBottom:17}))}),FilledInputInput=styled$1(InputBaseComponent,{name:"MuiFilledInput",slot:"Input",overridesResolver:inputOverridesResolver})(({theme:a,ownerState:o})=>_extends({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!a.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:a.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:a.palette.mode==="light"?null:"#fff",caretColor:a.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},a.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[a.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},o.size==="small"&&{paddingTop:21,paddingBottom:4},o.hiddenLabel&&{paddingTop:16,paddingBottom:17},o.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},o.startAdornment&&{paddingLeft:0},o.endAdornment&&{paddingRight:0},o.hiddenLabel&&o.size==="small"&&{paddingTop:8,paddingBottom:9})),FilledInput=reactExports.forwardRef(function(o,_e){var tt,at,lt,it;const ut=useThemeProps({props:o,name:"MuiFilledInput"}),{components:s={},componentsProps:et,fullWidth:ot=!1,inputComponent:st="input",multiline:Rt=!1,slotProps:ht,slots:bt={},type:ct="text"}=ut,mt=_objectWithoutPropertiesLoose(ut,_excluded$l),rt=_extends({},ut,{fullWidth:ot,inputComponent:st,multiline:Rt,type:ct}),pt=useUtilityClasses$i(ut),ft={root:{ownerState:rt},input:{ownerState:rt}},St=ht??et?deepmerge(ht??et,ft):ft,It=(tt=(at=bt.root)!=null?at:s.Root)!=null?tt:FilledInputRoot,xt=(lt=(it=bt.input)!=null?it:s.Input)!=null?lt:FilledInputInput;return jsxRuntimeExports.jsx(InputBase$1,_extends({slots:{root:It,input:xt},componentsProps:St,fullWidth:ot,inputComponent:st,multiline:Rt,ref:_e,type:ct},mt,{classes:pt}))});FilledInput.muiName="Input";const FilledInput$1=FilledInput;var _span;const _excluded$k=["children","classes","className","label","notched"],NotchedOutlineRoot$1=styled$1("fieldset")({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),NotchedOutlineLegend=styled$1("legend")(({ownerState:a,theme:o})=>_extends({float:"unset",width:"auto",overflow:"hidden"},!a.withLabel&&{padding:0,lineHeight:"11px",transition:o.transitions.create("width",{duration:150,easing:o.transitions.easing.easeOut})},a.withLabel&&_extends({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:o.transitions.create("max-width",{duration:50,easing:o.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},a.notched&&{maxWidth:"100%",transition:o.transitions.create("max-width",{duration:100,easing:o.transitions.easing.easeOut,delay:50})})));function NotchedOutline(a){const{className:o,label:_e,notched:tt}=a,at=_objectWithoutPropertiesLoose(a,_excluded$k),lt=_e!=null&&_e!=="",it=_extends({},a,{notched:tt,withLabel:lt});return jsxRuntimeExports.jsx(NotchedOutlineRoot$1,_extends({"aria-hidden":!0,className:o,ownerState:it},at,{children:jsxRuntimeExports.jsx(NotchedOutlineLegend,{ownerState:it,children:lt?jsxRuntimeExports.jsx("span",{children:_e}):_span||(_span=jsxRuntimeExports.jsx("span",{className:"notranslate",children:"​"}))})}))}function getOutlinedInputUtilityClass(a){return generateUtilityClass("MuiOutlinedInput",a)}const outlinedInputClasses=_extends({},inputBaseClasses$1,generateUtilityClasses("MuiOutlinedInput",["root","notchedOutline","input"])),outlinedInputClasses$1=outlinedInputClasses,_excluded$j=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],useUtilityClasses$h=a=>{const{classes:o}=a,tt=composeClasses({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},getOutlinedInputUtilityClass,o);return _extends({},o,tt)},OutlinedInputRoot=styled$1(InputBaseRoot,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:rootOverridesResolver})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return _extends({position:"relative",borderRadius:(a.vars||a).shape.borderRadius,[`&:hover .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette.text.primary},"@media (hover: none)":{[`&:hover .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:_e}},[`&.${outlinedInputClasses$1.focused} .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette[o.color].main,borderWidth:2},[`&.${outlinedInputClasses$1.error} .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette.error.main},[`&.${outlinedInputClasses$1.disabled} .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette.action.disabled}},o.startAdornment&&{paddingLeft:14},o.endAdornment&&{paddingRight:14},o.multiline&&_extends({padding:"16.5px 14px"},o.size==="small"&&{padding:"8.5px 14px"}))}),NotchedOutlineRoot=styled$1(NotchedOutline,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(a,o)=>o.notchedOutline})(({theme:a})=>{const o=a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:o}}),OutlinedInputInput=styled$1(InputBaseComponent,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:inputOverridesResolver})(({theme:a,ownerState:o})=>_extends({padding:"16.5px 14px"},!a.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:a.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:a.palette.mode==="light"?null:"#fff",caretColor:a.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},a.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[a.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},o.size==="small"&&{padding:"8.5px 14px"},o.multiline&&{padding:0},o.startAdornment&&{paddingLeft:0},o.endAdornment&&{paddingRight:0})),OutlinedInput=reactExports.forwardRef(function(o,_e){var tt,at,lt,it,ut;const s=useThemeProps({props:o,name:"MuiOutlinedInput"}),{components:et={},fullWidth:ot=!1,inputComponent:st="input",label:Rt,multiline:ht=!1,notched:bt,slots:ct={},type:mt="text"}=s,rt=_objectWithoutPropertiesLoose(s,_excluded$j),pt=useUtilityClasses$h(s),ft=useFormControl(),St=formControlState({props:s,muiFormControl:ft,states:["required"]}),It=_extends({},s,{color:St.color||"primary",disabled:St.disabled,error:St.error,focused:St.focused,formControl:ft,fullWidth:ot,hiddenLabel:St.hiddenLabel,multiline:ht,size:St.size,type:mt}),xt=(tt=(at=ct.root)!=null?at:et.Root)!=null?tt:OutlinedInputRoot,At=(lt=(it=ct.input)!=null?it:et.Input)!=null?lt:OutlinedInputInput;return jsxRuntimeExports.jsx(InputBase$1,_extends({slots:{root:xt,input:At},renderSuffix:Dt=>jsxRuntimeExports.jsx(NotchedOutlineRoot,{ownerState:It,className:pt.notchedOutline,label:Rt!=null&&Rt!==""&&St.required?ut||(ut=jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[Rt," ","*"]})):Rt,notched:typeof bt<"u"?bt:!!(Dt.startAdornment||Dt.filled||Dt.focused)}),fullWidth:ot,inputComponent:st,multiline:ht,ref:_e,type:mt},rt,{classes:_extends({},pt,{notchedOutline:null})}))});OutlinedInput.muiName="Input";const OutlinedInput$1=OutlinedInput,_excluded$i=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],useUtilityClasses$g=a=>{const{classes:o}=a;return o},styledRootConfig={name:"MuiSelect",overridesResolver:(a,o)=>o.root,shouldForwardProp:a=>rootShouldForwardProp(a)&&a!=="variant",slot:"Root"},StyledInput=styled$1(Input$1,styledRootConfig)(""),StyledOutlinedInput=styled$1(OutlinedInput$1,styledRootConfig)(""),StyledFilledInput=styled$1(FilledInput$1,styledRootConfig)(""),Select=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({name:"MuiSelect",props:o}),{autoWidth:at=!1,children:lt,classes:it={},className:ut,defaultOpen:s=!1,displayEmpty:et=!1,IconComponent:ot=ArrowDropDownIcon,id:st,input:Rt,inputProps:ht,label:bt,labelId:ct,MenuProps:mt,multiple:rt=!1,native:pt=!1,onClose:ft,onOpen:St,open:It,renderValue:xt,SelectDisplayProps:At,variant:Dt="outlined"}=tt,wt=_objectWithoutPropertiesLoose(tt,_excluded$i),Mt=pt?NativeSelectInput$1:SelectInput$1,vt=useFormControl(),Ft=formControlState({props:tt,muiFormControl:vt,states:["variant","error"]}),Ht=Ft.variant||Dt,Wt=_extends({},tt,{variant:Ht,classes:it}),tn=useUtilityClasses$g(Wt),gn=Rt||{standard:jsxRuntimeExports.jsx(StyledInput,{ownerState:Wt}),outlined:jsxRuntimeExports.jsx(StyledOutlinedInput,{label:bt,ownerState:Wt}),filled:jsxRuntimeExports.jsx(StyledFilledInput,{ownerState:Wt})}[Ht],nn=useForkRef(_e,gn.ref);return jsxRuntimeExports.jsx(reactExports.Fragment,{children:reactExports.cloneElement(gn,_extends({inputComponent:Mt,inputProps:_extends({children:lt,error:Ft.error,IconComponent:ot,variant:Ht,type:void 0,multiple:rt},pt?{id:st}:{autoWidth:at,defaultOpen:s,displayEmpty:et,labelId:ct,MenuProps:mt,onClose:ft,onOpen:St,open:It,renderValue:xt,SelectDisplayProps:_extends({id:st},At)},ht,{classes:ht?deepmerge(tn,ht.classes):tn},Rt?Rt.props.inputProps:{})},rt&&pt&&Ht==="outlined"?{notched:!0}:{},{ref:nn,className:clsx(gn.props.className,ut)},!Rt&&{variant:Ht},wt))})});Select.muiName="Select";const Select$1=Select;function getFormControlLabelUtilityClasses(a){return generateUtilityClass("MuiFormControlLabel",a)}const formControlLabelClasses=generateUtilityClasses("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),formControlLabelClasses$1=formControlLabelClasses,_excluded$h=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],useUtilityClasses$f=a=>{const{classes:o,disabled:_e,labelPlacement:tt,error:at,required:lt}=a,it={root:["root",_e&&"disabled",`labelPlacement${capitalize(tt)}`,at&&"error",lt&&"required"],label:["label",_e&&"disabled"],asterisk:["asterisk",at&&"error"]};return composeClasses(it,getFormControlLabelUtilityClasses,o)},FormControlLabelRoot=styled$1("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[{[`& .${formControlLabelClasses$1.label}`]:o.label},o.root,o[`labelPlacement${capitalize(_e.labelPlacement)}`]]}})(({theme:a,ownerState:o})=>_extends({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${formControlLabelClasses$1.disabled}`]:{cursor:"default"}},o.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},o.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},o.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${formControlLabelClasses$1.label}`]:{[`&.${formControlLabelClasses$1.disabled}`]:{color:(a.vars||a).palette.text.disabled}}})),AsteriskComponent=styled$1("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(a,o)=>o.asterisk})(({theme:a})=>({[`&.${formControlLabelClasses$1.error}`]:{color:(a.vars||a).palette.error.main}})),FormControlLabel=reactExports.forwardRef(function(o,_e){var tt,at;const lt=useThemeProps({props:o,name:"MuiFormControlLabel"}),{className:it,componentsProps:ut={},control:s,disabled:et,disableTypography:ot,label:st,labelPlacement:Rt="end",required:ht,slotProps:bt={}}=lt,ct=_objectWithoutPropertiesLoose(lt,_excluded$h),mt=useFormControl(),rt=(tt=et??s.props.disabled)!=null?tt:mt==null?void 0:mt.disabled,pt=ht??s.props.required,ft={disabled:rt,required:pt};["checked","name","onChange","value","inputRef"].forEach(wt=>{typeof s.props[wt]>"u"&&typeof lt[wt]<"u"&&(ft[wt]=lt[wt])});const St=formControlState({props:lt,muiFormControl:mt,states:["error"]}),It=_extends({},lt,{disabled:rt,labelPlacement:Rt,required:pt,error:St.error}),xt=useUtilityClasses$f(It),At=(at=bt.typography)!=null?at:ut.typography;let Dt=st;return Dt!=null&&Dt.type!==Typography$1&&!ot&&(Dt=jsxRuntimeExports.jsx(Typography$1,_extends({component:"span"},At,{className:clsx(xt.label,At==null?void 0:At.className),children:Dt}))),jsxRuntimeExports.jsxs(FormControlLabelRoot,_extends({className:clsx(xt.root,it),ownerState:It,ref:_e},ct,{children:[reactExports.cloneElement(s,ft),Dt,pt&&jsxRuntimeExports.jsxs(AsteriskComponent,{ownerState:It,"aria-hidden":!0,className:xt.asterisk,children:[" ","*"]})]}))}),FormControlLabel$1=FormControlLabel;function getSwitchBaseUtilityClass(a){return generateUtilityClass("PrivateSwitchBase",a)}generateUtilityClasses("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const _excluded$g=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],useUtilityClasses$e=a=>{const{classes:o,checked:_e,disabled:tt,edge:at}=a,lt={root:["root",_e&&"checked",tt&&"disabled",at&&`edge${capitalize(at)}`],input:["input"]};return composeClasses(lt,getSwitchBaseUtilityClass,o)},SwitchBaseRoot=styled$1(ButtonBase$1)(({ownerState:a})=>_extends({padding:9,borderRadius:"50%"},a.edge==="start"&&{marginLeft:a.size==="small"?-3:-12},a.edge==="end"&&{marginRight:a.size==="small"?-3:-12})),SwitchBaseInput=styled$1("input")({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),SwitchBase=reactExports.forwardRef(function(o,_e){const{autoFocus:tt,checked:at,checkedIcon:lt,className:it,defaultChecked:ut,disabled:s,disableFocusRipple:et=!1,edge:ot=!1,icon:st,id:Rt,inputProps:ht,inputRef:bt,name:ct,onBlur:mt,onChange:rt,onFocus:pt,readOnly:ft,required:St=!1,tabIndex:It,type:xt,value:At}=o,Dt=_objectWithoutPropertiesLoose(o,_excluded$g),[wt,Mt]=useControlled({controlled:at,default:!!ut,name:"SwitchBase",state:"checked"}),vt=useFormControl(),Ft=fn=>{pt&&pt(fn),vt&&vt.onFocus&&vt.onFocus(fn)},Ht=fn=>{mt&&mt(fn),vt&&vt.onBlur&&vt.onBlur(fn)},Wt=fn=>{if(fn.nativeEvent.defaultPrevented)return;const Cn=fn.target.checked;Mt(Cn),rt&&rt(fn,Cn)};let tn=s;vt&&typeof tn>"u"&&(tn=vt.disabled);const gn=xt==="checkbox"||xt==="radio",nn=_extends({},o,{checked:wt,disabled:tn,disableFocusRipple:et,edge:ot}),qt=useUtilityClasses$e(nn);return jsxRuntimeExports.jsxs(SwitchBaseRoot,_extends({component:"span",className:clsx(qt.root,it),centerRipple:!0,focusRipple:!et,disabled:tn,tabIndex:null,role:void 0,onFocus:Ft,onBlur:Ht,ownerState:nn,ref:_e},Dt,{children:[jsxRuntimeExports.jsx(SwitchBaseInput,_extends({autoFocus:tt,checked:at,defaultChecked:ut,className:qt.input,disabled:tn,id:gn?Rt:void 0,name:ct,onChange:Wt,readOnly:ft,ref:bt,required:St,ownerState:nn,tabIndex:It,type:xt},xt==="checkbox"&&At===void 0?{}:{value:At},ht)),wt?lt:st]}))}),SwitchBase$1=SwitchBase;function getFormGroupUtilityClass(a){return generateUtilityClass("MuiFormGroup",a)}generateUtilityClasses("MuiFormGroup",["root","row","error"]);const _excluded$f=["className","row"],useUtilityClasses$d=a=>{const{classes:o,row:_e,error:tt}=a;return composeClasses({root:["root",_e&&"row",tt&&"error"]},getFormGroupUtilityClass,o)},FormGroupRoot=styled$1("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.row&&o.row]}})(({ownerState:a})=>_extends({display:"flex",flexDirection:"column",flexWrap:"wrap"},a.row&&{flexDirection:"row"})),FormGroup=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiFormGroup"}),{className:at,row:lt=!1}=tt,it=_objectWithoutPropertiesLoose(tt,_excluded$f),ut=useFormControl(),s=formControlState({props:tt,muiFormControl:ut,states:["error"]}),et=_extends({},tt,{row:lt,error:s.error}),ot=useUtilityClasses$d(et);return jsxRuntimeExports.jsx(FormGroupRoot,_extends({className:clsx(ot.root,at),ownerState:et,ref:_e},it))}),FormGroup$1=FormGroup;function getUnit(a){return String(a).match(/[\d.\-+]*\s*(.*)/)[1]||""}function toUnitless(a){return parseFloat(a)}const _excluded$e=["theme"];function ThemeProvider(a){let{theme:o}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$e);const tt=o[THEME_ID];return jsxRuntimeExports.jsx(ThemeProvider$1,_extends({},_e,{themeId:tt?THEME_ID:void 0,theme:tt||o}))}const defaultTheme=createTheme(),Box=createBox({themeId:THEME_ID,defaultTheme,defaultClassName:"MuiBox-root",generateClassName:ClassNameGenerator$1.generate}),Box$1=Box;function getIconUtilityClass(a){return generateUtilityClass("MuiIcon",a)}generateUtilityClasses("MuiIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _excluded$d=["baseClassName","className","color","component","fontSize"],useUtilityClasses$c=a=>{const{color:o,fontSize:_e,classes:tt}=a,at={root:["root",o!=="inherit"&&`color${capitalize(o)}`,`fontSize${capitalize(_e)}`]};return composeClasses(at,getIconUtilityClass,tt)},IconRoot=styled$1("span",{name:"MuiIcon",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.color!=="inherit"&&o[`color${capitalize(_e.color)}`],o[`fontSize${capitalize(_e.fontSize)}`]]}})(({theme:a,ownerState:o})=>({userSelect:"none",width:"1em",height:"1em",overflow:"hidden",display:"inline-block",textAlign:"center",flexShrink:0,fontSize:{inherit:"inherit",small:a.typography.pxToRem(20),medium:a.typography.pxToRem(24),large:a.typography.pxToRem(36)}[o.fontSize],color:{primary:(a.vars||a).palette.primary.main,secondary:(a.vars||a).palette.secondary.main,info:(a.vars||a).palette.info.main,success:(a.vars||a).palette.success.main,warning:(a.vars||a).palette.warning.main,action:(a.vars||a).palette.action.active,error:(a.vars||a).palette.error.main,disabled:(a.vars||a).palette.action.disabled,inherit:void 0}[o.color]})),Icon=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiIcon"}),{baseClassName:at="material-icons",className:lt,color:it="inherit",component:ut="span",fontSize:s="medium"}=tt,et=_objectWithoutPropertiesLoose(tt,_excluded$d),ot=_extends({},tt,{baseClassName:at,color:it,component:ut,fontSize:s}),st=useUtilityClasses$c(ot);return jsxRuntimeExports.jsx(IconRoot,_extends({as:ut,className:clsx(at,"notranslate",st.root,lt),ownerState:ot,"aria-hidden":!0,ref:_e},et))});Icon.muiName="Icon";const Icon$1=Icon;function getIconButtonUtilityClass(a){return generateUtilityClass("MuiIconButton",a)}const iconButtonClasses=generateUtilityClasses("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),iconButtonClasses$1=iconButtonClasses,_excluded$c=["edge","children","className","color","disabled","disableFocusRipple","size"],useUtilityClasses$b=a=>{const{classes:o,disabled:_e,color:tt,edge:at,size:lt}=a,it={root:["root",_e&&"disabled",tt!=="default"&&`color${capitalize(tt)}`,at&&`edge${capitalize(at)}`,`size${capitalize(lt)}`]};return composeClasses(it,getIconButtonUtilityClass,o)},IconButtonRoot=styled$1(ButtonBase$1,{name:"MuiIconButton",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.color!=="default"&&o[`color${capitalize(_e.color)}`],_e.edge&&o[`edge${capitalize(_e.edge)}`],o[`size${capitalize(_e.size)}`]]}})(({theme:a,ownerState:o})=>_extends({textAlign:"center",flex:"0 0 auto",fontSize:a.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(a.vars||a).palette.action.active,transition:a.transitions.create("background-color",{duration:a.transitions.duration.shortest})},!o.disableRipple&&{"&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.activeChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette.action.active,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.edge==="start"&&{marginLeft:o.size==="small"?-3:-12},o.edge==="end"&&{marginRight:o.size==="small"?-3:-12}),({theme:a,ownerState:o})=>{var _e;const tt=(_e=(a.vars||a).palette)==null?void 0:_e[o.color];return _extends({},o.color==="inherit"&&{color:"inherit"},o.color!=="inherit"&&o.color!=="default"&&_extends({color:tt==null?void 0:tt.main},!o.disableRipple&&{"&:hover":_extends({},tt&&{backgroundColor:a.vars?`rgba(${tt.mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(tt.main,a.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),o.size==="small"&&{padding:5,fontSize:a.typography.pxToRem(18)},o.size==="large"&&{padding:12,fontSize:a.typography.pxToRem(28)},{[`&.${iconButtonClasses$1.disabled}`]:{backgroundColor:"transparent",color:(a.vars||a).palette.action.disabled}})}),IconButton=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiIconButton"}),{edge:at=!1,children:lt,className:it,color:ut="default",disabled:s=!1,disableFocusRipple:et=!1,size:ot="medium"}=tt,st=_objectWithoutPropertiesLoose(tt,_excluded$c),Rt=_extends({},tt,{edge:at,color:ut,disabled:s,disableFocusRipple:et,size:ot}),ht=useUtilityClasses$b(Rt);return jsxRuntimeExports.jsx(IconButtonRoot,_extends({className:clsx(ht.root,it),centerRipple:!0,focusRipple:!et,disabled:s,ref:_e,ownerState:Rt},st,{children:lt}))}),IconButton$1=IconButton,_excluded$b=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],PopperRoot=styled$1(BasePopper,{name:"MuiPopper",slot:"Root",overridesResolver:(a,o)=>o.root})({}),Popper=reactExports.forwardRef(function(o,_e){var tt;const at=useTheme$3(),lt=useThemeProps({props:o,name:"MuiPopper"}),{anchorEl:it,component:ut,components:s,componentsProps:et,container:ot,disablePortal:st,keepMounted:Rt,modifiers:ht,open:bt,placement:ct,popperOptions:mt,popperRef:rt,transition:pt,slots:ft,slotProps:St}=lt,It=_objectWithoutPropertiesLoose(lt,_excluded$b),xt=(tt=ft==null?void 0:ft.root)!=null?tt:s==null?void 0:s.Root,At=_extends({anchorEl:it,container:ot,disablePortal:st,keepMounted:Rt,modifiers:ht,open:bt,placement:ct,popperOptions:mt,popperRef:rt,transition:pt},It);return jsxRuntimeExports.jsx(PopperRoot,_extends({as:ut,direction:at==null?void 0:at.direction,slots:{root:xt},slotProps:St??et},At,{ref:_e}))}),Popper$1=Popper;function getTooltipUtilityClass(a){return generateUtilityClass("MuiTooltip",a)}const tooltipClasses=generateUtilityClasses("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),tooltipClasses$1=tooltipClasses,_excluded$a=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function round(a){return Math.round(a*1e5)/1e5}const useUtilityClasses$a=a=>{const{classes:o,disableInteractive:_e,arrow:tt,touch:at,placement:lt}=a,it={popper:["popper",!_e&&"popperInteractive",tt&&"popperArrow"],tooltip:["tooltip",tt&&"tooltipArrow",at&&"touch",`tooltipPlacement${capitalize(lt.split("-")[0])}`],arrow:["arrow"]};return composeClasses(it,getTooltipUtilityClass,o)},TooltipPopper=styled$1(Popper$1,{name:"MuiTooltip",slot:"Popper",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.popper,!_e.disableInteractive&&o.popperInteractive,_e.arrow&&o.popperArrow,!_e.open&&o.popperClose]}})(({theme:a,ownerState:o,open:_e})=>_extends({zIndex:(a.vars||a).zIndex.tooltip,pointerEvents:"none"},!o.disableInteractive&&{pointerEvents:"auto"},!_e&&{pointerEvents:"none"},o.arrow&&{[`&[data-popper-placement*="bottom"] .${tooltipClasses$1.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${tooltipClasses$1.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${tooltipClasses$1.arrow}`]:_extends({},o.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${tooltipClasses$1.arrow}`]:_extends({},o.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),TooltipTooltip=styled$1("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.tooltip,_e.touch&&o.touch,_e.arrow&&o.tooltipArrow,o[`tooltipPlacement${capitalize(_e.placement.split("-")[0])}`]]}})(({theme:a,ownerState:o})=>_extends({backgroundColor:a.vars?a.vars.palette.Tooltip.bg:alpha(a.palette.grey[700],.92),borderRadius:(a.vars||a).shape.borderRadius,color:(a.vars||a).palette.common.white,fontFamily:a.typography.fontFamily,padding:"4px 8px",fontSize:a.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:a.typography.fontWeightMedium},o.arrow&&{position:"relative",margin:0},o.touch&&{padding:"8px 16px",fontSize:a.typography.pxToRem(14),lineHeight:`${round(16/14)}em`,fontWeight:a.typography.fontWeightRegular},{[`.${tooltipClasses$1.popper}[data-popper-placement*="left"] &`]:_extends({transformOrigin:"right center"},o.isRtl?_extends({marginLeft:"14px"},o.touch&&{marginLeft:"24px"}):_extends({marginRight:"14px"},o.touch&&{marginRight:"24px"})),[`.${tooltipClasses$1.popper}[data-popper-placement*="right"] &`]:_extends({transformOrigin:"left center"},o.isRtl?_extends({marginRight:"14px"},o.touch&&{marginRight:"24px"}):_extends({marginLeft:"14px"},o.touch&&{marginLeft:"24px"})),[`.${tooltipClasses$1.popper}[data-popper-placement*="top"] &`]:_extends({transformOrigin:"center bottom",marginBottom:"14px"},o.touch&&{marginBottom:"24px"}),[`.${tooltipClasses$1.popper}[data-popper-placement*="bottom"] &`]:_extends({transformOrigin:"center top",marginTop:"14px"},o.touch&&{marginTop:"24px"})})),TooltipArrow=styled$1("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(a,o)=>o.arrow})(({theme:a})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:a.vars?a.vars.palette.Tooltip.bg:alpha(a.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let hystersisOpen=!1,hystersisTimer=null,cursorPosition={x:0,y:0};function composeEventHandler(a,o){return _e=>{o&&o(_e),a(_e)}}const Tooltip=reactExports.forwardRef(function(o,_e){var tt,at,lt,it,ut,s,et,ot,st,Rt,ht,bt,ct,mt,rt,pt,ft,St,It;const xt=useThemeProps({props:o,name:"MuiTooltip"}),{arrow:At=!1,children:Dt,components:wt={},componentsProps:Mt={},describeChild:vt=!1,disableFocusListener:Ft=!1,disableHoverListener:Ht=!1,disableInteractive:Wt=!1,disableTouchListener:tn=!1,enterDelay:gn=100,enterNextDelay:nn=0,enterTouchDelay:qt=700,followCursor:fn=!1,id:Cn,leaveDelay:Tn=0,leaveTouchDelay:un=1500,onClose:mn,onOpen:yn,open:pn,placement:In="bottom",PopperComponent:kn,PopperProps:Mn={},slotProps:xn={},slots:Pn={},title:On,TransitionComponent:Dn=Grow$1,TransitionProps:Fn}=xt,dr=_objectWithoutPropertiesLoose(xt,_excluded$a),ir=useTheme(),Xn=ir.direction==="rtl",[tr,cn]=reactExports.useState(),[Jn,Qn]=reactExports.useState(null),sr=reactExports.useRef(!1),Bn=Wt||fn,rr=reactExports.useRef(),nr=reactExports.useRef(),Nn=reactExports.useRef(),Wn=reactExports.useRef(),[vn,Rn]=useControlled({controlled:pn,default:!1,name:"Tooltip",state:"open"});let Gt=vn;const Tt=useId(Cn),nt=reactExports.useRef(),Ct=reactExports.useCallback(()=>{nt.current!==void 0&&(document.body.style.WebkitUserSelect=nt.current,nt.current=void 0),clearTimeout(Wn.current)},[]);reactExports.useEffect(()=>()=>{clearTimeout(rr.current),clearTimeout(nr.current),clearTimeout(Nn.current),Ct()},[Ct]);const yt=zn=>{clearTimeout(hystersisTimer),hystersisOpen=!0,Rn(!0),yn&&!Gt&&yn(zn)},Pt=useEventCallback(zn=>{clearTimeout(hystersisTimer),hystersisTimer=setTimeout(()=>{hystersisOpen=!1},800+Tn),Rn(!1),mn&&Gt&&mn(zn),clearTimeout(rr.current),rr.current=setTimeout(()=>{sr.current=!1},ir.transitions.duration.shortest)}),Et=zn=>{sr.current&&zn.type!=="touchstart"||(tr&&tr.removeAttribute("title"),clearTimeout(nr.current),clearTimeout(Nn.current),gn||hystersisOpen&&nn?nr.current=setTimeout(()=>{yt(zn)},hystersisOpen?nn:gn):yt(zn))},Ut=zn=>{clearTimeout(nr.current),clearTimeout(Nn.current),Nn.current=setTimeout(()=>{Pt(zn)},Tn)},{isFocusVisibleRef:Ot,onBlur:Bt,onFocus:Qt,ref:en}=useIsFocusVisible(),[,Jt]=reactExports.useState(!1),an=zn=>{Bt(zn),Ot.current===!1&&(Jt(!1),Ut(zn))},hn=zn=>{tr||cn(zn.currentTarget),Qt(zn),Ot.current===!0&&(Jt(!0),Et(zn))},rn=zn=>{sr.current=!0;const Yn=Dt.props;Yn.onTouchStart&&Yn.onTouchStart(zn)},dn=Et,Sn=Ut,wn=zn=>{rn(zn),clearTimeout(Nn.current),clearTimeout(rr.current),Ct(),nt.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Wn.current=setTimeout(()=>{document.body.style.WebkitUserSelect=nt.current,Et(zn)},qt)},An=zn=>{Dt.props.onTouchEnd&&Dt.props.onTouchEnd(zn),Ct(),clearTimeout(Nn.current),Nn.current=setTimeout(()=>{Pt(zn)},un)};reactExports.useEffect(()=>{if(!Gt)return;function zn(Yn){(Yn.key==="Escape"||Yn.key==="Esc")&&Pt(Yn)}return document.addEventListener("keydown",zn),()=>{document.removeEventListener("keydown",zn)}},[Pt,Gt]);const _n=useForkRef(Dt.ref,en,cn,_e);!On&&On!==0&&(Gt=!1);const jn=reactExports.useRef(),ar=zn=>{const Yn=Dt.props;Yn.onMouseMove&&Yn.onMouseMove(zn),cursorPosition={x:zn.clientX,y:zn.clientY},jn.current&&jn.current.update()},fr={},Cr=typeof On=="string";vt?(fr.title=!Gt&&Cr&&!Ht?On:null,fr["aria-describedby"]=Gt?Tt:null):(fr["aria-label"]=Cr?On:null,fr["aria-labelledby"]=Gt&&!Cr?Tt:null);const gr=_extends({},fr,dr,Dt.props,{className:clsx(dr.className,Dt.props.className),onTouchStart:rn,ref:_n},fn?{onMouseMove:ar}:{}),Er={};tn||(gr.onTouchStart=wn,gr.onTouchEnd=An),Ht||(gr.onMouseOver=composeEventHandler(dn,gr.onMouseOver),gr.onMouseLeave=composeEventHandler(Sn,gr.onMouseLeave),Bn||(Er.onMouseOver=dn,Er.onMouseLeave=Sn)),Ft||(gr.onFocus=composeEventHandler(hn,gr.onFocus),gr.onBlur=composeEventHandler(an,gr.onBlur),Bn||(Er.onFocus=hn,Er.onBlur=an));const Nr=reactExports.useMemo(()=>{var zn;let Yn=[{name:"arrow",enabled:!!Jn,options:{element:Jn,padding:4}}];return(zn=Mn.popperOptions)!=null&&zn.modifiers&&(Yn=Yn.concat(Mn.popperOptions.modifiers)),_extends({},Mn.popperOptions,{modifiers:Yn})},[Jn,Mn]),qr=_extends({},xt,{isRtl:Xn,arrow:At,disableInteractive:Bn,placement:In,PopperComponentProp:kn,touch:sr.current}),Qr=useUtilityClasses$a(qr),Sr=(tt=(at=Pn.popper)!=null?at:wt.Popper)!=null?tt:TooltipPopper,Dr=(lt=(it=(ut=Pn.transition)!=null?ut:wt.Transition)!=null?it:Dn)!=null?lt:Grow$1,wr=(s=(et=Pn.tooltip)!=null?et:wt.Tooltip)!=null?s:TooltipTooltip,Or=(ot=(st=Pn.arrow)!=null?st:wt.Arrow)!=null?ot:TooltipArrow,Ur=appendOwnerState(Sr,_extends({},Mn,(Rt=xn.popper)!=null?Rt:Mt.popper,{className:clsx(Qr.popper,Mn==null?void 0:Mn.className,(ht=(bt=xn.popper)!=null?bt:Mt.popper)==null?void 0:ht.className)}),qr),Hr=appendOwnerState(Dr,_extends({},Fn,(ct=xn.transition)!=null?ct:Mt.transition),qr),na=appendOwnerState(wr,_extends({},(mt=xn.tooltip)!=null?mt:Mt.tooltip,{className:clsx(Qr.tooltip,(rt=(pt=xn.tooltip)!=null?pt:Mt.tooltip)==null?void 0:rt.className)}),qr),Vn=appendOwnerState(Or,_extends({},(ft=xn.arrow)!=null?ft:Mt.arrow,{className:clsx(Qr.arrow,(St=(It=xn.arrow)!=null?It:Mt.arrow)==null?void 0:St.className)}),qr);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[reactExports.cloneElement(Dt,gr),jsxRuntimeExports.jsx(Sr,_extends({as:kn??Popper$1,placement:In,anchorEl:fn?{getBoundingClientRect:()=>({top:cursorPosition.y,left:cursorPosition.x,right:cursorPosition.x,bottom:cursorPosition.y,width:0,height:0})}:tr,popperRef:jn,open:tr?Gt:!1,id:Tt,transition:!0},Er,Ur,{popperOptions:Nr,children:({TransitionProps:zn})=>jsxRuntimeExports.jsx(Dr,_extends({timeout:ir.transitions.duration.shorter},zn,Hr,{children:jsxRuntimeExports.jsxs(wr,_extends({},na,{children:[On,At?jsxRuntimeExports.jsx(Or,_extends({},Vn,{ref:Qn})):null]}))}))}))]})}),Tooltip$1=Tooltip;function getCircularProgressUtilityClass(a){return generateUtilityClass("MuiCircularProgress",a)}generateUtilityClasses("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const _excluded$9=["className","color","disableShrink","size","style","thickness","value","variant"];let _$2=a=>a,_t$1,_t2$1,_t3$1,_t4$1;const SIZE=44,circularRotateKeyframe=keyframes(_t$1||(_t$1=_$2`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),circularDashKeyframe=keyframes(_t2$1||(_t2$1=_$2`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),useUtilityClasses$9=a=>{const{classes:o,variant:_e,color:tt,disableShrink:at}=a,lt={root:["root",_e,`color${capitalize(tt)}`],svg:["svg"],circle:["circle",`circle${capitalize(_e)}`,at&&"circleDisableShrink"]};return composeClasses(lt,getCircularProgressUtilityClass,o)},CircularProgressRoot=styled$1("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],o[`color${capitalize(_e.color)}`]]}})(({ownerState:a,theme:o})=>_extends({display:"inline-block"},a.variant==="determinate"&&{transition:o.transitions.create("transform")},a.color!=="inherit"&&{color:(o.vars||o).palette[a.color].main}),({ownerState:a})=>a.variant==="indeterminate"&&css(_t3$1||(_t3$1=_$2`
      animation: ${0} 1.4s linear infinite;
    `),circularRotateKeyframe)),CircularProgressSVG=styled$1("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(a,o)=>o.svg})({display:"block"}),CircularProgressCircle=styled$1("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.circle,o[`circle${capitalize(_e.variant)}`],_e.disableShrink&&o.circleDisableShrink]}})(({ownerState:a,theme:o})=>_extends({stroke:"currentColor"},a.variant==="determinate"&&{transition:o.transitions.create("stroke-dashoffset")},a.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:a})=>a.variant==="indeterminate"&&!a.disableShrink&&css(_t4$1||(_t4$1=_$2`
      animation: ${0} 1.4s ease-in-out infinite;
    `),circularDashKeyframe)),CircularProgress=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiCircularProgress"}),{className:at,color:lt="primary",disableShrink:it=!1,size:ut=40,style:s,thickness:et=3.6,value:ot=0,variant:st="indeterminate"}=tt,Rt=_objectWithoutPropertiesLoose(tt,_excluded$9),ht=_extends({},tt,{color:lt,disableShrink:it,size:ut,thickness:et,value:ot,variant:st}),bt=useUtilityClasses$9(ht),ct={},mt={},rt={};if(st==="determinate"){const pt=2*Math.PI*((SIZE-et)/2);ct.strokeDasharray=pt.toFixed(3),rt["aria-valuenow"]=Math.round(ot),ct.strokeDashoffset=`${((100-ot)/100*pt).toFixed(3)}px`,mt.transform="rotate(-90deg)"}return jsxRuntimeExports.jsx(CircularProgressRoot,_extends({className:clsx(bt.root,at),style:_extends({width:ut,height:ut},mt,s),ownerState:ht,ref:_e,role:"progressbar"},rt,Rt,{children:jsxRuntimeExports.jsx(CircularProgressSVG,{className:bt.svg,ownerState:ht,viewBox:`${SIZE/2} ${SIZE/2} ${SIZE} ${SIZE}`,children:jsxRuntimeExports.jsx(CircularProgressCircle,{className:bt.circle,style:ct,ownerState:ht,cx:SIZE,cy:SIZE,r:(SIZE-et)/2,fill:"none",strokeWidth:et})})}))}),M=CircularProgress,CancelIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function getChipUtilityClass(a){return generateUtilityClass("MuiChip",a)}const chipClasses=generateUtilityClasses("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),chipClasses$1=chipClasses,_excluded$8=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],useUtilityClasses$8=a=>{const{classes:o,disabled:_e,size:tt,color:at,iconColor:lt,onDelete:it,clickable:ut,variant:s}=a,et={root:["root",s,_e&&"disabled",`size${capitalize(tt)}`,`color${capitalize(at)}`,ut&&"clickable",ut&&`clickableColor${capitalize(at)}`,it&&"deletable",it&&`deletableColor${capitalize(at)}`,`${s}${capitalize(at)}`],label:["label",`label${capitalize(tt)}`],avatar:["avatar",`avatar${capitalize(tt)}`,`avatarColor${capitalize(at)}`],icon:["icon",`icon${capitalize(tt)}`,`iconColor${capitalize(lt)}`],deleteIcon:["deleteIcon",`deleteIcon${capitalize(tt)}`,`deleteIconColor${capitalize(at)}`,`deleteIcon${capitalize(s)}Color${capitalize(at)}`]};return composeClasses(et,getChipUtilityClass,o)},ChipRoot=styled$1("div",{name:"MuiChip",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a,{color:tt,iconColor:at,clickable:lt,onDelete:it,size:ut,variant:s}=_e;return[{[`& .${chipClasses$1.avatar}`]:o.avatar},{[`& .${chipClasses$1.avatar}`]:o[`avatar${capitalize(ut)}`]},{[`& .${chipClasses$1.avatar}`]:o[`avatarColor${capitalize(tt)}`]},{[`& .${chipClasses$1.icon}`]:o.icon},{[`& .${chipClasses$1.icon}`]:o[`icon${capitalize(ut)}`]},{[`& .${chipClasses$1.icon}`]:o[`iconColor${capitalize(at)}`]},{[`& .${chipClasses$1.deleteIcon}`]:o.deleteIcon},{[`& .${chipClasses$1.deleteIcon}`]:o[`deleteIcon${capitalize(ut)}`]},{[`& .${chipClasses$1.deleteIcon}`]:o[`deleteIconColor${capitalize(tt)}`]},{[`& .${chipClasses$1.deleteIcon}`]:o[`deleteIcon${capitalize(s)}Color${capitalize(tt)}`]},o.root,o[`size${capitalize(ut)}`],o[`color${capitalize(tt)}`],lt&&o.clickable,lt&&tt!=="default"&&o[`clickableColor${capitalize(tt)})`],it&&o.deletable,it&&tt!=="default"&&o[`deletableColor${capitalize(tt)}`],o[s],o[`${s}${capitalize(tt)}`]]}})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light"?a.palette.grey[700]:a.palette.grey[300];return _extends({maxWidth:"100%",fontFamily:a.typography.fontFamily,fontSize:a.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(a.vars||a).palette.text.primary,backgroundColor:(a.vars||a).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:a.transitions.create(["background-color","box-shadow"]),cursor:"default",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${chipClasses$1.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${chipClasses$1.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:a.vars?a.vars.palette.Chip.defaultAvatarColor:_e,fontSize:a.typography.pxToRem(12)},[`& .${chipClasses$1.avatarColorPrimary}`]:{color:(a.vars||a).palette.primary.contrastText,backgroundColor:(a.vars||a).palette.primary.dark},[`& .${chipClasses$1.avatarColorSecondary}`]:{color:(a.vars||a).palette.secondary.contrastText,backgroundColor:(a.vars||a).palette.secondary.dark},[`& .${chipClasses$1.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:a.typography.pxToRem(10)},[`& .${chipClasses$1.icon}`]:_extends({marginLeft:5,marginRight:-6},o.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},o.iconColor===o.color&&_extends({color:a.vars?a.vars.palette.Chip.defaultIconColor:_e},o.color!=="default"&&{color:"inherit"})),[`& .${chipClasses$1.deleteIcon}`]:_extends({WebkitTapHighlightColor:"transparent",color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.26)`:alpha(a.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.4)`:alpha(a.palette.text.primary,.4)}},o.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},o.color!=="default"&&{color:a.vars?`rgba(${a.vars.palette[o.color].contrastTextChannel} / 0.7)`:alpha(a.palette[o.color].contrastText,.7),"&:hover, &:active":{color:(a.vars||a).palette[o.color].contrastText}})},o.size==="small"&&{height:24},o.color!=="default"&&{backgroundColor:(a.vars||a).palette[o.color].main,color:(a.vars||a).palette[o.color].contrastText},o.onDelete&&{[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},o.onDelete&&o.color!=="default"&&{[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette[o.color].dark}})},({theme:a,ownerState:o})=>_extends({},o.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity)},[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)},"&:active":{boxShadow:(a.vars||a).shadows[1]}},o.clickable&&o.color!=="default"&&{[`&:hover, &.${chipClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette[o.color].dark}}),({theme:a,ownerState:o})=>_extends({},o.variant==="outlined"&&{backgroundColor:"transparent",border:a.vars?`1px solid ${a.vars.palette.Chip.defaultBorder}`:`1px solid ${a.palette.mode==="light"?a.palette.grey[400]:a.palette.grey[700]}`,[`&.${chipClasses$1.clickable}:hover`]:{backgroundColor:(a.vars||a).palette.action.hover},[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`& .${chipClasses$1.avatar}`]:{marginLeft:4},[`& .${chipClasses$1.avatarSmall}`]:{marginLeft:2},[`& .${chipClasses$1.icon}`]:{marginLeft:4},[`& .${chipClasses$1.iconSmall}`]:{marginLeft:2},[`& .${chipClasses$1.deleteIcon}`]:{marginRight:5},[`& .${chipClasses$1.deleteIconSmall}`]:{marginRight:3}},o.variant==="outlined"&&o.color!=="default"&&{color:(a.vars||a).palette[o.color].main,border:`1px solid ${a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / 0.7)`:alpha(a.palette[o.color].main,.7)}`,[`&.${chipClasses$1.clickable}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette[o.color].main,a.palette.action.hoverOpacity)},[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.focusOpacity})`:alpha(a.palette[o.color].main,a.palette.action.focusOpacity)},[`& .${chipClasses$1.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / 0.7)`:alpha(a.palette[o.color].main,.7),"&:hover, &:active":{color:(a.vars||a).palette[o.color].main}}})),ChipLabel=styled$1("span",{name:"MuiChip",slot:"Label",overridesResolver:(a,o)=>{const{ownerState:_e}=a,{size:tt}=_e;return[o.label,o[`label${capitalize(tt)}`]]}})(({ownerState:a})=>_extends({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},a.size==="small"&&{paddingLeft:8,paddingRight:8}));function isDeleteKeyboardEvent(a){return a.key==="Backspace"||a.key==="Delete"}const Chip=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiChip"}),{avatar:at,className:lt,clickable:it,color:ut="default",component:s,deleteIcon:et,disabled:ot=!1,icon:st,label:Rt,onClick:ht,onDelete:bt,onKeyDown:ct,onKeyUp:mt,size:rt="medium",variant:pt="filled",tabIndex:ft,skipFocusWhenDisabled:St=!1}=tt,It=_objectWithoutPropertiesLoose(tt,_excluded$8),xt=reactExports.useRef(null),At=useForkRef(xt,_e),Dt=fn=>{fn.stopPropagation(),bt&&bt(fn)},wt=fn=>{fn.currentTarget===fn.target&&isDeleteKeyboardEvent(fn)&&fn.preventDefault(),ct&&ct(fn)},Mt=fn=>{fn.currentTarget===fn.target&&(bt&&isDeleteKeyboardEvent(fn)?bt(fn):fn.key==="Escape"&&xt.current&&xt.current.blur()),mt&&mt(fn)},vt=it!==!1&&ht?!0:it,Ft=vt||bt?ButtonBase$1:s||"div",Ht=_extends({},tt,{component:Ft,disabled:ot,size:rt,color:ut,iconColor:reactExports.isValidElement(st)&&st.props.color||ut,onDelete:!!bt,clickable:vt,variant:pt}),Wt=useUtilityClasses$8(Ht),tn=Ft===ButtonBase$1?_extends({component:s||"div",focusVisibleClassName:Wt.focusVisible},bt&&{disableRipple:!0}):{};let gn=null;bt&&(gn=et&&reactExports.isValidElement(et)?reactExports.cloneElement(et,{className:clsx(et.props.className,Wt.deleteIcon),onClick:Dt}):jsxRuntimeExports.jsx(CancelIcon,{className:clsx(Wt.deleteIcon),onClick:Dt}));let nn=null;at&&reactExports.isValidElement(at)&&(nn=reactExports.cloneElement(at,{className:clsx(Wt.avatar,at.props.className)}));let qt=null;return st&&reactExports.isValidElement(st)&&(qt=reactExports.cloneElement(st,{className:clsx(Wt.icon,st.props.className)})),jsxRuntimeExports.jsxs(ChipRoot,_extends({as:Ft,className:clsx(Wt.root,lt),disabled:vt&&ot?!0:void 0,onClick:ht,onKeyDown:wt,onKeyUp:Mt,ref:At,tabIndex:St&&ot?-1:ft,ownerState:Ht},tn,It,{children:[nn||qt,jsxRuntimeExports.jsx(ChipLabel,{className:clsx(Wt.label),ownerState:Ht,children:Rt}),gn]}))}),Chip$1=Chip,Stack=createStack({createStyledComponent:styled$1("div",{name:"MuiStack",slot:"Root",overridesResolver:(a,o)=>o.root}),useThemeProps:a=>useThemeProps({props:a,name:"MuiStack"})}),Stack$1=Stack;var y$1=function(){return y$1=Object.assign||function(a){for(var o,_e=1,tt=arguments.length;_e<tt;_e++)for(var at in o=arguments[_e])Object.prototype.hasOwnProperty.call(o,at)&&(a[at]=o[at]);return a},y$1.apply(this,arguments)};function x(a,o){var _e={};for(var tt in a)Object.prototype.hasOwnProperty.call(a,tt)&&o.indexOf(tt)<0&&(_e[tt]=a[tt]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function"){var at=0;for(tt=Object.getOwnPropertySymbols(a);at<tt.length;at++)o.indexOf(tt[at])<0&&Object.prototype.propertyIsEnumerable.call(a,tt[at])&&(_e[tt[at]]=a[tt[at]])}return _e}var S=function(a){var o=a.children,_e=x(a,["children"]),tt=reactExports.useMemo(function(){var it,ut=React.Children.toArray(o);return ut.length<=1?it={xs:12,sx:{height:{xs:"100%"}}}:ut.length<=2?it={xs:12,md:6,sx:{height:{xs:100/ut.length+"%",md:100/Math.ceil(ut.length/2)+"%"}}}:ut.length<=4?it={xs:12,sm:6,sx:{height:{xs:100/ut.length+"%",sm:100/Math.ceil(ut.length/2)+"%"}}}:ut.length<=6?it={xs:6,md:4,sx:{height:{xs:100/Math.ceil(ut.length/2)+"%",md:100/Math.ceil(ut.length/3)+"%"}}}:ut.length<=9?it={xs:6,sm:4,sx:{height:{xs:100/Math.ceil(ut.length/2)+"%",sm:100/Math.ceil(ut.length/3)+"%"}}}:ut.length<=12?it={xs:4,md:3,sx:{height:{xs:100/Math.ceil(ut.length/3)+"%",md:100/Math.ceil(ut.length/4)+"%"}}}:ut.length<=24?it={xs:4,sm:2,sx:{height:{xs:100/Math.ceil(ut.length/3)+"%",sm:100/Math.ceil(ut.length/6)+"%"}}}:ut.length<=42?it={xs:3,sm:2,sx:{height:{xs:100/Math.ceil(ut.length/4)+"%",sm:100/Math.ceil(ut.length/6)+"%"}}}:it={xs:2,lg:1,sx:{height:{xs:100/Math.ceil(ut.length/6)+"%",lg:100/Math.ceil(ut.length/12)+"%"}}},{arrayChildren:ut,responsive:it}},[o]),at=tt.arrayChildren,lt=tt.responsive;return React.createElement(d$1,y$1({container:!0,direction:"row",justifyContent:"space-around",alignItems:"center"},_e),React.Children.map(at,function(it,ut){return React.createElement(d$1,y$1({item:!0,key:ut,display:"flex",justifyContent:"center",alignItems:"center"},lt),it)}))};function w$1(a){var o=a.id,_e=o===void 0?"media-device-selector":o,tt=a.devices,at=a.selectedDevice,lt=a.setSelectedDevice,it=x(a,["id","devices","selectedDevice","setSelectedDevice"]),ut=Object.values(tt).map(function(s){return React.createElement(MenuItem$1,{key:s.getId(),value:s.getId()},s.getLabel())}).concat(React.createElement(MenuItem$1,{key:"default",value:"default"},"default"));return React.createElement(Select$1,y$1({id:_e,value:at?at.getId():"default",onChange:function(s){s.preventDefault(),globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug("MediaDeviceSelect|onSelectDevice",s.target.value),lt(tt[s.target.value])}},it),ut)}var O$1=reactExports.createContext({stream:void 0,muted:!1,toggleMuted:function(){}}),k="Audio";function I(a){var o;globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(k+"|Rendering");var _e=a.id,tt=_e===void 0?(o=a.stream)===null||o===void 0?void 0:o.getId():_e,at=a.autoPlay,lt=at===void 0||at,it=a.muted,ut=a.stream;a.sinkId;var s=x(a,["id","autoPlay","muted","stream","sinkId"]),et=reactExports.useContext(O$1),ot=et.stream,st=et.muted,Rt=st!==void 0&&st,ht=reactExports.useMemo(function(){return ut??ot},[ot,ut]),bt=reactExports.useMemo(function(){return it??Rt},[Rt,it]),ct=reactExports.useRef(null);return reactExports.useEffect(function(){var mt=ct==null?void 0:ct.current;if(ht&&mt)return globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(k+"|useEffect stream",mt,ht),ht.attachToElement(mt),function(){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(k+"|useEffect stream destroy"),mt.src=""}},[ht]),reactExports.useEffect(function(){var mt=ct==null?void 0:ct.current;mt&&a.sinkId&&mt.setSinkId&&mt.setSinkId(a.sinkId)},[a.sinkId]),React.createElement(Box$1,y$1({display:"flex",alignItems:"center",justifyContent:"center"},s),ht&&React.createElement(Icon$1,{fontSize:"large"},ht.isRemote?"headset_mic":"mic"),React.createElement("audio",{id:tt,ref:ct,autoPlay:lt,muted:bt}))}var z="AudioEnableButton";function F(a){var o,_e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(z)}),tt=_e.id,at=tt===void 0?"audio-enable-btn":tt,lt=_e.enabledTooltip,it=lt===void 0?"Audio enabled, click to disable":lt,ut=_e.disabledTooltip,s=ut===void 0?"Audio disabled, click to enable":ut,et=_e.noAudioTooltip,ot=et===void 0?"No Audio":et,st=_e.tooltipProps,Rt=st===void 0?{placement:"left",arrow:!0}:st,ht=x(_e,["id","enabledTooltip","disabledTooltip","noAudioTooltip","tooltipProps"]),bt=(o=_e["aria-label"])!==null&&o!==void 0?o:"enable or disable audio",ct=reactExports.useReducer(function(ft){return ft+1},0)[1],mt=reactExports.useContext(O$1).stream;reactExports.useEffect(function(){if(mt){var ft=function(St){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(z+"|onAudioFlowStatusChanged",mt,St,mt.isAudioEnabled()),ct()};return mt.on("audioFlowStatusChanged",ft),mt.on("remoteAudioFlowStatusChanged",ft),function(){mt.removeListener("audioFlowStatusChanged",ft),mt.removeListener("remoteAudioFlowStatusChanged",ft)}}},[mt]);var rt=function(){mt!=null&&mt.isAudioEnabled()?(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(z+"|stream.disableAudio",mt==null?void 0:mt.isAudioEnabled()),mt==null||mt.disableAudio(!0).catch(function(ft){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(z+"|stream.disableAudio failed",ft)})):(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(z+"|stream.enableAudio",mt==null?void 0:mt.isAudioEnabled()),mt==null||mt.enableAudio(!0).catch(function(ft){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(z+"|stream.enableAudio failed",ft)})),ct()},pt=mt&&mt.hasAudio()?mt.isAudioEnabled()?it:s:ot;return React.createElement(Tooltip$1,y$1({title:pt},Rt),React.createElement("span",null,React.createElement(IconButton$1,y$1({id:at,"aria-label":bt},ht,{disabled:_e.disabled||mt&&!mt.hasAudio(),onClick:function(ft){ft.preventDefault(),ft.stopPropagation(),rt()},onKeyDown:function(ft){ft.preventDefault(),ft.key!==" "||mt!=null&&mt.isAudioEnabled()||rt()},onKeyUp:function(ft){ft.preventDefault(),ft.key===" "&&(mt!=null&&mt.isAudioEnabled())&&rt()}}),mt&&mt.hasAudio()&&mt.isAudioEnabled()?React.createElement(Icon$1,{fontSize:_e.size},"mic"):React.createElement(Icon$1,{fontSize:_e.size},"mic_off"))))}var W="MuteButton";function j(a){var o;globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug("".concat(W,"|Rendering"));var _e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(W)}),tt=_e.id,at=tt===void 0?"mute-btn":tt,lt=_e.mutedTooltip,it=lt===void 0?"Muted":lt,ut=_e.unmutedTooltip,s=ut===void 0?"On":ut,et=_e.noAudioTooltip,ot=et===void 0?"No Audio":et,st=_e.tooltipProps,Rt=st===void 0?{placement:"left",arrow:!0}:st,ht=x(_e,["id","mutedTooltip","unmutedTooltip","noAudioTooltip","tooltipProps"]),bt=(o=_e["aria-label"])!==null&&o!==void 0?o:"mute",ct=reactExports.useContext(O$1),mt=ct.stream,rt=ct.muted,pt=ct.toggleMuted,ft=mt&&mt.hasAudio()?rt?it:s:ot,St=mt&&mt.hasAudio()?rt?React.createElement(Icon$1,{fontSize:_e.size},"volume_off"):React.createElement(Icon$1,{fontSize:_e.size},"volume_up"):React.createElement(Icon$1,{fontSize:_e.size},"volume_off");return React.createElement(Tooltip$1,y$1({title:ft},Rt),React.createElement("span",null,React.createElement(IconButton$1,y$1({id:at,"aria-label":bt},ht,{disabled:a.disabled||mt&&!mt.hasAudio(),onClick:function(It){It.preventDefault(),It.stopPropagation(),pt()}}),St)))}var _$1=function(a){var o=reactExports.useState(a),_e=o[0],tt=o[1],at=reactExports.useCallback(function(){tt(function(lt){return!lt})},[]);return reactExports.useEffect(function(){tt(a)},[a]),reactExports.useMemo(function(){return{value:_e,setValue:tt,toggle:at}},[_e,at])},H={border:1,borderColor:"primary.main"},q="Stream";function N$1(a){var o=a.id,_e=a.children,tt=a.controls,at=a.detectSpeaking,lt=at!==void 0&&at,it=a.muted,ut=it!==void 0&&it,s=a.name,et=a.nameColor,ot=et===void 0?void 0:et,st=a.stream,Rt=a.sx,ht=x(a,["id","children","controls","detectSpeaking","muted","name","nameColor","stream","sx"]);globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(q+"|Rendering");var bt=_$1(ut),ct=bt.value,mt=bt.toggle,rt=reactExports.useState(!1),pt=rt[0],ft=rt[1],St=reactExports.useRef(null),It=reactExports.useRef(null),xt=reactExports.useState({height:0,width:0}),At=xt[0],Dt=xt[1],wt=reactExports.useState({height:0,width:0}),Mt=wt[0],vt=wt[1];reactExports.useEffect(function(){if(st&&lt){var Ht=st,Wt=function(tn){ft(tn.isSpeaking)};return Ht.on("audioAmplitude",Wt),function(){Ht.removeListener("audioAmplitude",Wt)}}},[st,lt]),reactExports.useEffect(function(){var Ht=St.current;if(Ht){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(q+"|setSize",Ht.clientHeight,Ht.clientWidth),Dt({height:Ht.clientHeight,width:Ht.clientWidth});var Wt=new ResizeObserver(function(){Dt({height:Ht.clientHeight,width:Ht.clientWidth})});return Wt.observe(Ht),function(){Wt.disconnect()}}},[St]),reactExports.useEffect(function(){var Ht=It.current;if(Ht){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(q+"|setControlsSize",Ht.clientHeight,Ht.clientWidth),vt({height:Ht.clientHeight,width:Ht.clientWidth});var Wt=new ResizeObserver(function(){vt({height:Ht.clientHeight,width:Ht.clientWidth})});return Wt.observe(Ht),function(){Wt.disconnect()}}},[It]);var Ft=reactExports.useMemo(function(){return Math.max(Math.ceil(.01*At.width),4)},[At]);return React.createElement(O$1.Provider,{value:{stream:st,muted:ct,toggleMuted:mt}},React.createElement(Box$1,y$1({id:o,ref:St,sx:y$1(y$1(y$1({minHeight:Mt.height+2*Ft+(s?36:0),minWidth:tt?Math.max(2*Mt.width,40)+Ft:0},Rt),{position:"relative"}),pt&&H),display:"flex",justifyContent:"center",alignItems:"center"},ht),_e,s&&React.createElement(Chip$1,{sx:{position:"absolute",top:Ft,left:"50%",transform:"translate(-50%)",opacity:.9},label:s,color:ot}),React.createElement(Stack$1,{ref:It,sx:{position:"absolute",float:"right",bottom:Ft,right:Ft,opacity:.9}},tt)))}var J="Video";function U(a){var o,_e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(J)}),tt=_e.id,at=tt===void 0?(o=_e.stream)===null||o===void 0?void 0:o.getId():tt,lt=_e.sx,it=_e.style,ut=_e.autoPlay,s=ut===void 0||ut,et=_e.muted,ot=_e.pointer,st=_e.pointerColor,Rt=_e.progressColor,ht=_e.stream,bt=_e.sinkId,ct=_e.videoMutedTooltip,mt=ct===void 0?"Video muted":ct,rt=x(_e,["id","sx","style","autoPlay","muted","pointer","pointerColor","progressColor","stream","sinkId","videoMutedTooltip"]),pt=reactExports.useContext(O$1),ft=pt.stream,St=pt.muted,It=St!==void 0&&St,xt=reactExports.useMemo(function(){return ht??ft},[ft,ht]),At=reactExports.useMemo(function(){return et??It},[It,et]),Dt=reactExports.useRef(null),wt=reactExports.useState(!1),Mt=wt[0],vt=wt[1];return reactExports.useEffect(function(){var Ft=Dt==null?void 0:Dt.current;if(xt&&Ft){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(J+"|useEffect stream",Ft,xt),xt.attachToElement(Ft);var Ht=function(Wt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(J+"|onVideoFlowStatusChanged",xt,Wt),vt(Wt.muted)};return xt.on("videoFlowStatusChanged",Ht),xt.on("remoteVideoFlowStatusChanged",Ht),function(){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(J+"|useEffect stream destroy"),Ft.src="",xt.removeListener("audioFlowStatusChanged",Ht),xt.removeListener("remoteAudioFlowStatusChanged",Ht)}}},[xt]),reactExports.useEffect(function(){var Ft=Dt==null?void 0:Dt.current;Ft&&bt&&Ft.setSinkId&&Ft.setSinkId(bt)},[bt]),React.createElement(Box$1,y$1({sx:y$1(y$1({},lt),{position:"relative"})},rt),React.createElement("video",{id:at,ref:Dt,style:it,autoPlay:s,muted:At}),ot&&React.createElement(Icon$1,{sx:{position:"absolute",top:ot.top,left:ot.left,transform:"translate(-50%,-50%)",opacity:.9},color:st},"adjust"),Mt&&React.createElement(Tooltip$1,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",opacity:.9},title:mt},React.createElement(M,{color:Rt})))}var Q="VideoEnableButton";function X(a){var o,_e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(Q)}),tt=_e.id,at=tt===void 0?"video-enable-btn":tt,lt=_e.enabledTooltip,it=lt===void 0?"Video enabled, click to disable":lt,ut=_e.disabledTooltip,s=ut===void 0?"Video disabled, click to enable":ut,et=_e.noVideoTooltip,ot=et===void 0?"No Video":et,st=_e.tooltipProps,Rt=st===void 0?{placement:"left",arrow:!0}:st,ht=x(_e,["id","enabledTooltip","disabledTooltip","noVideoTooltip","tooltipProps"]),bt=(o=_e["aria-label"])!==null&&o!==void 0?o:"enable or disable video",ct=reactExports.useReducer(function(pt){return pt+1},0)[1],mt=reactExports.useContext(O$1).stream;reactExports.useEffect(function(){if(mt){var pt=function(ft){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Q+"|onVideoFlowStatusChanged",mt,ft,mt.isVideoEnabled()),ct()};return mt.on("videoFlowStatusChanged",pt),mt.on("remoteVideoFlowStatusChanged",pt),function(){mt.removeListener("videoFlowStatusChanged",pt),mt.removeListener("remoteVideoFlowStatusChanged",pt)}}},[mt]);var rt=mt&&mt.hasVideo()?mt.isVideoEnabled()?it:s:ot;return React.createElement(Tooltip$1,y$1({title:rt},Rt),React.createElement("span",null,React.createElement(IconButton$1,y$1({id:at,"aria-label":bt},ht,{disabled:_e.disabled||mt&&!mt.hasVideo(),onClick:function(pt){pt.preventDefault(),pt.stopPropagation(),mt!=null&&mt.isVideoEnabled()?(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Q+"|stream.disableVideo",mt==null?void 0:mt.isVideoEnabled()),mt==null||mt.disableVideo(!0).catch(function(ft){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(Q+"|stream.disableVideo failed",ft)})):(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Q+"|stream.enableVideo",mt==null?void 0:mt.isVideoEnabled()),mt==null||mt.enableVideo(!0).catch(function(ft){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(Q+"|stream.enableVideo failed",ft)})),ct()}}),mt&&mt.hasVideo()&&mt.isVideoEnabled()?React.createElement(Icon$1,{fontSize:_e.size},"videocam"):React.createElement(Icon$1,{fontSize:_e.size},"videocam_off"))))}var Y={components:{ApiRtcMuiReactLibAudioEnableButton:{defaultProps:{"aria-label":"activer ou désactiver l'audio",enabledTooltip:"Audio activé, cliquer pour désactiver",disabledTooltip:"Audio désactivé, cliquer pour activer",noAudioTooltip:"Pas d'audio"}},ApiRtcMuiReactLibMuteButton:{defaultProps:{"aria-label":"activer ou désactiver le son",mutedTooltip:"Son désactivé, cliquer pour activer",unmutedTooltip:"Son activé, cliquer pour désactiver",noAudioTooltip:"Pas d'audio"}},ApiRtcMuiReactLibPublishOptions:{defaultProps:{labelText:"Options de publication",audioAndVideoText:"Audio et Vidéo",audioOnlyText:"Audio seul",videoOnlyText:"Vidéo seule"}},ApiRtcMuiReactLibSnapshotButton:{defaultProps:{"aria-label":"photo",snapshotTooltip:"Prendre une photo"}},ApiRtcMuiReactLibTorchButton:{defaultProps:{"aria-label":"torche",torchOffTooltip:"Eteindre la torche",torchOnTooltip:"Allumer la torche"}},ApiRtcMuiReactLibVideo:{defaultProps:{videoMutedTooltip:"Vidéo coupée"}},ApiRtcMuiReactLibVideoEnableButton:{defaultProps:{"aria-label":"activer ou désactiver la vidéo",enabledTooltip:"Vidéo activée, cliquer pour désactiver",disabledTooltip:"Vidéo désactivée, cliquer pour activer",noVideoTooltip:"Pas de Vidéo"}}}},Z={level:"info",isDebugEnabled:!1,isInfoEnabled:!0,isWarnEnabled:!0};function $$1(a){switch(a){case"debug":globalThis.apirtcMuiReactLibLogLevel={level:"debug",isDebugEnabled:!0,isInfoEnabled:!0,isWarnEnabled:!0};break;case"info":default:globalThis.apirtcMuiReactLibLogLevel=Z;break;case"warn":globalThis.apirtcMuiReactLibLogLevel={level:"warn",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!0};break;case"error":globalThis.apirtcMuiReactLibLogLevel={level:"error",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!1}}return globalThis.apirtcMuiReactLibLogLevel}globalThis.apirtcMuiReactLibLogLevel=Z,globalThis.setApirtcMuiReactLibLogLevel=$$1;const c="useCameraStream";function b(a,o={},_e){const[tt,at]=reactExports.useState(),[lt,it]=reactExports.useState(!1);return reactExports.useEffect(()=>{if(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${c}|useEffect`,a,o),a){const ut=a.getUserAgent();it(!0),ut.createStream(o).then(s=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${c}|createStream`,o,s),at(s)}).catch(s=>{console.error(`${c}|createStream error`,o,s),at(void 0),_e&&_e(s)}).finally(()=>{it(!1)})}else at(void 0)},[a,JSON.stringify(o)]),reactExports.useEffect(()=>{const ut=tt;if(ut)return()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${c}|release stream`,ut),ut.release()}},[tt]),{stream:tt,grabbing:lt}}const g="useConversation";function d(a,o,_e,tt=!0,at){const[lt,it]=reactExports.useState(),[ut,s]=reactExports.useState(!1),[et,ot]=reactExports.useState(!1),st=reactExports.useCallback((ht={})=>(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(g+"|join",lt,ht),new Promise((bt,ct)=>{lt?lt.isJoined()?ct(g+"|join|conversation already joined"):(ot(!0),lt.join(ht).then(()=>{s(!0),bt()}).catch(mt=>{ct(mt)}).finally(()=>{ot(!1)})):ct(g+"|join|conversation not defined")})),[lt]),Rt=reactExports.useCallback(()=>(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(g+"|leave",lt),new Promise((ht,bt)=>{lt?lt.isJoined()?lt.leave().then(()=>{s(!1),ht()}).catch(ct=>{bt(ct)}):bt(g+"|leave|conversation is not joined"):bt(g+"|leave|conversation not defined")})),[lt]);return reactExports.useEffect(()=>{if(a&&o){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(g+"|getOrCreateConversation",o,_e,tt);const ht=a.getOrCreateConversation(o,_e);return it(ht),()=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(g+"|useEffect cleanup",o,_e,tt),ht.isJoined()?ht.leave().then(()=>{}).catch(bt=>{globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(g+"|useEffect conversation.leave()",bt)}).finally(()=>{ht.destroy()}):ht.destroy(),it(void 0),s(!1)}}},[a,o,JSON.stringify(_e)]),reactExports.useEffect(()=>{if(lt&&tt){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(g+"|useEffect",lt,tt,at);const ht=lt,bt=tt;return bt&&(ot(!0),ht.join(at).then(()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(g+"|joined",ht),s(!0)}).catch(ct=>{globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(g+"|useEffect conversation.join()",at,ct)}).finally(()=>{ot(!1)})),()=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(g+"|useEffect cleanup",ht,bt),ht.isJoined()&&ht.leave().then(()=>{s(!1)}).catch(ct=>{globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(g+"|useEffect conversation.leave()",ct)})}}},[lt,tt,JSON.stringify(at)]),{conversation:lt,joining:et,joined:ut,join:st,leave:Rt}}function v(a){return a!=null}const h="useConversationStreams";function m(a,o=[],_e){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|hook render|${a==null?void 0:a.getName()}`,o.map(ct=>ct==null?void 0:ct.options));const[tt]=reactExports.useState([]),[at]=reactExports.useState(new Array),[lt,it]=reactExports.useState(new Array),[ut]=reactExports.useState(new Array),[s,et]=reactExports.useState(new Array),ot=reactExports.useCallback((ct,mt)=>new Promise((rt,pt)=>{a&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|publish|${a.getName()}`,ct,mt),a.publish(ct,mt).then(ft=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|published|${a.getName()}`,ft),at.push(ft),it(Array.from(at)),rt(ft)}).catch(ft=>{pt(ft)}))}),[a]),st=reactExports.useCallback((ct,mt)=>new Promise((rt,pt)=>{if(a){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|replacePublishedStream|${a.getName()}|${ct.getId()} -> ${mt.getId()}`);const ft=a.getConversationCall(ct);ft&&ft.replacePublishedStream(mt).then(St=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|stream replaced|${a.getName()}`,ct,St);const It=at.indexOf(ct);It>=0&&(at.splice(It,1,St),it(Array.from(at))),rt(St)}).catch(St=>{pt(St)})}}),[a]),Rt=reactExports.useCallback(ct=>{if(a){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|unpublish|${a.getName()}`,ct.getId(),ct),a.unpublish(ct);const mt=at.indexOf(ct);mt>=0&&(at.splice(mt,1),it(Array.from(at)))}},[a]),ht=reactExports.useCallback(()=>{const ct=Math.max(tt.length,o.length);globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|doHandlePublication`,o,JSON.stringify(tt.map(St=>St==null?void 0:St.stream.getId())),JSON.stringify(o.map(St=>St==null?void 0:St.stream.getId())),ct);const mt=[...tt],rt=o.map(St=>St&&St.options?{stream:St.stream,options:Object.assign({},St.options)}:St);tt.length=0,tt.push(...rt);const pt=new Set(o.filter(v).map(St=>St.stream)),ft=(St,It)=>{ot(It.stream,It.options).catch(xt=>{tt.splice(St,1,null),_e?_e(xt):globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${h}|publish|error`,xt)})};for(let St=0;St<ct;St++){const It=mt[St],xt=o[St];if(It&&xt){const At=()=>{Rt(It.stream),ft(St,xt)};It.stream===xt.stream?JSON.stringify(It.options)!==JSON.stringify(xt.options)&&At():pt.has(It.stream)?a&&!a.isPublishedStream(xt.stream)&&ft(St,xt):a&&!a.isPublishedStream(xt.stream)?JSON.stringify(It.options)===JSON.stringify(xt.options)?st(It.stream,xt.stream).catch(Dt=>{tt.splice(St,1,null),_e?_e(Dt):globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${h}|replacePublishedStream|error`,Dt)}):At():Rt(It.stream)}else It&&!xt?pt.has(It.stream)||Rt(It.stream):!It&&xt&&a&&!a.isPublishedStream(xt.stream)&&ft(St,xt)}},[a,JSON.stringify(o.map(ct=>(ct==null?void 0:ct.stream.getId())+"-"+JSON.stringify(ct==null?void 0:ct.options))),ot,Rt,st]),bt=ct=>{at.forEach(mt=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|unpublish|${ct.getName()}`,mt),ct.unpublish(mt)}),at.length=0,tt.length=0,ut.forEach(mt=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|unsubscribeToStream|${ct.getName()}`,mt),ct.unsubscribeToStream(mt.getId())}),ut.length=0,it(new Array),et(new Array)};return reactExports.useEffect(()=>{if(a){const ct=pt=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|on_streamAdded|${a.getName()}`,pt),ut.push(pt),et(Array.from(ut))},mt=pt=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|on_streamRemoved|${a.getName()}`,pt);const ft=ut.indexOf(pt);ft>=0&&(ut.splice(ft,1),et(Array.from(ut)))},rt=pt=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|on_streamListChanged|${a.getName()}`,pt);const ft=String(pt.streamId);pt.isRemote===!0&&(pt.listEventType==="added"?a.subscribeToStream(ft):pt.listEventType==="removed"&&a.unsubscribeToStream(ft))};return a.on("streamAdded",ct),a.on("streamRemoved",mt),a.on("streamListChanged",rt),()=>{a.removeListener("streamListChanged",rt),a.removeListener("streamRemoved",mt),a.removeListener("streamAdded",ct),bt(a)}}},[a]),reactExports.useEffect(()=>{if(a){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|useEffect doHandlePublication|${a.getName()}`);const ct=()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|on_joined|${a.getName()}`,o),ht()},mt=()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|on_left|${a.getName()}`),bt(a)};return a.on("joined",ct),a.on("left",mt),a.isJoined()&&ht(),()=>{a.removeListener("joined",ct),a.removeListener("left",mt)}}},[ht]),{publishedStreams:lt,subscribedStreams:s,publish:ot,unpublish:Rt,replacePublishedStream:st}}const R="useSession";function y(a,o,_e){const[tt,at]=reactExports.useState(),[lt,it]=reactExports.useState(!1);reactExports.useEffect(()=>{if(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${R}|useEffect credentials, options`,a,o),a)return ut(a,o).catch(s=>{console.error(`${R}|connection failed`,s),at(void 0),_e?_e(s):globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${R}|connect|error`,s)}),()=>{at(void 0),it(!1)}},[JSON.stringify(a),JSON.stringify(o)]),reactExports.useEffect(()=>{if(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${R}|useEffect session`,tt),tt){const s=tt;return()=>{s.disconnect().then(()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${R}|disconnected`,s)}).catch(et=>{console.error(`${R}|disconnect`,et)})}}},[tt]);const ut=(s,et)=>new Promise((ot,st)=>{const Rt=et||{cloudUrl:"https://cloud.apirtc.com"};let ht;if(typeof(bt=s)=="object"&&"username"in bt)Rt.password=s.password,ht=new apiRTC_minExports.UserAgent({uri:"apirtc:"+s.username});else if(function(ct){return typeof ct=="object"&&"apiKey"in ct}(s))ht=new apiRTC_minExports.UserAgent({uri:`apiKey:${s.apiKey}`});else{if(!function(ct){return typeof ct=="object"&&"token"in ct}(s))return void st("credentials not recognized");ht=new apiRTC_minExports.UserAgent({uri:`token:${s.token}`})}var bt;it(!0),ht.register(Rt).then(ct=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${R}|connected`,ct),at(ct),ot()}).catch(ct=>{st(ct)}).finally(()=>{it(!1)})});return{session:tt,connecting:lt,connect:ut,disconnect:()=>{at(void 0)}}}const $="useUserMediaDevices",w=a=>{try{const o=localStorage.getItem(a),_e=o?JSON.parse(o):null;return _e?new apiRTC_minExports.MediaDevice(_e.id,_e.type,_e.label):void 0}catch(o){return void console.warn($+"|getMediaDeviceFromLocalStorage",o)}},D=(a,o)=>{try{localStorage.setItem(a,o)}catch{}};function N(a,o="apirtc"){const _e=o+".audioIn",tt=o+".audioOut",at=o+".videoIn",[lt,it]=reactExports.useState(w(_e)),[ut,s]=reactExports.useState(w(tt)),[et,ot]=reactExports.useState(w(at)),st=reactExports.useMemo(()=>({audioinput:lt?{[lt.getId()]:lt}:{},audiooutput:ut?{[ut.getId()]:ut}:{},videoinput:et?{[et.getId()]:et}:{}}),[lt,ut,et]),[Rt,ht]=reactExports.useState(st);return reactExports.useEffect(()=>{if(a){const bt=a.getUserAgent(),ct=()=>{const mt=bt.getUserMediaDevices();globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${$}|mediaDeviceChanged`,mt),ht(mt);const rt=w(_e);rt&&it(mt.audioinput[rt.getId()]);const pt=w(tt);pt&&s(mt.audiooutput[pt.getId()]);const ft=w(at);ft&&ot(mt.videoinput[ft.getId()]),globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${$}|userMediaDevices, audioIn, audioOut, videoIn`,mt,rt==null?void 0:rt.getId(),pt==null?void 0:pt.getId(),ft==null?void 0:ft.getId())};return bt.on("mediaDeviceChanged",ct),()=>{bt.removeListener("mediaDeviceChanged",ct),ht(st)}}},[a]),reactExports.useEffect(()=>{lt&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${$}|Storing audioIn`,lt),D(_e,JSON.stringify({id:lt.getId(),type:lt.getType(),label:lt.getLabel()})))},[lt==null?void 0:lt.getId()]),reactExports.useEffect(()=>{ut&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${$}|Storing audioOut`,ut),D(tt,JSON.stringify({id:ut.getId(),type:ut.getType(),label:ut.getLabel()})))},[ut==null?void 0:ut.getId()]),reactExports.useEffect(()=>{et&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${$}|Storing videoIn`,et),D(at,JSON.stringify({id:et.getId(),type:et.getType(),label:et.getLabel()})))},[et==null?void 0:et.getId()]),{userMediaDevices:Rt,selectedAudioIn:lt,setSelectedAudioIn:it,selectedAudioOut:ut,setSelectedAudioOut:s,selectedVideoIn:et,setSelectedVideoIn:ot}}const O={level:"info",isDebugEnabled:!1,isInfoEnabled:!0,isWarnEnabled:!0};function A(a){switch(a){case"debug":globalThis.apirtcReactLibLogLevel={level:"debug",isDebugEnabled:!0,isInfoEnabled:!0,isWarnEnabled:!0};break;case"info":default:globalThis.apirtcReactLibLogLevel=O;break;case"warn":globalThis.apirtcReactLibLogLevel={level:"warn",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!0};break;case"error":globalThis.apirtcReactLibLogLevel={level:"error",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!1}}return globalThis.apirtcReactLibLogLevel}globalThis.apirtcReactLibLogLevel=O,globalThis.setApirtcReactLibLogLevel=A;function getAlertUtilityClass(a){return generateUtilityClass("MuiAlert",a)}const alertClasses=generateUtilityClasses("MuiAlert",["root","action","icon","message","filled","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),alertClasses$1=alertClasses,SuccessOutlinedIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),ReportProblemOutlinedIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),ErrorOutlineIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),InfoOutlinedIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),ClearIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),_excluded$7=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],useUtilityClasses$7=a=>{const{variant:o,color:_e,severity:tt,classes:at}=a,lt={root:["root",`${o}${capitalize(_e||tt)}`,`${o}`],icon:["icon"],message:["message"],action:["action"]};return composeClasses(lt,getAlertUtilityClass,at)},AlertRoot=styled$1(Paper$1,{name:"MuiAlert",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],o[`${_e.variant}${capitalize(_e.color||_e.severity)}`]]}})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light"?darken:lighten,tt=a.palette.mode==="light"?lighten:darken,at=o.color||o.severity;return _extends({},a.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},at&&o.variant==="standard"&&{color:a.vars?a.vars.palette.Alert[`${at}Color`]:_e(a.palette[at].light,.6),backgroundColor:a.vars?a.vars.palette.Alert[`${at}StandardBg`]:tt(a.palette[at].light,.9),[`& .${alertClasses$1.icon}`]:a.vars?{color:a.vars.palette.Alert[`${at}IconColor`]}:{color:a.palette[at].main}},at&&o.variant==="outlined"&&{color:a.vars?a.vars.palette.Alert[`${at}Color`]:_e(a.palette[at].light,.6),border:`1px solid ${(a.vars||a).palette[at].light}`,[`& .${alertClasses$1.icon}`]:a.vars?{color:a.vars.palette.Alert[`${at}IconColor`]}:{color:a.palette[at].main}},at&&o.variant==="filled"&&_extends({fontWeight:a.typography.fontWeightMedium},a.vars?{color:a.vars.palette.Alert[`${at}FilledColor`],backgroundColor:a.vars.palette.Alert[`${at}FilledBg`]}:{backgroundColor:a.palette.mode==="dark"?a.palette[at].dark:a.palette[at].main,color:a.palette.getContrastText(a.palette[at].main)}))}),AlertIcon=styled$1("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(a,o)=>o.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),AlertMessage=styled$1("div",{name:"MuiAlert",slot:"Message",overridesResolver:(a,o)=>o.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),AlertAction=styled$1("div",{name:"MuiAlert",slot:"Action",overridesResolver:(a,o)=>o.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),defaultIconMapping={success:jsxRuntimeExports.jsx(SuccessOutlinedIcon,{fontSize:"inherit"}),warning:jsxRuntimeExports.jsx(ReportProblemOutlinedIcon,{fontSize:"inherit"}),error:jsxRuntimeExports.jsx(ErrorOutlineIcon,{fontSize:"inherit"}),info:jsxRuntimeExports.jsx(InfoOutlinedIcon,{fontSize:"inherit"})},Alert=reactExports.forwardRef(function(o,_e){var tt,at,lt,it,ut,s;const et=useThemeProps({props:o,name:"MuiAlert"}),{action:ot,children:st,className:Rt,closeText:ht="Close",color:bt,components:ct={},componentsProps:mt={},icon:rt,iconMapping:pt=defaultIconMapping,onClose:ft,role:St="alert",severity:It="success",slotProps:xt={},slots:At={},variant:Dt="standard"}=et,wt=_objectWithoutPropertiesLoose(et,_excluded$7),Mt=_extends({},et,{color:bt,severity:It,variant:Dt}),vt=useUtilityClasses$7(Mt),Ft=(tt=(at=At.closeButton)!=null?at:ct.CloseButton)!=null?tt:IconButton$1,Ht=(lt=(it=At.closeIcon)!=null?it:ct.CloseIcon)!=null?lt:ClearIcon,Wt=(ut=xt.closeButton)!=null?ut:mt.closeButton,tn=(s=xt.closeIcon)!=null?s:mt.closeIcon;return jsxRuntimeExports.jsxs(AlertRoot,_extends({role:St,elevation:0,ownerState:Mt,className:clsx(vt.root,Rt),ref:_e},wt,{children:[rt!==!1?jsxRuntimeExports.jsx(AlertIcon,{ownerState:Mt,className:vt.icon,children:rt||pt[It]||defaultIconMapping[It]}):null,jsxRuntimeExports.jsx(AlertMessage,{ownerState:Mt,className:vt.message,children:st}),ot!=null?jsxRuntimeExports.jsx(AlertAction,{ownerState:Mt,className:vt.action,children:ot}):null,ot==null&&ft?jsxRuntimeExports.jsx(AlertAction,{ownerState:Mt,className:vt.action,children:jsxRuntimeExports.jsx(Ft,_extends({size:"small","aria-label":ht,title:ht,color:"inherit",onClick:ft},Wt,{children:jsxRuntimeExports.jsx(Ht,_extends({fontSize:"small"},tn))}))}):null]}))}),Alert$1=Alert;function getButtonUtilityClass(a){return generateUtilityClass("MuiButton",a)}const buttonClasses=generateUtilityClasses("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),buttonClasses$1=buttonClasses,ButtonGroupContext=reactExports.createContext({}),ButtonGroupContext$1=ButtonGroupContext,_excluded$6=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],useUtilityClasses$6=a=>{const{color:o,disableElevation:_e,fullWidth:tt,size:at,variant:lt,classes:it}=a,ut={root:["root",lt,`${lt}${capitalize(o)}`,`size${capitalize(at)}`,`${lt}Size${capitalize(at)}`,o==="inherit"&&"colorInherit",_e&&"disableElevation",tt&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${capitalize(at)}`],endIcon:["endIcon",`iconSize${capitalize(at)}`]},s=composeClasses(ut,getButtonUtilityClass,it);return _extends({},it,s)},commonIconStyles=a=>_extends({},a.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},a.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},a.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),ButtonRoot=styled$1(ButtonBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiButton",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],o[`${_e.variant}${capitalize(_e.color)}`],o[`size${capitalize(_e.size)}`],o[`${_e.variant}Size${capitalize(_e.size)}`],_e.color==="inherit"&&o.colorInherit,_e.disableElevation&&o.disableElevation,_e.fullWidth&&o.fullWidth]}})(({theme:a,ownerState:o})=>{var _e,tt;const at=a.palette.mode==="light"?a.palette.grey[300]:a.palette.grey[800],lt=a.palette.mode==="light"?a.palette.grey.A100:a.palette.grey[700];return _extends({},a.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create(["background-color","box-shadow","border-color","color"],{duration:a.transitions.duration.short}),"&:hover":_extends({textDecoration:"none",backgroundColor:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette.text.primary,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},o.variant==="text"&&o.color!=="inherit"&&{backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette[o.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},o.variant==="outlined"&&o.color!=="inherit"&&{border:`1px solid ${(a.vars||a).palette[o.color].main}`,backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette[o.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},o.variant==="contained"&&{backgroundColor:a.vars?a.vars.palette.Button.inheritContainedHoverBg:lt,boxShadow:(a.vars||a).shadows[4],"@media (hover: none)":{boxShadow:(a.vars||a).shadows[2],backgroundColor:(a.vars||a).palette.grey[300]}},o.variant==="contained"&&o.color!=="inherit"&&{backgroundColor:(a.vars||a).palette[o.color].dark,"@media (hover: none)":{backgroundColor:(a.vars||a).palette[o.color].main}}),"&:active":_extends({},o.variant==="contained"&&{boxShadow:(a.vars||a).shadows[8]}),[`&.${buttonClasses$1.focusVisible}`]:_extends({},o.variant==="contained"&&{boxShadow:(a.vars||a).shadows[6]}),[`&.${buttonClasses$1.disabled}`]:_extends({color:(a.vars||a).palette.action.disabled},o.variant==="outlined"&&{border:`1px solid ${(a.vars||a).palette.action.disabledBackground}`},o.variant==="contained"&&{color:(a.vars||a).palette.action.disabled,boxShadow:(a.vars||a).shadows[0],backgroundColor:(a.vars||a).palette.action.disabledBackground})},o.variant==="text"&&{padding:"6px 8px"},o.variant==="text"&&o.color!=="inherit"&&{color:(a.vars||a).palette[o.color].main},o.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},o.variant==="outlined"&&o.color!=="inherit"&&{color:(a.vars||a).palette[o.color].main,border:a.vars?`1px solid rgba(${a.vars.palette[o.color].mainChannel} / 0.5)`:`1px solid ${alpha(a.palette[o.color].main,.5)}`},o.variant==="contained"&&{color:a.vars?a.vars.palette.text.primary:(_e=(tt=a.palette).getContrastText)==null?void 0:_e.call(tt,a.palette.grey[300]),backgroundColor:a.vars?a.vars.palette.Button.inheritContainedBg:at,boxShadow:(a.vars||a).shadows[2]},o.variant==="contained"&&o.color!=="inherit"&&{color:(a.vars||a).palette[o.color].contrastText,backgroundColor:(a.vars||a).palette[o.color].main},o.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},o.size==="small"&&o.variant==="text"&&{padding:"4px 5px",fontSize:a.typography.pxToRem(13)},o.size==="large"&&o.variant==="text"&&{padding:"8px 11px",fontSize:a.typography.pxToRem(15)},o.size==="small"&&o.variant==="outlined"&&{padding:"3px 9px",fontSize:a.typography.pxToRem(13)},o.size==="large"&&o.variant==="outlined"&&{padding:"7px 21px",fontSize:a.typography.pxToRem(15)},o.size==="small"&&o.variant==="contained"&&{padding:"4px 10px",fontSize:a.typography.pxToRem(13)},o.size==="large"&&o.variant==="contained"&&{padding:"8px 22px",fontSize:a.typography.pxToRem(15)},o.fullWidth&&{width:"100%"})},({ownerState:a})=>a.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${buttonClasses$1.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${buttonClasses$1.disabled}`]:{boxShadow:"none"}}),ButtonStartIcon=styled$1("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.startIcon,o[`iconSize${capitalize(_e.size)}`]]}})(({ownerState:a})=>_extends({display:"inherit",marginRight:8,marginLeft:-4},a.size==="small"&&{marginLeft:-2},commonIconStyles(a))),ButtonEndIcon=styled$1("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.endIcon,o[`iconSize${capitalize(_e.size)}`]]}})(({ownerState:a})=>_extends({display:"inherit",marginRight:-4,marginLeft:8},a.size==="small"&&{marginRight:-2},commonIconStyles(a))),Button=reactExports.forwardRef(function(o,_e){const tt=reactExports.useContext(ButtonGroupContext$1),at=resolveProps(tt,o),lt=useThemeProps({props:at,name:"MuiButton"}),{children:it,color:ut="primary",component:s="button",className:et,disabled:ot=!1,disableElevation:st=!1,disableFocusRipple:Rt=!1,endIcon:ht,focusVisibleClassName:bt,fullWidth:ct=!1,size:mt="medium",startIcon:rt,type:pt,variant:ft="text"}=lt,St=_objectWithoutPropertiesLoose(lt,_excluded$6),It=_extends({},lt,{color:ut,component:s,disabled:ot,disableElevation:st,disableFocusRipple:Rt,fullWidth:ct,size:mt,type:pt,variant:ft}),xt=useUtilityClasses$6(It),At=rt&&jsxRuntimeExports.jsx(ButtonStartIcon,{className:xt.startIcon,ownerState:It,children:rt}),Dt=ht&&jsxRuntimeExports.jsx(ButtonEndIcon,{className:xt.endIcon,ownerState:It,children:ht});return jsxRuntimeExports.jsxs(ButtonRoot,_extends({ownerState:It,className:clsx(tt.className,xt.root,et),component:s,disabled:ot,focusRipple:!Rt,focusVisibleClassName:clsx(xt.focusVisible,bt),ref:_e,type:pt},St,{classes:xt,children:[At,it,Dt]}))}),Button$1=Button;function getCardUtilityClass(a){return generateUtilityClass("MuiCard",a)}generateUtilityClasses("MuiCard",["root"]);const _excluded$5=["className","raised"],useUtilityClasses$5=a=>{const{classes:o}=a;return composeClasses({root:["root"]},getCardUtilityClass,o)},CardRoot=styled$1(Paper$1,{name:"MuiCard",slot:"Root",overridesResolver:(a,o)=>o.root})(()=>({overflow:"hidden"})),Card=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiCard"}),{className:at,raised:lt=!1}=tt,it=_objectWithoutPropertiesLoose(tt,_excluded$5),ut=_extends({},tt,{raised:lt}),s=useUtilityClasses$5(ut);return jsxRuntimeExports.jsx(CardRoot,_extends({className:clsx(s.root,at),elevation:lt?8:void 0,ref:_e,ownerState:ut},it))}),Card$1=Card;function getCardContentUtilityClass(a){return generateUtilityClass("MuiCardContent",a)}generateUtilityClasses("MuiCardContent",["root"]);const _excluded$4=["className","component"],useUtilityClasses$4=a=>{const{classes:o}=a;return composeClasses({root:["root"]},getCardContentUtilityClass,o)},CardContentRoot=styled$1("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(a,o)=>o.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),CardContent=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiCardContent"}),{className:at,component:lt="div"}=tt,it=_objectWithoutPropertiesLoose(tt,_excluded$4),ut=_extends({},tt,{component:lt}),s=useUtilityClasses$4(ut);return jsxRuntimeExports.jsx(CardContentRoot,_extends({as:lt,className:clsx(s.root,at),ownerState:ut,ref:_e},it))}),CardContent$1=CardContent,Container=createContainer({createStyledComponent:styled$1("div",{name:"MuiContainer",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[`maxWidth${capitalize(String(_e.maxWidth))}`],_e.fixed&&o.fixed,_e.disableGutters&&o.disableGutters]}}),useThemeProps:a=>useThemeProps({props:a,name:"MuiContainer"})}),Container$1=Container;function getSkeletonUtilityClass(a){return generateUtilityClass("MuiSkeleton",a)}generateUtilityClasses("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const _excluded$3=["animation","className","component","height","style","variant","width"];let _=a=>a,_t,_t2,_t3,_t4;const useUtilityClasses$3=a=>{const{classes:o,variant:_e,animation:tt,hasChildren:at,width:lt,height:it}=a;return composeClasses({root:["root",_e,tt,at&&"withChildren",at&&!lt&&"fitContent",at&&!it&&"heightAuto"]},getSkeletonUtilityClass,o)},pulseKeyframe=keyframes(_t||(_t=_`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`)),waveKeyframe=keyframes(_t2||(_t2=_`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`)),SkeletonRoot=styled$1("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],_e.animation!==!1&&o[_e.animation],_e.hasChildren&&o.withChildren,_e.hasChildren&&!_e.width&&o.fitContent,_e.hasChildren&&!_e.height&&o.heightAuto]}})(({theme:a,ownerState:o})=>{const _e=getUnit(a.shape.borderRadius)||"px",tt=toUnitless(a.shape.borderRadius);return _extends({display:"block",backgroundColor:a.vars?a.vars.palette.Skeleton.bg:alpha(a.palette.text.primary,a.palette.mode==="light"?.11:.13),height:"1.2em"},o.variant==="text"&&{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${tt}${_e}/${Math.round(tt/.6*10)/10}${_e}`,"&:empty:before":{content:'"\\00a0"'}},o.variant==="circular"&&{borderRadius:"50%"},o.variant==="rounded"&&{borderRadius:(a.vars||a).shape.borderRadius},o.hasChildren&&{"& > *":{visibility:"hidden"}},o.hasChildren&&!o.width&&{maxWidth:"fit-content"},o.hasChildren&&!o.height&&{height:"auto"})},({ownerState:a})=>a.animation==="pulse"&&css(_t3||(_t3=_`
      animation: ${0} 1.5s ease-in-out 0.5s infinite;
    `),pulseKeyframe),({ownerState:a,theme:o})=>a.animation==="wave"&&css(_t4||(_t4=_`
      position: relative;
      overflow: hidden;

      /* Fix bug in Safari https://bugs.webkit.org/show_bug.cgi?id=68196 */
      -webkit-mask-image: -webkit-radial-gradient(white, black);

      &::after {
        animation: ${0} 1.6s linear 0.5s infinite;
        background: linear-gradient(
          90deg,
          transparent,
          ${0},
          transparent
        );
        content: '';
        position: absolute;
        transform: translateX(-100%); /* Avoid flash during server-side hydration */
        bottom: 0;
        left: 0;
        right: 0;
        top: 0;
      }
    `),waveKeyframe,(o.vars||o).palette.action.hover)),Skeleton=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiSkeleton"}),{animation:at="pulse",className:lt,component:it="span",height:ut,style:s,variant:et="text",width:ot}=tt,st=_objectWithoutPropertiesLoose(tt,_excluded$3),Rt=_extends({},tt,{animation:at,component:it,variant:et,hasChildren:!!st.children}),ht=useUtilityClasses$3(Rt);return jsxRuntimeExports.jsx(SkeletonRoot,_extends({as:it,ref:_e,className:clsx(ht.root,lt),ownerState:Rt},st,{style:_extends({width:ot,height:ut},s)}))}),Skeleton$1=Skeleton,StepperContext=reactExports.createContext({}),StepperContext$1=StepperContext,StepContext=reactExports.createContext({}),StepContext$1=StepContext;function getStepUtilityClass(a){return generateUtilityClass("MuiStep",a)}generateUtilityClasses("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const _excluded$2=["active","children","className","component","completed","disabled","expanded","index","last"],useUtilityClasses$2=a=>{const{classes:o,orientation:_e,alternativeLabel:tt,completed:at}=a;return composeClasses({root:["root",_e,tt&&"alternativeLabel",at&&"completed"]},getStepUtilityClass,o)},StepRoot=styled$1("div",{name:"MuiStep",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.orientation],_e.alternativeLabel&&o.alternativeLabel,_e.completed&&o.completed]}})(({ownerState:a})=>_extends({},a.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},a.alternativeLabel&&{flex:1,position:"relative"})),Step=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiStep"}),{active:at,children:lt,className:it,component:ut="div",completed:s,disabled:et,expanded:ot=!1,index:st,last:Rt}=tt,ht=_objectWithoutPropertiesLoose(tt,_excluded$2),{activeStep:bt,connector:ct,alternativeLabel:mt,orientation:rt,nonLinear:pt}=reactExports.useContext(StepperContext$1);let[ft=!1,St=!1,It=!1]=[at,s,et];bt===st?ft=at!==void 0?at:!0:!pt&&bt>st?St=s!==void 0?s:!0:!pt&&bt<st&&(It=et!==void 0?et:!0);const xt=reactExports.useMemo(()=>({index:st,last:Rt,expanded:ot,icon:st+1,active:ft,completed:St,disabled:It}),[st,Rt,ot,ft,St,It]),At=_extends({},tt,{active:ft,orientation:rt,alternativeLabel:mt,completed:St,disabled:It,expanded:ot,component:ut}),Dt=useUtilityClasses$2(At),wt=jsxRuntimeExports.jsxs(StepRoot,_extends({as:ut,className:clsx(Dt.root,it),ref:_e,ownerState:At},ht,{children:[ct&&mt&&st!==0?ct:null,lt]}));return jsxRuntimeExports.jsx(StepContext$1.Provider,{value:xt,children:ct&&!mt&&st!==0?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[ct,wt]}):wt})}),Step$1=Step;function getLinkUtilityClass(a){return generateUtilityClass("MuiLink",a)}const linkClasses=generateUtilityClasses("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),linkClasses$1=linkClasses,colorTransformations={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},transformDeprecatedColors=a=>colorTransformations[a]||a,getTextDecoration=({theme:a,ownerState:o})=>{const _e=transformDeprecatedColors(o.color),tt=getPath(a,`palette.${_e}`,!1)||o.color,at=getPath(a,`palette.${_e}Channel`);return"vars"in a&&at?`rgba(${at} / 0.4)`:alpha(tt,.4)},getTextDecoration$1=getTextDecoration,_excluded$1=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],useUtilityClasses$1=a=>{const{classes:o,component:_e,focusVisible:tt,underline:at}=a,lt={root:["root",`underline${capitalize(at)}`,_e==="button"&&"button",tt&&"focusVisible"]};return composeClasses(lt,getLinkUtilityClass,o)},LinkRoot=styled$1(Typography$1,{name:"MuiLink",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[`underline${capitalize(_e.underline)}`],_e.component==="button"&&o.button]}})(({theme:a,ownerState:o})=>_extends({},o.underline==="none"&&{textDecoration:"none"},o.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},o.underline==="always"&&_extends({textDecoration:"underline"},o.color!=="inherit"&&{textDecorationColor:getTextDecoration$1({theme:a,ownerState:o})},{"&:hover":{textDecorationColor:"inherit"}}),o.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${linkClasses$1.focusVisible}`]:{outline:"auto"}})),Link=reactExports.forwardRef(function(o,_e){const tt=useThemeProps({props:o,name:"MuiLink"}),{className:at,color:lt="primary",component:it="a",onBlur:ut,onFocus:s,TypographyClasses:et,underline:ot="always",variant:st="inherit",sx:Rt}=tt,ht=_objectWithoutPropertiesLoose(tt,_excluded$1),{isFocusVisibleRef:bt,onBlur:ct,onFocus:mt,ref:rt}=useIsFocusVisible(),[pt,ft]=reactExports.useState(!1),St=useForkRef(_e,rt),It=wt=>{ct(wt),bt.current===!1&&ft(!1),ut&&ut(wt)},xt=wt=>{mt(wt),bt.current===!0&&ft(!0),s&&s(wt)},At=_extends({},tt,{color:lt,component:it,focusVisible:pt,underline:ot,variant:st}),Dt=useUtilityClasses$1(At);return jsxRuntimeExports.jsx(LinkRoot,_extends({color:lt,className:clsx(Dt.root,at),classes:et,component:it,onBlur:It,onFocus:xt,ref:St,ownerState:At,variant:st,sx:[...Object.keys(colorTransformations).includes(lt)?[]:[{color:lt}],...Array.isArray(Rt)?Rt:[Rt]]},ht))}),Link$1=Link,CheckBoxOutlineBlankIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),CheckBoxIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),IndeterminateCheckBoxIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function getCheckboxUtilityClass(a){return generateUtilityClass("MuiCheckbox",a)}const checkboxClasses=generateUtilityClasses("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary"]),checkboxClasses$1=checkboxClasses,_excluded=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],useUtilityClasses=a=>{const{classes:o,indeterminate:_e,color:tt}=a,at={root:["root",_e&&"indeterminate",`color${capitalize(tt)}`]},lt=composeClasses(at,getCheckboxUtilityClass,o);return _extends({},o,lt)},CheckboxRoot=styled$1(SwitchBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.indeterminate&&o.indeterminate,_e.color!=="default"&&o[`color${capitalize(_e.color)}`]]}})(({theme:a,ownerState:o})=>_extends({color:(a.vars||a).palette.text.secondary},!o.disableRipple&&{"&:hover":{backgroundColor:a.vars?`rgba(${o.color==="default"?a.vars.palette.action.activeChannel:a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(o.color==="default"?a.palette.action.active:a.palette[o.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.color!=="default"&&{[`&.${checkboxClasses$1.checked}, &.${checkboxClasses$1.indeterminate}`]:{color:(a.vars||a).palette[o.color].main},[`&.${checkboxClasses$1.disabled}`]:{color:(a.vars||a).palette.action.disabled}})),defaultCheckedIcon=jsxRuntimeExports.jsx(CheckBoxIcon,{}),defaultIcon=jsxRuntimeExports.jsx(CheckBoxOutlineBlankIcon,{}),defaultIndeterminateIcon=jsxRuntimeExports.jsx(IndeterminateCheckBoxIcon,{}),Checkbox=reactExports.forwardRef(function(o,_e){var tt,at;const lt=useThemeProps({props:o,name:"MuiCheckbox"}),{checkedIcon:it=defaultCheckedIcon,color:ut="primary",icon:s=defaultIcon,indeterminate:et=!1,indeterminateIcon:ot=defaultIndeterminateIcon,inputProps:st,size:Rt="medium",className:ht}=lt,bt=_objectWithoutPropertiesLoose(lt,_excluded),ct=et?ot:s,mt=et?ot:it,rt=_extends({},lt,{color:ut,indeterminate:et,size:Rt}),pt=useUtilityClasses(rt);return jsxRuntimeExports.jsx(CheckboxRoot,_extends({type:"checkbox",inputProps:_extends({"data-indeterminate":et},st),icon:reactExports.cloneElement(ct,{fontSize:(tt=ct.props.fontSize)!=null?tt:Rt}),checkedIcon:reactExports.cloneElement(mt,{fontSize:(at=mt.props.fontSize)!=null?at:Rt}),ownerState:rt,ref:_e,className:clsx(pt.root,ht)},bt,{classes:pt}))}),Checkbox$1=Checkbox,OptIn=({id:a,checked:o,labels:_e,link:tt,onChange:at})=>jsxRuntimeExports.jsx(FormControlLabel$1,{required:!0,control:jsxRuntimeExports.jsx(Checkbox$1,{id:`${a}`,"data-testid":`${a}`,checked:o,onChange:()=>at(a),inputProps:{"aria-label":_e.aria}}),label:jsxRuntimeExports.jsxs(Typography$1,{variant:"body1",component:"span",children:[_e.prefix,jsxRuntimeExports.jsx(Link$1,{target:"_blank",href:tt,color:"info.main",children:_e.link})]}),sx:{".MuiFormControlLabel-asterisk":{display:"none"}}}),OptInList=({labels:a,optIns:o,onSubmit:_e})=>{const[tt,at]=reactExports.useState(Object.assign({},...o.map(it=>({[it.id]:!1})))),lt=it=>{at({...tt,[it]:!tt[it]})};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(FormGroup$1,{children:o.map(it=>jsxRuntimeExports.jsx(OptIn,{id:it.id,checked:tt[it.id],onChange:lt,labels:it.labels,link:it.link},it.id))}),jsxRuntimeExports.jsx(Box$1,{sx:{display:"flex",justifyContent:"end",mt:1},children:jsxRuntimeExports.jsx(Button$1,{variant:"outlined",disabled:!Object.values(tt).every(it=>it),onClick:_e,children:a.submit})})]})},TextStepper=({activeStep:a,children:o,header:_e,sx:tt={}})=>jsxRuntimeExports.jsxs(Box$1,{sx:{...tt},children:[jsxRuntimeExports.jsxs(Box$1,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[_e,jsxRuntimeExports.jsxs(Typography$1,{sx:{fontWeight:500},children:[a+1,"/",React.Children.toArray(o).length]})]}),jsxRuntimeExports.jsx(Box$1,{sx:{padding:"16px 16px 0 16px"},children:React.Children.toArray(o)[a]})]}),ErrorPage=({errorType:a})=>{let o="An error occurred";switch(a){case 404:o="Invitation not found";break;case 500:o="Internal server error";break;case 401:o="You're not auhorized to join";break;default:o="An error occurred";break}return jsxRuntimeExports.jsx(Container$1,{maxWidth:"sm",sx:{height:"100vh"},children:jsxRuntimeExports.jsx(Box$1,{sx:{height:"100%"},display:"flex",alignItems:"center",justifyContent:"center",children:jsxRuntimeExports.jsx(Card$1,{children:jsxRuntimeExports.jsx(CardContent$1,{children:jsxRuntimeExports.jsx(Box$1,{children:jsxRuntimeExports.jsx(Typography$1,{variant:"h4",children:o})})})})})})},App$1="",logo="/assets/apizee-6b3e8e8d.svg";var base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(a){var o=a.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _e=a.indexOf("=");_e===-1&&(_e=o);var tt=_e===o?0:4-_e%4;return[_e,tt]}function byteLength(a){var o=getLens(a),_e=o[0],tt=o[1];return(_e+tt)*3/4-tt}function _byteLength(a,o,_e){return(o+_e)*3/4-_e}function toByteArray(a){var o,_e=getLens(a),tt=_e[0],at=_e[1],lt=new Arr(_byteLength(a,tt,at)),it=0,ut=at>0?tt-4:tt,s;for(s=0;s<ut;s+=4)o=revLookup[a.charCodeAt(s)]<<18|revLookup[a.charCodeAt(s+1)]<<12|revLookup[a.charCodeAt(s+2)]<<6|revLookup[a.charCodeAt(s+3)],lt[it++]=o>>16&255,lt[it++]=o>>8&255,lt[it++]=o&255;return at===2&&(o=revLookup[a.charCodeAt(s)]<<2|revLookup[a.charCodeAt(s+1)]>>4,lt[it++]=o&255),at===1&&(o=revLookup[a.charCodeAt(s)]<<10|revLookup[a.charCodeAt(s+1)]<<4|revLookup[a.charCodeAt(s+2)]>>2,lt[it++]=o>>8&255,lt[it++]=o&255),lt}function tripletToBase64(a){return lookup[a>>18&63]+lookup[a>>12&63]+lookup[a>>6&63]+lookup[a&63]}function encodeChunk(a,o,_e){for(var tt,at=[],lt=o;lt<_e;lt+=3)tt=(a[lt]<<16&16711680)+(a[lt+1]<<8&65280)+(a[lt+2]&255),at.push(tripletToBase64(tt));return at.join("")}function fromByteArray(a){for(var o,_e=a.length,tt=_e%3,at=[],lt=16383,it=0,ut=_e-tt;it<ut;it+=lt)at.push(encodeChunk(a,it,it+lt>ut?ut:it+lt));return tt===1?(o=a[_e-1],at.push(lookup[o>>2]+lookup[o<<4&63]+"==")):tt===2&&(o=(a[_e-2]<<8)+a[_e-1],at.push(lookup[o>>10]+lookup[o>>4&63]+lookup[o<<2&63]+"=")),at.join("")}var sha256$1={exports:{}};/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */(function(module){(function(){var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&!0&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(a){return typeof a=="object"&&a.buffer&&a.buffer.constructor===ArrayBuffer});var createOutputMethod=function(a,o){return function(_e){return new Sha256(o,!0).update(_e)[a]()}},createMethod=function(a){var o=createOutputMethod("hex",a);NODE_JS&&(o=nodeWrap(o,a)),o.create=function(){return new Sha256(a)},o.update=function(at){return o.create().update(at)};for(var _e=0;_e<OUTPUT_TYPES.length;++_e){var tt=OUTPUT_TYPES[_e];o[tt]=createOutputMethod(tt,a)}return o},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(a){if(typeof a=="string")return crypto.createHash(algorithm).update(a,"utf8").digest("hex");if(a==null)throw new Error(ERROR);return a.constructor===ArrayBuffer&&(a=new Uint8Array(a)),Array.isArray(a)||ArrayBuffer.isView(a)||a.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(a)).digest("hex"):method(a)};return nodeMethod},createHmacOutputMethod=function(a,o){return function(_e,tt){return new HmacSha256(_e,o,!0).update(tt)[a]()}},createHmacMethod=function(a){var o=createHmacOutputMethod("hex",a);o.create=function(at){return new HmacSha256(at,a)},o.update=function(at,lt){return o.create(at).update(lt)};for(var _e=0;_e<OUTPUT_TYPES.length;++_e){var tt=OUTPUT_TYPES[_e];o[tt]=createHmacOutputMethod(tt,a)}return o};function Sha256(a,o){o?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=a}Sha256.prototype.update=function(a){if(!this.finalized){var o,_e=typeof a;if(_e!=="string"){if(_e==="object"){if(a===null)throw new Error(ERROR);if(ARRAY_BUFFER&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!Array.isArray(a)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(a)))throw new Error(ERROR)}else throw new Error(ERROR);o=!0}for(var tt,at=0,lt,it=a.length,ut=this.blocks;at<it;){if(this.hashed&&(this.hashed=!1,ut[0]=this.block,ut[16]=ut[1]=ut[2]=ut[3]=ut[4]=ut[5]=ut[6]=ut[7]=ut[8]=ut[9]=ut[10]=ut[11]=ut[12]=ut[13]=ut[14]=ut[15]=0),o)for(lt=this.start;at<it&&lt<64;++at)ut[lt>>2]|=a[at]<<SHIFT[lt++&3];else for(lt=this.start;at<it&&lt<64;++at)tt=a.charCodeAt(at),tt<128?ut[lt>>2]|=tt<<SHIFT[lt++&3]:tt<2048?(ut[lt>>2]|=(192|tt>>6)<<SHIFT[lt++&3],ut[lt>>2]|=(128|tt&63)<<SHIFT[lt++&3]):tt<55296||tt>=57344?(ut[lt>>2]|=(224|tt>>12)<<SHIFT[lt++&3],ut[lt>>2]|=(128|tt>>6&63)<<SHIFT[lt++&3],ut[lt>>2]|=(128|tt&63)<<SHIFT[lt++&3]):(tt=65536+((tt&1023)<<10|a.charCodeAt(++at)&1023),ut[lt>>2]|=(240|tt>>18)<<SHIFT[lt++&3],ut[lt>>2]|=(128|tt>>12&63)<<SHIFT[lt++&3],ut[lt>>2]|=(128|tt>>6&63)<<SHIFT[lt++&3],ut[lt>>2]|=(128|tt&63)<<SHIFT[lt++&3]);this.lastByteIndex=lt,this.bytes+=lt-this.start,lt>=64?(this.block=ut[16],this.start=lt-64,this.hash(),this.hashed=!0):this.start=lt}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,o=this.lastByteIndex;a[16]=this.block,a[o>>2]|=EXTRA[o&3],this.block=a[16],o>=56&&(this.hashed||this.hash(),a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),a[14]=this.hBytes<<3|this.bytes>>>29,a[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var a=this.h0,o=this.h1,_e=this.h2,tt=this.h3,at=this.h4,lt=this.h5,it=this.h6,ut=this.h7,s=this.blocks,et,ot,st,Rt,ht,bt,ct,mt,rt,pt,ft;for(et=16;et<64;++et)ht=s[et-15],ot=(ht>>>7|ht<<25)^(ht>>>18|ht<<14)^ht>>>3,ht=s[et-2],st=(ht>>>17|ht<<15)^(ht>>>19|ht<<13)^ht>>>10,s[et]=s[et-16]+ot+s[et-7]+st<<0;for(ft=o&_e,et=0;et<64;et+=4)this.first?(this.is224?(mt=300032,ht=s[0]-1413257819,ut=ht-150054599<<0,tt=ht+24177077<<0):(mt=704751109,ht=s[0]-210244248,ut=ht-1521486534<<0,tt=ht+143694565<<0),this.first=!1):(ot=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),st=(at>>>6|at<<26)^(at>>>11|at<<21)^(at>>>25|at<<7),mt=a&o,Rt=mt^a&_e^ft,ct=at&lt^~at&it,ht=ut+st+ct+K[et]+s[et],bt=ot+Rt,ut=tt+ht<<0,tt=ht+bt<<0),ot=(tt>>>2|tt<<30)^(tt>>>13|tt<<19)^(tt>>>22|tt<<10),st=(ut>>>6|ut<<26)^(ut>>>11|ut<<21)^(ut>>>25|ut<<7),rt=tt&a,Rt=rt^tt&o^mt,ct=ut&at^~ut&lt,ht=it+st+ct+K[et+1]+s[et+1],bt=ot+Rt,it=_e+ht<<0,_e=ht+bt<<0,ot=(_e>>>2|_e<<30)^(_e>>>13|_e<<19)^(_e>>>22|_e<<10),st=(it>>>6|it<<26)^(it>>>11|it<<21)^(it>>>25|it<<7),pt=_e&tt,Rt=pt^_e&a^rt,ct=it&ut^~it&at,ht=lt+st+ct+K[et+2]+s[et+2],bt=ot+Rt,lt=o+ht<<0,o=ht+bt<<0,ot=(o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10),st=(lt>>>6|lt<<26)^(lt>>>11|lt<<21)^(lt>>>25|lt<<7),ft=o&_e,Rt=ft^o&tt^pt,ct=lt&it^~lt&ut,ht=at+st+ct+K[et+3]+s[et+3],bt=ot+Rt,at=a+ht<<0,a=ht+bt<<0;this.h0=this.h0+a<<0,this.h1=this.h1+o<<0,this.h2=this.h2+_e<<0,this.h3=this.h3+tt<<0,this.h4=this.h4+at<<0,this.h5=this.h5+lt<<0,this.h6=this.h6+it<<0,this.h7=this.h7+ut<<0},Sha256.prototype.hex=function(){this.finalize();var a=this.h0,o=this.h1,_e=this.h2,tt=this.h3,at=this.h4,lt=this.h5,it=this.h6,ut=this.h7,s=HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15]+HEX_CHARS[_e>>28&15]+HEX_CHARS[_e>>24&15]+HEX_CHARS[_e>>20&15]+HEX_CHARS[_e>>16&15]+HEX_CHARS[_e>>12&15]+HEX_CHARS[_e>>8&15]+HEX_CHARS[_e>>4&15]+HEX_CHARS[_e&15]+HEX_CHARS[tt>>28&15]+HEX_CHARS[tt>>24&15]+HEX_CHARS[tt>>20&15]+HEX_CHARS[tt>>16&15]+HEX_CHARS[tt>>12&15]+HEX_CHARS[tt>>8&15]+HEX_CHARS[tt>>4&15]+HEX_CHARS[tt&15]+HEX_CHARS[at>>28&15]+HEX_CHARS[at>>24&15]+HEX_CHARS[at>>20&15]+HEX_CHARS[at>>16&15]+HEX_CHARS[at>>12&15]+HEX_CHARS[at>>8&15]+HEX_CHARS[at>>4&15]+HEX_CHARS[at&15]+HEX_CHARS[lt>>28&15]+HEX_CHARS[lt>>24&15]+HEX_CHARS[lt>>20&15]+HEX_CHARS[lt>>16&15]+HEX_CHARS[lt>>12&15]+HEX_CHARS[lt>>8&15]+HEX_CHARS[lt>>4&15]+HEX_CHARS[lt&15]+HEX_CHARS[it>>28&15]+HEX_CHARS[it>>24&15]+HEX_CHARS[it>>20&15]+HEX_CHARS[it>>16&15]+HEX_CHARS[it>>12&15]+HEX_CHARS[it>>8&15]+HEX_CHARS[it>>4&15]+HEX_CHARS[it&15];return this.is224||(s+=HEX_CHARS[ut>>28&15]+HEX_CHARS[ut>>24&15]+HEX_CHARS[ut>>20&15]+HEX_CHARS[ut>>16&15]+HEX_CHARS[ut>>12&15]+HEX_CHARS[ut>>8&15]+HEX_CHARS[ut>>4&15]+HEX_CHARS[ut&15]),s},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var a=this.h0,o=this.h1,_e=this.h2,tt=this.h3,at=this.h4,lt=this.h5,it=this.h6,ut=this.h7,s=[a>>24&255,a>>16&255,a>>8&255,a&255,o>>24&255,o>>16&255,o>>8&255,o&255,_e>>24&255,_e>>16&255,_e>>8&255,_e&255,tt>>24&255,tt>>16&255,tt>>8&255,tt&255,at>>24&255,at>>16&255,at>>8&255,at&255,lt>>24&255,lt>>16&255,lt>>8&255,lt&255,it>>24&255,it>>16&255,it>>8&255,it&255];return this.is224||s.push(ut>>24&255,ut>>16&255,ut>>8&255,ut&255),s},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(this.is224?28:32),o=new DataView(a);return o.setUint32(0,this.h0),o.setUint32(4,this.h1),o.setUint32(8,this.h2),o.setUint32(12,this.h3),o.setUint32(16,this.h4),o.setUint32(20,this.h5),o.setUint32(24,this.h6),this.is224||o.setUint32(28,this.h7),a};function HmacSha256(a,o,_e){var tt,at=typeof a;if(at==="string"){var lt=[],it=a.length,ut=0,s;for(tt=0;tt<it;++tt)s=a.charCodeAt(tt),s<128?lt[ut++]=s:s<2048?(lt[ut++]=192|s>>6,lt[ut++]=128|s&63):s<55296||s>=57344?(lt[ut++]=224|s>>12,lt[ut++]=128|s>>6&63,lt[ut++]=128|s&63):(s=65536+((s&1023)<<10|a.charCodeAt(++tt)&1023),lt[ut++]=240|s>>18,lt[ut++]=128|s>>12&63,lt[ut++]=128|s>>6&63,lt[ut++]=128|s&63);a=lt}else if(at==="object"){if(a===null)throw new Error(ERROR);if(ARRAY_BUFFER&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!Array.isArray(a)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(a)))throw new Error(ERROR)}else throw new Error(ERROR);a.length>64&&(a=new Sha256(o,!0).update(a).array());var et=[],ot=[];for(tt=0;tt<64;++tt){var st=a[tt]||0;et[tt]=92^st,ot[tt]=54^st}Sha256.call(this,o,_e),this.update(ot),this.oKeyPad=et,this.inner=!0,this.sharedMemory=_e}HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var a=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(a),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()})(sha256$1);var sha256Exports=sha256$1.exports;const sha256=getDefaultExportFromCjs(sha256Exports);if(typeof Promise>"u")throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");var loggedPromiseDeprecation=!1;function logPromiseDeprecation(){loggedPromiseDeprecation||(loggedPromiseDeprecation=!0,console.warn("[KEYCLOAK] Usage of legacy style promise methods such as `.error()` and `.success()` has been deprecated and support will be removed in future versions. Use standard style promise methods such as `.then() and `.catch()` instead."))}function Keycloak(a){if(!(this instanceof Keycloak))return new Keycloak(a);for(var o=this,_e,tt=[],at,lt={enable:!0,callbackList:[],interval:5},it=document.getElementsByTagName("script"),ut=0;ut<it.length;ut++)(it[ut].src.indexOf("keycloak.js")!==-1||it[ut].src.indexOf("keycloak.min.js")!==-1)&&it[ut].src.indexOf("version=")!==-1&&(o.iframeVersion=it[ut].src.substring(it[ut].src.indexOf("version=")+8).split("&")[0]);var s=!0,et=Tn(console.info),ot=Tn(console.warn);o.init=function(un){o.authenticated=!1,at=Cn();var mn=["default","cordova","cordova-native"];if(un&&mn.indexOf(un.adapter)>-1?_e=nn(un.adapter):un&&typeof un.adapter=="object"?_e=un.adapter:window.Cordova||window.cordova?_e=nn("cordova"):_e=nn(),un){if(typeof un.useNonce<"u"&&(s=un.useNonce),typeof un.checkLoginIframe<"u"&&(lt.enable=un.checkLoginIframe),un.checkLoginIframeInterval&&(lt.interval=un.checkLoginIframeInterval),un.onLoad==="login-required"&&(o.loginRequired=!0),un.responseMode)if(un.responseMode==="query"||un.responseMode==="fragment")o.responseMode=un.responseMode;else throw"Invalid value for responseMode";if(un.flow){switch(un.flow){case"standard":o.responseType="code";break;case"implicit":o.responseType="id_token token";break;case"hybrid":o.responseType="code id_token token";break;default:throw"Invalid value for flow"}o.flow=un.flow}if(un.timeSkew!=null&&(o.timeSkew=un.timeSkew),un.redirectUri&&(o.redirectUri=un.redirectUri),un.silentCheckSsoRedirectUri&&(o.silentCheckSsoRedirectUri=un.silentCheckSsoRedirectUri),typeof un.silentCheckSsoFallback=="boolean"?o.silentCheckSsoFallback=un.silentCheckSsoFallback:o.silentCheckSsoFallback=!0,un.pkceMethod){if(un.pkceMethod!=="S256")throw"Invalid value for pkceMethod";o.pkceMethod=un.pkceMethod}typeof un.enableLogging=="boolean"?o.enableLogging=un.enableLogging:o.enableLogging=!1,typeof un.scope=="string"&&(o.scope=un.scope),typeof un.messageReceiveTimeout=="number"&&un.messageReceiveTimeout>0?o.messageReceiveTimeout=un.messageReceiveTimeout:o.messageReceiveTimeout=1e4}o.responseMode||(o.responseMode="fragment"),o.responseType||(o.responseType="code",o.flow="standard");var yn=vt(),pn=vt();pn.promise.then(function(){o.onReady&&o.onReady(o.authenticated),yn.setSuccess(o.authenticated)}).catch(function(Pn){yn.setError(Pn)});var In=ft();function kn(){var Pn=function(Fn){Fn||(Dn.prompt="none"),o.login(Dn).then(function(){pn.setSuccess()}).catch(function(dr){pn.setError(dr)})},On=function(){var Fn=document.createElement("iframe"),dr=o.createLoginUrl({prompt:"none",redirectUri:o.silentCheckSsoRedirectUri});Fn.setAttribute("src",dr),Fn.setAttribute("title","keycloak-silent-check-sso"),Fn.style.display="none",document.body.appendChild(Fn);var ir=function(Xn){if(!(Xn.origin!==window.location.origin||Fn.contentWindow!==Xn.source)){var tr=Dt(Xn.data);pt(tr,pn),document.body.removeChild(Fn),window.removeEventListener("message",ir)}};window.addEventListener("message",ir)},Dn={};switch(un.onLoad){case"check-sso":lt.enable?Ht().then(function(){tn().then(function(Fn){Fn?pn.setSuccess():o.silentCheckSsoRedirectUri?On():Pn(!1)}).catch(function(Fn){pn.setError(Fn)})}):o.silentCheckSsoRedirectUri?On():Pn(!1);break;case"login-required":Pn(!0);break;default:throw"Invalid value for onLoad"}}function Mn(){var Pn=Dt(window.location.href);if(Pn&&window.history.replaceState(window.history.state,null,Pn.newUrl),Pn&&Pn.valid)return Ht().then(function(){pt(Pn,pn)}).catch(function(On){pn.setError(On)});un?un.token&&un.refreshToken?(It(un.token,un.refreshToken,un.idToken),lt.enable?Ht().then(function(){tn().then(function(On){On?(o.onAuthSuccess&&o.onAuthSuccess(),pn.setSuccess(),Wt()):pn.setSuccess()}).catch(function(On){pn.setError(On)})}):o.updateToken(-1).then(function(){o.onAuthSuccess&&o.onAuthSuccess(),pn.setSuccess()}).catch(function(On){o.onAuthError&&o.onAuthError(),un.onLoad?kn():pn.setError(On)})):un.onLoad?kn():pn.setSuccess():pn.setSuccess()}function xn(){var Pn=vt(),On=function(){(document.readyState==="interactive"||document.readyState==="complete")&&(document.removeEventListener("readystatechange",On),Pn.setSuccess())};return document.addEventListener("readystatechange",On),On(),Pn.promise}return In.then(function(){xn().then(gn).then(Mn).catch(function(Pn){yn.setError(Pn)})}),In.catch(function(Pn){yn.setError(Pn)}),yn.promise},o.login=function(un){return _e.login(un)};function st(un){var mn=null,yn=window.crypto||window.msCrypto;if(yn&&yn.getRandomValues&&window.Uint8Array)return mn=new Uint8Array(un),yn.getRandomValues(mn),mn;mn=new Array(un);for(var pn=0;pn<mn.length;pn++)mn[pn]=Math.floor(256*Math.random());return mn}function Rt(un){return ht(un,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}function ht(un,mn){for(var yn=st(un),pn=new Array(un),In=0;In<un;In++)pn[In]=mn.charCodeAt(yn[In]%mn.length);return String.fromCharCode.apply(null,pn)}function bt(un,mn){switch(un){case"S256":var yn=new Uint8Array(sha256.arrayBuffer(mn)),pn=base64Js.fromByteArray(yn).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return pn;default:throw"Invalid value for pkceMethod"}}function ct(un){var mn={id_token:{acr:un}};return JSON.stringify(mn)}o.createLoginUrl=function(un){var mn=At(),yn=At(),pn=_e.redirectUri(un),In={state:mn,nonce:yn,redirectUri:encodeURIComponent(pn)};un&&un.prompt&&(In.prompt=un.prompt);var kn;un&&un.action=="register"?kn=o.endpoints.register():kn=o.endpoints.authorize();var Mn=un&&un.scope||o.scope;Mn?Mn.indexOf("openid")===-1&&(Mn="openid "+Mn):Mn="openid";var xn=kn+"?client_id="+encodeURIComponent(o.clientId)+"&redirect_uri="+encodeURIComponent(pn)+"&state="+encodeURIComponent(mn)+"&response_mode="+encodeURIComponent(o.responseMode)+"&response_type="+encodeURIComponent(o.responseType)+"&scope="+encodeURIComponent(Mn);if(s&&(xn=xn+"&nonce="+encodeURIComponent(yn)),un&&un.prompt&&(xn+="&prompt="+encodeURIComponent(un.prompt)),un&&un.maxAge&&(xn+="&max_age="+encodeURIComponent(un.maxAge)),un&&un.loginHint&&(xn+="&login_hint="+encodeURIComponent(un.loginHint)),un&&un.idpHint&&(xn+="&kc_idp_hint="+encodeURIComponent(un.idpHint)),un&&un.action&&un.action!="register"&&(xn+="&kc_action="+encodeURIComponent(un.action)),un&&un.locale&&(xn+="&ui_locales="+encodeURIComponent(un.locale)),un&&un.acr){var Pn=ct(un.acr);xn+="&claims="+encodeURIComponent(Pn)}if(o.pkceMethod){var On=Rt(96);In.pkceCodeVerifier=On;var Dn=bt(o.pkceMethod,On);xn+="&code_challenge="+Dn,xn+="&code_challenge_method="+o.pkceMethod}return at.add(In),xn},o.logout=function(un){return _e.logout(un)},o.createLogoutUrl=function(un){var mn=o.endpoints.logout()+"?post_logout_redirect_uri="+encodeURIComponent(_e.redirectUri(un,!1))+"&id_token_hint="+encodeURIComponent(o.idToken);return mn},o.register=function(un){return _e.register(un)},o.createRegisterUrl=function(un){return un||(un={}),un.action="register",o.createLoginUrl(un)},o.createAccountUrl=function(un){var mn=mt(),yn=void 0;return typeof mn<"u"&&(yn=mn+"/account?referrer="+encodeURIComponent(o.clientId)+"&referrer_uri="+encodeURIComponent(_e.redirectUri(un))),yn},o.accountManagement=function(){return _e.accountManagement()},o.hasRealmRole=function(un){var mn=o.realmAccess;return!!mn&&mn.roles.indexOf(un)>=0},o.hasResourceRole=function(un,mn){if(!o.resourceAccess)return!1;var yn=o.resourceAccess[mn||o.clientId];return!!yn&&yn.roles.indexOf(un)>=0},o.loadUserProfile=function(){var un=mt()+"/account",mn=new XMLHttpRequest;mn.open("GET",un,!0),mn.setRequestHeader("Accept","application/json"),mn.setRequestHeader("Authorization","bearer "+o.token);var yn=vt();return mn.onreadystatechange=function(){mn.readyState==4&&(mn.status==200?(o.profile=JSON.parse(mn.responseText),yn.setSuccess(o.profile)):yn.setError())},mn.send(),yn.promise},o.loadUserInfo=function(){var un=o.endpoints.userinfo(),mn=new XMLHttpRequest;mn.open("GET",un,!0),mn.setRequestHeader("Accept","application/json"),mn.setRequestHeader("Authorization","bearer "+o.token);var yn=vt();return mn.onreadystatechange=function(){mn.readyState==4&&(mn.status==200?(o.userInfo=JSON.parse(mn.responseText),yn.setSuccess(o.userInfo)):yn.setError())},mn.send(),yn.promise},o.isTokenExpired=function(un){if(!o.tokenParsed||!o.refreshToken&&o.flow!="implicit")throw"Not authenticated";if(o.timeSkew==null)return et("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var mn=o.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+o.timeSkew;if(un){if(isNaN(un))throw"Invalid minValidity";mn-=un}return mn<0},o.updateToken=function(un){var mn=vt();if(!o.refreshToken)return mn.setError(),mn.promise;un=un||5;var yn=function(){var In=!1;if(un==-1?(In=!0,et("[KEYCLOAK] Refreshing token: forced refresh")):(!o.tokenParsed||o.isTokenExpired(un))&&(In=!0,et("[KEYCLOAK] Refreshing token: token expired")),!In)mn.setSuccess(!1);else{var kn="grant_type=refresh_token&refresh_token="+o.refreshToken,Mn=o.endpoints.token();if(tt.push(mn),tt.length==1){var xn=new XMLHttpRequest;xn.open("POST",Mn,!0),xn.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xn.withCredentials=!0,kn+="&client_id="+encodeURIComponent(o.clientId);var Pn=new Date().getTime();xn.onreadystatechange=function(){if(xn.readyState==4)if(xn.status==200){et("[KEYCLOAK] Token refreshed"),Pn=(Pn+new Date().getTime())/2;var On=JSON.parse(xn.responseText);It(On.access_token,On.refresh_token,On.id_token,Pn),o.onAuthRefreshSuccess&&o.onAuthRefreshSuccess();for(var Dn=tt.pop();Dn!=null;Dn=tt.pop())Dn.setSuccess(!0)}else{ot("[KEYCLOAK] Failed to refresh token"),xn.status==400&&o.clearToken(),o.onAuthRefreshError&&o.onAuthRefreshError();for(var Dn=tt.pop();Dn!=null;Dn=tt.pop())Dn.setError(!0)}},xn.send(kn)}}};if(lt.enable){var pn=tn();pn.then(function(){yn()}).catch(function(In){mn.setError(In)})}else yn();return mn.promise},o.clearToken=function(){o.token&&(It(null,null,null),o.onAuthLogout&&o.onAuthLogout(),o.loginRequired&&o.login())};function mt(){if(typeof o.authServerUrl<"u")return o.authServerUrl.charAt(o.authServerUrl.length-1)=="/"?o.authServerUrl+"realms/"+encodeURIComponent(o.realm):o.authServerUrl+"/realms/"+encodeURIComponent(o.realm)}function rt(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function pt(un,mn){var yn=un.code,pn=un.error,In=un.prompt,kn=new Date().getTime();if(un.kc_action_status&&o.onActionUpdate&&o.onActionUpdate(un.kc_action_status),pn){if(In!="none"){var Mn={error:pn,error_description:un.error_description};o.onAuthError&&o.onAuthError(Mn),mn&&mn.setError(Mn)}else mn&&mn.setSuccess();return}else o.flow!="standard"&&(un.access_token||un.id_token)&&Dn(un.access_token,null,un.id_token,!0);if(o.flow!="implicit"&&yn){var xn="code="+yn+"&grant_type=authorization_code",Pn=o.endpoints.token(),On=new XMLHttpRequest;On.open("POST",Pn,!0),On.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xn+="&client_id="+encodeURIComponent(o.clientId),xn+="&redirect_uri="+un.redirectUri,un.pkceCodeVerifier&&(xn+="&code_verifier="+un.pkceCodeVerifier),On.withCredentials=!0,On.onreadystatechange=function(){if(On.readyState==4)if(On.status==200){var Fn=JSON.parse(On.responseText);Dn(Fn.access_token,Fn.refresh_token,Fn.id_token,o.flow==="standard"),Wt()}else o.onAuthError&&o.onAuthError(),mn&&mn.setError()},On.send(xn)}function Dn(Fn,dr,ir,Xn){kn=(kn+new Date().getTime())/2,It(Fn,dr,ir,kn),s&&(o.tokenParsed&&o.tokenParsed.nonce!=un.storedNonce||o.refreshTokenParsed&&o.refreshTokenParsed.nonce!=un.storedNonce||o.idTokenParsed&&o.idTokenParsed.nonce!=un.storedNonce)?(et("[KEYCLOAK] Invalid nonce, clearing token"),o.clearToken(),mn&&mn.setError()):Xn&&(o.onAuthSuccess&&o.onAuthSuccess(),mn&&mn.setSuccess())}}function ft(un){var mn=vt(),yn;a?typeof a=="string"&&(yn=a):yn="keycloak.json";function pn(On){On?o.endpoints={authorize:function(){return On.authorization_endpoint},token:function(){return On.token_endpoint},logout:function(){if(!On.end_session_endpoint)throw"Not supported by the OIDC server";return On.end_session_endpoint},checkSessionIframe:function(){if(!On.check_session_iframe)throw"Not supported by the OIDC server";return On.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!On.userinfo_endpoint)throw"Not supported by the OIDC server";return On.userinfo_endpoint}}:o.endpoints={authorize:function(){return mt()+"/protocol/openid-connect/auth"},token:function(){return mt()+"/protocol/openid-connect/token"},logout:function(){return mt()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var Dn=mt()+"/protocol/openid-connect/login-status-iframe.html";return o.iframeVersion&&(Dn=Dn+"?version="+o.iframeVersion),Dn},thirdPartyCookiesIframe:function(){var Dn=mt()+"/protocol/openid-connect/3p-cookies/step1.html";return o.iframeVersion&&(Dn=Dn+"?version="+o.iframeVersion),Dn},register:function(){return mt()+"/protocol/openid-connect/registrations"},userinfo:function(){return mt()+"/protocol/openid-connect/userinfo"}}}if(yn){var In=new XMLHttpRequest;In.open("GET",yn,!0),In.setRequestHeader("Accept","application/json"),In.onreadystatechange=function(){if(In.readyState==4)if(In.status==200||St(In)){var On=JSON.parse(In.responseText);o.authServerUrl=On["auth-server-url"],o.realm=On.realm,o.clientId=On.resource,pn(null),mn.setSuccess()}else mn.setError()},In.send()}else{if(!a.clientId)throw"clientId missing";o.clientId=a.clientId;var kn=a.oidcProvider;if(kn)if(typeof kn=="string"){var Pn;kn.charAt(kn.length-1)=="/"?Pn=kn+".well-known/openid-configuration":Pn=kn+"/.well-known/openid-configuration";var In=new XMLHttpRequest;In.open("GET",Pn,!0),In.setRequestHeader("Accept","application/json"),In.onreadystatechange=function(){if(In.readyState==4)if(In.status==200||St(In)){var Dn=JSON.parse(In.responseText);pn(Dn),mn.setSuccess()}else mn.setError()},In.send()}else pn(kn),mn.setSuccess();else{if(!a.url){for(var Mn=document.getElementsByTagName("script"),xn=0;xn<Mn.length;xn++)if(Mn[xn].src.match(/.*keycloak\.js/)){a.url=Mn[xn].src.substr(0,Mn[xn].src.indexOf("/js/keycloak.js"));break}}if(!a.realm)throw"realm missing";o.authServerUrl=a.url,o.realm=a.realm,pn(null),mn.setSuccess()}}return mn.promise}function St(un){return un.status==0&&un.responseText&&un.responseURL.startsWith("file:")}function It(un,mn,yn,pn){if(o.tokenTimeoutHandle&&(clearTimeout(o.tokenTimeoutHandle),o.tokenTimeoutHandle=null),mn?(o.refreshToken=mn,o.refreshTokenParsed=xt(mn)):(delete o.refreshToken,delete o.refreshTokenParsed),yn?(o.idToken=yn,o.idTokenParsed=xt(yn)):(delete o.idToken,delete o.idTokenParsed),un){if(o.token=un,o.tokenParsed=xt(un),o.sessionId=o.tokenParsed.session_state,o.authenticated=!0,o.subject=o.tokenParsed.sub,o.realmAccess=o.tokenParsed.realm_access,o.resourceAccess=o.tokenParsed.resource_access,pn&&(o.timeSkew=Math.floor(pn/1e3)-o.tokenParsed.iat),o.timeSkew!=null&&(et("[KEYCLOAK] Estimated time difference between browser and server is "+o.timeSkew+" seconds"),o.onTokenExpired)){var In=(o.tokenParsed.exp-new Date().getTime()/1e3+o.timeSkew)*1e3;et("[KEYCLOAK] Token expires in "+Math.round(In/1e3)+" s"),In<=0?o.onTokenExpired():o.tokenTimeoutHandle=setTimeout(o.onTokenExpired,In)}}else delete o.token,delete o.tokenParsed,delete o.subject,delete o.realmAccess,delete o.resourceAccess,o.authenticated=!1}function xt(un){switch(un=un.split(".")[1],un=un.replace(/-/g,"+"),un=un.replace(/_/g,"/"),un.length%4){case 0:break;case 2:un+="==";break;case 3:un+="=";break;default:throw"Invalid token"}return un=decodeURIComponent(escape(atob(un))),un=JSON.parse(un),un}function At(){var un="0123456789abcdef",mn=ht(36,un).split("");mn[14]="4",mn[19]=un.substr(mn[19]&3|8,1),mn[8]=mn[13]=mn[18]=mn[23]="-";var yn=mn.join("");return yn}function Dt(un){var mn=wt(un);if(mn){var yn=at.get(mn.state);return yn&&(mn.valid=!0,mn.redirectUri=yn.redirectUri,mn.storedNonce=yn.nonce,mn.prompt=yn.prompt,mn.pkceCodeVerifier=yn.pkceCodeVerifier),mn}}function wt(un){var mn;switch(o.flow){case"standard":mn=["code","state","session_state","kc_action_status"];break;case"implicit":mn=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status"];break;case"hybrid":mn=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status"];break}mn.push("error"),mn.push("error_description"),mn.push("error_uri");var yn=un.indexOf("?"),pn=un.indexOf("#"),In,kn;if(o.responseMode==="query"&&yn!==-1?(In=un.substring(0,yn),kn=Mt(un.substring(yn+1,pn!==-1?pn:un.length),mn),kn.paramsString!==""&&(In+="?"+kn.paramsString),pn!==-1&&(In+=un.substring(pn))):o.responseMode==="fragment"&&pn!==-1&&(In=un.substring(0,pn),kn=Mt(un.substring(pn+1),mn),kn.paramsString!==""&&(In+="#"+kn.paramsString)),kn&&kn.oauthParams){if(o.flow==="standard"||o.flow==="hybrid"){if((kn.oauthParams.code||kn.oauthParams.error)&&kn.oauthParams.state)return kn.oauthParams.newUrl=In,kn.oauthParams}else if(o.flow==="implicit"&&(kn.oauthParams.access_token||kn.oauthParams.error)&&kn.oauthParams.state)return kn.oauthParams.newUrl=In,kn.oauthParams}}function Mt(un,mn){for(var yn=un.split("&"),pn={paramsString:"",oauthParams:{}},In=0;In<yn.length;In++){var kn=yn[In].indexOf("="),Mn=yn[In].slice(0,kn);mn.indexOf(Mn)!==-1?pn.oauthParams[Mn]=yn[In].slice(kn+1):(pn.paramsString!==""&&(pn.paramsString+="&"),pn.paramsString+=yn[In])}return pn}function vt(){var un={setSuccess:function(mn){un.resolve(mn)},setError:function(mn){un.reject(mn)}};return un.promise=new Promise(function(mn,yn){un.resolve=mn,un.reject=yn}),un.promise.success=function(mn){return logPromiseDeprecation(),this.then(function(pn){mn(pn)}),this},un.promise.error=function(mn){return logPromiseDeprecation(),this.catch(function(pn){mn(pn)}),this},un}function Ft(un,mn,yn){var pn=null,In=new Promise(function(kn,Mn){pn=setTimeout(function(){Mn({error:yn||"Promise is not settled within timeout of "+mn+"ms"})},mn)});return Promise.race([un,In]).finally(function(){clearTimeout(pn)})}function Ht(){var un=vt();if(!lt.enable||lt.iframe)return un.setSuccess(),un.promise;var mn=document.createElement("iframe");lt.iframe=mn,mn.onload=function(){var In=o.endpoints.authorize();In.charAt(0)==="/"?lt.iframeOrigin=rt():lt.iframeOrigin=In.substring(0,In.indexOf("/",8)),un.setSuccess()};var yn=o.endpoints.checkSessionIframe();mn.setAttribute("src",yn),mn.setAttribute("title","keycloak-session-iframe"),mn.style.display="none",document.body.appendChild(mn);var pn=function(In){if(!(In.origin!==lt.iframeOrigin||lt.iframe.contentWindow!==In.source)&&(In.data=="unchanged"||In.data=="changed"||In.data=="error")){In.data!="unchanged"&&o.clearToken();for(var kn=lt.callbackList.splice(0,lt.callbackList.length),Mn=kn.length-1;Mn>=0;--Mn){var xn=kn[Mn];In.data=="error"?xn.setError():xn.setSuccess(In.data=="unchanged")}}};return window.addEventListener("message",pn,!1),un.promise}function Wt(){lt.enable&&o.token&&setTimeout(function(){tn().then(function(un){un&&Wt()})},lt.interval*1e3)}function tn(){var un=vt();if(lt.iframe&&lt.iframeOrigin){var mn=o.clientId+" "+(o.sessionId?o.sessionId:"");lt.callbackList.push(un);var yn=lt.iframeOrigin;lt.callbackList.length==1&&lt.iframe.contentWindow.postMessage(mn,yn)}else un.setSuccess();return un.promise}function gn(){var un=vt();if(lt.enable||o.silentCheckSsoRedirectUri){var mn=document.createElement("iframe");mn.setAttribute("src",o.endpoints.thirdPartyCookiesIframe()),mn.setAttribute("title","keycloak-3p-check-iframe"),mn.style.display="none",document.body.appendChild(mn);var yn=function(pn){mn.contentWindow===pn.source&&(pn.data!=="supported"&&pn.data!=="unsupported"||(pn.data==="unsupported"&&(lt.enable=!1,o.silentCheckSsoFallback&&(o.silentCheckSsoRedirectUri=!1),ot("[KEYCLOAK] 3rd party cookies aren't supported by this browser. checkLoginIframe and silent check-sso are not available.")),document.body.removeChild(mn),window.removeEventListener("message",yn),un.setSuccess()))};window.addEventListener("message",yn,!1)}else un.setSuccess();return Ft(un.promise,o.messageReceiveTimeout,"Timeout when waiting for 3rd party check iframe message.")}function nn(un){if(!un||un=="default")return{login:function(kn){return window.location.replace(o.createLoginUrl(kn)),vt().promise},logout:function(kn){return window.location.replace(o.createLogoutUrl(kn)),vt().promise},register:function(kn){return window.location.replace(o.createRegisterUrl(kn)),vt().promise},accountManagement:function(){var kn=o.createAccountUrl();if(typeof kn<"u")window.location.href=kn;else throw"Not supported by the OIDC server";return vt().promise},redirectUri:function(kn,Mn){return kn&&kn.redirectUri?kn.redirectUri:o.redirectUri?o.redirectUri:location.href}};if(un=="cordova"){lt.enable=!1;var mn=function(kn,Mn,xn){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(kn,Mn,xn):window.open(kn,Mn,xn)},yn=function(kn){return kn&&kn.cordovaOptions?Object.keys(kn.cordovaOptions).reduce(function(Mn,xn){return Mn[xn]=kn.cordovaOptions[xn],Mn},{}):{}},pn=function(kn){return Object.keys(kn).reduce(function(Mn,xn){return Mn.push(xn+"="+kn[xn]),Mn},[]).join(",")},In=function(kn){var Mn=yn(kn);return Mn.location="no",kn&&kn.prompt=="none"&&(Mn.hidden="yes"),pn(Mn)};return{login:function(kn){var Mn=vt(),xn=In(kn),Pn=o.createLoginUrl(kn),On=mn(Pn,"_blank",xn),Dn=!1,Fn=!1,dr=function(){Fn=!0,On.close()};return On.addEventListener("loadstart",function(ir){if(ir.url.indexOf("http://localhost")==0){var Xn=Dt(ir.url);pt(Xn,Mn),dr(),Dn=!0}}),On.addEventListener("loaderror",function(ir){if(!Dn)if(ir.url.indexOf("http://localhost")==0){var Xn=Dt(ir.url);pt(Xn,Mn),dr(),Dn=!0}else Mn.setError(),dr()}),On.addEventListener("exit",function(ir){Fn||Mn.setError({reason:"closed_by_user"})}),Mn.promise},logout:function(kn){var Mn=vt(),xn=o.createLogoutUrl(kn),Pn=mn(xn,"_blank","location=no,hidden=yes,clearcache=yes"),On;return Pn.addEventListener("loadstart",function(Dn){Dn.url.indexOf("http://localhost")==0&&Pn.close()}),Pn.addEventListener("loaderror",function(Dn){Dn.url.indexOf("http://localhost")==0||(On=!0),Pn.close()}),Pn.addEventListener("exit",function(Dn){On?Mn.setError():(o.clearToken(),Mn.setSuccess())}),Mn.promise},register:function(kn){var Mn=vt(),xn=o.createRegisterUrl(),Pn=In(kn),On=mn(xn,"_blank",Pn);return On.addEventListener("loadstart",function(Dn){if(Dn.url.indexOf("http://localhost")==0){On.close();var Fn=Dt(Dn.url);pt(Fn,Mn)}}),Mn.promise},accountManagement:function(){var kn=o.createAccountUrl();if(typeof kn<"u"){var Mn=mn(kn,"_blank","location=no");Mn.addEventListener("loadstart",function(xn){xn.url.indexOf("http://localhost")==0&&Mn.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(kn){return"http://localhost"}}}if(un=="cordova-native")return lt.enable=!1,{login:function(kn){var Mn=vt(),xn=o.createLoginUrl(kn);return universalLinks.subscribe("keycloak",function(Pn){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var On=Dt(Pn.url);pt(On,Mn)}),window.cordova.plugins.browsertab.openUrl(xn),Mn.promise},logout:function(kn){var Mn=vt(),xn=o.createLogoutUrl(kn);return universalLinks.subscribe("keycloak",function(Pn){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),o.clearToken(),Mn.setSuccess()}),window.cordova.plugins.browsertab.openUrl(xn),Mn.promise},register:function(kn){var Mn=vt(),xn=o.createRegisterUrl(kn);return universalLinks.subscribe("keycloak",function(Pn){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var On=Dt(Pn.url);pt(On,Mn)}),window.cordova.plugins.browsertab.openUrl(xn),Mn.promise},accountManagement:function(){var kn=o.createAccountUrl();if(typeof kn<"u")window.cordova.plugins.browsertab.openUrl(kn);else throw"Not supported by the OIDC server"},redirectUri:function(kn){return kn&&kn.redirectUri?kn.redirectUri:o.redirectUri?o.redirectUri:"http://localhost"}};throw"invalid adapter type: "+un}var qt=function(){if(!(this instanceof qt))return new qt;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");var un=this;function mn(){for(var yn=new Date().getTime(),pn=0;pn<localStorage.length;pn++){var In=localStorage.key(pn);if(In&&In.indexOf("kc-callback-")==0){var kn=localStorage.getItem(In);if(kn)try{var Mn=JSON.parse(kn).expires;(!Mn||Mn<yn)&&localStorage.removeItem(In)}catch{localStorage.removeItem(In)}}}}un.get=function(yn){if(yn){var pn="kc-callback-"+yn,In=localStorage.getItem(pn);return In&&(localStorage.removeItem(pn),In=JSON.parse(In)),mn(),In}},un.add=function(yn){mn();var pn="kc-callback-"+yn.state;yn.expires=new Date().getTime()+60*60*1e3,localStorage.setItem(pn,JSON.stringify(yn))}},fn=function(){if(!(this instanceof fn))return new fn;var un=this;un.get=function(In){if(In){var kn=yn("kc-callback-"+In);if(pn("kc-callback-"+In,"",mn(-100)),kn)return JSON.parse(kn)}},un.add=function(In){pn("kc-callback-"+In.state,JSON.stringify(In),mn(60))},un.removeItem=function(In){pn(In,"",mn(-100))};var mn=function(In){var kn=new Date;return kn.setTime(kn.getTime()+In*60*1e3),kn},yn=function(In){for(var kn=In+"=",Mn=document.cookie.split(";"),xn=0;xn<Mn.length;xn++){for(var Pn=Mn[xn];Pn.charAt(0)==" ";)Pn=Pn.substring(1);if(Pn.indexOf(kn)==0)return Pn.substring(kn.length,Pn.length)}return""},pn=function(In,kn,Mn){var xn=In+"="+kn+"; expires="+Mn.toUTCString()+"; ";document.cookie=xn}};function Cn(){try{return new qt}catch{}return new fn}function Tn(un){return function(){o.enableLogging&&un.apply(console,Array.prototype.slice.call(arguments))}}}function loginKeyCloakJS(){return new Promise((a,o)=>{const _e=new Keycloak({url:"https://idp.apizee.com/auth",realm:"APIZEE-POC-DGPN",clientId:"visio-assisted"});_e.init({onLoad:"login-required",checkLoginIframe:!1}).then(tt=>{tt?(console.log("Keycloak authenticated"),a(_e)):console.log("Keycloak NOT authenticated...")}).catch(tt=>{console.error("Authenticated Failed",tt),o(tt)})})}const ROOM_THEME_OPTIONS={components:{MuiChip:{variants:[{props:{},style:{color:"#F7F7F8",backgroundColor:"#111313",borderRadius:"4px",opacity:"75%",":hover":{backgroundColor:"#1D1F20",opacity:"100%"}}}]},MuiCircularProgress:{variants:[{props:{},style:{color:"#F7F7F8"}}]},MuiIconButton:{variants:[{props:{},style:{padding:4,margin:2,color:"#F7F7F8",backgroundColor:"#111313",borderRadius:"4px",opacity:"75%",":hover":{backgroundColor:"#1D1F20",opacity:"100%"},":disabled":{color:"#7A8085",backgroundColor:"#CACCCE",opacity:"75%"}}}]},MuiSwitch:{styleOverrides:{colorPrimary:{"&.Mui-checked":{color:"#17821A"}},track:{".Mui-checked.Mui-checked + &":{backgroundColor:"#17821A"}}}}}},VIDEO_ROUNDED_CORNERS={borderRadius:"4px",overflow:"hidden"};function isInstanceOfTakeSnapshot(a){return typeof a!="object"?!1:"takeSnapshot"in a}function isInstanceOfSwitchFacingMode(a){return typeof a!="object"?!1:"switchFacingMode"in a}function isInstanceOfFileShared(a){return typeof a!="object"?!1:"fileShared"in a}function isInstanceOfHangup(a){return typeof a!="object"?!1:"hangUp"in a}const video_sizing={height:"100%",width:"100%"},COMPONENT_NAME="App";function App(a){var Wn,vn;const o=useThemeProps({props:a,name:`${COMPONENT_NAME}`}),{optInCGUPrefixText:_e="I agree to the ",optInCGULinkText:tt="General Terms of Sale",optInCGUAriaLabel:at="accept-terms-conditions",optInPrivacyPrefixText:lt="I agree to the ",optInPrivacyLinkText:it="Privacy Policy",optInPrivacyAriaLabel:ut="accept-privacy-policy",optInButtonText:s="Confirm",backButtonText:et="Back",readyButtonText:ot="Enter",selectDeviceHelperText:st="Please check what you want to share before entering the room.",hangedUpText:Rt="The agent hanged up. Bye!"}=o,ht=useParams(),[bt]=useSearchParams(),[ct,mt]=reactExports.useState(void 0),[rt,pt]=reactExports.useState(!1),[ft,St]=reactExports.useState(void 0),[It,xt]=reactExports.useState(),[At,Dt]=reactExports.useState(void 0),[wt,Mt]=reactExports.useState(void 0),{value:vt,toggle:Ft}=_$1(!1),{value:Ht,toggle:Wt}=_$1(!1),[tn,gn]=reactExports.useState(),[nn,qt]=reactExports.useState(!1),{session:fn,disconnect:Cn}=y(ct?{apiKey:ct.apiKey}:void 0,ct?{cloudUrl:ct.cloudUrl?ct.cloudUrl:"https://cloud.apirtc.com",groups:[ct.conversation.name+"-guests"],userData:new apiRTC_minExports.UserData({firstName:ct.user.firstName,lastName:ct.user.lastName})}:void 0),{userMediaDevices:Tn,selectedAudioIn:un,setSelectedAudioIn:mn,selectedVideoIn:yn,setSelectedVideoIn:pn}=N(fn),In=reactExports.useMemo(()=>{const Rn={...ct==null?void 0:ct.streams[0].constraints};if(Rn!=null&&Rn.audio&&(At===void 0||At)){const Gt=Rn.audio instanceof Object?{...Rn.audio}:{};un&&(Gt.deviceId=un.id),Rn.audio=Gt}else Rn.audio=!1;if(Rn!=null&&Rn.video&&(wt===void 0||wt)){const Gt=Rn.video instanceof Object?{...Rn.video}:{};yn&&(Gt.deviceId=yn.id),It&&(Gt.advanced?Gt.advanced=Gt.advanced.map(Tt=>Tt.facingMode?{facingMode:It}:Tt):Gt.advanced=[{facingMode:It}]),Rn.video=Gt}else Rn.video=!1;return globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|useMemo new_constraints`,Rn),Rn},[ct,un,yn,It,At,wt]),{stream:kn}=b(vt?fn:void 0,{constraints:In}),{conversation:Mn}=d(Ht?fn:void 0,ct?ct.conversation.name:void 0,ct?ct.conversation.getOrCreateOptions:void 0,!0,ct?ct.conversation.joinOptions:void 0),{publishedStreams:xn,subscribedStreams:Pn}=m(Mn,kn?[{stream:kn,options:ct==null?void 0:ct.streams[0].publishOptions}]:[]),{value:On,toggle:Dn}=_$1(!1),Fn=reactExports.useMemo(()=>Pn.length===0?!0:On,[Pn,On]),[dr,ir]=reactExports.useState(void 0),Xn=async(Rn,Gt)=>fetch(`http://localhost:3007/invitations/${Rn}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(Tt=>(console.log("response",Tt),Tt.status!==200?null:Tt.json())).catch(Tt=>{console.error("getInvitationData",Tt)});reactExports.useEffect(()=>{var Rn;if(ct){const Gt=(Rn=ct.streams[0].constraints)==null?void 0:Rn.video;Gt instanceof Object&&Gt.advanced&&Gt.advanced.forEach(Tt=>{Tt.facingMode&&(globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|useEffect invitationData, facingMode`,Tt.facingMode),xt(Tt.facingMode))})}},[ct]),reactExports.useEffect(()=>{const Rn=Gt=>{mt(void 0)};return window.addEventListener("beforeunload",Rn),()=>{window.removeEventListener("beforeunload",Rn)}},[]),reactExports.useEffect(()=>{if(ht.invitationData)try{const Rn=JSON.parse(base64Exports.decode(ht.invitationData));globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|InvitationData`,JSON.stringify(Rn)),mt(Rn)}catch(Rn){if(Rn instanceof SyntaxError){const Gt=ht.invitationData;loginKeyCloakJS().then(Tt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|keycloak.token`,Tt.token),Xn(Gt).then(nt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|getInvitationData`,Gt,nt),mt(nt)})}).catch(Tt=>{console.error(`${COMPONENT_NAME}|loginKeyCloakJS error`,Tt)})}}},[ht.invitationData]),reactExports.useEffect(()=>{var Rn,Gt;Dt(!!((Rn=ct==null?void 0:ct.streams[0].constraints)!=null&&Rn.audio)),Mt(!!((Gt=ct==null?void 0:ct.streams[0].constraints)!=null&&Gt.video))},[ct]),reactExports.useEffect(()=>{const Rn=bt.get("i");if(Rn)try{const Gt=JSON.parse(base64Exports.decode(Rn));globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|InvitationData`,JSON.stringify(Gt)),mt(Gt)}catch(Gt){if(console.error(`${COMPONENT_NAME}|parsing i search parameter error`,Gt),Gt instanceof SyntaxError){Xn(Rn).then(Tt=>{console.info(`${COMPONENT_NAME}|getInvitationData`,Rn,Tt),globalThis.logLevel.isInfoEnabled&&console.info(`${COMPONENT_NAME}|getInvitationData`,Rn,Tt),mt(Tt)});return}else pt(!0)}},[bt]),reactExports.useEffect(()=>{if(fn){const Rn=fn.getUserAgent(),Gt=new uaParserExports.UAParser;globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|UAParser`,Gt.getResult());const Tt=Rn.getUserData();Tt.setToSession(),Tt.setProp("systemInfo",JSON.stringify(Gt.getResult())),Rn.setUserData(Tt)}},[fn]),reactExports.useEffect(()=>{if(fn&&kn){const Rn=Gt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|onContactData`,Gt);const Tt=Gt.sender,nt=Gt.content;isInstanceOfTakeSnapshot(nt)?kn.takeSnapshot(nt.takeSnapshot).then(Ct=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|takeSnapshot of`,kn,Ct),Tt.sendFile({name:`snapshot_${new Date().toISOString()}.png`,type:"image/png"},Ct).on("statusChange",Pt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|statusChange`,Pt)})}).catch(Ct=>{globalThis.logLevel.isWarnEnabled&&console.warn(`${COMPONENT_NAME}|takeSnapshot error`,Ct)}):isInstanceOfSwitchFacingMode(nt)&&(globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|SwitchFacingMode`),xt(Ct=>Ct==="user"?"environment":"user"))};return fn.on("contactData",Rn),()=>{fn.removeListener("contactData",Rn)}}},[fn,kn]),reactExports.useEffect(()=>{if(fn&&Mn){const Rn=Gt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|Conversation onData`,Gt);const Tt=Gt.content;isInstanceOfFileShared(Tt)?(globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|fileShared`,Tt),fetch(Tt.fileShared.link,{method:"get",mode:"cors",headers:new Headers({Authorization:"Bearer "+Tt.fileShared.jwt})}).then(nt=>nt.blob()).then(nt=>{const Ct=window.URL.createObjectURL(nt);gn(Ct)}).catch(nt=>{console.error(`${COMPONENT_NAME}|fetch error`,Tt.fileShared.link,nt)})):isInstanceOfHangup(Tt)&&(Mn.leave().then().catch(nt=>{globalThis.logLevel.isWarnEnabled&&console.warn(`${COMPONENT_NAME}|conversation leave error`,nt)}).finally(()=>{Cn()}),qt(!0))};return Mn.on("data",Rn),()=>{Mn.removeListener("data",Rn)}}},[Mn,fn,Cn]),reactExports.useEffect(()=>{if(Mn){const Rn=Tt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|pointerSharingEnabled`,Tt)};Mn.on("pointerSharingEnabled",Rn);const Gt=Tt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|pointerLocationChanged`,Tt),ir(Tt.data),setTimeout(()=>{ir(void 0)},3e3)};return Mn.on("pointerLocationChanged",Gt),Mn.enablePointerSharing(!0),()=>{Mn.removeListener("pointerSharingEnabled",Rn),Mn.removeListener("pointerLocationChanged",Gt)}}},[Mn]),reactExports.useEffect(()=>{ct&&fetch(ct.cloudUrl).then(Rn=>{Rn.status===404?(pt(!0),St(404)):Rn.status===401?(pt(!0),St(401)):Rn.status===500&&(pt(!0),St(500))}).catch(Rn=>{pt(!0)})},[ct]);const tr=Rn=>{var nt,Ct;const Gt=(nt=Rn.getContact())==null?void 0:nt.getUserData().get("firstName"),Tt=(Ct=Rn.getContact())==null?void 0:Ct.getUserData().get("lastName");if(!(!Gt&&!Tt))return`${Gt??""} ${Tt??""}`},cn=!Fn&&Pn.length<=2?"large":void 0,Jn=Pn.map((Rn,Gt)=>jsxRuntimeExports.jsx(N$1,{id:"subscribed-stream-"+Gt,sx:{...Rn.hasVideo()?video_sizing:{backgroundColor:"grey"}},stream:Rn,name:tr(Rn),controls:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(j,{size:cn}),jsxRuntimeExports.jsx(F,{size:cn,disabled:!0}),jsxRuntimeExports.jsx(X,{size:cn,disabled:!0})]}),children:Rn.hasVideo()?jsxRuntimeExports.jsx(U,{sx:video_sizing,style:{...video_sizing,objectFit:"cover",...VIDEO_ROUNDED_CORNERS}}):jsxRuntimeExports.jsx(I,{})},Gt)),Qn=Fn&&xn.length<=2?"large":void 0,sr=xn.map((Rn,Gt)=>jsxRuntimeExports.jsx(N$1,{id:"published-stream-"+Gt,sx:{...Rn.hasVideo()?video_sizing:{backgroundColor:"grey"}},stream:Rn,muted:!0,controls:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(F,{size:Qn}),jsxRuntimeExports.jsx(X,{size:Qn})]}),children:Rn.hasVideo()?jsxRuntimeExports.jsx(U,{sx:video_sizing,style:{...video_sizing,objectFit:"cover",...VIDEO_ROUNDED_CORNERS},pointer:dr}):jsxRuntimeExports.jsx(I,{})},Gt)),[Bn,rr]=reactExports.useState(0),nr=()=>{rr(Rn=>Rn+1)},Nn=()=>{rr(Rn=>Rn-1)};return reactExports.useEffect(()=>{Bn===1&&!vt&&Ft()},[Bn,vt,Ft]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[!fn&&!rt&&jsxRuntimeExports.jsx(Box$1,{display:"flex",alignItems:"center",justifyContent:"center",sx:{mt:5},children:jsxRuntimeExports.jsx("img",{height:"320px",width:"320px",src:logo,alt:"logo"})}),rt&&jsxRuntimeExports.jsx(ErrorPage,{errorType:ft}),fn&&!rt&&!Ht&&jsxRuntimeExports.jsx(Container$1,{maxWidth:"sm",sx:{height:"100vh"},children:jsxRuntimeExports.jsx(Box$1,{sx:{height:"100%"},display:"flex",alignItems:"center",justifyContent:"center",children:jsxRuntimeExports.jsx(Card$1,{children:jsxRuntimeExports.jsx(CardContent$1,{children:jsxRuntimeExports.jsxs(TextStepper,{activeStep:Bn,header:jsxRuntimeExports.jsx("img",{src:logo,alt:"Apizee Logo",height:24}),children:[jsxRuntimeExports.jsx(Step$1,{children:jsxRuntimeExports.jsx(OptInList,{optIns:[{id:"CGU",labels:{aria:at,prefix:_e,link:tt},link:navigator.language==="fr"||navigator.language==="fr-FR"?"https://cloud.apizee.com/attachments/b87662d7-3e82-4519-a4db-9fb6ba67b5cc/Apizee-ConditionsGeneralesUtilisation.pdf":"https://cloud.apizee.com/attachments/cb744e03-182b-453e-bbdf-0d89cf42e182/Apizee-TermsOfUse.pdf"},{id:"Privacy",labels:{aria:ut,prefix:lt,link:it},link:navigator.language==="fr"||navigator.language==="fr-FR"?"https://cloud.apizee.com/attachments/f87493b0-483e-4723-a3ee-02d59a501b1c/Apizee-PolitiqueConfidentialite.pdf":"https://cloud.apizee.com/attachments/ae61f778-16d1-4dd4-baa1-cd1ba568a0d6/Apizee-PrivacyPolicy.pdf"}],labels:{submit:s},onSubmit:nr})},"legal"),jsxRuntimeExports.jsxs(Step$1,{children:[jsxRuntimeExports.jsxs(Stack$1,{sx:{mt:1},direction:{xs:"column"},alignItems:"center",justifyContent:"center",useFlexGap:!0,flexWrap:"wrap",spacing:1,children:[jsxRuntimeExports.jsx(Box$1,{sx:{width:"100%",paddingTop:"75%",position:"relative","& .MuiBox-root":{position:"absolute",height:"100%",maxWidth:"100%"}},children:kn?jsxRuntimeExports.jsx(N$1,{sx:{top:0,left:0,bottom:0,right:0,maxWidth:{xs:"100%",sm:"100%"},...!kn.hasVideo()&&{position:"absolute",inset:0,borderRadius:"4px",backgroundColor:"#CACCCE"}},stream:kn,muted:!0,children:kn.hasVideo()?jsxRuntimeExports.jsx(U,{style:{height:"100%",...VIDEO_ROUNDED_CORNERS},"data-testid":"local-video"}):jsxRuntimeExports.jsx(I,{"data-testid":"local-audio"})}):jsxRuntimeExports.jsx(Skeleton$1,{variant:"rectangular",width:"100%",height:"100%",sx:{position:"absolute",top:0,left:0}})}),jsxRuntimeExports.jsxs(Box$1,{sx:{minWidth:"120px",width:"100%",display:"flex"},children:[jsxRuntimeExports.jsx(Button$1,{sx:{minWidth:0,width:"3em",height:"3em",display:"flex",justifyContent:"center",alignItems:"center",border:"solid 1px rgba(0, 0, 0, 0.23)",borderRadius:"4px",boxSizing:"border-box",flexShrink:0,color:"black"},disabled:!((Wn=ct==null?void 0:ct.streams[0].constraints)!=null&&Wn.audio),onClick:()=>Dt(!At),children:jsxRuntimeExports.jsx(Icon$1,{children:In.audio?"mic_on":"mic_off"})}),jsxRuntimeExports.jsx(w$1,{sx:{marginLeft:"0.25em",minWidth:"120px",flexGrow:"1"},id:"audio-in",size:"small",disabled:!In.audio,devices:Tn.audioinput,selectedDevice:un,setSelectedDevice:mn})]}),jsxRuntimeExports.jsxs(Box$1,{sx:{minWidth:"120px",width:"100%",display:"flex"},children:[jsxRuntimeExports.jsx(Button$1,{sx:{minWidth:0,width:"3em",height:"3em",display:"flex",justifyContent:"center",alignItems:"center",border:"solid 1px rgba(0, 0, 0, 0.23)",borderRadius:"4px",boxSizing:"border-box",flexShrink:0,color:"black"},disabled:!((vn=ct==null?void 0:ct.streams[0].constraints)!=null&&vn.video),onClick:()=>{Mt(!wt)},children:jsxRuntimeExports.jsx(Icon$1,{children:In.video?"videocam_on":"videocam_off"})}),jsxRuntimeExports.jsx(w$1,{sx:{marginLeft:"0.25em",minWidth:"120px",flexGrow:"1"},id:"video-in",size:"small",disabled:!In.video,devices:Tn.videoinput,selectedDevice:yn,setSelectedDevice:pn})]})]}),jsxRuntimeExports.jsx(Typography$1,{sx:{mt:1},children:st}),jsxRuntimeExports.jsxs(Box$1,{sx:{display:"flex",justifyContent:"end",mt:1},children:[jsxRuntimeExports.jsx(Button$1,{onClick:Nn,children:et}),jsxRuntimeExports.jsx(Button$1,{variant:"outlined",onClick:Wt,children:ot})]})]},"device-selection")]})})})})}),Mn&&Ht&&jsxRuntimeExports.jsxs(Box$1,{sx:{position:"relative",height:"99vh",width:"100vw",maxWidth:"100%"},children:[jsxRuntimeExports.jsx(S,{sx:{height:"100%",width:"100%"},children:Fn?sr:Jn}),jsxRuntimeExports.jsx(S,{sx:{position:"absolute",bottom:4,left:4,opacity:.9,height:"34%",width:{xs:"50%",sm:"40%",md:"30%",lg:"20%"}},onClick:Dn,children:Fn?Jn:sr})]}),tn&&jsxRuntimeExports.jsx("img",{src:tn,alt:"sharedImg"}),nn&&jsxRuntimeExports.jsx(Container$1,{maxWidth:"md",children:jsxRuntimeExports.jsx(Alert$1,{severity:"info",children:Rt})})]})}const index="",frFR={components:{App:{defaultProps:{acceptTitleText:"Documents légaux",optInCGUPrefixText:"J'accepte les ",optInCGULinkText:"Conditions générales d'utilisation",optInCGUAriaLabel:"conditions-générales",optInPrivacyPrefixText:"J'accepte la ",optInPrivacyLinkText:"Politique de confidentialité",optInPrivacyAriaLabel:"politique-confidentialité",optInButtonText:"Confirmer",backButtonText:"Retour",readyButtonText:"Entrer en communication",selectDeviceText:"Sélection de périphériques",selectDeviceHelperText:"Avant d'entrer en communication, vérifiez ce que vous partagerez avec votre interlocuteur.",hangedUpText:"L'agent a raccroché."}}}},DEBUG={level:"debug",isDebugEnabled:!0,isInfoEnabled:!0,isWarnEnabled:!0},INFO={level:"info",isDebugEnabled:!1,isInfoEnabled:!0,isWarnEnabled:!0},WARN={level:"warn",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!0},ERROR={level:"error",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!1};function setLogLevel(a){switch(a){case"debug":globalThis.logLevel=DEBUG;break;case"info":globalThis.logLevel=INFO;break;case"warn":globalThis.logLevel=WARN;break;case"error":globalThis.logLevel=ERROR;break;default:globalThis.logLevel=INFO}}const logLevel="debug";setLogLevel(logLevel);A(logLevel);$$1(logLevel);function getLangFiles(){switch(navigator.language){case"fr":case"fr-FR":return[frFR,Y];default:return[]}}document.documentElement.setAttribute("lang",navigator.language.slice(0,2));const theme=createTheme({palette:{mode:"light",primary:{main:"#F76B40",light:"#ba3108",dark:"#f88562"},secondary:{main:"#5b5baf",light:"#8eabc7",dark:"#2e455c"},success:{main:"#0F5712",light:"#17821A",dark:"#0A340B"},info:{main:"#1355AE"},neutral:{main:"rgba(0, 0, 0, 0.23)"}},typography:{button:{textTransform:"none"}},...ROOM_THEME_OPTIONS},...getLangFiles()),container=document.getElementById("root");container&&createRoot(container).render(jsxRuntimeExports.jsx(ThemeProvider,{theme,children:jsxRuntimeExports.jsx(BrowserRouter,{basename:"/visio-assisted",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(App,{})}),jsxRuntimeExports.jsx(Route,{path:"/:invitationData",element:jsxRuntimeExports.jsx(App,{})})]})})}));
